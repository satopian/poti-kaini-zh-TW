!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r=n.parcelRequire94c2;r.register("6NgYC",(function(n,i){t(n.exports,"Embed",(function(){return p}));var a=r("4gaLD"),o=r("cijLd");r("jyMxU");var s=r("3C7jC"),l=r("5ngYX"),c=r("gWfkn"),u=r("941rU"),h=r("1mH1z");function p(t){var n,i,p=function(e){try{if(d)throw new Error("Already called openProject");d=!0;var r=new l.SaveReminder(c.klHistory,!1,!1,(function(){}),(function(){return!!n&&n.isDrawing()}));n=new s.KlApp(e,{saveReminder:r,bottomBar:t.bottomBar,aboutEl:t.aboutEl,embed:{url:t.embedUrl,onSubmit:t.onSubmit}}),r.init(),f&&f.parentNode&&f.parentNode.removeChild(f),f=null,v=null,document.body.appendChild(n.getEl())}catch(e){v&&(v.textContent="❌ "+e),f&&(f.className+="loading-screen-error"),console.error(e)}},d=!1,g=[],f=document.getElementById("loading-screen"),v=document.getElementById("loading-screen-text");v&&(v.textContent=h.LANG("embed-init-waiting")),t.project&&p(t.project),this.openProject=p,this.initError=function(e){v&&(v.textContent="❌ "+e),f&&(f.className+="loading-screen-error")},this.getPNG=function(){if(!n)throw new Error("App not initialized");return n.getPNG()},this.getPSD=a.asyncToGenerator(e(o).mark((function t(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}throw new Error("App not initialized");case 2:return e.next=4,n.getPSD();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),t)}))),this.readPSDs=function(t){if(0!==t.length){var n=function(e){try{var t=i.readPsd(e.blob),n=u.klPsdToKlProject(u.readPsd(t));e.callback(n)}catch(t){console.error("failed to read psd",t),e.callback(null)}};i?t.forEach(n):(0===g.length&&a.asyncToGenerator(e(o).mark((function t(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r("bxnoy");case 3:i=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),i="error";case 9:for(;g.length;)n(g.shift());case 10:case"end":return e.stop()}}),t,null,[[0,6]])})))(),t.forEach((function(e){g.push(e)})))}}}})),r.register("jyMxU",(function(e,t){if(r("cK5hG"),r("cNeLG"),r("dpoWh"),r("gGP1V"),r("jO3cy"),r("ffj4s"),r("ddY2J"),r("fOfIC"),r("cfF7p"),r("4ekSO"),r("fqkQP"),r("kv3nX"),r("fRxWg"),r("38lxR"),r("Apmcd"),r("MEgGa"),r("2xn0i"),r("j4lAT"),r("i8szt"),r("5eAxt"),r("cgkH9"),r("j06La"),r("5IsCk"),r("6yG0j"),r("7SrKm"),r("l4lCC"),r("g9bVW"),r("fpgtw"),r("ezT59"),r("f6hx0"),r("aiC3N"),r("cekHE"),r("h3f4c"),r("k803i"),r("9pmMz"),r("2M9cA"),r("cMF3x"),r("fcsxt"),r("27Hw3"),r("f1ng1"),r("hnS4i"),r("41rO8"),r("87a88"),r("9zshv"),r("gfSHW"),r("kC6Os"),r("99yfV"),r("j4Oqh"),r("41TXX"),r("71MGB"),r("bD4J9"),r("6DM4t"),r("gWrYo"),r("kOTv6"),r("hVycJ"),r("ji6FU"),r("6eVOU"),r("4vUKg"),r("7I91f"),r("18VuS"),r("k3QML"),r("doMoi"),r("gSCyV"),r("jXFsw"),r("7QBpd"),r("f99UO"),r("7fTKa"),r("cMc1u"),r("2nSAm"),r("1XKa2"),r("f8KAz"),r("5tBkn"),r("gX5K7"),r("3V1CB"),r("jHxqB"),r("6HQnJ"),r("52o9J"),r("hYUT4"),r("128AN"),r("lqh52"),r("eWB87"),r("6nBVP"),r("hwwzH"),r("ifz5K"),r("6a3a7"),r("2OJbv"),r("6aMzY"),r("57aGm"),r("bcN3S"),r("3z252"),r("1F9oE"),r("cyKYk"),r("5IT6w"),r("3iS5X"),r("jrROT"),r("bmHGB"),r("erIvV"),r("9HPWw"),r("22L4D"),r("9OU4N"),r("l8Guq"),r("mJux4"),r("tttpZ"),r("iG7hc"),r("8FSjO"),r("l9N2O"),r("evcP9"),r("ghL03"),r("jmNdZ"),r("gRAam"),r("gzcSr"),r("8LqBN"),r("21jPJ"),r("kVqfb"),r("dzzom"),r("2gunB"),r("QxL6K"),r("6ERNe"),r("jvxFE"),r("3I5Q0"),r("boJu5"),r("e0lr8"),r("7LL1n"),r("c0Tqp"),r("5FVj1"),r("fEEuV"),r("7aVqu"),r("b9AHh"),r("bsrPv"),r("1HS2A"),r("03jrQ"),r("1e9nP"),r("hu06n"),r("6dDHI"),r("8p8zQ"),r("9xQx7"),r("1YPyf"),r("ej8Tj"),r("0HFgS"),r("ivCR8"),r("kWB7y"),r("iRcYA"),r("8FnSg"),r("6FagT"),r("fltGU"),r("1TpBH"),r("jXJMN"),r("blHyV"),r("bytwV"),r("iElT4"),r("bqvPl"),r("by6w7"),r("k52v4"),r("3fQ7i"),r("vXr1A"),r("jkI01"),r("b59cW"),r("jXBTm"),r("bvJmB"),r("fDOA5"),r("iqpZ0"),r("6LiLh"),r("4AV73"),r("asE2s"),r("7HArX"),r("cZ95y"),r("7WxZe"),r("98YB9"),r("1SIrv"),r("lESvO"),r("nw13n"),r("ladKj"),r("cF1lk"),r("gKW7w"),r("kh0uM"),r("aHDvk"),r("ka3Iz"),r("jhNcH"),r("h47oj"),r("5rlTa"),r("7U31A"),r("7gDrp"),r("bKl1Y"),r("jXOHG"),r("WnnqW"),r("GU8j0"),r("j4nPZ"),r("fk2yb"),r("fJkZ6"),r("1RDb0"),r("eCXCW"),r("cboi3"),r("ej9nm"),r("jZZp4"),r("1Fdpk"),r("2Xd9T"),r("hMGEZ"),r("bZDCM"),r("3iuTX"),r("kIokh"),r("2sNOJ"),r("1lj6k"),r("4Ozez"),r("6xUV5"),r("1XiOT"),r("fLwrF"),r("15Boy"),r("4lauO"),r("7CWQc"),r("d9SMF"),r("63lU7"),r("ayEdr"),r("7Gwyo"),r("3iYKH"),r("dHv2h"),r("kXm0w"),r("kjhYX"),r("ba392"),r("aKc2e"),r("biXeg"),r("lom9E"),r("aamP5"),r("3FV0H"),r("1zLZr"),r("6nTC9"),r("hKO3L"),r("dgelS"),r("9vFTV"),r("diSfj"),r("kLDiZ"),r("lVKny"),r("9I8rX"),r("2970r"),r("kMNNB"),r("ewKQm"),r("celFa"),r("khNxJ"),r("1YHMm"),r("aVIMC"),r("8VwCG"),r("gIPra"),r("7dmhb"),r("jkBqo"),r("8drF5"),r("iYMug"),r("dsRj4"),r("3p37D"),r("f0D6D"),r("hqZAm"),r("g90ks"),r("3iQdG"),r("215Xh"),r("3hs7E"),r("3FGl4"),r("5X1AL"),r("gjLWg"),r("jDJfp"),r("jDLVA"),r("1Yhww"),r("iJZgE"),r("9Z4cR"),r("gJvaJ"),r("7ofeM"),r("epkJT"),r("3o9RK"),r("kFM0y"),r("kfvgx"),r("gsVBO"),r("kmSVG"),r("4zmA0"),r("cQIcc"),r("eAVDg"),r("hmM4b"),r("lFgox"),r("kfur8"),r("5dg4B"),r("izcMZ"),"scrollTo"in Element.prototype||Object.defineProperty(Element.prototype,"scrollTo",{value:function(e,t){this.scrollLeft=e,this.scrollTop=t}}),"scrollBy"in Element.prototype||Object.defineProperty(Element.prototype,"scrollBy",{value:function(e,t){this.scrollLeft+=e,this.scrollTop+=t}}),!("localStorage"in window))try{window.localStorage={getItem:function(){return null},setItem:function(){},removeItem:function(){}}}catch(e){}})),r.register("cK5hG",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("fdCuf"),o=r("cn22k"),s=r("9ZRgk"),l=r("2x0T1"),c=r("bMhTS"),u=r("A56Kx"),h=r("OTdcX"),p=r("6WghJ"),d=r("1JB0D"),g=r("gVpis"),f=r("3HoBU"),v=r("gczVK"),m=r("c9sXY"),y=r("fcVIX"),x=r("edAQb"),b=r("falgx"),w=r("hAcvu"),B=r("hvgHk"),C=r("eXtvS"),S=r("eqpEX"),k=r("KFLt0"),L=r("8xgUB"),A=r("9hrSE"),T=r("8Ybf3"),I=r("b9pdI"),E=r("l0gwz"),M=r("bLi0c"),R=r("jDguE"),O=r("7wvbV"),P=r("1fDSm"),D=r("8Opqg"),G=r("eW5R0"),N=r("7Sc7b"),j=r("8OCuI"),z=r("VN1JY"),H=r("8RiFY"),U=r("btl60"),X=r("aUpwE"),F=r("9Ebr8"),W=r("jUSxl"),K=r("9otZn").forEach,V=N("hidden"),Y="Symbol",J=H("toPrimitive"),_=W.set,Q=W.getterFor(Y),q=Object.prototype,Z=i.Symbol,$=Z&&Z.prototype,ee=i.TypeError,te=i.QObject,ne=a("JSON","stringify"),re=E.f,ie=M.f,ae=T.f,oe=O.f,se=l([].push),le=G("symbols"),ce=G("op-symbols"),ue=G("string-to-symbol-registry"),he=G("symbol-to-string-registry"),pe=G("wks"),de=!te||!te.prototype||!te.prototype.findChild,ge=u&&p((function(){return 7!=k(ie({},"a",{get:function(){return ie(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=re(q,t);r&&delete q[t],ie(e,t,n),r&&e!==q&&ie(q,t,r)}:ie,fe=function(e,t){var n=le[e]=k($);return _(n,{type:Y,tag:e,description:t}),u||(n.description=t),n},ve=function(e,t,n){e===q&&ve(ce,t,n),x(e);var r=B(t);return x(n),d(le,r)?(n.enumerable?(d(e,V)&&e[V][r]&&(e[V][r]=!1),n=k(n,{enumerable:S(0,!1)})):(d(e,V)||ie(e,V,S(1,{})),e[V][r]=!0),ge(e,r,n)):ie(e,r,n)},me=function(e,t){x(e);var n=w(t),r=L(n).concat(we(n));return K(r,(function(t){u&&!s(ye,n,t)||ve(e,t,n[t])})),e},ye=function(e){var t=B(e),n=s(oe,this,t);return!(this===q&&d(le,t)&&!d(ce,t))&&(!(n||!d(this,t)||!d(le,t)||d(this,V)&&this[V][t])||n)},xe=function(e,t){var n=w(e),r=B(t);if(n!==q||!d(le,r)||d(ce,r)){var i=re(n,r);return!i||!d(le,r)||d(n,V)&&n[V][r]||(i.enumerable=!0),i}},be=function(e){var t=ae(w(e)),n=[];return K(t,(function(e){d(le,e)||d(j,e)||se(n,e)})),n},we=function(e){var t=e===q,n=ae(t?ce:w(e)),r=[];return K(n,(function(e){!d(le,e)||t&&!d(q,e)||se(r,le[e])})),r};(h||(Z=function(){if(m($,this))throw ee("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?C(arguments[0]):void 0,t=z(e),n=function(e){this===q&&s(n,ce,e),d(this,V)&&d(this[V],t)&&(this[V][t]=!1),ge(this,t,S(1,e))};return u&&de&&ge(q,t,{configurable:!0,set:n}),fe(t,e)},D($=Z.prototype,"toString",(function(){return Q(this).tag})),D(Z,"withoutSetter",(function(e){return fe(z(e),e)})),O.f=ye,M.f=ve,R.f=me,E.f=xe,A.f=T.f=be,I.f=we,U.f=function(e){return fe(H(e),e)},u&&(ie($,"description",{configurable:!0,get:function(){return Q(this).description}}),c||D(q,"propertyIsEnumerable",ye,{unsafe:!0}))),n({global:!0,wrap:!0,forced:!h,sham:!h},{Symbol:Z}),K(L(pe),(function(e){X(e)})),n({target:Y,stat:!0,forced:!h},{for:function(e){var t=C(e);if(d(ue,t))return ue[t];var n=Z(t);return ue[t]=n,he[n]=t,n},keyFor:function(e){if(!y(e))throw ee(e+" is not a symbol");if(d(he,e))return he[e]},useSetter:function(){de=!0},useSimple:function(){de=!1}}),n({target:"Object",stat:!0,forced:!h,sham:!u},{create:function(e,t){return void 0===t?k(e):me(k(e),t)},defineProperty:ve,defineProperties:me,getOwnPropertyDescriptor:xe}),n({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:be,getOwnPropertySymbols:we}),n({target:"Object",stat:!0,forced:p((function(){I.f(1)}))},{getOwnPropertySymbols:function(e){return I.f(b(e))}}),ne)&&n({target:"JSON",stat:!0,forced:!h||p((function(){var e=Z();return"[null]"!=ne([e])||"{}"!=ne({a:e})||"{}"!=ne(Object(e))}))},{stringify:function(e,t,n){var r=P(arguments),i=t;if((v(t)||void 0!==e)&&!y(e))return g(t)||(t=function(e,t){if(f(i)&&(t=s(i,this,e,t)),!y(t))return t}),r[1]=t,o(ne,null,r)}});if(!$[J]){var Be=$.valueOf;D($,J,(function(e){return s(Be,this)}))}F(Z,Y),j[V]=!0})),r.register("JGbI2",(function(e,t){var n=r("4gaLD"),i=r("6LGrQ"),a=r("l0gwz").f,o=r("8ihId"),s=r("8Opqg"),l=r("7eUfi"),c=r("jzDTf"),u=r("iTHz4");e.exports=function(e,t){var r,h,p,d,g,f=e.target,v=e.global,m=e.stat;if(r=v?i:m?i[f]||l(f,{}):(i[f]||{}).prototype)for(h in t){if(d=t[h],p=e.noTargetGet?(g=a(r,h))&&g.value:r[h],!u(v?h:f+(m?".":"#")+h,e.forced)&&void 0!==p){if((void 0===d?"undefined":n.typeOf(d))==(void 0===p?"undefined":n.typeOf(p)))continue;c(d,p)}(e.sham||p&&p.sham)&&o(d,"sham",!0),s(r,h,d,e)}}})),r.register("6LGrQ",(function(e,t){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n&&n)||function(){return this}()||Function("return this")()})),r.register("l0gwz",(function(e,n){var i;t(e.exports,"f",(function(){return i}),(function(e){return i=e}));var a=r("A56Kx"),o=r("9ZRgk"),s=r("7wvbV"),l=r("eqpEX"),c=r("hAcvu"),u=r("hvgHk"),h=r("1JB0D"),p=r("k9fAW"),d=Object.getOwnPropertyDescriptor;i=a?d:function(e,t){if(e=c(e),t=u(t),p)try{return d(e,t)}catch(e){}if(h(e,t))return l(!o(s.f,e,t),e[t])}})),r.register("A56Kx",(function(e,t){var n=r("6WghJ");e.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))})),r.register("6WghJ",(function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}})),r.register("9ZRgk",(function(e,t){var n=r("10M9V"),i=Function.prototype.call;e.exports=n?i.bind(i):function(){return i.apply(i,arguments)}})),r.register("10M9V",(function(e,t){var n=r("6WghJ");e.exports=!n((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))})),r.register("7wvbV",(function(e,n){var r;t(e.exports,"f",(function(){return r}),(function(e){return r=e}));var i={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,o=a&&!i.call({1:2},1);r=o?function(e){var t=a(this,e);return!!t&&t.enumerable}:i})),r.register("eqpEX",(function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}})),r.register("hAcvu",(function(e,t){var n=r("atLuV"),i=r("0dsEW");e.exports=function(e){return n(i(e))}})),r.register("atLuV",(function(e,t){var n=r("6LGrQ"),i=r("2x0T1"),a=r("6WghJ"),o=r("lrHHl"),s=n.Object,l=i("".split);e.exports=a((function(){return!s("z").propertyIsEnumerable(0)}))?function(e){return"String"==o(e)?l(e,""):s(e)}:s})),r.register("2x0T1",(function(e,t){var n=r("10M9V"),i=Function.prototype,a=i.bind,o=i.call,s=n&&a.bind(o,o);e.exports=n?function(e){return e&&s(e)}:function(e){return e&&function(){return o.apply(e,arguments)}}})),r.register("lrHHl",(function(e,t){var n=r("2x0T1"),i=n({}.toString),a=n("".slice);e.exports=function(e){return a(i(e),8,-1)}})),r.register("0dsEW",(function(e,t){var n=r("6LGrQ").TypeError;e.exports=function(e){if(null==e)throw n("Can't call method on "+e);return e}})),r.register("hvgHk",(function(e,t){var n=r("ePlFm"),i=r("fcVIX");e.exports=function(e){var t=n(e,"string");return i(t)?t:t+""}})),r.register("ePlFm",(function(e,t){var n=r("6LGrQ"),i=r("9ZRgk"),a=r("gczVK"),o=r("fcVIX"),s=r("3Xhmk"),l=r("a2dhY"),c=r("8RiFY"),u=n.TypeError,h=c("toPrimitive");e.exports=function(e,t){if(!a(e)||o(e))return e;var n,r=s(e,h);if(r){if(void 0===t&&(t="default"),n=i(r,e,t),!a(n)||o(n))return n;throw u("Can't convert object to primitive value")}return void 0===t&&(t="number"),l(e,t)}})),r.register("gczVK",(function(e,t){var n=r("3HoBU");e.exports=function(e){return"object"==typeof e?null!==e:n(e)}})),r.register("3HoBU",(function(e,t){e.exports=function(e){return"function"==typeof e}})),r.register("fcVIX",(function(e,t){var n=r("4gaLD"),i=r("6LGrQ"),a=r("fdCuf"),o=r("3HoBU"),s=r("c9sXY"),l=r("e4Dh9"),c=i.Object;e.exports=l?function(e){return"symbol"==(void 0===e?"undefined":n.typeOf(e))}:function(e){var t=a("Symbol");return o(t)&&s(t.prototype,c(e))}})),r.register("fdCuf",(function(e,t){var n=r("6LGrQ"),i=r("3HoBU"),a=function(e){return i(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?a(n[e]):n[e]&&n[e][t]}})),r.register("c9sXY",(function(e,t){var n=r("2x0T1");e.exports=n({}.isPrototypeOf)})),r.register("e4Dh9",(function(e,t){var n=r("4gaLD"),i=r("OTdcX");e.exports=i&&!Symbol.sham&&"symbol"==n.typeOf(Symbol.iterator)})),r.register("OTdcX",(function(e,t){var n=r("ipWH0"),i=r("6WghJ");e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41}))})),r.register("ipWH0",(function(e,t){var n,i,a=r("6LGrQ"),o=r("2F7Zt"),s=a.process,l=a.Deno,c=s&&s.versions||l&&l.version,u=c&&c.v8;u&&(i=(n=u.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!i&&o&&(!(n=o.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=o.match(/Chrome\/(\d+)/))&&(i=+n[1]),e.exports=i})),r.register("2F7Zt",(function(e,t){var n=r("fdCuf");e.exports=n("navigator","userAgent")||""})),r.register("3Xhmk",(function(e,t){var n=r("lEpkd");e.exports=function(e,t){var r=e[t];return null==r?void 0:n(r)}})),r.register("lEpkd",(function(e,t){var n=r("6LGrQ"),i=r("3HoBU"),a=r("dth1M"),o=n.TypeError;e.exports=function(e){if(i(e))return e;throw o(a(e)+" is not a function")}})),r.register("dth1M",(function(e,t){var n=r("6LGrQ").String;e.exports=function(e){try{return n(e)}catch(e){return"Object"}}})),r.register("a2dhY",(function(e,t){var n=r("6LGrQ"),i=r("9ZRgk"),a=r("3HoBU"),o=r("gczVK"),s=n.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&a(n=e.toString)&&!o(r=i(n,e)))return r;if(a(n=e.valueOf)&&!o(r=i(n,e)))return r;if("string"!==t&&a(n=e.toString)&&!o(r=i(n,e)))return r;throw s("Can't convert object to primitive value")}})),r.register("8RiFY",(function(e,t){var n=r("6LGrQ"),i=r("eW5R0"),a=r("1JB0D"),o=r("VN1JY"),s=r("OTdcX"),l=r("e4Dh9"),c=i("wks"),u=n.Symbol,h=u&&u.for,p=l?u:u&&u.withoutSetter||o;e.exports=function(e){if(!a(c,e)||!s&&"string"!=typeof c[e]){var t="Symbol."+e;s&&a(u,e)?c[e]=u[e]:c[e]=l&&h?h(t):p(t)}return c[e]}})),r.register("eW5R0",(function(e,t){var n=r("bMhTS"),i=r("gt9ls");(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.3",mode:n?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"})})),r.register("bMhTS",(function(e,t){e.exports=!1})),r.register("gt9ls",(function(e,t){var n=r("6LGrQ"),i=r("7eUfi"),a="__core-js_shared__",o=n["__core-js_shared__"]||i(a,{});e.exports=o})),r.register("7eUfi",(function(e,t){var n=r("6LGrQ"),i=Object.defineProperty;e.exports=function(e,t){try{i(n,e,{value:t,configurable:!0,writable:!0})}catch(r){n[e]=t}return t}})),r.register("1JB0D",(function(e,t){var n=r("2x0T1"),i=r("falgx"),a=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return a(i(e),t)}})),r.register("falgx",(function(e,t){var n=r("6LGrQ"),i=r("0dsEW"),a=n.Object;e.exports=function(e){return a(i(e))}})),r.register("VN1JY",(function(e,t){var n=r("2x0T1"),i=0,a=Math.random(),o=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+o(++i+a,36)}})),r.register("k9fAW",(function(e,t){var n=r("A56Kx"),i=r("6WghJ"),a=r("ckGOu");e.exports=!n&&!i((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))})),r.register("ckGOu",(function(e,t){var n=r("6LGrQ"),i=r("gczVK"),a=n.document,o=i(a)&&i(a.createElement);e.exports=function(e){return o?a.createElement(e):{}}})),r.register("8ihId",(function(e,t){var n=r("A56Kx"),i=r("bLi0c"),a=r("eqpEX");e.exports=n?function(e,t,n){return i.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}})),r.register("bLi0c",(function(e,n){var i;t(e.exports,"f",(function(){return i}),(function(e){return i=e}));var a=r("6LGrQ"),o=r("A56Kx"),s=r("k9fAW"),l=r("8U1TM"),c=r("edAQb"),u=r("hvgHk"),h=a.TypeError,p=Object.defineProperty,d=Object.getOwnPropertyDescriptor,g="enumerable",f="configurable",v="writable";i=o?l?function(e,t,n){if(c(e),t=u(t),c(n),"function"==typeof e&&"prototype"===t&&"value"in n&&v in n&&!n.writable){var r=d(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:f in n?n.configurable:r.configurable,enumerable:g in n?n.enumerable:r.enumerable,writable:!1})}return p(e,t,n)}:p:function(e,t,n){if(c(e),t=u(t),c(n),s)try{return p(e,t,n)}catch(e){}if("get"in n||"set"in n)throw h("Accessors not supported");return"value"in n&&(e[t]=n.value),e}})),r.register("8U1TM",(function(e,t){var n=r("A56Kx"),i=r("6WghJ");e.exports=n&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))})),r.register("edAQb",(function(e,t){var n=r("6LGrQ"),i=r("gczVK"),a=n.String,o=n.TypeError;e.exports=function(e){if(i(e))return e;throw o(a(e)+" is not an object")}})),r.register("8Opqg",(function(e,t){var n=r("6LGrQ"),i=r("3HoBU"),a=r("1JB0D"),o=r("8ihId"),s=r("7eUfi"),l=r("3jbTY"),c=r("jUSxl"),u=r("ce4aN").CONFIGURABLE,h=c.get,p=c.enforce,d=String(String).split("String");(e.exports=function(e,t,r,l){var c,h=!!l&&!!l.unsafe,g=!!l&&!!l.enumerable,f=!!l&&!!l.noTargetGet,v=l&&void 0!==l.name?l.name:t;i(r)&&("Symbol("===String(v).slice(0,7)&&(v="["+String(v).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!a(r,"name")||u&&r.name!==v)&&o(r,"name",v),(c=p(r)).source||(c.source=d.join("string"==typeof v?v:""))),e!==n?(h?!f&&e[t]&&(g=!0):delete e[t],g?e[t]=r:o(e,t,r)):g?e[t]=r:s(t,r)})(Function.prototype,"toString",(function(){return i(this)&&h(this).source||l(this)}))})),r.register("3jbTY",(function(e,t){var n=r("2x0T1"),i=r("3HoBU"),a=r("gt9ls"),o=n(Function.toString);i(a.inspectSource)||(a.inspectSource=function(e){return o(e)}),e.exports=a.inspectSource})),r.register("jUSxl",(function(e,t){var n,i,a,o=r("g10oc"),s=r("6LGrQ"),l=r("2x0T1"),c=r("gczVK"),u=r("8ihId"),h=r("1JB0D"),p=r("gt9ls"),d=r("7Sc7b"),g=r("8OCuI"),f="Object already initialized",v=s.TypeError,m=s.WeakMap;if(o||p.state){var y=p.state||(p.state=new m),x=l(y.get),b=l(y.has),w=l(y.set);n=function(e,t){if(b(y,e))throw new v(f);return t.facade=e,w(y,e,t),t},i=function(e){return x(y,e)||{}},a=function(e){return b(y,e)}}else{var B=d("state");g[B]=!0,n=function(e,t){if(h(e,B))throw new v(f);return t.facade=e,u(e,B,t),t},i=function(e){return h(e,B)?e[B]:{}},a=function(e){return h(e,B)}}e.exports={set:n,get:i,has:a,enforce:function(e){return a(e)?i(e):n(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw v("Incompatible receiver, "+e+" required");return n}}}})),r.register("g10oc",(function(e,t){var n=r("6LGrQ"),i=r("3HoBU"),a=r("3jbTY"),o=n.WeakMap;e.exports=i(o)&&/native code/.test(a(o))})),r.register("7Sc7b",(function(e,t){var n=r("eW5R0"),i=r("VN1JY"),a=n("keys");e.exports=function(e){return a[e]||(a[e]=i(e))}})),r.register("8OCuI",(function(e,t){e.exports={}})),r.register("ce4aN",(function(e,t){var n=r("A56Kx"),i=r("1JB0D"),a=Function.prototype,o=n&&Object.getOwnPropertyDescriptor,s=i(a,"name"),l=s&&"something"===function(){}.name,c=s&&(!n||n&&o(a,"name").configurable);e.exports={EXISTS:s,PROPER:l,CONFIGURABLE:c}})),r.register("jzDTf",(function(e,t){var n=r("1JB0D"),i=r("6qoE5"),a=r("l0gwz"),o=r("bLi0c");e.exports=function(e,t,r){for(var s=i(t),l=o.f,c=a.f,u=0;u<s.length;u++){var h=s[u];n(e,h)||r&&n(r,h)||l(e,h,c(t,h))}}})),r.register("6qoE5",(function(e,t){var n=r("fdCuf"),i=r("2x0T1"),a=r("9hrSE"),o=r("b9pdI"),s=r("edAQb"),l=i([].concat);e.exports=n("Reflect","ownKeys")||function(e){var t=a.f(s(e)),n=o.f;return n?l(t,n(e)):t}})),r.register("9hrSE",(function(e,n){var i;t(e.exports,"f",(function(){return i}),(function(e){return i=e}));var a=r("19Y1f"),o=r("hwdBV").concat("length","prototype");i=Object.getOwnPropertyNames||function(e){return a(e,o)}})),r.register("19Y1f",(function(e,t){var n=r("2x0T1"),i=r("1JB0D"),a=r("hAcvu"),o=r("lCEDd").indexOf,s=r("8OCuI"),l=n([].push);e.exports=function(e,t){var n,r=a(e),c=0,u=[];for(n in r)!i(s,n)&&i(r,n)&&l(u,n);for(;t.length>c;)i(r,n=t[c++])&&(~o(u,n)||l(u,n));return u}})),r.register("lCEDd",(function(e,t){var n=r("hAcvu"),i=r("8BhlN"),a=r("9u6Bu"),o=function(e){return function(t,r,o){var s,l=n(t),c=a(l),u=i(o,c);if(e&&r!=r){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===r)return e||u||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}})),r.register("8BhlN",(function(e,t){var n=r("3Hjrl"),i=Math.max,a=Math.min;e.exports=function(e,t){var r=n(e);return r<0?i(r+t,0):a(r,t)}})),r.register("3Hjrl",(function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){var t=+e;return t!=t||0===t?0:(t>0?r:n)(t)}})),r.register("9u6Bu",(function(e,t){var n=r("k8phS");e.exports=function(e){return n(e.length)}})),r.register("k8phS",(function(e,t){var n=r("3Hjrl"),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}})),r.register("hwdBV",(function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]})),r.register("b9pdI",(function(e,n){var r;t(e.exports,"f",(function(){return r}),(function(e){return r=e})),r=Object.getOwnPropertySymbols})),r.register("iTHz4",(function(e,t){var n=r("6WghJ"),i=r("3HoBU"),a=/#|\.prototype\./,o=function(e,t){var r=l[s(e)];return r==u||r!=c&&(i(t)?n(t):!!t)},s=o.normalize=function(e){return String(e).replace(a,".").toLowerCase()},l=o.data={},c=o.NATIVE="N",u=o.POLYFILL="P";e.exports=o})),r.register("cn22k",(function(e,t){var n=r("10M9V"),i=Function.prototype,a=i.apply,o=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(n?o.bind(a):function(){return o.apply(a,arguments)})})),r.register("gVpis",(function(e,t){var n=r("lrHHl");e.exports=Array.isArray||function(e){return"Array"==n(e)}})),r.register("eXtvS",(function(e,t){var n=r("6LGrQ"),i=r("cKQyt"),a=n.String;e.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return a(e)}})),r.register("cKQyt",(function(e,t){var n=r("6LGrQ"),i=r("kDzjR"),a=r("3HoBU"),o=r("lrHHl"),s=r("8RiFY")("toStringTag"),l=n.Object,c="Arguments"==o(function(){return arguments}());e.exports=i?o:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=l(e),s))?n:c?o(t):"Object"==(r=o(t))&&a(t.callee)?"Arguments":r}})),r.register("kDzjR",(function(e,t){var n={};n[r("8RiFY")("toStringTag")]="z",e.exports="[object z]"===String(n)})),r.register("KFLt0",(function(e,t){var n,i=r("edAQb"),a=r("jDguE"),o=r("hwdBV"),s=r("8OCuI"),l=r("25rlX"),c=r("ckGOu"),u=r("7Sc7b"),h=u("IE_PROTO"),p=function(){},d=function(e){return"<script>"+e+"</"+"script>"},g=function(e){e.write(d("")),e.close();var t=e.parentWindow.Object;return e=null,t},f=function(){try{n=new ActiveXObject("htmlfile")}catch(e){}var e,t;f="undefined"!=typeof document?document.domain&&n?g(n):((t=c("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(d("document.F=Object")),e.close(),e.F):g(n);for(var r=o.length;r--;)delete f.prototype[o[r]];return f()};s[h]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(p.prototype=i(e),n=new p,p.prototype=null,n[h]=e):n=f(),void 0===t?n:a.f(n,t)}})),r.register("jDguE",(function(e,n){var i;t(e.exports,"f",(function(){return i}),(function(e){return i=e}));var a=r("A56Kx"),o=r("8U1TM"),s=r("bLi0c"),l=r("edAQb"),c=r("hAcvu"),u=r("8xgUB");i=a&&!o?Object.defineProperties:function(e,t){l(e);for(var n,r=c(t),i=u(t),a=i.length,o=0;a>o;)s.f(e,n=i[o++],r[n]);return e}})),r.register("8xgUB",(function(e,t){var n=r("19Y1f"),i=r("hwdBV");e.exports=Object.keys||function(e){return n(e,i)}})),r.register("25rlX",(function(e,t){var n=r("fdCuf");e.exports=n("document","documentElement")})),r.register("8Ybf3",(function(e,n){var i;t(e.exports,"f",(function(){return i}),(function(e){return i=e}));var a=r("lrHHl"),o=r("hAcvu"),s=r("9hrSE").f,l=r("b4zeJ"),c="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];i=function(e){return c&&"Window"==a(e)?function(e){try{return s(e)}catch(e){return l(c)}}(e):s(o(e))}})),r.register("b4zeJ",(function(e,t){var n=r("6LGrQ"),i=r("8BhlN"),a=r("9u6Bu"),o=r("9MkWL"),s=n.Array,l=Math.max;e.exports=function(e,t,n){for(var r=a(e),c=i(t,r),u=i(void 0===n?r:n,r),h=s(l(u-c,0)),p=0;c<u;c++,p++)o(h,p,e[c]);return h.length=p,h}})),r.register("9MkWL",(function(e,t){"use strict";var n=r("hvgHk"),i=r("bLi0c"),a=r("eqpEX");e.exports=function(e,t,r){var o=n(t);o in e?i.f(e,o,a(0,r)):e[o]=r}})),r.register("1fDSm",(function(e,t){var n=r("2x0T1");e.exports=n([].slice)})),r.register("btl60",(function(e,n){var i;t(e.exports,"f",(function(){return i}),(function(e){return i=e}));var a=r("8RiFY");i=a})),r.register("aUpwE",(function(e,t){var n=r("lEmA0"),i=r("1JB0D"),a=r("btl60"),o=r("bLi0c").f;e.exports=function(e){var t=n.Symbol||(n.Symbol={});i(t,e)||o(t,e,{value:a.f(e)})}})),r.register("lEmA0",(function(e,t){var n=r("6LGrQ");e.exports=n})),r.register("9Ebr8",(function(e,t){var n=r("bLi0c").f,i=r("1JB0D"),a=r("8RiFY")("toStringTag");e.exports=function(e,t,r){e&&!r&&(e=e.prototype),e&&!i(e,a)&&n(e,a,{configurable:!0,value:t})}})),r.register("9otZn",(function(e,t){var n=r("gAXAR"),i=r("2x0T1"),a=r("atLuV"),o=r("falgx"),s=r("9u6Bu"),l=r("ab5jG"),c=i([].push),u=function(e){var t=1==e,r=2==e,i=3==e,u=4==e,h=6==e,p=7==e,d=5==e||h;return function(g,f,v,m){for(var y,x,b=o(g),w=a(b),B=n(f,v),C=s(w),S=0,k=m||l,L=t?k(g,C):r||p?k(g,0):void 0;C>S;S++)if((d||S in w)&&(x=B(y=w[S],S,b),e))if(t)L[S]=x;else if(x)switch(e){case 3:return!0;case 5:return y;case 6:return S;case 2:c(L,y)}else switch(e){case 4:return!1;case 7:c(L,y)}return h?-1:i||u?u:L}};e.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}})),r.register("gAXAR",(function(e,t){var n=r("2x0T1"),i=r("lEpkd"),a=r("10M9V"),o=n(n.bind);e.exports=function(e,t){return i(e),void 0===t?e:a?o(e,t):function(){return e.apply(t,arguments)}}})),r.register("ab5jG",(function(e,t){var n=r("kMN3P");e.exports=function(e,t){return new(n(e))(0===t?0:t)}})),r.register("kMN3P",(function(e,t){var n=r("6LGrQ"),i=r("gVpis"),a=r("iHD1w"),o=r("gczVK"),s=r("8RiFY")("species"),l=n.Array;e.exports=function(e){var t;return i(e)&&(t=e.constructor,(a(t)&&(t===l||i(t.prototype))||o(t)&&null===(t=t[s]))&&(t=void 0)),void 0===t?l:t}})),r.register("iHD1w",(function(e,t){var n=r("2x0T1"),i=r("6WghJ"),a=r("3HoBU"),o=r("cKQyt"),s=r("fdCuf"),l=r("3jbTY"),c=function(){},u=[],h=s("Reflect","construct"),p=/^\s*(?:class|function)\b/,d=n(p.exec),g=!p.exec(c),f=function(e){if(!a(e))return!1;try{return h(c,u,e),!0}catch(e){return!1}},v=function(e){if(!a(e))return!1;switch(o(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return g||!!d(p,l(e))}catch(e){return!0}};v.sham=!0,e.exports=!h||i((function(){var e;return f(f.call)||!f(Object)||!f((function(){e=!0}))||e}))?v:f})),r.register("cNeLG",(function(e,t){"use strict";var n=r("JGbI2"),i=r("A56Kx"),a=r("6LGrQ"),o=r("2x0T1"),s=r("1JB0D"),l=r("3HoBU"),c=r("c9sXY"),u=r("eXtvS"),h=r("bLi0c").f,p=r("jzDTf"),d=a.Symbol,g=d&&d.prototype;if(i&&l(d)&&(!("description"in g)||void 0!==d().description)){var f={},v=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:u(arguments[0]),t=c(g,this)?new d(e):void 0===e?d():d(e);return""===e&&(f[t]=!0),t};p(v,d),v.prototype=g,g.constructor=v;var m="Symbol(test)"==String(d("test")),y=o(g.toString),x=o(g.valueOf),b=/^Symbol\((.*)\)[^)]+$/,w=o("".replace),B=o("".slice);h(g,"description",{configurable:!0,get:function(){var e=x(this),t=y(e);if(s(f,e))return"";var n=m?B(t,7,-1):w(t,b,"$1");return""===n?void 0:n}}),n({global:!0,forced:!0},{Symbol:v})}})),r.register("dpoWh",(function(e,t){r("aUpwE")("asyncIterator")})),r.register("gGP1V",(function(e,t){r("aUpwE")("hasInstance")})),r.register("jO3cy",(function(e,t){r("aUpwE")("isConcatSpreadable")})),r.register("ffj4s",(function(e,t){r("aUpwE")("iterator")})),r.register("ddY2J",(function(e,t){r("aUpwE")("match")})),r.register("fOfIC",(function(e,t){r("aUpwE")("replace")})),r.register("cfF7p",(function(e,t){r("aUpwE")("search")})),r.register("4ekSO",(function(e,t){r("aUpwE")("species")})),r.register("fqkQP",(function(e,t){r("aUpwE")("split")})),r.register("kv3nX",(function(e,t){r("aUpwE")("toPrimitive")})),r.register("fRxWg",(function(e,t){r("aUpwE")("toStringTag")})),r.register("38lxR",(function(e,t){r("aUpwE")("unscopables")})),r.register("Apmcd",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("6WghJ"),o=r("gVpis"),s=r("gczVK"),l=r("falgx"),c=r("9u6Bu"),u=r("9MkWL"),h=r("ab5jG"),p=r("4SJPo"),d=r("8RiFY"),g=r("ipWH0"),f=d("isConcatSpreadable"),v=9007199254740991,m="Maximum allowed index exceeded",y=i.TypeError,x=g>=51||!a((function(){var e=[];return e[f]=!1,e.concat()[0]!==e})),b=p("concat"),w=function(e){if(!s(e))return!1;var t=e[f];return void 0!==t?!!t:o(e)};n({target:"Array",proto:!0,forced:!x||!b},{concat:function(e){var t,n,r,i,a,o=l(this),s=h(o,0),p=0;for(t=-1,r=arguments.length;t<r;t++)if(w(a=-1===t?o:arguments[t])){if(p+(i=c(a))>v)throw y(m);for(n=0;n<i;n++,p++)n in a&&u(s,p,a[n])}else{if(p>=v)throw y(m);u(s,p++,a)}return s.length=p,s}})})),r.register("4SJPo",(function(e,t){var n=r("6WghJ"),i=r("8RiFY"),a=r("ipWH0"),o=i("species");e.exports=function(e){return a>=51||!n((function(){var t=[];return(t.constructor={})[o]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}})),r.register("MEgGa",(function(e,t){var n=r("JGbI2"),i=r("04UlN"),a=r("d9AHO");n({target:"Array",proto:!0},{copyWithin:i}),a("copyWithin")})),r.register("04UlN",(function(e,t){"use strict";var n=r("falgx"),i=r("8BhlN"),a=r("9u6Bu"),o=Math.min;e.exports=[].copyWithin||function(e,t){var r=n(this),s=a(r),l=i(e,s),c=i(t,s),u=arguments.length>2?arguments[2]:void 0,h=o((void 0===u?s:i(u,s))-c,s-l),p=1;for(c<l&&l<c+h&&(p=-1,c+=h-1,l+=h-1);h-- >0;)c in r?r[l]=r[c]:delete r[l],l+=p,c+=p;return r}})),r.register("d9AHO",(function(e,t){var n=r("8RiFY"),i=r("KFLt0"),a=r("bLi0c"),o=n("unscopables"),s=Array.prototype;null==s[o]&&a.f(s,o,{configurable:!0,value:i(null)}),e.exports=function(e){s[o][e]=!0}})),r.register("2xn0i",(function(e,t){var n=r("JGbI2"),i=r("5QjeM"),a=r("d9AHO");n({target:"Array",proto:!0},{fill:i}),a("fill")})),r.register("5QjeM",(function(e,t){"use strict";var n=r("falgx"),i=r("8BhlN"),a=r("9u6Bu");e.exports=function(e){for(var t=n(this),r=a(t),o=arguments.length,s=i(o>1?arguments[1]:void 0,r),l=o>2?arguments[2]:void 0,c=void 0===l?r:i(l,r);c>s;)t[s++]=e;return t}})),r.register("j4lAT",(function(e,t){"use strict";var n=r("JGbI2"),i=r("9otZn").filter;n({target:"Array",proto:!0,forced:!r("4SJPo")("filter")},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})})),r.register("i8szt",(function(e,t){"use strict";var n=r("JGbI2"),i=r("9otZn").find,a=r("d9AHO"),o="find",s=!0;o in[]&&Array(1).find((function(){s=!1})),n({target:"Array",proto:!0,forced:s},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a(o)})),r.register("5eAxt",(function(e,t){"use strict";var n=r("JGbI2"),i=r("9otZn").findIndex,a=r("d9AHO"),o="findIndex",s=!0;o in[]&&Array(1).findIndex((function(){s=!1})),n({target:"Array",proto:!0,forced:s},{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a(o)})),r.register("cgkH9",(function(e,t){"use strict";var n=r("JGbI2"),i=r("3GD8y"),a=r("falgx"),o=r("9u6Bu"),s=r("3Hjrl"),l=r("ab5jG");n({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=a(this),n=o(t),r=l(t,0);return r.length=i(r,t,t,n,0,void 0===e?1:s(e)),r}})})),r.register("3GD8y",(function(e,t){"use strict";var n=r("6LGrQ"),i=r("gVpis"),a=r("9u6Bu"),o=r("gAXAR"),s=n.TypeError,l=function(e,t,n,r,c,u,h,p){for(var d,g,f=c,v=0,m=!!h&&o(h,p);v<r;){if(v in n){if(d=m?m(n[v],v,t):n[v],u>0&&i(d))g=a(d),f=l(e,t,d,g,f,u-1)-1;else{if(f>=9007199254740991)throw s("Exceed the acceptable array length");e[f]=d}f++}v++}return f};e.exports=l})),r.register("j06La",(function(e,t){"use strict";var n=r("JGbI2"),i=r("3GD8y"),a=r("lEpkd"),o=r("falgx"),s=r("9u6Bu"),l=r("ab5jG");n({target:"Array",proto:!0},{flatMap:function(e){var t,n=o(this),r=s(n);return a(e),(t=l(n,0)).length=i(t,n,n,r,0,1,e,arguments.length>1?arguments[1]:void 0),t}})})),r.register("5IsCk",(function(e,t){var n=r("JGbI2"),i=r("jvovY");n({target:"Array",stat:!0,forced:!r("dNJyV")((function(e){Array.from(e)}))},{from:i})})),r.register("jvovY",(function(e,t){"use strict";var n=r("6LGrQ"),i=r("gAXAR"),a=r("9ZRgk"),o=r("falgx"),s=r("9XuUh"),l=r("9WXOl"),c=r("iHD1w"),u=r("9u6Bu"),h=r("9MkWL"),p=r("g3ZOP"),d=r("aCNH3"),g=n.Array;e.exports=function(e){var t=o(e),n=c(this),r=arguments.length,f=r>1?arguments[1]:void 0,v=void 0!==f;v&&(f=i(f,r>2?arguments[2]:void 0));var m,y,x,b,w,B,C=d(t),S=0;if(!C||this==g&&l(C))for(m=u(t),y=n?new this(m):g(m);m>S;S++)B=v?f(t[S],S):t[S],h(y,S,B);else for(w=(b=p(t,C)).next,y=n?new this:[];!(x=a(w,b)).done;S++)B=v?s(b,f,[x.value,S],!0):x.value,h(y,S,B);return y.length=S,y}})),r.register("9XuUh",(function(e,t){var n=r("edAQb"),i=r("eYYfs");e.exports=function(e,t,r,a){try{return a?t(n(r)[0],r[1]):t(r)}catch(t){i(e,"throw",t)}}})),r.register("eYYfs",(function(e,t){var n=r("9ZRgk"),i=r("edAQb"),a=r("3Xhmk");e.exports=function(e,t,r){var o,s;i(e);try{if(!(o=a(e,"return"))){if("throw"===t)throw r;return r}o=n(o,e)}catch(e){s=!0,o=e}if("throw"===t)throw r;if(s)throw o;return i(o),r}})),r.register("9WXOl",(function(e,t){var n=r("8RiFY"),i=r("csbVC"),a=n("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[a]===e)}})),r.register("csbVC",(function(e,t){e.exports={}})),r.register("g3ZOP",(function(e,t){var n=r("6LGrQ"),i=r("9ZRgk"),a=r("lEpkd"),o=r("edAQb"),s=r("dth1M"),l=r("aCNH3"),c=n.TypeError;e.exports=function(e,t){var n=arguments.length<2?l(e):t;if(a(n))return o(i(n,e));throw c(s(e)+" is not iterable")}})),r.register("aCNH3",(function(e,t){var n=r("cKQyt"),i=r("3Xhmk"),a=r("csbVC"),o=r("8RiFY")("iterator");e.exports=function(e){if(null!=e)return i(e,o)||i(e,"@@iterator")||a[n(e)]}})),r.register("dNJyV",(function(e,t){var n=r("8RiFY")("iterator"),i=!1;try{var a=0,o={next:function(){return{done:!!a++}},return:function(){i=!0}};o[n]=function(){return this},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var a={};a[n]=function(){return{next:function(){return{done:r=!0}}}},e(a)}catch(e){}return r}})),r.register("6yG0j",(function(e,t){"use strict";var n=r("JGbI2"),i=r("lCEDd").includes,a=r("d9AHO");n({target:"Array",proto:!0},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")})),r.register("7SrKm",(function(e,t){"use strict";var n=r("JGbI2"),i=r("2x0T1"),a=r("lCEDd").indexOf,o=r("orWZn"),s=i([].indexOf),l=!!s&&1/s([1],1,-0)<0,c=o("indexOf");n({target:"Array",proto:!0,forced:l||!c},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return l?s(this,e,t)||0:a(this,e,t)}})})),r.register("orWZn",(function(e,t){"use strict";var n=r("6WghJ");e.exports=function(e,t){var r=[][e];return!!r&&n((function(){r.call(null,t||function(){throw 1},1)}))}})),r.register("l4lCC",(function(e,t){"use strict";var n=r("hAcvu"),i=r("d9AHO"),a=r("csbVC"),o=r("jUSxl"),s=r("bLi0c").f,l=r("A0wh1"),c=r("bMhTS"),u=r("A56Kx"),h="Array Iterator",p=o.set,d=o.getterFor(h);e.exports=l(Array,"Array",(function(e,t){p(this,{type:h,target:n(e),index:0,kind:t})}),(function(){var e=d(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");var g=a.Arguments=a.Array;if(i("keys"),i("values"),i("entries"),!c&&u&&"values"!==g.name)try{s(g,"name",{value:"values"})}catch(e){}})),r.register("A0wh1",(function(e,t){"use strict";var n=r("JGbI2"),i=r("9ZRgk"),a=r("bMhTS"),o=r("ce4aN"),s=r("3HoBU"),l=r("bGPs6"),c=r("f4X4V"),u=r("4HLYu"),h=r("9Ebr8"),p=r("8ihId"),d=r("8Opqg"),g=r("8RiFY"),f=r("csbVC"),v=r("aGk5W"),m=o.PROPER,y=o.CONFIGURABLE,x=v.IteratorPrototype,b=v.BUGGY_SAFARI_ITERATORS,w=g("iterator"),B="keys",C="values",S="entries",k=function(){return this};e.exports=function(e,t,r,o,g,v,L){l(r,t,o);var A,T,I,E=function(e){if(e===g&&D)return D;if(!b&&e in O)return O[e];switch(e){case B:case C:case S:return function(){return new r(this,e)}}return function(){return new r(this)}},M=t+" Iterator",R=!1,O=e.prototype,P=O[w]||O["@@iterator"]||g&&O[g],D=!b&&P||E(g),G="Array"==t&&O.entries||P;if(G&&(A=c(G.call(new e)))!==Object.prototype&&A.next&&(a||c(A)===x||(u?u(A,x):s(A[w])||d(A,w,k)),h(A,M,!0,!0),a&&(f[M]=k)),m&&g==C&&P&&P.name!==C&&(!a&&y?p(O,"name",C):(R=!0,D=function(){return i(P,this)})),g)if(T={values:E(C),keys:v?D:E(B),entries:E(S)},L)for(I in T)(b||R||!(I in O))&&d(O,I,T[I]);else n({target:t,proto:!0,forced:b||R},T);return a&&!L||O[w]===D||d(O,w,D,{name:g}),f[t]=D,T}})),r.register("bGPs6",(function(e,t){"use strict";var n=r("aGk5W").IteratorPrototype,i=r("KFLt0"),a=r("eqpEX"),o=r("9Ebr8"),s=r("csbVC"),l=function(){return this};e.exports=function(e,t,r,c){var u=t+" Iterator";return e.prototype=i(n,{next:a(+!c,r)}),o(e,u,!1,!0),s[u]=l,e}})),r.register("aGk5W",(function(e,t){"use strict";var n,i,a,o=r("6WghJ"),s=r("3HoBU"),l=r("KFLt0"),c=r("f4X4V"),u=r("8Opqg"),h=r("8RiFY"),p=r("bMhTS"),d=h("iterator"),g=!1;[].keys&&("next"in(a=[].keys())?(i=c(c(a)))!==Object.prototype&&(n=i):g=!0),null==n||o((function(){var e={};return n[d].call(e)!==e}))?n={}:p&&(n=l(n)),s(n[d])||u(n,d,(function(){return this})),e.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:g}})),r.register("f4X4V",(function(e,t){var n=r("6LGrQ"),i=r("1JB0D"),a=r("3HoBU"),o=r("falgx"),s=r("7Sc7b"),l=r("khrDL"),c=s("IE_PROTO"),u=n.Object,h=u.prototype;e.exports=l?u.getPrototypeOf:function(e){var t=o(e);if(i(t,c))return t[c];var n=t.constructor;return a(n)&&t instanceof n?n.prototype:t instanceof u?h:null}})),r.register("khrDL",(function(e,t){var n=r("6WghJ");e.exports=!n((function(){var e=function(){};return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))})),r.register("4HLYu",(function(e,t){var n=r("2x0T1"),i=r("edAQb"),a=r("iHaUn");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=n(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),t=r instanceof Array}catch(e){}return function(n,r){return i(n),a(r),t?e(n,r):n.__proto__=r,n}}():void 0)})),r.register("iHaUn",(function(e,t){var n=r("6LGrQ"),i=r("3HoBU"),a=n.String,o=n.TypeError;e.exports=function(e){if("object"==typeof e||i(e))return e;throw o("Can't set "+a(e)+" as a prototype")}})),r.register("g9bVW",(function(e,t){"use strict";var n=r("JGbI2"),i=r("2x0T1"),a=r("atLuV"),o=r("hAcvu"),s=r("orWZn"),l=i([].join),c=a!=Object,u=s("join",",");n({target:"Array",proto:!0,forced:c||!u},{join:function(e){return l(o(this),void 0===e?",":e)}})})),r.register("fpgtw",(function(e,t){var n=r("JGbI2"),i=r("hYbqA");n({target:"Array",proto:!0,forced:i!==[].lastIndexOf},{lastIndexOf:i})})),r.register("hYbqA",(function(e,t){"use strict";var n=r("cn22k"),i=r("hAcvu"),a=r("3Hjrl"),o=r("9u6Bu"),s=r("orWZn"),l=Math.min,c=[].lastIndexOf,u=!!c&&1/[1].lastIndexOf(1,-0)<0,h=s("lastIndexOf"),p=u||!h;e.exports=p?function(e){if(u)return n(c,this,arguments)||0;var t=i(this),r=o(t),s=r-1;for(arguments.length>1&&(s=l(s,a(arguments[1]))),s<0&&(s=r+s);s>=0;s--)if(s in t&&t[s]===e)return s||0;return-1}:c})),r.register("ezT59",(function(e,t){"use strict";var n=r("JGbI2"),i=r("9otZn").map;n({target:"Array",proto:!0,forced:!r("4SJPo")("map")},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})})),r.register("f6hx0",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("6WghJ"),o=r("iHD1w"),s=r("9MkWL"),l=i.Array;n({target:"Array",stat:!0,forced:a((function(){var e=function(){};return!(l.of.call(e)instanceof e)}))},{of:function(){for(var e=0,t=arguments.length,n=new(o(this)?this:l)(t);t>e;)s(n,e,arguments[e++]);return n.length=t,n}})})),r.register("aiC3N",(function(e,t){"use strict";var n=r("JGbI2"),i=r("ah1Ob").left,a=r("orWZn"),o=r("ipWH0"),s=r("bVA4J");n({target:"Array",proto:!0,forced:!a("reduce")||!s&&o>79&&o<83},{reduce:function(e){var t=arguments.length;return i(this,e,t,t>1?arguments[1]:void 0)}})})),r.register("ah1Ob",(function(e,t){var n=r("6LGrQ"),i=r("lEpkd"),a=r("falgx"),o=r("atLuV"),s=r("9u6Bu"),l=n.TypeError,c=function(e){return function(t,n,r,c){i(n);var u=a(t),h=o(u),p=s(u),d=e?p-1:0,g=e?-1:1;if(r<2)for(;;){if(d in h){c=h[d],d+=g;break}if(d+=g,e?d<0:p<=d)throw l("Reduce of empty array with no initial value")}for(;e?d>=0:p>d;d+=g)d in h&&(c=n(c,h[d],d,u));return c}};e.exports={left:c(!1),right:c(!0)}})),r.register("bVA4J",(function(e,t){var n=r("lrHHl"),i=r("6LGrQ");e.exports="process"==n(i.process)})),r.register("cekHE",(function(e,t){"use strict";var n=r("JGbI2"),i=r("ah1Ob").right,a=r("orWZn"),o=r("ipWH0"),s=r("bVA4J");n({target:"Array",proto:!0,forced:!a("reduceRight")||!s&&o>79&&o<83},{reduceRight:function(e){return i(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})})),r.register("h3f4c",(function(e,t){"use strict";var n=r("JGbI2"),i=r("2x0T1"),a=r("gVpis"),o=i([].reverse),s=[1,2];n({target:"Array",proto:!0,forced:String(s)===String(s.reverse())},{reverse:function(){return a(this)&&(this.length=this.length),o(this)}})})),r.register("k803i",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("gVpis"),o=r("iHD1w"),s=r("gczVK"),l=r("8BhlN"),c=r("9u6Bu"),u=r("hAcvu"),h=r("9MkWL"),p=r("8RiFY"),d=r("4SJPo"),g=r("1fDSm"),f=d("slice"),v=p("species"),m=i.Array,y=Math.max;n({target:"Array",proto:!0,forced:!f},{slice:function(e,t){var n,r,i,p=u(this),d=c(p),f=l(e,d),x=l(void 0===t?d:t,d);if(a(p)&&(n=p.constructor,(o(n)&&(n===m||a(n.prototype))||s(n)&&null===(n=n[v]))&&(n=void 0),n===m||void 0===n))return g(p,f,x);for(r=new(void 0===n?m:n)(y(x-f,0)),i=0;f<x;f++,i++)f in p&&h(r,i,p[f]);return r.length=i,r}})})),r.register("9pmMz",(function(e,t){"use strict";var n=r("JGbI2"),i=r("2x0T1"),a=r("lEpkd"),o=r("falgx"),s=r("9u6Bu"),l=r("eXtvS"),c=r("6WghJ"),u=r("c3NuZ"),h=r("orWZn"),p=r("efWWg"),d=r("gucwG"),g=r("ipWH0"),f=r("3M0bw"),v=[],m=i(v.sort),y=i(v.push),x=c((function(){v.sort(void 0)})),b=c((function(){v.sort(null)})),w=h("sort"),B=!c((function(){if(g)return g<70;if(!(p&&p>3)){if(d)return!0;if(f)return f<603;var e,t,n,r,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)v.push({k:t+r,v:n})}for(v.sort((function(e,t){return t.v-e.v})),r=0;r<v.length;r++)t=v[r].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}}));n({target:"Array",proto:!0,forced:x||!b||!w||!B},{sort:function(e){void 0!==e&&a(e);var t=o(this);if(B)return void 0===e?m(t):m(t,e);var n,r,i=[],c=s(t);for(r=0;r<c;r++)r in t&&y(i,t[r]);for(u(i,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:l(t)>l(n)?1:-1}}(e)),n=i.length,r=0;r<n;)t[r]=i[r++];for(;r<c;)delete t[r++];return t}})})),r.register("c3NuZ",(function(e,t){var n=r("b4zeJ"),i=Math.floor,a=function(e,t){var r=e.length,l=i(r/2);return r<8?o(e,t):s(e,a(n(e,0,l),t),a(n(e,l),t),t)},o=function(e,t){for(var n,r,i=e.length,a=1;a<i;){for(r=a,n=e[a];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==a++&&(e[r]=n)}return e},s=function(e,t,n,r){for(var i=t.length,a=n.length,o=0,s=0;o<i||s<a;)e[o+s]=o<i&&s<a?r(t[o],n[s])<=0?t[o++]:n[s++]:o<i?t[o++]:n[s++];return e};e.exports=a})),r.register("efWWg",(function(e,t){var n=r("2F7Zt").match(/firefox\/(\d+)/i);e.exports=!!n&&+n[1]})),r.register("gucwG",(function(e,t){var n=r("2F7Zt");e.exports=/MSIE|Trident/.test(n)})),r.register("3M0bw",(function(e,t){var n=r("2F7Zt").match(/AppleWebKit\/(\d+)\./);e.exports=!!n&&+n[1]})),r.register("2M9cA",(function(e,t){r("b5zq9")("Array")})),r.register("b5zq9",(function(e,t){"use strict";var n=r("fdCuf"),i=r("bLi0c"),a=r("8RiFY"),o=r("A56Kx"),s=a("species");e.exports=function(e){var t=n(e),r=i.f;o&&t&&!t[s]&&r(t,s,{configurable:!0,get:function(){return this}})}})),r.register("cMF3x",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("8BhlN"),o=r("3Hjrl"),s=r("9u6Bu"),l=r("falgx"),c=r("ab5jG"),u=r("9MkWL"),h=r("4SJPo")("splice"),p=i.TypeError,d=Math.max,g=Math.min,f=9007199254740991,v="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!h},{splice:function(e,t){var n,r,i,h,m,y,x=l(this),b=s(x),w=a(e,b),B=arguments.length;if(0===B?n=r=0:1===B?(n=0,r=b-w):(n=B-2,r=g(d(o(t),0),b-w)),b+n-r>f)throw p(v);for(i=c(x,r),h=0;h<r;h++)(m=w+h)in x&&u(i,h,x[m]);if(i.length=r,n<r){for(h=w;h<b-r;h++)y=h+n,(m=h+r)in x?x[y]=x[m]:delete x[y];for(h=b;h>b-r+n;h--)delete x[h-1]}else if(n>r)for(h=b-r;h>w;h--)y=h+n-1,(m=h+r-1)in x?x[y]=x[m]:delete x[y];for(h=0;h<n;h++)x[h+w]=arguments[h+2];return x.length=b-r+n,i}})})),r.register("fcsxt",(function(e,t){r("d9AHO")("flat")})),r.register("27Hw3",(function(e,t){r("d9AHO")("flatMap")})),r.register("f1ng1",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("h6ot1"),o=r("b5zq9"),s="ArrayBuffer",l=a.ArrayBuffer;n({global:!0,forced:i.ArrayBuffer!==l},{ArrayBuffer:l}),o(s)})),r.register("h6ot1",(function(e,t){"use strict";var n=r("6LGrQ"),i=r("2x0T1"),a=r("A56Kx"),o=r("7jUo8"),s=r("ce4aN"),l=r("8ihId"),c=r("g2jnF"),u=r("6WghJ"),h=r("lIgln"),p=r("3Hjrl"),d=r("k8phS"),g=r("75wCi"),f=r("4JHSt"),v=r("f4X4V"),m=r("4HLYu"),y=r("9hrSE").f,x=r("bLi0c").f,b=r("5QjeM"),w=r("b4zeJ"),B=r("9Ebr8"),C=r("jUSxl"),S=s.PROPER,k=s.CONFIGURABLE,L=C.get,A=C.set,T="ArrayBuffer",I="DataView",E="Wrong index",M=n.ArrayBuffer,R=M,O=R&&R.prototype,P=n.DataView,D=P&&P.prototype,G=Object.prototype,N=n.Array,j=n.RangeError,z=i(b),H=i([].reverse),U=f.pack,X=f.unpack,F=function(e){return[255&e]},W=function(e){return[255&e,e>>8&255]},K=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},V=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},Y=function(e){return U(e,23,4)},J=function(e){return U(e,52,8)},_=function(e,t){x(e.prototype,t,{get:function(){return L(this)[t]}})},Q=function(e,t,n,r){var i=g(n),a=L(e);if(i+t>a.byteLength)throw j(E);var o=L(a.buffer).bytes,s=i+a.byteOffset,l=w(o,s,s+t);return r?l:H(l)},q=function(e,t,n,r,i,a){var o=g(n),s=L(e);if(o+t>s.byteLength)throw j(E);for(var l=L(s.buffer).bytes,c=o+s.byteOffset,u=r(+i),h=0;h<t;h++)l[c+h]=u[a?h:t-h-1]};if(o){var Z=S&&M.name!==T;if(u((function(){M(1)}))&&u((function(){new M(-1)}))&&!u((function(){return new M,new M(1.5),new M(NaN),Z&&!k})))Z&&k&&l(M,"name",T);else{(R=function(e){return h(this,O),new M(g(e))}).prototype=O;for(var $,ee=y(M),te=0;ee.length>te;)($=ee[te++])in R||l(R,$,M[$]);O.constructor=R}m&&v(D)!==G&&m(D,G);var ne=new P(new R(2)),re=i(D.setInt8);ne.setInt8(0,2147483648),ne.setInt8(1,2147483649),!ne.getInt8(0)&&ne.getInt8(1)||c(D,{setInt8:function(e,t){re(this,e,t<<24>>24)},setUint8:function(e,t){re(this,e,t<<24>>24)}},{unsafe:!0})}else O=(R=function(e){h(this,O);var t=g(e);A(this,{bytes:z(N(t),0),byteLength:t}),a||(this.byteLength=t)}).prototype,D=(P=function(e,t,n){h(this,D),h(e,O);var r=L(e).byteLength,i=p(t);if(i<0||i>r)throw j("Wrong offset");if(i+(n=void 0===n?r-i:d(n))>r)throw j("Wrong length");A(this,{buffer:e,byteLength:n,byteOffset:i}),a||(this.buffer=e,this.byteLength=n,this.byteOffset=i)}).prototype,a&&(_(R,"byteLength"),_(P,"buffer"),_(P,"byteLength"),_(P,"byteOffset")),c(D,{getInt8:function(e){return Q(this,1,e)[0]<<24>>24},getUint8:function(e){return Q(this,1,e)[0]},getInt16:function(e){var t=Q(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=Q(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return V(Q(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return V(Q(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return X(Q(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return X(Q(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){q(this,1,e,F,t)},setUint8:function(e,t){q(this,1,e,F,t)},setInt16:function(e,t){q(this,2,e,W,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){q(this,2,e,W,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){q(this,4,e,K,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){q(this,4,e,K,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){q(this,4,e,Y,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){q(this,8,e,J,t,arguments.length>2?arguments[2]:void 0)}});B(R,T),B(P,I),e.exports={ArrayBuffer:R,DataView:P}})),r.register("7jUo8",(function(e,t){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView})),r.register("g2jnF",(function(e,t){var n=r("8Opqg");e.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}})),r.register("lIgln",(function(e,t){var n=r("6LGrQ"),i=r("c9sXY"),a=n.TypeError;e.exports=function(e,t){if(i(t,e))return e;throw a("Incorrect invocation")}})),r.register("75wCi",(function(e,t){var n=r("6LGrQ"),i=r("3Hjrl"),a=r("k8phS"),o=n.RangeError;e.exports=function(e){if(void 0===e)return 0;var t=i(e),n=a(t);if(t!==n)throw o("Wrong length or index");return n}})),r.register("4JHSt",(function(e,t){var n=r("6LGrQ").Array,i=Math.abs,a=Math.pow,o=Math.floor,s=Math.log,l=Math.LN2;e.exports={pack:function(e,t,r){var c,u,h,p=n(r),d=8*r-t-1,g=(1<<d)-1,f=g>>1,v=23===t?a(2,-24)-a(2,-77):0,m=e<0||0===e&&1/e<0?1:0,y=0;for((e=i(e))!=e||e===1/0?(u=e!=e?1:0,c=g):(c=o(s(e)/l),e*(h=a(2,-c))<1&&(c--,h*=2),(e+=c+f>=1?v/h:v*a(2,1-f))*h>=2&&(c++,h/=2),c+f>=g?(u=0,c=g):c+f>=1?(u=(e*h-1)*a(2,t),c+=f):(u=e*a(2,f-1)*a(2,t),c=0));t>=8;)p[y++]=255&u,u/=256,t-=8;for(c=c<<t|u,d+=t;d>0;)p[y++]=255&c,c/=256,d-=8;return p[--y]|=128*m,p},unpack:function(e,t){var n,r=e.length,i=8*r-t-1,o=(1<<i)-1,s=o>>1,l=i-7,c=r-1,u=e[c--],h=127&u;for(u>>=7;l>0;)h=256*h+e[c--],l-=8;for(n=h&(1<<-l)-1,h>>=-l,l+=t;l>0;)n=256*n+e[c--],l-=8;if(0===h)h=1-s;else{if(h===o)return n?NaN:u?-1/0:1/0;n+=a(2,t),h-=s}return(u?-1:1)*n*a(2,h-t)}}})),r.register("hnS4i",(function(e,t){"use strict";var n=r("JGbI2"),i=r("2x0T1"),a=r("6WghJ"),o=r("h6ot1"),s=r("edAQb"),l=r("8BhlN"),c=r("k8phS"),u=r("4xaB6"),h=o.ArrayBuffer,p=o.DataView,d=p.prototype,g=i(h.prototype.slice),f=i(d.getUint8),v=i(d.setUint8);n({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:a((function(){return!new h(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(g&&void 0===t)return g(s(this),e);for(var n=s(this).byteLength,r=l(e,n),i=l(void 0===t?n:t,n),a=new(u(this,h))(c(i-r)),o=new p(this),d=new p(a),m=0;r<i;)v(d,m++,f(o,r++));return a}})})),r.register("4xaB6",(function(e,t){var n=r("edAQb"),i=r("3Z9Nz"),a=r("8RiFY")("species");e.exports=function(e,t){var r,o=n(e).constructor;return void 0===o||null==(r=n(o)[a])?t:i(r)}})),r.register("3Z9Nz",(function(e,t){var n=r("6LGrQ"),i=r("iHD1w"),a=r("dth1M"),o=n.TypeError;e.exports=function(e){if(i(e))return e;throw o(a(e)+" is not a constructor")}})),r.register("41rO8",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6WghJ"),a=r("falgx"),o=r("ePlFm");n({target:"Date",proto:!0,forced:i((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}))},{toJSON:function(e){var t=a(this),n=o(t,"number");return"number"!=typeof n||isFinite(n)?t.toISOString():null}})})),r.register("87a88",(function(e,t){var n=r("1JB0D"),i=r("8Opqg"),a=r("heBc3"),o=r("8RiFY")("toPrimitive"),s=Date.prototype;n(s,o)||i(s,o,a)})),r.register("heBc3",(function(e,t){"use strict";var n=r("6LGrQ"),i=r("edAQb"),a=r("a2dhY"),o=n.TypeError;e.exports=function(e){if(i(this),"string"===e||"default"===e)e="string";else if("number"!==e)throw o("Incorrect hint");return a(this,e)}})),r.register("9zshv",(function(e,t){"use strict";var n=r("3HoBU"),i=r("gczVK"),a=r("bLi0c"),o=r("f4X4V"),s=r("8RiFY")("hasInstance"),l=Function.prototype;s in l||a.f(l,s,{value:function(e){if(!n(this)||!i(e))return!1;var t=this.prototype;if(!i(t))return e instanceof this;for(;e=o(e);)if(t===e)return!0;return!1}})})),r.register("gfSHW",(function(e,t){var n=r("A56Kx"),i=r("ce4aN").EXISTS,a=r("2x0T1"),o=r("bLi0c").f,s=Function.prototype,l=a(s.toString),c=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=a(c.exec);n&&!i&&o(s,"name",{configurable:!0,get:function(){try{return u(c,l(this))[1]}catch(e){return""}}})})),r.register("kC6Os",(function(e,t){var n=r("6LGrQ");r("9Ebr8")(n.JSON,"JSON",!0)})),r.register("99yfV",(function(e,t){"use strict";r("6P8eJ")("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r("gVyws"))})),r.register("6P8eJ",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("2x0T1"),o=r("iTHz4"),s=r("8Opqg"),l=r("7ahyY"),c=r("d8pty"),u=r("lIgln"),h=r("3HoBU"),p=r("gczVK"),d=r("6WghJ"),g=r("dNJyV"),f=r("9Ebr8"),v=r("4nT4Z");e.exports=function(e,t,r){var m=-1!==e.indexOf("Map"),y=-1!==e.indexOf("Weak"),x=m?"set":"add",b=i[e],w=b&&b.prototype,B=b,C={},S=function(e){var t=a(w[e]);s(w,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(y&&!p(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return y&&!p(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(y&&!p(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})};if(o(e,!h(b)||!(y||w.forEach&&!d((function(){(new b).entries().next()})))))B=r.getConstructor(t,e,m,x),l.enable();else if(o(e,!0)){var k=new B,L=k[x](y?{}:-0,1)!=k,A=d((function(){k.has(1)})),T=g((function(e){new b(e)})),I=!y&&d((function(){for(var e=new b,t=5;t--;)e[x](t,t);return!e.has(-0)}));T||((B=t((function(e,t){u(e,w);var n=v(new b,e,B);return null!=t&&c(t,n[x],{that:n,AS_ENTRIES:m}),n}))).prototype=w,w.constructor=B),(A||I)&&(S("delete"),S("has"),m&&S("get")),(I||L)&&S(x),y&&w.clear&&delete w.clear}return C[e]=B,n({global:!0,forced:B!=b},C),f(B,e),y||r.setStrong(B,e,m),B}})),r.register("7ahyY",(function(e,t){var n=r("4gaLD"),i=r("JGbI2"),a=r("2x0T1"),o=r("8OCuI"),s=r("gczVK"),l=r("1JB0D"),c=r("bLi0c").f,u=r("9hrSE"),h=r("8Ybf3"),p=r("kneZa"),d=r("VN1JY"),g=r("6jxZs"),f=!1,v=d("meta"),m=0,y=function(e){c(e,v,{value:{objectID:"O"+m++,weakData:{}}})},x=e.exports={enable:function(){x.enable=function(){},f=!0;var e=u.f,t=a([].splice),n={};n[v]=1,e(n).length&&(u.f=function(n){for(var r=e(n),i=0,a=r.length;i<a;i++)if(r[i]===v){t(r,i,1);break}return r},i({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:h.f}))},fastKey:function(e,t){if(!s(e))return"symbol"==(void 0===e?"undefined":n.typeOf(e))?e:("string"==typeof e?"S":"P")+e;if(!l(e,v)){if(!p(e))return"F";if(!t)return"E";y(e)}return e[v].objectID},getWeakData:function(e,t){if(!l(e,v)){if(!p(e))return!0;if(!t)return!1;y(e)}return e[v].weakData},onFreeze:function(e){return g&&f&&p(e)&&!l(e,v)&&y(e),e}};o[v]=!0})),r.register("kneZa",(function(e,t){var n=r("6WghJ"),i=r("gczVK"),a=r("lrHHl"),o=r("8Chxf"),s=Object.isExtensible,l=n((function(){s(1)}));e.exports=l||o?function(e){return!!i(e)&&((!o||"ArrayBuffer"!=a(e))&&(!s||s(e)))}:s})),r.register("8Chxf",(function(e,t){var n=r("6WghJ");e.exports=n((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))})),r.register("6jxZs",(function(e,t){var n=r("6WghJ");e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))})),r.register("d8pty",(function(e,t){var n=r("6LGrQ"),i=r("gAXAR"),a=r("9ZRgk"),o=r("edAQb"),s=r("dth1M"),l=r("9WXOl"),c=r("9u6Bu"),u=r("c9sXY"),h=r("g3ZOP"),p=r("aCNH3"),d=r("eYYfs"),g=n.TypeError,f=function(e,t){this.stopped=e,this.result=t},v=f.prototype;e.exports=function(e,t,n){var r,m,y,x,b,w,B,C=n&&n.that,S=!(!n||!n.AS_ENTRIES),k=!(!n||!n.IS_ITERATOR),L=!(!n||!n.INTERRUPTED),A=i(t,C),T=function(e){return r&&d(r,"normal",e),new f(!0,e)},I=function(e){return S?(o(e),L?A(e[0],e[1],T):A(e[0],e[1])):L?A(e,T):A(e)};if(k)r=e;else{if(!(m=p(e)))throw g(s(e)+" is not iterable");if(l(m)){for(y=0,x=c(e);x>y;y++)if((b=I(e[y]))&&u(v,b))return b;return new f(!1)}r=h(e,m)}for(w=r.next;!(B=a(w,r)).done;){try{b=I(B.value)}catch(e){d(r,"throw",e)}if("object"==typeof b&&b&&u(v,b))return b}return new f(!1)}})),r.register("4nT4Z",(function(e,t){var n=r("3HoBU"),i=r("gczVK"),a=r("4HLYu");e.exports=function(e,t,r){var o,s;return a&&n(o=t.constructor)&&o!==r&&i(s=o.prototype)&&s!==r.prototype&&a(e,s),e}})),r.register("gVyws",(function(e,t){"use strict";var n=r("bLi0c").f,i=r("KFLt0"),a=r("g2jnF"),o=r("gAXAR"),s=r("lIgln"),l=r("d8pty"),c=r("A0wh1"),u=r("b5zq9"),h=r("A56Kx"),p=r("7ahyY").fastKey,d=r("jUSxl"),g=d.set,f=d.getterFor;e.exports={getConstructor:function(e,t,r,c){var u=e((function(e,n){s(e,d),g(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),h||(e.size=0),null!=n&&l(n,e[c],{that:e,AS_ENTRIES:r})})),d=u.prototype,v=f(t),m=function(e,t,n){var r,i,a=v(e),o=y(e,t);return o?o.value=n:(a.last=o={index:i=p(t,!0),key:t,value:n,previous:r=a.last,next:void 0,removed:!1},a.first||(a.first=o),r&&(r.next=o),h?a.size++:e.size++,"F"!==i&&(a.index[i]=o)),e},y=function(e,t){var n,r=v(e),i=p(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return a(d,{clear:function(){for(var e=v(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,h?e.size=0:this.size=0},delete:function(e){var t=this,n=v(t),r=y(t,e);if(r){var i=r.next,a=r.previous;delete n.index[r.index],r.removed=!0,a&&(a.next=i),i&&(i.previous=a),n.first==r&&(n.first=i),n.last==r&&(n.last=a),h?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=v(this),r=o(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!y(this,e)}}),a(d,r?{get:function(e){var t=y(this,e);return t&&t.value},set:function(e,t){return m(this,0===e?0:e,t)}}:{add:function(e){return m(this,e=0===e?0:e,e)}}),h&&n(d,"size",{get:function(){return v(this).size}}),u},setStrong:function(e,t,n){var r=t+" Iterator",i=f(t),a=f(r);c(e,t,(function(e,t){g(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=a(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),u(t)}}})),r.register("j4Oqh",(function(e,t){var n=r("JGbI2"),i=r("dVGex"),a=Math.acosh,o=Math.log,s=Math.sqrt,l=Math.LN2;n({target:"Math",stat:!0,forced:!a||710!=Math.floor(a(Number.MAX_VALUE))||a(1/0)!=1/0},{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?o(e)+l:i(e-1+s(e-1)*s(e+1))}})})),r.register("dVGex",(function(e,t){var n=Math.log;e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:n(1+e)}})),r.register("41TXX",(function(e,t){var n=r("JGbI2"),i=Math.asinh,a=Math.log,o=Math.sqrt;n({target:"Math",stat:!0,forced:!(i&&1/i(0)>0)},{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):a(t+o(t*t+1)):t}})})),r.register("71MGB",(function(e,t){var n=r("JGbI2"),i=Math.atanh,a=Math.log;n({target:"Math",stat:!0,forced:!(i&&1/i(-0)<0)},{atanh:function(e){return 0==(e=+e)?e:a((1+e)/(1-e))/2}})})),r.register("bD4J9",(function(e,t){var n=r("JGbI2"),i=r("fAbqV"),a=Math.abs,o=Math.pow;n({target:"Math",stat:!0},{cbrt:function(e){return i(e=+e)*o(a(e),1/3)}})})),r.register("fAbqV",(function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}})),r.register("6DM4t",(function(e,t){var n=r("JGbI2"),i=Math.floor,a=Math.log,o=Math.LOG2E;n({target:"Math",stat:!0},{clz32:function(e){return(e>>>=0)?31-i(a(e+.5)*o):32}})})),r.register("gWrYo",(function(e,t){var n=r("JGbI2"),i=r("aXV8O"),a=Math.cosh,o=Math.abs,s=Math.E;n({target:"Math",stat:!0,forced:!a||a(710)===1/0},{cosh:function(e){var t=i(o(e)-1)+1;return(t+1/(t*s*s))*(s/2)}})})),r.register("aXV8O",(function(e,t){var n=Math.expm1,r=Math.exp;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:r(e)-1}:n})),r.register("kOTv6",(function(e,t){var n=r("JGbI2"),i=r("aXV8O");n({target:"Math",stat:!0,forced:i!=Math.expm1},{expm1:i})})),r.register("hVycJ",(function(e,t){r("JGbI2")({target:"Math",stat:!0},{fround:r("kPZzt")})})),r.register("kPZzt",(function(e,t){var n=r("fAbqV"),i=Math.abs,a=Math.pow,o=a(2,-52),s=a(2,-23),l=a(2,127)*(2-s),c=a(2,-126);e.exports=Math.fround||function(e){var t,r,a=i(e),u=n(e);return a<c?u*(a/c/s+1/o-1/o)*c*s:(r=(t=(1+s/o)*a)-(t-a))>l||r!=r?u*(1/0):u*r}})),r.register("ji6FU",(function(e,t){var n=r("JGbI2"),i=Math.hypot,a=Math.abs,o=Math.sqrt;n({target:"Math",stat:!0,forced:!!i&&i(1/0,NaN)!==1/0},{hypot:function(e,t){for(var n,r,i=0,s=0,l=arguments.length,c=0;s<l;)c<(n=a(arguments[s++]))?(i=i*(r=c/n)*r+1,c=n):i+=n>0?(r=n/c)*r:n;return c===1/0?1/0:c*o(i)}})})),r.register("6eVOU",(function(e,t){var n=r("JGbI2"),i=r("6WghJ"),a=Math.imul;n({target:"Math",stat:!0,forced:i((function(){return-5!=a(4294967295,5)||2!=a.length}))},{imul:function(e,t){var n=65535,r=+e,i=+t,a=n&r,o=n&i;return 0|a*o+((n&r>>>16)*o+a*(n&i>>>16)<<16>>>0)}})})),r.register("4vUKg",(function(e,t){r("JGbI2")({target:"Math",stat:!0},{log10:r("84pAS")})})),r.register("84pAS",(function(e,t){var n=Math.log,r=Math.LOG10E;e.exports=Math.log10||function(e){return n(e)*r}})),r.register("7I91f",(function(e,t){r("JGbI2")({target:"Math",stat:!0},{log1p:r("dVGex")})})),r.register("18VuS",(function(e,t){var n=r("JGbI2"),i=Math.log,a=Math.LN2;n({target:"Math",stat:!0},{log2:function(e){return i(e)/a}})})),r.register("k3QML",(function(e,t){r("JGbI2")({target:"Math",stat:!0},{sign:r("fAbqV")})})),r.register("doMoi",(function(e,t){var n=r("JGbI2"),i=r("6WghJ"),a=r("aXV8O"),o=Math.abs,s=Math.exp,l=Math.E;n({target:"Math",stat:!0,forced:i((function(){return-2e-17!=Math.sinh(-2e-17)}))},{sinh:function(e){return o(e=+e)<1?(a(e)-a(-e))/2:(s(e-1)-s(-e-1))*(l/2)}})})),r.register("gSCyV",(function(e,t){var n=r("JGbI2"),i=r("aXV8O"),a=Math.exp;n({target:"Math",stat:!0},{tanh:function(e){var t=i(e=+e),n=i(-e);return t==1/0?1:n==1/0?-1:(t-n)/(a(e)+a(-e))}})})),r.register("jXFsw",(function(e,t){r("9Ebr8")(Math,"Math",!0)})),r.register("7QBpd",(function(e,t){var n=r("JGbI2"),i=Math.ceil,a=Math.floor;n({target:"Math",stat:!0},{trunc:function(e){return(e>0?a:i)(e)}})})),r.register("f99UO",(function(e,t){var n=r("4gaLD"),i=r("A56Kx"),a=r("6LGrQ"),o=r("2x0T1"),s=r("iTHz4"),l=r("8Opqg"),c=r("1JB0D"),u=r("4nT4Z"),h=r("c9sXY"),p=r("fcVIX"),d=r("ePlFm"),g=r("6WghJ"),f=r("9hrSE").f,v=r("l0gwz").f,m=r("bLi0c").f,y=r("dBMLl"),x=r("cCzE3").trim,b="Number",w=a.Number,B=w.prototype,C=a.TypeError,S=o("".slice),k=o("".charCodeAt),L=function(e){var t=d(e,"number");return"bigint"==(void 0===t?"undefined":n.typeOf(t))?t:A(t)},A=function(e){var t,n,r,i,a,o,s,l,c=d(e,"number");if(p(c))throw C("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=x(c),43===(t=k(c,0))||45===t){if(88===(n=k(c,2))||120===n)return NaN}else if(48===t){switch(k(c,1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+c}for(o=(a=S(c,2)).length,s=0;s<o;s++)if((l=k(a,s))<48||l>i)return NaN;return parseInt(a,r)}return+c};if(s(b,!w(" 0o1")||!w("0b1")||w("+0x1"))){for(var T,I=function(e){var t=arguments.length<1?0:w(L(e)),n=this;return h(B,n)&&g((function(){y(n)}))?u(Object(t),n,I):t},E=i?f(w):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),M=0;E.length>M;M++)c(w,T=E[M])&&!c(I,T)&&m(I,T,v(w,T));I.prototype=B,B.constructor=I,l(a,b,I)}})),r.register("dBMLl",(function(e,t){var n=r("2x0T1");e.exports=n(1..valueOf)})),r.register("cCzE3",(function(e,t){var n=r("2x0T1"),i=r("0dsEW"),a=r("eXtvS"),o=r("eJCyU"),s=n("".replace),l="["+o+"]",c=RegExp("^"+l+l+"*"),u=RegExp(l+l+"*$"),h=function(e){return function(t){var n=a(i(t));return 1&e&&(n=s(n,c,"")),2&e&&(n=s(n,u,"")),n}};e.exports={start:h(1),end:h(2),trim:h(3)}})),r.register("eJCyU",(function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"})),r.register("7fTKa",(function(e,t){r("JGbI2")({target:"Number",stat:!0},{EPSILON:Math.pow(2,-52)})})),r.register("cMc1u",(function(e,t){r("JGbI2")({target:"Number",stat:!0},{isFinite:r("4JrHk")})})),r.register("4JrHk",(function(e,t){var n=r("6LGrQ").isFinite;e.exports=Number.isFinite||function(e){return"number"==typeof e&&n(e)}})),r.register("2nSAm",(function(e,t){r("JGbI2")({target:"Number",stat:!0},{isInteger:r("dXAGN")})})),r.register("dXAGN",(function(e,t){var n=r("gczVK"),i=Math.floor;e.exports=Number.isInteger||function(e){return!n(e)&&isFinite(e)&&i(e)===e}})),r.register("1XKa2",(function(e,t){r("JGbI2")({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})})),r.register("f8KAz",(function(e,t){var n=r("JGbI2"),i=r("dXAGN"),a=Math.abs;n({target:"Number",stat:!0},{isSafeInteger:function(e){return i(e)&&a(e)<=9007199254740991}})})),r.register("5tBkn",(function(e,t){r("JGbI2")({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991})})),r.register("gX5K7",(function(e,t){r("JGbI2")({target:"Number",stat:!0},{MIN_SAFE_INTEGER:-9007199254740991})})),r.register("3V1CB",(function(e,t){var n=r("JGbI2"),i=r("hpuGp");n({target:"Number",stat:!0,forced:Number.parseFloat!=i},{parseFloat:i})})),r.register("hpuGp",(function(e,t){var n=r("6LGrQ"),i=r("6WghJ"),a=r("2x0T1"),o=r("eXtvS"),s=r("cCzE3").trim,l=r("eJCyU"),c=a("".charAt),u=n.parseFloat,h=n.Symbol,p=h&&h.iterator,d=1/u(l+"-0")!=-1/0||p&&!i((function(){u(Object(p))}));e.exports=d?function(e){var t=s(o(e)),n=u(t);return 0===n&&"-"==c(t,0)?-0:n}:u})),r.register("jHxqB",(function(e,t){var n=r("JGbI2"),i=r("9W5cg");n({target:"Number",stat:!0,forced:Number.parseInt!=i},{parseInt:i})})),r.register("9W5cg",(function(e,t){var n=r("6LGrQ"),i=r("6WghJ"),a=r("2x0T1"),o=r("eXtvS"),s=r("cCzE3").trim,l=r("eJCyU"),c=n.parseInt,u=n.Symbol,h=u&&u.iterator,p=/^[+-]?0x/i,d=a(p.exec),g=8!==c(l+"08")||22!==c(l+"0x16")||h&&!i((function(){c(Object(h))}));e.exports=g?function(e,t){var n=s(o(e));return c(n,t>>>0||(d(p,n)?16:10))}:c})),r.register("6HQnJ",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("2x0T1"),o=r("3Hjrl"),s=r("dBMLl"),l=r("kmJfO"),c=r("6WghJ"),u=i.RangeError,h=i.String,p=Math.floor,d=a(l),g=a("".slice),f=a(1..toFixed),v=function(e,t,n){return 0===t?n:t%2==1?v(e,t-1,n*e):v(e*e,t/2,n)},m=function(e,t,n){for(var r=-1,i=n;++r<6;)i+=t*e[r],e[r]=i%1e7,i=p(i/1e7)},y=function(e,t){for(var n=6,r=0;--n>=0;)r+=e[n],e[n]=p(r/t),r=r%t*1e7},x=function(e){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==e[t]){var r=h(e[t]);n=""===n?r:n+d("0",7-r.length)+r}return n};n({target:"Number",proto:!0,forced:c((function(){return"0.000"!==f(8e-5,3)||"1"!==f(.9,0)||"1.25"!==f(1.255,2)||"1000000000000000128"!==f(0xde0b6b3a7640080,0)}))||!c((function(){f({})}))},{toFixed:function(e){var t,n,r,i,a=s(this),l=o(e),c=[0,0,0,0,0,0],p="",f="0";if(l<0||l>20)throw u("Incorrect fraction digits");if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return h(a);if(a<0&&(p="-",a=-a),a>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(a*v(2,69,1))-69)<0?a*v(2,-t,1):a/v(2,t,1),n*=4503599627370496,(t=52-t)>0){for(m(c,0,n),r=l;r>=7;)m(c,1e7,0),r-=7;for(m(c,v(10,r,1),0),r=t-1;r>=23;)y(c,8388608),r-=23;y(c,1<<r),m(c,1,1),y(c,2),f=x(c)}else m(c,0,n),m(c,1<<-t,0),f=x(c)+d("0",l);return f=l>0?p+((i=f.length)<=l?"0."+d("0",l-i)+f:g(f,0,i-l)+"."+g(f,i-l)):p+f}})})),r.register("kmJfO",(function(e,t){"use strict";var n=r("6LGrQ"),i=r("3Hjrl"),a=r("eXtvS"),o=r("0dsEW"),s=n.RangeError;e.exports=function(e){var t=a(o(this)),n="",r=i(e);if(r<0||r==1/0)throw s("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}})),r.register("52o9J",(function(e,t){var n=r("JGbI2"),i=r("lFR0S");n({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})})),r.register("lFR0S",(function(e,t){"use strict";var n=r("A56Kx"),i=r("2x0T1"),a=r("9ZRgk"),o=r("6WghJ"),s=r("8xgUB"),l=r("b9pdI"),c=r("7wvbV"),u=r("falgx"),h=r("atLuV"),p=Object.assign,d=Object.defineProperty,g=i([].concat);e.exports=!p||o((function(){if(n&&1!==p({b:1},p(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol(),i="abcdefghijklmnopqrst";return e[r]=7,i.split("").forEach((function(e){t[e]=e})),7!=p({},e)[r]||s(p({},t)).join("")!=i}))?function(e,t){for(var r=u(e),i=arguments.length,o=1,p=l.f,d=c.f;i>o;)for(var f,v=h(arguments[o++]),m=p?g(s(v),p(v)):s(v),y=m.length,x=0;y>x;)f=m[x++],n&&!a(d,v,f)||(r[f]=v[f]);return r}:p})),r.register("hYUT4",(function(e,t){"use strict";var n=r("JGbI2"),i=r("A56Kx"),a=r("4qt6g"),o=r("lEpkd"),s=r("falgx"),l=r("bLi0c");i&&n({target:"Object",proto:!0,forced:a},{__defineGetter__:function(e,t){l.f(s(this),e,{get:o(t),enumerable:!0,configurable:!0})}})})),r.register("4qt6g",(function(e,t){"use strict";var n=r("bMhTS"),i=r("6LGrQ"),a=r("6WghJ"),o=r("3M0bw");e.exports=n||!a((function(){if(!(o&&o<535)){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete i[e]}}))})),r.register("128AN",(function(e,t){"use strict";var n=r("JGbI2"),i=r("A56Kx"),a=r("4qt6g"),o=r("lEpkd"),s=r("falgx"),l=r("bLi0c");i&&n({target:"Object",proto:!0,forced:a},{__defineSetter__:function(e,t){l.f(s(this),e,{set:o(t),enumerable:!0,configurable:!0})}})})),r.register("lqh52",(function(e,t){var n=r("JGbI2"),i=r("h9C8Y").entries;n({target:"Object",stat:!0},{entries:function(e){return i(e)}})})),r.register("h9C8Y",(function(e,t){var n=r("A56Kx"),i=r("2x0T1"),a=r("8xgUB"),o=r("hAcvu"),s=i(r("7wvbV").f),l=i([].push),c=function(e){return function(t){for(var r,i=o(t),c=a(i),u=c.length,h=0,p=[];u>h;)r=c[h++],n&&!s(i,r)||l(p,e?[r,i[r]]:i[r]);return p}};e.exports={entries:c(!0),values:c(!1)}})),r.register("eWB87",(function(e,t){var n=r("JGbI2"),i=r("6jxZs"),a=r("6WghJ"),o=r("gczVK"),s=r("7ahyY").onFreeze,l=Object.freeze;n({target:"Object",stat:!0,forced:a((function(){l(1)})),sham:!i},{freeze:function(e){return l&&o(e)?l(s(e)):e}})})),r.register("6nBVP",(function(e,t){var n=r("JGbI2"),i=r("d8pty"),a=r("9MkWL");n({target:"Object",stat:!0},{fromEntries:function(e){var t={};return i(e,(function(e,n){a(t,e,n)}),{AS_ENTRIES:!0}),t}})})),r.register("hwwzH",(function(e,t){var n=r("JGbI2"),i=r("6WghJ"),a=r("hAcvu"),o=r("l0gwz").f,s=r("A56Kx"),l=i((function(){o(1)}));n({target:"Object",stat:!0,forced:!s||l,sham:!s},{getOwnPropertyDescriptor:function(e,t){return o(a(e),t)}})})),r.register("ifz5K",(function(e,t){var n=r("JGbI2"),i=r("A56Kx"),a=r("6qoE5"),o=r("hAcvu"),s=r("l0gwz"),l=r("9MkWL");n({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(e){for(var t,n,r=o(e),i=s.f,c=a(r),u={},h=0;c.length>h;)void 0!==(n=i(r,t=c[h++]))&&l(u,t,n);return u}})})),r.register("6a3a7",(function(e,t){var n=r("JGbI2"),i=r("6WghJ"),a=r("8Ybf3").f;n({target:"Object",stat:!0,forced:i((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:a})})),r.register("2OJbv",(function(e,t){var n=r("JGbI2"),i=r("6WghJ"),a=r("falgx"),o=r("f4X4V"),s=r("khrDL");n({target:"Object",stat:!0,forced:i((function(){o(1)})),sham:!s},{getPrototypeOf:function(e){return o(a(e))}})})),r.register("6aMzY",(function(e,t){r("JGbI2")({target:"Object",stat:!0},{is:r("98Orf")})})),r.register("98Orf",(function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),r.register("57aGm",(function(e,t){var n=r("JGbI2"),i=r("kneZa");n({target:"Object",stat:!0,forced:Object.isExtensible!==i},{isExtensible:i})})),r.register("bcN3S",(function(e,t){var n=r("JGbI2"),i=r("6WghJ"),a=r("gczVK"),o=r("lrHHl"),s=r("8Chxf"),l=Object.isFrozen;n({target:"Object",stat:!0,forced:i((function(){l(1)}))||s},{isFrozen:function(e){return!a(e)||(!(!s||"ArrayBuffer"!=o(e))||!!l&&l(e))}})})),r.register("3z252",(function(e,t){var n=r("JGbI2"),i=r("6WghJ"),a=r("gczVK"),o=r("lrHHl"),s=r("8Chxf"),l=Object.isSealed;n({target:"Object",stat:!0,forced:i((function(){l(1)}))||s},{isSealed:function(e){return!a(e)||(!(!s||"ArrayBuffer"!=o(e))||!!l&&l(e))}})})),r.register("1F9oE",(function(e,t){var n=r("JGbI2"),i=r("falgx"),a=r("8xgUB");n({target:"Object",stat:!0,forced:r("6WghJ")((function(){a(1)}))},{keys:function(e){return a(i(e))}})})),r.register("cyKYk",(function(e,t){"use strict";var n=r("JGbI2"),i=r("A56Kx"),a=r("4qt6g"),o=r("falgx"),s=r("hvgHk"),l=r("f4X4V"),c=r("l0gwz").f;i&&n({target:"Object",proto:!0,forced:a},{__lookupGetter__:function(e){var t,n=o(this),r=s(e);do{if(t=c(n,r))return t.get}while(n=l(n))}})})),r.register("5IT6w",(function(e,t){"use strict";var n=r("JGbI2"),i=r("A56Kx"),a=r("4qt6g"),o=r("falgx"),s=r("hvgHk"),l=r("f4X4V"),c=r("l0gwz").f;i&&n({target:"Object",proto:!0,forced:a},{__lookupSetter__:function(e){var t,n=o(this),r=s(e);do{if(t=c(n,r))return t.set}while(n=l(n))}})})),r.register("3iS5X",(function(e,t){var n=r("JGbI2"),i=r("gczVK"),a=r("7ahyY").onFreeze,o=r("6jxZs"),s=r("6WghJ"),l=Object.preventExtensions;n({target:"Object",stat:!0,forced:s((function(){l(1)})),sham:!o},{preventExtensions:function(e){return l&&i(e)?l(a(e)):e}})})),r.register("jrROT",(function(e,t){var n=r("JGbI2"),i=r("gczVK"),a=r("7ahyY").onFreeze,o=r("6jxZs"),s=r("6WghJ"),l=Object.seal;n({target:"Object",stat:!0,forced:s((function(){l(1)})),sham:!o},{seal:function(e){return l&&i(e)?l(a(e)):e}})})),r.register("bmHGB",(function(e,t){r("JGbI2")({target:"Object",stat:!0},{setPrototypeOf:r("4HLYu")})})),r.register("erIvV",(function(e,t){var n=r("kDzjR"),i=r("8Opqg"),a=r("j9rDg");n||i(Object.prototype,"toString",a,{unsafe:!0})})),r.register("j9rDg",(function(e,t){"use strict";var n=r("kDzjR"),i=r("cKQyt");e.exports=n?{}.toString:function(){return"[object "+i(this)+"]"}})),r.register("9HPWw",(function(e,t){var n=r("JGbI2"),i=r("h9C8Y").values;n({target:"Object",stat:!0},{values:function(e){return i(e)}})})),r.register("22L4D",(function(e,t){var n=r("JGbI2"),i=r("hpuGp");n({global:!0,forced:parseFloat!=i},{parseFloat:i})})),r.register("9OU4N",(function(e,t){var n=r("JGbI2"),i=r("9W5cg");n({global:!0,forced:parseInt!=i},{parseInt:i})})),r.register("l8Guq",(function(e,t){"use strict";var n,i,a,o,s=r("JGbI2"),l=r("bMhTS"),c=r("6LGrQ"),u=r("fdCuf"),h=r("9ZRgk"),p=r("dH9yW"),d=r("8Opqg"),g=r("g2jnF"),f=r("4HLYu"),v=r("9Ebr8"),m=r("b5zq9"),y=r("lEpkd"),x=r("3HoBU"),b=r("gczVK"),w=r("lIgln"),B=r("3jbTY"),C=r("d8pty"),S=r("dNJyV"),k=r("4xaB6"),L=r("4sgQc").set,A=r("cqo3L"),T=r("jb14y"),I=r("46Eeh"),E=r("4l0Z8"),M=r("emrW7"),R=r("c6xXQ"),O=r("jUSxl"),P=r("iTHz4"),D=r("8RiFY"),G=r("5qUSX"),N=r("bVA4J"),j=r("ipWH0"),z=D("species"),H="Promise",U=O.getterFor(H),X=O.set,F=O.getterFor(H),W=p&&p.prototype,K=p,V=W,Y=c.TypeError,J=c.document,_=c.process,Q=E.f,q=Q,Z=!!(J&&J.createEvent&&c.dispatchEvent),$=x(c.PromiseRejectionEvent),ee="unhandledrejection",te=!1,ne=P(H,(function(){var e=B(K),t=e!==String(K);if(!t&&66===j)return!0;if(l&&!V.finally)return!0;if(j>=51&&/native code/.test(e))return!1;var n=new K((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[z]=r,!(te=n.then((function(){}))instanceof r)||!t&&G&&!$})),re=ne||!S((function(e){K.all(e).catch((function(){}))})),ie=function(e){var t;return!(!b(e)||!x(t=e.then))&&t},ae=function(e,t){var n,r,i,a=t.value,o=1==t.state,s=o?e.ok:e.fail,l=e.resolve,c=e.reject,u=e.domain;try{s?(o||(2===t.rejection&&ue(t),t.rejection=1),!0===s?n=a:(u&&u.enter(),n=s(a),u&&(u.exit(),i=!0)),n===e.promise?c(Y("Promise-chain cycle")):(r=ie(n))?h(r,n,l,c):l(n)):c(a)}catch(e){u&&!i&&u.exit(),c(e)}},oe=function(e,t){e.notified||(e.notified=!0,A((function(){for(var n,r=e.reactions;n=r.get();)ae(n,e);e.notified=!1,t&&!e.rejection&&le(e)})))},se=function(e,t,n){var r,i;Z?((r=J.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),c.dispatchEvent(r)):r={promise:t,reason:n},!$&&(i=c["on"+e])?i(r):e===ee&&I("Unhandled promise rejection",n)},le=function(e){h(L,c,(function(){var t,n=e.facade,r=e.value;if(ce(e)&&(t=M((function(){N?_.emit("unhandledRejection",r,n):se(ee,n,r)})),e.rejection=N||ce(e)?2:1,t.error))throw t.value}))},ce=function(e){return 1!==e.rejection&&!e.parent},ue=function(e){h(L,c,(function(){var t=e.facade;N?_.emit("rejectionHandled",t):se("rejectionhandled",t,e.value)}))},he=function(e,t,n){return function(r){e(t,r,n)}},pe=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,oe(e,!0))},de=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw Y("Promise can't be resolved itself");var r=ie(t);r?A((function(){var n={done:!1};try{h(r,t,he(de,n,e),he(pe,n,e))}catch(t){pe(n,t,e)}})):(e.value=t,e.state=1,oe(e,!1))}catch(t){pe({done:!1},t,e)}}};if(ne&&(V=(K=function(e){w(this,V),y(e),h(n,this);var t=U(this);try{e(he(de,t),he(pe,t))}catch(e){pe(t,e)}}).prototype,(n=function(e){X(this,{type:H,done:!1,notified:!1,parent:!1,reactions:new R,rejection:!1,state:0,value:void 0})}).prototype=g(V,{then:function(e,t){var n=F(this),r=Q(k(this,K));return n.parent=!0,r.ok=!x(e)||e,r.fail=x(t)&&t,r.domain=N?_.domain:void 0,0==n.state?n.reactions.add(r):A((function(){ae(r,n)})),r.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new n,t=U(e);this.promise=e,this.resolve=he(de,t),this.reject=he(pe,t)},E.f=Q=function(e){return e===K||e===a?new i(e):q(e)},!l&&x(p)&&W!==Object.prototype)){o=W.then,te||(d(W,"then",(function(e,t){var n=this;return new K((function(e,t){h(o,n,e,t)})).then(e,t)}),{unsafe:!0}),d(W,"catch",V.catch,{unsafe:!0}));try{delete W.constructor}catch(e){}f&&f(W,V)}s({global:!0,wrap:!0,forced:ne},{Promise:K}),v(K,H,!1,!0),m(H),a=u(H),s({target:H,stat:!0,forced:ne},{reject:function(e){var t=Q(this);return h(t.reject,void 0,e),t.promise}}),s({target:H,stat:!0,forced:l||ne},{resolve:function(e){return T(l&&this===a?K:this,e)}}),s({target:H,stat:!0,forced:re},{all:function(e){var t=this,n=Q(t),r=n.resolve,i=n.reject,a=M((function(){var n=y(t.resolve),a=[],o=0,s=1;C(e,(function(e){var l=o++,c=!1;s++,h(n,t,e).then((function(e){c||(c=!0,a[l]=e,--s||r(a))}),i)})),--s||r(a)}));return a.error&&i(a.value),n.promise},race:function(e){var t=this,n=Q(t),r=n.reject,i=M((function(){var i=y(t.resolve);C(e,(function(e){h(i,t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}})})),r.register("dH9yW",(function(e,t){var n=r("6LGrQ");e.exports=n.Promise})),r.register("4sgQc",(function(e,t){var n,i,a,o,s=r("6LGrQ"),l=r("cn22k"),c=r("gAXAR"),u=r("3HoBU"),h=r("1JB0D"),p=r("6WghJ"),d=r("25rlX"),g=r("1fDSm"),f=r("ckGOu"),v=r("eFUbX"),m=r("bVA4J"),y=s.setImmediate,x=s.clearImmediate,b=s.process,w=s.Dispatch,B=s.Function,C=s.MessageChannel,S=s.String,k=0,L={},A="onreadystatechange";try{n=s.location}catch(e){}var T=function(e){if(h(L,e)){var t=L[e];delete L[e],t()}},I=function(e){return function(){T(e)}},E=function(e){T(e.data)},M=function(e){s.postMessage(S(e),n.protocol+"//"+n.host)};y&&x||(y=function(e){var t=g(arguments,1);return L[++k]=function(){l(u(e)?e:B(e),void 0,t)},i(k),k},x=function(e){delete L[e]},m?i=function(e){b.nextTick(I(e))}:w&&w.now?i=function(e){w.now(I(e))}:C&&!v?(o=(a=new C).port2,a.port1.onmessage=E,i=c(o.postMessage,o)):s.addEventListener&&u(s.postMessage)&&!s.importScripts&&n&&"file:"!==n.protocol&&!p(M)?(i=M,s.addEventListener("message",E,!1)):i=A in f("script")?function(e){d.appendChild(f("script")).onreadystatechange=function(){d.removeChild(this),T(e)}}:function(e){setTimeout(I(e),0)}),e.exports={set:y,clear:x}})),r.register("eFUbX",(function(e,t){var n=r("2F7Zt");e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(n)})),r.register("cqo3L",(function(e,t){var n,i,a,o,s,l,c,u,h=r("6LGrQ"),p=r("gAXAR"),d=r("l0gwz").f,g=r("4sgQc").set,f=r("eFUbX"),v=r("k2k84"),m=r("jtDRH"),y=r("bVA4J"),x=h.MutationObserver||h.WebKitMutationObserver,b=h.document,w=h.process,B=h.Promise,C=d(h,"queueMicrotask"),S=C&&C.value;S||(n=function(){var e,t;for(y&&(e=w.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(e){throw i?o():a=void 0,e}}a=void 0,e&&e.enter()},f||y||m||!x||!b?!v&&B&&B.resolve?((c=B.resolve(void 0)).constructor=B,u=p(c.then,c),o=function(){u(n)}):y?o=function(){w.nextTick(n)}:(g=p(g,h),o=function(){g(n)}):(s=!0,l=b.createTextNode(""),new x(n).observe(l,{characterData:!0}),o=function(){l.data=s=!s})),e.exports=S||function(e){var t={fn:e,next:void 0};a&&(a.next=t),i||(i=t,o()),a=t}})),r.register("k2k84",(function(e,t){var n=r("2F7Zt"),i=r("6LGrQ");e.exports=/ipad|iphone|ipod/i.test(n)&&void 0!==i.Pebble})),r.register("jtDRH",(function(e,t){var n=r("2F7Zt");e.exports=/web0s(?!.*chrome)/i.test(n)})),r.register("jb14y",(function(e,t){var n=r("edAQb"),i=r("gczVK"),a=r("4l0Z8");e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=a.f(e);return(0,r.resolve)(t),r.promise}})),r.register("4l0Z8",(function(e,n){var i;t(e.exports,"f",(function(){return i}),(function(e){return i=e}));var a=r("lEpkd"),o=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=a(t),this.reject=a(n)};i=function(e){return new o(e)}})),r.register("46Eeh",(function(e,t){var n=r("6LGrQ");e.exports=function(e,t){var r=n.console;r&&r.error&&(1==arguments.length?r.error(e):r.error(e,t))}})),r.register("emrW7",(function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}})),r.register("c6xXQ",(function(e,t){var n=function(){this.head=null,this.tail=null};n.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}},e.exports=n})),r.register("5qUSX",(function(e,t){e.exports="object"==typeof window})),r.register("mJux4",(function(e,t){"use strict";var n=r("JGbI2"),i=r("bMhTS"),a=r("dH9yW"),o=r("6WghJ"),s=r("fdCuf"),l=r("3HoBU"),c=r("4xaB6"),u=r("jb14y"),h=r("8Opqg");if(n({target:"Promise",proto:!0,real:!0,forced:!!a&&o((function(){a.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=c(this,s("Promise")),n=l(e);return this.then(n?function(n){return u(t,e()).then((function(){return n}))}:e,n?function(n){return u(t,e()).then((function(){throw n}))}:e)}}),!i&&l(a)){var p=s("Promise").prototype.finally;a.prototype.finally!==p&&h(a.prototype,"finally",p,{unsafe:!0})}})),r.register("tttpZ",(function(e,t){var n=r("JGbI2"),i=r("cn22k"),a=r("lEpkd"),o=r("edAQb");n({target:"Reflect",stat:!0,forced:!r("6WghJ")((function(){Reflect.apply((function(){}))}))},{apply:function(e,t,n){return i(a(e),t,o(n))}})})),r.register("iG7hc",(function(e,t){var n=r("JGbI2"),i=r("fdCuf"),a=r("cn22k"),o=r("bLEKU"),s=r("3Z9Nz"),l=r("edAQb"),c=r("gczVK"),u=r("KFLt0"),h=r("6WghJ"),p=i("Reflect","construct"),d=Object.prototype,g=[].push,f=h((function(){var e=function(){};return!(p((function(){}),[],e)instanceof e)})),v=!h((function(){p((function(){}))})),m=f||v;n({target:"Reflect",stat:!0,forced:m,sham:m},{construct:function(e,t){s(e),l(t);var n=arguments.length<3?e:s(arguments[2]);if(v&&!f)return p(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return a(g,r,t),new(a(o,e,r))}var i=n.prototype,h=u(c(i)?i:d),m=a(e,h,t);return c(m)?m:h}})})),r.register("bLEKU",(function(e,t){"use strict";var n=r("6LGrQ"),i=r("2x0T1"),a=r("lEpkd"),o=r("gczVK"),s=r("1JB0D"),l=r("1fDSm"),c=r("10M9V"),u=n.Function,h=i([].concat),p=i([].join),d={},g=function(e,t,n){if(!s(d,t)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";d[t]=u("C,a","return new C("+p(r,",")+")")}return d[t](e,n)};e.exports=c?u.bind:function(e){var t=a(this),n=t.prototype,r=l(arguments,1),i=function(){var n=h(r,l(arguments));return this instanceof i?g(t,n.length,n):t.apply(e,n)};return o(n)&&(i.prototype=n),i}})),r.register("8FSjO",(function(e,t){var n=r("JGbI2"),i=r("A56Kx"),a=r("edAQb"),o=r("hvgHk"),s=r("bLi0c");n({target:"Reflect",stat:!0,forced:r("6WghJ")((function(){Reflect.defineProperty(s.f({},1,{value:1}),1,{value:2})})),sham:!i},{defineProperty:function(e,t,n){a(e);var r=o(t);a(n);try{return s.f(e,r,n),!0}catch(e){return!1}}})})),r.register("l9N2O",(function(e,t){var n=r("JGbI2"),i=r("edAQb"),a=r("l0gwz").f;n({target:"Reflect",stat:!0},{deleteProperty:function(e,t){var n=a(i(e),t);return!(n&&!n.configurable)&&delete e[t]}})})),r.register("evcP9",(function(e,t){var n=r("JGbI2"),i=r("9ZRgk"),a=r("gczVK"),o=r("edAQb"),s=r("dxXnz"),l=r("l0gwz"),c=r("f4X4V");n({target:"Reflect",stat:!0},{get:function e(t,n){var r,u,h=arguments.length<3?t:arguments[2];return o(t)===h?t[n]:(r=l.f(t,n))?s(r)?r.value:void 0===r.get?void 0:i(r.get,h):a(u=c(t))?e(u,n,h):void 0}})})),r.register("dxXnz",(function(e,t){var n=r("1JB0D");e.exports=function(e){return void 0!==e&&(n(e,"value")||n(e,"writable"))}})),r.register("ghL03",(function(e,t){var n=r("JGbI2"),i=r("A56Kx"),a=r("edAQb"),o=r("l0gwz");n({target:"Reflect",stat:!0,sham:!i},{getOwnPropertyDescriptor:function(e,t){return o.f(a(e),t)}})})),r.register("jmNdZ",(function(e,t){var n=r("JGbI2"),i=r("edAQb"),a=r("f4X4V");n({target:"Reflect",stat:!0,sham:!r("khrDL")},{getPrototypeOf:function(e){return a(i(e))}})})),r.register("gRAam",(function(e,t){r("JGbI2")({target:"Reflect",stat:!0},{has:function(e,t){return t in e}})})),r.register("gzcSr",(function(e,t){var n=r("JGbI2"),i=r("edAQb"),a=r("kneZa");n({target:"Reflect",stat:!0},{isExtensible:function(e){return i(e),a(e)}})})),r.register("8LqBN",(function(e,t){r("JGbI2")({target:"Reflect",stat:!0},{ownKeys:r("6qoE5")})})),r.register("21jPJ",(function(e,t){var n=r("JGbI2"),i=r("fdCuf"),a=r("edAQb");n({target:"Reflect",stat:!0,sham:!r("6jxZs")},{preventExtensions:function(e){a(e);try{var t=i("Object","preventExtensions");return t&&t(e),!0}catch(e){return!1}}})})),r.register("kVqfb",(function(e,t){var n=r("JGbI2"),i=r("9ZRgk"),a=r("edAQb"),o=r("gczVK"),s=r("dxXnz"),l=r("6WghJ"),c=r("bLi0c"),u=r("l0gwz"),h=r("f4X4V"),p=r("eqpEX");n({target:"Reflect",stat:!0,forced:l((function(){var e=function(){},t=c.f(new e,"a",{configurable:!0});return!1!==Reflect.set(e.prototype,"a",1,t)}))},{set:function e(t,n,r){var l,d,g,f=arguments.length<4?t:arguments[3],v=u.f(a(t),n);if(!v){if(o(d=h(t)))return e(d,n,r,f);v=p(0)}if(s(v)){if(!1===v.writable||!o(f))return!1;if(l=u.f(f,n)){if(l.get||l.set||!1===l.writable)return!1;l.value=r,c.f(f,n,l)}else c.f(f,n,p(0,r))}else{if(void 0===(g=v.set))return!1;i(g,f,r)}return!0}})})),r.register("dzzom",(function(e,t){var n=r("JGbI2"),i=r("edAQb"),a=r("iHaUn"),o=r("4HLYu");o&&n({target:"Reflect",stat:!0},{setPrototypeOf:function(e,t){i(e),a(t);try{return o(e,t),!0}catch(e){return!1}}})})),r.register("2gunB",(function(e,t){var n=r("A56Kx"),i=r("6LGrQ"),a=r("2x0T1"),o=r("iTHz4"),s=r("4nT4Z"),l=r("8ihId"),c=r("bLi0c").f,u=r("9hrSE").f,h=r("c9sXY"),p=r("j7Wj1"),d=r("eXtvS"),g=r("1wkuT"),f=r("5mPjD"),v=r("8Opqg"),m=r("6WghJ"),y=r("1JB0D"),x=r("jUSxl").enforce,b=r("b5zq9"),w=r("8RiFY"),B=r("iolan"),C=r("15yb5"),S=w("match"),k=i.RegExp,L=k.prototype,A=i.SyntaxError,T=a(g),I=a(L.exec),E=a("".charAt),M=a("".replace),R=a("".indexOf),O=a("".slice),P=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,D=/a/g,G=/a/g,N=new k(D)!==D,j=f.MISSED_STICKY,z=f.UNSUPPORTED_Y,H=n&&(!N||j||B||C||m((function(){return G[S]=!1,k(D)!=D||k(G)==G||"/a/i"!=k(D,"i")})));if(o("RegExp",H)){for(var U=function(e,t){var n,r,i,a,o,c,u=h(L,this),g=p(e),f=void 0===t,v=[],m=e;if(!u&&g&&f&&e.constructor===U)return e;if((g||h(L,e))&&(e=e.source,f&&(t="flags"in m?m.flags:T(m))),e=void 0===e?"":d(e),t=void 0===t?"":d(t),m=e,B&&"dotAll"in D&&(r=!!t&&R(t,"s")>-1)&&(t=M(t,/s/g,"")),n=t,j&&"sticky"in D&&(i=!!t&&R(t,"y")>-1)&&z&&(t=M(t,/y/g,"")),C&&(a=function(e){for(var t,n=e.length,r=0,i="",a=[],o={},s=!1,l=!1,c=0,u="";r<=n;r++){if("\\"===(t=E(e,r)))t+=E(e,++r);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:I(P,O(e,r+1))&&(r+=2,l=!0),i+=t,c++;continue;case">"===t&&l:if(""===u||y(o,u))throw new A("Invalid capture group name");o[u]=!0,a[a.length]=[u,c],l=!1,u="";continue}l?u+=t:i+=t}return[i,a]}(e),e=a[0],v=a[1]),o=s(k(e,t),u?this:L,U),(r||i||v.length)&&(c=x(o),r&&(c.dotAll=!0,c.raw=U(function(e){for(var t,n=e.length,r=0,i="",a=!1;r<=n;r++)"\\"!==(t=E(e,r))?a||"."!==t?("["===t?a=!0:"]"===t&&(a=!1),i+=t):i+="[\\s\\S]":i+=t+E(e,++r);return i}(e),n)),i&&(c.sticky=!0),v.length&&(c.groups=v)),e!==m)try{l(o,"source",""===m?"(?:)":m)}catch(e){}return o},X=function(e){e in U||c(U,e,{configurable:!0,get:function(){return k[e]},set:function(t){k[e]=t}})},F=u(k),W=0;F.length>W;)X(F[W++]);L.constructor=U,U.prototype=L,v(i,"RegExp",U)}b("RegExp")})),r.register("j7Wj1",(function(e,t){var n=r("gczVK"),i=r("lrHHl"),a=r("8RiFY")("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==i(e))}})),r.register("1wkuT",(function(e,t){"use strict";var n=r("edAQb");e.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}})),r.register("5mPjD",(function(e,t){var n=r("6WghJ"),i=r("6LGrQ").RegExp,a=n((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),o=a||n((function(){return!i("a","y").sticky})),s=a||n((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:s,MISSED_STICKY:o,UNSUPPORTED_Y:a}})),r.register("iolan",(function(e,t){var n=r("6WghJ"),i=r("6LGrQ").RegExp;e.exports=n((function(){var e=i(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))})),r.register("15yb5",(function(e,t){var n=r("6WghJ"),i=r("6LGrQ").RegExp;e.exports=n((function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))})),r.register("QxL6K",(function(e,t){"use strict";var n=r("JGbI2"),i=r("gDZSO");n({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})})),r.register("gDZSO",(function(e,t){"use strict";var n,i,a=r("9ZRgk"),o=r("2x0T1"),s=r("eXtvS"),l=r("1wkuT"),c=r("5mPjD"),u=r("eW5R0"),h=r("KFLt0"),p=r("jUSxl").get,d=r("iolan"),g=r("15yb5"),f=u("native-string-replace",String.prototype.replace),v=RegExp.prototype.exec,m=v,y=o("".charAt),x=o("".indexOf),b=o("".replace),w=o("".slice),B=(i=/b*/g,a(v,n=/a/,"a"),a(v,i,"a"),0!==n.lastIndex||0!==i.lastIndex),C=c.BROKEN_CARET,S=void 0!==/()??/.exec("")[1];(B||S||C||d||g)&&(m=function(e){var t,n,r,i,o,c,u,d=this,g=p(d),k=s(e),L=g.raw;if(L)return L.lastIndex=d.lastIndex,t=a(m,L,k),d.lastIndex=L.lastIndex,t;var A=g.groups,T=C&&d.sticky,I=a(l,d),E=d.source,M=0,R=k;if(T&&(I=b(I,"y",""),-1===x(I,"g")&&(I+="g"),R=w(k,d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==y(k,d.lastIndex-1))&&(E="(?: "+E+")",R=" "+R,M++),n=new RegExp("^(?:"+E+")",I)),S&&(n=new RegExp("^"+E+"$(?!\\s)",I)),B&&(r=d.lastIndex),i=a(v,T?n:d,R),T?i?(i.input=w(i.input,M),i[0]=w(i[0],M),i.index=d.lastIndex,d.lastIndex+=i[0].length):d.lastIndex=0:B&&i&&(d.lastIndex=d.global?i.index+i[0].length:r),S&&i&&i.length>1&&a(f,i[0],n,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i&&A)for(i.groups=c=h(null),o=0;o<A.length;o++)c[(u=A[o])[0]]=i[u[1]];return i}),e.exports=m})),r.register("6ERNe",(function(e,t){var n=r("A56Kx"),i=r("bLi0c"),a=r("1wkuT"),o=r("6WghJ"),s=RegExp.prototype;n&&o((function(){return"sy"!==Object.getOwnPropertyDescriptor(s,"flags").get.call({dotAll:!0,sticky:!0})}))&&i.f(s,"flags",{configurable:!0,get:a})})),r.register("jvxFE",(function(e,t){"use strict";var n=r("2x0T1"),i=r("ce4aN").PROPER,a=r("8Opqg"),o=r("edAQb"),s=r("c9sXY"),l=r("eXtvS"),c=r("6WghJ"),u=r("1wkuT"),h="toString",p=RegExp.prototype,d=p.toString,g=n(u),f=c((function(){return"/a/b"!=d.call({source:"a",flags:"b"})})),v=i&&d.name!=h;(f||v)&&a(RegExp.prototype,h,(function(){var e=o(this),t=l(e.source),n=e.flags;return"/"+t+"/"+l(void 0===n&&s(p,e)&&!("flags"in p)?g(e):n)}),{unsafe:!0})})),r.register("3I5Q0",(function(e,t){"use strict";r("6P8eJ")("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r("gVyws"))})),r.register("boJu5",(function(e,t){"use strict";var n=r("JGbI2"),i=r("57ZgD").codeAt;n({target:"String",proto:!0},{codePointAt:function(e){return i(this,e)}})})),r.register("57ZgD",(function(e,t){var n=r("2x0T1"),i=r("3Hjrl"),a=r("eXtvS"),o=r("0dsEW"),s=n("".charAt),l=n("".charCodeAt),c=n("".slice),u=function(e){return function(t,n){var r,u,h=a(o(t)),p=i(n),d=h.length;return p<0||p>=d?e?"":void 0:(r=l(h,p))<55296||r>56319||p+1===d||(u=l(h,p+1))<56320||u>57343?e?s(h,p):r:e?c(h,p,p+2):u-56320+(r-55296<<10)+65536}};e.exports={codeAt:u(!1),charAt:u(!0)}})),r.register("e0lr8",(function(e,t){"use strict";var n,i=r("JGbI2"),a=r("2x0T1"),o=r("l0gwz").f,s=r("k8phS"),l=r("eXtvS"),c=r("jliZt"),u=r("0dsEW"),h=r("gkCWb"),p=r("bMhTS"),d=a("".endsWith),g=a("".slice),f=Math.min,v=h("endsWith");i({target:"String",proto:!0,forced:!!(p||v||(n=o(String.prototype,"endsWith"),!n||n.writable))&&!v},{endsWith:function(e){var t=l(u(this));c(e);var n=arguments.length>1?arguments[1]:void 0,r=t.length,i=void 0===n?r:f(s(n),r),a=l(e);return d?d(t,a,i):g(t,i-a.length,i)===a}})})),r.register("jliZt",(function(e,t){var n=r("6LGrQ"),i=r("j7Wj1"),a=n.TypeError;e.exports=function(e){if(i(e))throw a("The method doesn't accept regular expressions");return e}})),r.register("gkCWb",(function(e,t){var n=r("8RiFY")("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,"/./"[e](t)}catch(e){}}return!1}})),r.register("7LL1n",(function(e,t){var n=r("JGbI2"),i=r("6LGrQ"),a=r("2x0T1"),o=r("8BhlN"),s=i.RangeError,l=String.fromCharCode,c=String.fromCodePoint,u=a([].join);n({target:"String",stat:!0,forced:!!c&&1!=c.length},{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,i=0;r>i;){if(t=+arguments[i++],o(t,1114111)!==t)throw s(t+" is not a valid code point");n[i]=t<65536?l(t):l(55296+((t-=65536)>>10),t%1024+56320)}return u(n,"")}})})),r.register("c0Tqp",(function(e,t){"use strict";var n=r("JGbI2"),i=r("2x0T1"),a=r("jliZt"),o=r("0dsEW"),s=r("eXtvS"),l=r("gkCWb"),c=i("".indexOf);n({target:"String",proto:!0,forced:!l("includes")},{includes:function(e){return!!~c(s(o(this)),s(a(e)),arguments.length>1?arguments[1]:void 0)}})})),r.register("5FVj1",(function(e,t){"use strict";var n=r("57ZgD").charAt,i=r("eXtvS"),a=r("jUSxl"),o=r("A0wh1"),s="String Iterator",l=a.set,c=a.getterFor(s);o(String,"String",(function(e){l(this,{type:s,string:i(e),index:0})}),(function(){var e,t=c(this),r=t.string,i=t.index;return i>=r.length?{value:void 0,done:!0}:(e=n(r,i),t.index+=e.length,{value:e,done:!1})}))})),r.register("fEEuV",(function(e,t){"use strict";var n=r("9ZRgk"),i=r("1eJAF"),a=r("edAQb"),o=r("k8phS"),s=r("eXtvS"),l=r("0dsEW"),c=r("3Xhmk"),u=r("6DNPg"),h=r("2aUTa");i("match",(function(e,t,r){return[function(t){var r=l(this),i=null==t?void 0:c(t,e);return i?n(i,t,r):new RegExp(t)[e](s(r))},function(e){var n=a(this),i=s(e),l=r(t,n,i);if(l.done)return l.value;if(!n.global)return h(n,i);var c=n.unicode;n.lastIndex=0;for(var p,d=[],g=0;null!==(p=h(n,i));){var f=s(p[0]);d[g]=f,""===f&&(n.lastIndex=u(i,o(n.lastIndex),c)),g++}return 0===g?null:d}]}))})),r.register("1eJAF",(function(e,t){"use strict";r("QxL6K");var n=r("2x0T1"),i=r("8Opqg"),a=r("gDZSO"),o=r("6WghJ"),s=r("8RiFY"),l=r("8ihId"),c=s("species"),u=RegExp.prototype;e.exports=function(e,t,r,h){var p=s(e),d=!o((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),g=d&&!o((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[p]=/./[p]),n.exec=function(){return t=!0,null},n[p](""),!t}));if(!d||!g||r){var f=n(/./[p]),v=t(p,""[e],(function(e,t,r,i,o){var s=n(e),l=t.exec;return l===a||l===u.exec?d&&!o?{done:!0,value:f(t,r,i)}:{done:!0,value:s(r,t,i)}:{done:!1}}));i(String.prototype,e,v[0]),i(u,p,v[1])}h&&l(u[p],"sham",!0)}})),r.register("6DNPg",(function(e,t){"use strict";var n=r("57ZgD").charAt;e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}})),r.register("2aUTa",(function(e,t){var n=r("6LGrQ"),i=r("9ZRgk"),a=r("edAQb"),o=r("3HoBU"),s=r("lrHHl"),l=r("gDZSO"),c=n.TypeError;e.exports=function(e,t){var n=e.exec;if(o(n)){var r=i(n,e,t);return null!==r&&a(r),r}if("RegExp"===s(e))return i(l,e,t);throw c("RegExp#exec called on incompatible receiver")}})),r.register("7aVqu",(function(e,t){"use strict";var n=r("JGbI2"),i=r("4h7kb").end;n({target:"String",proto:!0,forced:r("3gBOP")},{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})})),r.register("4h7kb",(function(e,t){var n=r("2x0T1"),i=r("k8phS"),a=r("eXtvS"),o=r("kmJfO"),s=r("0dsEW"),l=n(o),c=n("".slice),u=Math.ceil,h=function(e){return function(t,n,r){var o,h,p=a(s(t)),d=i(n),g=p.length,f=void 0===r?" ":a(r);return d<=g||""==f?p:((h=l(f,u((o=d-g)/f.length))).length>o&&(h=c(h,0,o)),e?p+h:h+p)}};e.exports={start:h(!1),end:h(!0)}})),r.register("3gBOP",(function(e,t){var n=r("2F7Zt");e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(n)})),r.register("b9AHh",(function(e,t){"use strict";var n=r("JGbI2"),i=r("4h7kb").start;n({target:"String",proto:!0,forced:r("3gBOP")},{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})})),r.register("bsrPv",(function(e,t){var n=r("JGbI2"),i=r("2x0T1"),a=r("hAcvu"),o=r("falgx"),s=r("eXtvS"),l=r("9u6Bu"),c=i([].push),u=i([].join);n({target:"String",stat:!0},{raw:function(e){for(var t=a(o(e).raw),n=l(t),r=arguments.length,i=[],h=0;n>h;){if(c(i,s(t[h++])),h===n)return u(i,"");h<r&&c(i,s(arguments[h]))}}})})),r.register("1HS2A",(function(e,t){r("JGbI2")({target:"String",proto:!0},{repeat:r("kmJfO")})})),r.register("03jrQ",(function(e,t){"use strict";var n=r("cn22k"),i=r("9ZRgk"),a=r("2x0T1"),o=r("1eJAF"),s=r("6WghJ"),l=r("edAQb"),c=r("3HoBU"),u=r("3Hjrl"),h=r("k8phS"),p=r("eXtvS"),d=r("0dsEW"),g=r("6DNPg"),f=r("3Xhmk"),v=r("tmsHt"),m=r("2aUTa"),y=r("8RiFY")("replace"),x=Math.max,b=Math.min,w=a([].concat),B=a([].push),C=a("".indexOf),S=a("".slice),k="$0"==="a".replace(/./,"$0"),L=!!/./[y]&&""===/./[y]("a","$0");o("replace",(function(e,t,r){var a=L?"$":"$0";return[function(e,n){var r=d(this),a=null==e?void 0:f(e,y);return a?i(a,e,r,n):i(t,p(r),e,n)},function(e,i){var o=l(this),s=p(e);if("string"==typeof i&&-1===C(i,a)&&-1===C(i,"$<")){var d=r(t,o,s,i);if(d.done)return d.value}var f=c(i);f||(i=p(i));var y=o.global;if(y){var k=o.unicode;o.lastIndex=0}for(var L=[];;){var A=m(o,s);if(null===A)break;if(B(L,A),!y)break;""===p(A[0])&&(o.lastIndex=g(s,h(o.lastIndex),k))}for(var T,I="",E=0,M=0;M<L.length;M++){for(var R=p((A=L[M])[0]),O=x(b(u(A.index),s.length),0),P=[],D=1;D<A.length;D++)B(P,void 0===(T=A[D])?T:String(T));var G=A.groups;if(f){var N=w([R],P,O,s);void 0!==G&&B(N,G);var j=p(n(i,void 0,N))}else j=v(R,s,O,P,G,i);O>=E&&(I+=S(s,E,O)+j,E=O+R.length)}return I+S(s,E)}]}),!!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!k||L)})),r.register("tmsHt",(function(e,t){var n=r("2x0T1"),i=r("falgx"),a=Math.floor,o=n("".charAt),s=n("".replace),l=n("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,h,p){var d=n+e.length,g=r.length,f=u;return void 0!==h&&(h=i(h),f=c),s(p,f,(function(i,s){var c;switch(o(s,0)){case"$":return"$";case"&":return e;case"`":return l(t,0,n);case"'":return l(t,d);case"<":c=h[l(s,1,-1)];break;default:var u=+s;if(0===u)return i;if(u>g){var p=a(u/10);return 0===p?i:p<=g?void 0===r[p-1]?o(s,1):r[p-1]+o(s,1):i}c=r[u-1]}return void 0===c?"":c}))}})),r.register("1e9nP",(function(e,t){"use strict";var n=r("9ZRgk"),i=r("1eJAF"),a=r("edAQb"),o=r("0dsEW"),s=r("98Orf"),l=r("eXtvS"),c=r("3Xhmk"),u=r("2aUTa");i("search",(function(e,t,r){return[function(t){var r=o(this),i=null==t?void 0:c(t,e);return i?n(i,t,r):new RegExp(t)[e](l(r))},function(e){var n=a(this),i=l(e),o=r(t,n,i);if(o.done)return o.value;var c=n.lastIndex;s(c,0)||(n.lastIndex=0);var h=u(n,i);return s(n.lastIndex,c)||(n.lastIndex=c),null===h?-1:h.index}]}))})),r.register("hu06n",(function(e,t){"use strict";var n=r("cn22k"),i=r("9ZRgk"),a=r("2x0T1"),o=r("1eJAF"),s=r("j7Wj1"),l=r("edAQb"),c=r("0dsEW"),u=r("4xaB6"),h=r("6DNPg"),p=r("k8phS"),d=r("eXtvS"),g=r("3Xhmk"),f=r("b4zeJ"),v=r("2aUTa"),m=r("gDZSO"),y=r("5mPjD"),x=r("6WghJ"),b=y.UNSUPPORTED_Y,w=4294967295,B=Math.min,C=[].push,S=a(/./.exec),k=a(C),L=a("".slice),A=!x((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));o("split",(function(e,t,r){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var a=d(c(this)),o=void 0===r?w:r>>>0;if(0===o)return[];if(void 0===e)return[a];if(!s(e))return i(t,a,e,o);for(var l,u,h,p=[],g=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),v=0,y=new RegExp(e.source,g+"g");(l=i(m,y,a))&&!((u=y.lastIndex)>v&&(k(p,L(a,v,l.index)),l.length>1&&l.index<a.length&&n(C,p,f(l,1)),h=l[0].length,v=u,p.length>=o));)y.lastIndex===l.index&&y.lastIndex++;return v===a.length?!h&&S(y,"")||k(p,""):k(p,L(a,v)),p.length>o?f(p,0,o):p}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:i(t,this,e,n)}:t,[function(t,n){var r=c(this),o=null==t?void 0:g(t,e);return o?i(o,t,r,n):i(a,d(r),t,n)},function(e,n){var i=l(this),o=d(e),s=r(a,i,o,n,a!==t);if(s.done)return s.value;var c=u(i,RegExp),g=i.unicode,f=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(b?"g":"y"),m=new c(b?"^(?:"+i.source+")":i,f),y=void 0===n?w:n>>>0;if(0===y)return[];if(0===o.length)return null===v(m,o)?[o]:[];for(var x=0,C=0,S=[];C<o.length;){m.lastIndex=b?0:C;var A,T=v(m,b?L(o,C):o);if(null===T||(A=B(p(m.lastIndex+(b?C:0)),o.length))===x)C=h(o,C,g);else{if(k(S,L(o,x,C)),S.length===y)return S;for(var I=1;I<=T.length-1;I++)if(k(S,T[I]),S.length===y)return S;C=x=A}}return k(S,L(o,x)),S}]}),!A,b)})),r.register("6dDHI",(function(e,t){"use strict";var n,i=r("JGbI2"),a=r("2x0T1"),o=r("l0gwz").f,s=r("k8phS"),l=r("eXtvS"),c=r("jliZt"),u=r("0dsEW"),h=r("gkCWb"),p=r("bMhTS"),d=a("".startsWith),g=a("".slice),f=Math.min,v=h("startsWith");i({target:"String",proto:!0,forced:!!(p||v||(n=o(String.prototype,"startsWith"),!n||n.writable))&&!v},{startsWith:function(e){var t=l(u(this));c(e);var n=s(f(arguments.length>1?arguments[1]:void 0,t.length)),r=l(e);return d?d(t,r,n):g(t,n,n+r.length)===r}})})),r.register("8p8zQ",(function(e,t){"use strict";var n=r("JGbI2"),i=r("cCzE3").trim;n({target:"String",proto:!0,forced:r("ecacA")("trim")},{trim:function(){return i(this)}})})),r.register("ecacA",(function(e,t){var n=r("ce4aN").PROPER,i=r("6WghJ"),a=r("eJCyU");e.exports=function(e){return i((function(){return!!a[e]()||"​᠎"!=="​᠎"[e]()||n&&a[e].name!==e}))}})),r.register("9xQx7",(function(e,t){"use strict";var n=r("JGbI2"),i=r("cCzE3").end,a=r("ecacA")("trimEnd"),o=a?function(){return i(this)}:"".trimEnd;n({target:"String",proto:!0,name:"trimEnd",forced:a},{trimEnd:o,trimRight:o})})),r.register("1YPyf",(function(e,t){"use strict";var n=r("JGbI2"),i=r("cCzE3").start,a=r("ecacA")("trimStart"),o=a?function(){return i(this)}:"".trimStart;n({target:"String",proto:!0,name:"trimStart",forced:a},{trimStart:o,trimLeft:o})})),r.register("ej8Tj",(function(e,t){"use strict";var n=r("JGbI2"),i=r("1nd9Q");n({target:"String",proto:!0,forced:r("6PJ8T")("anchor")},{anchor:function(e){return i(this,"a","name",e)}})})),r.register("1nd9Q",(function(e,t){var n=r("2x0T1"),i=r("0dsEW"),a=r("eXtvS"),o=/"/g,s=n("".replace);e.exports=function(e,t,n,r){var l=a(i(e)),c="<"+t;return""!==n&&(c+=" "+n+'="'+s(a(r),o,"&quot;")+'"'),c+">"+l+"</"+t+">"}})),r.register("6PJ8T",(function(e,t){var n=r("6WghJ");e.exports=function(e){return n((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}})),r.register("0HFgS",(function(e,t){"use strict";var n=r("JGbI2"),i=r("1nd9Q");n({target:"String",proto:!0,forced:r("6PJ8T")("big")},{big:function(){return i(this,"big","","")}})})),r.register("ivCR8",(function(e,t){"use strict";var n=r("JGbI2"),i=r("1nd9Q");n({target:"String",proto:!0,forced:r("6PJ8T")("blink")},{blink:function(){return i(this,"blink","","")}})})),r.register("kWB7y",(function(e,t){"use strict";var n=r("JGbI2"),i=r("1nd9Q");n({target:"String",proto:!0,forced:r("6PJ8T")("bold")},{bold:function(){return i(this,"b","","")}})})),r.register("iRcYA",(function(e,t){"use strict";var n=r("JGbI2"),i=r("1nd9Q");n({target:"String",proto:!0,forced:r("6PJ8T")("fixed")},{fixed:function(){return i(this,"tt","","")}})})),r.register("8FnSg",(function(e,t){"use strict";var n=r("JGbI2"),i=r("1nd9Q");n({target:"String",proto:!0,forced:r("6PJ8T")("fontcolor")},{fontcolor:function(e){return i(this,"font","color",e)}})})),r.register("6FagT",(function(e,t){"use strict";var n=r("JGbI2"),i=r("1nd9Q");n({target:"String",proto:!0,forced:r("6PJ8T")("fontsize")},{fontsize:function(e){return i(this,"font","size",e)}})})),r.register("fltGU",(function(e,t){"use strict";var n=r("JGbI2"),i=r("1nd9Q");n({target:"String",proto:!0,forced:r("6PJ8T")("italics")},{italics:function(){return i(this,"i","","")}})})),r.register("1TpBH",(function(e,t){"use strict";var n=r("JGbI2"),i=r("1nd9Q");n({target:"String",proto:!0,forced:r("6PJ8T")("link")},{link:function(e){return i(this,"a","href",e)}})})),r.register("jXJMN",(function(e,t){"use strict";var n=r("JGbI2"),i=r("1nd9Q");n({target:"String",proto:!0,forced:r("6PJ8T")("small")},{small:function(){return i(this,"small","","")}})})),r.register("blHyV",(function(e,t){"use strict";var n=r("JGbI2"),i=r("1nd9Q");n({target:"String",proto:!0,forced:r("6PJ8T")("strike")},{strike:function(){return i(this,"strike","","")}})})),r.register("bytwV",(function(e,t){"use strict";var n=r("JGbI2"),i=r("1nd9Q");n({target:"String",proto:!0,forced:r("6PJ8T")("sub")},{sub:function(){return i(this,"sub","","")}})})),r.register("iElT4",(function(e,t){"use strict";var n=r("JGbI2"),i=r("1nd9Q");n({target:"String",proto:!0,forced:r("6PJ8T")("sup")},{sup:function(){return i(this,"sup","","")}})})),r.register("bqvPl",(function(e,t){r("fMuLF")("Float32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))})),r.register("fMuLF",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("9ZRgk"),o=r("A56Kx"),s=r("gwHTU"),l=r("lKaOf"),c=r("h6ot1"),u=r("lIgln"),h=r("eqpEX"),p=r("8ihId"),d=r("dXAGN"),g=r("k8phS"),f=r("75wCi"),v=r("1kqup"),m=r("hvgHk"),y=r("1JB0D"),x=r("cKQyt"),b=r("gczVK"),w=r("fcVIX"),B=r("KFLt0"),C=r("c9sXY"),S=r("4HLYu"),k=r("9hrSE").f,L=r("8ecSO"),A=r("9otZn").forEach,T=r("b5zq9"),I=r("bLi0c"),E=r("l0gwz"),M=r("jUSxl"),R=r("4nT4Z"),O=M.get,P=M.set,D=I.f,G=E.f,N=Math.round,j=i.RangeError,z=c.ArrayBuffer,H=z.prototype,U=c.DataView,X=l.NATIVE_ARRAY_BUFFER_VIEWS,F=l.TYPED_ARRAY_CONSTRUCTOR,W=l.TYPED_ARRAY_TAG,K=l.TypedArray,V=l.TypedArrayPrototype,Y=l.aTypedArrayConstructor,J=l.isTypedArray,_="BYTES_PER_ELEMENT",Q="Wrong length",q=function(e,t){Y(e);for(var n=0,r=t.length,i=new e(r);r>n;)i[n]=t[n++];return i},Z=function(e,t){D(e,t,{get:function(){return O(this)[t]}})},$=function(e){var t;return C(H,e)||"ArrayBuffer"==(t=x(e))||"SharedArrayBuffer"==t},ee=function(e,t){return J(e)&&!w(t)&&t in e&&d(+t)&&t>=0},te=function(e,t){return t=m(t),ee(e,t)?h(2,e[t]):G(e,t)},ne=function(e,t,n){return t=m(t),!(ee(e,t)&&b(n)&&y(n,"value"))||y(n,"get")||y(n,"set")||n.configurable||y(n,"writable")&&!n.writable||y(n,"enumerable")&&!n.enumerable?D(e,t,n):(e[t]=n.value,e)};o?(X||(E.f=te,I.f=ne,Z(V,"buffer"),Z(V,"byteOffset"),Z(V,"byteLength"),Z(V,"length")),n({target:"Object",stat:!0,forced:!X},{getOwnPropertyDescriptor:te,defineProperty:ne}),e.exports=function(e,t,r){var o=e.match(/\d+$/)[0]/8,l=e+(r?"Clamped":"")+"Array",c="get"+e,h="set"+e,d=i[l],m=d,y=m&&m.prototype,x={},w=function(e,t){D(e,t,{get:function(){return function(e,t){var n=O(e);return n.view[c](t*o+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,n){var i=O(e);r&&(n=(n=N(n))<0?0:n>255?255:255&n),i.view[h](t*o+i.byteOffset,n,!0)}(this,t,e)},enumerable:!0})};X?s&&(m=t((function(e,t,n,r){return u(e,y),R(b(t)?$(t)?void 0!==r?new d(t,v(n,o),r):void 0!==n?new d(t,v(n,o)):new d(t):J(t)?q(m,t):a(L,m,t):new d(f(t)),e,m)})),S&&S(m,K),A(k(d),(function(e){e in m||p(m,e,d[e])})),m.prototype=y):(m=t((function(e,t,n,r){u(e,y);var i,s,l,c=0,h=0;if(b(t)){if(!$(t))return J(t)?q(m,t):a(L,m,t);i=t,h=v(n,o);var p=t.byteLength;if(void 0===r){if(p%o)throw j(Q);if((s=p-h)<0)throw j(Q)}else if((s=g(r)*o)+h>p)throw j(Q);l=s/o}else l=f(t),i=new z(s=l*o);for(P(e,{buffer:i,byteOffset:h,byteLength:s,length:l,view:new U(i)});c<l;)w(e,c++)})),S&&S(m,K),y=m.prototype=B(V)),y.constructor!==m&&p(y,"constructor",m),p(y,F,m),W&&p(y,W,l),x[l]=m,n({global:!0,forced:m!=d,sham:!X},x),_ in m||p(m,_,o),_ in y||p(y,_,o),T(l)}):e.exports=function(){}})),r.register("gwHTU",(function(e,t){var n=r("6LGrQ"),i=r("6WghJ"),a=r("dNJyV"),o=r("lKaOf").NATIVE_ARRAY_BUFFER_VIEWS,s=n.ArrayBuffer,l=n.Int8Array;e.exports=!o||!i((function(){l(1)}))||!i((function(){new l(-1)}))||!a((function(e){new l,new l(null),new l(1.5),new l(e)}),!0)||i((function(){return 1!==new l(new s(2),1,void 0).length}))})),r.register("lKaOf",(function(e,t){"use strict";var n,i,a,o=r("7jUo8"),s=r("A56Kx"),l=r("6LGrQ"),c=r("3HoBU"),u=r("gczVK"),h=r("1JB0D"),p=r("cKQyt"),d=r("dth1M"),g=r("8ihId"),f=r("8Opqg"),v=r("bLi0c").f,m=r("c9sXY"),y=r("f4X4V"),x=r("4HLYu"),b=r("8RiFY"),w=r("VN1JY"),B=l.Int8Array,C=B&&B.prototype,S=l.Uint8ClampedArray,k=S&&S.prototype,L=B&&y(B),A=C&&y(C),T=Object.prototype,I=l.TypeError,E=b("toStringTag"),M=w("TYPED_ARRAY_TAG"),R=w("TYPED_ARRAY_CONSTRUCTOR"),O=o&&!!x&&"Opera"!==p(l.opera),P=!1,D={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},G={BigInt64Array:8,BigUint64Array:8},N=function(e){if(!u(e))return!1;var t=p(e);return h(D,t)||h(G,t)};for(n in D)(a=(i=l[n])&&i.prototype)?g(a,R,i):O=!1;for(n in G)(a=(i=l[n])&&i.prototype)&&g(a,R,i);if((!O||!c(L)||L===Function.prototype)&&(L=function(){throw I("Incorrect invocation")},O))for(n in D)l[n]&&x(l[n],L);if((!O||!A||A===T)&&(A=L.prototype,O))for(n in D)l[n]&&x(l[n].prototype,A);if(O&&y(k)!==A&&x(k,A),s&&!h(A,E))for(n in P=!0,v(A,E,{get:function(){return u(this)?this[M]:void 0}}),D)l[n]&&g(l[n],M,n);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:O,TYPED_ARRAY_CONSTRUCTOR:R,TYPED_ARRAY_TAG:P&&M,aTypedArray:function(e){if(N(e))return e;throw I("Target is not a typed array")},aTypedArrayConstructor:function(e){if(c(e)&&(!x||m(L,e)))return e;throw I(d(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,r){if(s){if(n)for(var i in D){var a=l[i];if(a&&h(a.prototype,e))try{delete a.prototype[e]}catch(n){try{a.prototype[e]=t}catch(e){}}}A[e]&&!n||f(A,e,n?t:O&&C[e]||t,r)}},exportTypedArrayStaticMethod:function(e,t,n){var r,i;if(s){if(x){if(n)for(r in D)if((i=l[r])&&h(i,e))try{delete i[e]}catch(e){}if(L[e]&&!n)return;try{return f(L,e,n?t:O&&L[e]||t)}catch(e){}}for(r in D)!(i=l[r])||i[e]&&!n||f(i,e,t)}},isView:function(e){if(!u(e))return!1;var t=p(e);return"DataView"===t||h(D,t)||h(G,t)},isTypedArray:N,TypedArray:L,TypedArrayPrototype:A}})),r.register("1kqup",(function(e,t){var n=r("6LGrQ"),i=r("dG9ye"),a=n.RangeError;e.exports=function(e,t){var n=i(e);if(n%t)throw a("Wrong offset");return n}})),r.register("dG9ye",(function(e,t){var n=r("6LGrQ"),i=r("3Hjrl"),a=n.RangeError;e.exports=function(e){var t=i(e);if(t<0)throw a("The argument can't be less than 0");return t}})),r.register("8ecSO",(function(e,t){var n=r("gAXAR"),i=r("9ZRgk"),a=r("3Z9Nz"),o=r("falgx"),s=r("9u6Bu"),l=r("g3ZOP"),c=r("aCNH3"),u=r("9WXOl"),h=r("lKaOf").aTypedArrayConstructor;e.exports=function(e){var t,r,p,d,g,f,v=a(this),m=o(e),y=arguments.length,x=y>1?arguments[1]:void 0,b=void 0!==x,w=c(m);if(w&&!u(w))for(f=(g=l(m,w)).next,m=[];!(d=i(f,g)).done;)m.push(d.value);for(b&&y>2&&(x=n(x,arguments[2])),r=s(m),p=new(h(v))(r),t=0;r>t;t++)p[t]=b?x(m[t],t):m[t];return p}})),r.register("by6w7",(function(e,t){r("fMuLF")("Float64",(function(e){return function(t,n,r){return e(this,t,n,r)}}))})),r.register("k52v4",(function(e,t){r("fMuLF")("Int8",(function(e){return function(t,n,r){return e(this,t,n,r)}}))})),r.register("3fQ7i",(function(e,t){r("fMuLF")("Int16",(function(e){return function(t,n,r){return e(this,t,n,r)}}))})),r.register("vXr1A",(function(e,t){r("fMuLF")("Int32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))})),r.register("jkI01",(function(e,t){r("fMuLF")("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}))})),r.register("b59cW",(function(e,t){r("fMuLF")("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}),!0)})),r.register("jXBTm",(function(e,t){r("fMuLF")("Uint16",(function(e){return function(t,n,r){return e(this,t,n,r)}}))})),r.register("bvJmB",(function(e,t){r("fMuLF")("Uint32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))})),r.register("fDOA5",(function(e,t){"use strict";var n=r("2x0T1"),i=r("lKaOf"),a=n(r("04UlN")),o=i.aTypedArray;(0,i.exportTypedArrayMethod)("copyWithin",(function(e,t){return a(o(this),e,t,arguments.length>2?arguments[2]:void 0)}))})),r.register("iqpZ0",(function(e,t){"use strict";var n=r("lKaOf"),i=r("9otZn").every,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("every",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0)}))})),r.register("6LiLh",(function(e,t){"use strict";var n=r("lKaOf"),i=r("9ZRgk"),a=r("5QjeM"),o=n.aTypedArray;(0,n.exportTypedArrayMethod)("fill",(function(e){var t=arguments.length;return i(a,o(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}))})),r.register("4AV73",(function(e,t){"use strict";var n=r("lKaOf"),i=r("9otZn").filter,a=r("7WNzG"),o=n.aTypedArray;(0,n.exportTypedArrayMethod)("filter",(function(e){var t=i(o(this),e,arguments.length>1?arguments[1]:void 0);return a(this,t)}))})),r.register("7WNzG",(function(e,t){var n=r("ijLgx"),i=r("97HwV");e.exports=function(e,t){return n(i(e),t)}})),r.register("ijLgx",(function(e,t){var n=r("9u6Bu");e.exports=function(e,t){for(var r=0,i=n(t),a=new e(i);i>r;)a[r]=t[r++];return a}})),r.register("97HwV",(function(e,t){var n=r("lKaOf"),i=r("4xaB6"),a=n.TYPED_ARRAY_CONSTRUCTOR,o=n.aTypedArrayConstructor;e.exports=function(e){return o(i(e,e[a]))}})),r.register("asE2s",(function(e,t){"use strict";var n=r("lKaOf"),i=r("9otZn").find,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("find",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0)}))})),r.register("7HArX",(function(e,t){"use strict";var n=r("lKaOf"),i=r("9otZn").findIndex,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("findIndex",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0)}))})),r.register("cZ95y",(function(e,t){"use strict";var n=r("lKaOf"),i=r("9otZn").forEach,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("forEach",(function(e){i(a(this),e,arguments.length>1?arguments[1]:void 0)}))})),r.register("7WxZe",(function(e,t){"use strict";var n=r("gwHTU");(0,r("lKaOf").exportTypedArrayStaticMethod)("from",r("8ecSO"),n)})),r.register("98YB9",(function(e,t){"use strict";var n=r("lKaOf"),i=r("lCEDd").includes,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("includes",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0)}))})),r.register("1SIrv",(function(e,t){"use strict";var n=r("lKaOf"),i=r("lCEDd").indexOf,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("indexOf",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0)}))})),r.register("lESvO",(function(e,t){"use strict";var n=r("6LGrQ"),i=r("6WghJ"),a=r("2x0T1"),o=r("lKaOf"),s=r("l4lCC"),l=r("8RiFY")("iterator"),c=n.Uint8Array,u=a(s.values),h=a(s.keys),p=a(s.entries),d=o.aTypedArray,g=o.exportTypedArrayMethod,f=c&&c.prototype,v=!i((function(){f[l].call([1])})),m=!!f&&f.values&&f[l]===f.values&&"values"===f.values.name,y=function(){return u(d(this))};g("entries",(function(){return p(d(this))}),v),g("keys",(function(){return h(d(this))}),v),g("values",y,v||!m,{name:"values"}),g(l,y,v||!m,{name:"values"})})),r.register("nw13n",(function(e,t){"use strict";var n=r("lKaOf"),i=r("2x0T1"),a=n.aTypedArray,o=n.exportTypedArrayMethod,s=i([].join);o("join",(function(e){return s(a(this),e)}))})),r.register("ladKj",(function(e,t){"use strict";var n=r("lKaOf"),i=r("cn22k"),a=r("hYbqA"),o=n.aTypedArray;(0,n.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return i(a,o(this),t>1?[e,arguments[1]]:[e])}))})),r.register("cF1lk",(function(e,t){"use strict";var n=r("lKaOf"),i=r("9otZn").map,a=r("97HwV"),o=n.aTypedArray;(0,n.exportTypedArrayMethod)("map",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(a(e))(t)}))}))})),r.register("gKW7w",(function(e,t){"use strict";var n=r("lKaOf"),i=r("gwHTU"),a=n.aTypedArrayConstructor;(0,n.exportTypedArrayStaticMethod)("of",(function(){for(var e=0,t=arguments.length,n=new(a(this))(t);t>e;)n[e]=arguments[e++];return n}),i)})),r.register("kh0uM",(function(e,t){"use strict";var n=r("lKaOf"),i=r("ah1Ob").left,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return i(a(this),e,t,t>1?arguments[1]:void 0)}))})),r.register("aHDvk",(function(e,t){"use strict";var n=r("lKaOf"),i=r("ah1Ob").right,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return i(a(this),e,t,t>1?arguments[1]:void 0)}))})),r.register("ka3Iz",(function(e,t){"use strict";var n=r("lKaOf"),i=n.aTypedArray,a=n.exportTypedArrayMethod,o=Math.floor;a("reverse",(function(){for(var e,t=this,n=i(t).length,r=o(n/2),a=0;a<r;)e=t[a],t[a++]=t[--n],t[n]=e;return t}))})),r.register("jhNcH",(function(e,t){"use strict";var n=r("6LGrQ"),i=r("9ZRgk"),a=r("lKaOf"),o=r("9u6Bu"),s=r("1kqup"),l=r("falgx"),c=r("6WghJ"),u=n.RangeError,h=n.Int8Array,p=h&&h.prototype,d=p&&p.set,g=a.aTypedArray,f=a.exportTypedArrayMethod,v=!c((function(){var e=new Uint8ClampedArray(2);return i(d,e,{length:1,0:3},1),3!==e[1]})),m=v&&a.NATIVE_ARRAY_BUFFER_VIEWS&&c((function(){var e=new h(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));f("set",(function(e){g(this);var t=s(arguments.length>1?arguments[1]:void 0,1),n=l(e);if(v)return i(d,this,n,t);var r=this.length,a=o(n),c=0;if(a+t>r)throw u("Wrong length");for(;c<a;)this[t+c]=n[c++]}),!v||m)})),r.register("h47oj",(function(e,t){"use strict";var n=r("lKaOf"),i=r("97HwV"),a=r("6WghJ"),o=r("1fDSm"),s=n.aTypedArray;(0,n.exportTypedArrayMethod)("slice",(function(e,t){for(var n=o(s(this),e,t),r=i(this),a=0,l=n.length,c=new r(l);l>a;)c[a]=n[a++];return c}),a((function(){new Int8Array(1).slice()})))})),r.register("5rlTa",(function(e,t){"use strict";var n=r("lKaOf"),i=r("9otZn").some,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("some",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0)}))})),r.register("7U31A",(function(e,t){"use strict";var n=r("6LGrQ"),i=r("2x0T1"),a=r("6WghJ"),o=r("lEpkd"),s=r("c3NuZ"),l=r("lKaOf"),c=r("efWWg"),u=r("gucwG"),h=r("ipWH0"),p=r("3M0bw"),d=n.Array,g=l.aTypedArray,f=l.exportTypedArrayMethod,v=n.Uint16Array,m=v&&i(v.prototype.sort),y=!(!m||a((function(){m(new v(2),null)}))&&a((function(){m(new v(2),{})}))),x=!!m&&!a((function(){if(h)return h<74;if(c)return c<67;if(u)return!0;if(p)return p<602;var e,t,n=new v(516),r=d(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(m(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==r[e])return!0}));f("sort",(function(e){return void 0!==e&&o(e),x?m(this,e):s(g(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!x||y)})),r.register("7gDrp",(function(e,t){"use strict";var n=r("lKaOf"),i=r("k8phS"),a=r("8BhlN"),o=r("97HwV"),s=n.aTypedArray;(0,n.exportTypedArrayMethod)("subarray",(function(e,t){var n=s(this),r=n.length,l=a(e,r);return new(o(n))(n.buffer,n.byteOffset+l*n.BYTES_PER_ELEMENT,i((void 0===t?r:a(t,r))-l))}))})),r.register("bKl1Y",(function(e,t){"use strict";var n=r("6LGrQ"),i=r("cn22k"),a=r("lKaOf"),o=r("6WghJ"),s=r("1fDSm"),l=n.Int8Array,c=a.aTypedArray,u=a.exportTypedArrayMethod,h=[].toLocaleString,p=!!l&&o((function(){h.call(new l(1))}));u("toLocaleString",(function(){return i(h,p?s(c(this)):c(this),s(arguments))}),o((function(){return[1,2].toLocaleString()!=new l([1,2]).toLocaleString()}))||!o((function(){l.prototype.toLocaleString.call([1,2])})))})),r.register("jXOHG",(function(e,t){"use strict";var n=r("lKaOf").exportTypedArrayMethod,i=r("6WghJ"),a=r("6LGrQ"),o=r("2x0T1"),s=a.Uint8Array,l=s&&s.prototype||{},c=[].toString,u=o([].join);i((function(){c.call({})}))&&(c=function(){return u(this)});var h=l.toString!=c;n("toString",c,h)})),r.register("WnnqW",(function(e,t){"use strict";var n,i=r("6LGrQ"),a=r("2x0T1"),o=r("g2jnF"),s=r("7ahyY"),l=r("6P8eJ"),c=r("lGvw2"),u=r("gczVK"),h=r("kneZa"),p=r("jUSxl").enforce,d=r("g10oc"),g=!i.ActiveXObject&&"ActiveXObject"in i,f=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},v=l("WeakMap",f,c);if(d&&g){n=c.getConstructor(f,"WeakMap",!0),s.enable();var m=v.prototype,y=a(m.delete),x=a(m.has),b=a(m.get),w=a(m.set);o(m,{delete:function(e){if(u(e)&&!h(e)){var t=p(this);return t.frozen||(t.frozen=new n),y(this,e)||t.frozen.delete(e)}return y(this,e)},has:function(e){if(u(e)&&!h(e)){var t=p(this);return t.frozen||(t.frozen=new n),x(this,e)||t.frozen.has(e)}return x(this,e)},get:function(e){if(u(e)&&!h(e)){var t=p(this);return t.frozen||(t.frozen=new n),x(this,e)?b(this,e):t.frozen.get(e)}return b(this,e)},set:function(e,t){if(u(e)&&!h(e)){var r=p(this);r.frozen||(r.frozen=new n),x(this,e)?w(this,e,t):r.frozen.set(e,t)}else w(this,e,t);return this}})}})),r.register("lGvw2",(function(e,t){"use strict";var n=r("2x0T1"),i=r("g2jnF"),a=r("7ahyY").getWeakData,o=r("edAQb"),s=r("gczVK"),l=r("lIgln"),c=r("d8pty"),u=r("9otZn"),h=r("1JB0D"),p=r("jUSxl"),d=p.set,g=p.getterFor,f=u.find,v=u.findIndex,m=n([].splice),y=0,x=function(e){return e.frozen||(e.frozen=new b)},b=function(){this.entries=[]},w=function(e,t){return f(e.entries,(function(e){return e[0]===t}))};b.prototype={get:function(e){var t=w(this,e);if(t)return t[1]},has:function(e){return!!w(this,e)},set:function(e,t){var n=w(this,e);n?n[1]=t:this.entries.push([e,t])},delete:function(e){var t=v(this.entries,(function(t){return t[0]===e}));return~t&&m(this.entries,t,1),!!~t}},e.exports={getConstructor:function(e,t,n,r){var u=e((function(e,i){l(e,p),d(e,{type:t,id:y++,frozen:void 0}),null!=i&&c(i,e[r],{that:e,AS_ENTRIES:n})})),p=u.prototype,f=g(t),v=function(e,t,n){var r=f(e),i=a(o(t),!0);return!0===i?x(r).set(t,n):i[r.id]=n,e};return i(p,{delete:function(e){var t=f(this);if(!s(e))return!1;var n=a(e);return!0===n?x(t).delete(e):n&&h(n,t.id)&&delete n[t.id]},has:function(e){var t=f(this);if(!s(e))return!1;var n=a(e);return!0===n?x(t).has(e):n&&h(n,t.id)}}),i(p,n?{get:function(e){var t=f(this);if(s(e)){var n=a(e);return!0===n?x(t).get(e):n?n[t.id]:void 0}},set:function(e,t){return v(this,e,t)}}:{add:function(e){return v(this,e,!0)}}),u}}})),r.register("GU8j0",(function(e,t){"use strict";r("6P8eJ")("WeakSet",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r("lGvw2"))})),r.register("j4nPZ",(function(e,t){r("d4qau")})),r.register("d4qau",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("c9sXY"),o=r("f4X4V"),s=r("4HLYu"),l=r("jzDTf"),c=r("KFLt0"),u=r("8ihId"),h=r("eqpEX"),p=r("7w1I6"),d=r("fSh1A"),g=r("d8pty"),f=r("l5aDI"),v=r("8RiFY"),m=r("1hDjD"),y=v("toStringTag"),x=i.Error,b=[].push,w=function(e,t){var n,r=arguments.length>2?arguments[2]:void 0,i=a(B,this);s?n=s(new x,i?o(this):B):(n=i?this:c(B),u(n,y,"Error")),void 0!==t&&u(n,"message",f(t)),m&&u(n,"stack",p(n.stack,1)),d(n,r);var l=[];return g(e,b,{that:l}),u(n,"errors",l),n};s?s(w,x):l(w,x,{name:!0});var B=w.prototype=c(x.prototype,{constructor:h(1,w),message:h(1,""),name:h(1,"AggregateError")});n({global:!0},{AggregateError:w})})),r.register("7w1I6",(function(e,t){var n=r("2x0T1")("".replace),i=String(Error("zxcasd").stack),a=/\n\s*at [^:]*:[^\n]*/,o=a.test(i);e.exports=function(e,t){if(o&&"string"==typeof e)for(;t--;)e=n(e,a,"");return e}})),r.register("fSh1A",(function(e,t){var n=r("gczVK"),i=r("8ihId");e.exports=function(e,t){n(t)&&"cause"in t&&i(e,"cause",t.cause)}})),r.register("l5aDI",(function(e,t){var n=r("eXtvS");e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:n(e)}})),r.register("1hDjD",(function(e,t){var n=r("6WghJ"),i=r("eqpEX");e.exports=!n((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",i(1,7)),7!==e.stack)}))})),r.register("fk2yb",(function(e,t){"use strict";var n=r("A56Kx"),i=r("d9AHO"),a=r("falgx"),o=r("9u6Bu"),s=r("bLi0c").f;n&&!("lastIndex"in[])&&(s(Array.prototype,"lastIndex",{configurable:!0,get:function(){var e=a(this),t=o(e);return 0==t?0:t-1}}),i("lastIndex"))})),r.register("fJkZ6",(function(e,t){"use strict";var n=r("A56Kx"),i=r("d9AHO"),a=r("falgx"),o=r("9u6Bu"),s=r("bLi0c").f;n&&!("lastItem"in[])&&(s(Array.prototype,"lastItem",{configurable:!0,get:function(){var e=a(this),t=o(e);return 0==t?void 0:e[t-1]},set:function(e){var t=a(this),n=o(t);return t[0==n?0:n-1]=e}}),i("lastItem"))})),r.register("1RDb0",(function(e,t){var n=r("JGbI2"),i=r("6LGrQ"),a=r("cn22k"),o=r("8p7xn"),s=r("fdCuf"),l=r("KFLt0"),c=i.Object,u=function(){var e=s("Object","freeze");return e?e(l(null)):l(null)};n({global:!0},{compositeKey:function(){return a(o,c,arguments).get("object",u)}})})),r.register("8p7xn",(function(e,t){r("99yfV"),r("WnnqW");var n=r("6LGrQ"),i=r("fdCuf"),a=r("KFLt0"),o=r("gczVK"),s=n.Object,l=n.TypeError,c=i("Map"),u=i("WeakMap"),h=function(){this.object=null,this.symbol=null,this.primitives=null,this.objectsByIndex=a(null)};h.prototype.get=function(e,t){return this[e]||(this[e]=t())},h.prototype.next=function(e,t,n){var r=n?this.objectsByIndex[e]||(this.objectsByIndex[e]=new u):this.primitives||(this.primitives=new c),i=r.get(t);return i||r.set(t,i=new h),i};var p=new h;e.exports=function(){var e,t,n=p,r=arguments.length;for(e=0;e<r;e++)o(t=arguments[e])&&(n=n.next(e,t,!0));if(this===s&&n===p)throw l("Composite keys must contain a non-primitive component");for(e=0;e<r;e++)o(t=arguments[e])||(n=n.next(e,t,!1));return n}})),r.register("eCXCW",(function(e,t){var n=r("JGbI2"),i=r("8p7xn"),a=r("fdCuf"),o=r("cn22k");n({global:!0},{compositeSymbol:function(){return 1==arguments.length&&"string"==typeof arguments[0]?a("Symbol").for(arguments[0]):o(i,null,arguments).get("symbol",a("Symbol"))}})})),r.register("cboi3",(function(e,t){r("im4u0")})),r.register("im4u0",(function(e,t){r("JGbI2")({global:!0},{globalThis:r("6LGrQ")})})),r.register("ej9nm",(function(e,t){"use strict";r("JGbI2")({target:"Map",proto:!0,real:!0,forced:r("bMhTS")},{deleteAll:r("5T8Hb")})})),r.register("5T8Hb",(function(e,t){"use strict";var n=r("9ZRgk"),i=r("lEpkd"),a=r("edAQb");e.exports=function(){for(var e,t=a(this),r=i(t.delete),o=!0,s=0,l=arguments.length;s<l;s++)e=n(r,t,arguments[s]),o=o&&e;return!!o}})),r.register("jZZp4",(function(e,t){"use strict";var n=r("JGbI2"),i=r("bMhTS"),a=r("edAQb"),o=r("gAXAR"),s=r("7AisJ"),l=r("d8pty");n({target:"Map",proto:!0,real:!0,forced:i},{every:function(e){var t=a(this),n=s(t),r=o(e,arguments.length>1?arguments[1]:void 0);return!l(n,(function(e,n,i){if(!r(n,e,t))return i()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})})),r.register("7AisJ",(function(e,t){var n=r("9ZRgk");e.exports=function(e){return n(Map.prototype.entries,e)}})),r.register("1Fdpk",(function(e,t){"use strict";var n=r("bMhTS"),i=r("JGbI2"),a=r("fdCuf"),o=r("gAXAR"),s=r("9ZRgk"),l=r("lEpkd"),c=r("edAQb"),u=r("4xaB6"),h=r("7AisJ"),p=r("d8pty");i({target:"Map",proto:!0,real:!0,forced:n},{filter:function(e){var t=c(this),n=h(t),r=o(e,arguments.length>1?arguments[1]:void 0),i=new(u(t,a("Map"))),d=l(i.set);return p(n,(function(e,n){r(n,e,t)&&s(d,i,e,n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}})})),r.register("2Xd9T",(function(e,t){"use strict";var n=r("JGbI2"),i=r("bMhTS"),a=r("edAQb"),o=r("gAXAR"),s=r("7AisJ"),l=r("d8pty");n({target:"Map",proto:!0,real:!0,forced:i},{find:function(e){var t=a(this),n=s(t),r=o(e,arguments.length>1?arguments[1]:void 0);return l(n,(function(e,n,i){if(r(n,e,t))return i(n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}})})),r.register("hMGEZ",(function(e,t){"use strict";var n=r("JGbI2"),i=r("bMhTS"),a=r("edAQb"),o=r("gAXAR"),s=r("7AisJ"),l=r("d8pty");n({target:"Map",proto:!0,real:!0,forced:i},{findKey:function(e){var t=a(this),n=s(t),r=o(e,arguments.length>1?arguments[1]:void 0);return l(n,(function(e,n,i){if(r(n,e,t))return i(e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}})})),r.register("bZDCM",(function(e,t){r("JGbI2")({target:"Map",stat:!0},{from:r("iDq5m")})})),r.register("iDq5m",(function(e,t){"use strict";var n=r("gAXAR"),i=r("9ZRgk"),a=r("lEpkd"),o=r("3Z9Nz"),s=r("d8pty"),l=[].push;e.exports=function(e){var t,r,c,u,h=arguments.length,p=h>1?arguments[1]:void 0;return o(this),(t=void 0!==p)&&a(p),null==e?new this:(r=[],t?(c=0,u=n(p,h>2?arguments[2]:void 0),s(e,(function(e){i(l,r,u(e,c++))}))):s(e,l,{that:r}),new this(r))}})),r.register("3iuTX",(function(e,t){"use strict";var n=r("JGbI2"),i=r("9ZRgk"),a=r("2x0T1"),o=r("lEpkd"),s=r("g3ZOP"),l=r("d8pty"),c=a([].push);n({target:"Map",stat:!0},{groupBy:function(e,t){o(t);var n=s(e),r=new this,a=o(r.has),u=o(r.get),h=o(r.set);return l(n,(function(e){var n=t(e);i(a,r,n)?c(i(u,r,n),e):i(h,r,n,[e])}),{IS_ITERATOR:!0}),r}})})),r.register("kIokh",(function(e,t){"use strict";var n=r("bMhTS"),i=r("JGbI2"),a=r("edAQb"),o=r("7AisJ"),s=r("j1P8I"),l=r("d8pty");i({target:"Map",proto:!0,real:!0,forced:n},{includes:function(e){return l(o(a(this)),(function(t,n,r){if(s(n,e))return r()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})})),r.register("j1P8I",(function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}})),r.register("2sNOJ",(function(e,t){"use strict";var n=r("JGbI2"),i=r("9ZRgk"),a=r("d8pty"),o=r("lEpkd");n({target:"Map",stat:!0},{keyBy:function(e,t){var n=new this;o(t);var r=o(n.set);return a(e,(function(e){i(r,n,t(e),e)})),n}})})),r.register("1lj6k",(function(e,t){"use strict";var n=r("JGbI2"),i=r("bMhTS"),a=r("edAQb"),o=r("7AisJ"),s=r("d8pty");n({target:"Map",proto:!0,real:!0,forced:i},{keyOf:function(e){return s(o(a(this)),(function(t,n,r){if(n===e)return r(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}})})),r.register("4Ozez",(function(e,t){"use strict";var n=r("bMhTS"),i=r("JGbI2"),a=r("fdCuf"),o=r("gAXAR"),s=r("9ZRgk"),l=r("lEpkd"),c=r("edAQb"),u=r("4xaB6"),h=r("7AisJ"),p=r("d8pty");i({target:"Map",proto:!0,real:!0,forced:n},{mapKeys:function(e){var t=c(this),n=h(t),r=o(e,arguments.length>1?arguments[1]:void 0),i=new(u(t,a("Map"))),d=l(i.set);return p(n,(function(e,n){s(d,i,r(n,e,t),n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}})})),r.register("6xUV5",(function(e,t){"use strict";var n=r("bMhTS"),i=r("JGbI2"),a=r("fdCuf"),o=r("gAXAR"),s=r("9ZRgk"),l=r("lEpkd"),c=r("edAQb"),u=r("4xaB6"),h=r("7AisJ"),p=r("d8pty");i({target:"Map",proto:!0,real:!0,forced:n},{mapValues:function(e){var t=c(this),n=h(t),r=o(e,arguments.length>1?arguments[1]:void 0),i=new(u(t,a("Map"))),d=l(i.set);return p(n,(function(e,n){s(d,i,e,r(n,e,t))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}})})),r.register("1XiOT",(function(e,t){"use strict";var n=r("JGbI2"),i=r("bMhTS"),a=r("lEpkd"),o=r("edAQb"),s=r("d8pty");n({target:"Map",proto:!0,real:!0,forced:i},{merge:function(e){for(var t=o(this),n=a(t.set),r=arguments.length,i=0;i<r;)s(arguments[i++],n,{that:t,AS_ENTRIES:!0});return t}})})),r.register("fLwrF",(function(e,t){r("JGbI2")({target:"Map",stat:!0},{of:r("gBVpi")})})),r.register("gBVpi",(function(e,t){"use strict";var n=r("1fDSm");e.exports=function(){return new this(n(arguments))}})),r.register("15Boy",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("bMhTS"),o=r("edAQb"),s=r("lEpkd"),l=r("7AisJ"),c=r("d8pty"),u=i.TypeError;n({target:"Map",proto:!0,real:!0,forced:a},{reduce:function(e){var t=o(this),n=l(t),r=arguments.length<2,i=r?void 0:arguments[1];if(s(e),c(n,(function(n,a){r?(r=!1,i=a):i=e(i,a,n,t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),r)throw u("Reduce of empty map with no initial value");return i}})})),r.register("4lauO",(function(e,t){"use strict";var n=r("JGbI2"),i=r("bMhTS"),a=r("edAQb"),o=r("gAXAR"),s=r("7AisJ"),l=r("d8pty");n({target:"Map",proto:!0,real:!0,forced:i},{some:function(e){var t=a(this),n=s(t),r=o(e,arguments.length>1?arguments[1]:void 0);return l(n,(function(e,n,i){if(r(n,e,t))return i()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})})),r.register("7CWQc",(function(e,t){"use strict";var n=r("bMhTS"),i=r("JGbI2"),a=r("6LGrQ"),o=r("9ZRgk"),s=r("edAQb"),l=r("lEpkd"),c=a.TypeError;i({target:"Map",proto:!0,real:!0,forced:n},{update:function(e,t){var n=s(this),r=l(n.get),i=l(n.has),a=l(n.set),u=arguments.length;l(t);var h=o(i,n,e);if(!h&&u<3)throw c("Updating absent value");var p=h?o(r,n,e):l(u>2?arguments[2]:void 0)(e,n);return o(a,n,e,t(p,e,n)),n}})})),r.register("d9SMF",(function(e,t){var n=r("JGbI2"),i=Math.min,a=Math.max;n({target:"Math",stat:!0},{clamp:function(e,t,n){return i(n,a(t,e))}})})),r.register("63lU7",(function(e,t){r("JGbI2")({target:"Math",stat:!0},{DEG_PER_RAD:Math.PI/180})})),r.register("ayEdr",(function(e,t){var n=r("JGbI2"),i=180/Math.PI;n({target:"Math",stat:!0},{degrees:function(e){return e*i}})})),r.register("7Gwyo",(function(e,t){var n=r("JGbI2"),i=r("ax2Zy"),a=r("kPZzt");n({target:"Math",stat:!0},{fscale:function(e,t,n,r,o){return a(i(e,t,n,r,o))}})})),r.register("ax2Zy",(function(e,t){e.exports=Math.scale||function(e,t,n,r,i){var a=+e,o=+t,s=+n,l=+r,c=+i;return a!=a||o!=o||s!=s||l!=l||c!=c?NaN:a===1/0||a===-1/0?a:(a-o)*(c-l)/(s-o)+l}})),r.register("3iYKH",(function(e,t){r("JGbI2")({target:"Math",stat:!0},{iaddh:function(e,t,n,r){var i=e>>>0,a=n>>>0;return(t>>>0)+(r>>>0)+((i&a|(i|a)&~(i+a>>>0))>>>31)|0}})})),r.register("dHv2h",(function(e,t){r("JGbI2")({target:"Math",stat:!0},{imulh:function(e,t){var n=65535,r=+e,i=+t,a=r&n,o=i&n,s=r>>16,l=i>>16,c=(s*o>>>0)+(a*o>>>16);return s*l+(c>>16)+((a*l>>>0)+(c&n)>>16)}})})),r.register("kXm0w",(function(e,t){r("JGbI2")({target:"Math",stat:!0},{isubh:function(e,t,n,r){var i=e>>>0,a=n>>>0;return(t>>>0)-(r>>>0)-((~i&a|~(i^a)&i-a>>>0)>>>31)|0}})})),r.register("kjhYX",(function(e,t){r("JGbI2")({target:"Math",stat:!0},{RAD_PER_DEG:180/Math.PI})})),r.register("ba392",(function(e,t){var n=r("JGbI2"),i=Math.PI/180;n({target:"Math",stat:!0},{radians:function(e){return e*i}})})),r.register("aKc2e",(function(e,t){r("JGbI2")({target:"Math",stat:!0},{scale:r("ax2Zy")})})),r.register("biXeg",(function(e,t){var n=r("JGbI2"),i=r("6LGrQ"),a=r("edAQb"),o=r("4JrHk"),s=r("bGPs6"),l=r("jUSxl"),c="Seeded Random",u="Seeded Random Generator",h=l.set,p=l.getterFor(u),d=i.TypeError,g=s((function(e){h(this,{type:u,seed:e%2147483647})}),c,(function(){var e=p(this);return{value:(1073741823&(e.seed=(1103515245*e.seed+12345)%2147483647))/1073741823,done:!1}}));n({target:"Math",stat:!0,forced:!0},{seededPRNG:function(e){var t=a(e).seed;if(!o(t))throw d('Math.seededPRNG() argument should have a "seed" field with a finite value.');return new g(t)}})})),r.register("lom9E",(function(e,t){r("JGbI2")({target:"Math",stat:!0},{signbit:function(e){return(e=+e)==e&&0==e?1/e==-1/0:e<0}})})),r.register("aamP5",(function(e,t){r("JGbI2")({target:"Math",stat:!0},{umulh:function(e,t){var n=65535,r=+e,i=+t,a=r&n,o=i&n,s=r>>>16,l=i>>>16,c=(s*o>>>0)+(a*o>>>16);return s*l+(c>>>16)+((a*l>>>0)+(c&n)>>>16)}})})),r.register("3FV0H",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("2x0T1"),o=r("3Hjrl"),s=r("9W5cg"),l="Invalid number representation",c=i.RangeError,u=i.SyntaxError,h=i.TypeError,p=/^[\da-z]+$/,d=a("".charAt),g=a(p.exec),f=a(1..toString),v=a("".slice);n({target:"Number",stat:!0},{fromString:function(e,t){var n,r,i=1;if("string"!=typeof e)throw h(l);if(!e.length)throw u(l);if("-"==d(e,0)&&(i=-1,!(e=v(e,1)).length))throw u(l);if((n=void 0===t?10:o(t))<2||n>36)throw c("Invalid radix");if(!g(p,e)||f(r=s(e,n),n)!==e)throw u(l);return i*r}})})),r.register("1zLZr",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("9ZRgk"),o=r("A56Kx"),s=r("b5zq9"),l=r("lEpkd"),c=r("3HoBU"),u=r("iHD1w"),h=r("edAQb"),p=r("gczVK"),d=r("lIgln"),g=r("bLi0c").f,f=r("8Opqg"),v=r("g2jnF"),m=r("g3ZOP"),y=r("3Xhmk"),x=r("d8pty"),b=r("46Eeh"),w=r("8RiFY"),B=r("jUSxl"),C=w("observable"),S="Observable",k="Subscription",L="SubscriptionObserver",A=B.getterFor,T=B.set,I=A(S),E=A(k),M=A(L),R=i.Array,O=function(e){this.observer=h(e),this.cleanup=void 0,this.subscriptionObserver=void 0};O.prototype={type:k,clean:function(){var e=this.cleanup;if(e){this.cleanup=void 0;try{e()}catch(e){b(e)}}},close:function(){if(!o){var e=this.facade,t=this.subscriptionObserver;e.closed=!0,t&&(t.closed=!0)}this.observer=void 0},isClosed:function(){return void 0===this.observer}};var P=function(e,t){var n,r=T(this,new O(e));o||(this.closed=!1);try{(n=y(e,"start"))&&a(n,e,this)}catch(e){b(e)}if(!r.isClosed()){var i=r.subscriptionObserver=new D(r);try{var s=t(i),u=s;null!=s&&(r.cleanup=c(s.unsubscribe)?function(){u.unsubscribe()}:l(s))}catch(e){return void i.error(e)}r.isClosed()&&r.clean()}};P.prototype=v({},{unsubscribe:function(){var e=E(this);e.isClosed()||(e.close(),e.clean())}}),o&&g(P.prototype,"closed",{configurable:!0,get:function(){return E(this).isClosed()}});var D=function(e){T(this,{type:L,subscriptionState:e}),o||(this.closed=!1)};D.prototype=v({},{next:function(e){var t=M(this).subscriptionState;if(!t.isClosed()){var n=t.observer;try{var r=y(n,"next");r&&a(r,n,e)}catch(e){b(e)}}},error:function(e){var t=M(this).subscriptionState;if(!t.isClosed()){var n=t.observer;t.close();try{var r=y(n,"error");r?a(r,n,e):b(e)}catch(e){b(e)}t.clean()}},complete:function(){var e=M(this).subscriptionState;if(!e.isClosed()){var t=e.observer;e.close();try{var n=y(t,"complete");n&&a(n,t)}catch(e){b(e)}e.clean()}}}),o&&g(D.prototype,"closed",{configurable:!0,get:function(){return M(this).subscriptionState.isClosed()}});var G=function(e){d(this,N),T(this,{type:S,subscriber:l(e)})},N=G.prototype;v(N,{subscribe:function(e){var t=arguments.length;return new P(c(e)?{next:e,error:t>1?arguments[1]:void 0,complete:t>2?arguments[2]:void 0}:p(e)?e:{},I(this).subscriber)}}),v(G,{from:function(e){var t=u(this)?this:G,n=y(h(e),C);if(n){var r=h(a(n,e));return r.constructor===t?r:new t((function(e){return r.subscribe(e)}))}var i=m(e);return new t((function(e){x(i,(function(t,n){if(e.next(t),e.closed)return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}),e.complete()}))},of:function(){for(var e=u(this)?this:G,t=arguments.length,n=R(t),r=0;r<t;)n[r]=arguments[r++];return new e((function(e){for(var r=0;r<t;r++)if(e.next(n[r]),e.closed)return;e.complete()}))}}),f(N,C,(function(){return this})),n({global:!0},{Observable:G}),s(S)})),r.register("6nTC9",(function(e,t){r("ibUrc")})),r.register("ibUrc",(function(e,t){"use strict";var n=r("JGbI2"),i=r("9ZRgk"),a=r("lEpkd"),o=r("4l0Z8"),s=r("emrW7"),l=r("d8pty");n({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=o.f(t),r=n.resolve,c=n.reject,u=s((function(){var n=a(t.resolve),o=[],s=0,c=1;l(e,(function(e){var a=s++,l=!1;c++,i(n,t,e).then((function(e){l||(l=!0,o[a]={status:"fulfilled",value:e},--c||r(o))}),(function(e){l||(l=!0,o[a]={status:"rejected",reason:e},--c||r(o))}))})),--c||r(o)}));return u.error&&c(u.value),n.promise}})})),r.register("hKO3L",(function(e,t){r("jptYU")})),r.register("jptYU",(function(e,t){"use strict";var n=r("JGbI2"),i=r("lEpkd"),a=r("fdCuf"),o=r("9ZRgk"),s=r("4l0Z8"),l=r("emrW7"),c=r("d8pty"),u="No one promise resolved";n({target:"Promise",stat:!0},{any:function(e){var t=this,n=a("AggregateError"),r=s.f(t),h=r.resolve,p=r.reject,d=l((function(){var r=i(t.resolve),a=[],s=0,l=1,d=!1;c(e,(function(e){var i=s++,c=!1;l++,o(r,t,e).then((function(e){c||d||(d=!0,h(e))}),(function(e){c||d||(c=!0,a[i]=e,--l||p(new n(a,u)))}))})),--l||p(new n(a,u))}));return d.error&&p(d.value),r.promise}})})),r.register("dgelS",(function(e,t){"use strict";var n=r("JGbI2"),i=r("4l0Z8"),a=r("emrW7");n({target:"Promise",stat:!0},{try:function(e){var t=i.f(this),n=a(e);return(n.error?t.reject:t.resolve)(n.value),t.promise}})})),r.register("9vFTV",(function(e,t){var n=r("JGbI2"),i=r("aLynb"),a=r("edAQb"),o=i.toKey,s=i.set;n({target:"Reflect",stat:!0},{defineMetadata:function(e,t,n){var r=arguments.length<4?void 0:o(arguments[3]);s(e,t,a(n),r)}})})),r.register("aLynb",(function(e,t){var n=r("4gaLD");r("99yfV"),r("WnnqW");var i=r("fdCuf"),a=r("2x0T1"),o=r("eW5R0"),s=i("Map"),l=i("WeakMap"),c=a([].push),u=o("metadata"),h=u.store||(u.store=new l),p=function(e,t,n){var r=h.get(e);if(!r){if(!n)return;h.set(e,r=new s)}var i=r.get(t);if(!i){if(!n)return;r.set(t,i=new s)}return i};e.exports={store:h,getMap:p,has:function(e,t,n){var r=p(t,n,!1);return void 0!==r&&r.has(e)},get:function(e,t,n){var r=p(t,n,!1);return void 0===r?void 0:r.get(e)},set:function(e,t,n,r){p(n,r,!0).set(e,t)},keys:function(e,t){var n=p(e,t,!1),r=[];return n&&n.forEach((function(e,t){c(r,t)})),r},toKey:function(e){return void 0===e||"symbol"==(void 0===e?"undefined":n.typeOf(e))?e:String(e)}}})),r.register("diSfj",(function(e,t){var n=r("JGbI2"),i=r("aLynb"),a=r("edAQb"),o=i.toKey,s=i.getMap,l=i.store;n({target:"Reflect",stat:!0},{deleteMetadata:function(e,t){var n=arguments.length<3?void 0:o(arguments[2]),r=s(a(t),n,!1);if(void 0===r||!r.delete(e))return!1;if(r.size)return!0;var i=l.get(t);return i.delete(n),!!i.size||l.delete(t)}})})),r.register("kLDiZ",(function(e,t){var n=r("JGbI2"),i=r("aLynb"),a=r("edAQb"),o=r("f4X4V"),s=i.has,l=i.get,c=i.toKey,u=function(e,t,n){if(s(e,t,n))return l(e,t,n);var r=o(t);return null!==r?u(e,r,n):void 0};n({target:"Reflect",stat:!0},{getMetadata:function(e,t){var n=arguments.length<3?void 0:c(arguments[2]);return u(e,a(t),n)}})})),r.register("lVKny",(function(e,t){var n=r("JGbI2"),i=r("2x0T1"),a=r("aLynb"),o=r("edAQb"),s=r("f4X4V"),l=i(r("7wkLw")),c=i([].concat),u=a.keys,h=a.toKey,p=function(e,t){var n=u(e,t),r=s(e);if(null===r)return n;var i=p(r,t);return i.length?n.length?l(c(n,i)):i:n};n({target:"Reflect",stat:!0},{getMetadataKeys:function(e){var t=arguments.length<2?void 0:h(arguments[1]);return p(o(e),t)}})})),r.register("7wkLw",(function(e,t){"use strict";var n=r("fdCuf"),i=r("2x0T1"),a=r("lEpkd"),o=r("9u6Bu"),s=r("falgx"),l=r("ab5jG"),c=n("Map"),u=c.prototype,h=i(u.forEach),p=i(u.has),d=i(u.set),g=i([].push);e.exports=function(e){var t,n,r,i=s(this),u=o(i),f=l(i,0),v=new c,m=null!=e?a(e):function(e){return e};for(t=0;t<u;t++)r=m(n=i[t]),p(v,r)||d(v,r,n);return h(v,(function(e){g(f,e)})),f}})),r.register("9I8rX",(function(e,t){var n=r("JGbI2"),i=r("aLynb"),a=r("edAQb"),o=i.get,s=i.toKey;n({target:"Reflect",stat:!0},{getOwnMetadata:function(e,t){var n=arguments.length<3?void 0:s(arguments[2]);return o(e,a(t),n)}})})),r.register("2970r",(function(e,t){var n=r("JGbI2"),i=r("aLynb"),a=r("edAQb"),o=i.keys,s=i.toKey;n({target:"Reflect",stat:!0},{getOwnMetadataKeys:function(e){var t=arguments.length<2?void 0:s(arguments[1]);return o(a(e),t)}})})),r.register("kMNNB",(function(e,t){var n=r("JGbI2"),i=r("aLynb"),a=r("edAQb"),o=r("f4X4V"),s=i.has,l=i.toKey,c=function(e,t,n){if(s(e,t,n))return!0;var r=o(t);return null!==r&&c(e,r,n)};n({target:"Reflect",stat:!0},{hasMetadata:function(e,t){var n=arguments.length<3?void 0:l(arguments[2]);return c(e,a(t),n)}})})),r.register("ewKQm",(function(e,t){var n=r("JGbI2"),i=r("aLynb"),a=r("edAQb"),o=i.has,s=i.toKey;n({target:"Reflect",stat:!0},{hasOwnMetadata:function(e,t){var n=arguments.length<3?void 0:s(arguments[2]);return o(e,a(t),n)}})})),r.register("celFa",(function(e,t){var n=r("JGbI2"),i=r("aLynb"),a=r("edAQb"),o=i.toKey,s=i.set;n({target:"Reflect",stat:!0},{metadata:function(e,t){return function(n,r){s(e,t,a(n),o(r))}}})})),r.register("khNxJ",(function(e,t){"use strict";r("JGbI2")({target:"Set",proto:!0,real:!0,forced:r("bMhTS")},{addAll:r("gjkZM")})})),r.register("gjkZM",(function(e,t){"use strict";var n=r("9ZRgk"),i=r("lEpkd"),a=r("edAQb");e.exports=function(){for(var e=a(this),t=i(e.add),r=0,o=arguments.length;r<o;r++)n(t,e,arguments[r]);return e}})),r.register("1YHMm",(function(e,t){"use strict";r("JGbI2")({target:"Set",proto:!0,real:!0,forced:r("bMhTS")},{deleteAll:r("5T8Hb")})})),r.register("aVIMC",(function(e,t){"use strict";var n=r("bMhTS"),i=r("JGbI2"),a=r("fdCuf"),o=r("9ZRgk"),s=r("lEpkd"),l=r("edAQb"),c=r("4xaB6"),u=r("d8pty");i({target:"Set",proto:!0,real:!0,forced:n},{difference:function(e){var t=l(this),n=new(c(t,a("Set")))(t),r=s(n.delete);return u(e,(function(e){o(r,n,e)})),n}})})),r.register("8VwCG",(function(e,t){"use strict";var n=r("JGbI2"),i=r("bMhTS"),a=r("edAQb"),o=r("gAXAR"),s=r("iEP2p"),l=r("d8pty");n({target:"Set",proto:!0,real:!0,forced:i},{every:function(e){var t=a(this),n=s(t),r=o(e,arguments.length>1?arguments[1]:void 0);return!l(n,(function(e,n){if(!r(e,e,t))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})})),r.register("iEP2p",(function(e,t){var n=r("9ZRgk");e.exports=function(e){return n(Set.prototype.values,e)}})),r.register("gIPra",(function(e,t){"use strict";var n=r("bMhTS"),i=r("JGbI2"),a=r("fdCuf"),o=r("9ZRgk"),s=r("lEpkd"),l=r("edAQb"),c=r("gAXAR"),u=r("4xaB6"),h=r("iEP2p"),p=r("d8pty");i({target:"Set",proto:!0,real:!0,forced:n},{filter:function(e){var t=l(this),n=h(t),r=c(e,arguments.length>1?arguments[1]:void 0),i=new(u(t,a("Set"))),d=s(i.add);return p(n,(function(e){r(e,e,t)&&o(d,i,e)}),{IS_ITERATOR:!0}),i}})})),r.register("7dmhb",(function(e,t){"use strict";var n=r("JGbI2"),i=r("bMhTS"),a=r("edAQb"),o=r("gAXAR"),s=r("iEP2p"),l=r("d8pty");n({target:"Set",proto:!0,real:!0,forced:i},{find:function(e){var t=a(this),n=s(t),r=o(e,arguments.length>1?arguments[1]:void 0);return l(n,(function(e,n){if(r(e,e,t))return n(e)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}})})),r.register("jkBqo",(function(e,t){r("JGbI2")({target:"Set",stat:!0},{from:r("iDq5m")})})),r.register("8drF5",(function(e,t){"use strict";var n=r("bMhTS"),i=r("JGbI2"),a=r("fdCuf"),o=r("9ZRgk"),s=r("lEpkd"),l=r("edAQb"),c=r("4xaB6"),u=r("d8pty");i({target:"Set",proto:!0,real:!0,forced:n},{intersection:function(e){var t=l(this),n=new(c(t,a("Set"))),r=s(t.has),i=s(n.add);return u(e,(function(e){o(r,t,e)&&o(i,n,e)})),n}})})),r.register("iYMug",(function(e,t){"use strict";var n=r("bMhTS"),i=r("JGbI2"),a=r("9ZRgk"),o=r("lEpkd"),s=r("edAQb"),l=r("d8pty");i({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:function(e){var t=s(this),n=o(t.has);return!l(e,(function(e,r){if(!0===a(n,t,e))return r()}),{INTERRUPTED:!0}).stopped}})})),r.register("dsRj4",(function(e,t){"use strict";var n=r("bMhTS"),i=r("JGbI2"),a=r("fdCuf"),o=r("9ZRgk"),s=r("lEpkd"),l=r("3HoBU"),c=r("edAQb"),u=r("g3ZOP"),h=r("d8pty");i({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:function(e){var t=u(this),n=c(e),r=n.has;return l(r)||(n=new(a("Set"))(e),r=s(n.has)),!h(t,(function(e,t){if(!1===o(r,n,e))return t()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})})),r.register("3p37D",(function(e,t){"use strict";var n=r("bMhTS"),i=r("JGbI2"),a=r("9ZRgk"),o=r("lEpkd"),s=r("edAQb"),l=r("d8pty");i({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:function(e){var t=s(this),n=o(t.has);return!l(e,(function(e,r){if(!1===a(n,t,e))return r()}),{INTERRUPTED:!0}).stopped}})})),r.register("f0D6D",(function(e,t){"use strict";var n=r("bMhTS"),i=r("JGbI2"),a=r("2x0T1"),o=r("edAQb"),s=r("eXtvS"),l=r("iEP2p"),c=r("d8pty"),u=a([].join),h=[].push;i({target:"Set",proto:!0,real:!0,forced:n},{join:function(e){var t=o(this),n=l(t),r=void 0===e?",":s(e),i=[];return c(n,h,{that:i,IS_ITERATOR:!0}),u(i,r)}})})),r.register("hqZAm",(function(e,t){"use strict";var n=r("bMhTS"),i=r("JGbI2"),a=r("fdCuf"),o=r("gAXAR"),s=r("9ZRgk"),l=r("lEpkd"),c=r("edAQb"),u=r("4xaB6"),h=r("iEP2p"),p=r("d8pty");i({target:"Set",proto:!0,real:!0,forced:n},{map:function(e){var t=c(this),n=h(t),r=o(e,arguments.length>1?arguments[1]:void 0),i=new(u(t,a("Set"))),d=l(i.add);return p(n,(function(e){s(d,i,r(e,e,t))}),{IS_ITERATOR:!0}),i}})})),r.register("g90ks",(function(e,t){r("JGbI2")({target:"Set",stat:!0},{of:r("gBVpi")})})),r.register("3iQdG",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("bMhTS"),o=r("lEpkd"),s=r("edAQb"),l=r("iEP2p"),c=r("d8pty"),u=i.TypeError;n({target:"Set",proto:!0,real:!0,forced:a},{reduce:function(e){var t=s(this),n=l(t),r=arguments.length<2,i=r?void 0:arguments[1];if(o(e),c(n,(function(n){r?(r=!1,i=n):i=e(i,n,n,t)}),{IS_ITERATOR:!0}),r)throw u("Reduce of empty set with no initial value");return i}})})),r.register("215Xh",(function(e,t){"use strict";var n=r("JGbI2"),i=r("bMhTS"),a=r("edAQb"),o=r("gAXAR"),s=r("iEP2p"),l=r("d8pty");n({target:"Set",proto:!0,real:!0,forced:i},{some:function(e){var t=a(this),n=s(t),r=o(e,arguments.length>1?arguments[1]:void 0);return l(n,(function(e,n){if(r(e,e,t))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})})),r.register("3hs7E",(function(e,t){"use strict";var n=r("bMhTS"),i=r("JGbI2"),a=r("fdCuf"),o=r("9ZRgk"),s=r("lEpkd"),l=r("edAQb"),c=r("4xaB6"),u=r("d8pty");i({target:"Set",proto:!0,real:!0,forced:n},{symmetricDifference:function(e){var t=l(this),n=new(c(t,a("Set")))(t),r=s(n.delete),i=s(n.add);return u(e,(function(e){o(r,n,e)||o(i,n,e)})),n}})})),r.register("3FGl4",(function(e,t){"use strict";var n=r("JGbI2"),i=r("bMhTS"),a=r("fdCuf"),o=r("lEpkd"),s=r("edAQb"),l=r("4xaB6"),c=r("d8pty");n({target:"Set",proto:!0,real:!0,forced:i},{union:function(e){var t=s(this),n=new(l(t,a("Set")))(t);return c(e,o(n.add),{that:n}),n}})})),r.register("5X1AL",(function(e,t){"use strict";var n=r("JGbI2"),i=r("57ZgD").charAt,a=r("6WghJ"),o=r("0dsEW"),s=r("3Hjrl"),l=r("eXtvS");n({target:"String",proto:!0,forced:a((function(){return"𠮷"!=="𠮷".at(-2)}))},{at:function(e){var t=l(o(this)),n=t.length,r=s(e),a=r>=0?r:n+r;return a<0||a>=n?void 0:i(t,a)}})})),r.register("gjLWg",(function(e,t){"use strict";var n=r("JGbI2"),i=r("bGPs6"),a=r("0dsEW"),o=r("eXtvS"),s=r("jUSxl"),l=r("57ZgD"),c=l.codeAt,u=l.charAt,h="String Iterator",p=s.set,d=s.getterFor(h),g=i((function(e){p(this,{type:h,string:e,index:0})}),"String",(function(){var e,t=d(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=u(n,r),t.index+=e.length,{value:{codePoint:c(e,0),position:r},done:!1})}));n({target:"String",proto:!0},{codePoints:function(){return new g(o(a(this)))}})})),r.register("jDJfp",(function(e,t){r("6i9Ww")})),r.register("6i9Ww",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("9ZRgk"),o=r("2x0T1"),s=r("bGPs6"),l=r("0dsEW"),c=r("k8phS"),u=r("eXtvS"),h=r("edAQb"),p=r("lrHHl"),d=r("c9sXY"),g=r("j7Wj1"),f=r("1wkuT"),v=r("3Xhmk"),m=r("8Opqg"),y=r("6WghJ"),x=r("8RiFY"),b=r("4xaB6"),w=r("6DNPg"),B=r("2aUTa"),C=r("jUSxl"),S=r("bMhTS"),k=x("matchAll"),L="RegExp String",A="RegExp String Iterator",T=C.set,I=C.getterFor(A),E=RegExp.prototype,M=i.TypeError,R=o(f),O=o("".indexOf),P=o("".matchAll),D=!!P&&!y((function(){P("a",/./)})),G=s((function(e,t,n,r){T(this,{type:A,regexp:e,string:t,global:n,unicode:r,done:!1})}),L,(function(){var e=I(this);if(e.done)return{value:void 0,done:!0};var t=e.regexp,n=e.string,r=B(t,n);return null===r?{value:void 0,done:e.done=!0}:e.global?(""===u(r[0])&&(t.lastIndex=w(n,c(t.lastIndex),e.unicode)),{value:r,done:!1}):(e.done=!0,{value:r,done:!1})})),N=function(e){var t,n,r,i,a,o,s=h(this),l=u(e);return t=b(s,RegExp),void 0===(n=s.flags)&&d(E,s)&&!("flags"in E)&&(n=R(s)),r=void 0===n?"":u(n),i=new t(t===RegExp?s.source:s,r),a=!!~O(r,"g"),o=!!~O(r,"u"),i.lastIndex=c(s.lastIndex),new G(i,l,a,o)};n({target:"String",proto:!0,forced:D},{matchAll:function(e){var t,n,r,i,o=l(this);if(null!=e){if(g(e)&&(t=u(l("flags"in E?e.flags:R(e))),!~O(t,"g")))throw M("`.matchAll` does not allow non-global regexes");if(D)return P(o,e);if(void 0===(r=v(e,k))&&S&&"RegExp"==p(e)&&(r=N),r)return a(r,e,o)}else if(D)return P(o,e);return n=u(o),i=new RegExp(e,"g"),S?a(N,i,n):i[k](n)}}),S||k in E||m(E,k,N)})),r.register("jDLVA",(function(e,t){r("7vOjK")})),r.register("7vOjK",(function(e,t){"use strict";var n=r("JGbI2"),i=r("6LGrQ"),a=r("9ZRgk"),o=r("2x0T1"),s=r("0dsEW"),l=r("3HoBU"),c=r("j7Wj1"),u=r("eXtvS"),h=r("3Xhmk"),p=r("1wkuT"),d=r("tmsHt"),g=r("8RiFY"),f=r("bMhTS"),v=g("replace"),m=RegExp.prototype,y=i.TypeError,x=o(p),b=o("".indexOf),w=o("".replace),B=o("".slice),C=Math.max,S=function(e,t,n){return n>e.length?-1:""===t?n:b(e,t,n)};n({target:"String",proto:!0},{replaceAll:function(e,t){var n,r,i,o,p,g,k,L,A,T=s(this),I=0,E=0,M="";if(null!=e){if((n=c(e))&&(r=u(s("flags"in m?e.flags:x(e))),!~b(r,"g")))throw y("`.replaceAll` does not allow non-global regexes");if(i=h(e,v))return a(i,e,T,t);if(f&&n)return w(u(T),e,t)}for(o=u(T),p=u(e),(g=l(t))||(t=u(t)),k=p.length,L=C(1,k),I=S(o,p,0);-1!==I;)A=g?u(t(p,I,o)):d(p,o,I,[],void 0,t),M+=B(o,E,I)+A,E=I+k,I=S(o,p,I+L);return E<o.length&&(M+=B(o,E)),M}})})),r.register("1Yhww",(function(e,t){r("aUpwE")("dispose")})),r.register("iJZgE",(function(e,t){r("aUpwE")("observable")})),r.register("9Z4cR",(function(e,t){r("aUpwE")("patternMatch")})),r.register("gJvaJ",(function(e,t){"use strict";r("JGbI2")({target:"WeakMap",proto:!0,real:!0,forced:r("bMhTS")},{deleteAll:r("5T8Hb")})})),r.register("7ofeM",(function(e,t){r("JGbI2")({target:"WeakMap",stat:!0},{from:r("iDq5m")})})),r.register("epkJT",(function(e,t){r("JGbI2")({target:"WeakMap",stat:!0},{of:r("gBVpi")})})),r.register("3o9RK",(function(e,t){"use strict";r("JGbI2")({target:"WeakSet",proto:!0,real:!0,forced:r("bMhTS")},{addAll:r("gjkZM")})})),r.register("kFM0y",(function(e,t){"use strict";r("JGbI2")({target:"WeakSet",proto:!0,real:!0,forced:r("bMhTS")},{deleteAll:r("5T8Hb")})})),r.register("kfvgx",(function(e,t){r("JGbI2")({target:"WeakSet",stat:!0},{from:r("iDq5m")})})),r.register("gsVBO",(function(e,t){r("JGbI2")({target:"WeakSet",stat:!0},{of:r("gBVpi")})})),r.register("kmSVG",(function(e,t){var n=r("6LGrQ"),i=r("2vChI"),a=r("atkun"),o=r("iLKSv"),s=r("8ihId"),l=function(e){if(e&&e.forEach!==o)try{s(e,"forEach",o)}catch(t){e.forEach=o}};for(var c in i)i[c]&&l(n[c]&&n[c].prototype);l(a)})),r.register("2vChI",(function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}})),r.register("atkun",(function(e,t){var n=r("ckGOu")("span").classList,i=n&&n.constructor&&n.constructor.prototype;e.exports=i===Object.prototype?void 0:i})),r.register("iLKSv",(function(e,t){"use strict";var n=r("9otZn").forEach,i=r("orWZn")("forEach");e.exports=i?[].forEach:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})),r.register("4zmA0",(function(e,t){var n=r("6LGrQ"),i=r("2vChI"),a=r("atkun"),o=r("l4lCC"),s=r("8ihId"),l=r("8RiFY"),c=l("iterator"),u=l("toStringTag"),h=o.values,p=function(e,t){if(e){if(e[c]!==h)try{s(e,c,h)}catch(t){e[c]=h}if(e[u]||s(e,u,t),i[t])for(var n in o)if(e[n]!==o[n])try{s(e,n,o[n])}catch(t){e[n]=o[n]}}};for(var d in i)p(n[d]&&n[d].prototype,d);p(a,"DOMTokenList")})),r.register("cQIcc",(function(e,t){var n=r("JGbI2"),i=r("6LGrQ"),a=r("4sgQc");n({global:!0,bind:!0,enumerable:!0,forced:!i.setImmediate||!i.clearImmediate},{setImmediate:a.set,clearImmediate:a.clear})})),r.register("eAVDg",(function(e,t){var n=r("JGbI2"),i=r("6LGrQ"),a=r("cqo3L"),o=r("bVA4J"),s=i.process;n({global:!0,enumerable:!0,noTargetGet:!0},{queueMicrotask:function(e){var t=o&&s.domain;a(t?t.bind(e):e)}})})),r.register("hmM4b",(function(e,t){"use strict";r("5FVj1");var n,i=r("JGbI2"),a=r("A56Kx"),o=r("jQmSw"),s=r("6LGrQ"),l=r("gAXAR"),c=r("2x0T1"),u=r("jDguE").f,h=r("8Opqg"),p=r("lIgln"),d=r("1JB0D"),g=r("lFR0S"),f=r("jvovY"),v=r("b4zeJ"),m=r("57ZgD").codeAt,y=r("fTJdw"),x=r("eXtvS"),b=r("9Ebr8"),w=r("kfur8"),B=r("jUSxl"),C=B.set,S=B.getterFor("URL"),k=w.URLSearchParams,L=w.getState,A=s.URL,T=s.TypeError,I=s.parseInt,E=Math.floor,M=Math.pow,R=c("".charAt),O=c(/./.exec),P=c([].join),D=c(1..toString),G=c([].pop),N=c([].push),j=c("".replace),z=c([].shift),H=c("".split),U=c("".slice),X=c("".toLowerCase),F=c([].unshift),W="Invalid scheme",K="Invalid host",V="Invalid port",Y=/[a-z]/i,J=/[\d+-.a-z]/i,_=/\d/,Q=/^0x/i,q=/^[0-7]+$/,Z=/^\d+$/,$=/^[\da-f]+$/i,ee=/[\0\t\n\r #%/:<>?@[\\\]^|]/,te=/[\0\t\n\r #/:<>?@[\\\]^|]/,ne=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,re=/[\t\n\r]/g,ie=function(e){var t,n,r,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)F(t,e%256),e=E(e/256);return P(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,i=0,a=0;a<8;a++)0!==e[a]?(i>n&&(t=r,n=i),r=null,i=0):(null===r&&(r=a),++i);return i>n&&(t=r,n=i),t}(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),r===n?(t+=n?":":"::",i=!0):(t+=D(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},ae={},oe=g({},ae,{" ":1,'"':1,"<":1,">":1,"`":1}),se=g({},oe,{"#":1,"?":1,"{":1,"}":1}),le=g({},se,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),ce=function(e,t){var n=m(e,0);return n>32&&n<127&&!d(t,e)?e:encodeURIComponent(e)},ue={ftp:21,file:null,http:80,https:443,ws:80,wss:443},he=function(e,t){var n;return 2==e.length&&O(Y,R(e,0))&&(":"==(n=R(e,1))||!t&&"|"==n)},pe=function(e){var t;return e.length>1&&he(U(e,0,2))&&(2==e.length||"/"===(t=R(e,2))||"\\"===t||"?"===t||"#"===t)},de=function(e){return"."===e||"%2e"===X(e)},ge={},fe={},ve={},me={},ye={},xe={},be={},we={},Be={},Ce={},Se={},ke={},Le={},Ae={},Te={},Ie={},Ee={},Me={},Re={},Oe={},Pe={},De=function(e,t,n){var r,i,a,o=x(e);if(t){if(i=this.parse(o))throw T(i);this.searchParams=null}else{if(void 0!==n&&(r=new De(n,!0)),i=this.parse(o,null,r))throw T(i);(a=L(new k)).bindURL(this),this.searchParams=a}};De.prototype={type:"URL",parse:function(e,t,r){var i,a,o,s,l,c=this,u=t||ge,h=0,p="",g=!1,m=!1,y=!1;for(e=x(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=j(e,ne,"")),e=j(e,re,""),i=f(e);h<=i.length;){switch(a=i[h],u){case ge:if(!a||!O(Y,a)){if(t)return W;u=ve;continue}p+=X(a),u=fe;break;case fe:if(a&&(O(J,a)||"+"==a||"-"==a||"."==a))p+=X(a);else{if(":"!=a){if(t)return W;p="",u=ve,h=0;continue}if(t&&(c.isSpecial()!=d(ue,p)||"file"==p&&(c.includesCredentials()||null!==c.port)||"file"==c.scheme&&!c.host))return;if(c.scheme=p,t)return void(c.isSpecial()&&ue[c.scheme]==c.port&&(c.port=null));p="","file"==c.scheme?u=Ae:c.isSpecial()&&r&&r.scheme==c.scheme?u=me:c.isSpecial()?u=we:"/"==i[h+1]?(u=ye,h++):(c.cannotBeABaseURL=!0,N(c.path,""),u=Re)}break;case ve:if(!r||r.cannotBeABaseURL&&"#"!=a)return W;if(r.cannotBeABaseURL&&"#"==a){c.scheme=r.scheme,c.path=v(r.path),c.query=r.query,c.fragment="",c.cannotBeABaseURL=!0,u=Pe;break}u="file"==r.scheme?Ae:xe;continue;case me:if("/"!=a||"/"!=i[h+1]){u=xe;continue}u=Be,h++;break;case ye:if("/"==a){u=Ce;break}u=Me;continue;case xe:if(c.scheme=r.scheme,a==n)c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=v(r.path),c.query=r.query;else if("/"==a||"\\"==a&&c.isSpecial())u=be;else if("?"==a)c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=v(r.path),c.query="",u=Oe;else{if("#"!=a){c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=v(r.path),c.path.length--,u=Me;continue}c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=v(r.path),c.query=r.query,c.fragment="",u=Pe}break;case be:if(!c.isSpecial()||"/"!=a&&"\\"!=a){if("/"!=a){c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,u=Me;continue}u=Ce}else u=Be;break;case we:if(u=Be,"/"!=a||"/"!=R(p,h+1))continue;h++;break;case Be:if("/"!=a&&"\\"!=a){u=Ce;continue}break;case Ce:if("@"==a){g&&(p="%40"+p),g=!0,o=f(p);for(var b=0;b<o.length;b++){var w=o[b];if(":"!=w||y){var B=ce(w,le);y?c.password+=B:c.username+=B}else y=!0}p=""}else if(a==n||"/"==a||"?"==a||"#"==a||"\\"==a&&c.isSpecial()){if(g&&""==p)return"Invalid authority";h-=f(p).length+1,p="",u=Se}else p+=a;break;case Se:case ke:if(t&&"file"==c.scheme){u=Ie;continue}if(":"!=a||m){if(a==n||"/"==a||"?"==a||"#"==a||"\\"==a&&c.isSpecial()){if(c.isSpecial()&&""==p)return K;if(t&&""==p&&(c.includesCredentials()||null!==c.port))return;if(s=c.parseHost(p))return s;if(p="",u=Ee,t)return;continue}"["==a?m=!0:"]"==a&&(m=!1),p+=a}else{if(""==p)return K;if(s=c.parseHost(p))return s;if(p="",u=Le,t==ke)return}break;case Le:if(!O(_,a)){if(a==n||"/"==a||"?"==a||"#"==a||"\\"==a&&c.isSpecial()||t){if(""!=p){var C=I(p,10);if(C>65535)return V;c.port=c.isSpecial()&&C===ue[c.scheme]?null:C,p=""}if(t)return;u=Ee;continue}return V}p+=a;break;case Ae:if(c.scheme="file","/"==a||"\\"==a)u=Te;else{if(!r||"file"!=r.scheme){u=Me;continue}if(a==n)c.host=r.host,c.path=v(r.path),c.query=r.query;else if("?"==a)c.host=r.host,c.path=v(r.path),c.query="",u=Oe;else{if("#"!=a){pe(P(v(i,h),""))||(c.host=r.host,c.path=v(r.path),c.shortenPath()),u=Me;continue}c.host=r.host,c.path=v(r.path),c.query=r.query,c.fragment="",u=Pe}}break;case Te:if("/"==a||"\\"==a){u=Ie;break}r&&"file"==r.scheme&&!pe(P(v(i,h),""))&&(he(r.path[0],!0)?N(c.path,r.path[0]):c.host=r.host),u=Me;continue;case Ie:if(a==n||"/"==a||"\\"==a||"?"==a||"#"==a){if(!t&&he(p))u=Me;else if(""==p){if(c.host="",t)return;u=Ee}else{if(s=c.parseHost(p))return s;if("localhost"==c.host&&(c.host=""),t)return;p="",u=Ee}continue}p+=a;break;case Ee:if(c.isSpecial()){if(u=Me,"/"!=a&&"\\"!=a)continue}else if(t||"?"!=a)if(t||"#"!=a){if(a!=n&&(u=Me,"/"!=a))continue}else c.fragment="",u=Pe;else c.query="",u=Oe;break;case Me:if(a==n||"/"==a||"\\"==a&&c.isSpecial()||!t&&("?"==a||"#"==a)){if(".."===(l=X(l=p))||"%2e."===l||".%2e"===l||"%2e%2e"===l?(c.shortenPath(),"/"==a||"\\"==a&&c.isSpecial()||N(c.path,"")):de(p)?"/"==a||"\\"==a&&c.isSpecial()||N(c.path,""):("file"==c.scheme&&!c.path.length&&he(p)&&(c.host&&(c.host=""),p=R(p,0)+":"),N(c.path,p)),p="","file"==c.scheme&&(a==n||"?"==a||"#"==a))for(;c.path.length>1&&""===c.path[0];)z(c.path);"?"==a?(c.query="",u=Oe):"#"==a&&(c.fragment="",u=Pe)}else p+=ce(a,se);break;case Re:"?"==a?(c.query="",u=Oe):"#"==a?(c.fragment="",u=Pe):a!=n&&(c.path[0]+=ce(a,ae));break;case Oe:t||"#"!=a?a!=n&&("'"==a&&c.isSpecial()?c.query+="%27":c.query+="#"==a?"%23":ce(a,ae)):(c.fragment="",u=Pe);break;case Pe:a!=n&&(c.fragment+=ce(a,oe))}h++}},parseHost:function(e){var t,n,r;if("["==R(e,0)){if("]"!=R(e,e.length-1))return K;if(t=function(e){var t,n,r,i,a,o,s,l=[0,0,0,0,0,0,0,0],c=0,u=null,h=0,p=function(){return R(e,h)};if(":"==p()){if(":"!=R(e,1))return;h+=2,u=++c}for(;p();){if(8==c)return;if(":"!=p()){for(t=n=0;n<4&&O($,p());)t=16*t+I(p(),16),h++,n++;if("."==p()){if(0==n)return;if(h-=n,c>6)return;for(r=0;p();){if(i=null,r>0){if(!("."==p()&&r<4))return;h++}if(!O(_,p()))return;for(;O(_,p());){if(a=I(p(),10),null===i)i=a;else{if(0==i)return;i=10*i+a}if(i>255)return;h++}l[c]=256*l[c]+i,2!=++r&&4!=r||c++}if(4!=r)return;break}if(":"==p()){if(h++,!p())return}else if(p())return;l[c++]=t}else{if(null!==u)return;h++,u=++c}}if(null!==u)for(o=c-u,c=7;0!=c&&o>0;)s=l[c],l[c--]=l[u+o-1],l[u+--o]=s;else if(8!=c)return;return l}(U(e,1,-1)),!t)return K;this.host=t}else if(this.isSpecial()){if(e=y(e),O(ee,e))return K;if(t=function(e){var t,n,r,i,a,o,s,l=H(e,".");if(l.length&&""==l[l.length-1]&&l.length--,(t=l.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(i=l[r]))return e;if(a=10,i.length>1&&"0"==R(i,0)&&(a=O(Q,i)?16:8,i=U(i,8==a?1:2)),""===i)o=0;else{if(!O(10==a?Z:8==a?q:$,i))return e;o=I(i,a)}N(n,o)}for(r=0;r<t;r++)if(o=n[r],r==t-1){if(o>=M(256,5-t))return null}else if(o>255)return null;for(s=G(n),r=0;r<n.length;r++)s+=n[r]*M(256,3-r);return s}(e),null===t)return K;this.host=t}else{if(O(te,e))return K;for(t="",n=f(e),r=0;r<n.length;r++)t+=ce(n[r],ae);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return d(ue,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&he(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,r=e.password,i=e.host,a=e.port,o=e.path,s=e.query,l=e.fragment,c=t+":";return null!==i?(c+="//",e.includesCredentials()&&(c+=n+(r?":"+r:"")+"@"),c+=ie(i),null!==a&&(c+=":"+a)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?o[0]:o.length?"/"+P(o,"/"):"",null!==s&&(c+="?"+s),null!==l&&(c+="#"+l),c},setHref:function(e){var t=this.parse(e);if(t)throw T(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new Ge(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+ie(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(x(e)+":",ge)},getUsername:function(){return this.username},setUsername:function(e){var t=f(x(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=ce(t[n],le)}},getPassword:function(){return this.password},setPassword:function(e){var t=f(x(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=ce(t[n],le)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?ie(e):ie(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Se)},getHostname:function(){var e=this.host;return null===e?"":ie(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,ke)},getPort:function(){var e=this.port;return null===e?"":x(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=x(e))?this.port=null:this.parse(e,Le))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+P(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Ee))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=x(e))?this.query=null:("?"==R(e,0)&&(e=U(e,1)),this.query="",this.parse(e,Oe)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=x(e))?("#"==R(e,0)&&(e=U(e,1)),this.fragment="",this.parse(e,Pe)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Ge=function(e){var t=p(this,Ne),n=arguments.length>1?arguments[1]:void 0,r=C(t,new De(e,!1,n));a||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},Ne=Ge.prototype,je=function(e,t){return{get:function(){return S(this)[e]()},set:t&&function(e){return S(this)[t](e)},configurable:!0,enumerable:!0}};if(a&&u(Ne,{href:je("serialize","setHref"),origin:je("getOrigin"),protocol:je("getProtocol","setProtocol"),username:je("getUsername","setUsername"),password:je("getPassword","setPassword"),host:je("getHost","setHost"),hostname:je("getHostname","setHostname"),port:je("getPort","setPort"),pathname:je("getPathname","setPathname"),search:je("getSearch","setSearch"),searchParams:je("getSearchParams"),hash:je("getHash","setHash")}),h(Ne,"toJSON",(function(){return S(this).serialize()}),{enumerable:!0}),h(Ne,"toString",(function(){return S(this).serialize()}),{enumerable:!0}),A){var ze=A.createObjectURL,He=A.revokeObjectURL;ze&&h(Ge,"createObjectURL",l(ze,A)),He&&h(Ge,"revokeObjectURL",l(He,A))}b(Ge,"URL"),i({global:!0,forced:!o,sham:!a},{URL:Ge})})),r.register("jQmSw",(function(e,t){var n=r("6WghJ"),i=r("8RiFY"),a=r("bMhTS"),o=i("iterator");e.exports=!n((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),a&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[o]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))})),r.register("fTJdw",(function(e,t){"use strict";var n=r("6LGrQ"),i=r("2x0T1"),a=2147483647,o=/[^\0-\u007E]/,s=/[.\u3002\uFF0E\uFF61]/g,l="Overflow: input needs wider integers to process",c=n.RangeError,u=i(s.exec),h=Math.floor,p=String.fromCharCode,d=i("".charCodeAt),g=i([].join),f=i([].push),v=i("".replace),m=i("".split),y=i("".toLowerCase),x=function(e){return e+22+75*(e<26)},b=function(e,t,n){var r=0;for(e=n?h(e/700):e>>1,e+=h(e/t);e>455;)e=h(e/35),r+=36;return h(r+36*e/(e+38))},w=function(e){var t=[];e=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=d(e,n++);if(i>=55296&&i<=56319&&n<r){var a=d(e,n++);56320==(64512&a)?f(t,((1023&i)<<10)+(1023&a)+65536):(f(t,i),n--)}else f(t,i)}return t}(e);var n,r,i=e.length,o=128,s=0,u=72;for(n=0;n<e.length;n++)(r=e[n])<128&&f(t,p(r));var v=t.length,m=v;for(v&&f(t,"-");m<i;){var y=a;for(n=0;n<e.length;n++)(r=e[n])>=o&&r<y&&(y=r);var w=m+1;if(y-o>h((a-s)/w))throw c(l);for(s+=(y-o)*w,o=y,n=0;n<e.length;n++){if((r=e[n])<o&&++s>a)throw c(l);if(r==o){for(var B=s,C=36;;){var S=C<=u?1:C>=u+26?26:C-u;if(B<S)break;var k=B-S,L=36-S;f(t,p(x(S+k%L))),B=h(k/L),C+=36}f(t,p(x(B))),u=b(s,w,m==v),s=0,m++}}s++,o++}return g(t,"")};e.exports=function(e){var t,n,r=[],i=m(v(y(e),s,"."),".");for(t=0;t<i.length;t++)n=i[t],f(r,u(o,n)?"xn--"+w(n):n);return g(r,".")}})),r.register("kfur8",(function(e,t){"use strict";r("l4lCC");var n=r("JGbI2"),i=r("6LGrQ"),a=r("fdCuf"),o=r("9ZRgk"),s=r("2x0T1"),l=r("jQmSw"),c=r("8Opqg"),u=r("g2jnF"),h=r("9Ebr8"),p=r("bGPs6"),d=r("jUSxl"),g=r("lIgln"),f=r("3HoBU"),v=r("1JB0D"),m=r("gAXAR"),y=r("cKQyt"),x=r("edAQb"),b=r("gczVK"),w=r("eXtvS"),B=r("KFLt0"),C=r("eqpEX"),S=r("g3ZOP"),k=r("aCNH3"),L=r("lRXJh"),A=r("8RiFY"),T=r("c3NuZ"),I=A("iterator"),E="URLSearchParams",M="URLSearchParamsIterator",R=d.set,O=d.getterFor(E),P=d.getterFor(M),D=a("fetch"),G=a("Request"),N=a("Headers"),j=G&&G.prototype,z=N&&N.prototype,H=i.RegExp,U=i.TypeError,X=i.decodeURIComponent,F=i.encodeURIComponent,W=s("".charAt),K=s([].join),V=s([].push),Y=s("".replace),J=s([].shift),_=s([].splice),Q=s("".split),q=s("".slice),Z=/\+/g,$=Array(4),ee=function(e){return $[e-1]||($[e-1]=H("((?:%[\\da-f]{2}){"+e+"})","gi"))},te=function(e){try{return X(e)}catch(t){return e}},ne=function(e){var t=Y(e,Z," "),n=4;try{return X(t)}catch(e){for(;n;)t=Y(t,ee(n--),te);return t}},re=/[!'()~]|%20/g,ie={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ae=function(e){return ie[e]},oe=function(e){return Y(F(e),re,ae)},se=p((function(e,t){R(this,{type:M,iterator:S(O(e).entries),kind:t})}),"Iterator",(function(){var e=P(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n}),!0),le=function(e){this.entries=[],this.url=null,void 0!==e&&(b(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===W(e,0)?q(e,1):e:w(e)))};le.prototype={type:E,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,i,a,s,l,c=k(e);if(c)for(n=(t=S(e,c)).next;!(r=o(n,t)).done;){if(a=(i=S(x(r.value))).next,(s=o(a,i)).done||(l=o(a,i)).done||!o(a,i).done)throw U("Expected sequence with length 2");V(this.entries,{key:w(s.value),value:w(l.value)})}else for(var u in e)v(e,u)&&V(this.entries,{key:u,value:w(e[u])})},parseQuery:function(e){if(e)for(var t,n,r=Q(e,"&"),i=0;i<r.length;)(t=r[i++]).length&&(n=Q(t,"="),V(this.entries,{key:ne(J(n)),value:ne(K(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],r=0;r<t.length;)e=t[r++],V(n,oe(e.key)+"="+oe(e.value));return K(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var ce=function(){g(this,ue);var e=arguments.length>0?arguments[0]:void 0;R(this,new le(e))},ue=ce.prototype;if(u(ue,{append:function(e,t){L(arguments.length,2);var n=O(this);V(n.entries,{key:w(e),value:w(t)}),n.updateURL()},delete:function(e){L(arguments.length,1);for(var t=O(this),n=t.entries,r=w(e),i=0;i<n.length;)n[i].key===r?_(n,i,1):i++;t.updateURL()},get:function(e){L(arguments.length,1);for(var t=O(this).entries,n=w(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){L(arguments.length,1);for(var t=O(this).entries,n=w(e),r=[],i=0;i<t.length;i++)t[i].key===n&&V(r,t[i].value);return r},has:function(e){L(arguments.length,1);for(var t=O(this).entries,n=w(e),r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){L(arguments.length,1);for(var n,r=O(this),i=r.entries,a=!1,o=w(e),s=w(t),l=0;l<i.length;l++)(n=i[l]).key===o&&(a?_(i,l--,1):(a=!0,n.value=s));a||V(i,{key:o,value:s}),r.updateURL()},sort:function(){var e=O(this);T(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=O(this).entries,r=m(e,arguments.length>1?arguments[1]:void 0),i=0;i<n.length;)r((t=n[i++]).value,t.key,this)},keys:function(){return new se(this,"keys")},values:function(){return new se(this,"values")},entries:function(){return new se(this,"entries")}},{enumerable:!0}),c(ue,I,ue.entries,{name:"entries"}),c(ue,"toString",(function(){return O(this).serialize()}),{enumerable:!0}),h(ce,E),n({global:!0,forced:!l},{URLSearchParams:ce}),!l&&f(N)){var he=s(z.has),pe=s(z.set),de=function(e){if(b(e)){var t,n=e.body;if(y(n)===E)return t=e.headers?new N(e.headers):new N,he(t,"content-type")||pe(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),B(e,{body:C(0,w(n)),headers:C(0,t)})}return e};if(f(D)&&n({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return D(e,arguments.length>1?de(arguments[1]):{})}}),f(G)){var ge=function(e){return g(this,j),new G(e,arguments.length>1?de(arguments[1]):{})};j.constructor=ge,ge.prototype=j,n({global:!0,forced:!0},{Request:ge})}}e.exports={URLSearchParams:ce,getState:O}})),r.register("lRXJh",(function(e,t){var n=r("6LGrQ").TypeError;e.exports=function(e,t){if(e<t)throw n("Not enough arguments");return e}})),r.register("lFgox",(function(e,t){"use strict";var n=r("JGbI2"),i=r("9ZRgk");n({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return i(URL.prototype.toString,this)}})})),r.register("5dg4B",(function(e,t){var n;n=function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach((function(e){var n=e instanceof Node;t.appendChild(n?e:document.createTextNode(String(e)))})),this.appendChild(t)},[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach((function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:n})}))})),r.register("izcMZ",(function(e,t){var n;n=function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach((function(e){var n=e instanceof Node;t.appendChild(n?e:document.createTextNode(String(e)))})),this.insertBefore(t,this.firstChild)},[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach((function(e){e.hasOwnProperty("prepend")||Object.defineProperty(e,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:n})}))})),r.register("3C7jC",(function(n,i){t(n.exports,"KlApp",(function(){return S}));var a=r("4gaLD"),o=r("cijLd"),s=r("hrnUX"),l=r("gWfkn"),c=r("eWjiX"),u=r("5ebUJ");r("eK8ID");var h=r("85H3x"),p=r("iUR3L"),d=r("2wCWz"),g=r("3WOmu"),f=r("1mH1z"),v=r("fxAg2"),m=r("2dTGs"),y=r("fuF9j"),x=r("adBnR"),b=r("cafM1"),w=r("eIlXd"),B=r("23J3k"),C=r("6l0gQ");function S(t,n){var r=function(e){return 1==e?.5:2==e?.84:3==e?.965:4==e?.9825:5==e?.99125:e},i=function(e){Z.emitSize(e),re&&re.setCursorSize(2*e)},p=function(e,t,n){function r(e,t){var n=parseInt(e),r=parseInt(t);return n>O&&(r*=O/n,n=O),r>O&&(n*=O/r,r=O),{width:n=parseInt(""+n),height:r=parseInt(""+r)}}function i(e){var n=r(e.width,e.height),i=c.BB.canvas(e.width,e.height);i.getContext("2d").drawImage(e,0,0),c.BB.resizeCanvas(i,n.width,n.height),F.reset({width:n.width,height:n.height,image:i,layerName:t}),Le.update(0),A(F.getLayer(0)),re.resetView(),we.update(re.getScale(),re.getAngleDeg()),!1}function a(e,t){function n(e,t,n){t.width=t.width,t.getContext("2d").drawImage(e,-n.x,-n.y),e.width=n.width,e.height=n.height,e.getContext("2d").drawImage(t,0,0)}if(t&&(t.width!==e.width||t.height!==e.height)){var i=c.BB.canvas(t.width,t.height);if(e.width=t.width,e.height=t.height,e.layers||n(e.canvas,i,t),e.layers)for(var a=0;a<e.layers.length;a++){n(e.layers[a].image,i,t)}}var o=r(e.width,e.height);if(e.width=o.width,e.height=o.height,e.layers||c.BB.resizeCanvas(e.canvas,e.width,e.height),e.layers)for(var s=0;s<e.layers.length;s++){var l=e.layers[s];c.BB.resizeCanvas(l.image,e.width,e.height)}var u=void 0;u=e.layers?F.reset({width:e.width,height:e.height,layers:e.layers}):F.reset({width:e.width,height:e.height,image:e.canvas}),Le.update(u),A(F.getLayer(u)),re.resetView(),we.update(re.getScale(),re.getAngleDeg()),!1}function o(e){s.KL.showImportAsLayerDialog({target:j,klCanvas:F,importImage:e,callback:function(n,r){if(n){l.klHistory.pause(!0),F.addLayer();var i=F.getLayers().length-1;t&&F.renameLayer(i,t);var a=F.getLayerContext(i);c.BB.drawTransformedImageWithBounds(a,e,n,null,r),A(F.getLayer(i)),Le.update(i),l.klHistory.pause(!1),l.klHistory.push({tool:["misc"],action:"importImage",params:[c.BB.copyCanvas(a.canvas),t]})}}})}!e||isNaN(e.width)||isNaN(e.height)||e.width<=0||e.height<=0?s.KL.popup({target:j,type:"error",message:f.LANG("import-broken-file"),buttons:["Ok"]}):("default"!==n&&n||s.KL.showImportImageDialog({image:e,target:j,maxSize:O,callback:function(e){"as-image"===e.type?i(e.image):"as-image-psd"===e.type?a(e.image,e.cropObj):"as-layer"===e.type?o(e.image):e.type}}),"layer"===n&&o(e.canvas),"image"===n&&("psd"===e.type?a(e):i(e.canvas)))},S=function(e,t){function n(){s.KL.popup({target:j,type:"warning",message:f.LANG("import-psd-unsupported")+"<br /><br />",buttons:["Ok"]})}for(var r,i=!1,a=0;r=e[a];a++){var o=r.name.split(".");"psd"===(o=o[o.length-1].toLowerCase())?function(r){var i=4096;if(r.size>=1073741824)s.KL.popup({target:j,type:"error",message:"File too big. Unable to import.<br /><br />",buttons:["Ok"]});else{var a,o=1===e.length&&r.size>=26214400,l=!0;o&&s.KL.popup({target:j,message:f.LANG("import-opening"),callback:function(e){l=!1,a=null},closefunc:function(e){a=e}});var c=new FileReader;c.onload=function(e){s.KL.loadAgPsd().then((function(c){if(!o||l)try{var u;if((u=c.readPsd(e.target.result,{skipLayerImageData:!0,skipThumbnail:!0,skipCompositeImageData:!0})).width>i||u.height>i)return a&&a(),void s.KL.popup({target:j,type:"error",message:f.LANG("import-psd-too-large").replace(/{x}/g,"4096")+"<br /><br />"+f.LANG("import-psd-size")+": "+u.width+" x "+u.height+" pixels<br /><br />",buttons:["Ok"]});u=null;try{u=c.readPsd(e.target.result)}catch(e){}if(u){var h=s.KL.PSD.readPsd(u);"image"===t&&h.error&&n(),a&&a(),p(h,r.name,t)}else u=c.readPsd(e.target.result,{skipLayerImageData:!0,skipThumbnail:!0}),"image"===t&&n(),a&&a(),p({type:"psd",width:u.width,height:u.height,canvas:u.canvas,error:!0},r.name,t)}catch(e){a&&a(),s.KL.popup({target:j,type:"error",message:"Failed to load PSD.<br /><br />",buttons:["Ok"]})}})).catch((function(){a(),alert("Error: failed to load PSD library")}))},c.readAsArrayBuffer(r)}}(r):r.type.match("image.*")?function(e){window.URL=window.URL||window.webkitURL;var n=window.URL.createObjectURL(e),r=new Image;r.src=n,c.BB.loadImage(r,(function(){p({type:"image",width:r.width,height:r.height,canvas:r},e.name,t)}))}(r):i=!0}i&&s.KL.popup({target:j,message:f.LANG("import-unsupported-file"),type:"error",buttons:["OK"]})},k=function(){z<P?(he.getElement().style.display="block",he.setDirection(D),he.isOpen()?("left"===D?(c.BB.css(he.getElement(),{left:"271px",right:""}),c.BB.css(re.getElement(),{left:"271px"})):(c.BB.css(he.getElement(),{left:"",right:"271px"}),c.BB.css(re.getElement(),{left:"0"})),ce.style.display="block",re.setSize(Math.max(0,z-U),H),le.setWide(!1)):("left"===D?(c.BB.css(he.getElement(),{left:"0",right:""}),c.BB.css(re.getElement(),{left:"0"})):(c.BB.css(he.getElement(),{left:"",right:"0"}),c.BB.css(re.getElement(),{left:"0"})),ce.style.display="none",re.setSize(Math.max(0,z),H),le.setWide(!0))):(he.getElement().style.display="none","left"===D?c.BB.css(re.getElement(),{left:"271px"}):c.BB.css(re.getElement(),{left:"0"}),ce.style.display="block",re.setSize(Math.max(0,z-U),H),le.setWide(!1))},L=function(){"left"===D?(c.BB.css(ce,{left:"0",right:"",borderLeft:"none",borderRight:"1px solid rgb(135, 135, 135)"}),c.BB.css(re.getElement(),{left:"271px"})):(c.BB.css(ce,{left:"",right:"0",borderLeft:"1px solid rgb(135, 135, 135)",borderRight:"none"}),c.BB.css(re.getElement(),{left:"0"})),le.setUiState(D),Ae.setUiState(""+D),Le.setUiState(""+D),k(),De.updateUiState(D)},A=function(e){q=e.context,J.setContext(e.context),Ae.setLayer(e)},T=function(){s.KL.newImageDialog({currentColor:Y,secondaryColor:fe.getSecondaryRGB(),maxCanvasSize:O,canvasWidth:F.getWidth(),canvasHeight:F.getHeight(),workspaceWidth:window.innerWidth<P?z:z-U,workspaceHeight:H,onConfirm:function(e,t,n){F.reset({width:e,height:t,color:1===n.a?n:null}),Le.update(0),A(F.getLayer(0)),re.resetView(),we.update(re.getScale(),re.getAngleDeg()),!1},onCancel:function(){}})},I=function(e){c.BB.shareCanvas({canvas:F.getCompleteCanvas(1),fileName:c.BB.getDate()+G+".png",title:c.BB.getDate()+G+".png",callback:e||function(){}})},E=function(){if(W)for(var e=ge.getActive(),t=W.getOpenedTabId(),n=Object.keys({draw:{},hand:{},fill:{},text:{},shape:{}}),r=0;r<n.length;r++)e===n[r]?W.setIsVisible(n[r],!0):(W.setIsVisible(n[r],!1),t===n[r]&&W.open(e))},M=function(e){s.KL.clipboardDialog(j,F.getCompleteCanvas(1),(function(e){if(0!==e.left||0!==e.right||0!==e.top||0!==e.bottom){var t={context:q,canvas:F,input:e,history:l.klHistory};s.KL.filterLib.cropExtend.apply(t),Le.update(),re.resetView(),we.update(re.getScale(),re.getAngleDeg())}}),le,e)},R=function(){if(n.bottomBar){var e=617<window.innerHeight&&ue.scrollHeight+50<window.innerHeight;Oe.style.display=e?"":"none"}},O=Math.min(4096,Math.max(2048,Math.max(window.screen.width,window.screen.height))),P=820,D=n.embed?"left":C.LocalStorage.getItem("uiState")?C.LocalStorage.getItem("uiState"):"right",G=n.app&&n.app.filenameBase?n.app.filenameBase:"Klecks",N=n.projectStore,j=document.createElement("div");j.className="g-root";var z=Math.max(0,window.innerWidth),H=Math.max(0,window.innerHeight),U=271,X="png",F=new s.KL.KlCanvas(t?{projectObj:t}:{width:Math.min(O,window.innerWidth<P?z:z-U),height:Math.min(O,H)},n.embed?-1:0);F.setHistory(l.klHistory);var W,K=null;n.saveReminder||(n.saveReminder={init:function(){},reset:function(){}});t?(t.layers.forEach((function(e){e.image=null})),t=null):(l.klHistory.pause(!0),F.addLayer(),F.layerFill(0,{r:255,g:255,b:255}),l.klHistory.pause(!1));try{K={canvas:new s.KL.KlCanvas({copy:F},n.embed?-1:0),focus:F.getLayerCount()-1,brushes:{}}}catch(e){throw"kl-create-canvas-error"===e.message&&F.destroy(),e}for(var V in s.KL.brushes)s.KL.brushes.hasOwnProperty(V)&&(K.brushes[V]=new s.KL.brushes[V],K.canvas&&K.brushes[V].setContext(K.canvas.getLayerContext(K.focus)));var Y=new c.BB.RGB(0,0,0),J=void 0,_=void 0,Q=0,q=F.getLayerContext(F.getLayerCount()-1),Z=new s.KL.BrushSettingService((function(e){fe.setColor(e),J.setColor(e),Y=c.BB.copyObj(e)}),(function(e){J.setSize(e),re.setCursorSize(2*e)}),(function(e){J.setOpacity(e)}),(function(){return fe.getColor()}),(function(){return ae[_].getSize()}),(function(){return ae[_].getOpacity()}),(function(){return{sizeSlider:s.KL.brushesUI[_].sizeSlider,opacitySlider:s.KL.brushesUI[_].opacitySlider}})),$=new c.BB.EventChain.LineSmoothing({smoothing:r(1)}),ee=new c.BB.EventChain.LineSanitizer,te=new c.BB.EventChain.EventChain({chainArr:[ee,$]});te.setChainOut((function(e){"down"===e.type&&(ce.style.pointerEvents="none",J.startLine(e.x,e.y,e.pressure),re.requestFrame()),"move"===e.type&&(J.goLine(e.x,e.y,e.pressure,!1,e.isCoalesced),re.setLastDrawEvent(e.x,e.y,e.pressure),re.requestFrame()),"up"===e.type&&(ce.style.pointerEvents="",J.endLine(),re.requestFrame()),"line"===e.type&&(J.getBrush().drawLineSegment(e.x0,e.y0,e.x1,e.y1),re.requestFrame())}));var ne={size:20,align:"left",isBold:!1,isItalic:!1,font:"sans-serif",opacity:1},re=new s.KL.KlCanvasWorkspace({klCanvas:F,width:Math.max(0,z-U),height:H,onDraw:te.chainIn,onPick:function(e,t){Z.setColor(e),t&&(fe.pickingDone(),re.setMode(ge.getActive()))},onFill:function(e,t){var n=F.getLayerIndex(q.canvas);F.floodFill(n,e,t,fe.getColor(),Be.getOpacity(),Be.getTolerance(),Be.getSample(),Be.getGrow(),Be.getContiguous()),re.requestFrame()},onText:function(e,t,n){s.KL.dialogCounter.get()>0||s.KL.textToolDialog({klCanvas:F,layerIndex:F.getLayerIndex(q.canvas),x:e,y:t,angleRad:n,color:fe.getColor(),secondaryColor:fe.getSecondaryRGB(),size:ne.size,align:ne.align,isBold:ne.isBold,isItalic:ne.isItalic,font:ne.font,opacity:ne.opacity,onConfirm:function(e){var t=e.color;t.a=e.opacity,ne.size=e.size,ne.align=e.align,ne.isBold=e.isBold,ne.isItalic=e.isItalic,ne.font=e.font,ne.opacity=e.opacity;var r=F.getLayerIndex(q.canvas);F.text(r,{textStr:e.textStr,x:e.x,y:e.y,size:e.size,font:e.font,align:e.align,isBold:e.isBold,isItalic:e.isItalic,angleRad:n,color:c.BB.ColorConverter.toRgbaStr(t)}),re.requestFrame()}})},onShape:function(e,t,n,r){"down"===e&&ke.onDown(t,n,r),"move"===e&&ke.onMove(t,n),"up"===e&&ke.onUp(t,n)},onViewChange:function(e){e.changed.includes("scale")&&le.out({type:"transform",scale:e.scale,angleDeg:180*e.angle/Math.PI}),ge.setEnableZoomIn(e.scale!==re.getMaxScale()),ge.setEnableZoomOut(e.scale!==re.getMinScale()),we.update(e.scale,180*e.angle/Math.PI)},onUndo:function(){l.klHistory.canUndo()&&Ie.undo()&&le.out(f.LANG("undo"),!0)},onRedo:function(){l.klHistory.canRedo()&&Ie.redo()&&le.out(f.LANG("redo"),!0)}}),ie=new c.BB.KeyListener({onDown:function(t,r,i){if(!(s.KL.dialogCounter.get()>0)&&(!c.BB.isInputFocused(!0)&&!(ee.getIsDrawing()||re.getIsDrawing()))){if("plus"===i&&re.zoomByStep(ie.isPressed("shift")?1/8:.5),"minus"===i&&re.zoomByStep(ie.isPressed("shift")?-1/8:-.5),"home"===i&&re.fitView(),"end"===i&&re.resetView(!0),["ctrl+z","cmd+z"].includes(i)&&(r.preventDefault(),Ie.undo()),(["ctrl+y","cmd+y"].includes(i)||(c.BB.sameKeys("ctrl+shift+z",i)||c.BB.sameKeys("cmd+shift+z",i))&&"z"===t)&&(r.preventDefault(),Ie.redo()),n.embed||(["ctrl+s","cmd+s"].includes(i)&&(r.preventDefault(),Ee.save()),["ctrl+shift+s","cmd+shift+s"].includes(i)&&(r.preventDefault(),a.asyncToGenerator(e(o).mark((function t(){var r;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!0,e.prev=1,e.next=4,N.store(F.getProject());case 4:e.next=11;break;case 6:e.prev=6,e.t0=e.catch(1),r=!1,setTimeout((function(){throw new Error("keyboard-shortcut: failed to store browser storage, "+e.t0)}),0),le.out("❌ "+f.LANG("file-storage-failed"),!0);case 11:r&&(n.saveReminder.reset(),le.out(f.LANG("file-storage-stored"),!0));case 12:case"end":return e.stop()}}),t,null,[[1,6]])})))()),["ctrl+c","cmd+c"].includes(i)&&(r.preventDefault(),M(!0))),["ctrl+a","cmd+a"].includes(i)&&r.preventDefault(),ie.comboOnlyContains(["left","right","up","down"])&&("left"===t&&re.translateView(1,0),"right"===t&&re.translateView(-1,0),"up"===t&&re.translateView(0,1),"down"===t&&re.translateView(0,-1)),["r+left","r+right"].includes(i)&&("left"===t&&(re.setAngle(-15,!0),we.update(re.getScale(),re.getAngleDeg())),"right"===t&&(re.setAngle(15,!0),we.update(re.getScale(),re.getAngleDeg()))),["r+up"].includes(i)&&(re.setAngle(0),we.update(re.getScale(),re.getAngleDeg())),"sqbr_open"===i&&J.decreaseSize(.03/re.getScale()),"sqbr_close"===i&&J.increaseSize(.03/re.getScale()),"enter"===i&&(F.layerFill(F.getLayerIndex(q.canvas),fe.getColor()),le.out(f.LANG("filled"),!0)),["delete","backspace"].includes(i)){var l=F.getLayerIndex(q.canvas);0!==l||ae.eraserBrush.getIsTransparentBg()?F.clearLayer(l):F.layerFill(l,{r:255,g:255,b:255},"source-in"),le.out(f.LANG("cleared-layer"),!0)}"e"===i&&(r.preventDefault(),re.setMode("draw"),ge.setActive("draw"),W.open("draw"),E(),xe.open("eraserBrush")),"b"===i&&(r.preventDefault(),re.setMode("draw"),ge.setActive("draw"),W.open("draw"),E(),xe.open(Q)),"g"===i&&(r.preventDefault(),re.setMode("fill"),ge.setActive("fill"),W.open("fill"),E()),"t"===i&&(r.preventDefault(),re.setMode("text"),ge.setActive("text"),W.open("text"),E()),"u"===i&&(r.preventDefault(),re.setMode("shape"),ge.setActive("shape"),W.open("shape"),E()),"x"===i&&(r.preventDefault(),fe.swapColors())}},onUp:function(e,t){}});n.embed||(new s.KL.KlImageDropper({target:document.body,onDrop:function(e,t){s.KL.dialogCounter.get()>0||S(e,t)},enabledTest:function(){return 0===s.KL.dialogCounter.get()}}),c.BB.addEventListener(window,"paste",(function(e){s.KL.dialogCounter.get()>0||(e.stopPropagation(),e.preventDefault(),e.clipboardData.files[0]?function(e,t){0==e.clipboardData&&"function"==typeof t&&t(void 0);var n=e.clipboardData.items;if(null==n)"function"==typeof t&&t(void 0);else for(var r=0;r<n.length;r++)if(-1!=n[r].type.indexOf("image")){var i=n[r].getAsFile();"function"==typeof t&&t(i)}}(e,(function(e){if(e){var t=new Image;t.onload=function(){URL.revokeObjectURL(t.src),p({type:"image",width:t.width,height:t.height,canvas:t},null,"default")};var n=window.URL||window.webkitURL;t.src=n.createObjectURL(e)}})):e.clipboardData.items[0]&&e.clipboardData.items[0].getAsString((function(e){if((e=e.trim()).match(/^https?/)){var t=new Image;t.onload=function(){p({type:"image",width:t.width,height:t.height,canvas:t},null,"default")},t.onerror=function(e){console.log("error loading",e)},t.crossOrigin="Anonymous",t.src=e}else if(e.match(/^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/)){var n=c.BB.ColorConverter.hexToRGB(e.replace("#",""));Z.setColor(n)}})))}),!1));var ae={};for(var oe in s.KL.brushesUI)if(s.KL.brushesUI.hasOwnProperty(oe)){var se=new s.KL.brushesUI[oe].Ui({onSizeChange:i,onOpacityChange:function(e){Z.emitOpacity(e)},onConfigChange:function(){Z.emitSliderConfig({sizeSlider:s.KL.brushesUI[_].sizeSlider,opacitySlider:s.KL.brushesUI[_].opacitySlider})}});ae[oe]=se,se.getElement().style.padding="10px"}c.BB.css(j,{position:"absolute",left:"0",top:"0",right:"0",bottom:"0"});var le=new s.KL.StatusOverlay,ce=c.BB.el({}),ue=c.BB.el({parent:ce});ce.oncontextmenu=function(){return!1},ce.onclick=c.BB.handleClick;var he=new s.KL.ToolspaceCollapser({onChange:function(){k()}});k();var pe=void 0;setTimeout((function(){pe=new s.KL.OverlayToolspace({enabledTest:function(){return 0===s.KL.dialogCounter.get()&&!ee.getIsDrawing()},brushSettingService:Z}),j.appendChild(pe.getElement())}),0),c.BB.append(j,[re.getElement(),ce,he.getElement()]),c.BB.css(ce,{position:"absolute",right:"0",top:"0",bottom:"0",width:U-1+"px",overflow:"hidden",backgroundColor:"#ddd",borderLeft:"1px solid rgb(135, 135, 135)",userSelect:"none",touchAction:"none"});var de=void 0;de=n.embed?new h.ToolspaceTopRow({onHelp:function(){u.showIframePopup(n.embed.url+"/help.html",!!n.embed)},onSubmit:function(){s.KL.popup({target:j,message:f.LANG("submit-prompt"),buttons:[f.LANG("submit"),"Cancel"],callback:a.asyncToGenerator(e(o).mark((function t(r){var i;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r===f.LANG("submit")){e.next=2;break}return e.abrupt("return");case 2:i=c.BB.el({parent:j,className:"upload-overlay",content:'<div class="spinner"></div> '+f.LANG("submit-submitting")}),n.embed.onSubmit((function(){n.saveReminder.reset(),j.removeChild(i)}),(function(){j.removeChild(i)}));case 4:case"end":return e.stop()}}),t)})))})},onLeftRight:function(){D="left"===D?"right":"left",L()}}):new s.KL.ToolspaceTopRow({logoImg:n.logoImg,onLogo:function(){u.showIframePopup("./home/",!!n.embed)},onNew:function(){T()},onImport:function(){Me.triggerImport()},onSave:function(){Ee.save()},onShare:function(){I()},onHelp:function(){u.showIframePopup("./help/",!!n.embed)}}),c.BB.addClassName(de.getElement(),"toolspace-row-shadow"),de.getElement().style.marginBottom="10px",ue.appendChild(de.getElement());var ge=new s.KL.ToolspaceToolRow({onActivate:function(e){if("draw"===e)re.setMode("draw");else if("hand"===e)re.setMode("hand");else if("fill"===e)re.setMode("fill");else if("text"===e)re.setMode("text");else{if("shape"!==e)throw new Error("unknown activeStr");re.setMode("shape")}W.open(e),E(),fe.pickingDone()},onZoomIn:function(){re.zoomByStep(ie.isPressed("shift")?1/8:.5)},onZoomOut:function(){re.zoomByStep(ie.isPressed("shift")?-1/8:-.5)},onUndo:function(){Ie.undo()},onRedo:function(){Ie.redo()}});ge.setIsSmall(H<540),l.klHistory.addListener((function(){ge.setEnableUndo(l.klHistory.canUndo()),ge.setEnableRedo(l.klHistory.canRedo())})),c.BB.addClassName(ge.getElement(),"toolspace-row-shadow"),ue.appendChild(ge.getElement());var fe=void 0;(fe=new s.KL.KlColorSlider({width:250,height:30,svHeight:100,startValue:new c.BB.RGB(0,0,0),onPick:function(e){Y=e,J.setColor(e),Z.emitColor(e),fe.pickingDone()}})).setHeight(Math.max(163,Math.min(400,H-505))),fe.setPickCallback((function(e){e?re.setMode("pick"):(re.setMode(ge.getActive()),E())}));var ve=document.createElement("div"),me=document.createElement("div");c.BB.css(me,{margin:"10px",display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"flex-end"});var ye=new s.KL.ToolspaceStabilizerRow({smoothing:1,onSelect:function(e){$.setSmoothing(r(e))}});ve.appendChild(me),c.BB.append(me,[fe.getElement(),fe.getOutputElement(),ye.getElement()]);var xe=new s.KL.TabRow({initialId:"penBrush",useAccent:!0,tabArr:function(){for(var e=function(e){return{id:e,image:s.KL.brushesUI[e].image,title:s.KL.brushesUI[e].tooltip,onOpen:function(){var t;ae[e].getElement().style.display="block","eraserBrush"!==(t=e)&&(Q=t),fe&&("eraserBrush"===t?fe.enable(!1):fe.enable(!0)),_=t,(J=ae[t]).setColor(Y),J.setContext(q),re.setMode("draw"),ge.setActive("draw"),E(),fe.pickingDone(),Z.emitSliderConfig({sizeSlider:s.KL.brushesUI[e].sizeSlider,opacitySlider:s.KL.brushesUI[e].opacitySlider}),i(ae[e].getSize()),Z.emitOpacity(ae[e].getOpacity())},onClose:function(){ae[e].getElement().style.display="none"}}},t=[],n=Object.keys(ae),r=0;r<n.length;r++)t.push(e(n[r]));return t}()});for(var be in ve.appendChild(xe.getElement()),s.KL.brushesUI)s.KL.brushesUI.hasOwnProperty(be)&&ve.appendChild(ae[be].getElement());var we=new s.KL.HandUi({scale:1,angleDeg:0,onReset:function(){re.resetView(!0),we.update(re.getScale(),re.getAngleDeg())},onFit:function(){re.fitView(),we.update(re.getScale(),re.getAngleDeg())},onAngleChange:function(e,t){re.setAngle(e,t),we.update(re.getScale(),re.getAngleDeg())}}),Be=new s.KL.FillUi({colorSlider:fe}),Ce=new s.KL.TextUi({colorSlider:fe}),Se=new s.KL.ShapeUi({colorSlider:fe}),ke=new s.KL.ShapeTool({onShape:function(e,t,n,r,i,a){var o=F.getLayerIndex(q.canvas),l={type:Se.getShape(),x1:t,y1:n,x2:r,y2:i,angleRad:a,isOutwards:Se.getIsOutwards(),opacity:Se.getOpacity(),isEraser:Se.getIsEraser()};"line"===Se.getShape()?(l.strokeRgb=fe.getColor(),l.lineWidth=Se.getLineWidth(),l.isAngleSnap=Se.getIsSnap()||ie.isPressed("shift")):(l.isFixedRatio=Se.getIsFixed()||ie.isPressed("shift"),"stroke"===Se.getMode()?(l.strokeRgb=fe.getColor(),l.lineWidth=Se.getLineWidth()):l.fillRgb=fe.getColor()),e?(F.setComposite(o,null),F.drawShape(o,l)):F.setComposite(o,{draw:function(e){s.KL.drawShape(e,l)}}),re.requestFrame()}}),Le=s.KL.klLayerManager(F,(function(e){A(F.getLayer(e)),l.klHistory.push({tool:["misc"],action:"focusLayer",params:[e]})}),j),Ae=new s.KL.LayerPreview({klRootEl:j,onClick:function(){W.open("layers")}});Ae.setIsVisible(H>=579),Ae.setLayer(F.getLayer(F.getLayerIndex(q.canvas)));var Te=new s.KL.FilterTab(j,fe,Le,A,re,we,(function(){return Y}),(function(){return O}),(function(){return F}),(function(){return q}),!!n.embed,le),Ie=new s.KL.UndoRedoCatchup(ae,Ae,Le,we,re,(function(){if(!K)throw new Error("initState not initialized");return K}),(function(){return F}),(function(){return q}),(function(e){q=e}),(function(){return J}));l.klHistory.addListener((function(e){Ie.catchup(e)}));var Ee=new s.KL.SaveToComputer(n.saveReminder,j,(function(){return X}),(function(){return F}),G),Me=n.embed?null:new s.KL.FileTab(j,N,(function(){return F.getProject()}),X,(function(e){X=e}),S,(function(){Ee.save()}),T,I,(function(){s.KL.imgurUpload(F,j,n.saveReminder,n.app&&n.app.imgurKey?n.app.imgurKey:null)}),M,n.saveReminder),Re=new s.KL.SettingsTab((function(){D="left"===D?"right":"left",L(),n.embed||C.LocalStorage.setItem("uiState",D)}),n.aboutEl);W=new s.KL.TabRow({initialId:"draw",tabArr:[{id:"draw",title:f.LANG("tool-brush"),image:e(v),onOpen:function(){"eraserBrush"===_&&fe.enable(!1),c.BB.append(me,[fe.getElement(),fe.getOutputElement(),ye.getElement()]),ve.style.display="block"},onClose:function(){ve.style.display="none"},css:{minWidth:"45px"}},{id:"hand",title:f.LANG("tool-hand"),image:e(m),isVisible:!1,onOpen:function(){we.setIsVisible(!0)},onClose:function(){we.setIsVisible(!1)},css:{minWidth:"45px"}},{id:"fill",title:f.LANG("tool-paint-bucket"),image:e(y),isVisible:!1,onOpen:function(){fe.enable(!0),Be.setIsVisible(!0)},onClose:function(){Be.setIsVisible(!1)},css:{minWidth:"45px"}},{id:"text",title:f.LANG("tool-text"),image:e(x),isVisible:!1,onOpen:function(){fe.enable(!0),Ce.setIsVisible(!0)},onClose:function(){Ce.setIsVisible(!1)},css:{minWidth:"45px"}},{id:"shape",title:f.LANG("tool-shape"),image:e(b),isVisible:!1,onOpen:function(){fe.enable(!0),Se.setIsVisible(!0)},onClose:function(){Se.setIsVisible(!1)},css:{minWidth:"45px"}},{id:"layers",title:f.LANG("tab-layers"),image:e(B),onOpen:function(){Le.update(),Le.style.display="block"},onClose:function(){Le.style.display="none"},css:{minWidth:"45px"}},{id:"edit",label:f.LANG("tab-edit"),onOpen:function(){Te.show()},onClose:function(){Te.hide()},css:{padding:"0 7px"}},{id:"file",label:f.LANG("tab-file"),isVisible:!!Me,onOpen:function(){Me&&(Me.getElement().style.display="block",Me.setIsVisible(!0))},onClose:function(){Me&&(Me.getElement().style.display="none",Me.setIsVisible(!1))},css:{padding:"0 7px"}},{id:"settings",title:f.LANG("tab-settings"),image:e(w),onOpen:function(){Re.getElement().style.display="block"},onClose:function(){Re.getElement().style.display="none"},css:{minWidth:"45px"}}]});var Oe=c.BB.el({css:{width:"270px",position:"absolute",bottom:"0",left:"0"}});n.bottomBar&&(Oe.append(n.bottomBar),new MutationObserver((function(){return R()})).observe(ue,{attributes:!0,childList:!0,subtree:!0}));c.BB.append(ue,[Ae.getElement(),W.getElement(),ve,we.getElement(),Be.getElement(),Ce.getElement(),Se.getElement(),Le,Te.getElement(),Me?Me.getElement():null,Re.getElement(),c.BB.el({css:{height:"10px"}}),Oe||null]);var Pe,De=new s.KL.ToolspaceScroller({toolspace:ce,uiState:D});this.getEl=function(){return j},this.resize=function(e,t){window.scrollY>0&&window.scrollTo(0,0),z===Math.max(0,e)&&H===Math.max(0,t)||(z=Math.max(0,e),H=Math.max(0,t),k(),R(),Ae.setIsVisible(H>=579),fe.setHeight(Math.max(163,Math.min(400,H-505))),ge.setIsSmall(H<540))},this.out=function(e){le.out(e)},this.getPNG=function(){return d.base64ToBlob(F.getCompleteCanvas(1).toDataURL("image/png"))},this.getPSD=(Pe=a.asyncToGenerator(e(o).mark((function t(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.klCanvasToPsdBlob(F);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),t)}))),function(){return Pe.apply(this,arguments)}),this.swapUiLeftRight=function(){D="left"===D?"right":"left",n.embed||C.LocalStorage.setItem("uiState",D),L()},this.saveAsPsd=function(){Ee.save("psd")},this.isDrawing=function(){return ee.getIsDrawing()||re.getIsDrawing()},this.resize(z,H),L();var Ge=this;c.BB.addEventListener(window,"resize",(function(){Ge.resize(window.innerWidth,window.innerHeight)})),c.BB.addEventListener(window,"orientationchange",(function(){Ge.resize(window.innerWidth,window.innerHeight)}));var Ne=c.BB.el({parent:document.body,css:{position:"fixed",left:"0",top:"0",right:"0",bottom:"0",pointerEvents:"none",zIndex:"-1",userSelect:"none"}});try{var je=this;new ResizeObserver((function(){return je.resize(window.innerWidth,window.innerHeight)})).observe(Ne)}catch(e){Ne.parentNode.removeChild(Ne)}c.BB.addEventListener(this.getEl(),"wheel",(function(e){e.preventDefault()}));var ze=function(e){e.preventDefault()};window.addEventListener("gesturestart",ze),window.addEventListener("gesturechange",ze),window.addEventListener("gestureend",ze)}p.importFilters()})),r.register("hrnUX",(function(e,n){t(e.exports,"KL",(function(){return we}));var i=r("gWfkn"),a=r("ekHRj"),o=r("i8UFO"),s=r("lXqiv"),l=r("c4LUw"),c=r("21VAD"),u=r("jKOQl"),h=r("gmlbk"),p=r("fCJWy"),d=r("llzZ0"),g=r("l4PqG"),f=r("lfHl9"),v=r("h7i9r"),m=r("kzhsD"),y=r("bd9hB"),x=r("9A7OD"),b=r("iskOY"),w=r("bmB93"),B=r("auloj"),C=r("hRdOL"),S=r("isYih"),k=r("5rdL4"),L=r("7bo3M"),A=r("lV6Vy"),T=r("i5nyl"),I=r("cNhNm"),E=r("kEeSq"),M=r("32CBv"),R=r("kqmpc"),O=r("j1kEL"),P=r("8ebuX"),D=r("13r5y"),G=r("9p4Zp"),N=r("8jqzp"),j=r("84zxV"),z=r("9Kxky"),H=r("1Ax5m"),U=r("e4sAN"),X=r("khi8I"),F=r("dJXmR"),W=r("iS9xS"),K=r("9J17G"),V=r("76Qvv"),Y=r("1uc3b"),J=r("h20yl"),_=r("keKW3"),Q=r("kDGzx"),q=r("30Cml"),Z=r("941rU"),$=r("3ujzu"),ee=r("705qg"),te=r("9BlwZ"),ne=r("kyVjY"),re=r("dAXbp"),ie=r("3P46L"),ae=r("5ebUJ"),oe=r("bHZQg"),se=r("9pcu9"),le=r("aSJRf"),ce=r("6mTnI"),ue=r("eK8ID"),he=r("2umOB"),pe=r("5ENro"),de=r("lkluh"),ge=r("5ngYX"),fe=r("eyygR"),ve=r("6rdi0"),me=(te=r("9BlwZ"),r("7pyBK")),ye=r("iDHln"),xe=r("bIgqE"),be=r("iVHpg"),we={brushes:re.brushes,brushesUI:ie.brushesUI,BrushSettingService:me.BrushSettingService,KlCanvas:ee.KlCanvas,drawProject:le.drawProject,WorkspaceSvgOverlay:L.WorkspaceSvgOverlay,KlCanvasWorkspace:A.KlCanvasWorkspace,KlCanvasPreview:T.KlCanvasPreview,filterLibStatus:ne.filterLibStatus,filterLib:ne.filterLib,UndoRedoCatchup:ve.UndoRedoCatchup,renderText:J.renderText,floodFillBits:q.floodFillBits,ShapeTool:$.ShapeTool,drawShape:$.drawShape,PSD:Z,setDbName:te.setDbName,indexedDb:te,ProjectStore:ce.ProjectStore,loadAgPsd:de.loadAgPsd,SaveToComputer:fe.SaveToComputer,calcSliderFalloffFactor:g.calcSliderFalloffFactor,Checkbox:s.Checkbox,input:l.input,Select:c.Select,ImageToggle:u.ImageToggle,ImageRadioList:h.ImageRadioList,RadioList:oe.RadioList,penPressureToggle:p.penPressureToggle,KlSlider:d.KlSlider,HexColorDialog:f.HexColorDialog,KlColorSlider:v.KlColorSlider,KlSmallColorSlider:m.KlSmallColorSlider,PointSlider:y.PointSlider,ColorOptions:x.ColorOptions,Options:b.Options,BoxToggle:ye.BoxToggle,StatusOverlay:w.StatusOverlay,CropCopy:C.CropCopy,FreeTransform:I.FreeTransform,FreeTransformCanvas:E.FreeTransformCanvas,Cropper:M.Cropper,LayerPreview:R.LayerPreview,FittedImage:O.FittedImage,KlImageDropper:D.KlImageDropper,OverlayToolspace:G.OverlayToolspace,ToolspaceTopRow:N.ToolspaceTopRow,ToolDropdown:j.ToolDropdown,ToolspaceToolRow:z.ToolspaceToolRow,ToolspaceStabilizerRow:H.ToolspaceStabilizerRow,TabRow:U.TabRow,ToolspaceCollapser:Y.ToolspaceCollapser,BrowserStorageUi:se.BrowserStorageUi,SaveReminder:ge.SaveReminder,ToolspaceScroller:be.ToolspaceScroller,dialogCounter:o.dialogCounter,popup:a.popup,Popup:a.Popup,exportDialog:B.exportDialog,clipboardDialog:S.clipboardDialog,showImportAsLayerDialog:P.showImportAsLayerDialog,newImageDialog:V.newImageDialog,textToolDialog:_.textToolDialog,showImportImageDialog:Q.showImportImageDialog,showIframePopup:ae.showIframePopup,imgurUpload:pe.imgurUpload,HandUi:X.HandUi,FillUi:F.FillUi,TextUi:W.TextUi,ShapeUi:K.ShapeUi,FileTab:ue.FileTab,FilterTab:he.FilterTab,SettingsTab:xe.SettingsTab,klLayerManager:k.klLayerManager,klHistory:i.klHistory,DecoyKlHistory:i.DecoyKlHistory}})),r.register("gWfkn",(function(e,n){t(e.exports,"DecoyKlHistory",(function(){return o})),t(e.exports,"klHistory",(function(){return s}));var i=r("4gaLD"),a=!1,o=function(){"use strict";function e(){i.classCallCheck(this,e)}return i.createClass(e,[{key:"pause",value:function(e){}},{key:"addListener",value:function(e){}},{key:"push",value:function(e){}},{key:"undo",value:function(){return[]}},{key:"redo",value:function(){return[]}},{key:"getAll",value:function(){return[]}},{key:"canRedo",value:function(){return!1}},{key:"canUndo",value:function(){return!1}},{key:"getState",value:function(){return 0}},{key:"getActionNumber",value:function(){return 0}}]),e}(),s=new(function(){"use strict";function e(){if(i.classCallCheck(this,e),this.max=20,a)throw new Error("klHistory already instantiated");a=!0,this.state=0,this.dataArr=[],this.listeners=[],this.pauseStack=0,this.maxState=-1,this.actionNumber=-1}return i.createClass(e,[{key:"broadcast",value:function(e){var t=this;setTimeout((function(){for(var n=0;n<t.listeners.length;n++)t.listeners[n](e);t.state++}),1)}},{key:"pause",value:function(e){!1===e?this.pauseStack=Math.max(0,this.pauseStack-1):this.pauseStack++}},{key:"addListener",value:function(e){this.listeners.push(e)}},{key:"push",value:function(e){if(!(this.pauseStack>0)){for(;this.actionNumber<this.dataArr.length-1;)this.dataArr.pop();var t=this.dataArr[this.dataArr.length-1];if("layerOpacity"===e.action&&t&&"layerOpacity"===t.action&&t.params[0]===e.params[0])return this.dataArr[this.dataArr.length-1]=e,void this.state++;if("focusLayer"===e.action&&t&&"focusLayer"===t.action)return this.dataArr[this.dataArr.length-1]=e,void this.state++;this.dataArr[this.dataArr.length]=e,this.actionNumber=this.dataArr.length-1;var n=this.maxState;this.maxState=Math.max(this.maxState,this.actionNumber-this.max),n<this.maxState?this.broadcast({bufferUpdate:this.dataArr[this.maxState]}):this.broadcast(null),this.maxState>=0&&(this.dataArr[this.maxState]=null)}}},{key:"undo",value:function(){var e;if(this.canUndo()){e=[];for(var t=this.maxState+1;t<this.actionNumber;t++)e.push(this.dataArr[t]);this.actionNumber--,this.broadcast(null)}return e}},{key:"redo",value:function(){var e=[];return this.canRedo()&&(this.actionNumber++,e.push(this.dataArr[this.actionNumber]),this.broadcast(null)),e}},{key:"getAll",value:function(){return[].concat(this.dataArr)}},{key:"canRedo",value:function(){return this.actionNumber<this.dataArr.length-1}},{key:"canUndo",value:function(){return this.actionNumber>this.maxState}},{key:"getState",value:function(){return this.state}},{key:"getActionNumber",value:function(){return this.actionNumber+1}}]),e}())})),r.register("ekHRj",(function(n,i){t(n.exports,"popup",(function(){return u})),t(n.exports,"Popup",(function(){return h}));var a=r("i8UFO"),o=r("eWjiX"),s=r("c0kqC"),l=r("fh18w"),c=r("1mH1z");function u(t){var n=function(e){if(!r){r=!0,o.BB.clearSelection();var n=o.BB.el({parent:document.body,tagName:"input",css:{opacity:"0",width:"0",height:"0"}});setTimeout((function(){n.select(),n.focus(),n.parentNode.removeChild(n)}),10),document.body.removeChild(i),a.dialogCounter.decrease(),o.BB.destroyEl(d),o.BB.destroyEl(p),v.destroy(),o.BB.removeEventListener(u,"wheel",m),u.onclick=null,w.forEach((function(e){o.BB.destroyEl(e)})),w.splice(0,w.length),t.callback&&t.callback(e)}};a.dialogCounter.increase();var r=!1,i=o.BB.el({parent:document.body,css:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0",overflow:"hidden"}}),u=o.BB.el({parent:i,className:"kl-popup"}),h=o.BB.el({parent:u,css:{width:"100%",minHeight:"100%",position:"relative",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}}),p=o.BB.el({parent:h,onClick:function(){t.ignoreBackground||n("Cancel")},css:{position:"absolute",left:"0",top:"0",zIndex:"0",width:"100%",height:"100%"}}),d=o.BB.el({tagName:"button",className:"popup-x",content:'<img alt="'.concat(c.LANG("modal-close"),'" height="20" src="').concat(e(l),'">'),title:c.LANG("modal-close"),onClick:function(){n("Cancel")},css:{width:"40px",height:"40px",lineHeight:"40px",position:"absolute",right:"0",top:"0",background:"none",boxShadow:"none"}}),g=["kl-popup-box"];g.push("kl-popup-box--sm");var f=o.BB.el({content:[d,o.BB.el({content:t.message,css:{marginBottom:t.div?"10px":null,marginRight:"15px"}}),t.div],className:g.join(" "),css:t.style?t.style:null});h.append(o.BB.el({css:{flex:"0.5"}}),f,o.BB.el({css:{flex:"1"}})),"error"===t.type&&o.BB.addClassName(f,"poperror"),"ok"===t.type&&o.BB.addClassName(f,"popok"),"warning"===t.type&&o.BB.addClassName(f,"popwarning"),"upload"===t.type&&o.BB.addClassName(f,"popupload");var v=new o.BB.KeyListener({onDown:function(e,t,i){r||(x&&"enter"===i&&!o.BB.isInputFocused()&&(t.stopPropagation(),setTimeout((function(){x.click()}),10)),"esc"===i&&(t.stopPropagation(),n("Cancel")))}}),m=function(e){v.isPressed("ctrl")&&e.preventDefault()};o.BB.addEventListener(u,"wheel",m),u.onclick=o.BB.handleClick;var y=null;y=t.autoFocus?t.autoFocus:!1===t.autoFocus?null:"Ok";var x,b=t.buttons&&t.buttons.length>0?o.BB.el({parent:f,css:{display:"flex",flexWrap:"wrap",justifyContent:"flex-end",marginTop:"12px",marginLeft:"-8px"}}):null,w=[];t.buttons&&t.buttons.forEach((function(r){var i,a=["kl-popup__btn"];("Ok"===r||t.primaries&&t.primaries.includes(r))&&a.push("kl-button-primary");var h=r;"Ok"===r&&(h=c.LANG("modal-ok"),i=e(s)),"Cancel"===r&&(h=c.LANG("modal-cancel"),i=e(l));var p=null;i&&(p=o.BB.el({tagName:"img",custom:{src:i,height:"17"}}));var d=o.BB.el({parent:b,tagName:"button",className:a.join(" "),content:[p,h],onClick:function(){n(r)}});w.push(d),y===r&&(setTimeout((function(){d.focus(),u.scrollTo(0,0)}),10),setTimeout((function(){u.scrollTo(0,0)}),20)),r===t.clickOnEnter&&(x=d)})),t.closefunc&&t.closefunc((function(){n("Cancel")}))}window.onscroll=function(e){e.preventDefault()};var h=function(t){var n=function(){a.dialogCounter.decrease(),s.onclick=null,i.removeChild(s),clearInterval(undefined),window.removeEventListener("resize",r),f.destroy(),o.BB.destroyEl(d),o.BB.destroyEl(u),t.onClose&&t.onClose()},r=function(){var e=h.offsetWidth,t=h.offsetHeight;o.BB.css(h,{left:Math.max(0,(window.innerWidth-e)/2)+"px",top:Math.max(20,(window.innerHeight-t)/2-.2*t)+"px"})};a.dialogCounter.increase();var i=document.body,s=o.BB.el({parent:i,className:"g-root",css:{position:"fixed",left:"0",top:"0",bottom:"0",right:"0",background:"rgba(0, 0, 0, 0.45)",overflow:"auto",animationName:"consoleIn",animationDuration:"0.3s",animationTimingFunction:"ease-out"}});s.onclick=o.BB.handleClick;var u=o.BB.el({parent:s,css:{position:"absolute",left:"0",top:"0",bottom:"0",right:"0"},onClick:n}),h=o.BB.el({parent:s,css:{position:"absolute",width:o.BB.isCssMinMaxSupported()?"min(calc(100% - 40px), "+(t.width?t.width:400)+"px)":(t.width?t.width:400)+"px",height:"calc(100% - 40px)",background:"#eee",borderRadius:"10px",overflow:"hidden",boxShadow:"rgba(0, 0, 0, 0.25) 0px 5px 60px"}});r(),window.addEventListener("resize",r);var p=o.BB.el({parent:h,css:{height:"40px",display:"flex",justifyContent:"space-between",alignItems:"center",paddingLeft:"20px"}});t.title&&p.appendChild(t.title);var d=o.BB.el({parent:p,tagName:"button",className:"popup-x",content:'<img alt="'.concat(c.LANG("modal-close"),'" height="20" src="').concat(e(l),'">'),title:c.LANG("modal-close"),onClick:n,css:{width:"40px",height:"40px",lineHeight:"40px",background:"none",boxShadow:"none"},custom:{tabindex:"0"}}),g=o.BB.el({parent:h,css:{height:"calc(100% - 40px)"}});t.content&&g.appendChild(t.content);var f=new o.BB.KeyListener({onDown:function(e,t){"esc"===e&&(t.stopPropagation(),n())}});this.close=function(){n()}}})),r.register("i8UFO",(function(e,n){t(e.exports,"dialogCounter",(function(){return a}));var i=r("4gaLD"),a=new(function(){"use strict";function e(){i.classCallCheck(this,e),this.listeners=[],this.count=0}return i.createClass(e,[{key:"emit",value:function(){var e=this;this.listeners.forEach((function(t){t(e.count)}))}},{key:"increase",value:function(e){void 0!==e?this.count+=e:this.count++,this.emit()}},{key:"decrease",value:function(e){void 0!==e?this.count-=e:this.count--,this.emit()}},{key:"get",value:function(){return this.count}},{key:"subscribe",value:function(e){this.listeners.push(e)}}]),e}())})),r.register("eWjiX",(function(e,n){t(e.exports,"BB",(function(){return b}));var i=r("h4olN"),a=r("7jh4K"),o=r("6J2My"),s=r("idV3L"),l=r("04lDo"),c=r("exufe"),u=r("eIcQa"),h=r("kVHNC"),p=r("4toIY"),d=r("af1iA"),g=r("dJ1E2"),f=r("72Jv0"),v=r("eg83P"),m=r("eelgW"),y=r("i0uIf"),x=r("6l0gQ"),b={eventUsesHighResTimeStamp:o.eventUsesHighResTimeStamp,mouseEventHasMovement:o.mouseEventHasMovement,hasPointerEvents:o.hasPointerEvents,hasWebGl:o.hasWebGl,getVisitor:o.getVisitor,isCssMinMaxSupported:o.isCssMinMaxSupported,canShareFiles:o.canShareFiles,insertAfter:a.insertAfter,loadImage:a.loadImage,css:a.css,setAttributes:a.setAttributes,addClassName:a.addClassName,removeClassName:a.removeClassName,append:a.append,fitInto:a.fitInto,centerWithin:a.centerWithin,getDate:a.getDate,gcd:a.gcd,reduce:a.reduce,decToFraction:a.decToFraction,imageBlobToUrl:a.imageBlobToUrl,dateDayDifference:a.dateDayDifference,copyObj:a.copyObj,shareCanvas:a.shareCanvas,handleClick:a.handleClick,createSvg:a.createSvg,BbLog:y.BbLog,LocalStorage:x.LocalStorage,mix:v.mix,dist:v.dist,distSquared:v.distSquared,lenSquared:v.lenSquared,pointsToAngleRad:v.pointsToAngleRad,pointsToAngleDeg:v.pointsToAngleDeg,clamp:v.clamp,rotate:v.rotate,rotateAround:v.rotateAround,Matrix:h.Matrix,Vec2:p.Vec2,intDxy:v.intDxy,roundEven:v.roundEven,roundUneven:v.roundUneven,updateBounds:v.updateBounds,boundsInArea:v.boundsInArea,projectPointOnLine:d.projectPointOnLine,PointLine:d.PointLine,BezierLine:d.BezierLine,SplineInterpolator:d.SplineInterpolator,quadraticSplineInput:d.quadraticSplineInput,canvas:m.createCanvas,copyCanvas:u.copyCanvas,testShouldPixelate:u.testShouldPixelate,drawTransformedImageWithBounds:u.drawTransformedImageWithBounds,drawTransformedImageOnCanvas:u.drawTransformedImageOnCanvas,createCheckerCanvas:u.createCheckerCanvas,createCheckerDataUrl:u.createCheckerDataUrl,resizeCanvas:u.resizeCanvas,convertToAlphaChannelCanvas:u.convertToAlphaChannelCanvas,freeCanvas:u.freeCanvas,HSV:g.HSV,RGB:g.RGB,CMYK:g.CMYK,ColorConverter:g.ColorConverter,testIsWhiteBestContrast:g.testIsWhiteBestContrast,appendTextDiv:f.appendTextDiv,clearSelection:f.clearSelection,makeUnfocusable:f.makeUnfocusable,el:f.el,destroyEl:f.destroyEl,isInputFocused:f.isInputFocused,addEventListener:i.addEventListener,removeEventListener:i.removeEventListener,setEventListener:i.setEventListener,KeyListener:s.KeyListener,PointerListener:l.PointerListener,sameKeys:s.sameKeys,EventChain:c}})),r.register("h4olN",(function(e,n){t(e.exports,"setEventListener",(function(){return a})),t(e.exports,"addEventListener",(function(){return o})),t(e.exports,"removeEventListener",(function(){return s}));var i=r("6J2My"),a=function(e,t,n){i.hasPointerEvents||(t=t.replace("pointer","mouse")),e[t]=n},o=function(e,t,n,r){i.hasPointerEvents||(t=t.replace("pointer","mouse")),e.addEventListener(t,n,r)},s=function(e,t,n,r){i.hasPointerEvents||(t=t.replace("pointer","mouse")),e.removeEventListener(t,n,r)}})),r.register("6J2My",(function(e,n){t(e.exports,"isFirefox",(function(){return c})),t(e.exports,"eventUsesHighResTimeStamp",(function(){return u})),t(e.exports,"mouseEventHasMovement",(function(){return h})),t(e.exports,"hasPointerEvents",(function(){return p})),t(e.exports,"hasWebGl",(function(){return d})),t(e.exports,"getVisitor",(function(){return g})),t(e.exports,"isCssMinMaxSupported",(function(){return f})),t(e.exports,"canShareFiles",(function(){return v}));var i,a,o,s,l=r("eelgW"),c=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,u=function(){var e,t=null;return document.body?(e=new Event(""),t=e.timeStamp<36e5):window.addEventListener("DOMContentLoaded",(function(e){t=e.timeStamp<36e5})),function(){if(null===t)throw"eventUsesHighResTimeStamp not initialized";return t}}(),h=function(){if(!("MouseEvent"in window))return!1;var e;try{e=new MouseEvent("mousemove")}catch(e){return!1}return"movementX"in e&&!c}(),p=!!window.PointerEvent,d=(i=function(){var e=l.createCanvas();try{return e.getContext("experimental-webgl",{premultipliedAlpha:!1}),!0}catch(e){return!1}}(),function(){return i}),g=(a={chrome:!1,gl:!1},window.chrome&&window.chrome.app&&(a.chrome=!0),a.gl=d(),function(){return JSON.parse(JSON.stringify(a))}),f=(o=function(){var e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="max(0px, 25px)",document.body.appendChild(e),setTimeout((function(){s=25===e.offsetLeft,document.body.removeChild(e)}),25)},s=null,document.body?o():window.addEventListener("DOMContentLoaded",(function(){o()})),function(){if(null===s)throw new Error("isCssMinMaxSupported not initialized");return s}),v=function(){return"share"in navigator&&"canShare"in navigator}})),r.register("eelgW",(function(e,n){function r(e,t){var n=document.createElement("canvas");return e&&t&&(n.width=e,n.height=t),n}t(e.exports,"createCanvas",(function(){return r}))})),r.register("7jh4K",(function(e,n){function r(e,t){e.parentNode&&e.parentNode.insertBefore(t,e.nextSibling)}function i(e,t){var n=0;!function r(){1e3!==n?e.complete?(n++,t()):setTimeout(r,1):alert("couldn't load")}()}function a(e,t){for(var n,r=Object.keys(t),i=e.style,a=0;a<r.length;a++)i[n=r[a]]=t[n],i.alignContent="true","userSelect"===n&&(i.webkitUserSelect=t[n])}function o(e,t){for(var n,r=Object.keys(t),i=0;i<r.length;i++)n=r[i],e.setAttribute(n,t[n])}function s(e,t){var n=e.getAttribute("class"),r=null===n?[]:n.split(" ");r.includes(t)||(r.push(t),e.setAttribute("class",r.join(" ")))}function l(e,t){var n=e.getAttribute("class"),r=null===n?[]:n.split(" ");if(r.includes(t)){for(var i=0;i<r.length;i++)r[i]===t&&(r.splice(i,1),i--);e.setAttribute("class",r.join(" "))}}function c(e,t){var n=document.createDocumentFragment();t.forEach((function(e){return e?n.append(e):null})),e.append(n)}function u(e,t,n,r,i){var a=e*n,o=t*n;return a>n&&(o*=n/a,a=n),o>r&&(a*=r/o,o=r),i&&(a=Math.max(i,a),o=Math.max(i,o)),{width:a,height:o}}function h(e,t,n,r){return{x:e/2-n/2,y:t/2-r/2}}function p(){var e=new Date;return e.getFullYear()+"_"+(e.getMonth()+1).toString().padStart(2,"0")+"_"+e.getDate().toString().padStart(2,"0")+"_"+(60*e.getHours()+e.getMinutes()).toString(36).padStart(3,"0")+"_"}function d(e,t){return t?d(t,e%t):e}function g(e,t){var n=d(e,t);return[e/n,t/n]}function f(e){var t=e.toString().length-2,n=Math.pow(10,t);return g(e*n,n)}function v(e){if(!e)throw new Error("blobObj is undefined or null");if(window.Blob&&e instanceof Blob)return URL.createObjectURL(e);if("Object"===e.constructor.name){var t=e;return"data:"+t.type+";"+t.encoding+","+t.data}throw new Error("unknown blob format")}function m(e,t){return e=new Date(e),t=new Date(t),e.setHours(0,0,0,0),t.setHours(0,0,0,0),(t.getTime()-e.getTime())/864e5}function y(e){return JSON.parse(JSON.stringify(e))}function x(e){var t="image/png",n=function(){return alert("sharing not supported")};e.canvas.toBlob((function(r){if(null===r)return n(),void e.callback();try{var i=[new File([r],e.fileName,{type:t})];navigator.share({title:e.title,files:i}).then((function(e){})).catch((function(e){n()}))}catch(e){n()}e.callback()}),t)}function b(e){var t=e.target;return!!t&&(!(!["A","LABEL","INPUT"].includes(t.tagName)&&!t.allowClick)||(e.preventDefault(),!1))}function w(e){for(var t,n=document.createElementNS("http://www.w3.org/2000/svg",e.elementType),r=Object.keys(e),i=0;i<r.length;i++)if("childrenArr"===(t=r[i]))for(var a=0;a<e.childrenArr.length;a++)n.appendChild(w(e.childrenArr[a]));else"elementType"!==t&&n.setAttribute(t,e[t]);return n}t(e.exports,"insertAfter",(function(){return r})),t(e.exports,"loadImage",(function(){return i})),t(e.exports,"css",(function(){return a})),t(e.exports,"setAttributes",(function(){return o})),t(e.exports,"addClassName",(function(){return s})),t(e.exports,"removeClassName",(function(){return l})),t(e.exports,"append",(function(){return c})),t(e.exports,"fitInto",(function(){return u})),t(e.exports,"centerWithin",(function(){return h})),t(e.exports,"getDate",(function(){return p})),t(e.exports,"gcd",(function(){return d})),t(e.exports,"reduce",(function(){return g})),t(e.exports,"decToFraction",(function(){return f})),t(e.exports,"imageBlobToUrl",(function(){return v})),t(e.exports,"dateDayDifference",(function(){return m})),t(e.exports,"copyObj",(function(){return y})),t(e.exports,"shareCanvas",(function(){return x})),t(e.exports,"handleClick",(function(){return b})),t(e.exports,"createSvg",(function(){return w}))})),r.register("idV3L",(function(e,n){t(e.exports,"KeyListener",(function(){return s})),t(e.exports,"sameKeys",(function(){return l}));var i=r("4gaLD"),a=r("h4olN"),o=function(){for(var e=function(e,t,n,r){p.forEach((function(i){i[0]&&i[0](e,t,n,r)}))},t=function(e,t,n){p.forEach((function(r){r[1]&&r[1](e,t,n)}))},n=function(t){var n=t.key,r="code"in t?t.code:t.keyCode;if(n in c){var i=c[n];if(l[i])return void e(i,t,u.join("+"),!0);l[i]=!0,h[r]=i,u.push(i),e(i,t,u.join("+"))}},r=function(e){e.key;var n="code"in e?e.code:e.keyCode,r=u.join("+");if(["Meta","MetaLeft","MetaRight","OSLeft","OSRight"].includes(n))i(null);else if(n in h&&null!==h[n]){var a=h[n];l[a]=!1,h[n]=null;for(var o=0;o<u.length;o++)u[o]==a&&(u.splice(o,1),o--);t(a,e,r)}},i=function(e){var n=u.join("+");u=[],h={};for(var r=[],i=0;i<s.length;i++)l[s[i]]&&(l[s[i]]=!1,r.push(s[i]));for(var a=0;a<r.length;a++)t(r[a],{preventDefault:function(){},stopPropagation:function(){}},n);p.forEach((function(e){e[2]&&e[2]()}))},o={space:[" ","Spacebar"],alt:["Alt","AltGraph"],shift:"Shift",ctrl:"Control",cmd:["Meta","MetaLeft","MetaRight"],enter:"Enter",esc:"Escape",backspace:"Backspace",delete:"Delete",sqbr_open:"[",sqbr_close:"]",a:["a","A"],b:["b","B"],c:["c","C"],e:["e","E"],f:["f","F"],g:["g","G"],r:["r","R"],s:["s","S"],t:["t","T"],u:["u","U"],x:["x","X"],y:["y","Y"],z:["z","Z"],plus:"+",minus:"-",left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown",home:"Home",end:"End"},s=Object.keys(o),l={},c={},u=[],h={},p=[],d=0;d<s.length;d++){l[s[d]]=!1;var g=o[s[d]];if("string"==typeof g)c[o[s[d]]]=s[d];else for(var f=0;f<g.length;f++)c[g[f]]=s[d]}return{add:function(e){if(!p.includes(e)){var t=0===p.length;p.push(e),t&&(a.addEventListener(document,"keydown",n),a.addEventListener(document,"keyup",r),a.addEventListener(window,"blur",i))}},remove:function(e){if(p.includes(e)){for(var t=1===p.length,o=0;o<p.length;o++)if(p[o]===e){p.splice(o,1);break}t&&(a.removeEventListener(document,"keydown",n),a.removeEventListener(document,"keyup",r),a.removeEventListener(window,"blur",i))}},getIsDown:function(){return l},getCombo:function(){return u}}}(),s=function(){"use strict";function e(t){i.classCallCheck(this,e),this.onDown=t.onDown,this.onUp=t.onUp,this.onBlur=t.onBlur,this.ref=[this.onDown,this.onUp,this.onBlur],o.add(this.ref)}return i.createClass(e,[{key:"isPressed",value:function(e){if(!(e in o.getIsDown()))throw'key "'+e+'" not found';return o.getIsDown()[e]}},{key:"getComboStr",value:function(){return o.getCombo().join("+")}},{key:"comboOnlyContains",value:function(e){for(var t=0;t<o.getCombo().length;t++)if(!e.includes(o.getCombo()[t]))return!1;return!0}},{key:"destroy",value:function(){o.remove(this.ref)}}]),e}();function l(e,t){return e.split("+").sort().join("+")===t.split("+").sort().join("+")}})),r.register("04lDo",(function(e,n){t(e.exports,"PointerListener",(function(){return d}));var i,a,o,s,l,c=r("h4olN"),u=r("6J2My"),h=r("eg83P"),p=function(e){var t,n=function(t){e({deltaY:Math.round(t/o),pageX:l.pageX,pageY:l.pageY,clientX:l.clientX,clientY:l.clientY})},r=function(){null!==s&&(n(s),s=null),null===o||i.includes(o)||i.push(o),a=0,o=null},i=[100],a=0,o=null,s=null,l=null;this.process=function(e){l={pageX:e.pageX,pageY:e.pageY,clientX:e.clientX,clientY:e.clientY},clearTimeout(t),t=setTimeout(r,200);var c=e.deltaY;"deltaMode"in e&&1===e.deltaMode&&(c*=100/3);var u=Math.abs(c);if(a>0&&null===o)s=null;else{if(0===a){if(a++,u<50)return;return o=u,void(i.includes(o)?n(c):s=c)}if(0!==u){if(u===o||u/o%1<1e-4);else if(o/u%1<1e-4)o=u;else if(u!==o)return o=null,void(s=null);null!==s&&(n(s),s=null),n(c)}}}},d=(i=[],a=0,o=null,s=!1,l=1,function(e){var t,n,r,d=function(e){for(var t=0;t<H.length;t++)if(e===H[t].pointerId)return H[t];return null},g=function(e){for(var t=null,n=0;n<U.length;n++)U[n]===e&&(t=H[n],H.splice(n,1),U.splice(n,1),n--);return t},f=function(e,t){return 0===e||1===e?e:(a<60?(o=0===a?e:h.mix(e,o,.95),a++):s||(s=!0,o<.13&&(l=2.3)),Math.pow(e,1/l))},v=function(e){if(e.corrected)return e.corrected;var t={pointerId:e.pointerId,pointerType:e.pointerType,pageX:e.pageX,pageY:e.pageY,clientX:e.clientX,clientY:e.clientY,movementX:e.movementX,movementY:e.movementY,timeStamp:e.timeStamp+N,pressure:f(e.pressure,e.type),buttons:e.buttons,button:e.button,coalescedArr:[],eventPreventDefault:function(){e.preventDefault()},eventStopPropagation:function(){e.stopPropagation()}};e.corrected=t;var n=null;"pointerId"in e?"pressure"in e&&0!==e.buttons&&(["mouse"].includes(e.pointerType)||"touch"===e.pointerType&&0===e.pressure)&&(t.pressure=1,n=1):(t.pointerId=0,t.pointerType="mouse",t.pressure=0!==e.buttons?1:0,n=t.pressure),u.isFirefox&&"mouse"!=e.pointerType&&"pointermove"===e.type&&0===e.buttons&&(t.buttons=1);var r=[];"getCoalescedEvents"in e&&(r=e.getCoalescedEvents());var a=function(e){for(var t=i.length-1;t>=0;t--)if(e.pointerId===i[t].pointerId)return i[t];return null}(t);null===a&&(a=function(e){var t={pointerId:e.pointerId,lastPageX:null,lastPageY:null};return i.push(t),i.length>15&&i.shift(),t}(t));for(var o=a.lastPageX,s=a.lastPageY,l=0;l<r.length;l++){var c=r[l];t.coalescedArr.push({pageX:c.pageX,pageY:c.pageY,clientX:c.clientX,clientY:c.clientY,movementX:null===a.lastPageX?0:c.pageX-a.lastPageX,movementY:null===a.lastPageY?0:c.pageY-a.lastPageY,timeStamp:0===c.timeStamp?t.timeStamp:c.timeStamp+N,pressure:null===n?f(c.pressure):n}),a.lastPageX=c.pageX,a.lastPageY=c.pageY}return a.lastPageX=t.pageX,a.lastPageY=t.pageY,t.movementX=null===o?0:a.lastPageX-o,t.movementY=null===s?0:a.lastPageY-s,t},m=function(e,t,n){var r=I.getBoundingClientRect(),i={type:e,pointerId:t.pointerId,pointerType:t.pointerType,pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY,relX:t.clientX-r.left+I.scrollLeft,relY:t.clientY-r.top+I.scrollTop,dX:t.movementX,dY:t.movementY,time:t.timeStamp,eventPreventDefault:t.eventPreventDefault,eventStopPropagation:t.eventStopPropagation};if("pointermove"===e&&(i.coalescedArr=[],t.coalescedArr.length>1))for(var a,o=0;o<t.coalescedArr.length;o++)a=t.coalescedArr[o],i.coalescedArr.push({pageX:a.pageX,pageY:a.pageY,clientX:a.clientX,clientY:a.clientY,relX:a.clientX-r.left+I.scrollLeft,relY:a.clientY-r.top+I.scrollTop,dX:a.movementX,dY:a.movementY,time:a.timeStamp});if(n)for(var s=Object.keys(n),l=0;l<s.length;l++)i[s[l]]=n[s[l]];return i},y=function(e,t,n,r){var i=I.getBoundingClientRect(),a={type:e,pointerId:t.identifier,pointerType:"touch",pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY,relX:t.pageX-i.left+I.scrollLeft,relY:t.pageY-i.top+I.scrollTop,time:n.timeStamp+N,eventPreventDefault:function(){n.preventDefault()},eventStopPropagation:function(){n.stopPropagation()}};"pointermove"===e&&(a.coalescedArr=[]);for(var o=Object.keys(r),s=0;s<o.length;s++)a[o[s]]=r[o[s]];return a},x=function(){c.removeEventListener(document,"pointermove",S),c.removeEventListener(document,"pointerup",k),c.removeEventListener(document,"pointerleave",L)},b=function(){X++,R&&R(!0)},w=function(){X--,R&&R(!1)},B=function(e){e=v(e);var t=j;if(j=e.pointerType,U.includes(e.pointerId)||U.length===O||"touch"===e.pointerType)z=!1;else if(z||"mouse"!==e.pointerType||"pen"!==t){z=!1;var n=m("pointermove",e);E(n)}else z=!0},C=function(e){if(e=v(e),!U.includes(e.pointerId)&&U.length!==O&&[1,2,4].includes(e.buttons)){0===H.length&&(c.addEventListener(document,"pointermove",S),c.addEventListener(document,"pointerup",k),c.addEventListener(document,"pointerleave",L));var t={pointerId:e.pointerId,pointerType:e.pointerType,downPageX:e.pageX,downPageY:e.pageY,buttons:e.buttons,lastPageX:e.pageX,lastPageY:e.pageY,lastTimeStamp:e.timeStamp};H.push(t),A(t),U.push(e.pointerId);var n=m("pointerdown",e,{downPageX:e.pageX,downPageY:e.pageY,button:P[e.buttons],pressure:e.pressure});E(n)}},S=function(e){if(e=v(e),U.includes(e.pointerId)){var t=d(e.pointerId);if(T(t),e.buttons===t.buttons){if(A(t),"pen"!==e.pointerType||e.pageX!==t.lastPageX||e.pageY!==t.lastPageY||e.timeStamp!==t.lastTimeStamp){var n=m("pointermove",e,{downPageX:t.downPageX,downPageY:t.downPageY,button:P[e.buttons],pressure:e.pressure});t.lastPageX=e.pageX,t.lastPageY=e.pageY,t.lastTimeStamp=e.timeStamp,E(n)}}else{1===H.length&&x(),g(e.pointerId);var r=m("pointerup",e,{downPageX:t.downPageX,downPageY:t.downPageY});E(r)}}},k=function(e){if(e=v(e),U.includes(e.pointerId)){1===H.length&&x();var t=g(e.pointerId);T(t);var n=m("pointerup",e,{downPageX:t.downPageX,downPageY:t.downPageY});E(n)}},L=function(e){if(e=v(e),U.includes(e.pointerId)){1===H.length&&x();var t=g(e.pointerId);T(t);var n=m("pointerup",e,{downPageX:t.downPageX,downPageY:t.downPageY});E(n)}},A=function(e){"touch"===e.pointerType&&(e.touchTimeout=setTimeout((function(){!function(e){var t={pointerId:e.pointerId,pointerType:e.pointerType,type:"pointerup",timeStamp:performance.now(),pageX:0,pageY:0,clientX:0,clientY:0,preventDefault:function(){},stopPropagation:function(){}};k(t)}(e)}),2500))},T=function(e){e.touchTimeout&&(clearTimeout(e.touchTimeout),e.touchTimeout=null)},I=e.target,E=e.onPointer,M=e.onWheel,R=e.onEnterLeave,O="maxPointers"in e?e.maxPointers:1,P={1:"left",2:"right",4:"middle"},D=new p((function(e){if(!G&&M){var t=I.getBoundingClientRect();e.relX=e.clientX-t.left+I.scrollLeft,e.relY=e.clientY-t.top+I.scrollTop,M(e)}})),G=!1,N=u.eventUsesHighResTimeStamp()?0:-performance.timing.navigationStart,j="",z=!1,H=[],U=[],X=0;R&&(c.addEventListener(I,"pointerenter",b),c.addEventListener(I,"pointerleave",w)),E&&(c.addEventListener(I,"pointermove",B),c.addEventListener(I,"pointerdown",C)),M&&c.addEventListener(I,"wheel",D.process),u.hasPointerEvents?e.fixScribble&&(n=function(e){e.preventDefault()},c.addEventListener(I,"touchmove",n)):(t=function(e){e.preventDefault();for(var t=e.changedTouches,i=0;i<t.length&&H.length<O;i++){var a=t[i];0===H.length&&(c.addEventListener(document,"touchmove",n),c.addEventListener(document,"touchend",r),c.addEventListener(document,"touchcancel",r)),H.push({pointerId:a.identifier,downPageX:a.pageX,downPageY:a.pageY,buttons:1,lastPageX:a.pageX,lastPageY:a.pageY}),U.push(a.identifier);var o=y("pointerdown",a,e,{dX:0,dY:0,downPageX:a.downPageX,downPageY:a.downPageY,button:"left",pressure:1});E(o)}},n=function(e){e.preventDefault();for(var t=e.changedTouches,n=0;n<t.length;n++){var r=t[n];if(U.includes(r.identifier)){var i=d(r.identifier),a=y("pointermove",r,e,{dX:r.pageX-i.lastPageX,dY:r.pageY-i.lastPageY,downPageX:i.downPageX,downPageY:i.downPageY,button:"left",isCoalesced:!1,pressure:1});i.lastPageX=r.pageX,i.lastPageY=r.pageY,E(a)}}},r=function(e){"touchcancel"!==e.type&&e.preventDefault();for(var t=e.changedTouches,i=0;i<t.length;i++){var a=t[i];if(U.includes(a.identifier)){1===H.length&&(c.removeEventListener(document,"touchmove",n),c.removeEventListener(document,"touchend",r),c.removeEventListener(document,"touchcancel",r));var o=g(a.identifier),s=y("pointerup",a,e,{dX:a.pageX-o.lastPageX,dY:a.pageY-o.lastPageY,downPageX:o.downPageX,downPageY:o.downPageY});E(s)}}},E&&c.addEventListener(I,"touchstart",t)),this.isOver=function(){return X>0},this.destroy=function(){G||(G=!0,c.removeEventListener(I,"pointerenter",b),c.removeEventListener(I,"pointerleave",w),c.removeEventListener(I,"pointermove",B),c.removeEventListener(I,"pointerdown",C),c.removeEventListener(I,"wheel",D.process),H.length>0&&x(),u.hasPointerEvents?c.removeEventListener(I,"touchmove",n):(c.removeEventListener(I,"touchstart",t),H.length>0&&(c.removeEventListener(document,"touchmove",n),c.removeEventListener(document,"touchend",r),c.removeEventListener(document,"touchcancel",r))))}})})),r.register("eg83P",(function(e,n){function r(e,t,n){return e*(1-n)+t*n}function i(e,t,n,r){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-r,2))}function a(e,t,n,r){return Math.pow(e-n,2)+Math.pow(t-r,2)}function o(e,t){return e*e+t*t}function s(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function l(e,t){return 180*s(e,t)/Math.PI}function c(e,t,n){return e<=t?t:e>=n?n:e}function u(e,t,n){var r=n*(Math.PI/180),i=Math.cos(r),a=Math.sin(r);return{x:e*i-t*a,y:e*a+t*i}}function h(e,t,n){var r=u(t.x-e.x,t.y-e.y,n);return r.x+=e.x,r.y+=e.y,r}function p(e,t,n){e.x+=t,e.y+=n;var r=Math.round(e.x),i=Math.round(e.y);return e.x-=r,e.y-=i,{dX:r,dY:i}}function d(e){if(e%1==0)return e%2==0?e:e+1;var t=Math.ceil(e),n=Math.floor(e);return t%2==0?t:n}function g(e){if(e%1==0)return e%2==0?e+1:e;var t=Math.ceil(e),n=Math.floor(e);return t%2==1?t:n}function f(e,t){return t?(e?(e.x1=Math.min(e.x1,t.x1),e.y1=Math.min(e.y1,t.y1),e.x2=Math.max(e.x2,t.x2),e.y2=Math.max(e.y2,t.y2)):e={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2},e):e}function v(e,t,n){var r=Math.max(0,e.x1),i=Math.max(0,e.y1),a=Math.min(t-1,e.x2),o=Math.min(n-1,e.y2);return r>a||i>o?null:{x1:r,y1:i,x2:a,y2:o}}t(e.exports,"mix",(function(){return r})),t(e.exports,"dist",(function(){return i})),t(e.exports,"distSquared",(function(){return a})),t(e.exports,"lenSquared",(function(){return o})),t(e.exports,"pointsToAngleRad",(function(){return s})),t(e.exports,"pointsToAngleDeg",(function(){return l})),t(e.exports,"clamp",(function(){return c})),t(e.exports,"rotate",(function(){return u})),t(e.exports,"rotateAround",(function(){return h})),t(e.exports,"intDxy",(function(){return p})),t(e.exports,"roundEven",(function(){return d})),t(e.exports,"roundUneven",(function(){return g})),t(e.exports,"updateBounds",(function(){return f})),t(e.exports,"boundsInArea",(function(){return v}))})),r.register("exufe",(function(e,n){t(e.exports,"EventChain",(function(){return a})),t(e.exports,"DoubleTapper",(function(){return o})),t(e.exports,"NFingerTapper",(function(){return s})),t(e.exports,"PinchZoomer",(function(){return l})),t(e.exports,"CoalescedExploder",(function(){return c})),t(e.exports,"OnePointerLimiter",(function(){return u})),t(e.exports,"LinetoolProcessor",(function(){return h})),t(e.exports,"LineSanitizer",(function(){return p})),t(e.exports,"LineSmoothing",(function(){return d}));var i=r("eg83P"),a=function(e){for(var t=function(e,t){for(;e<n.length;e++)if(null===(t=n[e].chainIn(t)))return null;return r(t),null},n=e.chainArr,r=function(){},i=0;i<n.length;i++)!function(e){n[e].setChainOut((function(n){t(e+1,n)}))}(i);this.chainIn=function(e){return t(0,e)},this.setChainOut=function(e){r=e}},o=function(e){var t=function(){if(0!==f.length){clearTimeout(b.fail),clearTimeout(b.maxUntilSecondDown),clearTimeout(b.success),b.fail=null,b.maxUntilSecondDown=null,b.success=null;for(var e=0;e<x.length;e++)a(x[e]);x=[],f=[]}},n=function(){b.fail=null,b.success=null,x=[];var t=f[f.length-1];f=[],e.onDoubleTap({pageX:t.pageX,pageY:t.pageY})},r=function(e,t,n){var r=n-y;return!(r<=0)&&(b[e]=setTimeout(t,r),!0)},a=function(){},o=400,s=300,l=10,c=19,u=500,h=300,p=250,d=["touch","mouse","pen"],g=["left"],f=[],v=[],m=0,y=0,x=[],b={fail:null,maxUntilSecondDown:null,success:null};this.chainIn=function(e){return function(e){if("pointerdown"===e.type)v.push(e.pointerId);else if("pointerup"===e.type)for(var a=0;a<v.length;a++)if(v[a]===e.pointerId){v.splice(a,1);break}if(d.includes(e.pointerType)){y=performance.now();var x=f.length>0?f[f.length-1]:null;if("pointerup"===e.type&&(m=e.time),"pointerdown"===e.type){if(v.length>1)return void t();if(null!==b.success)return void t();if(0===f.length&&y-m<o)return void t();if(!g.includes(e.button))return void t();if(x&&x.isDown||f.length>2)return void t();if(x&&i.dist(x.position[0],x.position[1],e.pageX,e.pageY)>c&&(t(),y-x.time<o))return;if(f.push({isDown:!0,time:y,position:[e.pageX,e.pageY],pointerId:e.pointerId}),f.length>1)clearTimeout(b.maxUntilSecondDown);else if(!r("maxUntilSecondDown",t,e.time+h))return void t();if(clearTimeout(b.fail),!r("fail",t,e.time+s))return void t()}if(x&&"pointermove"===e.type&&x.pointerId===e.pointerId&&i.dist(x.position[0],x.position[1],e.pageX,e.pageY)>l)return void t();if(x&&"pointerup"===e.type){if(x.pointerId!==e.pointerId)return void t();if(y>=x.time+s)return void t();if(clearTimeout(b.fail),f.length<3)return r("fail",t,e.time+u)?void(f=[x,{isUp:!0,time:y,position:[e.pageX,e.pageY]}]):void t();y<f[1].time+u?(f.push({pageX:e.pageX,pageY:e.pageY}),r("success",n,e.time+p)||t()):t()}}else t()}(e),0===f.length?(t(),e):(x.push(e),null)},this.setChainOut=function(e){a=e},this.setAllowedPointerTypeArr=function(e){d=e},this.setAllowedButtonArr=function(e){g=e}},s=function(e){var t,n,r=function(){if(0!==g.length){clearTimeout(m.firstLastDownTimeout),clearTimeout(m.tapTimeout);for(var e=0;e<g.length;e++)l(g[e]);g=[],d=[]}},a=function(e,t){var i=t-n;return!(i<=0)&&(m[e]=setTimeout(r,i),!0)},o=function(o){var l=f;if(f=o.time,"pointerdown"===o.type)v.push(o.pointerId);else if("pointerup"===o.type)for(var y=0;y<v.length;y++)if(v[y]===o.pointerId){v.splice(y,1);break}if("touch"===o.pointerType){if(n=performance.now(),"pointerdown"===o.type)return d.length+1!==v.length||d.length===s||d.length>0&&o.time-h>d[0].downTime||0===d.length&&o.time-c<l?void r():0!==d.length||(t=o.time,a("firstLastDownTimeout",o.time+h)&&a("tapTimeout",o.time+u))?void d.push({pointerId:o.pointerId,downTime:o.time,downPageX:o.pageX,downPageY:o.pageY}):void r();if("pointermove"===o.type){if(0===d.length)return;for(var x=null,b=0;b<d.length;b++)if(d[b].pointerId===o.pointerId){x=d[b];break}if(null===x)return void r();if(o.time-u>t)return void r();if(i.dist(o.pageX,o.pageY,x.downPageX,x.downPageY)>p)return void r()}if("pointerup"===o.type){if(0===d.length)return;if(d.length!==s)return void r();for(var w=null,B=0;B<d.length;B++)if(d[B].pointerId===o.pointerId){w=d[B];break}if(null===w)return;if(o.time-u>t)return void r();if(i.dist(o.pageX,o.pageY,w.downPageX,w.downPageY)>p)return void r();w.isUp=!0;for(var C=!0,S=0;S<d.length;S++)if(!d[S].isUp){C=!1;break}if(C)return clearTimeout(m.firstLastDownTimeout),clearTimeout(m.tapTimeout),g=[],d=[],e.onTap(),!0}}else d.length>0&&r()},s=e.fingers,l=function(){},c=50,u=500,h=250,p=12,d=[],g=[],f=0,v=[],m={firstLastDownTimeout:null,tapTimeout:null};this.chainIn=function(e){return!0===o(e)?null:0===d.length?e:(g.push(e),null)},this.setChainOut=function(e){l=e}},l=function(e){var t,n=function(){d=null,g=[]},r=function(e){if(d){if(clearTimeout(f.secondFingerTimeout),!e)for(var t=0;t<g.length;t++)h(g[t]);n()}},a=function(e){if("pointerdown"===e.type)p.push(e.pointerId);else if("pointerup"===e.type)for(var a=0;a<p.length;a++)if(p[a]===e.pointerId){p.splice(a,1);break}if(d||!("touch"!==e.pointerType||"pointermove"===e.type&&p.length>0||p.length>1||"pointerup"===e.type)){if(t=performance.now(),"pointerdown"===e.type)return d?"touch"===e.pointerType?(d.touchPointerArr.push({pointerId:e.pointerId,relX:e.relX,relY:e.relY}),void(d.isInProgress?s(d,{type:"down",index:d.touchPointerArr.length-1}):(clearTimeout(f.secondFingerTimeout),d.isInProgress=!0,o(d)))):void(d.isInProgress?d.otherPointerIdArr.push(e.pointerId):r()):(d={touchPointerArr:[{pointerId:e.pointerId,relX:e.relX,relY:e.relY,downRelX:e.relX,downRelY:e.relY}],otherPointerIdArr:[],isInProgress:!1},h="secondFingerTimeout",g=function(){r()},v=e.time+u,(m=v-t)<=0||(f[h]=setTimeout(g,m),0)?void r():void 0);var h,g,v,m;if("pointermove"!==e.type||"touch"!==e.pointerType){if("pointerup"===e.type){if("touch"===e.pointerType){for(var y=0;y<d.touchPointerArr.length;y++)if(d.touchPointerArr[y].pointerId===e.pointerId){d.touchPointerArr.splice(y,1);break}d.touchPointerArr.length>0&&s(d,{type:"up",index:y})}else for(var x=0;x<d.otherPointerIdArr.length;x++)if(d.otherPointerIdArr[x]===e.pointerId){d.otherPointerIdArr.splice(x,1);break}if(0===d.touchPointerArr.length&&0===d.otherPointerIdArr.length)return void(d.isInProgress?(n(),l()):r())}}else{for(var b=null,w=0;w<d.touchPointerArr.length;w++)if(e.pointerId===d.touchPointerArr[w].pointerId){b=d.touchPointerArr[w];break}if(b.relX=e.relX,b.relY=e.relY,d.isInProgress)w<2&&s(d,{type:"move",index:w});else if(i.dist(b.downRelX,b.downRelY,b.relX,b.relY)>c)return void r()}}},o=function(t){for(var n=0;n<t.touchPointerArr.length;n++){var r=t.touchPointerArr[n];v.push({pointerId:r.pointerId,relX:r.relX,relY:r.relY,downRelX:r.relX,downRelY:r.relY})}var i={type:"move",angleRad:0,scale:1};1===v.length?(i.relX=v[0].downRelX,i.relY=v[0].downRelY):(i.relX=.5*(v[0].downRelX+v[1].downRelX),i.relY=.5*(v[0].downRelY+v[1].downRelY)),i.downRelX=i.relX,i.downRelY=i.relY,e.onPinch(i)},s=function(t,n){if(!(n.index>1))if("move"===n.type){var r;if(v[n.index].relX=t.touchPointerArr[n.index].relX,v[n.index].relY=t.touchPointerArr[n.index].relY,1===v.length)r={type:"move",downRelX:v[0].downRelX,downRelY:v[0].downRelY,relX:v[0].relX,relY:v[0].relY,angleRad:0,scale:1};else{var a=i.dist(v[0].downRelX,v[0].downRelY,v[1].downRelX,v[1].downRelY),s=i.dist(v[0].relX,v[0].relY,v[1].relX,v[1].relY),c=i.pointsToAngleRad({x:v[0].downRelX,y:v[0].downRelY},{x:v[1].downRelX,y:v[1].downRelY}),u=i.pointsToAngleRad({x:v[0].relX,y:v[0].relY},{x:v[1].relX,y:v[1].relY});r={type:"move",downRelX:.5*(v[0].downRelX+v[1].downRelX),downRelY:.5*(v[0].downRelY+v[1].downRelY),relX:.5*(v[0].relX+v[1].relX),relY:.5*(v[0].relY+v[1].relY),angleRad:u-c,scale:s/a}}e.onPinch(r)}else"down"!==n.type&&"up"!==n.type||(l(),o(t))},l=function(){v=[],e.onPinch({type:"end"})},c=10,u=250,h=function(){},p=[],d=null,g=[],f={secondFingerTimeout:null},v=[];this.chainIn=function(e){return a(e),d?(d.isInProgress||g.push(e),null):e},this.setChainOut=function(e){h=e}},c=function(){var e=function(){};this.chainIn=function(t){if("pointermove"!==t.type)return t;if(!(t.coalescedArr.length>0))return t;var n,r=JSON.parse(JSON.stringify(t));r.coalescedArr=[];for(var i=0;i<t.coalescedArr.length;i++)i>0&&(r=JSON.parse(JSON.stringify(t))),n=t.coalescedArr[i],r.pageX=n.pageX,r.pageY=n.pageY,r.relX=n.relX,r.relY=n.relY,r.dX=n.dX,r.dY=n.dY,r.time=n.time,i<t.coalescedArr.length-1&&(r.isCoalesced=!0),e(r);return null},this.setChainOut=function(t){e=t}},u=function(e){var t=null,n=[];this.chainIn=function(e){if(n.includes(e.pointerId)){if("pointerup"===e.type)for(var r=0;r<n.length;r++)if(n[r]===e.pointerId){n.splice(r,1);break}return null}return null===t?("pointerdown"===e.type&&(t=e.pointerId),e):e.pointerId!==t?("pointerdown"===e.type&&n.push(e.pointerId),null):("pointerup"===e.type&&(t=null),e)},this.setChainOut=function(e){e}},h=function(e){var t=null,n=[],r=null;this.process=function(i){if("down"===i.type&&(t=i,r=null,i.shiftIsPressed))return e.onDraw({type:"line",x0:null,y0:null,pressure0:null,x1:i.x,y1:i.y,pressure1:i.pressure}),void n.push(i);if("move"===i.type)if(i.shiftIsPressed){if(null===r){var a=Math.abs(i.x-t.x),o=Math.abs(i.y-t.y);if(a>5||o>5){r=a>o?0:1;for(var s=0;s<n.length;s++){var l=n[s];0===r?l.y=t.y:l.x=t.x,e.onDraw(JSON.parse(JSON.stringify(l)))}n=[]}}if(null===r)return void n.push(i);0===r?i.y=t.y:i.x=t.x}else if(n.length>0){for(var c=0;c<n.length;c++)e.onDraw(JSON.parse(JSON.stringify(n[c])));n=[]}"up"===i.type&&(n=[]),e.onDraw(JSON.parse(JSON.stringify(i)))}},p=function(){var e=function(){},t=!1;this.chainIn=function(n){return"down"===n.type&&(t?e({type:"up",scale:n.scale,shiftIsPressed:n.shiftIsPressed,isCoalesced:!1}):t=!0),t||"move"!==n.type&&"up"!==n.type?("up"===n.type&&t&&(t=!1),n):null},this.setChainOut=function(t){e=t},this.getIsDrawing=function(){return t}},d=function(e){var t,n,r,a=function(){},o=i.clamp(e.smoothing,0,1);this.chainIn=function(e){if(e=JSON.parse(JSON.stringify(e)),clearTimeout(r),clearInterval(n),"down"===e.type&&(t={x:e.x,y:e.y,pressure:e.pressure}),"move"===e.type){var s=e.x,l=e.y,c=e.pressure;e.x=i.mix(e.x,t.x,o),e.y=i.mix(e.y,t.y,o),e.pressure=i.mix(e.pressure,t.pressure,o),t={x:e.x,y:e.y,pressure:e.pressure},o>0&&(r=setTimeout((function(){n=setInterval((function(){(e=JSON.parse(JSON.stringify(e))).x=i.mix(s,t.x,o),e.y=i.mix(l,t.y,o),e.pressure=i.mix(c,t.pressure,o),t={x:e.x,y:e.y,pressure:e.pressure},a(e)}),35)}),80))}return e},this.setChainOut=function(e){a=e},this.setSmoothing=function(e){o=i.clamp(e,0,1)}}})),r.register("eIcQa",(function(e,n){t(e.exports,"copyCanvas",(function(){return a})),t(e.exports,"testShouldPixelate",(function(){return o})),t(e.exports,"drawTransformedImageWithBounds",(function(){return s})),t(e.exports,"drawTransformedImageOnCanvas",(function(){return l})),t(e.exports,"createCheckerCanvas",(function(){return u})),t(e.exports,"createCheckerDataUrl",(function(){return h})),t(e.exports,"resizeCanvas",(function(){return p})),t(e.exports,"convertToAlphaChannelCanvas",(function(){return d})),t(e.exports,"freeCanvas",(function(){return g}));var i=r("eelgW");function a(e){var t=i.createCanvas(e.width,e.height),n=t.getContext("2d");if(!n)throw new Error("2d context not supported or canvas already initialized");return n.drawImage(e,0,0),t}function o(e,t,n){if(![1,-1].includes(t)||![1,-1].includes(n)||e.width%1!=0||e.height%1!=0||Math.abs(e.angleDeg)%90!=0)return!1;var r=Math.abs(e.angleDeg-90)%180==0,i=r?e.height:e.width,a=r?e.width:e.height;return(Math.abs(i)%2==0&&e.x%1==0||Math.abs(i)%2==1&&e.x%1==.5)&&(Math.abs(a)%2==0&&e.y%1==0||Math.abs(a)%2==1&&e.y%1==.5)}function s(e,t,n,r,i){r||(r={x:0,y:0,width:t.width,height:t.height}),e.save(),i?e.imageSmoothingEnabled=!1:(e.imageSmoothingEnabled=!0,e.imageSmoothingQuality="high"),e.translate(n.x,n.y),e.rotate(n.angleDeg/180*Math.PI),e.scale(n.width>0?1:-1,n.height>0?1:-1),e.drawImage(t,r.x,r.y,r.width,r.height,-Math.abs(n.width)/2,-Math.abs(n.height)/2,Math.abs(n.width),Math.abs(n.height)),e.restore()}function l(e,t,n){(n=JSON.parse(JSON.stringify(n))).center||(n.center={x:t.width/2,y:t.height/2}),n.scale||(n.scale={x:1,y:1}),n.angleDegree||(n.angleDegree=0),n.translate||(n.translate={x:0,y:0});var r=e.getContext("2d");if(!r)throw new Error("2d context not supported or canvas already initialized");r.save(),Math.abs(n.scale.x-1)>1e-6||Math.abs(n.scale.y-1)>1e-6||Math.abs(n.angleDegree%90)>1e-6?(r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high"):r.imageSmoothingEnabled=!1,r.translate(n.translate.x,n.translate.y),r.translate(n.center.x,n.center.y),r.rotate(n.angleDegree/180*Math.PI),r.scale(n.scale.x,n.scale.y),r.translate(-n.center.x,-n.center.y),r.drawImage(t,0,0,t.width,t.height),r.restore()}var c,u=function(e){var t,n=i.createCanvas();if(e<1){if(n.width=1,n.height=1,!(t=n.getContext("2d")))throw new Error("2d context not supported or canvas already initialized");t.fillStyle="rgb(128, 128, 128)",t.fillRect(0,0,1,1)}else if(e>200)n.width=401,n.height=401;else{if(n.width=2*e,n.height=2*e,!(t=n.getContext("2d")))throw new Error("2d context not supported or canvas already initialized");t.fillStyle="rgb(255, 255, 255)",t.fillRect(0,0,2*e,2*e),t.fillStyle="rgb(200, 200, 200)",t.fillRect(0,0,e,e),t.fillRect(e,e,2*e,2*e)}return n},h=(c={8:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMElEQVQ4T2M8ceLEfwY8wNzcHJ80A+OoAcMiDP7//483HZw8eRJ/Ohg1gIFx6IcBAIhJUqnarXQ1AAAAAElFTkSuQmCC",4:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAJ0lEQVQoU2M8ceLEfwYkYG5ujsxlYKSDgv///6O44eTJk6huoL0CAGsOKVVu8UYvAAAAAElFTkSuQmCC"},function(e,t){var n=function(e){if(e=parseInt(""+e),c[""+e])return c[""+e];var t=u(e).toDataURL("image/png");return c[""+e]=t,t};if(!t)return n(e);setTimeout((function(){t(n(e))}),1)});function p(e,t,n,r,a){var o,s,l,c,u;if(t&&n&&(t!==e.width||n!==e.height))if(t=Math.max(t,1),n=Math.max(n,1),t<=e.width&&n<=e.height){r=r||i.createCanvas(),a=a||i.createCanvas();var h,d,g=(o=e.width,s=e.height,l=t,c=n,(u={oldWidthEx:Math.round(Math.log2(o)),oldHeightEx:Math.round(Math.log2(s)),newWidthEx:Math.ceil(Math.log2(l)),newHeightEx:Math.ceil(Math.log2(c))}).oldWidthEx=Math.max(u.oldWidthEx,u.newWidthEx),u.oldHeightEx=Math.max(u.oldHeightEx,u.newHeightEx),u);a.width=g.oldWidthEx>g.newWidthEx?Math.pow(2,g.oldWidthEx):t,a.height=g.oldHeightEx>g.newHeightEx?Math.pow(2,g.oldHeightEx):n,r.getContext("2d").save(),a.getContext("2d").save();var f=r,v=a;h=g.oldWidthEx,d=g.oldHeightEx;var m=v.getContext("2d");m.imageSmoothingEnabled=!0,m.imageSmoothingQuality="high",m.globalCompositeOperation="copy",m.drawImage(e,0,0,v.width,v.height);for(var y=v.width,x=v.height;h>g.newWidthEx||d>g.newHeightEx;h--,d--){(m=f.getContext("2d")).imageSmoothingEnabled=!0,m.imageSmoothingQuality="high",m.globalCompositeOperation="copy";var b=h>g.newWidthEx?y/2:y,w=d>g.newHeightEx?x/2:x;f.width=b,f.height=w,m.drawImage(v,0,0,y,x,0,0,b,w),y=b,x=w;var B=f;f=v,v=B}e.width=t,e.height=n;var C=e.getContext("2d");C.save(),C.imageSmoothingEnabled=!0,C.imageSmoothingQuality="high",C.drawImage(v,0,0,y,x,0,0,t,n),C.restore(),r.getContext("2d").restore(),a.getContext("2d").restore()}else if(t>=e.width&&n>=e.height){(r=r||i.createCanvas()).width=t,r.height=n;var S=r.getContext("2d");S.save(),S.imageSmoothingEnabled=!0,S.imageSmoothingQuality="high",S.drawImage(e,0,0,t,n),S.restore(),e.width=t,e.height=n,e.getContext("2d").drawImage(r,0,0)}else p(e,t,e.height,r,a),p(e,t,n,r,a)}function d(e){for(var t=e.getContext("2d").getImageData(0,0,e.width,e.height),n=0;n<t.data.length;n+=4)0!==t.data[n+3]&&(t.data[n+3]=(t.data[n]+t.data[n+1]+t.data[n+2])/3*(t.data[n+3]/255));e.getContext("2d").putImageData(t,0,0)}function g(e){e.width=1,e.height=1;var t=e.getContext("2d");t&&t.clearRect(0,0,1,1)}})),r.register("kVHNC",(function(e,n){t(e.exports,"Matrix",(function(){return i}));var r,i={getIdentity:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},multiplyMatrixAndPoint:r=function(e,t){return[t[0]*e[0]+t[1]*e[4]+t[2]*e[8]+t[3]*e[12],t[0]*e[1]+t[1]*e[5]+t[2]*e[9]+t[3]*e[13],t[0]*e[2]+t[1]*e[6]+t[2]*e[10]+t[3]*e[14],t[0]*e[3]+t[1]*e[7]+t[2]*e[11]+t[3]*e[15]]},multiplyMatrices:function(e,t){var n=[t[0],t[1],t[2],t[3]],i=[t[4],t[5],t[6],t[7]],a=[t[8],t[9],t[10],t[11]],o=[t[12],t[13],t[14],t[15]],s=r(e,n),l=r(e,i),c=r(e,a),u=r(e,o);return[s[0],s[1],s[2],s[3],l[0],l[1],l[2],l[3],c[0],c[1],c[2],c[3],u[0],u[1],u[2],u[3]]},createTranslationMatrix:function(e,t){return[1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1]},createRotationMatrix:function(e){return[Math.cos(-e),-Math.sin(-e),0,0,Math.sin(-e),Math.cos(-e),0,0,0,0,1,0,0,0,0,1]},createScaleMatrix:function(e){return[e,0,0,0,0,e,0,0,0,0,1,0,0,0,0,1]}}})),r.register("4toIY",(function(e,n){t(e.exports,"Vec2",(function(){return r}));var r={add:function(e,t){return{x:e.x+t.x,y:e.y+t.y}},sub:function(e,t){return{x:e.x-t.x,y:e.y-t.y}},nor:function(e){var t=Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2));return{x:e.x/t,y:e.y/t}},len:function(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))},dist:function(e,t){return r.len(r.sub(e,t))},mul:function(e,t){return{x:e.x*t,y:e.y*t}},angle:function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},dot:function(e,t){var n=[e.x,e.y],r=[t.x,t.y];return n.map((function(e,t){return n[t]*r[t]})).reduce((function(e,t){return e+t}))}}})),r.register("af1iA",(function(e,n){t(e.exports,"projectPointOnLine",(function(){return o})),t(e.exports,"PointLine",(function(){return s})),t(e.exports,"BezierLine",(function(){return l})),t(e.exports,"SplineInterpolator",(function(){return c})),t(e.exports,"quadraticSplineInput",(function(){return u}));var i=r("4toIY"),a=r("eg83P"),o=function(e,t,n){if(e.x===t.x)return{x:e.x,y:n.y};var r=(t.y-e.y)/(t.x-e.x),i=e.y-r*e.x;return{x:(r*n.y+n.x-r*i)/(r*r+1),y:(r*r*n.y+r*n.x+i)/(r*r+1)}},s=function(e){for(var t,n,r=[],i=this,o=0;o<e.points.length;o++)n=void 0,n=void 0,(t=o)<e.points.length-1&&(n=a.dist(e.points[t].x,e.points[t].y,e.points[t+1].x,e.points[t+1].y)),r[t]={x:e.points[t].x,y:e.points[t].y,length:n};this.getAtDist=function(e){for(var t=Math.min(i.getLength(),e),n=0;t>r[n].length&&n<r.length-2;n++)t-=r[n].length;var a=Math.min(1,Math.max(0,t/r[n].length));return{x:r[n].x*(1-a)+r[n+1].x*a,y:r[n].y*(1-a)+r[n+1].y*a}},this.getLength=function(){for(var e=0,t=0;t<r.length-1;t++)e+=r[t].length;return e}},l=function(){var e,t,n,r=this,o=[],l=0,c=null;this.add=function(r,u,h,p,d){if(!e||r!==e.x||u!==e.y)if(e={x:r,y:u},o[o.length]={x:r,y:u,spacing:h},1!==o.length){if(2===o.length)return o[0].dir=i.Vec2.nor(i.Vec2.sub(o[1],o[0])),l=h,void(c=h);var g=o[o.length-1],f=o[o.length-2],v=o[o.length-3];f.dir=i.Vec2.nor(i.Vec2.sub(g,v)),(isNaN(f.dir.x)||isNaN(f.dir.y))&&(f.dir=JSON.parse(JSON.stringify(v.dir)));var m,y,x=o[o.length-3],b=o[o.length-2],w=x,B=i.Vec2.add(x,i.Vec2.mul(x.dir,i.Vec2.dist(x,b)/4)),C=i.Vec2.sub(b,i.Vec2.mul(b.dir,i.Vec2.dist(x,b)/4)),S=b;if(p)y=function(e,t,n,r,i){for(var a,o,s=[],l=0;l<=i;l++)a=l/i,(o={}).x=Math.pow(1-a,3)*e.x+3*Math.pow(1-a,2)*a*t.x+3*(1-a)*Math.pow(a,2)*n.x+Math.pow(a,3)*r.x,o.y=Math.pow(1-a,3)*e.y+3*Math.pow(1-a,2)*a*t.y+3*(1-a)*Math.pow(a,2)*n.y+Math.pow(a,3)*r.y,s[s.length]=o;return s}(w,B,C,S,20),m=new s({points:y});else m=new s({points:[w,S]});for(var k=m.getLength(),L=a.mix(c,h,a.clamp(l/k,0,1)),A=l;A<=k;A+=L){L=a.mix(c,h,a.clamp(A/k,0,1));var T=m.getAtDist(A),I=t?a.pointsToAngleDeg(t,T):void 0;p&&p({x:T.x,y:T.y,t:A/k,angle:I,dAngle:t?I-n:0}),t=T,n=I}p?l=A-k:(l=0,d({p1:w,p2:B,p3:C,p4:S})),c=h}else c=h},this.addFinal=function(e,t,n){if(!(o.length<2)){var a=o[o.length-2],s=o[o.length-1],l=i.Vec2.add(s,i.Vec2.sub(s,a));r.add(l.x,l.y,e,t,n)}}},c=function(e){var t,n=e.length;this.xa=[],this.ya=[],this.u=[],this.y2=[];var r=e[0][0],i=e[e.length-1][0];for(e.sort((function(e,t){return e[0]-t[0]})),t=0;t<n;t++)this.xa.push(e[t][0]),this.ya.push(e[t][1]);for(this.u[0]=0,this.y2[0]=0,t=1;t<n-1;++t){var a=this.xa[t+1]-this.xa[t-1],o=(this.xa[t]-this.xa[t-1])/a,s=o*this.y2[t-1]+2;this.y2[t]=(o-1)/s;var l=(this.ya[t+1]-this.ya[t])/(this.xa[t+1]-this.xa[t])-(this.ya[t]-this.ya[t-1])/(this.xa[t]-this.xa[t-1]);this.u[t]=(6*l/a-o*this.u[t-1])/s}for(this.y2[n-1]=0,t=n-2;t>=0;--t)this.y2[t]=this.y2[t]*this.y2[t+1]+this.u[t];this.getFirstX=function(){return r},this.getLastX=function(){return i}};c.prototype.interpolate=function(e){for(var t=0,n=this.ya.length-1;n-t>1;){var r=n+t>>1;this.xa[r]>e?n=r:t=r}var i=this.xa[n]-this.xa[t],a=(this.xa[n]-e)/i,o=(e-this.xa[t])/i;return a*this.ya[t]+o*this.ya[n]+((a*a*a-a)*this.y2[t]+(o*o*o-o)*this.y2[n])*(i*i)/6},c.prototype.findX=function(e,t){for(var n=null,r=null,i=0;i<=t;i++){var a=i/t,o=this.interpolate(a);if(null!==n){var s=Math.abs(o-e);if(!(s<r))break;n=a,r=s}else n=a,r=Math.abs(o-e)}return n};var u=function(e,t,n){for(var r=function(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)},i=[],a=0;a<=1;a+=n)i.push([r(a,4),r(e+Math.pow(a,2)*(t-e),4)]);return i}})),r.register("dJ1E2",(function(e,n){t(e.exports,"HSV",(function(){return a})),t(e.exports,"RGB",(function(){return o})),t(e.exports,"CMYK",(function(){return s})),t(e.exports,"ColorConverter",(function(){return l})),t(e.exports,"testIsWhiteBestContrast",(function(){return c}));var i=r("4gaLD"),a=function e(t,n,r){"use strict";i.classCallCheck(this,e),this.h=Math.max(0,Math.min(360,t)),this.s=Math.max(.001,Math.min(100,n)),this.v=Math.max(0,Math.min(100,r))},o=function e(t,n,r){"use strict";i.classCallCheck(this,e),this.r=Math.max(0,Math.min(255,t)),this.g=Math.max(0,Math.min(255,n)),this.b=Math.max(0,Math.min(255,r))},s=function e(t,n,r,a){"use strict";i.classCallCheck(this,e),this.c=Math.max(0,Math.min(100,t)),this.m=Math.max(0,Math.min(100,n)),this.y=Math.max(0,Math.min(100,r)),this.k=Math.max(0,Math.min(100,a))},l={_RGBtoHSV:function(e){var t=new a(0,0,0),n=e.r/255,r=e.g/255,i=e.b/255,o=Math.min(n,r,i),s=Math.max(n,r,i),l=s-o;if(t.v=s,0==l)t.h=0,t.s=0;else{t.s=l/s;var c=((s-n)/6+l/2)/l,u=((s-r)/6+l/2)/l,h=((s-i)/6+l/2)/l;n==s?t.h=h-u:r==s?t.h=1/3+c-h:i==s&&(t.h=2/3+u-c),t.h<0&&(t.h+=1),t.h>1&&(t.h-=1)}return t.h=Math.round(360*t.h),t.s=Math.round(100*t.s),t.v=Math.round(100*t.v),t},_HSVtoRGB:function(e){var t,n,r,i,a,s,l,c,u=new o(0,0,0),h=e.h/360%1,p=e.s/100,d=e.v/100;return 0==p?(u.r=255*d,u.g=255*d,u.b=255*d):(r=d*(1-p),i=d*(1-p*((t=6*h)-(n=Math.floor(t)))),a=d*(1-p*(1-(t-n))),0==n?(s=d,l=a,c=r):1==n?(s=i,l=d,c=r):2==n?(s=r,l=d,c=a):3==n?(s=r,l=i,c=d):4==n?(s=a,l=r,c=d):(s=d,l=r,c=i),u.r=255*s,u.g=255*l,u.b=255*c,u.r=Math.round(u.r),u.g=Math.round(u.g),u.b=Math.round(u.b)),u},_CMYKtoRGB:function(e){var t=new o(0,0,0),n=e.c/100,r=e.m/100,i=e.y/100,a=e.k/100;return t.r=1-Math.min(1,n*(1-a)+a),t.g=1-Math.min(1,r*(1-a)+a),t.b=1-Math.min(1,i*(1-a)+a),t.r=Math.round(255*t.r),t.g=Math.round(255*t.g),t.b=Math.round(255*t.b),t},_RGBtoCMYK:function(e){var t=new s(0,0,0,0),n=e.r/255,r=e.g/255,i=e.b/255;return t.k=Math.min(1-n,1-r,1-i),t.c=(1-n-t.k)/(1-t.k),t.m=(1-r-t.k)/(1-t.k),t.y=(1-i-t.k)/(1-t.k),t.c=Math.round(100*t.c),t.m=Math.round(100*t.m),t.y=Math.round(100*t.y),t.k=Math.round(100*t.k),t},toRGB:function(e){return e instanceof o?e:e instanceof a?this._HSVtoRGB(e):e instanceof s?this._CMYKtoRGB(e):void 0},toHSV:function(e){return e instanceof a?e:e instanceof o?this._RGBtoHSV(e):e instanceof s?this._RGBtoHSV(this._CMYKtoRGB(e)):void 0},toCMYK:function(e){return e instanceof s?e:e instanceof o?this._RGBtoCMYK(e):e instanceof a?this._RGBtoCMYK(this._HSVtoRGB(e)):void 0},toHexString:function(e){if(e instanceof o){var t=parseInt(""+e.r).toString(16),n=parseInt(""+e.g).toString(16),r=parseInt(""+e.b).toString(16);return 1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),1==r.length&&(r="0"+r),t+n+r}},toRgbStr:function(e){return"rgb("+Math.round(e.r)+", "+Math.round(e.g)+", "+Math.round(e.b)+")"},toRgbaStr:function(e){return"rgba("+Math.round(e.r)+", "+Math.round(e.g)+", "+Math.round(e.b)+", "+e.a+")"},hexToRGB:function(e){e=(e=e.trim()).replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,r){return t+t+n+n+r+r}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?new o(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)):null}};function c(e){return.299*e.r+.587*e.g+.114*e.b<125}})),r.register("72Jv0",(function(e,n){t(e.exports,"appendTextDiv",(function(){return s})),t(e.exports,"isInputFocused",(function(){return l})),t(e.exports,"clearSelection",(function(){return c})),t(e.exports,"makeUnfocusable",(function(){return h})),t(e.exports,"el",(function(){return d})),t(e.exports,"destroyEl",(function(){return g}));var i=r("h4olN"),a=r("7jh4K"),o=r("eWjiX");function s(e,t){var n=document.createElement("div");return n.innerHTML=t,e.appendChild(n),n}function l(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=document.activeElement&&["INPUT","TEXTAREA"].includes(document.activeElement.tagName);return e?t:t&&!document.activeElement.getAttribute("data-ignore-focus")}function c(){if(window.getSelection){var e=window.getSelection();e&&(e.empty?e.empty():e.removeAllRanges&&e.removeAllRanges())}else"selection"in document&&document.selection.empty()}var u,h=(u=function(e){e.preventDefault();var t=!1;if(e.relatedTarget)try{e.relatedTarget.focus(),t=!0}catch(e){console.error("failed to focus")}t||e.currentTarget.blur()},function(e){e.setAttribute("tabindex","-1"),i.addEventListener(e,"focus",u)}),p=[];function d(e){var t=document.createElement(e.tagName?e.tagName:"div");e.css&&a.css(t,e.css),e.content&&("string"==typeof e.content?t.innerHTML=e.content:Array.isArray(e.content)?o.BB.append(t,e.content):t.appendChild(e.content)),e.textContent&&(t.textContent=e.textContent),e.className&&(t.className=e.className),e.id&&(t.id=e.id),e.parent&&e.parent.appendChild(t),"title"in e&&void 0!==e.title&&(t.title=e.title);var n=[];if("onClick"in e&&(i.addEventListener(t,"click",e.onClick),n.push(["click",e.onClick])),"onChange"in e&&(i.addEventListener(t,"change",e.onChange),n.push(["change",e.onChange])),n.length>0&&p.push({el:t,listeners:n}),"custom"in e)for(var r=Object.keys(e.custom),s=0;s<r.length;s++)t.setAttribute(r[s],e.custom[r[s]]);return t}function g(e){for(var t=0;t<p.length;t++){var n=p[t];if(n.el===e)return n.listeners.forEach((function(t){e.removeEventListener(t[0],t[1])})),void p.splice(t,1)}}})),r.register("i0uIf",(function(e,n){t(e.exports,"BbLog",(function(){return a}));var i=r("4gaLD"),a=function(){"use strict";function e(){i.classCallCheck(this,e)}return i.createClass(e,null,[{key:"subscribe",value:function(t){e.listeners.includes(t)||e.listeners.push(t)}},{key:"unsubscribe",value:function(t){for(var n=0;n<e.listeners.length;n++)if(t===e.listeners[n])return void e.listeners.splice(n,1)}},{key:"emit",value:function(t){e.listeners.forEach((function(e){e(t)}))}}]),e}();a.listeners=[]})),r.register("6l0gQ",(function(e,n){t(e.exports,"LocalStorage",(function(){return a}));var i=r("4gaLD"),a=function(){"use strict";function e(){i.classCallCheck(this,e)}return i.createClass(e,null,[{key:"getItem",value:function(e){var t=null;try{t=localStorage.getItem(e)}catch(e){this.error=e}return t}},{key:"setItem",value:function(e,t){try{localStorage.setItem(e,t)}catch(e){this.error=e}}},{key:"removeItem",value:function(e){try{localStorage.removeItem(e)}catch(e){this.error=e}}},{key:"getError",value:function(){return this.error}}]),e}()})),r.register("c0kqC",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("l7FYj")})),r.register("fh18w",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("kbyFQ")})),r.register("lXqiv",(function(e,n){t(e.exports,"Checkbox",(function(){return o}));var i=r("4gaLD"),a=r("eWjiX"),o=function(){"use strict";function e(t){var n=this;i.classCallCheck(this,e),this.element=a.BB.el({className:"kl-checkbox"});var r=a.BB.el({parent:this.element,tagName:"label",className:"kl-checkbox__inner"});this.check=a.BB.el({parent:r,tagName:"input",css:{marginLeft:"0",display:"inline-block"},custom:{type:"checkbox"}}),this.check.checked=t.init,t.doHighlight&&this.check.checked&&a.BB.addClassName(this.element,"kl-checkbox--highlight"),t.allowTab||(this.check.tabIndex=-1),t.title&&(r.title=t.title);var o=document.createElement("div");o.style.display="inline-block",o.innerHTML=t.label,o.allowClick=!0,r.appendChild(o),this.check.onchange=function(){var e=n;t.doHighlight&&(n.check.checked?a.BB.addClassName(n.element,"kl-checkbox--highlight"):a.BB.removeClassName(n.element,"kl-checkbox--highlight")),t.callback(n.check.checked),setTimeout((function(){e.check.blur()}),0)},t.css&&a.BB.css(this.element,t.css)}return i.createClass(e,[{key:"getValue",value:function(){return this.check.checked}},{key:"getElement",value:function(){return this.element}},{key:"destroy",value:function(){this.check.onchange=null}}]),e}()})),r.register("c4LUw",(function(e,n){t(e.exports,"input",(function(){return a}));var i=r("eWjiX"),a=function(e){var t=document.createElement("input");if(e.type)try{t.type=e.type}catch(e){}else t.type="text";return void 0!==e.min&&(t.min=""+e.min),void 0!==e.max&&(t.max=""+e.max),t.value=""+e.init,e.callback&&(t.onchange=function(){e.callback(t.value)}),e.css&&i.BB.css(t,e.css),t}})),r.register("21VAD",(function(e,n){t(e.exports,"Select",(function(){return o}));var i=r("4gaLD"),a=r("eWjiX"),o=function(){"use strict";function e(t){var n=this;i.classCallCheck(this,e),this.destroy=function(){n.selectEl.removeEventListener("change",n.changeListener)},this.selectEl=a.BB.el({tagName:"select",title:t.title,css:{cursor:"pointer",fontSize:"15px",padding:"3px",background:"#fff",colorScheme:"only light"}}),t.css&&a.BB.css(this.selectEl,t.css);var r=t.isFocusable;r||(this.selectEl.tabIndex=-1),this.optionArr=t.optionArr;for(var o=0;o<this.optionArr.length;o++)if(null!==this.optionArr[o]){var s=document.createElement("option");s.value=this.optionArr[o][0],s.textContent=this.optionArr[o][1],this.selectEl.append(s)}this.onChange=t.onChange,this.changeListener=function(e){r||n.selectEl.blur(),n.onChange(n.selectEl.value)},this.selectEl.addEventListener("change",this.changeListener),this.selectEl.value="initValue"in t?t.initValue:null}return i.createClass(e,[{key:"setValue",value:function(e){this.selectEl.value=e}},{key:"getValue",value:function(){return this.selectEl.value}},{key:"setDeltaValue",value:function(e){for(var t=0,n=0;n<this.optionArr.length;n++)if(""+this.optionArr[n][0]===this.selectEl.value){t=n;break}t=Math.max(0,Math.min(this.optionArr.length-1,t+e)),this.selectEl.value=this.optionArr[t][0],this.onChange(this.selectEl.value)}},{key:"getElement",value:function(){return this.selectEl}}]),e}()})),r.register("jKOQl",(function(e,n){t(e.exports,"ImageToggle",(function(){return a}));var i=r("eWjiX"),a=function(e){var t=function(){n?i.BB.addClassName(r,"image-toggle-active"):i.BB.removeClassName(r,"image-toggle-active")},n=!!e.initValue,r=i.BB.el({className:"image-toggle",title:e.title,css:{backgroundImage:"url('"+e.image+"')"},onClick:function(r){r.preventDefault(),e.isRadio&&n||(n=!n,t(),e.onChange(n))}});t(),this.setValue=function(e){n=!!e,t()},this.getElement=function(){return r},this.getValue=function(){return n},this.destroy=function(){i.BB.destroyEl(r)}}})),r.register("gmlbk",(function(e,n){t(e.exports,"ImageRadioList",(function(){return o}));var i=r("eWjiX"),a=r("jKOQl"),o=function(e){for(var t,n=function(n,i){i.id===e.initId&&(t=n);var s=new a.ImageToggle({image:i.image,title:i.title,initValue:i.id===e.initId,isRadio:!0,onChange:function(){!function(n,r){t=n;for(var i=0;i<o.length;i++)o[i].setValue(i===t);e.onChange(r)}(n,i.id)}});return r.appendChild(s.getElement()),s},r=i.BB.el({className:"image-radio-wrapper",css:{display:"flex"}}),o=[],s=0;s<e.optionArr.length;s++)o.push(n(s,e.optionArr[s]));this.getElement=function(){return r},this.getValue=function(){return e.optionArr[t].id},this.destroy=function(){o.forEach((function(e){e.destroy()}))}}})),r.register("fCJWy",(function(n,i){t(n.exports,"penPressureToggle",(function(){return l}));var a=r("eWjiX"),o=r("e1Rnq"),s=r("1mH1z"),l=function(t,n){var r=function(){t?a.BB.css(i,{backgroundColor:"#fff",opacity:"0.9",border:"1px solid var(--active-highlight-color)"}):a.BB.css(i,{backgroundColor:"transparent",opacity:"0.5",border:"1px solid #666"})},i=a.BB.el({css:{cssFloat:"right",borderRadius:"3px",width:"18px",height:"18px",backgroundImage:'url("'+e(o)+'")',backgroundSize:"contain",backgroundRepeat:"no-repeat",cursor:"pointer",boxSizing:"border-box",colorScheme:"only light"}});return a.BB.hasPointerEvents||(i.style.display="none"),i.title=s.LANG("brush-toggle-pressure"),i.onclick=function(){t=!t,r(),n(t)},r(),n(t),i}})),r.register("e1Rnq",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("5H9IS")})),r.register("llzZ0",(function(e,n){t(e.exports,"KlSlider",(function(){return s}));var i=r("eWjiX"),a=r("l4PqG"),o=r("1mH1z"),s=function(e){var t,n=function(e){return d?t.findX(e,Math.floor(1.5*v)):(e-m)/(y-m)},r=function(){p?i.BB.css(S,{opacity:null,pointerEvents:null}):i.BB.css(S,{opacity:"0.5",pointerEvents:"none"})},s=function(){var e=m+I*(y-m);return d&&(e=t.interpolate(I)),e},l=function(){var e,n,r=(n=m+(e=I)*(y-m),d&&(n=t.interpolate(e)),n);r=(r=w?w(r):parseInt(r)).toLocaleString(o.languageStrings.getCode()),L.innerHTML=k+'&nbsp;&nbsp;<span style="font-weight:bold">'+r+"</span>",A.style.width=I*g+"px"},c=function(e){if(e||!b)if(B&&!e){var t=performance.now();t-O>=B&&(O=t,x(s()))}else x(s())},u=function(e){if(e.eventPreventDefault(),p){if("pointerdown"===e.type&&(S.className="sliderWrapper sliderWrapperActive","left"===e.button&&(I=e.relX/g,I=Math.max(0,Math.min(1,I)),l(),c(!1)),M=I),"pointermove"===e.type&&["left","right"].includes(e.button)){var t=e.dX,n=Math.abs(e.pageY-e.downPageY);t*=a.calcSliderFalloffFactor(n,"right"===e.button),M+=t/=g,I=Math.max(0,Math.min(1,M)),l(),c(!1)}"pointerup"===e.type&&(S.className="sliderWrapper",c(!0))}},h=this,p=!1!==e.isEnabled,d=!!e.curve;if(!e.label||!e.onChange)throw"PcSlider missing params";if(!(0==e.min||0==e.max||0==e.initValue||e.min&&e.max&&e.initValue))throw"PcSlider broken params";if(e.min>=e.max)throw"PcSlider broken params";var g=e.width,f=e.height,v=e.resolution?e.resolution:g,m=e.min,y=e.max,x=e.onChange,b=!!e.isChangeOnFinal,w=e.formatFunc,B=e.eventResMs;if(d){var C="quadratic"===e.curve?i.BB.quadraticSplineInput(m,y,.1):e.curve;t=new i.BB.SplineInterpolator(C)}var S=i.BB.el({className:"sliderWrapper",css:{overflow:"hidden",position:"relative",width:g+"px",height:f+"px",userSelect:"none"}}),k=e.label,L=document.createElement("div"),A=document.createElement("div"),T=document.createElement("div"),I=n(e.initValue);S.appendChild(A),S.appendChild(L),A.appendChild(T),A.className="sliderInner",S.oncontextmenu=function(){return!1},L.innerHTML=k,A.style.position="absolute",A.style.left="0",A.style.top="0",A.style.width=I*g+"px",A.style.height=f+"px";var E=f-14;i.BB.css(L,{position:"absolute",left:"7px",top:f/2-E/2+1+"px",lineHeight:E+"px",fontSize:E+"px",pointerEvents:"none"}),r();var M,R,O=0,P=setTimeout((function(){R=new i.BB.PointerListener({target:S,maxPointers:1,fixScribble:!0,onPointer:u,onWheel:function(e){d?(I+=-e.deltaY*(t.getLastX()-t.getFirstX())/40,I=Math.max(t.getFirstX(),Math.min(t.getLastX(),I))):(I+=-e.deltaY/40,I=Math.max(0,Math.min(1,I))),l(),x(s())}}),l()}),1);this.increaseValue=function(e){I=Math.min(1,I+Math.abs(e)),l(),x(s())},this.decreaseValue=function(e){I=Math.max(0,I-Math.abs(e)),l(),x(s())},this.setValue=function(e){I=n(e),l()},this.getValue=function(){return s()},this.update=function(e){if(m=e.min,y=e.max,d=!!e.curve){var n="quadratic"===e.curve?i.BB.quadraticSplineInput(m,y,.1):e.curve;t=new i.BB.SplineInterpolator(n)}else t=null;h.setIsEnabled(!e.isDisabled)},this.setIsEnabled=function(e){p=!!e,r()},this.destroy=function(){clearTimeout(P),R&&R.destroy()},this.getElement=function(){return S}}})),r.register("l4PqG",(function(e,n){t(e.exports,"calcSliderFalloffFactor",(function(){return r}));var r=function(e,t){var n=Math.min(10,1+Math.pow(Math.floor(e/50),2));return t&&(n*=2),1/n}})),r.register("lfHl9",(function(n,i){t(n.exports,"HexColorDialog",(function(){return u}));var a=r("eWjiX"),o=r("c4LUw"),s=r("ekHRj"),l=r("1mH1z"),c=r("fcsnL"),u=function(t){var n=function(e,t){var n={},s=a.BB.el({css:{display:"flex",alignItems:"center",marginTop:"5px"}}),l=a.BB.el({content:e,css:{width:"60px"}}),c=o.input({init:r[t],min:0,max:255,type:"number",css:{width:"80px"},callback:function(){""===c.value||parseFloat(c.value)<0||parseFloat(c.value)>255?n.update():(c.value=""+Math.round(parseFloat(c.value)),r[t]=c.value,u.style.background="#"+a.BB.ColorConverter.toHexString(r),d.value="#"+a.BB.ColorConverter.toHexString(r))}});return s.appendChild(l),s.appendChild(c),i.appendChild(s),n.update=function(){c.value=r[t]},n.destroy=function(){c.onchange=null},n},r=new a.BB.RGB(t.color.r,t.color.g,t.color.b),i=a.BB.el({}),u=a.BB.el({css:{width:"20px",height:"20px",marginBottom:"10px",boxShadow:"inset 0 0 0 1px #fff, 0 0 0 1px #000",background:"#"+a.BB.ColorConverter.toHexString(r),colorScheme:"only light"}});i.appendChild(u);var h=a.BB.el({css:{display:"flex",alignItems:"center",marginBottom:"15px"}}),p=a.BB.el({content:l.LANG("mci-hex"),css:{width:"60px"}}),d=o.input({init:"#"+a.BB.ColorConverter.toHexString(r),css:{width:"80px"},callback:function(){var e=a.BB.ColorConverter.hexToRGB(d.value);null===e?(e=r,d.value="#"+a.BB.ColorConverter.toHexString(r)):r=e,u.style.background="#"+a.BB.ColorConverter.toHexString(e);for(var t=0;t<f.length;t++)f[t].update()}}),g=a.BB.el({tagName:"button",content:'<img src="'+e(c)+'" height="20"/>',title:l.LANG("mci-copy"),css:{marginLeft:"10px"},onClick:function(){d.select(),document.execCommand("copy")}});h.appendChild(p),h.appendChild(d),h.appendChild(g),i.appendChild(h),setTimeout((function(){d.focus(),d.select()}),0);var f=[];f.push(n(l.LANG("red"),"r")),f.push(n(l.LANG("green"),"g")),f.push(n(l.LANG("blue"),"b")),s.popup({target:document.body,message:"<b>".concat(l.LANG("manual-color-input"),"</b>"),div:i,autoFocus:!1,clickOnEnter:"Ok",buttons:["Ok","Cancel"],callback:function(e){a.BB.destroyEl(g),f.forEach((function(e){return e.destroy()})),f.splice(0,f.length),t.onClose("Ok"===e?a.BB.ColorConverter.hexToRGB(d.value):null)}})}})),r.register("fcsnL",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("la7yv")})),r.register("h7i9r",(function(n,i){t(n.exports,"KlColorSlider",(function(){return u}));var a=r("eWjiX"),o=r("lfHl9"),s=r("l4PqG"),l=r("1nsGS"),c=r("1mH1z"),u=function(t){var n=function(e){B=0===e.s?new a.BB.HSV(B.h,e.s,e.v):new a.BB.HSV(e.h,e.s,e.v)},r=function(){var e=a.BB.ColorConverter.toRGB(new a.BB.HSV(B.h,100,100));a.BB.setAttributes(A,{"stop-color":"#"+a.BB.ColorConverter.toHexString(e)})},i=function(){var e=B.s/100*m-7,t=(1-B.v/100)*y-6;a.BB.css(R,{left:e+"px",top:t+"px"})},u=function(){I.style.backgroundColor="rgb("+w.r+","+w.g+","+w.b+")",a.BB.testIsWhiteBestContrast(w)?(a.BB.css(P,{filter:"invert(1)"}),a.BB.css(G,{filter:"invert(1)"})):(a.BB.css(P,{filter:""}),a.BB.css(G,{filter:""}))},h=function(){N.style.backgroundColor=a.BB.ColorConverter.toRgbStr(C)},p=function(){var e=S;S=B,n(e),e=C,C=w,w=e,E.style.left=parseInt(""+(B.h/359*m-1))+"px",r(),i(),u(),h(),b(new a.BB.RGB(w.r,w.g,w.b))},d=this,g=function(e){},f=document.createElement("div");f.style.position="relative",f.className="colorSlider";var v=a.BB.el({css:{display:"flex",alignItems:"center"}}),m=t.width,y=t.svHeight,x=t.height,b=t.onPick,w={r:parseInt(t.startValue.r,10),g:parseInt(t.startValue.g,10),b:parseInt(t.startValue.b,10)},B=a.BB.ColorConverter.toHSV(t.startValue),C={r:255,g:255,b:255},S=a.BB.ColorConverter._RGBtoHSV(C),k=a.BB.el({}),L=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"> <defs> <linearGradient id="value" gradientTransform="rotate(90)"> <stop offset="0" stop-color="rgba(0,0,0,0)"/> <stop offset="100%" stop-color="rgba(0,0,0,1)"/> </linearGradient> <linearGradient id="hue" gradientTransform="rotate(0)"> <stop offset="0" stop-color="#fff"/> <stop id="hue-stop" offset="100%" stop-color="#f00"/> </linearGradient> </defs> <rect x="0" y="0" width="100" height="100" fill="url(\'#hue\')"/> <rect x="0" y="0" width="100" height="100" fill="url(\'#value\')"/></svg>',"image/svg+xml").documentElement,A=L.getElementById("hue-stop");a.BB.setAttributes(A,{"stop-color":"#f0f"}),a.BB.css(L,{width:m+"px",height:y+"px"}),k.appendChild(L);var T=document.createElement("div");a.BB.css(T,{position:"relative",height:x+"px"});var I=document.createElement("div"),E=document.createElement("div");r(),f.style.width=m+"px",f.oncontextmenu=function(){return!1};var M=document.createElement("div");a.BB.css(M,{width:m+"px",height:y+"px",overflow:"hidden",display:"block",position:"relative",cursor:"crosshair",boxShadow:"rgb(188, 188, 188) 0 0 0 1px"});var R=document.createElement("div");a.BB.css(R,{width:"12px",height:"12px",borderRadius:"6px",position:"absolute",pointerEvents:"none",boxShadow:"0px 0px 0 1px #000, inset 0px 0px 0 1px #fff"}),M.appendChild(k),M.appendChild(R),i(),f.appendChild(M),f.appendChild(T),v.appendChild(I),a.BB.css(I,{display:"flex",justifyContent:"space-between",width:2.5*x+"px",height:x+"px",boxShadow:"rgb(188, 188, 188) 0 0 0 1px",colorScheme:"only light"}),a.BB.css(T,{overflow:"hidden",position:"relative",width:m+"px",height:x+"px",cursor:"ew-resize",boxShadow:"rgb(188, 188, 188) 0 0 0 1px",marginTop:"1px",marginBottom:"1px"}),a.BB.css(E,{width:"1px",height:x+"px",background:"#000",borderLeft:"1px solid #fff",position:"absolute",top:"0",left:parseInt(""+(B.h/360*m-1))+"px"});var O={h:0,s:0,v:0},P=a.BB.el({title:c.LANG("eyedropper")+" [Alt]",className:"color-picker-preview-button",css:{width:"30px",height:"30px",backgroundImage:"url("+e(l)+")",backgroundRepeat:"no-repeat",backgroundSize:"70%",backgroundPosition:"center"}}),D=!1;P.onclick=function(){!1===D?(a.BB.removeClassName(P,"color-picker-preview-button-hover"),a.BB.addClassName(P,"color-picker-preview-button-active"),D=!0,g(!0)):(g(!1),d.pickingDone())};new a.BB.PointerListener({target:P,onEnterLeave:function(e){D||(e?a.BB.addClassName(P,"color-picker-preview-button-hover"):a.BB.removeClassName(P,"color-picker-preview-button-hover"))}});I.appendChild(P);var G=a.BB.el({content:"#",className:"color-picker-preview-button",title:c.LANG("manual-color-input"),css:{height:"100%",width:x+"px",lineHeight:x+"px",fontSize:.65*x+"px"},onClick:function(){o.HexColorDialog({color:new a.BB.RGB(w.r,w.g,w.b),onClose:function(e){e&&(d.setColor(e),b(new a.BB.RGB(w.r,w.g,w.b)))}})}});new a.BB.PointerListener({target:G,onEnterLeave:function(e){e?a.BB.addClassName(G,"color-picker-preview-button-hover"):a.BB.removeClassName(G,"color-picker-preview-button-hover")}});I.appendChild(G),u(),setTimeout((function(){!function(e){var t=new Image;a.BB.css(t,{position:"absolute",left:"0",top:"0",display:"none",pointerEvents:"none"});for(var n=a.BB.canvas(m,x),r=n.getContext("2d"),i=r.createLinearGradient(0,0,m,0),o=0;o<1;o+=.01){var s=a.BB.ColorConverter.toRGB(new a.BB.HSV(360*o,100,100)),l=parseInt(""+s.r).toString(16),c=parseInt(""+s.g).toString(16),u=parseInt(""+s.b).toString(16);1===l.length&&(l="0"+l),1===c.length&&(c="0"+c),1===u.length&&(u="0"+u),i.addColorStop(o,"#"+l+c+u)}r.fillStyle=i,r.fillRect(0,0,m,x),e.appendChild(t),t.alt="hue",t.src=n.toDataURL("image/png"),t.style.display="block"}(T),T.appendChild(E),new a.BB.PointerListener({target:k,maxPointers:1,fixScribble:!0,onPointer:function(e){if("pointerdown"===e.type&&(a.BB.css(M,{boxShadow:"0px 0px 0px 1px rgb(255,255,255)",zIndex:"1"}),"left"===e.button?(O.s=e.relX/m*100,O.v=100-e.relY/y*100,B=new a.BB.HSV(B.h,O.s,O.v),w=a.BB.ColorConverter.toRGB(B),i(),u(),b(a.BB.ColorConverter.toRGB(B))):(O.s=B.s,O.v=B.v)),"pointermove"===e.type&&["left","right"].includes(e.button)){var t=1;"right"===e.button&&(t=.5),O.s+=e.dX/m*100*t,O.v-=e.dY/y*100*t,B=new a.BB.HSV(B.h,O.s,O.v),w=a.BB.ColorConverter.toRGB(B),i(),u(),b(a.BB.ColorConverter.toRGB(B))}"pointerup"===e.type&&a.BB.css(M,{boxShadow:"0 0 0 1px rgb(188, 188, 188)",zIndex:"0"})}}),new a.BB.PointerListener({target:T,maxPointers:1,fixScribble:!0,onPointer:function(e){if("pointerdown"===e.type&&(a.BB.css(T,{boxShadow:"0px 0px 0px 1px rgba(255,255,255,1)"}),"left"===e.button?(O.h=e.relX/m*359.99,B=new a.BB.HSV(O.h,B.s,B.v),w=a.BB.ColorConverter.toRGB(B),E.style.left=Math.round(B.h/359.99*m)-1+"px",r(),u(),b(a.BB.ColorConverter.toRGB(B))):O.h=B.h),"pointermove"===e.type&&["left","right"].includes(e.button)){var t=Math.abs(e.pageY-e.downPageY),n=s.calcSliderFalloffFactor(t,"right"===e.button);O.h+=e.dX/m*359.99*n,"right"===e.button&&(O.h=O.h%359.99,O.h<0&&(O.h+=359.99)),O.h=Math.min(359.99,O.h),B=new a.BB.HSV(O.h,B.s,B.v),w=a.BB.ColorConverter.toRGB(B),E.style.left=Math.round(B.h/359.99*m)-1+"px",r(),u(),b(a.BB.ColorConverter.toRGB(B))}"pointerup"===e.type&&a.BB.css(T,{boxShadow:"rgb(188, 188, 188) 0 0 0 1px"})}})}),1);var N=a.BB.el({parent:v,title:c.LANG("secondary-color")+" [X]",css:{cursor:"pointer",marginLeft:"5px",width:"22px",height:"22px",boxShadow:"rgb(188, 188, 188) 0px 0px 0px 1px",colorScheme:"only light"},onClick:function(e){e.preventDefault(),p()}});h(),this.setColor=function(e){w={r:parseInt(e.r,10),g:parseInt(e.g,10),b:parseInt(e.b,10)},n(a.BB.ColorConverter.toHSV(e)),E.style.left=parseInt(""+(B.h/359*m-1))+"px",r(),i(),u()},this.getColor=function(){return new a.BB.RGB(w.r,w.g,w.b)},this.getSecondaryRGB=function(){return new a.BB.RGB(C.r,C.g,C.b)},this.setPickCallback=function(e){g=e},this.pickingDone=function(){D&&(D=!1,a.BB.removeClassName(P,"color-picker-preview-button-active"))},this.enable=function(e){e?(f.style.pointerEvents="",f.style.opacity="1",v.style.pointerEvents="",v.style.opacity="1"):(f.style.pointerEvents="none",f.style.opacity="0.5",v.style.pointerEvents="none",v.style.opacity="0.5")},this.setHeight=function(e){(e=parseInt(""+(e-2*x-3),10))!==y&&(y=e,a.BB.css(L,{width:m+"px",height:y+"px"}),M.style.height=y+"px",i())},this.swapColors=function(){p()},this.getElement=function(){return f},this.getOutputElement=function(){return v}}})),r.register("1nsGS",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("cTtMO")})),r.register("kzhsD",(function(e,n){t(e.exports,"KlSmallColorSlider",(function(){return o}));var i=r("eWjiX"),a=r("l4PqG"),o=function(e){var t=function(){for(var e=l.getContext("2d"),t=0;t<l.height;t+=1){var n=e.createLinearGradient(0,0,l.width,0),r=i.BB.ColorConverter.toRGB(new i.BB.HSV(s.h,1,100-t/l.height*100)),a=i.BB.ColorConverter.toRGB(new i.BB.HSV(s.h,100,100-t/l.height*100));n.addColorStop(0,"#"+i.BB.ColorConverter.toHexString(r)),n.addColorStop(1,"#"+i.BB.ColorConverter.toHexString(a)),e.fillStyle="#ff0000",e.fillStyle=n,e.fillRect(0,t,l.width,1)}},n=function(){var t=s.s/100*e.width-4,n=(1-s.v/100)*e.heightSV-4;i.BB.css(u,{left:t+"px",top:n+"px"})},r=function(){h.style.left=s.h/359.999*e.width-1+"px"},o=document.createElement("div");o.oncontextmenu=function(e){e.preventDefault()};var s=i.BB.ColorConverter.toHSV(new i.BB.RGB(e.color.r,e.color.g,e.color.b));i.BB.css(o,{width:e.width+"px",position:"relative",overflow:"hidden",userSelect:"none"});var l=i.BB.canvas(10,10);l.style.width=e.width+"px",l.style.height=e.heightSV+"px",l.style.cursor="crosshair",t();var c=i.BB.canvas(e.width,e.heightH);c.style.cursor="ew-resize",function(){for(var t=c.getContext("2d"),n=t.createLinearGradient(0,0,e.width,0),r=0;r<1;r+=.01){var a=i.BB.ColorConverter.toRGB(new i.BB.HSV(360*r,100,100));n.addColorStop(r,"rgba("+parseInt(""+a.r)+", "+parseInt(""+a.g)+", "+parseInt(""+a.b)+", 1)")}t.fillStyle=n,t.fillRect(0,0,e.width,e.heightH)}(),i.BB.css(l,{width:e.width+"px",height:e.heightSV+"px",overflow:"hidden",position:"relative"}),l.style.cssFloat="left",c.style.cssFloat="left",o.appendChild(l),o.appendChild(c);var u=document.createElement("div");i.BB.css(u,{width:"8px",height:"8px",borderRadius:"8px",position:"absolute",pointerEvents:"none",boxShadow:"0 0 0 1px #000, inset 0 0 0 1px #fff"}),o.appendChild(u);var h=document.createElement("div");i.BB.css(h,{width:"0",height:e.heightH+"px",borderLeft:"1px solid #fff",borderRight:"1px solid #000",position:"absolute",top:e.heightSV+"px",pointerEvents:"none"}),o.appendChild(h),n(),r();var p={h:0,s:0,v:0},d=null,g=new i.BB.PointerListener({target:l,maxPointers:1,fixScribble:!0,onPointer:function(t){if("pointerdown"===t.type&&(d=t.pointerId,"left"===t.button?(p.s=t.relX/e.width*100,p.v=100-t.relY/e.heightSV*100,s=new i.BB.HSV(s.h,p.s,p.v),n(),e.callback(i.BB.ColorConverter.toRGB(s))):(p.s=s.s,p.v=s.v)),"pointermove"===t.type&&["left","right"].includes(t.button)&&d===t.pointerId){var r=1;"right"===t.button&&(r=.5),p.s+=t.dX/e.width*100*r,p.v-=t.dY/e.heightSV*100*r,s=new i.BB.HSV(s.h,p.s,p.v),n(),e.callback(i.BB.ColorConverter.toRGB(s))}"pointerup"===t.type&&(d=null)}}),f=null,v=new i.BB.PointerListener({target:c,maxPointers:1,fixScribble:!0,onPointer:function(n){if("pointerdown"===n.type&&(f=n.pointerId,"left"===n.button?(p.h=n.relX/e.width*359.99,s=new i.BB.HSV(p.h,s.s,s.v),t(),r(),e.callback(i.BB.ColorConverter.toRGB(s))):p.h=s.h),"pointermove"===n.type&&["left","right"].includes(n.button)&&f===n.pointerId){var o=Math.abs(n.pageY-n.downPageY),l=a.calcSliderFalloffFactor(o,"right"===n.button);p.h+=n.dX/e.width*359.99*l,"right"===n.button&&(p.h=p.h%359.99,p.h<0&&(p.h+=359.99)),p.h=Math.min(359.99,p.h),s=new i.BB.HSV(p.h,s.s,s.v),t(),r(),e.callback(i.BB.ColorConverter.toRGB(s))}"pointerup"===n.type&&(f=null)}}),m=document.createElement("div");m.style.clear="both",o.appendChild(m),this.setColor=function(e){s=i.BB.ColorConverter.toHSV(new i.BB.RGB(e.r,e.g,e.b)),t(),n(),r()},this.getColor=function(){return i.BB.ColorConverter.toRGB(s)},this.getElement=function(){return o},this.destroy=function(){g.destroy(),v.destroy()},this.end=function(){d=null,f=null}}})),r.register("bd9hB",(function(e,n){t(e.exports,"PointSlider",(function(){return a}));var i=r("eWjiX"),a=function(e){var t=function(){s.style.left=a+"px",s.style.boxShadow=l?"0 0 6px rgba(0,0,0,1)":"0 0 3px rgba(0,0,0,0.8)"},n=function(){return a/(e.width-e.pointSize)},r=document.createElement("div");r.style.position="relative";var a,o=i.BB.el({}),s=i.BB.el({css:{colorScheme:"only light"}});r.appendChild(o),r.appendChild(s);var l=!1;i.BB.css(o,{marginTop:parseInt(""+(e.pointSize/2-1))+"px",height:"2px",background:"#aaa",width:e.width+"px"});var c,u,h;i.BB.el({parent:s,css:{margin:"-7px 0 0 -7px",width:"calc(100% + 14px)",height:"calc(100% + 7px)"}});a=i.BB.clamp(e.init*(e.width-e.pointSize),0,e.width-e.pointSize),i.BB.css(s,{position:"absolute",top:"0px",backgroundColor:"#eaeaea",boxShadow:"0 0 3px rgba(0,0,0,0.8)",width:e.pointSize+"px",height:e.pointSize+"px",borderRadius:e.pointSize+"px",cursor:"ew-resize",transition:"box-shadow 0.2s ease-in-out"}),t(),c=new i.BB.PointerListener({target:s,fixScribble:!0,onPointer:function(r){"pointerdown"===r.type&&"left"===r.button?(u=!0,l=!0,h=a,t(),r.eventStopPropagation()):"pointermove"===r.type&&"left"===r.button&&(r.eventStopPropagation(),h+=r.dX,a=parseInt(""+i.BB.clamp(h,0,e.width-e.pointSize)),t(),e.callback(n(),u,!1),u=!1),"pointerup"===r.type&&(r.eventStopPropagation(),l=!1,t(),e.callback(n(),!1,!0))}}),this.getEl=function(){return r},this.setActive=function(e){s.style.backgroundColor=e?"#fff":"#eaeaea"},this.destroy=function(){c.destroy()}}})),r.register("9A7OD",(function(e,n){t(e.exports,"ColorOptions",(function(){return a}));var i=r("eWjiX"),a=function(e){for(var t=function(){for(var e=0;e<o.length;e++)o[e].setIsSelected(e===r)},n=i.BB.el({content:e.label?e.label:"",css:{display:"flex",alignItems:"center",colorScheme:"only light"}}),r=0,a=[],o=[],s=i.BB.createCheckerDataUrl(5),l=0;l<e.colorArr.length;l++){for(var c=e.colorArr[l],u=!1,h=0;h<a.length;h++){var p=a[h];if(null!==p&&null!==c&&(p.r===c.r&&p.g===c.g&&p.b===c.b&&p.a===c.a)){u=!0;break}}u||(a.push(c),"initialIndex"in e&&e.initialIndex===l&&(r=a.length-1))}for(var d=0;d<a.length;d++)!function(l){var c=i.BB.el({content:a[l]?"":"X",css:{width:"22px",height:"22px",backgroundColor:a[l]?i.BB.ColorConverter.toRgbaStr(a[l]):"transparent",marginLeft:"7px",boxShadow:"0 0 0 1px #aaa",cursor:"pointer",userSelect:"none",textAlign:"center",lineHeight:"23px",color:"#aaa"}});a[l]&&0===a[l].a&&(c.style.backgroundImage="url("+s+")"),c.onclick=function(n){n.preventDefault(),r=l,t(),e.onChange(a[l])},c.setIsSelected=function(e){e?i.BB.css(c,{boxShadow:"0 0 0 2px var(--active-highlight-color), 0 0 5px 0 var(--active-highlight-color)",pointerEvents:"none"}):i.BB.css(c,{boxShadow:"0 0 0 1px #aaa",pointerEvents:""})},n.appendChild(c),o.push(c)}(d);t(),this.getElement=function(){return n},this.destroy=function(){o.forEach((function(e){e.onclick=null})),o.splice(0,o.length)}}})),r.register("iskOY",(function(e,n){t(e.exports,"Options",(function(){return a}));var i=r("eWjiX"),a=function(e){for(var t=function(t){var r={id:t.id,el:null},a=["kl-option"];e.isSmall&&a.push("kl-option--small"),"string"!=typeof t.label&&(a.push("kl-option--custom-el"),i.BB.css(t.label,{display:"block",pointerEvents:"none"})),r.el=i.BB.el({parent:o,content:t.label,className:a.join(" "),onClick:function(){l!==r.id&&(l=r.id,n(),e.onChange(l))}}),t.title&&(r.el.title=t.title),s.push(r)},n=function(){for(var e=0;e<s.length;e++)s[e].id===l?i.BB.addClassName(s[e].el,"kl-option-selected"):i.BB.removeClassName(s[e].el,"kl-option-selected")},r=function(){for(var e=0;e<s.length;e++)if(s[e].id===l)return e},a=i.BB.el({}),o=i.BB.el({parent:a,className:"kl-option-wrapper",css:{display:"flex"}}),s=[],l=("initialId"in e?e.initialId:e.optionArr[0].id),c=0;c<e.optionArr.length;c++)t(e.optionArr[c]);n(),e.changeOnInit&&setTimeout((function(){e.onChange(l)}),0),this.getElement=function(){return a},this.getValue=function(){return l},this.next=function(){l=s[(r()+1)%s.length].id,n(),e.onChange(l)},this.previous=function(){l=s[(s.length+r()-1)%s.length].id,n(),e.onChange(l)},this.destroy=function(){s.forEach((function(e){i.BB.destroyEl(e.el)})),s.splice(0,s.length)}}})),r.register("bmB93",(function(n,i){t(n.exports,"StatusOverlay",(function(){return l}));var a=r("4gaLD"),o=r("eWjiX"),s=r("bv5Zj"),l=function(){"use strict";function t(){a.classCallCheck(this,t),this.init()}return a.createClass(t,[{key:"updateUiState",value:function(){this.el&&(setTimeout((function(){}),100),"left"===this.uiState?this.el.style.left="271px":this.el.style.removeProperty("left"))}},{key:"init",value:function(){this.el=o.BB.el({className:"top-overlay g-root",onClick:o.BB.handleClick}),this.isWide&&(this.el.style.width="100%"),this.updateUiState(),this.innerEl=o.BB.el({className:"top-overlay-inner"}),this.angleIm=new Image,this.angleIm.src=e(s),o.BB.css(this.angleIm,{verticalAlign:"bottom",width:"20px",height:"20px",marginLeft:"5px",borderRadius:"10px"}),this.innerInnerEl=document.createElement("div"),this.innerInnerEl.style.display="inline-block",this.innerEl.appendChild(this.innerInnerEl),this.innerEl.appendChild(this.angleIm),this.el.appendChild(this.innerEl),document.body.appendChild(this.el),this.el.style.display="none"}},{key:"setWide",value:function(e){this.isWide=!!e,this.el&&(this.isWide?(this.el.style.width="100%",this.el.style.left=""):(this.el.style.removeProperty("width"),this.el.style.left="left"===this.uiState?"271px":""))}},{key:"setUiState",value:function(e){this.uiState=e,this.updateUiState()}},{key:"out",value:function(e,t){var n=this;if(e&&"object"==typeof e?"transform"===e.type?(this.angleIm.style.display="inline-block",this.angleIm.style.transform="rotate("+e.angleDeg+"deg)",e.angleDeg%90==0?this.angleIm.style.boxShadow="inset 0 0 0 1px rgba(255, 255, 255, 0.7)":this.angleIm.style.boxShadow="",this.innerInnerEl.innerHTML=Math.round(100*e.scale)+"%"):this.angleIm.style.display="none":"string"==typeof e&&(this.angleIm.style.display="none",this.innerInnerEl.innerHTML=e),t){var r=this;this.innerEl.style.animation="",setTimeout((function(){return r.innerEl.style.animation="top-overlay-pulse 0.5s ease-out"}),20),this.timeout3&&clearTimeout(this.timeout3),this.timeout3=window.setTimeout((function(){return r.innerEl.style.animation=""}),520)}this.timeout&&clearTimeout(this.timeout),this.timeout2&&clearTimeout(this.timeout2),this.el.style.animationName=t?"consoleInFast":"consoleIn",this.el.style.opacity="1",this.timeout=window.setTimeout((function(){var e=n;n.el.style.opacity="0",n.el.style.animationName="consoleOut",n.timeout2=window.setTimeout((function(){e.el.style.display="none",e.timeout2=0}),450),n.timeout=0}),1200),this.el.style.display="flex"}}]),t}()})),r.register("bv5Zj",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("iQ1f0")})),r.register("auloj",(function(e,n){t(e.exports,"exportDialog",(function(){return o}));var i=r("eWjiX"),a=r("ekHRj");function o(e,t){var n,r,o,s,l,c,u,h;r=!1,o=!1,n=document.createElement("div"),i.BB.css(n,{width:"308px"}),s=document.createElement("div"),(l=new Image).src=t.src,s.appendChild(l),s.appendChild(t),i.BB.css(s,{width:"264px",height:"176px",marginTop:"21px",marginLeft:"21px",position:"relative",overflow:"hidden",boxShadow:"0 0 10px 4px rgba(255,255,255, 0)",border:"1px solid rgba(255, 255, 255, 1)",transition:"box-shadow 0.7s linear"}),i.BB.css(t,{position:"absolute",left:"0",top:"0",width:"264px",height:"176px",opacity:"0"}),(c={width:264,height:264/t.width*t.height}).height<176&&(c.height=176,c.width=c.height/t.height*t.width),i.BB.css(l,{position:"absolute",top:"88px",left:"132px",width:c.width+"px",height:c.height+"px",marginLeft:-c.width/2+"px",marginTop:-c.height/2+"px"}),function e(){r||((o=!o)?i.BB.css(s,{border:"1px solid rgba(0, 0, 0, 1)"}):i.BB.css(s,{border:"1px solid rgba(200, 200, 200, 1)"}),setTimeout(e,510))}(),(u=document.createElement("div")).innerHTML="Right-Click or Press-Hold on the image, then save.",u.ontouchstart=function(){return!1},i.BB.css(u,{fontSize:"17.6px",color:"#666",padding:"10px",textAlign:"center"}),n.appendChild(s),n.appendChild(u),t.ontouchstart=function(){i.BB.css(s,{boxShadow:"0 0 10px 8px rgba(0,255,255, 1)"}),!0,h=setTimeout((function(){!1,i.BB.css(s,{boxShadow:"0 0 10px 4px rgba(0,255,255, 0)"})}),1500)},t.ontouchmove=function(){i.BB.css(s,{boxShadow:"0 0 10px 4px rgba(0,255,255, 0)"}),!1,clearTimeout(h)},t.ontouchend=function(){i.BB.css(s,{boxShadow:"0 0 10px 4px rgba(0,255,255, 0)"}),!1,clearTimeout(h)},a.popup({target:e,message:"<b>Save Image</b>",div:n,buttons:["Close"],callback:function(e){r=!0}})}})),r.register("hRdOL",(function(e,n){t(e.exports,"CropCopy",(function(){return a}));var i=r("eWjiX");function a(e){var t,n=function(){t={x:0,y:0,width:e.canvas.width,height:e.canvas.height}},r=function(){u.width=Math.round(t.width),u.height=Math.round(t.height),u.getContext("2d").drawImage(e.canvas,Math.round(-t.x),Math.round(-t.y)),p&&(p.src=u.toDataURL("image/png")),e.onChange&&e.onChange(u.width,u.height)},a=function(){i.BB.css(B,{left:x+t.x*v+"px",top:b+t.y*m+"px",width:t.width*v+"px",height:t.height*m+"px"}),e.onChange&&e.onChange(Math.round(t.width),Math.round(t.height))},o=function(t){return{x:i.BB.clamp((t.x-x)/v,0,e.canvas.width),y:i.BB.clamp((t.y-b)/m,0,e.canvas.height)}},s=function(e,t){var n={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y)},r={x:Math.max(e.x,t.x),y:Math.max(e.y,t.y)},i=o(n),a=o(r);return i.x=Math.floor(i.x),i.y=Math.floor(i.y),a.x=Math.ceil(a.x),a.y=Math.ceil(a.y),{x:i.x,y:i.y,width:a.x-i.x,height:a.y-i.y}},l=function(){return 0===t.x&&0===t.y&&t.width===e.canvas.width&&t.height===e.canvas.height},c=document.createElement("div");i.BB.css(c,{position:"relative",height:e.height+"px",width:e.width+"px",overflow:"hidden",colorScheme:"only light"}),c.style.position="relative",n();var u=i.BB.canvas(),h=u,p=null;e.isNotCopy||(p=new Image,h=p),i.BB.css(h,{height:e.height+"px",width:e.width+"px"}),c.appendChild(h),r();var d=i.BB.el({css:{width:e.width+"px",height:e.height+"px",position:"absolute",left:"0",top:"0",pointerEvents:"none"}});c.appendChild(d),i.BB.createCheckerDataUrl(4,(function(e){d.style.backgroundImage="url("+e+")"}));var g=i.BB.fitInto(e.canvas.width,e.canvas.height,e.width-40,e.height-40,1),f=i.BB.canvas(Math.round(g.width),Math.round(g.height));f.style.imageRendering="pixelated";var v=f.width/e.canvas.width,m=f.height/e.canvas.height,y=f.getContext("2d");y.imageSmoothingEnabled=!1,y.drawImage(e.canvas,0,0,f.width,f.height),d.appendChild(f);var x=parseInt(""+(e.width-f.width)/2),b=parseInt(""+(e.height-f.height)/2);i.BB.css(f,{position:"absolute",left:x+"px",top:b+"px"});var w,B=i.BB.el({css:{position:"absolute",boxShadow:"0 0 0 1px #fff, 0 0 0 2px #000, 0 0 40px 1px #000"}});d.appendChild(B),a();var C,S=null,k=!1,L=!1,A=new i.BB.PointerListener({target:h,fixScribble:!0,onPointer:function(o){var c,u,h,p,d;"pointerdown"===o.type&&"left"===o.button?(o.eventPreventDefault(),k=!0,w={x:o.relX,y:o.relY},!l()&&(c=w,u=Math.round(x+t.x*v),h=Math.round(b+t.y*m),p=Math.round(t.width*v),d=Math.round(t.height*m),u<=c.x&&c.x<=u+p&&h<=c.y&&c.y<=h+d)?S={x:t.x,y:t.y,width:t.width,height:t.height}:t=s(w,w)):"pointermove"===o.type&&"left"===o.button?(o.eventPreventDefault(),L=!0,S?(t.x=S.x+Math.round((o.relX-w.x)/v),t.y=S.y+Math.round((o.relY-w.y)/m),t.x=i.BB.clamp(t.x,0,e.canvas.width-t.width),t.y=i.BB.clamp(t.y,0,e.canvas.height-t.height)):t=s(w,{x:o.relX,y:o.relY}),a()):"pointerup"===o.type&&w&&(o.eventPreventDefault(),k=!1,S=null,w=null,0!==t.width&&0!==t.height&&L||(n(),a()),L=!1,C=setTimeout(r,1))}}),T=new i.BB.KeyListener({onDown:function(n,o,s){if(!k){var l=!1,c=Math.max(1,1/v),u=T.isPressed("shift");"left"===n&&(u?t.width=i.BB.clamp(t.width-c,1,e.canvas.width-t.x):t.x=i.BB.clamp(t.x-c,0,e.canvas.width-t.width),l=!0),"right"===n&&(u?t.width=i.BB.clamp(t.width+c,1,e.canvas.width-t.x):t.x=i.BB.clamp(t.x+c,0,e.canvas.width-t.width),l=!0),"up"===n&&(u?t.height=i.BB.clamp(t.height-c,1,e.canvas.height-t.y):t.y=i.BB.clamp(t.y-c,0,e.canvas.height-t.height),l=!0),"down"===n&&(u?t.height=i.BB.clamp(t.height+c,1,e.canvas.height-t.y):t.y=i.BB.clamp(t.y+c,0,e.canvas.height-t.height),l=!0),l&&(o.preventDefault(),a(),clearTimeout(C),C=setTimeout(r,100))}}});this.getEl=function(){return c},this.reset=function(){n(),r(),a()},this.destroy=function(){h.style.removeProperty("width"),h.style.removeProperty("height"),T.destroy(),A.destroy()},this.isReset=function(){return l()},this.getRect=function(){return JSON.parse(JSON.stringify(t))},this.getCroppedImage=function(){return u}}})),r.register("isYih",(function(n,i){t(n.exports,"clipboardDialog",(function(){return h}));var a=r("4gaLD"),o=r("cijLd"),s=r("eWjiX"),l=r("ekHRj"),c=r("hRdOL"),u=r("1mH1z");function h(t,n,r,i,h){var p=function(){var t,n=m.getCroppedImage().toDataURL("image/png");setTimeout((t=a.asyncToGenerator(e(o).mark((function t(){var r,s;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(n);case 3:return r=e.sent,e.next=6,r.blob();case 6:return s=e.sent,e.next=9,navigator.clipboard.write([new ClipboardItem(a.defineProperty({},s.type,s))]);case 9:setTimeout((function(){i.out(u.LANG("cropcopy-copied"),!0)}),200),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0.name,e.t0.message);case 15:case"end":return e.stop()}}),t,null,[[0,12]])}))),function(){return t.apply(this,arguments)}),0)},d=function(){y()},g=document.createElement("div"),f=window.innerWidth<550||window.innerHeight<550,v=s.BB.el({content:u.LANG("crop-drag-to-crop"),css:{textAlign:"center"}});g.appendChild(v);var m=new c.CropCopy({width:f?340:540,height:f?300:350,canvas:n});s.BB.css(m.getEl(),{marginTop:"10px",marginLeft:"-20px",borderTop:"1px solid #bbb",borderBottom:"1px solid #bbb"}),g.appendChild(m.getEl());var y,x=new s.BB.KeyListener({onDown:function(e,t,n){"ctrl+c"===n&&(p(),y())}});s.BB.addEventListener(window,"blur",d),l.popup({target:t,message:"<b>"+(h?"".concat(u.LANG("cropcopy-title-copy")," / ").concat(u.LANG("cropcopy-title-crop")):"".concat(u.LANG("cropcopy-title-copy")))+"</b>",div:g,style:f?{}:{width:"500px"},buttons:h?[u.LANG("cropcopy-btn-copy"),u.LANG("cropcopy-btn-crop"),"Cancel"]:[u.LANG("cropcopy-btn-copy"),"Cancel"],primaries:[u.LANG("cropcopy-btn-copy")],callback:function(e){if(e===u.LANG("cropcopy-btn-copy"))p();else if(e===u.LANG("cropcopy-btn-crop")){var t=m.getRect();r({left:Math.round(-t.x),right:Math.round(t.x+t.width-n.width),top:Math.round(-t.y),bottom:Math.round(t.y+t.height-n.height)})}s.BB.removeEventListener(window,"blur",d),m.destroy(),x.destroy()},clickOnEnter:u.LANG("cropcopy-btn-copy"),closefunc:function(e){y=e}})}})),r.register("5rdL4",(function(n,i){t(n.exports,"klLayerManager",(function(){return x}));var a=r("eWjiX"),o=r("ekHRj"),s=r("gWfkn"),l=r("iskOY"),c=r("21VAD"),u=r("bd9hB"),h=r("d42vI"),p=r("dKwR8"),d=r("3VpTB"),g=r("8yL1I"),f=r("g91IK"),v=r("705qg"),m=r("1mH1z"),y=r("bBcC4");function x(t,n,r){var i,x=function(t){var n=document.createElement("div"),i=a.BB.el({content:m.LANG("layers-rename-name")+":",css:{marginRight:"5px"}}),l=a.BB.el({css:{display:"flex"}}),c=document.createElement("input");c.value=k.getLayer(t).name,c.setAttribute("data-ignore-focus","true");var u=a.BB.el({tagName:"Button",content:'<img src="'+e(g)+'" height="20"/>',title:m.LANG("layers-rename-clear"),css:{marginLeft:"10px"},onClick:function(){c.value="",c.focus()}}),h=[m.LANG("layers-rename-sketch"),m.LANG("layers-rename-colors"),m.LANG("layers-rename-lines"),m.LANG("background"),m.LANG("layers-rename-foreground")],p=[],d=a.BB.el({css:{display:"flex",flexWrap:"wrap",marginTop:"5px",marginLeft:"-5px"}});h.forEach((function(e){var t=a.BB.el({parent:d,tagName:"Button",content:e,onClick:function(){c.value=t.textContent},css:{margin:"5px 0 0 5px"}});p.push(t)})),n.appendChild(i),i.append(l,d),l.append(c,u),setTimeout((function(){c.focus(),c.select()}),10),o.popup({target:r,message:"<b>".concat(m.LANG("layers-rename-title"),"</b>"),div:n,buttons:[m.LANG("layers-rename"),"Cancel"],primaries:[m.LANG("layers-rename")],callback:function(e){if(a.BB.destroyEl(u),p.forEach((function(e){a.BB.destroyEl(e)})),p.splice(0,p.length),e===m.LANG("layers-rename")){if(c.value===k.getLayer(t).name)return;k.renameLayer(t,c.value),b(),s.klHistory.pause(!0),I(t),s.klHistory.pause(!1)}},clickOnEnter:m.LANG("layers-rename")})},b=function(){function e(e){var t=k.getLayer(e).name,n=D[e].opacity,r=D[e].context.canvas,i=document.createElement("div");i.className="layerBox",L[e]=i,i.posY=35*(D.length-1)-35*e,a.BB.css(i,{width:"250px",height:"34px",backgroundColor:"rgb( 220, 220, 220)",border:"1px solid #aaa",position:"absolute",left:"0 px",top:i.posY+"px",transition:"all 0.1s linear",borderRadius:"5px",boxSizing:"border-box"});var o=document.createElement("div");a.BB.css(o,{position:"relative"});var l=document.createElement("div");a.BB.css(l,{width:"250px",height:"34px"});var c=document.createElement("div");i.appendChild(o),o.appendChild(l),o.appendChild(c),i.spot=e;var h,p=a.BB.fitInto(r.width,r.height,30,30,1),d=i.thumb=a.BB.canvas(p.width,p.height),g=d.getContext("2d");g.save(),d.width>r.width&&(g.imageSmoothingEnabled=!1),g.drawImage(r,0,0,d.width,d.height),g.restore(),a.BB.css(i.thumb,{position:"absolute",left:(32-i.thumb.width)/2+"px",top:(32-i.thumb.height)/2+"px",colorScheme:"only light"}),a.BB.createCheckerDataUrl(4,(function(e){d.style.backgroundImage="url("+e+")"})),i.label=document.createElement("div"),i.lname=t,i.label.append(i.lname),a.BB.css(i.label,{position:"absolute",left:"38px",top:"1px",fontSize:"13px",width:"170px",height:"20px",overflow:"hidden",color:"#666",whiteSpace:"nowrap"}),i.label.ondblclick=function(){x(i.spot)},i.opacityLabel=document.createElement("div"),i.opacity=n,i.opacityLabel.append(parseInt(""+100*i.opacity)+"%"),a.BB.css(i.opacityLabel,{position:"absolute",left:"194px",top:"1px",fontSize:"13px",textAlign:"right",width:"50px",color:"#666",transition:"color 0.2s ease-in-out"});var f=new u.PointSlider({init:i.opacity,width:204,pointSize:14,callback:function(e,t,n){return t?(h=k.getLayer(i.spot).opacity,void s.klHistory.pause(!0)):n?(s.klHistory.pause(!1),void(h!==e&&k.layerOpacity(i.spot,e))):(i.opacityLabel.innerHTML=Math.round(100*e)+"%",void k.layerOpacity(i.spot,e))}});a.BB.css(f.getEl(),{position:"absolute",left:"39px",top:"17px"}),i.opacitySlider=f,a.BB.setEventListener(i.thumb,"onpointerover",(function(e){if(0===e.buttons||e.pointerType&&"touch"===e.pointerType){var t=a.BB.fitInto(r.width,r.height,250,250,1);O.width===t.width&&O.height===t.height||(O.width=t.width,O.height=t.height);var n=O.getContext("2d");n.save(),O.width>r.width&&(n.imageSmoothingEnabled=!1),n.imageSmoothingQuality="high",n.clearRect(0,0,O.width,O.height),n.drawImage(r,0,0,O.width,O.height),n.restore(),a.BB.css(E,{top:e.clientY-O.height/2+"px",opacity:"0"}),!1===P&&(document.body.appendChild(E),P=!0),clearTimeout(R),R=setTimeout((function(){a.BB.css(E,{opacity:"1"})}),20),clearTimeout(M)}})),a.BB.setEventListener(i.thumb,"onpointerout",(function(){clearTimeout(R),a.BB.css(E,{opacity:"0"}),clearTimeout(M),M=setTimeout((function(){P&&(document.body.removeChild(E),P=!1)}),300)})),l.appendChild(i.thumb),l.appendChild(i.label),l.appendChild(i.opacityLabel),l.appendChild(f.getEl());var v=!1,m=!1;i.pointerListener=new a.BB.PointerListener({target:l,maxPointers:1,onPointer:function(e){if("pointerdown"===e.type&&"left"===e.button)a.BB.css(i,{transition:"box-shadow 0.3s ease-in-out"}),i.style.zIndex="1",J=i.spot,m=!1,i.isSelected||(m=!0,N.activateLayer(i.spot)),v=!0;else if("pointermove"===e.type&&"left"===e.button){v&&(v=!1,a.BB.css(i,{boxShadow:"1px 3px 5px rgba(0,0,0,0.4)"})),i.posY+=e.dY;var t=Math.max(0,Math.min(35*(D.length-1),i.posY));i.style.top=t+"px",B(i.spot,w(i.posY))}if("pointerup"===e.type){a.BB.css(i,{transition:"all 0.1s linear"}),setTimeout((function(){a.BB.css(i,{boxShadow:""})}),20),i.posY=Math.max(0,Math.min(35*(D.length-1),i.posY)),i.style.zIndex="";var n=w(i.posY),r=i.spot;C(i.spot,n),r!=n&&(s.klHistory.pause(!0),I(G),s.klHistory.pause(!1)),r===n&&m&&I(G),m=!1}}}),z.appendChild(i)}for(i=s.klHistory.getState(),L=[];z.firstChild;){var t=z.firstChild;t.pointerListener.destroy(),t.opacitySlider.destroy(),z.removeChild(t)}for(var n=0;n<D.length;n++)e(n);N.activateLayer(G),S()},w=function(e){var t=parseInt(""+(e/(A+T)+.5));return t=Math.min(D.length-1,Math.max(0,t)),t=D.length-t-1},B=function(e,t){if((t=Math.min(D.length-1,Math.max(0,t)))!==J){for(var n=0;n<D.length;n++)if(L[n].spot!==e){var r=L[n].spot;L[n].spot>e&&r--,r>=t&&r++,L[n].posY=(A+T)*(D.length-r-1),L[n].style.top=L[n].posY+"px"}J=t}},C=function(e,t){if(isNaN(e)||isNaN(t))throw"layermanager - invalid move";for(var n=0;n<D.length;n++)!function(n){var r=L[n].spot;L[n].spot===e?r=t:(L[n].spot>e&&r--,r>=t&&r++),L[n].spot=r,L[n].posY=(A+T)*(D.length-r-1),L[n].style.top=L[n].posY+"px"}(n);e!==t&&(k.moveLayer(G,t-e),D=k.getLayers(),G=t,K.disabled=0===G)},S=function(){z.style.height=35*L.length+"px"},k=t,L=[],A=35,T=0,I=n,E=a.BB.el({onClick:a.BB.handleClick,css:{position:"absolute",right:"280px",top:"500px",background:"#aaa",boxShadow:"1px 1px 3px rgba(0,0,0,0.3)",pointerEvents:"none",padding:"0",border:"1px solid #aaa",transition:"opacity 0.3s ease-out",userSelect:"none",colorScheme:"only light"}});a.BB.createCheckerDataUrl(4,(function(e){E.style.backgroundImage="url("+e+")"}));var M,R,O=a.BB.canvas(200,200);O.style.display="block",E.appendChild(O);var P=!1,D=k.getLayers(),G=D.length-1,N=document.createElement("div");N.style.marginRight="10px",N.style.marginBottom="10px",N.style.marginLeft="10px",N.style.marginTop="10px",N.style.cursor="default";var j=document.createElement("div");a.BB.css(j,{width:"250px",position:"relative"});var z=a.BB.el({});N.disableButtons=function(){},N.enableButtons=function(){};var H,U,X,F=document.createElement("button"),W=document.createElement("button"),K=document.createElement("button"),V=document.createElement("button"),Y=document.createElement("button");N.appendChild((H=document.createElement("div"),setTimeout((function(){a.BB.makeUnfocusable(F),a.BB.makeUnfocusable(W),a.BB.makeUnfocusable(K),a.BB.makeUnfocusable(V),a.BB.makeUnfocusable(Y),F.style.cssFloat="left",W.style.cssFloat="left",K.style.cssFloat="left",V.style.cssFloat="left",Y.style.cssFloat="left",F.title=m.LANG("layers-new"),W.title=m.LANG("layers-duplicate"),V.title=m.LANG("layers-remove"),K.title=m.LANG("layers-merge"),Y.title=m.LANG("layers-rename-title"),F.style.paddingLeft="5px",F.style.paddingRight="3px",V.style.paddingLeft="5px",V.style.paddingRight="3px",W.style.paddingLeft="5px",W.style.paddingRight="3px",K.style.paddingLeft="5px",K.style.paddingRight="3px",Y.style.height="30px",Y.style.lineHeight="20px",F.innerHTML="<img src='"+e(h)+"' height='20'/>",W.innerHTML="<img src='"+e(p)+"' height='20'/>",K.innerHTML="<img src='"+e(d)+"' height='20'/>",V.innerHTML="<img src='"+e(g)+"' height='20'/>",Y.innerHTML="<img src='"+e(f)+"' height='20'/>",F.style.marginRight="5px",V.style.marginRight="5px",W.style.marginRight="5px",K.style.marginRight="5px",H.appendChild(F),H.appendChild(V),H.appendChild(W),H.appendChild(K),H.appendChild(Y),H.appendChild(a.BB.el({css:{clear:"both"}}));var t=document.createElement("div");t.style.clear="both",t.style.height="10px",H.appendChild(t),F.onclick=function(){!1!==k.addLayer(G)&&((D=k.getLayers()).length===v.MAX_LAYERS&&(F.disabled=!0,W.disabled=!0),V.disabled=!1,G+=1,b(),s.klHistory.pause(!0),I(G),s.klHistory.pause(!1))},W.onclick=function(){!1!==k.duplicateLayer(G)&&((D=k.getLayers()).length===v.MAX_LAYERS&&(F.disabled=!0,W.disabled=!0),V.disabled=!1,G++,b(),s.klHistory.pause(!0),I(G),s.klHistory.pause(!1))},V.onclick=function(){L.length<=1||(k.removeLayer(G),G>0&&G--,D=k.getLayers(),b(),s.klHistory.pause(!0),I(G),s.klHistory.pause(!1),1===D.length&&(V.disabled=!0),D.length<v.MAX_LAYERS&&(F.disabled=!1,W.disabled=!1))},K.onclick=function(){G<=0||function(e){var t=document.createElement("div");t.innerHTML=m.LANG("layers-merge-description");var n=new l.Options({optionArr:[{id:e.mixModeStr,label:y.translateBlending(e.mixModeStr)},{id:"source-in",label:"source-in"},{id:"source-out",label:"source-out"},{id:"source-atop",label:"source-atop"},{id:"destination-in",label:"destination-in"},{id:"destination-out",label:"destination-out"},{id:"destination-atop",label:"destination-atop"},{id:"xor",label:"xor"}],initId:e.mixModeStr,onChange:function(e){h()},isSmall:!0});n.getElement().style.marginTop="5px",t.appendChild(n.getElement());var i=a.BB.fitInto(e.topCanvas.width,e.topCanvas.height,200,200,1),s=a.BB.canvas(i.width,i.height);s.title=m.LANG("preview");var c=document.createElement("div");c.innerHTML="<br/>",c.style.clear="both",t.appendChild(c),t.appendChild(s),a.BB.css(s,{display:"block",marginLeft:"auto",marginRight:"auto",colorScheme:"only light"}),s.style.boxShadow="0 0 3px rgba(0,0,0,0.5)",a.BB.createCheckerDataUrl(4,(function(e){s.style.backgroundImage="url("+e+")"}));var u=a.BB.copyCanvas(s);function h(){var t=s.getContext("2d");t.save(),t.clearRect(0,0,s.width,s.height),s.width>e.topCanvas.width&&(t.imageSmoothingEnabled=!1),t.drawImage(e.bottomCanvas,0,0,s.width,s.height),"as-alpha"===n.getValue()?(t.globalCompositeOperation="destination-in",t.globalAlpha=e.topOpacity,t.drawImage(u,0,0,s.width,s.height)):(t.globalCompositeOperation=n.getValue(),t.globalAlpha=e.topOpacity,t.drawImage(e.topCanvas,0,0,s.width,s.height)),t.restore()}u.getContext("2d").drawImage(e.topCanvas,0,0,u.width,u.height),a.BB.convertToAlphaChannelCanvas(u),h();var p=new a.BB.KeyListener({onDown:function(e){"right"===e&&n.next(),"left"===e&&n.previous()}});o.popup({target:r,message:"<b>".concat(m.LANG("layers-merge-modal-title"),"</b>"),div:t,buttons:["Ok","Cancel"],clickOnEnter:"Ok",callback:function(t){p.destroy(),n.destroy(),"Ok"===t&&e.callback(n.getValue())}})}({topCanvas:D[G].context.canvas,bottomCanvas:D[G-1].context.canvas,topOpacity:k.getLayer(G).opacity,mixModeStr:D[G].mixModeStr,callback:function(e){k.mergeLayers(G,G-1,e),D=k.getLayers(),G--,1===D.length&&(V.disabled=!0),D.length<v.MAX_LAYERS&&(F.disabled=!1,W.disabled=!1),b(),s.klHistory.pause(!0),I(G),s.klHistory.pause(!1)}})},Y.onclick=function(){x(G)}}),1),H)),U=a.BB.el({content:m.LANG("layers-blending")+"&nbsp;",css:{fontSize:"15px"}}),X=new c.Select({optionArr:["source-over",null,"darken","multiply","color-burn",null,"lighten","screen","color-dodge",null,"overlay","soft-light","hard-light",null,"difference","exclusion",null,"hue","saturation","color","luminosity"].map((function(e){return e?[e,y.translateBlending(e)]:null})),onChange:function(e){k.setMixMode(G,e),N.update(G)},css:{marginBottom:"10px"}}),U.appendChild(X.getElement()),N.appendChild(U),j.appendChild(z),N.appendChild(j);var J=0;setInterval((function(){if("block"===N.style.display){var e=s.klHistory.getState();if(e!==i){i=e;for(var t=0;t<L.length;t++)if(G===L[t].spot&&D[L[t].spot]){var n=L[t].thumb.getContext("2d");n.save(),n.clearRect(0,0,n.canvas.width,n.canvas.height),D[L[t].spot].context.canvas.width<L[t].thumb.width&&(n.imageSmoothingEnabled=!1),n.drawImage(D[L[t].spot].context.canvas,0,0,L[t].thumb.width,L[t].thumb.height),n.restore()}}}}),1);return N.update=function(e){D=k.getLayers(),(e||0===e)&&(G=e),V.disabled=1===D.length,D.length===v.MAX_LAYERS?(F.disabled=!0,W.disabled=!0):(F.disabled=!1,W.disabled=!1),setTimeout((function(){b()}),1)},N.getSelected=function(){return G},N.activateLayer=function(e){if(e<0||e>L.length-1)throw"invalid spotIndex "+e+", layerElArr.length "+L.length;G=e,X.setValue(D[G].mixModeStr);for(var t=0;t<L.length;t++)G===L[t].spot?(L[t].style.backgroundColor="rgb( 250, 250, 250)",L[t].label.style.color="#000",L[t].style.boxShadow="",L[t].style.border="1px solid var(--active-highlight-color)",L[t].opacitySlider.setActive(!0),L[t].isSelected=!0):(L[t].style.backgroundColor="rgb( 220, 220, 220)",L[t].label.style.color="#666",L[t].style.boxShadow="",L[t].style.border="1px solid rgb(158, 158, 158)",L[t].opacitySlider.setActive(!1),L[t].isSelected=!1);K.disabled=0===G},N.setUiState=function(e){"left"===""+e?a.BB.css(E,{left:"280px",right:""}):a.BB.css(E,{left:"",right:"280px"})},b(),N}})),r.register("d42vI",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("1mb1v")})),r.register("dKwR8",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("11KJK")})),r.register("3VpTB",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("floUo")})),r.register("8yL1I",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("kino6")})),r.register("g91IK",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("hhQeq")})),r.register("705qg",(function(e,n){t(e.exports,"MAX_LAYERS",(function(){return d})),t(e.exports,"KlCanvas",(function(){return g}));var i=r("4gaLD"),a=r("eWjiX"),o=r("30Cml"),s=r("3ujzu"),l=r("h20yl"),c=r("gWfkn"),u=r("aSJRf"),h=r("1mH1z"),p=["source-over","darken","multiply","color-burn","lighten","screen","color-dodge","overlay","soft-light","hard-light","difference","exclusion","hue","saturation","color","luminosity"],d=16,g=function(){"use strict";function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(i.classCallCheck(this,e),this.layerNrOffset=n,this.layerCanvasArr=[],this.pickCanvas=a.BB.canvas(1,1),this.history=new c.DecoyKlHistory,"copy"in t?(this.width=1,this.height=1):"width"in t&&"height"in t?(this.width=t.width,this.height=t.height):(this.width=1,this.height=1),this.init(this.width,this.height),this.changeListenerArr=[],"copy"in t)try{this.copy(t.copy)}catch(e){throw this.destroy(),e}else if("projectObj"in t){var r=[].concat(t.projectObj.layers);if(this.init(t.projectObj.width,t.projectObj.height),!r.length)throw new Error("project.layers needs at least 1 layer");for(var o=0;o<r.length;o++){if(r[o].mixModeStr&&!p.includes(r[o].mixModeStr))throw new Error("unknown mixModeStr "+r[o].mixModeStr);this.addLayer(),this.layerOpacity(o,r[o].opacity),this.layerCanvasArr[o].name=r[o].name,this.layerCanvasArr[o].mixModeStr=r[o].mixModeStr?r[o].mixModeStr:"source-over",this.layerCanvasArr[o].getContext("2d").drawImage(r[o].image,0,0)}}this.updateIndices()}return i.createClass(e,[{key:"init",value:function(e,t){if(!e||!t||isNaN(e)||isNaN(t)||e<1||t<1)throw new Error("init - invalid canvas size");this.width=e,this.height=t}},{key:"emitChange",value:function(){this.changeListenerArr.forEach((function(e){return e()}))}},{key:"updateIndices",value:function(){this.layerCanvasArr.forEach((function(e,t){e.index=t}))}},{key:"setHistory",value:function(e){this.history=e}},{key:"reset",value:function(e){if(!e.width||!e.height||e.width<1||e.height<1||isNaN(e.width)||isNaN(e.height))throw new Error("invalid canvas size");if(this.history.pause(!0),this.width=e.width,this.height=e.height,this.layerCanvasArr.splice(1,Math.max(0,this.layerCanvasArr.length-1)),e.layers)for(var t=0;t<e.layers.length;t++){var n=e.layers[t];this.layerCanvasArr[t]||this.addLayer(),this.layerCanvasArr[t].name=n.name,this.layerCanvasArr[t].width=this.width,this.layerCanvasArr[t].height=this.height,this.layerCanvasArr[t].mixModeStr=n.mixModeStr?n.mixModeStr:"source-over",this.layerCanvasArr[t].getContext("2d").drawImage(n.image,0,0),this.layerOpacity(t,n.opacity)}else this.layerCanvasArr[0].name=e.layerName?e.layerName:h.LANG("layers-layer")+" 1",this.layerCanvasArr[0].width=this.width,this.layerCanvasArr[0].height=this.height,this.layerCanvasArr[0].mixModeStr="source-over",this.layerOpacity(0,1),e.color?this.layerFill(0,e.color):e.image&&this.layerCanvasArr[0].getContext("2d").drawImage(e.image,0,0);return this.updateIndices(),this.history.pause(!1),this.history.push({tool:["canvas"],action:"reset",params:[e]}),this.layerCanvasArr.length-1}},{key:"isLayerLimitReached",value:function(){return this.layerCanvasArr.length>=d}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"copy",value:function(e){if(e.getWidth()<1||e.getHeight()<1||isNaN(e.getWidth())||isNaN(e.getHeight()))throw new Error("invalid canvas size");for(var t=e.getLayers();this.layerCanvasArr.length>t.length;)this.removeLayer(this.layerCanvasArr.length-1);e.getWidth()==this.width&&e.getHeight()==this.height||this.init(e.getWidth(),e.getHeight());for(var n=0;n<t.length;n++)n>=this.layerCanvasArr.length?this.addLayer():(this.layerCanvasArr[n].width=this.width,this.layerCanvasArr[n].height=this.height),this.layerOpacity(n,t[n].opacity),this.layerCanvasArr[n].name=t[n].name,this.layerCanvasArr[n].mixModeStr=t[n].mixModeStr,this.layerCanvasArr[n].getContext("2d").drawImage(t[n].context.canvas,0,0);this.updateIndices()}},{key:"getLayerCount",value:function(){return this.layerCanvasArr.length}},{key:"resize",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"smooth";if(!e||!t||e===this.width&&t===this.height||isNaN(e)||isNaN(t)||e<1||t<1)return!1;if(e=Math.max(e,1),t=Math.max(t,1),"pixelated"===i){var o=(n=a.BB.canvas(e,t)).getContext("2d");o.imageSmoothingEnabled=!1;for(var s=0;s<this.layerCanvasArr.length;s++){s>0&&o.clearRect(0,0,e,t);var l=this.layerCanvasArr[s];o.drawImage(l,0,0,e,t),l.width=e,l.height=t;var c=l.getContext("2d");c.drawImage(n,0,0)}}else{if("smooth"!==i)throw new Error("unknown resize algorithm");n=a.BB.canvas(),r=a.BB.canvas();for(var u=0;u<this.layerCanvasArr.length;u++)a.BB.resizeCanvas(this.layerCanvasArr[u],e,t,n,r)}return this.width=e,this.height=t,!0}},{key:"resizeCanvas",value:function(e){var t=Math.round(e.left)+this.width+Math.round(e.right),n=Math.round(e.top)+this.height+Math.round(e.bottom),r=Math.round(e.left),i=Math.round(e.top);if(isNaN(t)||isNaN(n)||t<1||n<1)throw new Error("KlCanvas.resizeCanvas - invalid canvas size");for(var o=0;o<this.layerCanvasArr.length;o++){var s=a.BB.canvas(this.width,this.height),l=this.layerCanvasArr[o],c=this.layerCanvasArr[o].getContext("2d");s.getContext("2d").drawImage(l,0,0),this.layerCanvasArr[o].width=t,this.layerCanvasArr[o].height=n,c.save(),0===o&&e.fillColor&&(c.fillStyle=a.BB.ColorConverter.toRgbStr(e.fillColor),c.fillRect(0,0,t,n),c.clearRect(r,i,this.width,this.height)),c.drawImage(s,r,i),c.restore()}this.width=t,this.height=n}},{key:"addLayer",value:function(e){if(this.isLayerLimitReached())return!1;var t=a.BB.canvas(this.width,this.height);if(!t.getContext("2d"))throw new Error("kl-create-canvas-error");return t.mixModeStr="source-over",void 0===e?(this.layerCanvasArr[this.layerCanvasArr.length]=t,e=Math.max(0,this.layerCanvasArr.length-1)):(this.layerCanvasArr.splice(e+1,0,t),e++),t.name=h.LANG("layers-layer")+" "+(this.layerCanvasArr.length+this.layerNrOffset),this.history.pause(!0),this.layerOpacity(e,1),this.history.pause(!1),this.updateIndices(),this.history.push({tool:["canvas"],action:"addLayer",params:[e-1]}),e}},{key:"duplicateLayer",value:function(e){if(!this.layerCanvasArr[e]||this.isLayerLimitReached())return!1;var t=a.BB.canvas(this.width,this.height);return this.layerCanvasArr.splice(e+1,0,t),t.name=this.layerCanvasArr[e].name+" "+h.LANG("layers-copy"),t.mixModeStr=this.layerCanvasArr[e].mixModeStr,t.getContext("2d").drawImage(this.layerCanvasArr[e],0,0),this.history.pause(!0),this.layerOpacity(e+1,this.layerCanvasArr[e].opacity),this.history.pause(!1),this.updateIndices(),this.history.push({tool:["canvas"],action:"duplicateLayer",params:[e]}),e+1}},{key:"getLayerContext",value:function(e,t){if(this.layerCanvasArr[e])return this.layerCanvasArr[e].getContext("2d");if(t)return null;throw new Error("layer of index "+e+" not found (in "+this.layerCanvasArr.length+" layers)")}},{key:"removeLayer",value:function(e){return!!this.layerCanvasArr[e]&&(this.layerCanvasArr.splice(e,1),this.updateIndices(),this.history.push({tool:["canvas"],action:"removeLayer",params:[e]}),Math.max(0,e-1))}},{key:"renameLayer",value:function(e,t){return!!this.layerCanvasArr[e]&&(this.layerCanvasArr[e].name=t,this.history.push({tool:["canvas"],action:"renameLayer",params:[e,t]}),!0)}},{key:"layerOpacity",value:function(e,t){this.layerCanvasArr[e]&&(t=Math.max(0,Math.min(1,t)),this.layerCanvasArr[e].opacity=t,this.history.push({tool:["canvas"],action:"layerOpacity",params:[e,t]}),this.emitChange())}},{key:"moveLayer",value:function(e,t){if(0!==t&&this.layerCanvasArr[e]){var n=this.layerCanvasArr[e];this.layerCanvasArr.splice(e,1);var r=Math.max(0,Math.min(e+t,this.layerCanvasArr.length));return this.layerCanvasArr.splice(r,0,n),this.updateIndices(),this.history.push({tool:["canvas"],action:"moveLayer",params:[e,t]}),r}}},{key:"mergeLayers",value:function(e,t,n){if(this.layerCanvasArr[e]&&this.layerCanvasArr[t]&&e!==t){if(e>t){var r=e;e=t,t=r}var i=this.layerCanvasArr[t].opacity;if(0!==i&&i){var o=this.layerCanvasArr[e].getContext("2d");o.save(),"as-alpha"===n?(a.BB.convertToAlphaChannelCanvas(this.layerCanvasArr[t]),o.globalCompositeOperation="destination-in",o.globalAlpha=i,this.layerCanvasArr[e].getContext("2d").drawImage(this.layerCanvasArr[t],0,0)):(n&&(o.globalCompositeOperation=n),o.globalAlpha=i,this.layerCanvasArr[e].getContext("2d").drawImage(this.layerCanvasArr[t],0,0)),o.restore(),n&&(o.save(),o.fillStyle="rgba(0,0,0,0.01)",o.fillRect(-.9999999,-.9999999,1,1),o.restore())}return this.updateIndices(),this.history.pause(!0),this.removeLayer(t),this.history.pause(!1),this.history.push({tool:["canvas"],action:"mergeLayers",params:[e,t,n]}),e}}},{key:"rotate",value:function(e){for(;e<0;)e+=360;if((e%=360)%90==0&&0!==e){var t=a.BB.canvas();0===e||180===e?(t.width=this.width,t.height=this.height):90!==e&&270!==e||(t.width=this.height,t.height=this.width);for(var n=t.getContext("2d"),r=0;r<this.layerCanvasArr.length;r++)n.clearRect(0,0,t.width,t.height),n.save(),n.translate(t.width/2,t.height/2),n.rotate(e*Math.PI/180),180===e?n.drawImage(this.layerCanvasArr[r],-t.width/2,-t.height/2):90!==e&&270!==e||n.drawImage(this.layerCanvasArr[r],-t.height/2,-t.width/2),this.layerCanvasArr[r].width=t.width,this.layerCanvasArr[r].height=t.height,this.layerCanvasArr[r].getContext("2d").clearRect(0,0,this.layerCanvasArr[r].width,this.layerCanvasArr[r].height),this.layerCanvasArr[r].getContext("2d").drawImage(t,0,0),n.restore();this.width=t.width,this.height=t.height}}},{key:"flip",value:function(e,t,n){if(e||t){var r=a.BB.canvas(this.width,this.height);r.width=this.width,r.height=this.height;for(var i=r.getContext("2d"),o=0;o<this.layerCanvasArr.length;o++)(!n&&0!==n||o===n)&&(i.save(),i.clearRect(0,0,r.width,r.height),i.translate(r.width/2,r.height/2),i.scale(e?-1:1,t?-1:1),i.drawImage(this.layerCanvasArr[o],-r.width/2,-r.height/2),i.restore(),this.layerCanvasArr[o].getContext("2d").clearRect(0,0,this.layerCanvasArr[o].width,this.layerCanvasArr[o].height),this.layerCanvasArr[o].getContext("2d").drawImage(r,0,0))}}},{key:"layerFill",value:function(e,t,n){var r=this.layerCanvasArr[e].getContext("2d");r.save(),n&&(r.globalCompositeOperation=n),r.fillStyle="rgba("+t.r+","+t.g+","+t.b+",1)",r.fillRect(0,0,this.layerCanvasArr[e].width,this.layerCanvasArr[e].height),r.restore(),r.save(),r.fillStyle="rgba(0,0,0,0.01)",r.fillRect(-.9999999,-.9999999,1,1),r.restore(),this.history.push({tool:["canvas"],action:"layerFill",params:[e,t,n]})}},{key:"floodFill",value:function(e,t,n,r,i,s,l,c,u){if(!(t<0||n<0||t>=this.width||n>=this.height||0===i)){if(s=Math.round(s),!["above","current","all"].includes(l))throw new Error("invalid sampleStr");var h,p,d,g,f,v,m;if("all"===l){var y=1===this.layerCanvasArr.length?this.layerCanvasArr[0]:this.getCompleteCanvas(1);g=(d=(p=y.getContext("2d")).getImageData(0,0,this.width,this.height)).data,h=o.floodFillBits(g,this.width,this.height,t,n,s,Math.round(c),u),y=null,p=null,d=null,g=null,v=(f=this.layerCanvasArr[e].getContext("2d")).getImageData(0,0,this.width,this.height)}else{var x="above"===l?e+1:e;if(x>=this.layerCanvasArr.length)return;g=(d=(p=this.layerCanvasArr[x].getContext("2d")).getImageData(0,0,this.width,this.height)).data,h=o.floodFillBits(g,this.width,this.height,t,n,s,Math.round(c),u),e!==x&&(p=null,d=null,g=null),f=e===x?p:this.layerCanvasArr[e].getContext("2d"),v=e===x?d:f.getImageData(0,0,this.width,this.height)}if(m=v.data,1===i)for(var b=0;b<this.width*this.height;b++)255===h.data[b]&&(m[4*b]=r.r,m[4*b+1]=r.g,m[4*b+2]=r.b,m[4*b+3]=255);else for(var w=0;w<this.width*this.height;w++)255===h.data[w]&&(m[4*w]=a.BB.mix(m[4*w],r.r,i),m[4*w+1]=a.BB.mix(m[4*w+1],r.g,i),m[4*w+2]=a.BB.mix(m[4*w+2],r.b,i),m[4*w+3]=a.BB.mix(m[4*w+3],255,i));f.putImageData(v,0,0),this.history.push({tool:["canvas"],action:"replaceLayer",params:[e,v]})}}},{key:"drawShape",value:function(e,t){s.drawShape(this.layerCanvasArr[e].getContext("2d"),t),this.history.push({tool:["canvas"],action:"drawShape",params:[e,a.BB.copyObj(t)]})}},{key:"text",value:function(e,t){l.renderText(this.layerCanvasArr[e],a.BB.copyObj(t)),this.history.push({tool:["canvas"],action:"text",params:[e,a.BB.copyObj(t)]})}},{key:"replaceLayer",value:function(e,t){this.layerCanvasArr[e].getContext("2d").putImageData(t,0,0),this.history.push({tool:["canvas"],action:"replaceLayer",params:[e,t]})}},{key:"clearLayer",value:function(e){var t=this.layerCanvasArr[e].getContext("2d");t.save(),t.clearRect(0,0,this.layerCanvasArr[e].width,this.layerCanvasArr[e].height),t.restore(),this.history.push({tool:["canvas"],action:"clearLayer",params:[e]})}},{key:"getLayers",value:function(){return this.layerCanvasArr.map((function(e){return{context:e.getContext("2d"),opacity:e.opacity,name:e.name,mixModeStr:e.mixModeStr}}))}},{key:"getLayersFast",value:function(){return this.layerCanvasArr.map((function(e){return{canvas:e,opacity:e.opacity,name:e.name,mixModeStr:e.mixModeStr}}))}},{key:"getLayerIndex",value:function(e,t){for(var n=0;n<this.layerCanvasArr.length;n++)if(this.layerCanvasArr[n]===e)return n;if(!t)throw new Error("layer not found (in "+this.layerCanvasArr.length+" layers)");return null}},{key:"getLayer",value:function(e,t){if(this.layerCanvasArr[e])return{context:this.layerCanvasArr[e].getContext("2d"),opacity:this.layerCanvasArr[e].opacity,name:this.layerCanvasArr[e].name,id:e};if(!t)throw new Error("layer of index "+e+" not found (in "+this.layerCanvasArr.length+" layers)");return null}},{key:"getColorAt",value:function(e,t){e=Math.floor(e),t=Math.floor(t);var n=this.pickCanvas.getContext("2d");n.save(),n.imageSmoothingEnabled=!1,n.clearRect(0,0,1,1);for(var r=0;r<this.layerCanvasArr.length;r++)n.globalAlpha=this.layerCanvasArr[r].opacity,n.globalCompositeOperation=this.layerCanvasArr[r].mixModeStr,n.drawImage(this.layerCanvasArr[r],-e,-t);n.restore();var i=n.getImageData(0,0,1,1);return new a.BB.RGB(i.data[0],i.data[1],i.data[2])}},{key:"getCompleteCanvas",value:function(e){return u.drawProject(this.getProject(),e)}},{key:"getProject",value:function(){return{width:this.width,height:this.height,layers:this.layerCanvasArr.map((function(e){return{name:e.name,opacity:e.opacity,mixModeStr:e.mixModeStr,image:e}}))}}},{key:"addChangeListener",value:function(e){this.changeListenerArr.includes(e)||this.changeListenerArr.push(e)}},{key:"removeChangeListener",value:function(e){for(var t=0;t<this.changeListenerArr.length;t++)if(this.changeListenerArr[t]===e)return void this.changeListenerArr.splice(t,1)}},{key:"setMixMode",value:function(e,t){if(!this.layerCanvasArr[e])throw new Error("invalid layer");this.layerCanvasArr[e].mixModeStr=t,this.history.push({tool:["canvas"],action:"setMixMode",params:[e,""+t]})}},{key:"setComposite",value:function(e,t){if(!this.layerCanvasArr[e])throw new Error("invalid layer");this.layerCanvasArr[e].compositeObj=t}},{key:"destroy",value:function(){null!==this.layerCanvasArr&&(this.layerCanvasArr.forEach((function(e){a.BB.freeCanvas(e)})),this.layerCanvasArr=null)}}]),e}()})),r.register("30Cml",(function(e,n){function r(e,t,n,r,i,a){for(var o=n;o<=i;o++)for(var s=r;s<=a;s++)255!==e[s*t+o]&&(e[s*t+o]=254)}var i,a;function o(e,t,n,r,o){return i=n%e+r,a=Math.floor(n/e)+o,i<0||a<0||i>=e||a>=t?null:a*e+i}function s(e,t,n,r,i,a,o){return null!==o&&255!==t[o]&&((e[4*o]===i[0]&&e[4*o+1]===i[1]&&e[4*o+2]===i[2]&&e[4*o+3]===i[3]||a>0&&Math.abs(e[4*o]-i[0])<=a&&Math.abs(e[4*o+1]-i[1])<=a&&Math.abs(e[4*o+2]-i[2])<=a&&Math.abs(e[4*o+3]-i[3])<=a)&&(t[o]=255,!0))}function l(e,t,n,i,a,l,c,u){i=Math.round(i),a=Math.round(a);var h=new Uint8Array(new ArrayBuffer(t*n));return function(e,t,n,i,a,l,c,u,h){var p=[e[4*(l*n+a)],e[4*(l*n+a)+1],e[4*(l*n+a)+2],e[4*(l*n+a)+3]];if(h){var d,g,f=[];for(f.push(l*n+a),t[l*n+a]=255;f.length;)s(e,t,0,0,p,c,g=o(n,i,d=f.pop(),-1,0))&&f.push(g),s(e,t,0,0,p,c,g=o(n,i,d,1,0))&&f.push(g),s(e,t,0,0,p,c,g=o(n,i,d,0,-1))&&f.push(g),s(e,t,0,0,p,c,g=o(n,i,d,0,1))&&f.push(g)}else for(var v=0;v<n*i;v++)s(e,t,0,0,p,c,v);if(0!==u){for(var m=void 0,y=void 0,x=void 0,b=void 0,w=void 0,B=void 0,C=void 0,S=void 0,k=void 0,L=void 0,A=void 0,T=void 0,I=0;I<n;I++)for(var E=0;E<i;E++)255===t[E*n+I]&&(m=I,y=I,x=E,b=E,w=255!==t[E*n+I-1],B=255!==t[(E-1)*n+I-1],C=255!==t[(E-1)*n+I],S=255!==t[(E-1)*n+I+1],k=255!==t[E*n+I+1],L=255!==t[(E+1)*n+I+1],A=255!==t[(E+1)*n+I],T=255!==t[(E+1)*n+I-1],w&&(m=I-u),w&&B&&C&&(m=I-u,x=E-u),C&&(x=Math.min(x,E-u)),C&&S&&k&&(x=Math.min(x,E-u),y=I+u),k&&(y=Math.max(y,I+1*u)),k&&L&&A&&(y=Math.max(y,I+1*u),b=Math.max(b,E+1*u)),A&&(b=Math.max(b,E+1*u)),A&&T&&w&&(m=Math.min(m,I-1*u),b=Math.max(b,E+1*u)),(w||B||C||S||k||L||A||T)&&r(t,n,Math.max(0,m),Math.max(0,x),Math.min(n-1,y),Math.min(i-1,b)));for(var M=0;M<n*i;M++)254===t[M]&&(t[M]=255)}}(e,h,t,n,i,a,l,c,u),{data:h}}t(e.exports,"floodFillBits",(function(){return l}))})),r.register("3ujzu",(function(e,n){t(e.exports,"ShapeTool",(function(){return a})),t(e.exports,"drawShape",(function(){return o}));var i=r("eWjiX");function a(e){var t,n,r;this.onDown=function(e,i,a){t=e,n=i,r=a},this.onMove=function(i,a){e.onShape(!1,t,n,i,a,r)},this.onUp=function(i,a){e.onShape(!0,t,n,i,a,r)}}function o(e,t){if(!["rect","ellipse","line"].includes(t.type))throw new Error("unknown shape");var n=Math.round(t.lineWidth),r=180*t.angleRad/Math.PI;e.save(),t.opacity&&(e.globalAlpha=t.opacity),t.isEraser&&(e.globalCompositeOperation="destination-out"),e.rotate(-t.angleRad),t.fillRgb?e.fillStyle=i.BB.ColorConverter.toRgbStr(t.fillRgb):t.strokeRgb&&(e.strokeStyle=i.BB.ColorConverter.toRgbStr(t.strokeRgb),e.lineWidth=n);var a=t.x1,o=t.y1,s=t.x2,l=t.y2;if(t.isAngleSnap){var c=i.BB.rotate(a,o,t.angleRad/Math.PI*180),u=i.BB.rotate(s,l,t.angleRad/Math.PI*180),h=i.BB.pointsToAngleDeg(c,u)+90,p=45*Math.round(h/45),d=i.BB.rotateAround({x:a,y:o},{x:s,y:l},p-h);s=d.x,l=d.y,(r+p)%90==0&&(Math.round((r-p)/90)%2==0?s=a:l=o)}var g,f,v=a,m=o,y=s-a,x=l-o;if("line"!==t.type&&t.isFixedRatio){var b=i.BB.rotate(t.x1,t.y1,t.angleRad/Math.PI*180),w=i.BB.rotate(t.x2,t.y2,t.angleRad/Math.PI*180),B=b.x,C=b.y,S=w.x-b.x,k=w.y-b.y;Math.abs(S)<Math.abs(k)?k=Math.abs(S)*(k<0?-1:1):S=Math.abs(k)*(S<0?-1:1),w.x=B+S,w.y=C+k,b=i.BB.rotate(b.x,b.y,-t.angleRad/Math.PI*180),w=i.BB.rotate(w.x,w.y,-t.angleRad/Math.PI*180),v=a=b.x,m=o=b.y,y=(s=w.x)-a,x=(l=w.y)-o}if(t.isOutwards&&(a=v-=y,o=m-=x,s=v+(y*=2),l=m+(x*=2)),"line"===t.type){var L=Math.round(a),A=Math.round(o),T=Math.round(s),I=Math.round(l),E=Math.floor(a),M=Math.floor(o),R=Math.floor(s),O=Math.floor(l);n%2==0?A===I?(g={x:E,y:A},f={x:R,y:I},E<R?f.x+=1:g.x+=1):L===T?(g={x:L,y:M},f={x:T,y:O},M<O?f.y+=1:g.y+=1):(g={x:a,y:o},f={x:s,y:l}):(g={x:E,y:M},f={x:R,y:O},M===O?(E<R?f.x+=1:g.x+=1,g.y+=.5,f.y+=.5):E===R?(M<O?f.y+=1:g.y+=1,g.x+=.5,f.x+=.5):(g.x=a,g.y=o,f.x=s,f.y=l)),g=i.BB.rotate(g.x,g.y,t.angleRad/Math.PI*180),f=i.BB.rotate(f.x,f.y,t.angleRad/Math.PI*180),e.beginPath(),e.moveTo(g.x,g.y),e.lineTo(f.x,f.y),e.stroke()}else if("rect"===t.type){var P=Math.floor(a),D=Math.floor(o),G=Math.floor(s),N=Math.floor(l);r%90==0?t.fillRgb?(a%1==0&&(a+=1),o%1==0&&(o+=1),s%1==0&&(s+=1),l%1==0&&(l+=1),g={x:a<s?P:G,y:o<l?D:N},(f={x:Math.ceil((a<s?s:a)-g.x),y:Math.ceil((o<l?l:o)-g.y)}).x=g.x+f.x,f.y=g.y+f.y):n%2==0?(g={x:P,y:D},f={x:G,y:N}):(g={x:P+.5,y:D+.5},f={x:G+.5,y:N+.5}):(g={x:a,y:o},f={x:s,y:l}),g=i.BB.rotate(g.x,g.y,t.angleRad/Math.PI*180),(f=i.BB.rotate(f.x,f.y,t.angleRad/Math.PI*180)).x=f.x-g.x,f.y=f.y-g.y,t.fillRgb?e.fillRect(g.x,g.y,f.x,f.y):e.strokeRect(g.x,g.y,f.x,f.y)}else g=i.BB.rotate(a,o,t.angleRad/Math.PI*180),f=i.BB.rotate(s,l,t.angleRad/Math.PI*180),v=g.x,m=g.y,y=f.x-g.x,x=f.y-g.y,e.beginPath(),e.ellipse(v+y/2,m+x/2,Math.abs(y/2),Math.abs(x/2),0,0,2*Math.PI),t.fillRgb?e.fill():e.stroke();e.restore()}})),r.register("h20yl",(function(e,n){t(e.exports,"renderText",(function(){return a}));var i=r("eWjiX");function a(e,t){for(var n=""===t.textStr?" ":t.textStr,r=i.BB.el({css:{position:"fixed",left:"0",top:"0",width:"100000px",fontSize:t.size+"px",lineHeight:t.lineHeight?t.lineHeight+"px":"default"}}),a=i.BB.el({parent:r,css:{display:"inline-block",textAlign:t.align?t.align:"left",fontFamily:t.font?t.font:"sans-serif",fontSize:t.size+"px",fontWeight:t.isBold?"bold":"normal",fontStyle:t.isItalic?"italic":"normal",lineHeight:t.lineHeight?t.lineHeight+"px":"default",opacity:"0",pointerEvents:"none"}}),o="",s=0;s<n.length;s++)"\n"!==n[s]?o+=n[s].replace("\t","    "):(a.appendChild(i.BB.el({tagName:"span",textContent:o,css:{whiteSpace:"pre"}})),o="",a.appendChild(i.BB.el({tagName:"br"})));a.appendChild(i.BB.el({tagName:"span",textContent:o,css:{whiteSpace:"pre"}})),document.body.appendChild(r);for(var l={x0:99999999,y0:99999999,x1:0,y1:0},c=0;c<a.children.length;c++){var u=a.children[c];l.x0=Math.min(l.x0,u.offsetLeft),l.y0=Math.min(l.y0,u.offsetTop),l.x1=Math.max(l.x1,u.offsetLeft+u.offsetWidth),l.y1=Math.max(l.y1,u.offsetTop+u.offsetHeight)}var h=e.getContext("2d");h.save();var p=[];t.isItalic&&p.push("italic"),t.isBold&&p.push("bold"),p.push(t.size+"px "+(t.font?t.font:"sans-serif")),h.font=p.join(" "),h.fillStyle=t.color?t.color:"#000";var d=t.x,g=t.y;"right"===t.align&&(d+=-l.x1+l.x0),"center"===t.align&&(d+=(-l.x1+l.x0)/2),h.translate(t.x,t.y),h.rotate(t.angleRad?-t.angleRad:0),h.translate(-t.x,-t.y),h.translate(d,g);for(var f=0;f<a.children.length;f++){var v=a.children[f];h.fillText(v.innerText,v.offsetLeft,v.offsetTop)}return t.isDebug?(h.lineWidth=1,h.strokeRect(0,.85*-t.size,l.x1,l.y1),h.restore(),h.fillRect(t.x-1,t.y-1,2,2)):h.restore(),document.body.removeChild(r),{x:d-t.x,y:g-t.y-.85*t.size,width:l.x1-l.x0,height:l.y1-l.y0}}})),r.register("aSJRf",(function(e,n){t(e.exports,"drawProject",(function(){return a}));var i=r("eWjiX");function a(e,t){var n=i.BB.canvas(Math.max(1,Math.round(e.width*t)),Math.max(1,Math.round(e.height*t))),r=n.getContext("2d");r.save(),t>1&&(r.imageSmoothingEnabled=!1);for(var a=0;a<e.layers.length;a++)0!==e.layers[a].opacity&&(r.globalAlpha=e.layers[a].opacity,r.globalCompositeOperation=e.layers[a].mixModeStr?e.layers[a].mixModeStr:"source-over",r.drawImage(e.layers[a].image,0,0,n.width,n.height));return r.restore(),n}})),r.register("bBcC4",(function(e,n){t(e.exports,"translateBlending",(function(){return a}));var i=r("1mH1z");function a(e){if(!e)return i.LANG("layers-blend-normal");var t={"source-over":"layers-blend-normal",darken:"layers-blend-darken",multiply:"layers-blend-multiply","color-burn":"layers-blend-color-burn",lighten:"layers-blend-lighten",screen:"layers-blend-screen","color-dodge":"layers-blend-color-dodge",overlay:"layers-blend-overlay","soft-light":"layers-blend-soft-light","hard-light":"layers-blend-hard-light",difference:"layers-blend-difference",exclusion:"layers-blend-exclusion",hue:"layers-blend-hue",saturation:"layers-blend-saturation",color:"layers-blend-color",luminosity:"layers-blend-luminosity"};if(!(e in t))throw new Error("unknown blend mode");return i.LANG(t[e])}})),r.register("7bo3M",(function(e,n){t(e.exports,"WorkspaceSvgOverlay",(function(){return o}));var i=r("4gaLD"),a=r("eWjiX"),o=function(){"use strict";function e(t){i.classCallCheck(this,e),this.rootElement=a.BB.createSvg({elementType:"svg",width:""+t.width,height:""+t.height}),a.BB.css(this.rootElement,{position:"absolute",left:"0",top:"0",pointerEvents:"none",userSelect:"none"}),this.brushCircleOuter=a.BB.createSvg({elementType:"circle",r:"10",stroke:"rgba(0,0,0,0.7)","stroke-width":"1",fill:"none"}),this.brushCircleInner=a.BB.createSvg({elementType:"circle",r:"9",stroke:"rgba(255,255,255,0.7)","stroke-width":"1",fill:"none"}),this.rootElement.append(this.brushCircleOuter,this.brushCircleInner),this.pickerPreviewBorder=a.BB.createSvg({elementType:"circle",r:"47",stroke:"black","stroke-width":"22",fill:"none"}),this.pickerPreviewBorder.style.opacity="0",this.pickerPreviewCol=a.BB.createSvg({elementType:"circle",r:"47",stroke:"black","stroke-width":"20",fill:"none"}),this.pickerPreviewCol.style.opacity="0",this.rootElement.append(this.pickerPreviewBorder,this.pickerPreviewCol),this.compassSize=30,this.compass=a.BB.createSvg({elementType:"g",transform:"translate("+t.width/2+", "+t.height/2+")"}),a.BB.css(this.compass,{transition:"opacity 0.25s ease-in-out",opacity:"0"}),this.compassInner=a.BB.createSvg({elementType:"g",transform:"rotate(45)"}),this.compassBaseCircle=a.BB.createSvg({elementType:"circle",fill:"rgba(0,0,0,0.9)",stroke:"none",cx:"0",cy:"0",r:""+this.compassSize}),this.compassLineCircle=a.BB.createSvg({elementType:"circle",fill:"none",stroke:"rgba(255,255,255,0.75)","stroke-width":"1",cx:"0",cy:"0",r:""+.9*this.compassSize}),this.compassUpperTriangle=a.BB.createSvg({elementType:"path",fill:"#f00",stroke:"none",d:"M -"+.25*this.compassSize+",0 "+.25*this.compassSize+",0 0,-"+.9*this.compassSize+" z"}),this.compassLowerTriangle=a.BB.createSvg({elementType:"path",fill:"#fff",stroke:"none",d:"M -"+.25*this.compassSize+",0 "+.25*this.compassSize+",0 0,"+.9*this.compassSize+" z"}),this.compassInner.append(this.compassBaseCircle,this.compassLineCircle,this.compassUpperTriangle,this.compassLowerTriangle),this.compass.append(this.compassInner),this.rootElement.append(this.compass)}return i.createClass(e,[{key:"getElement",value:function(){return this.rootElement}},{key:"setSize",value:function(e,t){this.rootElement.setAttribute("width",""+e),this.rootElement.setAttribute("height",""+t),this.compass.setAttribute("transform","translate("+e/2+", "+t/2+")")}},{key:"updateCursor",value:function(e){"x"in e&&(this.brushCircleOuter.setAttribute("cx",""+e.x),this.brushCircleInner.setAttribute("cx",""+e.x)),"y"in e&&(this.brushCircleOuter.setAttribute("cy",""+e.y),this.brushCircleInner.setAttribute("cy",""+e.y)),"radius"in e&&(this.brushCircleOuter.setAttribute("r",""+Math.max(0,e.radius)),this.brushCircleInner.setAttribute("r",""+Math.max(0,e.radius-1))),"isVisible"in e&&(this.brushCircleOuter.style.opacity=e.isVisible?"1":"0",this.brushCircleInner.style.opacity=e.isVisible?"1":"0")}},{key:"updateColorPreview",value:function(e){if("x"in e&&(this.pickerPreviewCol.setAttribute("cx",""+e.x),this.pickerPreviewBorder.setAttribute("cx",""+e.x)),"y"in e&&(this.pickerPreviewCol.setAttribute("cy",""+e.y),this.pickerPreviewBorder.setAttribute("cy",""+e.y)),"color"in e){this.pickerPreviewCol.setAttribute("stroke",a.BB.ColorConverter.toRgbStr(e.color));var t=a.BB.testIsWhiteBestContrast(e.color)?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.5)";this.pickerPreviewBorder.setAttribute("stroke",t)}"isVisible"in e&&(this.pickerPreviewCol.style.opacity=e.isVisible?"1":"0",this.pickerPreviewBorder.style.opacity=e.isVisible?"1":"0")}},{key:"updateCompass",value:function(e){"angleDeg"in e&&(this.compassInner.setAttribute("transform","rotate("+e.angleDeg+")"),this.compassLineCircle.style.opacity=e.angleDeg%90==0?"1":"0"),"isVisible"in e&&(this.compass.style.opacity=e.isVisible?"1":"0")}}]),e}()})),r.register("lV6Vy",(function(n,i){t(n.exports,"KlCanvasWorkspace",(function(){return v}));var a,o,s=r("4gaLD"),l=r("eWjiX"),c=r("7bo3M"),u=r("gWfkn"),h=r("hNEwm"),p=r("iOLNv"),d=r("3zTyb"),g=r("kFdtJ"),f=.0625;(o=a||(a={}))[o.Draw=0]="Draw",o[o.Hand=1]="Hand",o[o.HandGrabbing=2]="HandGrabbing",o[o.Pick=3]="Pick",o[o.Zoom=4]="Zoom",o[o.Rotate=5]="Rotate",o[o.Rotating=6]="Rotating",o[o.Fill=7]="Fill",o[o.Text=8]="Text",o[o.Shape=9]="Shape";var v=function(){"use strict";function t(e){var n=this;s.classCallCheck(this,t);var r=this;this.rootEl=l.BB.el({css:{position:"absolute",left:"0",right:"0",top:"0",bottom:"0",cursor:"crosshair",userSelect:"none",colorScheme:"only light"}}),this.klCanvas=e.klCanvas,this.onViewChange=e.onViewChange,this.renderTargetCanvas=l.BB.canvas(e.width,e.height),this.renderTargetCtx=this.renderTargetCanvas.getContext("2d"),this.renderWidth=e.width,this.renderHeight=e.height,this.compositeCanvas=l.BB.canvas(1,1),this.compositeCtx=this.compositeCanvas.getContext("2d"),this.doResizeCanvas=!1,this.oldTransformObj=null,this.targetTransformObj={x:0,y:0,scale:1,angle:0},this.highResTransformObj={x:0,y:0,scale:1,angle:0},this.renderedTransformObj={x:null,y:null,scale:null,angle:null},this.cursorPos={x:0,y:0},this.usesCssCursor=!1,this.bgVisible=!0,this.transformIsDirty=!0,this.doAnimateTranslate=!0,this.svgOverlay=new c.WorkspaceSvgOverlay({width:e.width,height:e.height}),l.BB.css(this.renderTargetCanvas,{userSelect:"none",pointerEvents:"none"}),l.BB.createCheckerDataUrl(8,(function(e){n.renderTargetCanvas.style.background="url("+e+")"})),this.rootEl.appendChild(this.renderTargetCanvas),this.rootEl.appendChild(this.svgOverlay.getElement()),l.BB.addEventListener(this.rootEl,"touchend",(function(e){return e.preventDefault(),!1})),l.BB.addEventListener(this.rootEl,"contextmenu",(function(e){return e.preventDefault(),!1})),l.BB.addEventListener(this.rootEl,"dragstart",(function(e){return e.preventDefault(),!1})),this.emptyCanvas=l.BB.canvas(1,1),this.emptyCanvas.getContext("2d").fillRect(0,0,1,1),this.keyListener=new l.BB.KeyListener({onDown:function(e,t,r,i){if("alt"===e&&t.preventDefault(),!i)if(n.currentInputProcessor)n.currentInputProcessor.onKeyDown(e,t,r,i);else{if([a.Draw,a.Pick,a.Fill,a.Text,a.Shape].includes(n.globalMode)&&"space"===r)return n.currentInputProcessor=n.inputProcessorObj.spaceHand,void n.currentInputProcessor.onKeyDown(e,t,r,i);if([a.Draw,a.Hand,a.Fill,a.Text,a.Shape].includes(n.globalMode)&&"alt"===r)return n.currentInputProcessor=n.inputProcessorObj.altPicker,void n.currentInputProcessor.onKeyDown(e,t,r,i);if(["r","shift+r"].includes(r))return n.currentInputProcessor=n.inputProcessorObj.rotate,void n.currentInputProcessor.onKeyDown(e,t,r,i);if("z"===r)return n.currentInputProcessor=n.inputProcessorObj.zoom,void n.currentInputProcessor.onKeyDown(e,t,r,i)}},onUp:function(e,t,r){n.currentInputProcessor&&n.currentInputProcessor.onKeyUp(e,t,r)}}),this.updateChangeListener(),this.currentMode=a.Draw,this.globalMode=a.Draw,this.renderTime=0,this.lastDrawEvent=null,this.linetoolProcessor=new l.BB.EventChain.LinetoolProcessor({onDraw:function(t){var r=n,i=function(){var e=r.getRenderedTransform(),t=l.BB.Matrix.getIdentity();return t=l.BB.Matrix.multiplyMatrices(t,l.BB.Matrix.createScaleMatrix(1/e.scale)),t=l.BB.Matrix.multiplyMatrices(t,l.BB.Matrix.createRotationMatrix(-e.angle)),t=l.BB.Matrix.multiplyMatrices(t,l.BB.Matrix.createTranslationMatrix(-e.x,-e.y))};if("line"===t.type&&!n.lastDrawEvent){var a=i(),o=[t.x1,t.y1,0,1];return o=l.BB.Matrix.multiplyMatrixAndPoint(a,o),void(n.lastDrawEvent={x:o[0],y:o[1],pressure:t.pressure1})}if("x"in t||"x0"in t){var s=i();if("x"in t){var c=[t.x,t.y,0,1];c=l.BB.Matrix.multiplyMatrixAndPoint(s,c),t.x=c[0],t.y=c[1]}if("x0"in t){t.x0=n.lastDrawEvent.x,t.y0=n.lastDrawEvent.y,t.pressure0=n.lastDrawEvent.pressure;var u=[t.x1,t.y1,0,1];u=l.BB.Matrix.multiplyMatrixAndPoint(s,u),t.x1=u[0],t.y1=u[1],n.lastDrawEvent={x:t.x1,y:t.y1,pressure:t.pressure1}}}["down","move"].includes(t.type)&&(n.lastDrawEvent=t),e.onDraw(t)}}),this.pointer=null,this.isDrawing=!1,this.inputProcessorObj={draw:{onPointer:function(e){n.reqFrame(),n.updateCursor(a.Draw);var t=n.keyListener.getComboStr(),r={scale:n.highResTransformObj.scale};if(r.shiftIsPressed="shift"===t,r.pressure=e.pressure,r.isCoalesced=!!e.isCoalesced,"pointerdown"===e.type)n.isDrawing=!0,r.type="down";else{if(!e.button)return"pointerup"===e.type?(n.isDrawing=!1,r.type="up",n.linetoolProcessor.process(r),void n.resetInputProcessor()):void 0;r.type="move"}r.x=e.relX,r.y=e.relY,n.linetoolProcessor.process(r)},onKeyDown:function(e,t,n,r){},onKeyUp:function(e,t,n){}},fill:{onPointer:function(t){if(n.reqFrame(),n.updateCursor(a.Fill),"pointerdown"===t.type){var r=n.workspaceToCanvasCoord({x:t.relX,y:t.relY});e.onFill(Math.floor(r.x),Math.floor(r.y))}else if("pointerup"===t.type)return void n.resetInputProcessor()},onKeyDown:function(e,t,n,r){},onKeyUp:function(e,t,n){}},text:{onPointer:function(t){if(n.reqFrame(),n.updateCursor(a.Text),"pointerdown"===t.type){var r=n.workspaceToCanvasCoord({x:t.relX,y:t.relY});e.onText(Math.floor(r.x),Math.floor(r.y),n.renderedTransformObj.angle)}else if("pointerup"===t.type)return void n.resetInputProcessor()},onKeyDown:function(e,t,n,r){},onKeyUp:function(e,t,n){}},shape:{onPointer:function(t){n.reqFrame(),n.updateCursor(a.Shape);var r=n.workspaceToCanvasCoord({x:t.relX,y:t.relY});"pointerdown"===t.type?(n.isDrawing=!0,e.onShape("down",r.x,r.y,n.renderedTransformObj.angle)):"pointermove"===t.type?e.onShape("move",r.x,r.y,n.renderedTransformObj.angle):"pointerup"===t.type&&(n.isDrawing=!1,e.onShape("up",r.x,r.y,n.renderedTransformObj.angle),n.resetInputProcessor())},onKeyDown:function(e,t,n,r){},onKeyUp:function(e,t,n){}},hand:{onPointer:function(e){n.updateCursor(a.Hand),["left","middle"].includes(e.button)?(n.updateCursor(a.HandGrabbing),n.targetTransformObj.x+=e.dX,n.targetTransformObj.y+=e.dY,n.highResTransformObj=JSON.parse(JSON.stringify(n.targetTransformObj)),n.doAnimateTranslate=!1,n.transformIsDirty=!0,n.reqFrame(!0)):"pointerup"===e.type&&n.resetInputProcessor()},onKeyDown:function(e,t,n,r){},onKeyUp:function(e,t,n){}},spaceHand:{onPointer:function(e){n.updateCursor(a.Hand),["left","middle"].includes(e.button)&&(n.updateCursor(a.HandGrabbing),n.targetTransformObj.x+=e.dX,n.targetTransformObj.y+=e.dY,n.highResTransformObj=JSON.parse(JSON.stringify(n.targetTransformObj)),n.doAnimateTranslate=!1,n.transformIsDirty=!0,n.reqFrame(!0))},onKeyDown:function(e,t,r,i){"space"!==r?n.resetInputProcessor():n.updateCursor(a.Hand)},onKeyUp:function(e,t,r){n.resetInputProcessor()}},zoom:{onPointer:function(e){if(n.updateCursor(a.Zoom),"left"===e.button&&!e.isCoalesced&&0!=e.dX){var t=e.pageX-e.relX,r=e.pageY-e.relY;n.internalZoomByStep(e.dX/175,e.downPageX-t,e.downPageY-r),n.highResTransformObj=JSON.parse(JSON.stringify(n.targetTransformObj)),n.lastRenderedState=-1,n.reqFrame(),n.onViewChange({changed:["scale"],angle:n.targetTransformObj.angle,scale:n.targetTransformObj.scale})}},onKeyDown:function(e,t,r,i){"z"!==r?n.resetInputProcessor():n.updateCursor(a.Zoom)},onKeyUp:function(e,t,r){n.resetInputProcessor()}},picker:{onPointer:function(t){if(n.updateCursor(a.Pick),["left","right"].includes(t.button)&&!t.isCoalesced||"pointerup"===t.type){var r=n.workspaceToCanvasCoord({x:t.relX,y:t.relY}),i=n.klCanvas.getColorAt(r.x,r.y);e.onPick(i,"pointerup"===t.type),n.svgOverlay.updateColorPreview({x:t.relX,y:t.relY,color:i,isVisible:"pointerup"!==t.type}),"pointerup"===t.type&&n.resetInputProcessor()}},onKeyDown:function(e,t,n,r){},onKeyUp:function(e,t,n){}},altPicker:{onPointer:function(t){if(n.updateCursor(a.Pick),["left","right"].includes(t.button)&&!t.isCoalesced||"pointerup"===t.type){var r=n.workspaceToCanvasCoord({x:t.relX,y:t.relY}),i=n.klCanvas.getColorAt(r.x,r.y);e.onPick(i,"pointerup"===t.type),n.svgOverlay.updateColorPreview({x:t.relX,y:t.relY,color:i,isVisible:"pointerup"!==t.type})}},onKeyDown:function(e,t,r,i){"alt"!==r?n.resetInputProcessor():n.updateCursor(a.Pick)},onKeyUp:function(e,t,r){n.resetInputProcessor()}},rotate:{onPointer:function(e){if(n.updateCursor("left"===e.button?a.Rotating:a.Rotate),"pointerdown"===e.type&&"left"===e.button)n.oldTransformObj=JSON.parse(JSON.stringify(n.targetTransformObj));else if("left"===e.button&&!e.isCoalesced&&n.oldTransformObj){var t=e.pageX-e.relX,r=e.pageY-e.relY,i={x:n.renderWidth/2,y:n.renderHeight/2},o=l.BB.Vec2.angle(i,{x:e.downPageX-t,y:e.downPageY-r}),s=l.BB.Vec2.angle(i,{x:e.pageX-t,y:e.pageY-r})-o;n.targetTransformObj=JSON.parse(JSON.stringify(n.oldTransformObj)),n.targetTransformObj.angle+=s,n.keyListener.isPressed("shift")&&(n.targetTransformObj.angle=Math.round(n.targetTransformObj.angle/Math.PI*8)*Math.PI/8,s=n.targetTransformObj.angle-n.oldTransformObj.angle),n.targetTransformObj.angle=n.minimizeAngleRad(n.targetTransformObj.angle);var c=l.BB.Matrix.getIdentity();c=l.BB.Matrix.multiplyMatrices(c,l.BB.Matrix.createTranslationMatrix(i.x,i.y)),c=l.BB.Matrix.multiplyMatrices(c,l.BB.Matrix.createRotationMatrix(s)),c=l.BB.Matrix.multiplyMatrices(c,l.BB.Matrix.createTranslationMatrix(-i.x,-i.y));var u=[n.targetTransformObj.x,n.targetTransformObj.y,0,1];u=l.BB.Matrix.multiplyMatrixAndPoint(c,u),n.targetTransformObj.x=u[0],n.targetTransformObj.y=u[1],n.highResTransformObj=JSON.parse(JSON.stringify(n.targetTransformObj)),n.transformIsDirty=!0,n.lastRenderedState=-1,n.reqFrame(),n.onViewChange({changed:["angle"],scale:n.targetTransformObj.scale,angle:n.targetTransformObj.angle})}},onKeyDown:function(e,t,r,i){["r","r+shift","shift+r","r+left","r+right","r+left+right","r+right+left","r+up"].includes(r)?n.updateCursor(a.Rotate):n.resetInputProcessor()},onKeyUp:function(e,t,r){var i=n.keyListener.getComboStr();["r","r+shift","shift+r","r+left","r+right","r+left+right","r+right+left","r+up"].includes(i)?n.updateCursor(a.Rotate):n.resetInputProcessor()}}},this.currentInputProcessor=null,this.angleIsExtraSticky=!1,this.pinchZoomer=new l.BB.EventChain.PinchZoomer({onPinch:function(e){if("move"===e.type){n.oldTransformObj||(n.oldTransformObj=JSON.parse(JSON.stringify(n.targetTransformObj)),n.angleIsExtraSticky=n.targetTransformObj.angle%(Math.PI/2)==0),n.targetTransformObj=JSON.parse(JSON.stringify(n.oldTransformObj)),e.scale=Math.max(f,Math.min(64,n.targetTransformObj.scale*e.scale))/n.targetTransformObj.scale,n.targetTransformObj.scale*=e.scale,n.targetTransformObj.angle+=e.angleRad,n.targetTransformObj.angle=n.minimizeAngleRad(n.snapAngleRad(n.targetTransformObj.angle,90,n.angleIsExtraSticky?12:4)),n.targetTransformObj.angle%(Math.PI/2)!=0&&(n.angleIsExtraSticky=!1),e.angleRad=n.targetTransformObj.angle-n.oldTransformObj.angle;var t=l.BB.Matrix.getIdentity();t=l.BB.Matrix.multiplyMatrices(t,l.BB.Matrix.createTranslationMatrix(e.relX,e.relY)),t=l.BB.Matrix.multiplyMatrices(t,l.BB.Matrix.createScaleMatrix(e.scale)),t=l.BB.Matrix.multiplyMatrices(t,l.BB.Matrix.createRotationMatrix(e.angleRad)),t=l.BB.Matrix.multiplyMatrices(t,l.BB.Matrix.createTranslationMatrix(-e.relX,-e.relY)),t=l.BB.Matrix.multiplyMatrices(t,l.BB.Matrix.createTranslationMatrix(e.relX-e.downRelX,e.relY-e.downRelY));var r=[n.targetTransformObj.x,n.targetTransformObj.y,0,1];r=l.BB.Matrix.multiplyMatrixAndPoint(t,r),n.targetTransformObj.x=r[0],n.targetTransformObj.y=r[1],n.highResTransformObj=l.BB.copyObj(n.targetTransformObj),n.onViewChange({changed:["scale","angle"],scale:n.targetTransformObj.scale,angle:n.targetTransformObj.angle}),n.reqFrame(),n.transformIsDirty=!0,n.lastRenderedState=-1}else"end"===e.type&&(n.oldTransformObj=null)}});var i=function(){var e=JSON.parse(JSON.stringify(n.targetTransformObj));r.fitView(),n.lastRenderedState=-1,n.reqFrame(),e.scale===n.targetTransformObj.scale&&e.angle===n.targetTransformObj.angle||n.onViewChange({changed:["scale","angle"],angle:n.targetTransformObj.angle,scale:n.targetTransformObj.scale})};this.mainDoubleTapper=new l.BB.EventChain.DoubleTapper({onDoubleTap:i}),this.middleDoubleTapper=new l.BB.EventChain.DoubleTapper({onDoubleTap:i}),this.middleDoubleTapper.setAllowedButtonArr(["middle"]),this.twoFingerTap=new l.BB.EventChain.NFingerTapper({fingers:2,onTap:function(){e.onUndo()}}),this.threeFingerTap=new l.BB.EventChain.NFingerTapper({fingers:3,onTap:function(){e.onRedo()}}),this.pointerEventChain=new l.BB.EventChain.EventChain({chainArr:[this.twoFingerTap,this.threeFingerTap,this.mainDoubleTapper,this.middleDoubleTapper,this.pinchZoomer,new l.BB.EventChain.OnePointerLimiter,new l.BB.EventChain.CoalescedExploder]}),this.pointerEventChain.setChainOut((function(e){if(n.cursorPos.x=e.relX,n.cursorPos.y=e.relY,"pointerup"===e.type&&"touch"===e.pointerType?(n.pointer=null,n.lastRenderedState=-1,n.reqFrame()):(n.pointer||(n.pointer={x:0,y:0}),n.pointer.x=e.relX,n.pointer.y=e.relY),n.currentInputProcessor)n.currentInputProcessor.onPointer(e);else{var t=n.keyListener.getComboStr();n.globalMode===a.Draw?["","shift","ctrl"].includes(t)&&"pointerdown"===e.type&&"left"===e.button?(n.currentInputProcessor=n.inputProcessorObj.draw,n.currentInputProcessor.onPointer(e)):[""].includes(t)&&"pointerdown"===e.type&&"right"===e.button?(n.currentInputProcessor=n.inputProcessorObj.picker,n.currentInputProcessor.onPointer(e)):[""].includes(t)&&"pointerdown"===e.type&&"middle"===e.button?(n.currentInputProcessor=n.inputProcessorObj.hand,n.currentInputProcessor.onPointer(e)):(n.updateCursor(a.Draw),n.reqFrame()):n.globalMode===a.Hand?"pointerdown"===e.type&&["left","middle"].includes(e.button)?(n.currentInputProcessor=n.inputProcessorObj.hand,n.currentInputProcessor.onPointer(e)):[""].includes(t)&&"pointerdown"===e.type&&"right"===e.button?(n.currentInputProcessor=n.inputProcessorObj.picker,n.currentInputProcessor.onPointer(e)):n.updateCursor(a.Hand):n.globalMode===a.Pick?"pointerdown"===e.type&&["left","right"].includes(e.button)?(n.currentInputProcessor=n.inputProcessorObj.picker,n.currentInputProcessor.onPointer(e)):[""].includes(t)&&"pointerdown"===e.type&&"middle"===e.button?(n.currentInputProcessor=n.inputProcessorObj.hand,n.currentInputProcessor.onPointer(e)):n.updateCursor(a.Pick):n.globalMode===a.Fill?"pointerdown"===e.type&&"left"===e.button?(n.currentInputProcessor=n.inputProcessorObj.fill,n.currentInputProcessor.onPointer(e)):[""].includes(t)&&"pointerdown"===e.type&&"right"===e.button?(n.currentInputProcessor=n.inputProcessorObj.picker,n.currentInputProcessor.onPointer(e)):[""].includes(t)&&"pointerdown"===e.type&&"middle"===e.button?(n.currentInputProcessor=n.inputProcessorObj.hand,n.currentInputProcessor.onPointer(e)):(n.updateCursor(a.Fill),n.reqFrame()):n.globalMode===a.Text?"pointerdown"===e.type&&"left"===e.button?(n.currentInputProcessor=n.inputProcessorObj.text,n.currentInputProcessor.onPointer(e)):[""].includes(t)&&"pointerdown"===e.type&&"right"===e.button?(n.currentInputProcessor=n.inputProcessorObj.picker,n.currentInputProcessor.onPointer(e)):[""].includes(t)&&"pointerdown"===e.type&&"middle"===e.button?(n.currentInputProcessor=n.inputProcessorObj.hand,n.currentInputProcessor.onPointer(e)):(n.updateCursor(a.Text),n.reqFrame()):n.globalMode===a.Shape&&(["","shift","ctrl"].includes(t)&&"pointerdown"===e.type&&"left"===e.button?(n.currentInputProcessor=n.inputProcessorObj.shape,n.currentInputProcessor.onPointer(e)):[""].includes(t)&&"pointerdown"===e.type&&"right"===e.button?(n.currentInputProcessor=n.inputProcessorObj.picker,n.currentInputProcessor.onPointer(e)):[""].includes(t)&&"pointerdown"===e.type&&"middle"===e.button?(n.currentInputProcessor=n.inputProcessorObj.hand,n.currentInputProcessor.onPointer(e)):(n.updateCursor(a.Shape),n.reqFrame()))}})),l.BB.addEventListener(this.rootEl,"wheel",(function(e){e.preventDefault()})),setTimeout((function(){var e=n;n.pointerListener=new l.BB.PointerListener({target:n.rootEl,fixScribble:!0,onPointer:function(t){if("pointerdown"===t.type&&"middle"===t.button)try{t.eventPreventDefault()}catch(e){}e.pointerEventChain.chainIn(t)},onWheel:function(t){e.isDrawing||(e.reqFrame(),e.internalZoomByStep(-t.deltaY/(e.keyListener.isPressed("shift")?8:2),t.relX,t.relY)&&e.onViewChange({changed:["scale"],angle:e.targetTransformObj.angle,scale:e.targetTransformObj.scale}),e.lastRenderedState=-1)},onEnterLeave:function(t){t||e.isDrawing||(e.pointer=null,e.lastRenderedState=-1)},maxPointers:4})}),1),this.brushRadius=1,this.animationFrameRequested=!1,this.lastRenderedState=-2,this.lastRenderTime=performance.now(),window.requestAnimationFrame((function(){return n.updateLoop()})),this.resetView()}return s.createClass(t,[{key:"getRenderedTransform",value:function(){var e=this.renderedTransformObj;return e.x=this.highResTransformObj.x,e.y=this.highResTransformObj.y,e.scale=this.highResTransformObj.scale,e.angle=this.highResTransformObj.angle,e.angle%(Math.PI/2)==0&&e.scale%1==0&&(e.x=Math.round(e.x),e.y=Math.round(e.y)),e}},{key:"updateChangeListener",value:function(){var e=this;this.klCanvas.addChangeListener((function(){e.lastRenderedState=-1,e.reqFrame()}))}},{key:"updateCursor",value:function(t,n){if(t!==this.currentMode||n){var r=this.currentMode;if(this.currentMode=t,this.lastRenderedState=-1,this.currentMode===a.Draw?this.rootEl.style.cursor="crosshair":this.currentMode===a.Hand?this.rootEl.style.cursor="grab":this.currentMode===a.HandGrabbing?this.rootEl.style.cursor="grabbing":this.currentMode===a.Pick?this.rootEl.style.cursor="url('"+e(h)+"') 0 15, crosshair":this.currentMode===a.Zoom?this.rootEl.style.cursor="url('"+e(p)+"') 7 7, zoom-in":this.currentMode===a.Rotate?this.rootEl.style.cursor="grab":this.currentMode===a.Rotating?this.rootEl.style.cursor="grabbing":this.currentMode===a.Fill?this.rootEl.style.cursor="url('"+e(d)+"') 1 12, crosshair":this.currentMode===a.Text?this.rootEl.style.cursor="url('"+e(g)+"') 1 12, crosshair":this.currentMode===a.Shape&&(this.rootEl.style.cursor="crosshair"),[a.Draw,a.Pick,a.Fill,a.Text,a.Shape].includes(this.globalMode)){var i=[a.Hand,a.HandGrabbing].includes(r),o=[a.Hand,a.HandGrabbing].includes(this.currentMode);!i&&o&&this.mainDoubleTapper.setAllowedPointerTypeArr(["mouse","pen","touch"]),i&&!o&&this.mainDoubleTapper.setAllowedPointerTypeArr(["touch"])}this.currentMode!==a.Pick&&this.svgOverlay.updateColorPreview({isVisible:!1})}}},{key:"internalZoomByStep",value:function(e,t,n){var r=Math.log2(this.targetTransformObj.scale)/Math.abs(e);r+=e>0?1:-1,r=Math.round(r),r*=Math.abs(e);var i=Math.max(f,Math.min(64,Math.pow(2,r)));if(i===this.targetTransformObj.scale)return!1;var a=i/this.targetTransformObj.scale;this.targetTransformObj.scale=i;var o=l.BB.Matrix.getIdentity();o=l.BB.Matrix.multiplyMatrices(o,l.BB.Matrix.createTranslationMatrix(t,n)),o=l.BB.Matrix.multiplyMatrices(o,l.BB.Matrix.createScaleMatrix(a)),o=l.BB.Matrix.multiplyMatrices(o,l.BB.Matrix.createTranslationMatrix(-t,-n));var s=[this.targetTransformObj.x,this.targetTransformObj.y,0,1];return s=l.BB.Matrix.multiplyMatrixAndPoint(o,s),this.targetTransformObj.x=s[0],this.targetTransformObj.y=s[1],this.transformIsDirty=!0,!0}},{key:"mixTransformObj",value:function(e,t,n){if(e.angle===t.angle)return e.scale=l.BB.mix(e.scale,t.scale,n),e.x=l.BB.mix(e.x,t.x,n),e.y=l.BB.mix(e.y,t.y,n),void(e.angle=l.BB.mix(e.angle,t.angle,n));var r=this.klCanvas.getWidth(),i=this.klCanvas.getHeight(),a=this.canvasToWorkspaceCoord({x:r/2,y:i/2},e),o=this.canvasToWorkspaceCoord({x:r/2,y:i/2},t);e.x=l.BB.mix(a.x,o.x,n),e.y=l.BB.mix(a.y,o.y,n),e.scale=l.BB.mix(e.scale,t.scale,n),e.angle=l.BB.mix(e.angle,t.angle,n);var s=this.canvasToWorkspaceCoord({x:-r/2,y:-i/2},e);e.x=s.x,e.y=s.y}},{key:"render",value:function(){this.doResizeCanvas&&(this.doResizeCanvas=!1,this.renderTargetCanvas.width=this.renderWidth,this.renderTargetCanvas.height=this.renderHeight),this.renderContext(this.renderTargetCtx)}},{key:"testBgVisible",value:function(){var e=[[0,0],[this.renderWidth,0],[this.renderWidth,this.renderHeight],[0,this.renderHeight]],t=this.getRenderedTransform(),n=l.BB.Matrix.getIdentity();n=l.BB.Matrix.multiplyMatrices(n,l.BB.Matrix.createScaleMatrix(1/t.scale)),n=l.BB.Matrix.multiplyMatrices(n,l.BB.Matrix.createRotationMatrix(-t.angle)),n=l.BB.Matrix.multiplyMatrices(n,l.BB.Matrix.createTranslationMatrix(-t.x,-t.y));for(var r=0;r<e.length;r++){var i=[e[r][0],e[r][1],0,1];if(!(0<=(i=l.BB.Matrix.multiplyMatrixAndPoint(n,i))[0]&&i[0]<=this.klCanvas.getWidth()&&0<=i[1]&&i[1]<=this.klCanvas.getHeight()))return!0}return!1}},{key:"renderContext",value:function(e){var t=this.klCanvas.getWidth(),n=this.klCanvas.getHeight(),r=this.getRenderedTransform();if(r.scale>=4||1===r.scale&&0===r.angle?e.imageSmoothingEnabled=!1:(e.imageSmoothingEnabled=!0,e.imageSmoothingQuality="low"),e.save(),this.bgVisible?(e.fillStyle="rgb(158,158,158)",e.fillRect(0,0,this.renderWidth,this.renderHeight)):e.clearRect(0,0,this.renderWidth,this.renderHeight),this.bgVisible){e.save(),e.translate(r.x,r.y),e.scale(r.scale,r.scale),e.rotate(r.angle),e.imageSmoothingEnabled=!1;e.globalAlpha=.2,e.drawImage(this.emptyCanvas,-1/r.scale,-1/r.scale,t+2/r.scale,n+2/r.scale),e.globalAlpha=1,e.globalCompositeOperation="destination-out",e.drawImage(this.emptyCanvas,0,0,t,n),e.restore()}e.translate(r.x,r.y),e.scale(r.scale,r.scale),e.rotate(r.angle);for(var i=this.klCanvas.getLayersFast(),o=0;o<i.length;o++)i[o].opacity>0&&(e.globalAlpha=i[o].opacity,e.globalCompositeOperation=i[o].mixModeStr,i[o].canvas.compositeObj?(this.compositeCanvas.width!==i[o].canvas.width||this.compositeCanvas.height!==i[o].canvas.height?(this.compositeCanvas.width=i[o].canvas.width,this.compositeCanvas.height=i[o].canvas.height):this.compositeCtx.clearRect(0,0,this.compositeCanvas.width,this.compositeCanvas.height),this.compositeCtx.drawImage(i[o].canvas,0,0),i[o].canvas.compositeObj.draw(this.compositeCtx),e.drawImage(this.compositeCanvas,0,0,t,n)):e.drawImage(i[o].canvas,0,0,t,n));e.globalAlpha=1,e.restore(),a.Rotate===this.currentMode||a.Rotating===this.currentMode?this.svgOverlay.updateCompass({isVisible:!0,angleDeg:r.angle/Math.PI*180}):this.svgOverlay.updateCompass({isVisible:!1})}},{key:"workspaceToCanvasCoord",value:function(e){var t=this.getRenderedTransform(),n=l.BB.Matrix.getIdentity();n=l.BB.Matrix.multiplyMatrices(n,l.BB.Matrix.createScaleMatrix(1/t.scale)),n=l.BB.Matrix.multiplyMatrices(n,l.BB.Matrix.createRotationMatrix(-t.angle)),n=l.BB.Matrix.multiplyMatrices(n,l.BB.Matrix.createTranslationMatrix(-t.x,-t.y));var r=[e.x,e.y,0,1];return{x:(r=l.BB.Matrix.multiplyMatrixAndPoint(n,r))[0],y:r[1]}}},{key:"canvasToWorkspaceCoord",value:function(e,t){var n=l.BB.Matrix.getIdentity();n=l.BB.Matrix.multiplyMatrices(n,l.BB.Matrix.createTranslationMatrix(t.x,t.y)),n=l.BB.Matrix.multiplyMatrices(n,l.BB.Matrix.createRotationMatrix(t.angle)),n=l.BB.Matrix.multiplyMatrices(n,l.BB.Matrix.createScaleMatrix(t.scale));var r=[e.x,e.y,0,1];return{x:(r=l.BB.Matrix.multiplyMatrixAndPoint(n,r))[0],y:r[1]}}},{key:"snapAngleRad",value:function(e,t,n){var r=180*e/Math.PI,i=Math.abs(r%t);return Math.min(i,t-i)<=n&&(r=Math.round(r/t)*t),r/180*Math.PI}},{key:"minimizeAngleRad",value:function(e){return(e%=2*Math.PI)>Math.PI?e-=2*Math.PI:e<-Math.PI&&(e+=2*Math.PI),e}},{key:"resetInputProcessor",value:function(){this.currentInputProcessor=null,this.updateCursor(this.globalMode),this.reqFrame(!0)}},{key:"reqFrame",value:function(e){this.animationFrameRequested=!0,e&&(this.lastRenderedState=-1)}},{key:"updateLoop",value:function(){var e=this;window.requestAnimationFrame((function(){return e.updateLoop()}));var t=u.klHistory.getState(),n=this.lastRenderedState<t,r=performance.now(),i=60*(r-this.lastRenderTime)/1e3;this.lastRenderTime=r,(this.animationFrameRequested||n)&&(this.animationFrameRequested=!1,this.checkChange(i))}},{key:"checkChange",value:function(e){var t=u.klHistory.getState(),n=this.lastRenderedState<t||this.highResTransformObj.scale!==this.targetTransformObj.scale||this.highResTransformObj.x!==this.targetTransformObj.x||this.highResTransformObj.y!==this.targetTransformObj.y;if(!this.doAnimateTranslate&&(this.highResTransformObj.scale===this.targetTransformObj.scale||Math.abs(this.highResTransformObj.scale-this.targetTransformObj.scale)<.008*this.targetTransformObj.scale))this.highResTransformObj.scale=this.targetTransformObj.scale,this.highResTransformObj.x=this.targetTransformObj.x,this.highResTransformObj.y=this.targetTransformObj.y,this.highResTransformObj.angle=this.targetTransformObj.angle,this.transformIsDirty&&(this.transformIsDirty=!1,this.bgVisible=this.testBgVisible()),this.svgOverlay.updateCursor({radius:this.brushRadius*this.highResTransformObj.scale});else if((this.highResTransformObj.x===this.targetTransformObj.x||Math.abs(this.highResTransformObj.x-this.targetTransformObj.x)<.5)&&(this.highResTransformObj.y===this.targetTransformObj.y||Math.abs(this.highResTransformObj.y-this.targetTransformObj.y)<.5)&&(this.highResTransformObj.scale===this.targetTransformObj.scale||Math.abs(this.highResTransformObj.scale-this.targetTransformObj.scale)<.008*this.targetTransformObj.scale))this.highResTransformObj.scale=this.targetTransformObj.scale,this.highResTransformObj.x=this.targetTransformObj.x,this.highResTransformObj.y=this.targetTransformObj.y,this.highResTransformObj.angle=this.targetTransformObj.angle,this.doAnimateTranslate=!1,this.transformIsDirty&&(this.transformIsDirty=!1,this.bgVisible=this.testBgVisible()),this.svgOverlay.updateCursor({radius:this.brushRadius*this.highResTransformObj.scale});else{this.reqFrame();var r=Math.min(1,.3*e);this.mixTransformObj(this.highResTransformObj,this.targetTransformObj,r),this.bgVisible=!0,this.svgOverlay.updateCursor({radius:this.brushRadius*this.highResTransformObj.scale})}if(this.pointer&&this.currentMode==a.Draw&&!this.usesCssCursor?this.svgOverlay.updateCursor({x:this.pointer.x,y:this.pointer.y,isVisible:!0}):this.svgOverlay.updateCursor({isVisible:!1}),n){this.lastRenderedState=t;var i=performance.now();this.render(),this.renderTime=l.BB.mix(this.renderTime,performance.now()-i,.05)}}},{key:"getElement",value:function(){return this.rootEl}},{key:"setCanvas",value:function(e){this.klCanvas=e,this.lastDrawEvent=null,this.resetView(),this.updateChangeListener(),this.lastRenderedState=-1,this.reqFrame()}},{key:"setSize",value:function(e,t){var n=this.renderWidth,r=this.renderHeight;e===n&&t===r||(this.doResizeCanvas=!0,this.renderWidth=e,this.renderHeight=t,this.svgOverlay.setSize(e,t),this.targetTransformObj.x+=(e-n)/2,this.targetTransformObj.y+=(t-r)/2,this.highResTransformObj.x=this.targetTransformObj.x,this.highResTransformObj.y=this.targetTransformObj.y,this.bgVisible=this.testBgVisible(),this.lastRenderedState=-1,this.reqFrame())}},{key:"setMode",value:function(e){"draw"===e&&(this.globalMode=a.Draw,this.mainDoubleTapper.setAllowedPointerTypeArr(["touch"])),"fill"===e&&(this.globalMode=a.Fill,this.mainDoubleTapper.setAllowedPointerTypeArr(["touch"])),"text"===e&&(this.globalMode=a.Text,this.mainDoubleTapper.setAllowedPointerTypeArr(["touch"])),"shape"===e&&(this.globalMode=a.Shape,this.mainDoubleTapper.setAllowedPointerTypeArr(["touch"])),"hand"===e&&(this.globalMode=a.Hand,this.mainDoubleTapper.setAllowedPointerTypeArr(["mouse","pen","touch"])),"pick"===e&&(this.globalMode=a.Pick,this.mainDoubleTapper.setAllowedPointerTypeArr(["touch"]))}},{key:"setEnabled",value:function(e){}},{key:"setCursorSize",value:function(e){if(this.brushRadius=e/2,this.svgOverlay.updateCursor({radius:this.brushRadius*this.highResTransformObj.scale}),null===this.pointer){var t=this;clearTimeout(this.hideBrushCursorTimeout),this.svgOverlay.updateCursor({x:this.renderWidth/2,y:this.renderHeight/2,isVisible:!0}),this.hideBrushCursorTimeout=setTimeout((function(){null===t.pointer&&t.svgOverlay.updateCursor({isVisible:!1})}),500)}}},{key:"zoomByStep",value:function(e){this.internalZoomByStep(e,this.renderWidth/2,this.renderHeight/2)&&(this.lastRenderedState=-1,this.reqFrame(),this.onViewChange({changed:["scale"],angle:this.targetTransformObj.angle,scale:this.targetTransformObj.scale}))}},{key:"resetView",value:function(e){this.targetTransformObj.scale=1,this.targetTransformObj.angle=0,this.targetTransformObj.x=(this.renderWidth-this.klCanvas.getWidth())/2,this.targetTransformObj.y=(this.renderHeight-this.klCanvas.getHeight())/2,e?(this.doAnimateTranslate=!0,this.transformIsDirty=!0):this.highResTransformObj=JSON.parse(JSON.stringify(this.targetTransformObj)),this.bgVisible=this.testBgVisible(),this.reqFrame(),e&&this.onViewChange({changed:["scale","angle"],scale:this.targetTransformObj.scale,angle:this.targetTransformObj.angle})}},{key:"fitView",value:function(){var e=[[0,0],[this.klCanvas.getWidth(),0],[this.klCanvas.getWidth(),this.klCanvas.getHeight()],[0,this.klCanvas.getHeight()],[this.klCanvas.getWidth()/2,this.klCanvas.getHeight()/2]],t=l.BB.Matrix.getIdentity();t=l.BB.Matrix.multiplyMatrices(t,l.BB.Matrix.createRotationMatrix(this.targetTransformObj.angle));for(var n=0;n<e.length;n++){var r=[e[n][0],e[n][1],0,1];r=l.BB.Matrix.multiplyMatrixAndPoint(t,r),e[n][0]=r[0],e[n][1]=r[1]}for(var i={x0:null,y0:null,x1:null,y1:null},a=0;a<e.length;a++)(null===i.x0||e[a][0]<i.x0)&&(i.x0=e[a][0]),(null===i.y0||e[a][1]<i.y0)&&(i.y0=e[a][1]),(null===i.x1||e[a][0]>i.x1)&&(i.x1=e[a][0]),(null===i.y1||e[a][1]>i.y1)&&(i.y1=e[a][1]);var o=i.x1-i.x0,s=i.y1-i.y0,c=l.BB.fitInto(o,s,this.renderWidth-40,this.renderHeight-40,1).width/o;this.targetTransformObj.x=this.renderWidth/2-(e[4][0]-e[0][0])*c,this.targetTransformObj.y=this.renderHeight/2-(e[4][1]-e[0][1])*c,this.targetTransformObj.scale=c,this.doAnimateTranslate=!0,this.transformIsDirty=!0,this.reqFrame(),this.onViewChange({changed:["scale","angle"],scale:this.targetTransformObj.scale,angle:this.targetTransformObj.angle})}},{key:"setAngle",value:function(e,t){var n={x:this.renderWidth/2,y:this.renderHeight/2},r=this.targetTransformObj.angle,i=e/180*Math.PI;t?this.targetTransformObj.angle+=i:this.targetTransformObj.angle=i,this.targetTransformObj.angle=this.minimizeAngleRad(this.snapAngleRad(this.targetTransformObj.angle,90,4));var a=l.BB.Matrix.getIdentity();a=l.BB.Matrix.multiplyMatrices(a,l.BB.Matrix.createTranslationMatrix(n.x,n.y)),a=l.BB.Matrix.multiplyMatrices(a,l.BB.Matrix.createRotationMatrix(this.targetTransformObj.angle-r)),a=l.BB.Matrix.multiplyMatrices(a,l.BB.Matrix.createTranslationMatrix(-n.x,-n.y));var o=[this.targetTransformObj.x,this.targetTransformObj.y,0,1];o=l.BB.Matrix.multiplyMatrixAndPoint(a,o),this.targetTransformObj.x=o[0],this.targetTransformObj.y=o[1],this.highResTransformObj=JSON.parse(JSON.stringify(this.targetTransformObj)),this.transformIsDirty=!0,this.reqFrame(!0)}},{key:"translateView",value:function(e,t){this.targetTransformObj.x+=40*e,this.targetTransformObj.y+=40*t,this.transformIsDirty=!0,this.doAnimateTranslate=!0,this.reqFrame(!0)}},{key:"getIsDrawing",value:function(){return this.isDrawing}},{key:"getScale",value:function(){return this.targetTransformObj.scale}},{key:"getAngleDeg",value:function(){return 180*this.targetTransformObj.angle/Math.PI}},{key:"getMaxScale",value:function(){return 64}},{key:"getMinScale",value:function(){return f}},{key:"requestFrame",value:function(){this.lastRenderedState=-1,this.reqFrame()}},{key:"setLastDrawEvent",value:function(e,t,n){null!==e?(this.lastDrawEvent||(this.lastDrawEvent={x:0,y:0,pressure:0}),this.lastDrawEvent.x=e,this.lastDrawEvent.y=t,this.lastDrawEvent.pressure=n):this.lastDrawEvent=null}}]),t}()})),r.register("hNEwm",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("1dLwT")})),r.register("iOLNv",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("9wZxU")})),r.register("3zTyb",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("hQSEH")})),r.register("kFdtJ",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("916ZI")})),r.register("i5nyl",(function(e,n){t(e.exports,"KlCanvasPreview",(function(){return a}));var i=r("eWjiX");function a(e){var t=function(){s.save(),s.clearRect(0,0,o.width,o.height);for(var t=0;t<e.layers.length;t++)s.globalAlpha=e.layers[t].opacity,s.globalCompositeOperation=e.layers[t].mixModeStr,o.width>e.layers[t].image.width&&(s.imageSmoothingEnabled=!1),s.drawImage(e.layers[t].image,0,0,o.width,o.height);s.restore()},n=e.width/e.layers[0].image.width,r=n>1?e.layers[0].image.width:e.width,a=n>1?e.layers[0].image.height:e.height,o=i.BB.canvas(r,a);o.style.backgroundImage="url("+i.BB.createCheckerDataUrl(8)+")";var s=o.getContext("2d");i.BB.css(o,{width:"100%",height:"100%",imageRendering:n>1?"pixelated":null}),setTimeout(t,0),this.getElement=function(){return o},this.render=function(){t()}}})),r.register("cNhNm",(function(n,i){t(n.exports,"FreeTransform",(function(){return p}));var a=r("4gaLD"),o=r("eWjiX"),s=r("lQMok");function l(e){if(Math.abs(e.angleDeg)%90==0){e.width=Math.round(e.width),e.height=Math.round(e.height);var t=Math.abs(e.angleDeg-90)%180==0;e.x=(t?e.height:e.width)%2==0?Math.round(e.x):Math.round(e.x-.5)+.5,e.y=(t?e.width:e.height)%2==0?Math.round(e.y):Math.round(e.y-.5)+.5}}function c(e){return{x:e.x,y:e.y,width:e.width,height:e.height,angleDeg:e.angleDeg}}function u(e,t,n){var r,i;r=e-n.x,i=t-n.y;var a=o.BB.rotateAround({x:0,y:0},{x:r,y:i},-n.angleDeg);return{x:r=a.x,y:i=a.y}}function h(e,t,n){var r=o.BB.rotateAround({x:0,y:0},{x:e,y:t},n.angleDeg);return{x:r.x+n.x,y:r.y+n.y}}var p=function(){"use strict";function t(n){var r=this;a.classCallCheck(this,t);this.scaled={x:0,y:0,width:0,height:0,corners:[{x:0,y:0}]},this.minSnapDist=7,this.cornerCursors=["nw","n","ne","e","se","s","sw","w"],this.gripSize=14,this.edgeSize=10,this.corners=[],this.edges=[],this.transform={x:n.x,y:n.y,width:n.width,height:n.height,angleDeg:n.angleDeg},this.isConstrained=!!n.isConstrained,this.snapX=n.snapX,this.snapY=n.snapY,this.callback=n.callback,this.scale=n.scale,this.snappingEnabled=!0,this.ratio=this.transform.width/this.transform.height,this.rootEl=o.BB.el({className:"kl-free-transform",css:{userSelect:"none"}}),this.transEl=o.BB.el({parent:this.rootEl,css:{position:"absolute"}}),this.boundsEl=o.BB.el({css:{position:"absolute",cursor:"move",boxShadow:"rgba(255, 255, 255, 0.5) 0 0 0 1px inset, rgba(0, 0, 0, 0.5) 0 0 0 1px"}});var i={x:0,y:0};this.keyListener=new o.BB.KeyListener({});var c,p={x:0,y:0};this.boundsPointerListener=new o.BB.PointerListener({target:this.boundsEl,fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointerdown"===e.type&&(p={x:r.transform.x,y:r.transform.y}),"pointermove"===e.type&&"left"===e.button){var t;r.transform.x=p.x+(e.pageX-e.downPageX)/r.scale,r.transform.y=p.y+(e.pageY-e.downPageY)/r.scale;var n={};if(r.snappingEnabled){var i,a;for(i=0;i<r.snapX.length;i++)(t=Math.abs(r.transform.x-r.snapX[i]))<r.minSnapDist/r.scale&&(!n.x||t<n.distX)&&(n.x=r.snapX[i],n.distX=t);for(i=0;i<r.snapY.length;i++)(t=Math.abs(r.transform.y-r.snapY[i]))<r.minSnapDist/r.scale&&(!n.y||t<n.distY)&&(n.y=r.snapY[i],n.distY=t);for(i=0;i<4;i++){a=h(r.corners[i].x,r.corners[i].y,r.transform);var s=void 0;for(s=0;s<r.snapX.length;s++)(t=Math.abs(a.x-r.snapX[s]))<r.minSnapDist/r.scale&&(!n.x||t<n.distX)&&(n.x=r.snapX[s]-(a.x-r.transform.x),n.distX=t);for(s=0;s<r.snapY.length;s++)(t=Math.abs(a.y-r.snapY[s]))<r.minSnapDist/r.scale&&(!n.y||t<n.distY)&&(n.y=r.snapY[s]-(a.y-r.transform.y),n.distY=t)}}if("shift"===r.keyListener.getComboStr()){var c=o.BB.projectPointOnLine({x:0,y:p.y},{x:10,y:p.y},{x:r.transform.x,y:r.transform.y}),u=o.BB.dist(c.x,c.y,r.transform.x,r.transform.y);(n={}).x=c.x,n.y=c.y,n.distX=u,n.distY=u,c=o.BB.projectPointOnLine({x:p.x,y:0},{x:p.x,y:10},{x:r.transform.x,y:r.transform.y}),(u=o.BB.dist(c.x,c.y,r.transform.x,r.transform.y))<n.distX&&(n.x=c.x,n.y=c.y,n.distX=u,n.distY=u),c=o.BB.projectPointOnLine({x:p.x,y:p.y},{x:p.x+1,y:p.y+1},{x:r.transform.x,y:r.transform.y}),(u=o.BB.dist(c.x,c.y,r.transform.x,r.transform.y))<n.distX&&(n.x=c.x,n.y=c.y,n.distX=u,n.distY=u),c=o.BB.projectPointOnLine({x:p.x,y:p.y},{x:p.x+1,y:p.y-1},{x:r.transform.x,y:r.transform.y}),(u=o.BB.dist(c.x,c.y,r.transform.x,r.transform.y))<n.distX&&(n.x=c.x,n.y=c.y,n.distX=u,n.distY=u)}null!=n.x&&(r.transform.x=n.x),null!=n.y&&(r.transform.y=n.y),Math.abs(r.transform.angleDeg)%90==0&&(l(r.transform),r.updateCornerPositions()),r.updateDOM()}}});for(var d=0;d<4;d++)!function(e){var t=r,n=r.corners[e]={i:e,el:o.BB.el({css:{width:r.gripSize+"px",height:r.gripSize+"px",background:"#fff",borderRadius:r.gripSize+"px",position:"absolute",boxShadow:"inset 0 0 0 2px #000"}}),x:0,y:0,virtualPos:{x:0,y:0},updateDOM:null,pointerListener:null};n.updateDOM=function(){var r=t,i=[[-1,-1],[1,-1],[1,1],[-1,1]].map((function(e){return e[0]*=r.transform.width>0?1:-1,e[1]*=r.transform.height>0?1:-1,e})),a=Math.abs(t.scaled.width)<20||Math.abs(t.scaled.height)<20?10:0;o.BB.css(n.el,{left:t.scaled.corners[n.i].x-t.gripSize/2+i[e][0]*a+"px",top:t.scaled.corners[n.i].y-t.gripSize/2+i[e][1]*a+"px"});for(var s=o.BB.pointsToAngleDeg({x:t.transform.x,y:t.transform.y},h(n.x,n.y,t.transform))+135;s<0;)s+=360;var l=Math.round(s/45)%t.cornerCursors.length;o.BB.css(n.el,{cursor:t.cornerCursors[l]+"-resize"})},n.pointerListener=new o.BB.PointerListener({target:r.corners[e].el,fixScribble:!0,onPointer:function(n){if(n.eventPreventDefault(),"pointerdown"===n.type&&"left"===n.button)t.corners[e].virtualPos=h(t.corners[e].x,t.corners[e].y,t.transform);else if("pointermove"===n.type&&"left"===n.button){t.corners[e].virtualPos.x+=n.dX/t.scale,t.corners[e].virtualPos.y+=n.dY/t.scale;var r={x:t.corners[e].virtualPos.x,y:t.corners[e].virtualPos.y};r=t.constrainCorner(e,r.x,r.y),t.isConstrained||(r=t.snapCorner(r.x,r.y)),Math.abs(t.transform.angleDeg)%90==0&&(r.x=Math.round(r.x),r.y=Math.round(r.y));var i=u(r.x,r.y,t.transform),a=i.x-t.corners[e].x,o=i.y-t.corners[e].y;t.corners[e].x=i.x,t.corners[e].y=i.y;var s=[];0===e?s=[3,1,2]:1===e?s=[2,0,3]:2===e?s=[1,3,0]:3===e&&(s=[0,2,1]),t.corners[s[0]].x=t.corners[e].x,t.corners[s[1]].y=t.corners[e].y,t.keyListener.isPressed("shift")&&(t.corners[s[2]].x-=a,t.corners[s[2]].y-=o,t.corners[s[1]].x=t.corners[s[2]].x,t.corners[s[0]].y=t.corners[s[2]].y),t.updateTransformViaCorners()}}})}(d);this.updateCornerPositions(),this.updateScaled();for(var g=0;g<4;g++)!function(e){var t=r;r.edges[e]={el:o.BB.el({css:{width:r.edgeSize+"px",height:r.edgeSize+"px",position:"absolute"}}),updateDOM:null,pointerListener:null};var n=r.edges[e];n.updateDOM=function(){0===e?o.BB.css(n.el,{left:Math.min(t.scaled.corners[0].x,t.scaled.corners[1].x)+"px",top:Math.min(t.scaled.corners[0].y,t.scaled.corners[3].y)-t.edgeSize+"px",width:Math.abs(t.scaled.width)+"px",height:t.edgeSize+"px"}):1===e?o.BB.css(n.el,{left:Math.max(t.scaled.corners[0].x,t.scaled.corners[1].x)+"px",top:Math.min(t.scaled.corners[1].y,t.scaled.corners[2].y)+"px",width:t.edgeSize+"px",height:Math.abs(t.scaled.height)+"px"}):2===e?o.BB.css(n.el,{left:Math.min(t.scaled.corners[3].x,t.scaled.corners[2].x)+"px",top:Math.max(t.scaled.corners[0].y,t.scaled.corners[3].y)+"px",width:Math.abs(t.scaled.width)+"px",height:t.edgeSize+"px"}):3===e&&o.BB.css(n.el,{left:Math.min(t.scaled.corners[0].x,t.scaled.corners[1].x)-t.edgeSize+"px",top:Math.min(t.scaled.corners[0].y,t.scaled.corners[3].y)+"px",width:t.edgeSize+"px",height:Math.abs(t.scaled.height)+"px"});for(var r=Math.round(t.transform.angleDeg/45);r<0;)r+=8;r=(2*e+1+r)%t.cornerCursors.length,n.el.style.cursor=t.cornerCursors[r]+"-resize"};var a=[0,2].includes(e);n.pointerListener=new o.BB.PointerListener({target:r.edges[e].el,fixScribble:!0,onPointer:function(n){if(n.eventPreventDefault(),"pointerdown"===n.type&&"left"===n.button&&(c=a?t.corners[0].y>=t.corners[3].y:t.corners[0].x>=t.corners[1].x,i.x=0,i.y=0),"pointermove"===n.type&&"left"===n.button){var r=o.BB.rotateAround({x:0,y:0},{x:n.dX/t.scale,y:n.dY/t.scale},-t.transform.angleDeg),s={dX:r.x,dY:r.y};Math.abs(t.transform.angleDeg)%90==0&&(s=o.BB.intDxy(i,r.x,r.y));var l=[];0===e?l=[2,3,0,1]:1===e?l=[0,3,1,2]:2===e?l=[0,1,2,3]:3===e&&(l=[1,2,0,3]);var u=a?"y":"x",h=a?s.dY:s.dX;c?(t.corners[l[0]][u]+=h,t.corners[l[1]][u]+=h):(t.corners[l[2]][u]+=h,t.corners[l[3]][u]+=h),t.keyListener.isPressed("shift")&&(c?(t.corners[l[2]][u]-=h,t.corners[l[3]][u]-=h):(t.corners[l[0]][u]-=h,t.corners[l[1]][u]-=h)),a?t.restoreRatio(!1,!0):t.restoreRatio(!0,!1),t.updateTransformViaCorners()}}})}(g);this.angleGrip={el:o.BB.el({css:{cursor:"url("+e(s)+") 10 10, move",width:this.gripSize+"px",height:this.gripSize+"px",background:"#0ff",borderRadius:this.gripSize+"px",position:"absolute",boxShadow:"inset 0 0 0 2px #000"}}),x:0,y:0,snap:!1,updateDOM:function(){o.BB.css(r.angleGrip.el,{left:r.angleGrip.x-r.gripSize/2+"px",top:r.angleGrip.y-r.gripSize/2+"px"})}},o.BB.el({parent:this.angleGrip.el,css:{width:"2px",height:"13px",left:this.gripSize/2-1+"px",top:this.gripSize+"px",background:"#0ff",position:"absolute"}}),this.anglePointerListener=new o.BB.PointerListener({target:this.angleGrip.el,fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var t=r.rootEl.getBoundingClientRect(),n={x:t.left-r.rootEl.scrollLeft,y:t.top-r.rootEl.scrollTop},i={x:(e.clientX-n.x)/r.scale,y:(e.clientY-n.y)/r.scale},a=o.BB.pointsToAngleDeg({x:r.transform.x,y:r.transform.y},i)+90;r.transform.angleDeg=a;var s=45*Math.round(a/360*8);("shift"===r.keyListener.getComboStr()||r.snappingEnabled&&Math.abs(s-a)<8)&&(r.transform.angleDeg=s),r.updateDOM()}"pointerup"===e.type&&Math.abs(r.transform.angleDeg)%90==0&&(l(r.transform),r.updateCornerPositions(),r.updateDOM())}}),l(this.transform),this.updateDOM(!0),o.BB.append(this.transEl,[this.boundsEl,this.edges[0].el,this.edges[1].el,this.edges[2].el,this.edges[3].el,this.corners[0].el,this.corners[1].el,this.corners[2].el,this.corners[3].el,this.angleGrip.el])}return a.createClass(t,[{key:"updateScaled",value:function(){var e=this;this.scaled.x=this.transform.x*this.scale,this.scaled.y=this.transform.y*this.scale,this.scaled.width=this.transform.width*this.scale,this.scaled.height=this.transform.height*this.scale,this.scaled.corners=this.corners.map((function(t){return{x:t.x*e.scale,y:t.y*e.scale}}))}},{key:"snapCorner",value:function(e,t){if(!this.snappingEnabled)return{x:e,y:t};for(var n,r={x:null,y:null,dist:{x:null,y:null}},i=0;i<this.snapX.length;i++)(n=Math.abs(e-this.snapX[i]))<this.minSnapDist/this.scale&&(null===r.x||n<r.dist.x)&&(r.x=this.snapX[i],r.dist.x=n);for(var a=0;a<this.snapY.length;a++)(n=Math.abs(t-this.snapY[a]))<this.minSnapDist/this.scale&&(null===r.y||n<r.dist.y)&&(r.y=this.snapY[a],r.dist.y=n);return null===r.x&&null===r.y?{x:e,y:t}:{x:null===r.x?e:r.x,y:null===r.y?t:r.y}}},{key:"constrainCorner",value:function(e,t,n){if(!this.isConstrained)return{x:t,y:n};var r=this.transform.width*this.transform.height<0?-1:1;return o.BB.projectPointOnLine({x:this.transform.x,y:this.transform.y},h(this.ratio,r*([0,2].includes(e)?1:-1),this.transform),{x:t,y:n})}},{key:"updateCornerPositions",value:function(){this.corners[0].x=-this.transform.width/2,this.corners[0].y=-this.transform.height/2,this.corners[1].x=this.transform.width/2,this.corners[1].y=-this.transform.height/2,this.corners[2].x=this.transform.width/2,this.corners[2].y=this.transform.height/2,this.corners[3].x=-this.transform.width/2,this.corners[3].y=this.transform.height/2}},{key:"restoreRatio",value:function(e,t){if(this.isConstrained){var n=Math.abs(this.transform.angleDeg)%90==0,r=Math.abs(this.transform.angleDeg-90)%180==0;if(t&&!e){var i=Math.abs(this.corners[3].y-this.corners[0].y),a=this.ratio*i;n&&(a=0==(r?this.transform.y%1:this.transform.x%1)?o.BB.roundEven(a):o.BB.roundUneven(a)),this.corners[1].x-this.corners[0].x<0&&(a*=-1),this.corners[0].x=-a/2,this.corners[3].x=-a/2,this.corners[1].x=a/2,this.corners[2].x=a/2}if(!t&&e){var s=Math.abs(this.corners[0].x-this.corners[1].x)/this.ratio;n&&(s=0==(r?this.transform.x%1:this.transform.y%1)?o.BB.roundEven(s):o.BB.roundUneven(s)),this.corners[3].y-this.corners[0].y<0&&(s*=-1),this.corners[0].y=-s/2,this.corners[1].y=-s/2,this.corners[2].y=s/2,this.corners[3].y=s/2}}}},{key:"updateTransformViaCorners",value:function(){var e=o.BB.rotateAround({x:0,y:0},{x:(this.corners[0].x+this.corners[1].x)/2,y:(this.corners[0].y+this.corners[3].y)/2},this.transform.angleDeg);this.transform.x=e.x+this.transform.x,this.transform.y=e.y+this.transform.y,this.transform.width=this.corners[1].x-this.corners[0].x,this.transform.height=this.corners[3].y-this.corners[0].y,this.updateCornerPositions(),this.updateDOM()}},{key:"updateDOM",value:function(e){this.updateScaled(),o.BB.css(this.transEl,{left:this.scaled.x+"px",top:this.scaled.y+"px",transformOrigin:"0 0",transform:"rotate("+this.transform.angleDeg+"deg)"}),o.BB.css(this.boundsEl,{width:Math.abs(this.scaled.width)+"px",height:Math.abs(this.scaled.height)+"px",left:Math.min(this.scaled.corners[0].x,this.scaled.corners[1].x)+"px",top:Math.min(this.scaled.corners[0].y,this.scaled.corners[3].y)+"px"}),this.corners[0].updateDOM(),this.corners[1].updateDOM(),this.corners[2].updateDOM(),this.corners[3].updateDOM(),this.edges[0].updateDOM(),this.edges[1].updateDOM(),this.edges[2].updateDOM(),this.edges[3].updateDOM(),this.angleGrip.x=0,this.angleGrip.y=-Math.abs(this.transform.height*this.scale)/2-20,this.angleGrip.updateDOM(),e||this.callback&&this.callback(c(this.transform))}},{key:"getTransform",value:function(){return c(this.transform)}},{key:"setConstrained",value:function(e){this.isConstrained=!!e,e&&0!==this.transform.width&&0!==this.transform.height&&(this.ratio=Math.abs(this.transform.width/this.transform.height))}},{key:"setSnapping",value:function(e){this.snappingEnabled=!!e}},{key:"setPos",value:function(e){this.transform.x=e.x,this.transform.y=e.y,this.updateDOM(!0)}},{key:"move",value:function(e,t){this.transform.x+=e,this.transform.y+=t,this.updateDOM(!1)}},{key:"setSize",value:function(e,t){this.transform.width=e,this.transform.height=t,Math.abs(this.transform.angleDeg)%90==0&&l(this.transform),this.updateCornerPositions(),this.updateDOM(!1)}},{key:"setAngleDeg",value:function(e){this.transform.angleDeg=e,Math.abs(this.transform.angleDeg)%90==0&&(l(this.transform),this.updateCornerPositions()),this.updateDOM(!0)}},{key:"getElement",value:function(){return this.rootEl}},{key:"getRatio",value:function(){return this.ratio}},{key:"destroy",value:function(){this.keyListener.destroy(),this.boundsPointerListener.destroy(),this.corners[0].pointerListener.destroy(),this.corners[1].pointerListener.destroy(),this.corners[2].pointerListener.destroy(),this.corners[3].pointerListener.destroy(),this.edges[0].pointerListener.destroy(),this.edges[1].pointerListener.destroy(),this.edges[2].pointerListener.destroy(),this.edges[3].pointerListener.destroy(),this.anglePointerListener.destroy()}}]),t}()})),r.register("lQMok",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("045N6")})),r.register("kEeSq",(function(e,n){t(e.exports,"FreeTransformCanvas",(function(){return s}));var i=r("eWjiX"),a=r("i5nyl"),o=r("cNhNm");function s(e){var t=function(){if(u){var t=u.getTransform();r<1&&(t.x*=r,t.y*=r,t.width*=r,t.height*=r);var n=c[e.transformIndex].image,a=n.getContext("2d");a.save(),a.clearRect(0,0,n.width,n.height),i.BB.drawTransformedImageWithBounds(a,e.layers[e.transformIndex].image,t,null,i.BB.testShouldPixelate(t,t.width/h.width,t.height/h.height)),a.restore(),p.render()}},n=i.BB.fitInto(e.imageWidth,e.imageHeight,e.elementWidth-20,e.elementHeight-60,1),r=n.width/e.imageWidth,s=i.BB.el({css:{width:e.elementWidth+"px",height:e.elementHeight+"px",backgroundColor:"#9e9e9e",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",overflow:"hidden",userSelect:"none",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",colorScheme:"only light"}});s.oncontextmenu=function(){return!1};var l=i.BB.el({css:{position:"relative",boxShadow:"0 0 5px rgba(0,0,0,0.5)",width:n.width+"px",height:n.height+"px"}});s.appendChild(l);var c=e.layers.map((function(e){return{image:e.image,mixModeStr:e.mixModeStr,opacity:e.opacity}}));c[c.length-1].image=i.BB.canvas(r>1?e.imageWidth:n.width,r>1?e.imageHeight:n.height);var u,h,p=new a.KlCanvasPreview({width:n.width,height:n.height,layers:c});l.appendChild(p.getElement());var d={width:e.layers[e.transformIndex].image.width*r,height:e.layers[e.transformIndex].image.height*r};(d.width>n.width||d.height>n.height)&&(d=i.BB.fitInto(e.layers[e.transformIndex].image.width,e.layers[e.transformIndex].image.height,n.width,n.height,1)),h={x:e.imageWidth/2,y:e.imageHeight/2,width:e.layers[e.transformIndex].image.width,height:e.layers[e.transformIndex].image.height},u=new o.FreeTransform({x:h.x,y:h.y,width:h.width,height:h.height,angleDeg:0,isConstrained:!0,snapX:[0,e.imageWidth],snapY:[0,e.imageHeight],scale:r,callback:function(e){t()}}),i.BB.css(u.getElement(),{position:"absolute",left:"0",top:"0"}),l.appendChild(u.getElement()),setTimeout(t,0),this.move=function(e,t){u.move(e,t)},this.reset=function(){var n=e.layers[e.transformIndex].image.width,r=e.layers[e.transformIndex].image.height;u.setSize(n,r),u.setPos({x:n/2,y:r/2}),u.setAngleDeg(0),t()},this.setTransformFit=function(){var n=i.BB.fitInto(e.layers[e.transformIndex].image.width,e.layers[e.transformIndex].image.height,e.imageWidth,e.imageHeight,1);u.setSize(n.width,n.height),u.setPos({x:n.width/2,y:n.height/2}),u.setAngleDeg(0),t()},this.setTransformCenter=function(){u.setPos({x:e.imageWidth/2,y:e.imageHeight/2}),u.setAngleDeg(0),t()},this.getTransformation=function(){return!!u&&u.getTransform()},this.getIsPixelated=function(){var e=u.getTransform();return i.BB.testShouldPixelate(e,e.width/h.width,e.height/h.height)},this.getElement=function(){return s},this.destroy=function(){u.destroy()}}})),r.register("32CBv",(function(e,n){t(e.exports,"Cropper",(function(){return a}));var i=r("eWjiX");function a(e){var t=function(e){L[0].y+=e,L[0].y=Math.max(L[3].y-v,Math.min(L[3].y-1,L[0].y)),L[1].y=L[0].y},n=function(e){L[1].x+=e,L[1].x=Math.min(L[0].x+f,Math.max(L[0].x+1,L[1].x)),L[2].x=L[1].x},r=function(e){L[2].y+=e,L[2].y=Math.min(L[1].y+v,Math.max(L[1].y+1,L[2].y)),L[3].y=L[2].y},a=function(e){L[0].x+=e,L[0].x=Math.max(L[1].x-f,Math.min(L[1].x-1,L[0].x)),L[3].x=L[0].x},o=function(){w.x=0,w.y=0,g(s())},s=function(){return L[1].x-=L[0].x,L[1].y-=L[0].y,L[2].x-=L[0].x,L[2].y-=L[0].y,L[3].x-=L[0].x,L[3].y-=L[0].y,c+=L[0].x,u+=L[0].y,L[0].x=0,L[0].y=0,{x:c,y:u,width:L[1].x,height:L[2].y}},l=function(){A[0].update(),A[1].update(),A[2].update(),A[3].update(),D[0].update(),D[1].update(),D[2].update(),D[3].update(),I[0].update(),I[1].update(),I[2].update(),I[3].update(),b.update(),C.update(),S.update()},c=e.x,u=e.y,h=e.width,p=e.height,d=e.scale,g=e.callback,f=e.maxW,v=e.maxH,m=document.createElement("div"),y=["nw","n","ne","e","se","s","sw","w"],x=new i.BB.KeyListener({});i.BB.css(m,{position:"absolute",left:c*d+"px",top:u*d+"px"});var b=document.createElement("div");i.BB.css(b,{position:"absolute",border:"1px dashed #fff",cursor:"move"}),b.update=function(){i.BB.css(b,{left:L[0].x*d-1+"px",top:L[0].y*d-1+"px",width:(L[2].x-L[0].x)*d+"px",height:(L[2].y-L[0].y)*d+"px"})};var w={x:0,y:0},B=new i.BB.PointerListener({target:b,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var t=i.BB.intDxy(w,e.dX/d,e.dY/d),n=t.dX,r=t.dY;L[0].x+=n,L[0].y+=r,L[1].x+=n,L[1].y+=r,L[2].x+=n,L[2].y+=r,L[3].x+=n,L[3].y+=r,l()}"pointerup"===e.type&&o()}}),C=document.createElement("div");i.BB.css(C,{position:"absolute",borderTop:"1px solid #0ff",borderBottom:"1px solid #0ff"}),C.update=function(){i.BB.css(C,{left:L[0].x*d+"px",top:(L[0].y+(L[2].y-L[0].y)/3)*d+"px",width:(L[2].x-L[0].x)*d+"px",height:(L[2].y-L[0].y)/3*d+"px"})};var S=document.createElement("div");i.BB.css(S,{position:"absolute",borderLeft:"1px solid #0ff",borderRight:"1px solid #0ff"}),S.update=function(){i.BB.css(S,{left:(L[0].x+(L[2].x-L[0].x)/3)*d+"px",top:L[0].y*d+"px",width:(L[2].x-L[0].x)/3*d+"px",height:(L[2].y-L[0].y)*d+"px"})};for(var k=10,L=[{x:0,y:0},{x:h,y:0},{x:h,y:p},{x:0,y:p}],A=[],T=0;T<4;T++)!function(e){A[e]=document.createElement("div");var t=A[e];t.style.width="40px",t.style.height="40px",t.style.position="absolute",t.update=function(){0===e?(t.style.left=L[0].x*d+k+"px",t.style.top=L[0].y*d-80+k+"px",t.style.width=(L[1].x-L[0].x)*d-20+"px",t.style.height="80px"):1===e?(t.style.left=L[1].x*d-k+"px",t.style.top=L[1].y*d+k+"px",t.style.width="80px",t.style.height=(L[2].y-L[1].y)*d-20+"px"):2===e?(t.style.left=L[3].x*d+k+"px",t.style.top=L[3].y*d-k+"px",t.style.width=(L[2].x-L[3].x)*d-20+"px",t.style.height="80px"):3===e&&(t.style.left=L[0].x*d-80+k+"px",t.style.top=L[0].y*d+k+"px",t.style.width="80px",t.style.height=(L[3].y-L[0].y)*d-20+"px");var n=2*e+1;t.style.cursor=y[n]+"-resize"}}(T);for(var I=[],E=0;E<4;E++)!function(e){I[e]=document.createElement("div");var t=I[e];t.style.position="absolute",t.style.background="#000",t.style.opacity="0.5",t.update=function(){0===e?(t.style.left=L[0].x*d+"px",t.style.top=L[0].y*d-8e3+"px",t.style.width=(L[1].x-L[0].x)*d+"px",t.style.height="8000px"):1===e?(t.style.left=L[1].x*d+"px",t.style.top=L[1].y*d-8e3+"px",t.style.width="8000px",t.style.height="16000px"):2===e?(t.style.left=L[3].x*d+"px",t.style.top=L[3].y*d+"px",t.style.width=(L[2].x-L[3].x)*d+"px",t.style.height="8000px"):3===e&&(t.style.left=L[0].x*d-8e3+"px",t.style.top=L[0].y*d-8e3+"px",t.style.width="8000px",t.style.height="16000px")}}(E);var M=new i.BB.PointerListener({target:A[0],fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var n=i.BB.intDxy(w,e.dX/d,e.dY/d),a=(n.dX,n.dY);t(a),x.isPressed("shift")&&r(-a),l()}"pointerup"===e.type&&o()}}),R=new i.BB.PointerListener({target:A[1],fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var t=i.BB.intDxy(w,e.dX/d,e.dY/d),r=t.dX;t.dY;n(r),x.isPressed("shift")&&a(-r),l()}"pointerup"===e.type&&o()}}),O=new i.BB.PointerListener({target:A[2],fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var n=i.BB.intDxy(w,e.dX/d,e.dY/d),a=(n.dX,n.dY);r(a),x.isPressed("shift")&&t(-a),l()}"pointerup"===e.type&&o()}}),P=new i.BB.PointerListener({target:A[3],fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var t=i.BB.intDxy(w,e.dX/d,e.dY/d),r=t.dX;t.dY;a(r),x.isPressed("shift")&&n(-r),l()}"pointerup"===e.type&&o()}}),D=[];!function(){for(var e=0;e<4;e++)!function(e){D[e]=document.createElement("div");var t=D[e];i.BB.css(t,{width:"80px",height:"80px",position:"absolute"}),t.style.cursor=["nwse-resize","nesw-resize"][e%2],t.update=function(){0===e?i.BB.css(t,{left:L[0].x*d-80+k+"px",top:L[0].y*d-80+k+"px"}):1===e?i.BB.css(t,{left:L[1].x*d-k+"px",top:L[1].y*d-80+k+"px"}):2===e?i.BB.css(t,{left:L[1].x*d-k+"px",top:L[2].y*d-k+"px"}):3===e&&i.BB.css(t,{left:L[0].x*d-80+k+"px",top:L[2].y*d-k+"px"})}}(e)}();var G=new i.BB.PointerListener({target:D[0],fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var s=i.BB.intDxy(w,e.dX/d,e.dY/d),c=s.dX,u=s.dY;a(c),t(u),x.isPressed("shift")&&(n(-c),r(-u)),l()}"pointerup"===e.type&&o()}}),N=new i.BB.PointerListener({target:D[1],fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var s=i.BB.intDxy(w,e.dX/d,e.dY/d),c=s.dX,u=s.dY;n(c),t(u),x.isPressed("shift")&&(a(-c),r(-u)),l()}"pointerup"===e.type&&o()}}),j=new i.BB.PointerListener({target:D[2],fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var s=i.BB.intDxy(w,e.dX/d,e.dY/d),c=s.dX,u=s.dY;n(c),r(u),x.isPressed("shift")&&(a(-c),t(-u)),l()}"pointerup"===e.type&&o()}}),z=new i.BB.PointerListener({target:D[3],fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var s=i.BB.intDxy(w,e.dX/d,e.dY/d),c=s.dX,u=s.dY;a(c),r(u),x.isPressed("shift")&&(n(-c),t(-u)),l()}"pointerup"===e.type&&o()}});m.append(I[1],I[0],I[2],I[3],C,S,b,A[1],A[0],A[2],A[3],D[0],D[1],D[2],D[3]),l(),this.getTransform=s,this.setTransform=function(e){c=e.x,u=e.y,h=e.width,p=e.height,i.BB.css(m,{left:c*d+"px",top:u*d+"px"}),L[0].x=0,L[0].y=0,L[1].x=h,L[1].y=0,L[2].x=h,L[2].y=p,L[3].x=0,L[3].y=p,l(),o()},this.setScale=function(e){d=e,i.BB.css(m,{left:c*d+"px",top:u*d+"px"}),l()},this.showThirds=function(e){e?(C.style.display="block",S.style.display="block"):(C.style.display="none",S.style.display="none")},this.getElement=function(){return m},this.destroy=function(){x.destroy(),B.destroy(),G.destroy(),N.destroy(),j.destroy(),z.destroy(),M.destroy(),R.destroy(),O.destroy(),P.destroy()}}})),r.register("kqmpc",(function(e,n){t(e.exports,"LayerPreview",(function(){return s}));var i=r("eWjiX"),a=r("gWfkn"),o=r("1mH1z");function s(e){var t,n,r=function(e){if(h){T.textContent=t.name,M.innerHTML=o.LANG("opacity")+"<br>"+Math.round(100*t.opacity)+"%";var n=t.context.canvas;if(n.width!==v.width||n.height!==v.height){var r=i.BB.fitInto(n.width,n.height,d,d,1);k.width=Math.round(r.width),k.height=Math.round(r.height),e=!0}m.width=k.width,m.height=k.height,y.save(),y.imageSmoothingEnabled=!1,y.fillStyle=D,y.fillRect(0,0,m.width,m.height),y.drawImage(n,0,0,m.width,m.height),y.restore(),e?(b=0,L.save(),L.drawImage(m,0,0),L.restore()):(b=x,N()),l(),f=a.klHistory.getState(),v.width=n.width,v.height=n.height}},s=function(){r(!0)},l=function(){if(w&&t){var e=t.context.canvas,n=i.BB.fitInto(e.width,e.height,g,g,1);O.width=Math.round(n.width),O.height=Math.round(n.height),P.save(),O.width>e.width?P.imageSmoothingEnabled=!1:(P.imageSmoothingEnabled=!0,P.imageSmoothingQuality="high"),P.fillStyle=G,P.fillRect(0,0,O.width,O.height),P.drawImage(e,0,0,O.width,O.height),P.restore();var r=u.getBoundingClientRect();i.BB.css(R,{top:Math.max(10,r.top+p/2-O.height/2)+"px"})}},c=function(){try{e.klRootEl.removeChild(R)}catch(e){}},u=i.BB.el({}),h=!0,p=40,d=p-10,g=300,f=-2,v={width:0,height:0},m=i.BB.canvas(),y=m.getContext("2d"),x=30,b=0,w=!1,B=300,C=i.BB.el({css:{display:"flex",alignItems:"center",height:p+"px",color:"#666"}}),S=i.BB.el({css:{minWidth:p+"px",height:p+"px",display:"flex",justifyContent:"center",alignItems:"center"}}),k=i.BB.canvas(d,d),L=k.getContext("2d");k.title=o.LANG("layers-active-layer"),i.BB.css(k,{boxShadow:"0 0 0 1px #9e9e9e",colorScheme:"only light"});var A=i.BB.el({css:{flexGrow:"1",paddingLeft:"10px",fontSize:"13px",overflow:"hidden",position:"relative"}}),T=i.BB.el({content:"",css:{cssFloat:"left",whiteSpace:"nowrap"}}),I=i.BB.el({css:{backgroundImage:"linear-gradient(to right, rgba(221,221,221,0) 0%, rgba(221,221,221,0.8) 100%)",position:"absolute",right:"0",top:"0",width:"50px",height:"100%"}}),E=i.BB.el({css:{position:"absolute",left:"10px",top:"0",width:"90px",height:"100%"}});e.onClick&&(i.BB.addEventListener(E,"click",(function(){e.onClick()})),i.BB.addEventListener(k,"click",(function(){e.onClick()})));var M=i.BB.el({content:o.LANG("opacity")+"<br>100%",css:{minWidth:"60px",fontSize:"12px",textAlign:"center",background:"#dddddd",color:"#555"}}),R=i.BB.el({onClick:i.BB.handleClick,css:{pointerEvents:"none",background:"#fff",position:"absolute",right:"280px",top:"10px",border:"1px solid #aaa",boxShadow:"1px 1px 3px rgba(0,0,0,0.3)",transition:"opacity "+B+"ms ease-in-out",userSelect:"none",display:"block",webkitTouchCallout:"none",colorScheme:"only light"}}),O=i.BB.canvas(g,g);R.append(O);var P=O.getContext("2d");i.BB.css(O,{display:"block"}),u.appendChild(C),C.appendChild(S),S.appendChild(k),C.appendChild(A),A.appendChild(T),A.appendChild(I),A.appendChild(E),C.appendChild(M);var D=y.createPattern(i.BB.createCheckerCanvas(4),"repeat"),G=L.createPattern(i.BB.createCheckerCanvas(4),"repeat");function N(){0!==b&&(b--,L.save(),L.globalAlpha=Math.pow((x-b)/x,2),L.drawImage(m,0,0),L.restore(),b>0&&requestAnimationFrame(N))}setInterval((function(){t&&(a.klHistory.getState()!==f&&(t.opacity=t.context.canvas.opacity,r(!1)))}),2e3);new i.BB.PointerListener({target:k,onEnterLeave:function(t){!function(t){w!==t&&(clearTimeout(n),w=t,t?n=setTimeout((function(){l(),R.style.opacity="0",e.klRootEl.appendChild(R),setTimeout((function(){R.style.opacity="1"}),20)}),250):(R.style.opacity="0",n=setTimeout(c,B+20)))}(t)}});this.getElement=function(){return u},this.setIsVisible=function(e){if(h!==e){h=e,C.style.display=h?"flex":"none",u.style.marginBottom=h?"":"10px";var t=a.klHistory.getState();e&&f!==t&&s()}},this.setLayer=function(e){t=e,s()},this.setUiState=function(e){"left"===""+e?i.BB.css(R,{left:"280px",right:""}):i.BB.css(R,{left:"",right:"280px"})}}})),r.register("j1kEL",(function(e,n){t(e.exports,"FittedImage",(function(){return a}));var i=r("eWjiX");function a(e){var t=i.BB.fitInto(e.image.width,e.image.height,e.width,e.height,1),n=parseInt(""+t.width),r=parseInt(""+t.height),a=i.BB.canvas(n,r);a.getContext("2d").drawImage(e.image,0,0,n,r),i.BB.css(a,{display:"block",boxShadow:"0 0 0 1px #aaa"}),this.getElement=function(){return a}}})),r.register("8ebuX",(function(e,n){t(e.exports,"showImportAsLayerDialog",(function(){return l}));var i=r("eWjiX"),a=r("kEeSq"),o=r("ekHRj"),s=r("1mH1z");function l(e){var t=function(e,t){v.move(e,t)},n=document.createElement("div");if(i.BB.appendTextDiv(n,s.LANG("import-as-layer-description")),e.klCanvas.isLayerLimitReached()){var r=i.BB.el({content:s.LANG("import-as-layer-limit-reached"),css:{background:"#ff0",padding:"10px",marginTop:"5px",marginBottom:"5px",border:"1px solid #e7d321",borderRadius:"5px"}});n.appendChild(r)}var l=window.innerWidth<550,c=i.BB.el({css:{display:"flex"}}),u=i.BB.el({tagName:"button",content:"1:1",css:{marginRight:"10px"},onClick:function(){v.reset()}}),h=i.BB.el({tagName:"button",content:s.LANG("import-as-layer-fit"),css:{marginRight:"10px"},onClick:function(){v.setTransformFit()}}),p=i.BB.el({tagName:"button",content:s.LANG("center"),css:{marginRight:"10px"},onClick:function(){v.setTransformCenter()}});c.appendChild(u),c.appendChild(h),c.appendChild(p),n.appendChild(c);for(var d=[],g=e.klCanvas.getLayers(),f=0;f<g.length;f++)d.push({image:g[f].context.canvas,opacity:g[f].opacity,mixModeStr:g[f].mixModeStr});d.push({image:e.importImage,opacity:1,mixModeStr:"source-over"});var v=new a.FreeTransformCanvas({elementWidth:l?340:540,elementHeight:l?280:350,imageWidth:e.klCanvas.getLayerContext(0).canvas.width,imageHeight:e.klCanvas.getLayerContext(0).canvas.height,layers:d,transformIndex:d.length-1});i.BB.css(v.getElement(),{marginTop:"10px",marginLeft:"-20px"}),n.appendChild(v.getElement());var m=new i.BB.KeyListener({onDown:function(e){"left"===e&&t(-1,0),"right"===e&&t(1,0),"up"===e&&t(0,-1),"down"===e&&t(0,1)}});o.popup({target:e.target,message:"<b>".concat(s.LANG("import-as-layer-title"),"</b>"),div:n,style:l?null:{width:"500px"},buttons:["Ok","Cancel"],clickOnEnter:"Ok",callback:function(t){m.destroy(),v.destroy(),i.BB.destroyEl(u),i.BB.destroyEl(h),i.BB.destroyEl(p),"Ok"===t?e.callback(v.getTransformation(),v.getIsPixelated()):e.callback()}})}})),r.register("13r5y",(function(e,n){t(e.exports,"KlImageDropper",(function(){return a}));var i=r("eWjiX");function a(e){var t=function(){u=0,h=0,p=0;try{e.target.removeChild(a)}catch(e){}},n=function(e){try{return!e.dataTransfer.types.includes("text/plain")}catch(e){}return!1},r=function(){var e="0 0 20px 4px #fff";h>0?(l.style.boxShadow=e,c.style.boxShadow=""):p>0?(l.style.boxShadow="",c.style.boxShadow=e):(l.style.boxShadow="",c.style.boxShadow="")},a=i.BB.el({content:"Drop to import",css:{paddingTop:"100px",position:"fixed",left:"0",top:"0",width:"100%",height:"100%",background:"rgba(50, 50, 50, 0.7)",color:"#fff",textShadow:"2px 2px #000",textAlign:"center",fontSize:"25px"}}),o=i.BB.el({css:{marginTop:"50px",display:"flex",justifyContent:"center"}}),s={width:"200px",padding:"50px",margin:"10px",borderRadius:"20px",border:"1px dashed #fff",background:"#00aefe",fontWeight:"bold"},l=i.BB.el({content:"As Layer",css:s}),c=i.BB.el({content:"As New Image",css:s});a.appendChild(o),o.appendChild(l),o.appendChild(c);var u=0,h=0,p=0;i.BB.addEventListener(l,"dragenter",(function(){h++,r()})),i.BB.addEventListener(l,"dragleave",(function(){h--,r()})),i.BB.addEventListener(c,"dragenter",(function(){p++,r()})),i.BB.addEventListener(c,"dragleave",(function(){p--,r()})),i.BB.addEventListener(window,"dragover",(function(e){n(e)&&(e.stopPropagation(),e.preventDefault())}),!1),i.BB.addEventListener(window,"dragenter",(function(t){e.enabledTest()&&n(t)&&(0===u&&e.target.appendChild(a),u++)}),!1),i.BB.addEventListener(window,"dragleave",(function(t){n(t)&&0!==u&&0===(u=Math.max(0,u-1))&&e.target.removeChild(a)}),!1),i.BB.addEventListener(window,"drop",(function(i){if(n(i)&&0!==i.dataTransfer.files.length){i.stopPropagation(),i.preventDefault();var o="default";h>0?o="layer":p>0&&(o="image"),e.onDrop(i.dataTransfer.files,o),u>0&&e.target.removeChild(a),u=0,h=0,p=0,r()}else t()}),!1),i.BB.addEventListener(a,"pointerdown",(function(){t()}));new i.BB.KeyListener({onDown:function(e){u>0&&"esc"===e&&t()}})}})),r.register("9p4Zp",(function(e,n){t(e.exports,"OverlayToolspace",(function(){return l}));var i=r("eWjiX"),a=r("kzhsD"),o=r("llzZ0"),s=r("1mH1z");function l(e){var t=function(e){h.setColor(e),p.style.backgroundColor="rgb("+e.r+","+e.g+","+e.b+")"},n=function(){c.style.display=l?"block":"none",l&&y&&(c.style.left=y.x-Math.round(r.width/2)+"px",c.style.top=y.y-Math.round(r.svHeight+3*r.hHeight/2)+"px")},r={width:150,svHeight:90,hHeight:20,sliderHeight:25},l=!1,c=i.BB.el({css:{position:"absolute",left:"500px",top:"500px",background:"rgb(221, 221, 221)",display:"none",border:"1px solid #fff",boxShadow:"0 0 10px rgba(0,0,0,0.5)",colorScheme:"only light"}}),u={color:null,size:null,opacity:null},h=new a.KlSmallColorSlider({width:r.width,heightSV:r.svHeight,heightH:r.hHeight,color:e.brushSettingService.getColor(),callback:function(t){p.style.backgroundColor="rgb("+t.r+","+t.g+","+t.b+")",e.brushSettingService.setColor(t,v)}}),p=i.BB.el({css:{width:r.width+"px",height:r.hHeight+"px",pointerEvents:"none"}}),d=e.brushSettingService.getColor();p.style.backgroundColor="rgb("+d.r+","+d.g+","+d.b+")",c.appendChild(p),c.appendChild(h.getElement());var g=new o.KlSlider({label:s.LANG("brush-size"),width:r.width,height:r.sliderHeight,min:0,max:500,initValue:50,resolution:225,eventResMs:1e3/30,onChange:function(t){e.brushSettingService.setSize(t)},formatFunc:function(e){return 2*e<10?Math.round(20*e)/10:Math.round(2*e)}});i.BB.css(g.getElement(),{marginTop:"2px"}),c.appendChild(g.getElement());var f=new o.KlSlider({label:s.LANG("opacity"),width:r.width,height:r.sliderHeight,min:0,max:1,initValue:1,resolution:225,eventResMs:1e3/30,onChange:function(t){e.brushSettingService.setOpacity(t)},formatFunc:function(e){return Math.round(100*e)}});i.BB.css(f.getElement(),{margin:"2px 0"}),c.appendChild(f.getElement());var v=function(e){"color"===e.type&&(l?t(e.value):u.color=e.value),"size"===e.type&&(l?g.setValue(e.value):u.size=e.value),"opacity"===e.type&&(l?f.setValue(e.value):u.opacity=e.value),"sliderConfig"===e.type&&(g.update(e.value.sizeSlider),f.update(e.value.opacitySlider))};e.brushSettingService.subscribe(v);var m=e.brushSettingService.getSliderConfig();g.update(m.sizeSlider),f.update(m.opacitySlider),g.setValue(e.brushSettingService.getSize()),f.setValue(e.brushSettingService.getOpacity());var y=null;i.BB.addEventListener(document,"pointermove",(function(e){y={x:e.pageX,y:e.pageY}}));new i.BB.KeyListener({onDown:function(r,i,a,o){if(!o)return l?(l=!1,void n()):void(e.enabledTest()&&y&&["ctrl+alt","cmd+alt","alt+ctrl","alt+cmd"].includes(a)&&(i.preventDefault(),l=!0,null!==u.color&&(t(u.color),u.color=null),null!==u.size&&(g.setValue(u.size),u.size=null),null!==u.opacity&&(f.setValue(u.opacity),u.opacity=null),n()))},onUp:function(e,t,r){["ctrl+alt","cmd+alt","alt+ctrl","alt+cmd"].includes(r)&&l&&(l=!1,h.end(),n())},onBlur:function(){l&&(l=!1,h.end(),n())}});this.getElement=function(){return c}}})),r.register("8jqzp",(function(n,i){t(n.exports,"ToolspaceTopRow",(function(){return d}));var a=r("eWjiX"),o=r("8oUiM"),s=r("1gUFn"),l=r("gswMe"),c=r("lLh5u"),u=r("5xpQb"),h=r("kS5uZ"),p=r("1mH1z");function d(t){var n=function(e){var t=6+(e.extraPadding?e.extraPadding:0),n=a.BB.el({className:"toolspace-row-button nohighlight",title:e.title,onClick:e.onClick,css:{padding:e.contain?t+"px 0":""}}),r=a.BB.el({css:{backgroundImage:"url('"+e.image+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:e.contain?"contain":"",height:"100%"}});return r.style.pointerEvents="none",n.appendChild(r),n.pointerListener=new a.BB.PointerListener({target:n,onEnterLeave:function(e){e?a.BB.addClassName(n,"toolspace-row-button-hover"):a.BB.removeClassName(n,"toolspace-row-button-hover")}}),n},r=document.createElement("div");a.BB.css(r,{height:"36px",display:"flex",backgroundImage:"linear-gradient(to top, rgba(255, 255, 255, 0) 20%, rgba(255, 255, 255, 0.6) 100%)"});var i=n({onClick:t.onLogo,title:p.LANG("home"),image:t.logoImg?t.logoImg:e(o),contain:!0});i.style.width="45px",i.style.borderRight="1px solid rgb(212, 212, 212)";var d=n({onClick:t.onNew,title:p.LANG("file-new"),image:e(s),extraPadding:1,contain:!0}),g=n({onClick:t.onImport,title:p.LANG("file-import"),image:e(l),extraPadding:1,contain:!0}),f=n({onClick:t.onSave,title:p.LANG("file-save"),image:e(c),extraPadding:1,contain:!0}),v=null;a.BB.canShareFiles()&&(v=n({onClick:t.onShare,title:p.LANG("file-share"),image:e(u),contain:!0}));var m=n({onClick:t.onHelp,title:p.LANG("help"),image:e(h),contain:!0});r.appendChild(i),r.appendChild(d),r.appendChild(g),r.appendChild(f),v&&r.appendChild(v),r.appendChild(m),this.getElement=function(){return r}}})),r.register("8oUiM",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("eHdqz")})),r.register("1gUFn",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("3x5dR")})),r.register("gswMe",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("hbDTd")})),r.register("lLh5u",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("16iGk")})),r.register("5xpQb",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("2ME3z")})),r.register("kS5uZ",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("hZnSk")})),r.register("84zxV",(function(n,i){t(n.exports,"ToolDropdown",(function(){return d}));var a=r("eWjiX"),o=r("i8UFO"),s=r("fxAg2"),l=r("fuF9j"),c=r("adBnR"),u=r("cafM1"),h=r("gzZrf"),p=r("1mH1z");function d(t){var n=function(e){var t={},n=a.BB.el({parent:M,className:"tool-dropdown-button",title:e.title,css:{padding:"10px 0",height:100/(f.length-1)+"%",boxSizing:"border-box"},onClick:function(t){t.preventDefault(),t.stopPropagation(),e.onClick(e.index,e.id)}});t.wrapper=n;a.BB.el({parent:n,css:{backgroundImage:"url('"+e.image+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain",height:"100%",pointerEvents:"none",opacity:"0.75"}});return t.show=function(e){n.style.display=e?"block":"none"},t.setIsSmall=function(e){n.style.padding=e?S:"10px 0"},t},r=function(e,n){d(),x=!0,y=e,g(),t.onChange(f[y])},i=function(){o.dialogCounter.increase(.5),b=!0;for(var e=0;e<f.length;e++)R[e].show(y!==e);I.style.display="none",k.style.zIndex="1",document.body.appendChild(E),k.appendChild(M)},d=function(){o.dialogCounter.decrease(.5),b=!1,I.style.removeProperty("display"),k.style.removeProperty("z-index"),document.body.removeChild(E),k.removeChild(M)},g=function(){A.title=m[y],T.style.backgroundImage="url('"+v[y]+"')"},f=["draw","fill","text","shape"],v=[e(s),e(l),e(c),e(u)],m=["".concat(p.LANG("tool-brush")," [B]"),"".concat(p.LANG("tool-paint-bucket")," [G]"),"".concat(p.LANG("tool-text")," [T]"),"".concat(p.LANG("tool-shape")," [U]")],y=0,x=!0,b=!1;setTimeout((function(){for(var e=1;e<v.length;e++){(new Image).src=v[e]}}),100);var w,B,C,S="6px 0",k=a.BB.el({css:{position:"relative",flexGrow:"1"}}),L=!1;a.BB.hasPointerEvents&&new a.BB.PointerListener({target:k,maxPointers:1,onPointer:function(e){if("pointerdown"===e.type){if(b)return;w=setTimeout((function(){i()}),400),L=!0,B=e.pageX,C=e.pageY}else if("pointermove"===e.type)L&&!b&&a.BB.dist(B,C,e.pageX,e.pageY)>5&&(clearTimeout(w),i());else if("pointerup"===e.type){if(clearTimeout(w),b&&L)for(var n=document.elementFromPoint(e.pageX,e.pageY),r=0;r<R.length;r++)if(n===R[r].wrapper){d(),x=!0,y=r,g(),t.onChange(f[y]);break}L=!1}}});for(var A=a.BB.el({parent:k,className:"toolspace-row-button nohighlight toolspace-row-button-activated",title:m[y],onClick:function(e){if(x&&!b)return e.preventDefault(),e.stopPropagation(),void i();x=!0,t.onChange(f[y]),b&&d()},css:{padding:"10px 0",pointerEvents:"auto",height:"100%",boxSizing:"border-box"}}),T=a.BB.el({parent:A,css:{backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain",width:"calc(100% - 7px)",height:"100%",pointerEvents:"none",opacity:"0.75"}}),I=a.BB.el({parent:A,css:{position:"absolute",right:"1px",bottom:"1px",width:"18px",height:"18px",cursor:"pointer",backgroundImage:"url('"+e(h)+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"60%"},title:"More Tools",onClick:function(e){e.preventDefault(),e.stopPropagation(),i()}}),E=a.BB.el({css:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0"}}),M=(new a.BB.PointerListener({target:E,pointers:1,onPointer:function(e){"pointerdown"===e.type&&(e.eventPreventDefault(),d())}}),a.BB.el({className:"tool-dropdown-wrapper",css:{position:"absolute",width:"100%",height:100*(f.length-1)+"%",top:"100%",left:"0",zIndex:"1",boxSizing:"border-box",cursor:"pointer",transition:"height 0.1s ease-in-out, opacity 0.1s ease-in-out",borderBottomLeftRadius:"5px",borderBottomRightRadius:"5px",overflow:"hidden"}})),R=[],O=0;O<f.length;O++)R.push(n({index:O,id:f[O],image:v[O],title:m[O],onClick:r}));g(),this.setIsSmall=function(e){A.style.padding=e?S:"10px 0";for(var t=0;t<f.length;t++)R[t].setIsSmall(e);e?(I.style.width="14px",I.style.height="14px"):(I.style.width="18px",I.style.height="18px")},this.setActive=function(e){if(f.includes(e)){x=!0;for(var t=0;t<f.length;t++)if(f[t]===e){y=t;break}a.BB.addClassName(A,"toolspace-row-button-activated"),g()}else x=!1,a.BB.removeClassName(A,"toolspace-row-button-activated")},this.getActive=function(){return f[y]},this.getElement=function(){return k}}})),r.register("fxAg2",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("6mHrC")})),r.register("fuF9j",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("hS5Hj")})),r.register("adBnR",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("doX4v")})),r.register("cafM1",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("7NqHO")})),r.register("gzZrf",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("dz3mY")})),r.register("9Kxky",(function(n,i){t(n.exports,"ToolspaceToolRow",(function(){return p}));var a=r("eWjiX"),o=r("84zxV"),s=r("2dTGs"),l=r("3KoFh"),c=r("eWf2I"),u=r("fc34V"),h=r("1mH1z");function p(t){var n=function(e,n){d!==e&&(d=e,g.setActive(d),"hand"===d?a.BB.addClassName(f,"toolspace-row-button-activated"):a.BB.removeClassName(f,"toolspace-row-button-activated"),n&&t.onActivate(d))},r=function(e){var t=e.doLighten?"6px 0":"8px 0",n=a.BB.el({className:"toolspace-row-button nohighlight",onClick:e.onClick,css:{padding:e.contain?"10px 0":""}}),r=a.BB.el({css:{backgroundImage:"url('"+e.image+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:e.contain?"contain":"",height:"100%",transform:e.doMirror?"scale(-1, 1)":"",pointerEvents:"none",opacity:e.doLighten?"0.75":"1"}});return n.appendChild(r),n.pointerListener=new a.BB.PointerListener({target:n,onEnterLeave:function(e){e?a.BB.addClassName(n,"toolspace-row-button-hover"):a.BB.removeClassName(n,"toolspace-row-button-hover")}}),n.setIsSmall=function(r){n.style.padding=e.contain?r?t:"10px 0":""},n},i=function(e){var t=document.createElement("div");a.BB.css(t,{flexGrow:"1",position:"relative"});var n=a.BB.createSvg({elementType:"svg",width:"67px",height:"54px",viewBox:"0 0 100 100",preserveAspectRatio:"none"});a.BB.css(n,{position:"absolute",left:"0",top:"0"});var r=a.BB.createSvg({elementType:"defs",childrenArr:[{elementType:"filter",id:"innershadow",x0:"-50%",y0:"-50%",width:"200%",height:"200%",childrenArr:[{elementType:"feGaussianBlur",in:"SourceAlpha",stdDeviation:"10",result:"blur"},{elementType:"feOffset",dx:"2",dy:"2"},{elementType:"feComposite",in2:"SourceAlpha",operator:"arithmetic",k2:"-1",k3:"1",result:"shadowDiff"},{elementType:"feFlood","flood-color":"#000","flood-opacity":"0.2"},{elementType:"feComposite",in2:"shadowDiff",operator:"in"},{elementType:"feComposite",in2:"SourceGraphic",operator:"over",result:"firstfilter"},{elementType:"feGaussianBlur",in:"firstfilter",stdDeviation:"10",result:"blur2"},{elementType:"feOffset",dx:"2",dy:"2"},{elementType:"feComposite",in2:"firstfilter",operator:"arithmetic",k2:"-1",k3:"1",result:"shadowDiff"},{elementType:"feFlood","flood-color":"#000","flood-opacity":"0.2"},{elementType:"feComposite",in2:"shadowDiff",operator:"in"},{elementType:"feComposite",in2:"firstfilter",operator:"over"}]}]}),i=a.BB.createSvg({elementType:"path","vector-effect":"non-scaling-stroke",d:"M0,0 L 100,0 0,100 z",fill:"rgba(0,0,0,0)",class:"toolspace-svg-triangle-button"});i.onclick=function(){e.onLeft(),a.BB.removeClassName(i,"toolspace-svg-triangle-button-hover")};var o=a.BB.createSvg({elementType:"path","vector-effect":"non-scaling-stroke",d:"M100,100 L 100,0 0,100 z",fill:"rgba(0,0,0,0)",class:"toolspace-svg-triangle-button"});o.onclick=function(){e.onRight(),a.BB.removeClassName(o,"toolspace-svg-triangle-button-hover")},t.leftPointerListener=new a.BB.PointerListener({target:i,onEnterLeave:function(e){e?a.BB.addClassName(i,"toolspace-svg-triangle-button-hover"):a.BB.removeClassName(i,"toolspace-svg-triangle-button-hover")}}),t.rightPointerListener=new a.BB.PointerListener({target:o,onEnterLeave:function(e){e?a.BB.addClassName(o,"toolspace-svg-triangle-button-hover"):a.BB.removeClassName(o,"toolspace-svg-triangle-button-hover")}}),n.appendChild(r),n.appendChild(i),n.appendChild(o),t.appendChild(n);var s=a.BB.el({css:{backgroundImage:"url('"+e.leftImage+"')",backgroundRepeat:"no-repeat",backgroundSize:"contain",width:"20px",height:"20px",position:"absolute",left:"10px",top:"8px",pointerEvents:"none"}});t.appendChild(s);var l=a.BB.el({css:{backgroundImage:"url('"+(e.rightImage?e.rightImage:e.leftImage)+"')",backgroundRepeat:"no-repeat",backgroundSize:"contain",width:"20px",height:"20px",position:"absolute",right:"10px",bottom:"8px",transform:e.rightImage?"":"scale(-1, 1)",pointerEvents:"none"}});return t.appendChild(l),t.setIsEnabledLeft=function(e){e?(a.BB.removeClassName(i,"toolspace-row-button-disabled"),a.BB.removeClassName(s,"toolspace-row-button-disabled")):(a.BB.addClassName(i,"toolspace-row-button-disabled"),a.BB.addClassName(s,"toolspace-row-button-disabled"))},t.setIsEnabledRight=function(e){e?(a.BB.removeClassName(o,"toolspace-row-button-disabled"),a.BB.removeClassName(l,"toolspace-row-button-disabled")):(a.BB.addClassName(o,"toolspace-row-button-disabled"),a.BB.addClassName(l,"toolspace-row-button-disabled"))},t},p=document.createElement("div");a.BB.css(p,{height:"54px",display:"flex",backgroundImage:"linear-gradient(to top, rgba(255, 255, 255, 0) 20%, rgba(255, 255, 255, 0.6) 100%)"});var d="draw",g=new o.ToolDropdown({onChange:function(e){n(e,!0)}});p.appendChild(g.getElement());var f=r({onClick:function(){n("hand",!0)},image:e(s),contain:!0,doLighten:!0});f.style.borderRight="1px solid rgb(212, 212, 212)",f.title=h.LANG("tool-hand"),p.appendChild(f);var v=i({onLeft:t.onZoomIn,onRight:t.onZoomOut,leftImage:e(l),rightImage:e(c)});v.title=h.LANG("tool-zoom"),p.appendChild(v);var m=r({onClick:t.onZoomIn,image:e(l),contain:!0});m.title=h.LANG("zoom-in"),p.appendChild(m);var y=r({onClick:t.onZoomOut,image:e(c),contain:!0});y.title=h.LANG("zoom-out"),p.appendChild(y);var x=i({onLeft:t.onUndo,onRight:t.onRedo,leftImage:e(u),rightImage:null});x.title=h.LANG("tool-undo-redo"),x.setIsEnabledLeft(!1),x.setIsEnabledRight(!1),p.appendChild(x);var b=r({onClick:t.onUndo,image:e(u),contain:!0});b.title=h.LANG("undo"),a.BB.addClassName(b,"toolspace-row-button-disabled"),p.appendChild(b);var w=r({onClick:t.onRedo,image:e(u),contain:!0,doMirror:!0});w.title=h.LANG("redo"),a.BB.addClassName(w,"toolspace-row-button-disabled"),p.appendChild(w),m.style.display="none",y.style.display="none",b.style.display="none",w.style.display="none",this.getElement=function(){return p},this.setIsSmall=function(e){a.BB.css(p,{height:e?"36px":"54px"}),g.setIsSmall(e),f.setIsSmall(e),m.setIsSmall(e),y.setIsSmall(e),b.setIsSmall(e),w.setIsSmall(e),e?(v.style.display="none",x.style.display="none",m.style.display="block",y.style.display="block",b.style.display="block",w.style.display="block"):(v.style.display="block",x.style.display="block",m.style.display="none",y.style.display="none",b.style.display="none",w.style.display="none")},this.setEnableZoomIn=function(e){e?a.BB.removeClassName(m,"toolspace-row-button-disabled"):a.BB.addClassName(m,"toolspace-row-button-disabled"),v.setIsEnabledLeft(e)},this.setEnableZoomOut=function(e){e?a.BB.removeClassName(y,"toolspace-row-button-disabled"):a.BB.addClassName(y,"toolspace-row-button-disabled"),v.setIsEnabledRight(e)},this.setEnableUndo=function(e){e?a.BB.removeClassName(b,"toolspace-row-button-disabled"):a.BB.addClassName(b,"toolspace-row-button-disabled"),x.setIsEnabledLeft(e)},this.setEnableRedo=function(e){e?a.BB.removeClassName(w,"toolspace-row-button-disabled"):a.BB.addClassName(w,"toolspace-row-button-disabled"),x.setIsEnabledRight(e)},this.setActive=function(e){n(e)},this.getActive=function(){return d}}})),r.register("2dTGs",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("2gZH2")})),r.register("3KoFh",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("04ZZm")})),r.register("eWf2I",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("j9xio")})),r.register("fc34V",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("AnO0a")})),r.register("1Ax5m",(function(e,n){t(e.exports,"ToolspaceStabilizerRow",(function(){return s}));var i=r("eWjiX"),a=r("21VAD"),o=r("1mH1z");function s(e){var t=i.BB.el({tagName:"label",content:o.LANG("stabilizer")+"&nbsp;",title:o.LANG("stabilizer-title"),css:{display:"flex",alignItems:"center",fontSize:"13px",color:"rgba(0,0,0,0.6)"}}),n=new a.Select({optionArr:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"]],initValue:e.smoothing,onChange:function(t){e.onSelect(parseInt(t))}});t.appendChild(n.getElement());new i.BB.PointerListener({target:t,onWheel:function(e){n.setDeltaValue(e.deltaY)}});this.getElement=function(){return t}}})),r.register("e4sAN",(function(n,i){t(n.exports,"TabRow",(function(){return s}));var a=r("eWjiX"),o=r("4m0AU");function s(t){for(var n=function(e,t,n){var r={id:e.id,isVisible:!("isVisible"in e)||e.isVisible,onOpen:e.onOpen,onClose:e.onClose,update:function(e){o.className=e===r?n?"tabrow-tab tabrow-tab-opened-accented":"tabrow-tab tabrow-tab-opened":"tabrow-tab",o.style.display=r.isVisible?"block":"none"}},o=a.BB.el({content:"label"in e?e.label:"",title:"title"in e?e.title:void 0,className:t===r.id?n?"tabrow-tab tabrow-tab-opened-accented":"tabrow-tab tabrow-tab-opened":"tabrow-tab",css:{lineHeight:s+"px",display:r.isVisible?"block":"none",zIndex:"0"},onClick:function(){u!==r&&i.open(r.id)}});r.div=o,"image"in e&&a.BB.css(o,{backgroundImage:"url('"+e.image+"')",backgroundSize:s-7+"px"}),"css"in e&&a.BB.css(o,e.css),l.appendChild(o);new a.BB.PointerListener({target:o,onEnterLeave:function(e){e?a.BB.addClassName(o,"tabrow-tab-hover"):a.BB.removeClassName(o,"tabrow-tab-hover")}});return t===r.id?(r.onOpen(),r.div.appendChild(h),r.div.appendChild(p)):r.onClose(),r},r=function(){for(var e=0;e<c.length;e++)c[e].update(u)},i=this,s=35,l=a.BB.el({className:"tabrow",css:{height:s+"px"}}),c=[],u=null,h=a.BB.el({css:{width:"10px",height:"10px",backgroundImage:"url('".concat(e(o),"')"),backgroundSize:"cover",position:"absolute",right:"-10px",bottom:"0",pointerEvents:"none"}}),p=a.BB.el({css:{width:"10px",height:"10px",backgroundImage:"url('".concat(e(o),"')"),backgroundSize:"cover",position:"absolute",left:"-10px",bottom:"0",transform:"scale(-1,1)",pointerEvents:"none"}}),d=0;d<t.tabArr.length;d++)c.push(n(t.tabArr[d],t.initialId,t.useAccent));for(var g=0;g<c.length;g++)c[g].id===t.initialId&&(u=c[g]);if(null===u)throw"invalid initialId";this.getElement=function(){return l},this.open=function(e){for(var t=0;t<c.length;t++)if(c[t].id===e){if(u===c[t])return;return u.onClose(),(u=c[t]).onOpen(),u.div.appendChild(h),u.div.appendChild(p),void r()}throw"TabRow.open - invalid tabId"},this.getOpenedTabId=function(){return""+u.id},this.setIsVisible=function(e,t){for(var n=0;n<c.length;n++)if(c[n].id===e)return c[n].isVisible=!!t,void r();throw"TabRow.setIsVisible - invalid tabId"}}})),r.register("4m0AU",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("nTvP2")})),r.register("khi8I",(function(n,i){t(n.exports,"HandUi",(function(){return c}));var a=r("eWjiX"),o=r("bv5Zj"),s=r("2n4Fs"),l=r("1mH1z");function c(t){var n=function(){g.innerHTML=Math.round(100*c)+"%",v.innerHTML=Math.round(u)+"°",f.style.transform="rotate("+u+"deg)",f.style.boxShadow=u%90==0?"inset 0 0 0 1px rgba(255,255,255, 1), 0 0 0 1px rgba(0, 0, 0, 0.3)":""},r=a.BB.el({css:{margin:"10px"}}),i=!0,c=t.scale,u=t.angleDeg,h=a.BB.el({css:{marginBottom:"10px",display:"flex"}}),p=a.BB.el({css:{display:"flex",marginBottom:"10px"}}),d=a.BB.el({css:{display:"flex"}});r.append(h,p,d);var g=a.BB.el({css:{width:"55px",userSelect:"none"}});h.appendChild(g);var f=new Image;f.src=e(o),a.BB.css(f,{verticalAlign:"bottom",width:"20px",height:"20px",marginRight:"5px",borderRadius:"10px",background:"rgba(0,0,0,0.2)",userSelect:"none"}),h.appendChild(f);var v=a.BB.el({css:{userSelect:"none"}});h.appendChild(v),n();var m=a.BB.el({tagName:"button",content:l.LANG("hand-reset"),onClick:t.onReset});a.BB.makeUnfocusable(m);var y=a.BB.el({tagName:"button",content:l.LANG("hand-fit"),css:{marginLeft:"10px"},onClick:t.onFit});a.BB.makeUnfocusable(y),p.append(m,y);var x=a.BB.el({tagName:"button",content:'<img height="20" src="'+e(s)+'" alt="Rotate" style="transform: scale(-1, 1)"/>',onClick:function(){t.onAngleChange(-15,!0)}});a.BB.makeUnfocusable(x);var b=a.BB.el({tagName:"button",content:"0°",css:{marginLeft:"10px"},onClick:function(){t.onAngleChange(0)}});a.BB.makeUnfocusable(b);var w=a.BB.el({tagName:"button",content:'<img height="20" src="'+e(s)+'" alt="Rotate"/>',css:{marginLeft:"10px"},onClick:function(){t.onAngleChange(15,!0)}});a.BB.makeUnfocusable(w),d.append(x,b,w),this.getElement=function(){return r},this.setIsVisible=function(e){i=!!e,r.style.display=i?"block":"none",i&&n()},this.update=function(e,t){c=e,u=t,i&&n()}}})),r.register("2n4Fs",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("6toXQ")})),r.register("dJXmR",(function(e,n){t(e.exports,"FillUi",(function(){return c}));var i=r("eWjiX"),a=r("llzZ0"),o=r("21VAD"),s=r("lXqiv"),l=r("1mH1z");function c(e){var t=i.BB.el({css:{margin:"10px"}}),n=!0,r=i.BB.el({parent:t,css:{marginBottom:"10px"}}),c=new a.KlSlider({label:l.LANG("opacity"),width:250,height:30,min:0,max:1,initValue:1,onChange:function(e){},formatFunc:function(e){return Math.round(100*e)}});t.appendChild(c.getElement());var u=new a.KlSlider({label:l.LANG("bucket-tolerance"),width:250,height:30,min:0,max:255,initValue:51,onChange:function(e){},formatFunc:function(e){return Math.round(e/255*100)}});i.BB.css(u.getElement(),{marginTop:"10px"}),t.appendChild(u.getElement());var h,p,d=i.BB.el({parent:t,css:{display:"flex",marginTop:"10px"}});h=i.BB.el({content:l.LANG("bucket-sample")+"&nbsp;",title:l.LANG("bucket-sample-title"),css:{fontSize:"15px"}}),p=new o.Select({optionArr:[["all",l.LANG("bucket-sample-all")],["current",l.LANG("bucket-sample-active")],["above",l.LANG("bucket-sample-above")]],initValue:"all",onChange:function(e){}});var g,f;new i.BB.PointerListener({target:p.getElement(),onWheel:function(e){p.setDeltaValue(e.deltaY)}});h.appendChild(p.getElement()),d.appendChild(h),g=i.BB.el({content:l.LANG("bucket-grow")+"&nbsp;",title:l.LANG("bucket-grow-title"),css:{fontSize:"15px",marginLeft:"10px"}}),f=new o.Select({optionArr:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"]],initValue:"0",onChange:function(e){}});new i.BB.PointerListener({target:f.getElement(),onWheel:function(e){f.setDeltaValue(e.deltaY)}});g.appendChild(f.getElement()),d.appendChild(g);var v=!0,m=new s.Checkbox({init:!0,label:l.LANG("bucket-contiguous"),title:l.LANG("bucket-contiguous-title"),callback:function(e){v=e},css:{marginTop:"10px",paddingRight:"5px",display:"inline-block"}});t.appendChild(m.getElement()),this.getElement=function(){return t},this.setIsVisible=function(i){n=!!i,t.style.display=n?"block":"none",n&&(r.appendChild(e.colorSlider.getElement()),r.appendChild(e.colorSlider.getOutputElement()))},this.getTolerance=function(){return u.getValue()},this.getOpacity=function(){return c.getValue()},this.getSample=function(){return p.getValue()},this.getGrow=function(){return parseInt(f.getValue(),10)},this.getContiguous=function(){return v}}})),r.register("iS9xS",(function(e,n){t(e.exports,"TextUi",(function(){return o}));var i=r("eWjiX"),a=r("1mH1z");function o(e){var t=i.BB.el({css:{margin:"10px"}}),n=!0,r=i.BB.el({parent:t,css:{marginBottom:"10px"}});i.BB.el({parent:t,content:a.LANG("text-instruction")});this.getElement=function(){return t},this.setIsVisible=function(i){n=!!i,t.style.display=n?"block":"none",n&&(r.appendChild(e.colorSlider.getElement()),r.appendChild(e.colorSlider.getOutputElement()))}}})),r.register("9J17G",(function(e,n){t(e.exports,"ShapeUi",(function(){return c}));var i=r("eWjiX"),a=r("iskOY"),o=r("lXqiv"),s=r("llzZ0"),l=r("1mH1z");function c(e){var t,n,r=function(){var e=i.BB.clamp(Math.round(A.getValue()/10),1,10)+"px",t=1.35;i.BB.css(g,{fill:"none",stroke:"black",strokeWidth:e}),i.BB.css(v,{fill:"black",stroke:"none"}),i.BB.css(y,{fill:"none",stroke:"black",strokeWidth:e}),i.BB.css(b,{fill:"black",stroke:"none"}),i.BB.css(B,{fill:"none",stroke:"black",strokeWidth:e}),M.getValue()?(g.setAttribute("y",""+d),g.setAttribute("height",""+(p-2*d)),v.setAttribute("y",""+d),v.setAttribute("height",""+(p-2*d)),y.setAttribute("ry",""+(p/2-d)),b.setAttribute("ry",""+(p/2-d))):(g.setAttribute("y",""+d*t),g.setAttribute("height",""+(p-d*t*2)),v.setAttribute("y",""+d*t),v.setAttribute("height",""+(p-d*t*2)),y.setAttribute("ry",""+(p/2-d*t)),b.setAttribute("ry",""+(p/2-d*t))),R.getValue()?(B.setAttribute("y1",""+(p-d)),B.setAttribute("y2",""+d)):(B.setAttribute("y1",""+(p-d*t)),B.setAttribute("y2",""+d*t))},c=i.BB.el({css:{margin:"10px"}}),u=!0,h=i.BB.el({parent:c,css:{marginBottom:"10px"}}),p=35,d=8,g=i.BB.createSvg({elementType:"rect",x:""+d,width:""+(p-2*d)}),f=i.BB.createSvg({elementType:"svg",width:""+p,height:""+p});f.appendChild(g),i.BB.css(f,{display:"block"});var v=i.BB.createSvg({elementType:"rect",x:""+d,width:""+(p-2*d)}),m=i.BB.createSvg({elementType:"svg",width:""+p,height:""+p});m.appendChild(v),i.BB.css(m,{display:"block"});var y=i.BB.createSvg({elementType:"ellipse",cx:""+p/2,cy:""+p/2,rx:""+(p/2-d)}),x=i.BB.createSvg({elementType:"svg",width:""+p,height:""+p});x.appendChild(y),i.BB.css(x,{display:"block"});var b=i.BB.createSvg({elementType:"ellipse",cx:""+p/2,cy:""+p/2,rx:""+(p/2-d)}),w=i.BB.createSvg({elementType:"svg",width:""+p,height:""+p});w.appendChild(b),i.BB.css(w,{display:"block"});var B=i.BB.createSvg({elementType:"line",x1:""+d,x2:""+(p-d)}),C=i.BB.createSvg({elementType:"svg",width:""+p,height:""+p});C.appendChild(B),i.BB.css(C,{display:"block"});var S=i.BB.el({parent:c,css:{display:"flex",justifyContent:"space-between",alignItems:"start"}}),k=new a.Options({optionArr:[{id:"rect-stroke",label:f,title:l.LANG("shape-rect")+" "+l.LANG("shape-stroke")},{id:"ellipse-stroke",label:x,title:l.LANG("shape-ellipse")+" "+l.LANG("shape-stroke")},{id:"line",label:C,title:l.LANG("shape-line")},{id:"rect-fill",label:m,title:l.LANG("shape-rect")+" "+l.LANG("shape-fill")},{id:"ellipse-fill",label:w,title:l.LANG("shape-ellipse")+" "+l.LANG("shape-fill")}],initId:"rect",onChange:function(e){var r=e.split("-");t=r[0],n=r[1],i.BB.css(M.getElement(),{display:"line"===t?"none":null}),i.BB.css(R.getElement(),{display:"line"===t?null:"none"}),i.BB.css(A.getElement(),{display:"line"!==t&&"fill"===n?"none":null})},changeOnInit:!0});k.getElement().style.width="120px",S.appendChild(k.getElement());var L=new o.Checkbox({init:!1,label:l.LANG("eraser"),callback:function(e){r()}});S.appendChild(L.getElement());var A=new s.KlSlider({label:l.LANG("shape-line-width"),width:250,height:30,min:1,max:200,initValue:4,curve:"quadratic",onChange:function(e){r()},formatFunc:function(e){return Math.round(e)}});i.BB.css(A.getElement(),{marginTop:"10px"}),c.appendChild(A.getElement());var T=new s.KlSlider({label:l.LANG("opacity"),width:250,height:30,min:0,max:1,initValue:1,onChange:function(e){},formatFunc:function(e){return Math.round(100*e)}});i.BB.css(T.getElement(),{marginTop:"10px"}),c.appendChild(T.getElement());var I=i.BB.el({parent:c,css:{display:"flex",alignItems:"center",marginTop:"10px"}}),E=new o.Checkbox({init:!1,label:l.LANG("shape-outwards"),callback:function(e){},css:{width:"50%",marginRight:"10px"}});I.appendChild(E.getElement());var M=new o.Checkbox({init:!1,label:l.LANG("shape-fixed"),callback:function(e){r()},css:{flexGrow:"1"}});I.appendChild(M.getElement());var R=new o.Checkbox({init:!1,label:l.LANG("shape-snap"),title:l.LANG("shape-snap-title"),callback:function(e){r()},css:{flexGrow:"1"}});I.appendChild(R.getElement()),r(),this.getElement=function(){return c},this.setIsVisible=function(t){u=!!t,c.style.display=u?"block":"none",u&&(h.appendChild(e.colorSlider.getElement()),h.appendChild(e.colorSlider.getOutputElement()))},this.getShape=function(){return t},this.getMode=function(){return n},this.getIsEraser=function(){return L.getValue()},this.getOpacity=function(){return T.getValue()},this.getLineWidth=function(){return A.getValue()},this.getIsOutwards=function(){return E.getValue()},this.getIsFixed=function(){return M.getValue()},this.getIsSnap=function(){return R.getValue()}}})),r.register("76Qvv",(function(e,n){t(e.exports,"newImageDialog",(function(){return c}));var i=r("eWjiX"),a=r("21VAD"),o=r("9A7OD"),s=r("ekHRj"),l=r("1mH1z");function c(e){var t=function(e,t,n,r,a){return i.BB.fitInto(e,t,Math.min(u,n-a),Math.min(u,r-a),1)},n=function(){b.value=""+Math.min(u,parseInt(b.value)),B.value=""+Math.min(u,parseInt(B.value));var e=parseInt(b.value),t=parseInt(B.value);(e<1||e>u||t<1||t>u)&&(e>u?e=u:t>u&&(t=u),b.value=""+e,B.value=""+t);for(var n=[[1,2],[2,1],[2,3],[3,2],[3,4],[4,3],[4,5],[5,4],[16,9],[9,16],[3,2],[2,3],[5,3],[3,5],[2,1],[1,2],[1.414,1],[1,1.414]],r=i.BB.reduce(e,t),a=null,o=null,s=0;s<n.length;s++)(0===s||Math.abs(n[s][0]/n[s][1]-r[0]/r[1])<o)&&(a=n[s],o=Math.abs(n[s][0]/n[s][1]-r[0]/r[1]));S.innerText=o>0&&o<.005?l.LANG("new-ratio")+": ~"+a[0]+":"+a[1]:l.LANG("new-ratio")+": "+r[0]+":"+r[1],e,t;var c=e,h=function(e,t){for(var n=e,r=t;;){if(!(n%=r))return r;if(!(r%=n))return n}}(e,t);e/=h,t/=h,t*=260,(e*=260)>260&&(t*=260/e,e=260),t>100&&(e*=100/t,t=100),N.style.width=e+"px",N.style.height=t+"px",i.BB.createCheckerDataUrl(parseInt(""+e/c*30),(function(e){G.style.background="url("+e+")"}))},r=e.currentColor,c=e.secondaryColor,u=e.maxCanvasSize,h=e.canvasWidth,p=e.canvasHeight,d=e.workspaceWidth,g=e.workspaceHeight,f=e.onConfirm,v=e.onCancel,m=document.createElement("div"),y=document.createElement("div"),x=document.createElement("div"),b=document.createElement("input"),w=document.createElement("div"),B=document.createElement("input"),C=document.createElement("div");y.style.position="relative",y.style.width="145px",y.style.height="35px",y.style.lineHeight="30px",x.style.width="145px",x.style.height="35px",x.style.lineHeight="30px",w.innerText=l.LANG("new-px"),w.style.color="#888",w.style.fontSize="12px",w.style.marginLeft="5px",w.style.cssFloat="right",C.innerText=l.LANG("new-px"),C.style.color="#888",C.style.fontSize="12px",C.style.marginLeft="5px",C.style.cssFloat="right",b.setAttribute("data-ignore-focus","true"),B.setAttribute("data-ignore-focus","true"),b.type="number",b.min="1",b.max=u,b.style.cssFloat="right",b.style.width="70px",B.type="number",B.min="1",B.max=u,B.style.cssFloat="right",B.style.width="70px",b.value=h,B.value=p,b.onclick=function(){this.focus(),n()},B.onclick=function(){this.focus(),n()},y.appendChild(w),y.appendChild(b),i.BB.appendTextDiv(y,l.LANG("width")+": "),x.appendChild(C),x.appendChild(B),i.BB.appendTextDiv(x,l.LANG("height")+": ");var S=document.createElement("div");S.style.marginTop="5px",S.style.color="#888";var k=document.createElement("div"),L=document.createElement("button");k.style.marginBottom="10px";var A=document.createElement("button"),T=document.createElement("button"),I=document.createElement("button"),E=document.createElement("button"),M=document.createElement("button");A.textContent=l.LANG("new-current"),L.textContent=l.LANG("new-fit"),M.textContent=l.LANG("new-oversize"),I.textContent=l.LANG("new-landscape"),E.textContent=l.LANG("new-portrait"),T.textContent=l.LANG("new-square"),A.style.marginRight="5px",L.style.marginRight="5px",M.style.marginRight="5px",I.style.marginTop="5px",I.style.marginRight="5px",E.style.marginTop="5px",E.style.marginRight="5px",k.appendChild(A),k.appendChild(L),k.appendChild(M),k.appendChild(T),k.appendChild(I),k.appendChild(E);A.onclick=function(){b.value=h,B.value=p,n()},L.onclick=function(){b.value=d,B.value=g,n()},M.onclick=function(){b.value=d+500,B.value=g+500,n()},T.onclick=function(){var e=t(1,1,d,g,50);b.value=""+Math.round(e.width),B.value=""+Math.round(e.height),n()},I.onclick=function(){var e=t(4,3,d,g,50);b.value=""+Math.round(e.width),B.value=""+Math.round(e.height),n()},E.onclick=function(){var e=t(3,4,d,g,50);b.value=""+Math.round(e.width),B.value=""+Math.round(e.height),n()};var R=new a.Select({isFocusable:!0,optionArr:[["screen",l.LANG("new-screen")],["16 9",l.LANG("new-video")+" 16:9"],["3 2","3:2"],["5 3","5:3"],["2 1","2:1"],["paper",l.LANG("new-din-paper")+" √2:1"],["9 16","9:16"],["2 3","2:3"],["3 5","3:5"],["1 2","1:2"],["1 1.4142135623730951","1:√2"]],onChange:function(e){if("screen"===e)b.value=""+window.screen.width,B.value=""+window.screen.height;else if("paper"===e){var r=t(Math.sqrt(2),1,d,g,50);b.value=""+Math.round(r.width),B.value=""+Math.round(r.height)}else{var i=e.split(" "),a=t(parseFloat(i[0]),parseFloat(i[1]),d,g,50);b.value=""+Math.round(a.width),B.value=""+Math.round(a.height)}n(),R.setValue(null)}});setTimeout((function(){R.setValue(null)}),0),i.BB.css(R.getElement(),{width:"80px"}),k.appendChild(R.getElement());var O={r:255,g:255,b:255,a:1},P=[{r:255,g:255,b:255,a:1},{r:0,g:0,b:0,a:1},{r:0,g:0,b:0,a:0}];P.push({r:r.r,g:r.g,b:r.b,a:1}),P.push({r:c.r,g:c.g,b:c.b,a:1});var D=new o.ColorOptions({colorArr:P,onChange:function(e){O=e,N.style.backgroundColor="rgba("+e.r+","+e.g+","+e.b+", "+e.a+")"}}),G=document.createElement("div");i.BB.css(G,{boxSizing:"border-box",width:"340px",height:"140px",display:"table",backgroundColor:"#9e9e9e",padding:"10px",marginTop:"10px",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",marginLeft:"-20px",colorScheme:"only light"});var N=document.createElement("div");i.BB.css(N,{width:"200px",height:"100px",backgroundColor:"#fff",marginLeft:"auto",marginRight:"auto",color:"#aaa",fontSize:"16px",fontWeight:"bold",textAlign:"center",verticalAlign:"center",display:"table",overflow:"hidden",boxShadow:"0px 0px 3px rgba(0,0,0,0.5)"});var j=document.createElement("div");j.style.display="table-cell",j.style.verticalAlign="middle",j.appendChild(N),G.appendChild(j);var z=i.BB.appendTextDiv(N,"");z.style.display="table-cell",z.style.verticalAlign="middle";parseInt(b.value),parseInt(B.value);b.onchange=function(){(""===b.value||parseInt(b.value)<0)&&(b.value="1"),n()},b.onkeyup=function(){n()},B.onchange=function(){(""===B.value||parseFloat(B.value)<0)&&(B.value="1"),n()},B.onkeyup=function(){n()},n(),m.appendChild(k);var H=i.BB.el({parent:m,css:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"}}),U=i.BB.el({parent:H});U.appendChild(y),U.appendChild(x),U.appendChild(S),H.appendChild(D.getElement()),m.appendChild(G),s.popup({target:document.body,message:"<b>".concat(l.LANG("new-title"),"</b>"),div:m,buttons:["Ok","Cancel"],callback:function(e){b.onclick=null,B.onclick=null,A.onclick=null,L.onclick=null,M.onclick=null,T.onclick=null,I.onclick=null,E.onclick=null,b.onchange=null,b.onkeyup=null,B.onchange=null,B.onkeyup=null,R.destroy(),D.destroy(),"Cancel"===e||parseInt(b.value)<=0||parseInt(B.value)<=0||isNaN(parseInt(b.value))||isNaN(parseInt(B.value))?v():f(parseInt(b.value),parseInt(B.value),O)},clickOnEnter:"Ok"})}})),r.register("1uc3b",(function(n,i){t(n.exports,"ToolspaceCollapser",(function(){return l}));var a=r("eWjiX"),o=r("jiQkU"),s=r("1mH1z");function l(t){var n=function(){c.style.transform="left"===i?r?"rotate(180deg)":"":r?"":"rotate(180deg)"},r=!0,i="right",l=a.BB.el({css:{width:"36px",height:"36px",background:"rgba(100, 100, 100, 0.9)",color:"#fff",position:"absolute",top:"0",textAlign:"center",lineHeight:"36px",cursor:"pointer",userSelect:"none",padding:"6px",boxSizing:"border-box"},title:s.LANG("toggle-show-tools"),onClick:function(e){e.preventDefault(),r=!r,n(),t.onChange()}}),c=a.BB.el({parent:l,css:{backgroundImage:"url(".concat(e(o),")"),width:"100%",height:"100%",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center",userSelect:"none"}});l.oncontextmenu=function(){return!1},this.isOpen=function(){return r},this.setDirection=function(e){i=e,n()},this.getElement=function(){return l}}})),r.register("jiQkU",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("b1UMP")})),r.register("keKW3",(function(n,i){t(n.exports,"textToolDialog",(function(){return B}));var a=r("4gaLD"),o=r("eWjiX"),s=r("h20yl"),l=r("9A7OD"),c=r("21VAD"),u=r("gmlbk"),h=r("jKOQl"),p=r("llzZ0"),d=r("ekHRj"),g=r("2dqOY"),f=r("rk4vM"),v=r("hucjG"),m=r("cZa2s"),y=r("03Zd8"),x=r("3KoFh"),b=r("eWf2I"),w=r("1mH1z");function B(t){var n=function(){R.clearRect(0,0,M.width,M.height);var e=a.objectSpread({},t.color,{a:le.getValue()}),n=s.renderText(M,{x:t.x,y:t.y,textStr:ce.value,align:ae.getValue(),isItalic:oe.getValue(),isBold:se.getValue(),size:parseFloat(re.value),font:q.getValue(),color:o.BB.ColorConverter.toRgbaStr(e),angleRad:t.angleRad});n.width=Math.max(n.width,1),n.height=Math.max(n.height,1);var r=o.BB.rotate(n.x,n.y,-t.angleRad/Math.PI*180),i=o.BB.rotate(n.width,n.height,-t.angleRad/Math.PI*180),l=t.x+r.x+i.x/2,c=t.y+r.y+i.y/2,u=o.BB.fitInto(n.width,n.height,A-100,T-100);I=Math.min(1,u.width/n.width),I=Math.min(4,I*Math.pow(2,$)),P.save(),I>=4?P.imageSmoothingEnabled=!1:(P.imageSmoothingEnabled=!0,P.imageSmoothingQuality=I>=1?"low":"medium"),P.clearRect(0,0,N.width,N.height),P.translate(A/2,T/2),P.scale(I,I),P.rotate(t.angleRad),P.drawImage(E[t.layerIndex].canvas,-l,-c),P.drawImage(M,-l,-c),P.restore(),G.save(),G.fillStyle="rgb(158,158,158)",G.fillRect(0,0,A,T),G.save(),G.translate(A/2,T/2),G.scale(I,I),G.rotate(t.angleRad),G.imageSmoothingEnabled=!1;var h=1/I;G.globalAlpha=.2,G.drawImage(U,-l-h,-c-h,M.width+2*h,M.height+2*h),G.globalAlpha=1,G.globalCompositeOperation="destination-out",G.drawImage(U,-l,-c,M.width,M.height),G.restore(),I>=4?G.imageSmoothingEnabled=!1:(G.imageSmoothingEnabled=!0,G.imageSmoothingQuality=I>=1?"low":"medium"),G.save(),G.translate(A/2,T/2),G.scale(I,I),G.rotate(t.angleRad);for(var p=0;p<t.layerIndex;p++)E[p].opacity>0&&(G.globalAlpha=E[p].opacity,G.globalCompositeOperation=E[p].mixModeStr,G.drawImage(E[p].canvas,-l,-c));G.restore(),G.globalAlpha=E[t.layerIndex].opacity,G.globalCompositeOperation=E[t.layerIndex].mixModeStr,G.drawImage(O,0,0),G.save(),G.translate(A/2,T/2),G.scale(I,I),G.rotate(t.angleRad);for(var d=t.layerIndex+1;d<E.length;d++)E[d].opacity>0&&(G.globalAlpha=E[d].opacity,G.globalCompositeOperation=E[d].mixModeStr,G.drawImage(E[d].canvas,-l,-c));G.restore(),G.restore(),j.save(),j.fillStyle=H,j.fillRect(0,0,N.width,N.height),j.drawImage(D,0,0),j.restore(),j.save(),j.globalCompositeOperation="difference",j.strokeStyle="#fff",j.lineWidth=1,j.strokeRect(Math.round(A/2-n.width/2*I),Math.round(T/2-n.height/2*I),Math.round(n.width*I),Math.round(n.height*I)),j.restore()},r=function(e,r){var i=o.BB.rotate(e,r,-t.angleRad/Math.PI*180);t.x+=i.x/I,t.y+=i.y/I,n()},i=function(e){$=Math.min(2,Math.max(-2,$+e)),n(),te.disabled=!B(1),ne.disabled=!B(-1)},B=function(e){return $!==Math.min(2,Math.max(-2,$+e))},C=function(){window.scrollTo(0,0)},S=o.BB.el({}),k=window.innerWidth<550,L=window.innerHeight<630,A=k?340:540,T=k?L?210:260:L?230:350,I=1,E=t.klCanvas.getLayersFast(),M=o.BB.canvas(t.klCanvas.getWidth(),t.klCanvas.getHeight()),R=M.getContext("2d"),O=o.BB.canvas(A,T),P=O.getContext("2d"),D=o.BB.canvas(A,T),G=D.getContext("2d"),N=o.BB.canvas(A,T),j=N.getContext("2d");o.BB.css(N,{display:"block"});var z=o.BB.el({parent:S,css:{position:"relative",width:A+"px",marginLeft:"-20px",cursor:"move",colorScheme:"only light",touchAction:"none"},onClick:function(){ce.focus()}});o.BB.el({parent:z,css:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",pointerEvents:"none"}}),z.appendChild(N);var H=j.createPattern(o.BB.createCheckerCanvas(8),"repeat"),U=o.BB.canvas(1,1);U.getContext("2d").fillRect(0,0,1,1);var X=new o.BB.PointerListener({target:N,pointers:1,onPointer:function(e){"pointermove"===e.type&&e.button&&(e.eventPreventDefault(),r(-e.dX,-e.dY))},onWheel:function(e){i(-e.deltaY)}}),F=function(e){e.preventDefault()};o.BB.addEventListener(N,"wheel",F);var W=o.BB.el({parent:S,css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"10px"}}),K=o.BB.el({parent:S,css:k?{}:{display:"flex",alignItems:"center",justifyContent:"space-between"}}),V=o.BB.el({parent:K,css:{display:"flex",alignItems:"center",marginTop:"5px"}}),Y=o.BB.el({parent:K,css:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"5px",width:k?"":"300px"}}),J=[{r:0,g:0,b:0,a:1},{r:255,g:255,b:255,a:1}];J.unshift({r:t.secondaryColor.r,g:t.secondaryColor.g,b:t.secondaryColor.b,a:1}),J.unshift({r:t.color.r,g:t.color.g,b:t.color.b,a:1});var _=new l.ColorOptions({colorArr:J,initialIndex:0,onChange:function(e){t.color=e,n()}});_.getElement().title=w.LANG("text-color"),_.getElement().style.marginLeft="-5px",W.appendChild(_.getElement());var Q,q,Z,$=0,ee=o.BB.el({parent:W,css:{}}),te=o.BB.el({parent:ee,content:'<img height="20" src="'.concat(e(x),'">'),title:w.LANG("zoom-in"),tagName:"button",onClick:function(){i(1)},css:{fontWeight:"bold"}}),ne=o.BB.el({parent:ee,content:'<img height="20" src="'.concat(e(b),'">'),title:w.LANG("zoom-out"),tagName:"button",onClick:function(){i(-1)},css:{fontWeight:"bold",marginLeft:"5px"}}),re=o.BB.el({parent:V,tagName:"input",title:w.LANG("text-size"),custom:{type:"number",min:1,max:1e4,value:t.size},css:{width:"60px"},onChange:function(){re.value=""+Math.max(1,Math.min(1e4,parseInt(re.value))),n()}}),ie=new o.BB.PointerListener({target:re,onWheel:function(e){re.value=""+Math.max(1,Math.min(1e3,parseInt(re.value)-e.deltaY)),n()}});Q=o.BB.el({css:{fontSize:"15px",marginLeft:"10px"}}),q=new c.Select({isFocusable:!0,optionArr:[["sans-serif","Sans-serif"],["serif","Serif"],["monospace","Monospace"],["cursive","Cursive"],["fantasy","Fantasy"]],initValue:t.font,onChange:function(e){n()}}),Q.appendChild(q.getElement()),V.appendChild(Q),Z=new o.BB.PointerListener({target:q.getElement(),onWheel:function(e){q.setDeltaValue(e.deltaY)}});var ae=new u.ImageRadioList({optionArr:[{id:"left",title:w.LANG("text-left"),image:e(g)},{id:"center",title:w.LANG("text-center"),image:e(f)},{id:"right",title:w.LANG("text-right"),image:e(v)}],initId:t.align,onChange:function(e){n()}});Y.appendChild(ae.getElement());var oe=new h.ImageToggle({image:e(m),title:w.LANG("text-italic"),initValue:t.isItalic,onChange:function(e){n()}});Y.appendChild(oe.getElement());var se=new h.ImageToggle({image:e(y),title:w.LANG("text-bold"),initValue:t.isBold,onChange:function(e){n()}});Y.appendChild(se.getElement());var le=new p.KlSlider({label:w.LANG("opacity"),width:150,height:30,min:0,max:1,initValue:t.opacity,resolution:225,eventResMs:1e3/30,onChange:function(e){n()},formatFunc:function(e){return Math.round(100*e)}});Y.appendChild(le.getElement());var ce=o.BB.el({parent:S,tagName:"textarea",custom:{placeholder:w.LANG("text-placeholder"),"data-ignore-focus":"true"},css:{whiteSpace:"nowrap",overflow:"auto",width:"100%",height:"70px",resize:"vertical",marginTop:"10px"},onChange:function(){n()}});ce.addEventListener("input",n),setTimeout((function(){ce.focus(),ce.select()}));var ue=new o.BB.KeyListener({onDown:function(e,t,n){o.BB.isInputFocused(!0)||("left"===e&&r(-1,0),"right"===e&&r(1,0),"up"===e&&r(0,-1),"down"===e&&r(0,1))}});window.addEventListener("scroll",C),d.popup({target:document.body,message:"<b>".concat(w.LANG("text-title"),"</b>"),div:S,buttons:["Ok","Cancel"],style:k?{}:{width:"500px"},callback:function(e){var r={x:t.x,y:t.y,textStr:ce.value,align:ae.getValue(),isItalic:oe.getValue(),isBold:se.getValue(),color:t.color,size:re.value,font:q.getValue(),opacity:le.getValue()};window.removeEventListener("scroll",C),ce.removeEventListener("input",n),o.BB.destroyEl(ce),X.destroy(),ie.destroy(),Z.destroy(),o.BB.removeEventListener(N,"wheel",F),o.BB.destroyEl(z),o.BB.destroyEl(te),o.BB.destroyEl(ne),o.BB.destroyEl(re),_.destroy(),q.destroy(),ue.destroy(),ae.destroy(),oe.destroy(),se.destroy(),le.destroy(),"Ok"===e&&t.onConfirm(r)},autoFocus:!1,clickOnEnter:"Ok",ignoreBackground:!0,closefunc:function(e){e}}),n()}})),r.register("2dqOY",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("lvwQ5")})),r.register("rk4vM",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("imAvm")})),r.register("hucjG",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("dC0sF")})),r.register("cZa2s",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("h3hPo")})),r.register("03Zd8",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("1pAeY")})),r.register("kDGzx",(function(e,n){t(e.exports,"showImportImageDialog",(function(){return c}));var i=r("eWjiX"),a=r("hRdOL"),o=r("lXqiv"),s=r("ekHRj"),l=r("1mH1z");function c(e){var t,n=function(n,r){var a=i.BB.fitInto(n,r,e.maxSize,e.maxSize);a.width<n?(t.innerHTML='<span style="color:#f00">'.concat(n," X ").concat(r,"</span> ⟶ ").concat(Math.round(a.width)," X ").concat(Math.round(a.height)),t.title=l.LANG("import-too-large")):(t.innerHTML="".concat(n," X ").concat(r),t.title="")},r=i.BB.el({}),c=window.innerWidth<550||window.innerHeight<550,u=c?{}:{width:"500px"},h=new a.CropCopy({width:c?340:540,height:c?300:400,canvas:e.image.canvas,isNotCopy:!0,onChange:function(e,r){t&&n(e,r)}});i.BB.css(h.getEl(),{marginLeft:"-20px",borderTop:"1px solid #bbb",borderBottom:"1px solid #bbb"}),h.getEl().title=l.LANG("crop-drag-to-crop"),r.appendChild(h.getEl()),t=i.BB.el({parent:r,css:{marginTop:"10px",textAlign:"center",color:"#888",lineHeight:"20px"}}),n(e.image.width,e.image.height);var p,d=!1;if("psd"===e.image.type){var g={background:"rgba(255,255,0,0.5)",padding:"10px",marginTop:"5px",marginBottom:"5px",border:"1px solid #e7d321",borderRadius:"5px"};if(e.image.layers){if(p=new o.Checkbox({init:d,label:l.LANG("import-flatten"),callback:function(e){d=e}}),r.appendChild(p.getElement()),e.image.warningArr){var f=i.BB.el({content:l.LANG("import-psd-limited-support"),css:g});f.appendChild(i.BB.el({tagName:"a",content:"Details",onClick:function(){!function(e){for(var t=[],n={mask:"Masks not supported. Mask was applied.",clipping:"Clipping not supported. Clipping layers were merged.",group:"Groups not supported. Layers were ungrouped.",adjustment:"Adjustment layers not supported.","layer-effect":"Layer effects not supported.","smart-object":"Smart objects not supported.","blend-mode":"Unsupported layer blend mode.","bits-per-channel":"Unsupported color depth. Only 8bit per channel supported."},r=0;r<e.length;r++)t.push("- "+n[e[r]]);alert(t.join("\n"))}(e.image.warningArr)}})),r.appendChild(f)}}else{var v=i.BB.el({content:l.LANG("import-psd-unsupported"),css:g});r.appendChild(v)}}s.popup({target:e.target,message:"<b>".concat(l.LANG("import-title"),"</b>"),div:r,style:u,buttons:[l.LANG("import-btn-as-layer"),l.LANG("import-btn-as-image"),"Cancel"],callback:function(t){var n=h.getCroppedImage(),r=h.getRect();h.destroy(),p&&p.destroy(),t===l.LANG("import-btn-as-layer")?e.callback({type:"as-layer",image:n}):t===l.LANG("import-btn-as-image")?"psd"===e.image.type?(d&&(e.image.layers=null),e.callback({type:"as-image-psd",image:e.image,cropObj:r})):"image"===e.image.type&&e.callback({type:"as-image",image:n}):e.callback({type:"cancel"})},autoFocus:"As Image"})}})),r.register("941rU",(function(e,n){t(e.exports,"blendPsdToKl",(function(){return u})),t(e.exports,"blendKlToPsd",(function(){return h})),t(e.exports,"readPsd",(function(){return p})),t(e.exports,"klPsdToKlProject",(function(){return d}));var i,a,o=r("eelgW"),s=r("1mH1z"),l=r("705qg");function c(){if(!i){i={"source-over":"normal",darken:"darken",multiply:"multiply","color-burn":"color burn",lighten:"lighten",screen:"screen","color-dodge":"color dodge",overlay:"overlay","soft-light":"soft light","hard-light":"hard light",difference:"difference",exclusion:"exclusion",hue:"hue",saturation:"saturation",color:"color",luminosity:"luminosity"},a={};for(var e=Object.keys(i),t=0;t<e.length;t++)a[i[e[t]]]=e[t]}}function u(e){return c(),a[e]}function h(e){return c(),i[e]}function p(e){var t=function(e){i.warningArr||(i.warningArr=[]),i.warningArr.includes(e)||i.warningArr.push(e)},n=function(e){var n=u(e);return n||(t("blend-mode"),n="source-over"),n},r=function(e,t){var n=e.getContext("2d"),r=n.getImageData(0,0,e.width,e.height);if(0===t)for(var i=0;i<r.data.length;i+=4)r.data[i+3]=r.data[i];else for(var a=0;a<r.data.length;a+=4)r.data[a+3]=255-r.data[a];n.putImageData(r,0,0)},i={type:"psd",canvas:e.canvas,width:e.width,height:e.height};if(8!==e.bitsPerChannel&&t("bits-per-channel"),!e.children)return i.error=!0,i;var a=l.MAX_LAYERS,s=0;if(s+=function e(n){var r=0;if(n.blendMode){var i=u(n.blendMode);if(i&&"source-over"!==i)return 1}for(var a=0;a<n.children.length;a++){var o=n.children[a];o.clipping||o.adjustment||(o.children?(t("group"),r+=e(o)):r++)}return r}(e),s>a)return i.error=!0,i;return i.layers=[],i.layers=function e(a){var s,l,c=[],u=a.hidden?0:a.opacity,h=n(a.blendMode);"source-over"!==h&&(l=(s=o.createCanvas(i.width,i.height)).getContext("2d")),a.mask&&(t("mask"),r(a.mask.canvas,a.mask.defaultColor));for(var p=0;p<a.children.length;p++){var d=a.children[p];if(!d.clipping)if(d.adjustment)t("adjustment");else{var g=(d.children||d.canvas)&&a.children[p+1]&&a.children[p+1].clipping;if(g&&t("clipping"),d.children)for(var f=e(d),v=0;v<f.length;v++){var m=f[v],y=m.image.getContext("2d");if(g){var x=o.createCanvas(i.width,i.height),b=x.getContext("2d");b.drawImage(m.image,0,0);for(var w=p+1;w<a.children.length&&a.children[w].clipping;w++){var B=a.children[w];0===B.opacity||B.hidden||(b.globalCompositeOperation=n(B.blendMode),b.globalAlpha=B.opacity,b.drawImage(B.canvas,B.left,B.top))}y.globalCompositeOperation="source-atop",y.drawImage(x,0,0)}a.mask&&(y.globalCompositeOperation=0===a.mask.defaultColor?"destination-in":"destination-out",y.drawImage(a.mask.canvas,a.mask.left,a.mask.top)),s?(l.globalCompositeOperation=m.mixModeStr,l.globalAlpha=m.opacity,l.drawImage(m.image,0,0)):(m.opacity=m.opacity*u,c.push(m))}else{var C=o.createCanvas(i.width,i.height),S=C.getContext("2d");if(d.canvas&&S.drawImage(d.canvas,d.left,d.top),d.effects&&t("layer-effect"),d.mask&&(t("mask"),r(d.mask.canvas,d.mask.defaultColor),S.globalCompositeOperation=0===d.mask.defaultColor?"destination-in":"destination-out",S.drawImage(d.mask.canvas,d.mask.left,d.mask.top)),g){var k=o.createCanvas(d.right-d.left,d.bottom-d.top),L=k.getContext("2d");L.drawImage(d.canvas,0,0);for(var A=p+1;A<a.children.length&&a.children[A].clipping;A++){var T=a.children[A];0===T.opacity||T.hidden||(L.globalCompositeOperation=n(T.blendMode),L.globalAlpha=T.opacity,L.drawImage(T.canvas,T.left-d.left,T.top-d.top))}S.globalCompositeOperation="source-atop",S.drawImage(k,d.left,d.top)}a.mask&&(S.globalCompositeOperation=0===a.mask.defaultColor?"destination-in":"destination-out",S.drawImage(a.mask.canvas,a.mask.left,a.mask.top)),s?u>0&&(l.globalCompositeOperation=n(d.blendMode),l.globalAlpha=d.hidden?0:d.opacity,l.drawImage(C,0,0)):c.push({name:d.name,opacity:(d.hidden?0:d.opacity)*u,mixModeStr:n(d.blendMode),image:C})}}}return s&&(c=[{name:a.name,opacity:u,mixModeStr:h,image:s}]),c}({name:"root",opacity:1,blendMode:"normal",children:e.children}),i}function d(e){var t={width:e.width,height:e.height,layers:[]};return e.layers?t.layers=t.layers.concat(e.layers.map((function(e){return{name:e.name,opacity:e.opacity,mixModeStr:e.mixModeStr,image:e.image}}))):t.layers.push({name:s.LANG("background"),opacity:1,mixModeStr:"source-over",image:e.canvas}),t}})),r.register("9BlwZ",(function(e,n){t(e.exports,"setDbName",(function(){return o})),t(e.exports,"getKlProjectObj",(function(){return l})),t(e.exports,"storeKlProjectObj",(function(){return c})),t(e.exports,"clear",(function(){return u}));var r=!!window.indexedDB,i="Klecks",a="ProjectStore";function o(e){i=""+e}function s(e,t,n){var o=function(e){s||(s=!0,n(e))},s=!1;if(r){var l;try{l=window.indexedDB.open(i,1)}catch(e){return void o(e.message)}l.onupgradeneeded=function(e){try{l.result.createObjectStore(a,{keyPath:"id"}).createIndex("id","id",{unique:!0})}catch(e){o(e.message)}},l.onerror=function(e){o("indexedDB.open failed, "+l.error)},l.onsuccess=function(n){var r,c,u;try{if(!(r=l.result).objectStoreNames.contains(a))return window.indexedDB.deleteDatabase(i),void o("object store ProjectStore missing. destroying db");(u=(c=r.transaction(a,"readwrite")).objectStore(a)).index("id")}catch(e){return void o(e.message)}r.onerror=function(e){o("database error, "+r.error)};try{e(u)}catch(e){return void o(e.message)}c.oncomplete=function(){s||(s=!0,t()),r.close()},c.onerror=function(){o("transaction error, "+c.error)}}}else setTimeout((function(){o("no indexed db available")}),0)}function l(e,t){var n;r?s((function(e){n=e.get(1)}),(function(){e(n.result)}),(function(e){t("execIndexedDBTransaction error, "+e)})):e(null)}function c(e,t,n){s((function(t){t.put(e)}),(function(){t()}),(function(e){n(e)}))}function u(e,t){s((function(e){e.delete(1)}),(function(){e()}),(function(e){t(e)}))}})),r.register("kyVjY",(function(n,i){t(n.exports,"filterLibStatus",(function(){return b})),t(n.exports,"filterLib",(function(){return w}));var a=r("8k5kH"),o=r("4UkHZ"),s=r("e7LnL"),l=r("iI5sC"),c=r("eySuj"),u=r("iPRwU"),h=r("krmR4"),p=r("92iBR"),d=r("2n4Fs"),g=r("bFASM"),f=r("9m6gZ"),v=r("4fkq2"),m=r("dPWA8"),y=r("cQHFd"),x=r("1mH1z"),b={isLoaded:!1},w={glBrightnessContrast:{lang:{name:"filter-bright-contrast-title",button:"filter-bright-contrast"},name:"",buttonLabel:"",webgl:!0,updateContext:!0,icon:e(a),updatePos:!1,getDialog:null,apply:null,inEmbed:!0},cropExtend:{lang:{name:"filter-crop-title",button:"filter-crop-extend"},name:"",buttonLabel:"",icon:e(o),webgl:!1,neededWithWebGL:!0,updateContext:!0,updatePos:!0,getDialog:null,apply:null,inEmbed:!1},glCurves:{lang:{name:"filter-curves-title",button:"filter-curves"},name:"",buttonLabel:"",icon:e(s),webgl:!0,updateContext:!0,updatePos:!1,getDialog:null,apply:null,inEmbed:!0},flip:{lang:{name:"filter-flip-title",button:"filter-flip"},name:"",buttonLabel:"",icon:e(l),webgl:!1,neededWithWebGL:!0,updateContext:!0,updatePos:!1,getDialog:null,apply:null,inEmbed:!0},glHueSaturation:{lang:{name:"filter-hue-sat-title",button:"filter-hue-sat"},name:"",buttonLabel:"",icon:e(c),webgl:!0,updateContext:!0,updatePos:!1,getDialog:null,apply:null,inEmbed:!0},invert:{lang:{name:"filter-invert",button:"filter-invert"},name:"",icon:e(u),webgl:!0,updateContext:!0,updatePos:!1,isInstant:!0,getDialog:null,apply:null,inEmbed:!0},glPerspective:{lang:{name:"filter-perspective-title",button:"filter-perspective"},name:"",buttonLabel:"",icon:e(h),webgl:!0,updateContext:!0,updatePos:!1,getDialog:null,apply:null,inEmbed:!0},resize:{lang:{name:"filter-resize-title",button:"filter-resize"},name:"",buttonLabel:"",icon:e(p),webgl:!1,neededWithWebGL:!0,updateContext:!0,updatePos:!0,getDialog:null,apply:null,inEmbed:!1},rotate:{lang:{name:"filter-rotate-title",button:"filter-rotate"},name:"",buttonLabel:"",icon:e(d),webgl:!1,neededWithWebGL:!0,updateContext:!0,updatePos:!0,getDialog:null,apply:null,inEmbed:!1},glTiltShift:{lang:{name:"filter-tilt-shift-title",button:"filter-tilt-shift"},name:"",buttonLabel:"",icon:e(g),webgl:!0,updateContext:!0,updatePos:!1,getDialog:null,apply:null,inEmbed:!0},toAlpha:{lang:{name:"filter-to-alpha-title",button:"filter-to-alpha"},name:"",buttonLabel:"",icon:e(f),webgl:!0,updateContext:!1,updatePos:!1,getDialog:null,apply:null,inEmbed:!0},transform:{lang:{name:"filter-transform-title",button:"filter-transform"},name:"",buttonLabel:"",icon:e(v),webgl:!1,neededWithWebGL:!0,updateContext:!0,updatePos:!1,ieFails:!0,getDialog:null,apply:null,inEmbed:!0},glBlur:{lang:{name:"filter-triangle-blur-title",button:"filter-triangle-blur"},name:"",buttonLabel:"",icon:e(m),webgl:!0,updateContext:!0,updatePos:!1,getDialog:null,apply:null,inEmbed:!0},glUnsharpMask:{lang:{name:"filter-unsharp-mask-title",button:"filter-unsharp-mask"},name:"",buttonLabel:"",icon:e(y),webgl:!0,updateContext:!0,updatePos:!1,getDialog:null,apply:null,inEmbed:!0}};function B(){Object.keys(w).forEach((function(e){w[e].name=x.LANG(w[e].lang.name),w[e].buttonLabel=x.LANG(w[e].lang.button)}))}B(),x.languageStrings.subscribe((function(){B()}))})),r.register("8k5kH",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("5tPq3")})),r.register("4UkHZ",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("cazOx")})),r.register("e7LnL",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("245NA")})),r.register("iI5sC",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("1hkCG")})),r.register("eySuj",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("k2eFf")})),r.register("iPRwU",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("krKGd")})),r.register("krmR4",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("ehfxY")})),r.register("92iBR",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("beOjS")})),r.register("bFASM",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("Gk9bV")})),r.register("9m6gZ",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("csed7")})),r.register("4fkq2",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("equSE")})),r.register("dPWA8",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("h1dN3")})),r.register("cQHFd",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("LfAXI")})),r.register("dAXbp",(function(e,n){t(e.exports,"brushes",(function(){return h}));var i=r("68QTJ"),a=r("5PSXS"),o=r("ewgr9"),s=r("kic4a"),l=r("7cUpm"),c=r("ltaBP"),u=r("6Nq1H"),h={PenBrush:i.PenBrush,BlendBrush:a.BlendBrush,SketchyBrush:o.SketchyBrush,PixelBrush:s.PixelBrush,ChemyBrush:u.ChemyBrush,SmudgeBrush:c.SmudgeBrush,EraserBrush:l.EraserBrush}})),r.register("68QTJ",(function(e,n){t(e.exports,"PenBrush",(function(){return s}));var i=r("eWjiX"),a=r("5CF7D"),o=r("hrnUX");function s(){var e,t,n,r,s=function(){if(b!==m&&b!==x)for(var e,t=[[k,128],[L,64],[A,32]],r=0;r<t.length;r++)(e=t[r][0].getContext("2d")).save(),e.clearRect(0,0,t[r][1],t[r][1]),e.fillStyle="rgba("+n.r+", "+n.g+", "+n.b+", "+S[b]+")",e.fillRect(0,0,t[r][1],t[r][1]),e.globalCompositeOperation="destination-in",e.imageSmoothingQuality="high",e.drawImage(a.alphaImArr[b],0,0,t[r][1],t[r][1]),e.restore()},l=function(t,n,i,a,o,s){if(!(i<=0))if(v&&(e.globalCompositeOperation="source-atop"),s&&s[3]===a||(e.globalAlpha=a),s||b!==m&&b!==x||(e.fillStyle=r),b===m)e.beginPath(),e.arc(t,n,i,0,I),e.closePath(),e.fill();else if(b===x)void 0!==o&&(e.save(),e.translate(t,n),e.rotate(o/180*Math.PI),e.fillRect(-i,-i,2*i,2*i),e.restore());else{e.save(),e.translate(t,n);var l=k;i<=32&&i>16?l=L:i<=16&&(l=A),e.scale(i,i),b===y&&e.rotate(53123*(t+n)%I),e.drawImage(l,-1,-1,2,2),e.restore()}},c=function(t,n,r,a){null===T&&(T=new i.BB.BezierLine).add(w.x,w.y,0,(function(){}));var o=[];function s(e){var t=i.BB.mix(B.pressure,a,e.t),n=d*(f?t*t:1),r=Math.max(.1,h*(g?t:1));o.push([e.x,e.y,r,n,e.angle])}var c,u=r*p;null===t?T.addFinal(u,s):T.add(t,n,u,s),e.save();for(var v=0;v<o.length;v++){var m=o[v];l(m[0],m[1],m[2],m[3],m[4],c),c=m}e.restore()},u=new o.KL.DecoyKlHistory,h=2,p=.8489,d=1,g=!0,f=!1,v=!1,m=0,y=1,x=3,b=m,w={x:0,y:0,pressure:0},B={x:0,y:0,pressure:0},C=!1,S=[1,.9,1,1],k=i.BB.canvas(128,128),L=i.BB.canvas(64,64),A=i.BB.canvas(32,32),T=null,I=2*Math.PI;this.startLine=function(r,a,o){(t={tool:["brush","PenBrush"],actions:[]}).actions.push({action:"opacityPressure",params:[f]}),t.actions.push({action:"sizePressure",params:[g]}),t.actions.push({action:"setSize",params:[h]}),t.actions.push({action:"setSpacing",params:[p]}),t.actions.push({action:"setOpacity",params:[d]}),t.actions.push({action:"setColor",params:[n]}),t.actions.push({action:"setAlpha",params:[b]}),t.actions.push({action:"setLockAlpha",params:[v]}),o=i.BB.clamp(o,0,1);var s=f?d*o*o:d,c=g?Math.max(.1,o*h):Math.max(.1,h);C=!0,e.save(),l(r,a,c,s),e.restore(),c*p,w.x=r,w.y=a,w.pressure=o,B.pressure=o,t.actions.push({action:"startLine",params:[r,a,o]})},this.goLine=function(n,r,a){if(C){t.actions.push({action:"goLine",params:[n,r,a]});var o=i.BB.clamp(a,0,1),s=g?Math.max(.1,w.pressure*h):Math.max(.1,h);e.save(),c(n,r,s,w.pressure),e.restore(),w.x=n,w.y=r,B.pressure=w.pressure,w.pressure=o}},this.endLine=function(n,r){var i=g?Math.max(.1,w.pressure*h):Math.max(.1,h);e.save(),c(null,null,i,w.pressure),e.restore(),C=!1,T=null,t&&(t.actions.push({action:"endLine",params:[n,r]}),u.push(t),t=void 0)},this.drawLineSegment=function(e,t,r,a){if(w.x=r,w.y=a,w.pressure=1,!C&&void 0!==e){var o,s=i.BB.pointsToAngleDeg({x:e,y:t},{x:r,y:a}),c=Math.sqrt(Math.pow(r-e,2)+Math.pow(a-t,2)),m=(r-e)/c,y=(a-t)/c,x=h*p;for(o=h*p;o<=c;o+=x)l(e+m*o,t+y*o,h,d,s);var B={tool:["brush","PenBrush"],actions:[]};B.actions.push({action:"opacityPressure",params:[f]}),B.actions.push({action:"sizePressure",params:[g]}),B.actions.push({action:"setSize",params:[h]}),B.actions.push({action:"setSpacing",params:[p]}),B.actions.push({action:"setOpacity",params:[d]}),B.actions.push({action:"setColor",params:[n]}),B.actions.push({action:"setAlpha",params:[b]}),B.actions.push({action:"setLockAlpha",params:[v]}),B.actions.push({action:"drawLineSegment",params:[e,t,r,a]}),u.push(B)}},this.isDrawing=function(){return C},this.setAlpha=function(e){b!==e&&(b=e,s())},this.setColor=function(e){n!==e&&(n={r:e.r,g:e.g,b:e.b},r="rgb("+n.r+","+n.g+","+n.b+")",s())},this.setContext=function(t){e=t},this.setHistory=function(e){u=e},this.setSize=function(e){h=e},this.setOpacity=function(e){d=e},this.setSpacing=function(e){p=e},this.sizePressure=function(e){g=e},this.opacityPressure=function(e){f=e},this.setLockAlpha=function(e){v=e},this.getSpacing=function(){return p},this.getSize=function(){return h},this.getOpacity=function(){return d},this.getLockAlpha=function(e){return v}}})),r.register("5CF7D",(function(e,n){t(e.exports,"alphaImArr",(function(){return a}));var i=r("74D3O"),a=[];a[1]=i.genBrushAlpha01(128),a[2]=i.genBrushAlpha02(128)})),r.register("74D3O",(function(e,n){t(e.exports,"genBrushAlpha01",(function(){return o})),t(e.exports,"genBrushAlpha02",(function(){return l}));var i=r("eWjiX"),a=r("gZSR2");function o(e){for(var t=e/500,n=e,r=i.BB.canvas(e,n),o=r.getContext("2d"),s=o.createImageData(e,n),l=0;l<e;l++)for(var c=0;c<n;c++){var u=4*(c*e+l),h=t+.04*a.noise.simplex2(l/50/t,c/50/t),p=100+(a.noise.simplex2(l/50/h,c/50/h)+1)/2*100;p-=(a.noise.simplex2(l/10/t,c/10/t)+1)/2*100;var d=i.BB.dist(e/2,n/2,l,c);p*=i.BB.clamp(1-((d-e/2.5)/(e/14)+a.noise.simplex2(l/22/h,c/22/h)),0,1),p*=2*i.BB.clamp(1-d/e,0,1),s.data[u]=0,s.data[u+1]=0,s.data[u+2]=0,s.data[u+3]=i.BB.clamp(p,0,255)}return o.putImageData(s,0,0),r}function s(e,t,n){var r=i.BB.Vec2.sub(n,t),a=i.BB.Vec2.sub(e,t),o=i.BB.clamp(i.BB.Vec2.dot(a,r)/i.BB.Vec2.dot(r,r),0,1);return i.BB.Vec2.len(i.BB.Vec2.sub(a,i.BB.Vec2.mul(r,o)))}function l(e){var t=.25;for(var n={x:t*e,y:e-e*t},r={x:e-e*t,y:t*e},a=e,o=i.BB.canvas(e,a),l=o.getContext("2d"),c=l.createImageData(e,a),u=0;u<e;u++)for(var h=0;h<a;h++){var p=4*(h*e+u),d=s({x:u,y:h},n,r);d=i.BB.clamp(255-(d-.16666666666666666*e)/(.08333333333333333*e)*255,0,255),c.data[p]=0,c.data[p+1]=0,c.data[p+2]=0,c.data[p+3]=d}return l.putImageData(c,0,0),o}})),r.register("gZSR2",(function(e,n){t(e.exports,"noise",(function(){return h}));var r={};function i(e,t,n){this.x=e,this.y=t,this.z=n}i.prototype.dot2=function(e,t){return this.x*e+this.y*t};var a=[new i(1,1,0),new i(-1,1,0),new i(1,-1,0),new i(-1,-1,0),new i(1,0,1),new i(-1,0,1),new i(1,0,-1),new i(-1,0,-1),new i(0,1,1),new i(0,-1,1),new i(0,1,-1),new i(0,-1,-1)],o=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],s=new Array(512),l=new Array(512);r.seed=function(e){e>0&&e<1&&(e*=65536),(e=Math.floor(e))<256&&(e|=e<<8);for(var t=0;t<256;t++){var n=void 0;n=1&t?o[t]^255&e:o[t]^e>>8&255,s[t]=s[t+256]=n,l[t]=l[t+256]=a[n%12]}},r.seed(0);var c=.5*(Math.sqrt(3)-1),u=(3-Math.sqrt(3))/6;r.simplex2=function(e,t){var n,r,i=(e+t)*c,a=Math.floor(e+i),o=Math.floor(t+i),h=(a+o)*u,p=e-a+h,d=t-o+h;p>d?(n=1,r=0):(n=0,r=1);var g=p-n+u,f=d-r+u,v=p-1+2*u,m=d-1+2*u,y=l[(a&=255)+s[o&=255]],x=l[a+n+s[o+r]],b=l[a+1+s[o+1]],w=.5-p*p-d*d,B=.5-g*g-f*f,C=.5-v*v-m*m;return 70*((w<0?0:(w*=w)*w*y.dot2(p,d))+(B<0?0:(B*=B)*B*x.dot2(g,f))+(C<0?0:(C*=C)*C*b.dot2(v,m)))};var h=r})),r.register("5PSXS",(function(e,n){t(e.exports,"BlendBrush",(function(){return l}));var i=r("4gaLD"),a=r("eWjiX"),o=256;function s(e,t,n){return e<=t?t:e>=n?n:e}var l=function(){"use strict";function e(){i.classCallCheck(this,e),this.isTesting=!1,this.size=29,this.opacity=.6,this.blending=.65,this.settingLockLayerAlpha=!1,this.settingSizePressure=!0,this.settingOpacityPressure=!1,this.blendCol={r:0,g:0,b:0,a:1},this.blendMix=.45,this.isDrawing=!1,this.lastInput={x:0,y:0,pressure:0},this.lastInput2={x:0,y:0,pressure:0}}return i.createClass(e,[{key:"updateRedrawBounds",value:function(e){this.redrawBounds=a.BB.updateBounds(this.redrawBounds,e)}},{key:"getCellsWidth",value:function(){return Math.ceil(this.context.canvas.width/o)}},{key:"drawChangedCells",value:function(){var e=this,t=this.cells.map((function(e){return null}));this.getTouchedCells(this.redrawBounds).forEach((function(n,r){n&&(t[r]=e.cells[r])})),this.drawCells(t),this.redrawBounds=null}},{key:"getTouchedCells",value:function(e){for(var t=this.cells.map((function(e){return!1})),n=this.getCellsWidth(),r=(e={x1:Math.floor(e.x1/o),y1:Math.floor(e.y1/o),x2:Math.floor(e.x2/o),y2:Math.floor(e.y2/o)}).x1;r<=e.x2;r++)for(var i=e.y1;i<=e.y2;i++)t[i*n+r]=!0;return t}},{key:"sliceBounds",value:function(e){var t=this,n=this.getCellsWidth(),r=[];return this.getTouchedCells(e).forEach((function(i,a){if(i){var s=a%n*o,l=Math.floor(a/n)*o,c=t.cells[a].width,u=t.cells[a].height,h={x1:Math.max(0,e.x1-s),y1:Math.max(0,e.y1-l),x2:Math.min(c-1,e.x2-s),y2:Math.min(u-1,e.y2-l)};h.x1>h.x2||h.y1>h.y2||r.push({index:a,bounds:h})}})),r}},{key:"copyFromCanvas",value:function(e){var t=this;if(e){var n=this.getTouchedCells(e),r=this.getCellsWidth();n.forEach((function(e,n){if(e&&!t.cells[n]){var i=n%r,s=Math.floor(n/r),l=(Math.min(i*o+o,t.context.canvas.width)-1)%o+1,c=(Math.min(s*o+o,t.context.canvas.height)-1)%o+1,u=a.BB.canvas(l,c).getContext("2d");u.drawImage(t.context.canvas,-i*o,-s*o),t.cells[n]=u.getImageData(0,0,l,c)}}))}}},{key:"getAverage",value:function(e,t,n){var r=this;n=Math.max(.5,.75*n);var i=Math.max(0,Math.floor(e-n)),a=Math.max(0,Math.floor(t-n)),o=Math.min(this.context.canvas.width-1,Math.ceil(e+n)),s=Math.min(this.context.canvas.height-1,Math.ceil(t+n));if(i>o||a>s)return{r:0,g:0,b:0,a:0};var l,c=0,u=0,h=0,p=0;return this.sliceBounds({x1:i,y1:a,x2:o,y2:s}).forEach((function(e){for(var t=r.cells[e.index].width,n=r.cells[e.index].data,i=e.bounds,a=i.y1;a<=i.y2;a+=4)for(var o=i.x1,s=a*t*4+4*i.x1;o<=i.x2;o+=4,s+=16)l=n[s+3],c+=n[s]*l,u+=n[s+1]*l,h+=n[s+2]*l,p+=l})),0!==p&&(c/=p,u/=p,h/=p,p=Math.min(1,p)),{r:c,g:u,b:h,a:p}}},{key:"prepDot",value:function(e,t,n){n=Math.max(.5,n);var r=Math.max(0,Math.floor(e-n)),i=Math.max(0,Math.floor(t-n)),a=Math.min(this.context.canvas.width-1,Math.ceil(e+n)),o=Math.min(this.context.canvas.height-1,Math.ceil(t+n));return r>a||i>o?null:{x1:r,y1:i,x2:a,y2:o}}},{key:"drawDot",value:function(e){for(var t=this,n=0,r=e.size>30?1024:512,i=[],l=0;l<r;l++)i[l]=(Math.random()-.5)/1.001+.5;var c=[8,4,4,4,2,2,2,2,2,2][Math.floor(2*e.size)],u=c?c*c:0,h=[];if(c)for(var p=0,d=0;d<c;d++)for(var g=0;g<c;g++,p+=2)h[p]=(d+1)/c,h[p+1]=(g+1)/c;var f=.8*Math.pow(e.opacity,2),v=1-f,m=f/v,y=e.size*e.size,x=y*v/e.opacity,b=(1+m)*e.opacity,w=this.sliceBounds({x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}),B=this.getCellsWidth();w.forEach((function(l){for(var c=l.index%B*o,p=Math.floor(l.index/B)*o,d=t.cells[l.index].width,g=t.cells[l.index].data,f=l.bounds.y1,v=f+p-e.y;f<=l.bounds.y2;f++,v++)for(var m=l.bounds.x1,w=f*d*4+4*l.bounds.x1,C=m+c-e.x;m<=l.bounds.x2;m++,w+=4,C++){var S=0;if(u){for(var k=0;k<h.length;k+=2){var L=a.BB.lenSquared(C+h[k],v+h[k+1]);L>=y||(S+=s(b-L/x,0,e.opacity))}if(!S)continue;S/=u}else{var A=Math.pow(C,2)+Math.pow(v,2);if(A>=y)continue;S=s(b-A/x,0,e.opacity)}var T=1-S,I=g[w+3]/255;if(t.settingLockLayerAlpha){var E=e.r*S+g[w]*T,M=e.g*S+g[w+1]*T,R=e.b*S+g[w+2]*T;I&&(g[w]=Math.floor(E+i[n]),g[w+1]=Math.floor(M+i[n]),g[w+2]=Math.floor(R+i[n]))}else{var O=e.r*S+g[w]*I*T,P=e.g*S+g[w+1]*I*T,D=e.b*S+g[w+2]*I*T,G=1-T*(1-I);g[w+3]=Math.floor(Math.min(255,255*G)+.5),G&&(g[w]=Math.floor(O/G+i[n]),g[w+1]=Math.floor(P/G+i[n]),g[w+2]=Math.floor(D/G+i[n]))}n=(n+1)%r}}))}},{key:"calcSpacing",value:function(e){return a.BB.mix(2*e/2,2*e/9,a.BB.clamp((e-2.7)/9.3,0,1))}},{key:"continueLine",value:function(e,t,n,r){var i,o,s=this;this.drawBuffer=[];var l,c=this.settingSizePressure?Math.max(1,n*this.size):Math.max(1,this.size),u=this.calcSpacing(c),h=e,p=t;if(null===e&&(h=this.lastInput.x,p=this.lastInput.y),0===this.blending)this.mixr=this.color.r,this.mixg=this.color.g,this.mixb=this.color.b;else{var d;if(r)d={r:this.localColOld.r,g:this.localColOld.g,b:this.localColOld.b,a:0};else{var g=[h,p,this.settingSizePressure?Math.max(.5,n*this.size):Math.max(.5,this.size)],f=this.prepDot(g[0],g[1],g[2]);this.copyFromCanvas(f),d=this.getAverage(g[0],g[1],g[2])}l={r:0,g:0,b:0,a:0},d.a>0&&0===this.blendCol.a?(this.blendCol.r=d.r,this.blendCol.g=d.g,this.blendCol.b=d.b,this.blendCol.a=d.a,l.r=this.blendCol.r,l.g=this.blendCol.g,l.b=this.blendCol.b,l.a=this.blendCol.a):(0===d.a&&(d.r=this.color.r,d.g=this.color.g,d.b=this.color.b,d.a=1-this.blending),this.blendCol.r=a.BB.mix(this.blendCol.r,a.BB.mix(this.blendCol.r,d.r,this.blendMix),d.a),this.blendCol.g=a.BB.mix(this.blendCol.g,a.BB.mix(this.blendCol.g,d.g,this.blendMix),d.a),this.blendCol.b=a.BB.mix(this.blendCol.b,a.BB.mix(this.blendCol.b,d.b,this.blendMix),d.a),this.blendCol.a=Math.min(1,this.blendCol.a+d.a),l.r=this.blendCol.r,l.g=this.blendCol.g,l.b=this.blendCol.b,l.a=this.blendCol.a)}var v=function(e){if(!(s.blending>=1&&s.blendCol.a<=0)){var t=e.t;i=s.lastInput2.pressure*(1-t)+n*t,o=s.settingOpacityPressure?s.opacity*i*i:s.opacity,c=s.settingSizePressure?Math.max(.1,i*s.size):Math.max(.1,s.size),0!=s.blending&&(s.mixr=a.BB.mix(s.localColOld.r,l.r,t),s.mixg=a.BB.mix(s.localColOld.g,l.g,t),s.mixb=a.BB.mix(s.localColOld.b,l.b,t)),1===s.blending&&0===s.localColOld.a&&(s.mixr=l.r,s.mixg=l.g,s.mixb=l.b);var r=s.prepDot(e.x,e.y,c);r&&(s.updateRedrawBounds(r),s.drawBuffer.push({x:e.x,y:e.y,size:c,opacity:o,x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,r:a.BB.mix(s.color.r,s.mixr,s.blending),g:a.BB.mix(s.color.g,s.mixg,s.blending),b:a.BB.mix(s.color.b,s.mixb,s.blending)}))}};null===e?this.bezierLine.addFinal(u,v):this.bezierLine.add(e,t,u,v),this.copyFromCanvas(this.redrawBounds),this.drawBuffer.forEach((function(e){s.drawDot(e)})),this.drawBuffer=[],this.localColOld=l}},{key:"setHistory",value:function(e){this.history=e}},{key:"getSize",value:function(){return this.size}},{key:"setSize",value:function(e){this.size=e}},{key:"getOpacity",value:function(){return this.opacity}},{key:"setOpacity",value:function(e){this.opacity=e}},{key:"getBlending",value:function(){return this.blending}},{key:"setBlending",value:function(e){this.blending=e}},{key:"setColor",value:function(e){this.color=a.BB.copyObj(e)}},{key:"setContext",value:function(e){this.context=e}},{key:"setSizePressure",value:function(e){this.settingSizePressure=!!e}},{key:"setOpacityPressure",value:function(e){this.settingOpacityPressure=!!e}},{key:"getLockAlpha",value:function(){return this.settingLockLayerAlpha}},{key:"setLockAlpha",value:function(e){this.settingLockLayerAlpha=!!e}},{key:"getIsDrawing",value:function(){return this.isDrawing}},{key:"setIsTesting",value:function(e){this.isTesting=!!e}},{key:"startLine",value:function(e,t,n){var r=this;this.historyEntry={tool:["brush","BlendBrush"],actions:[]};var i=Math.ceil(this.context.canvas.width/o)*Math.ceil(this.context.canvas.height/o);this.cells="0".repeat(i).split("").map((function(e){return null})),this.isDrawing=!0,n=Math.max(0,Math.min(1,n));var s=this.settingOpacityPressure?this.opacity*n*n:this.opacity,l=this.settingSizePressure?Math.max(.1,n*this.size):Math.max(.1,this.size);if(0===this.blending)this.mixr=this.color.r,this.mixg=this.color.g,this.mixb=this.color.b;else{this.copyFromCanvas(this.prepDot(e,t,l));var c=this.getAverage(e,t,this.settingSizePressure?Math.max(.1,n*this.size):Math.max(.1,this.size));0===c.a?this.blendCol={r:this.color.r,g:this.color.g,b:this.color.b,a:1-this.blending}:this.blendCol={r:c.r,g:c.g,b:c.b,a:c.a},this.mixr=this.blendCol.r,this.mixg=this.blendCol.g,this.mixb=this.blendCol.b}if(this.localColOld={r:this.mixr,g:this.mixg,b:this.mixb,a:this.blendCol.a},this.redrawBounds=null,this.drawBuffer=[],this.blending<1||this.blendCol.a>0){var u=this.prepDot(e,t,l);u&&(this.updateRedrawBounds(u),this.drawBuffer.push({x:e,y:t,size:l,opacity:s,x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,r:a.BB.mix(this.color.r,this.mixr,this.blending),g:a.BB.mix(this.color.g,this.mixg,this.blending),b:a.BB.mix(this.color.b,this.mixb,this.blending)}))}this.copyFromCanvas(this.redrawBounds),this.drawBuffer.forEach((function(e){r.drawDot(e)})),this.drawBuffer=[],this.bezierLine=new a.BB.BezierLine,this.bezierLine.add(e,t,0,(function(){})),this.lastInput.x=e,this.lastInput.y=t,this.lastInput.pressure=n,this.lastInput2=a.BB.copyObj(this.lastInput),this.redrawBounds&&!this.isTesting&&this.drawChangedCells()}},{key:"goLine",value:function(e,t,n,r){this.isDrawing&&(this.continueLine(e,t,this.lastInput.pressure,r),this.lastInput2=a.BB.copyObj(this.lastInput),this.lastInput.x=e,this.lastInput.y=t,this.lastInput.pressure=n,this.redrawBounds&&!this.isTesting&&this.drawChangedCells())}},{key:"endLine",value:function(){this.bezierLine&&this.continueLine(null,null,this.lastInput.pressure,!1),this.isDrawing=!1,this.bezierLine=null,this.redrawBounds&&this.drawChangedCells(),this.historyEntry&&this.history&&this.cells.find((function(e){return!!e}))&&(this.historyEntry.actions.push({action:"drawCells",params:[this.cells]}),this.history.push(this.historyEntry),this.historyEntry=null),this.cells=null}},{key:"drawCells",value:function(e){var t=this,n=this.getCellsWidth();e.forEach((function(e,r){if(e){var i=r%n*o,a=Math.floor(r/n)*o;t.context.putImageData(e,i,a)}}))}},{key:"drawLineSegment",value:function(e,t,n,r){var i=this;if(this.lastInput.x=n,this.lastInput.y=r,!this.isDrawing&&void 0!==e){var s=Math.ceil(this.context.canvas.width/o)*Math.ceil(this.context.canvas.height/o);this.cells="0".repeat(s).split("").map((function(e){return null})),this.redrawBounds=null,this.drawBuffer=[],this.copyFromCanvas(this.prepDot(e,t,Math.max(.1,this.size)));var l=this.getAverage(e,t,Math.max(.1,this.size));0===l.a?this.blendCol={r:this.color.r,g:this.color.g,b:this.color.b,a:1-this.blending}:this.blendCol={r:l.r,g:l.g,b:l.b,a:l.a},this.mixr=this.color.r*(1-this.blendCol.a)+(this.blending*this.blendCol.r+this.color.r*(1-this.blending))*this.blendCol.a,this.mixg=this.color.g*(1-this.blendCol.a)+(this.blending*this.blendCol.g+this.color.g*(1-this.blending))*this.blendCol.a,this.mixb=this.color.b*(1-this.blendCol.a)+(this.blending*this.blendCol.b+this.color.b*(1-this.blending))*this.blendCol.a;for(var c=this.settingOpacityPressure?1*this.opacity*1:this.opacity,u=this.settingSizePressure?Math.max(.1,1*this.size):Math.max(.1,this.size),h=Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2)),p=(n-e)/h,d=(r-t)/h,g=this.calcSpacing(u),f=0;f<=h;f+=g){var v=this.prepDot(e+p*f,t+d*f,u);v&&(this.copyFromCanvas(v),this.drawBuffer.push({x:e+p*f,y:t+d*f,size:u,opacity:c,x1:v.x1,y1:v.y1,x2:v.x2,y2:v.y2,r:a.BB.mix(this.color.r,this.mixr,this.blending),g:a.BB.mix(this.color.g,this.mixg,this.blending),b:a.BB.mix(this.color.b,this.mixb,this.blending)}))}this.drawBuffer.forEach((function(e){i.drawDot(e)})),this.drawBuffer=[],this.history&&this.cells.find((function(e){return!!e}))&&(this.drawCells(this.cells),this.historyEntry={tool:["brush","BlendBrush"],actions:[{action:"drawCells",params:[this.cells]}]},this.history.push(this.historyEntry),this.historyEntry=null),this.cells=null}}}]),e}()})),r.register("ewgr9",(function(e,n){t(e.exports,"SketchyBrush",(function(){return l}));var i=r("eWjiX"),a=r("hrnUX"),o=i.BB.canvas(32,32),s=o.getContext("2d");function l(){var e,t,n,r,l,c=1,u=.2,h=.5,p=1,d=!1,g={x:0,y:0,pressure:0},f=new a.KL.DecoyKlHistory,v=0;this.setHistory=function(e){f=e},this.setSeed=function(e){v=parseInt(e)},this.getSeed=function(){return parseInt(""+v)};var m=[],y=0,x=[function(e,t){return e},function(e,t){var n=new i.BB.RGB(e.r,e.g,e.b);return n.r*=t.r/255,n.g*=t.g/255,n.b*=t.b/255,n},function(e,t){var n=new i.BB.RGB(e.r,e.g,e.b);return n.r*=t.r/255,n.g*=t.g/255,n.b*=t.b/255,n}];this.getSize=function(){return c/2},this.setColor=function(e){t=e},this.getOpacity=function(){return u},this.setOpacity=function(e){u=e},this.getBlending=function(){return h},this.setBlending=function(e){h=e},this.setSize=function(e){c=2*e},this.getScale=function(){return p},this.setScale=function(e){p=e},this.setContext=function(t){e=t},this.startLine=function(e,i,a,o){if(o&&g.x){g.x,g.y;d=!0,this.endLine()}else d=!0,n=e,r=i,g.x=e,g.y=i,(l={tool:["brush","SketchyBrush"],actions:[]}).actions.push({action:"setScale",params:[p]}),l.actions.push({action:"setSize",params:[c/2]}),l.actions.push({action:"setOpacity",params:[u]}),l.actions.push({action:"setColor",params:[t]}),l.actions.push({action:"setBlending",params:[h]}),l.actions.push({action:"startLine",params:[e,i,a]})},this.goLine=function(a,o,s,f){if(d&&(a!==g.x||o!==g.y)){var b,w,B,C,S=parseInt(a),k=parseInt(o);m.push([S,k]);var L=t.r,A=t.g,T=t.b;if(null!==f)L=f.r,A=f.g,T=f.b;else if(0!==h&&S+5>=0&&k+5>=0&&S-5<e.canvas.width-1&&k-5<e.canvas.height-1){L=0,A=0,T=0;var I=Math.min(e.canvas.width-1,Math.max(0,S-5)),E=Math.min(e.canvas.height-1,Math.max(0,k-5)),M=Math.min(e.canvas.width-1,Math.max(0,S+5)),R=Math.min(e.canvas.height-1,Math.max(0,k+5));if(R-=E,(M-=I)>0&&R>0){for(var O=e.getImageData(I,E,M,R),P=0,D=0;D<O.data.length;D+=4)L+=O.data[D+0],A+=O.data[D+1],T+=O.data[D+2],P++;L/=P,A/=P,T/=P}var G=x[0](new i.BB.RGB(L,A,T),t);L=parseInt(""+i.BB.mix(t.r,G.r,h)),A=parseInt(""+i.BB.mix(t.g,G.g,h)),T=parseInt(""+i.BB.mix(t.b,G.b,h))}for(e.save(),e.strokeStyle="rgba("+L+", "+A+", "+T+", "+u+")",e.lineWidth=c,e.beginPath(),e.moveTo(n,r),e.lineTo(S,k),b=0;b<m.length;b++)(C=(w=m[b][0]-m[y][0])*w+(B=m[b][1]-m[y][1])*B)<4e3*p*p&&(v++,.5*Math.sin(6324634.2345*Math.cos(5342.3423*v))+.5>C/2e3/p/p)&&(e.moveTo(m[y][0]+.3*w,m[y][1]+.3*B),e.lineTo(m[b][0]-.3*w,m[b][1]-.3*B));e.stroke(),e.restore(),y++,n=S,r=k,g.x=S,g.y=k,l.actions.push({action:"goLine",params:[a,o,s,{r:L,g:A,b:T}]})}},this.endLine=function(){d=!1,y=0,m=[],l&&(l.actions.push({action:"endLine",params:[]}),f.push(l),l=void 0)},this.drawLineSegment=function(n,r,a,l){if(g.x=a,g.y=l,!d&&void 0!==n){e.save(),e.lineWidth=c;var v=t.r,m=t.g,y=t.b;if(n+5>=0&&r+5>=0&&n-5<e.canvas.width-1&&r-5<e.canvas.height-1){v=0,m=0,y=0;var b=Math.min(e.canvas.width-1,Math.max(0,n-5)),w=Math.min(e.canvas.height-1,Math.max(0,r-5)),B=Math.min(e.canvas.width-1,Math.max(0,n+5)),C=Math.min(e.canvas.height-1,Math.max(0,r+5));if(C-=w,(B-=b)>0&&C>0){var S=Math.min(o.width,B),k=Math.min(o.height,C);s.save(),s.globalCompositeOperation="copy",s.drawImage(e.canvas,b,w,B,C,0,0,S,k),s.restore();for(var L=s.getImageData(b,w,B,C),A=0,T=0;T<L.data.length;T+=4)v+=L.data[T+0],m+=L.data[T+1],y+=L.data[T+2],A++;v/=A,m/=A,y/=A}}var I=x[0](new i.BB.RGB(v,m,y),t);v=parseInt(""+(h*I.r+t.r*(1-h))),m=parseInt(""+(h*I.g+t.g*(1-h))),y=parseInt(""+(h*I.b+t.b*(1-h))),e.strokeStyle="rgba("+v+", "+m+", "+y+", "+u+")",e.beginPath(),e.moveTo(n,r),e.lineTo(a,l),e.stroke(),e.strokeStyle="rgba("+v+", "+m+", "+y+", "+u+")",e.restore();var E={tool:["brush","SketchyBrush"],actions:[]};E.actions.push({action:"setScale",params:[p]}),E.actions.push({action:"setSize",params:[c/2]}),E.actions.push({action:"setOpacity",params:[u]}),E.actions.push({action:"setColor",params:[t]}),E.actions.push({action:"setBlending",params:[h]}),E.actions.push({action:"drawLineSegment",params:[n,r,a,l]}),f.push(E)}},this.isDrawing=function(){return d}}})),r.register("kic4a",(function(e,n){t(e.exports,"PixelBrush",(function(){return o}));var i=r("eWjiX"),a=r("hrnUX");function o(){var e,t,n,r,o,s=function(){L.clearRect(0,0,4,4),L.fillStyle=x?"#fff":r;for(var t=0;t<Math.max(1,Math.round(f*A.length));t++)L.fillRect(A[t][0],A[t][1],1,1);o=e.createPattern(k,"repeat")},l=function(t,n,i,a,s){e.save(),x?(e.fillStyle=b?o:"#fff",e.globalCompositeOperation=y?"source-atop":"destination-out"):(e.fillStyle=b?o:r,y&&(e.globalCompositeOperation="source-atop")),e.globalAlpha=b?1:f,t=Math.floor(t),n=Math.floor(n),i=Math.floor(i),a=Math.floor(a);for(var l=Math.abs(i-t),c=t<i?1:-1,u=-Math.abs(a-n),h=n<a?1:-1,p=l+u;s?s=!1:e.fillRect(t,n,1,1),t!==i||n!==a;){var d=2*p;d>=u&&(p+=u,t+=c),d<=l&&(p+=l,n+=h)}e.restore()},c=function(e,t,n,r){var a=function(e,t,n,r,a){var o=i.BB.Vec2.nor({x:r.x-e.x,y:r.y-e.y}),s=i.BB.Vec2.nor({x:t.x-e.x,y:t.y-e.y}),l=i.BB.Vec2.nor({x:r.x-n.x,y:r.y-n.y});return Math.abs(i.BB.Vec2.angle(o,s)%Math.PI),Math.PI,Math.abs(i.BB.Vec2.angle(o,l)%Math.PI),Math.PI,Math.max(i.BB.Vec2.dist(o,s),i.BB.Vec2.dist(o,l))>a}(e,t,n,r,.1);e.x=Math.floor(e.x),e.y=Math.floor(e.y),r.x=Math.floor(r.x),r.y=Math.floor(r.y);var o=i.BB.dist(e.x,e.y,r.x,r.y);if(!a||o<7)l(e.x,e.y,r.x,r.y,!0);else{for(var s=Math.max(2,Math.round(o/4)),c=[],u=0;u<=s;u++){var h=u/s,p=Math.pow(1-h,3),d=3*h*Math.pow(1-h,2),g=3*Math.pow(h,2)*(1-h),f=Math.pow(h,3);c.push({x:p*e.x+d*t.x+g*n.x+f*r.x,y:p*e.y+d*t.y+g*n.y+f*r.y})}for(var v=0;v<s;v++)l(Math.round(c[v].x),Math.round(c[v].y),Math.round(c[v+1].x),Math.round(c[v+1].y),!0)}},u=function(t,n,i,a,s){e.save(),x?(e.fillStyle=b?o:"#fff",e.globalCompositeOperation=y?"source-atop":"destination-out"):(e.fillStyle=b?o:r,y&&(e.globalCompositeOperation="source-atop")),e.globalAlpha=b?1:a,e.fillRect(Math.round(t+-i),Math.round(n+-i),Math.round(2*i),Math.round(2*i)),e.restore()},h=function(t,n,r,a){function o(e){var t=i.BB.mix(B.pressure,a,e.t),n=f*(m?t*t:1),r=Math.max(.5,d*(v?t:1));u(e.x,e.y,r,n,e.angle)}function s(e){c(e.p1,e.p2,e.p3,e.p4)}if(null===S&&(S=new i.BB.BezierLine).add(w.x,w.y,0,(function(){})),e.save(),1===Math.round(2*d))null===t?S.addFinal(4,null,s):S.add(t,n,4,null,s);else{var l=r*g;null===t?S.addFinal(l,o):S.add(t,n,l,o)}e.restore()},p=new a.KL.DecoyKlHistory,d=.5,g=.9,f=1,v=!0,m=!1,y=!1,x=!1,b=!0,w={x:0,y:0,pressure:0},B={x:0,y:0,pressure:0},C=!1,S=null,k=(Math.PI,i.BB.canvas(4,4)),L=k.getContext("2d"),A=[[3,2],[1,0],[3,0],[1,2],[2,1],[0,3],[0,1],[2,3],[2,0],[0,2],[0,0],[2,2],[1,1],[3,3],[3,1],[1,3]];this.startLine=function(e,r,a){(t={tool:["brush","PixelBrush"],actions:[]}).actions.push({action:"sizePressure",params:[v]}),t.actions.push({action:"setSize",params:[d]}),t.actions.push({action:"setSpacing",params:[g]}),t.actions.push({action:"setOpacity",params:[f]}),t.actions.push({action:"setColor",params:[n]}),t.actions.push({action:"setLockAlpha",params:[y]}),t.actions.push({action:"setIsEraser",params:[x]}),t.actions.push({action:"setUseDither",params:[b]}),b&&s(),a=Math.max(0,Math.min(1,a));var o=m?f*a*a:f,l=v?Math.max(.5,a*d):Math.max(.5,d);C=!0,u(e,r,l,o),l*g,w.x=e,w.y=r,w.pressure=a,B=i.BB.copyObj(w),t.actions.push({action:"startLine",params:[e,r,a]})},this.goLine=function(e,n,r){if(C){t.actions.push({action:"goLine",params:[e,n,r]});var a=i.BB.clamp(r,0,1),o=v?Math.max(.1,w.pressure*d):Math.max(.1,d);h(e,n,o,w.pressure),B=i.BB.copyObj(w),w.x=e,w.y=n,w.pressure=a}},this.endLine=function(e,n){var r=v?Math.max(.1,w.pressure*d):Math.max(.1,d);h(null,null,r,w.pressure),C=!1,S=null,t&&(t.actions.push({action:"endLine",params:[e,n]}),p.push(t),t=void 0)},this.drawLineSegment=function(e,t,r,a){if(w.x=r,w.y=a,w.pressure=1,!C&&void 0!==e){if(b&&s(),1===Math.round(2*d))l(e,t,r,a,!0);else{i.BB.pointsToAngleDeg({x:e,y:t},{x:r,y:a});var o,c=Math.sqrt(Math.pow(r-e,2)+Math.pow(a-t,2)),h=(r-e)/c,m=(a-t)/c,B=d*g;for(o=d*g;o<=c;o+=B)u(e+h*o,t+m*o,d,f)}var S={tool:["brush","PixelBrush"],actions:[]};S.actions.push({action:"sizePressure",params:[v]}),S.actions.push({action:"setSize",params:[d]}),S.actions.push({action:"setSpacing",params:[g]}),S.actions.push({action:"setOpacity",params:[f]}),S.actions.push({action:"setColor",params:[n]}),S.actions.push({action:"setLockAlpha",params:[y]}),S.actions.push({action:"setIsEraser",params:[x]}),S.actions.push({action:"setUseDither",params:[b]}),S.actions.push({action:"drawLineSegment",params:[e,t,r,a]}),p.push(S)}},this.isDrawing=function(){return C},this.setColor=function(e){n!==e&&(r="rgb("+(n=e).r+","+n.g+","+n.b+")")},this.setContext=function(t){e=t},this.setHistory=function(e){p=e},this.setSize=function(e){d=e},this.setOpacity=function(e){f=e},this.setSpacing=function(e){g=e},this.sizePressure=function(e){v=e},this.opacityPressure=function(e){m=e},this.setLockAlpha=function(e){y=e},this.setIsEraser=function(e){x=!!e},this.setUseDither=function(e){b=!!e},this.getSpacing=function(){return g},this.getSize=function(){return d},this.getOpacity=function(){return f},this.getLockAlpha=function(){return y},this.getIsEraser=function(){return x},this.getUseDither=function(){return b}}})),r.register("7cUpm",(function(e,n){t(e.exports,"EraserBrush",(function(){return o}));var i=r("eWjiX"),a=r("hrnUX");function o(){var e,t,n,r=function(t,n,r,i){e.save(),e.globalCompositeOperation=v?m?"destination-out":"source-atop":"destination-out";var a=e.createRadialGradient(r,r,0,r,r,r),o=Math.pow(i,2);o=Math.max(0,Math.min((r-1)/r,o));var s=Math.max(0,Math.min(1,i)),l=2*s-s*s;a.addColorStop(o,"rgba(255, 255, 255, "+l+")"),a.addColorStop(1,"rgba(255, 255, 255, 0)"),e.fillStyle=a,e.translate(t-r,n-r),e.fillRect(0,0,2*r,2*r),e.restore()},o=function(e,t,i){var a,o;i=Math.max(0,Math.min(1,i));var s=h?Math.max(.1,i*l):Math.max(.1,l),d=Math.max(1,Math.max(.5,1-u)*s*c);function f(e){var t=e.t;a=g.pressure*(1-t)+i*t,o=p?u*a*a:u,s=h?Math.max(.1,a*l):Math.max(.1,l),r(e.x,e.y,s,o)}null===e?n.addFinal(d,f):n.add(e,t,d,f)},s=new a.KL.DecoyKlHistory,l=30,c=.4,u=1,h=!0,p=!1,d={x:0,y:0,pressure:0},g={x:0,y:0,pressure:0},f=!1,v=!1,m=!1;this.startLine=function(a,o,s){(t={tool:["brush","EraserBrush"],actions:[]}).actions.push({action:"opacityPressure",params:[p]}),t.actions.push({action:"sizePressure",params:[h]}),t.actions.push({action:"setSize",params:[l]}),t.actions.push({action:"setOpacity",params:[u]}),t.actions.push({action:"setTransparentBG",params:[m]}),v=0===e.canvas.index,s=Math.max(0,Math.min(1,s));var y=p?u*s*s:u,x=h?Math.max(.1,s*l):Math.max(.1,l);f=!0,x>1&&r(a,o,x,y),x*c,d.x=a,d.y=o,d.pressure=s,g=i.BB.copyObj(d),(n=new i.BB.BezierLine).add(a,o,0,(function(){})),t.actions.push({action:"startLine",params:[a,o,s]})},this.goLine=function(e,n,r){f&&(t.actions.push({action:"goLine",params:[e,n,r]}),o(e,n,d.pressure),g=i.BB.copyObj(d),d.x=e,d.y=n,d.pressure=r)},this.endLine=function(){n&&o(null,null,d.pressure),f=!1,n=void 0,t&&(t.actions.push({action:"endLine",params:[]}),s.push(t),t=void 0)},this.drawLineSegment=function(t,n,i,a){if(v=0===e.canvas.index,d.x=i,d.y=a,!f&&void 0!==t){var o,g=Math.sqrt(Math.pow(i-t,2)+Math.pow(a-n,2)),y=(i-t)/g,x=(a-n)/g,b=Math.max(1,Math.max(.5,1-u)*l*c);for(o=0;o<=g;o+=b)r(t+y*o,n+x*o,l,u);var w={tool:["brush","EraserBrush"],actions:[]};w.actions.push({action:"opacityPressure",params:[p]}),w.actions.push({action:"sizePressure",params:[h]}),w.actions.push({action:"setSize",params:[l]}),w.actions.push({action:"setOpacity",params:[u]}),w.actions.push({action:"setTransparentBG",params:[m]}),w.actions.push({action:"drawLineSegment",params:[t,n,i,a]}),s.push(w)}},this.isDrawing=function(){return f},this.setContext=function(t){e=t},this.setHistory=function(e){s=e},this.setSize=function(e){l=e},this.setOpacity=function(e){u=e},this.sizePressure=function(e){h=e},this.opacityPressure=function(e){p=e},this.setTransparentBG=function(e){m=1==e},this.getSize=function(){return l},this.getOpacity=function(){return u}}})),r.register("ltaBP",(function(e,n){t(e.exports,"SmudgeBrush",(function(){return c}));var i=r("4gaLD"),a=r("eWjiX"),o=r("hrnUX"),s=256;function l(e,t){for(var n=(t=a.BB.copyObj(t)).brush.size,r=t.brush.center.x,i=t.brush.center.y,o=t.aP.y*e.width+t.aP.x,s=4*(t.bP.y*e.width+t.bP.x-o),l=0,c=n>30?1024:512,u=[],h=0;h<c;h++)u[h]=(Math.random()-.5)/1.001+.5;var p=Math.max(3,Math.min(8,t.brush.size-8)),d=function(o,s,h,d){var g,f,v,m=a.BB.dist(r,i,h,d),y=1-t.brush.opacity*(1-(v=1,(g=(m-(n-p))/p)<=(f=0)?f:g>=v?v:g));if(1!==y){if(e.data[o+3])if(e.data[s+3]){var x;x=e.data[o+3]<e.data[s+3]?1-e.data[o+3]/e.data[s+3]*(1-y):e.data[s+3]/e.data[o+3]*y,e.data[s]=Math.floor(a.BB.mix(e.data[o],e.data[s+0],x)+u[l]),e.data[s+1]=Math.floor(a.BB.mix(e.data[o+1],e.data[s+1],x)+u[l]),e.data[s+2]=Math.floor(a.BB.mix(e.data[o+2],e.data[s+2],x)+u[l]),l=(l+1)%c}else e.data[s]=e.data[o+0],e.data[s+1]=e.data[o+1],e.data[s+2]=e.data[o+2];else;t.brush.alphaLock||(e.data[s+3]=Math.floor(a.BB.mix(e.data[o+3],e.data[s+3],y)+.5))}},g=4*t.bP.x,f=g+4*(t.size.w-1);if(t.aP.y<t.bP.y)for(var v=t.size.h-1,m=t.bP.y+t.size.h-1;v>=0;v--,m--)for(var y=(v+t.bP.y)*e.width*4,x=f+y,b=f+y-s,w=t.bP.x+t.size.w-1;x>=g+y;x-=4,b-=4,w--)d(b,x,w,m);else if(t.aP.y>t.bP.y)for(var B=0,C=t.bP.y;B<t.size.h;B++,C++)for(var S=(B+t.bP.y)*e.width*4,k=f+S,L=f+S-s,A=t.bP.x+t.size.w-1;k>=g+S;k-=4,L-=4,A--)d(L,k,A,C);else if(t.aP.x<t.bP.x)for(var T=t.size.h-1,I=t.bP.y+t.size.h-1;T>=0;T--,I--)for(var E=(T+t.bP.y)*e.width*4,M=f+E,R=f+E-s,O=t.bP.x+t.size.w-1;M>=g+E;M-=4,R-=4,O--)d(R,M,O,I);else for(var P=0,D=t.bP.y;P<t.size.h;P++,D++)for(var G=(P+t.bP.y)*e.width*4,N=g+G,j=g+G-s,z=t.bP.x;N<f+G;N+=4,j+=4,z++)d(j,N,z,D)}var c=function(){"use strict";function e(){i.classCallCheck(this,e),this.history=new o.KL.DecoyKlHistory,this.settingColor={r:0,g:0,b:0},this.settingSize=35,this.settingSpacing=.20446882736951905,this.settingOpacity=.8,this.settingHasSizePressure=!1,this.settingHasOpacityPressure=!1,this.settingLockLayerAlpha=!1,this.lastInput={x:0,y:0,pressure:0},this.lastInput2={x:0,y:0,pressure:0},this.isDrawing=!1,this.bezierLine=null,this.drawBuffer=[]}return i.createClass(e,[{key:"updateRedrawBounds",value:function(e){this.redrawBounds=a.BB.updateBounds(this.redrawBounds,e)}},{key:"updateCompleteRedrawBounds",value:function(e,t,n,r){this.completeRedrawBounds=a.BB.updateBounds(this.completeRedrawBounds,{x1:e,y1:t,x2:n,y2:r})}},{key:"copyFromCanvas",value:function(){var e=this,t=this.copiedCells.map((function(e){return!1})),n=[],r=Math.ceil(this.copyImageData.width/s);this.redrawBounds&&(n.push({x1:Math.floor(this.redrawBounds.x1/s),y1:Math.floor(this.redrawBounds.y1/s),x2:Math.floor(this.redrawBounds.x2/s),y2:Math.floor(this.redrawBounds.y2/s)}),n.forEach((function(e){for(var n=e.x1;n<=e.x2;n++)for(var i=e.y1;i<=e.y2;i++)t[i*r+n]=!0})),t.forEach((function(t,n){if(t&&!e.copiedCells[n]){e.copiedCells[n]=!0;var i=n%r,o=Math.floor(n/r),l=(Math.min(i*s+s,e.copyImageData.width)-1)%s+1,c=(Math.min(o*s+s,e.copyImageData.height)-1)%s+1,u=a.BB.canvas(l,c).getContext("2d");u.drawImage(e.context.canvas,-i*s,-o*s);for(var h=u.getImageData(0,0,l,c),p=0;p<c;p++)for(var d=0,g=p*l*4,f=4*((o*s+p)*e.copyImageData.width+i*s);d<l;d++,g+=4,f+=4)e.copyImageData.data[f]=h.data[g],e.copyImageData.data[f+1]=h.data[g+1],e.copyImageData.data[f+2]=h.data[g+2],e.copyImageData.data[f+3]=h.data[g+3]}})))}},{key:"prepDot",value:function(e,t,n,r){if(this.lastDot){n=Math.round(n);var i=Math.round(2*n),o=Math.round(2*n),s=function(e,t,n,r,i){if(n.x===r.x&&n.y===r.y)return null;n=a.BB.copyObj(n),r=a.BB.copyObj(r),i=a.BB.copyObj(i);var o=0,s=0,l=0,c=0;return n.x<0&&(c=-n.x),n.y<0&&(o=-n.y),r.x<0&&(c=Math.max(c,-r.x)),r.y<0&&(o=Math.max(o,-r.y)),n.x+i.w>e&&(s=n.x+i.w-e),n.y+i.h>t&&(l=n.y+i.h-t),r.x+i.w>e&&(s=Math.max(s,r.x+i.w-e)),r.y+i.h>t&&(l=Math.max(l,r.y+i.h-t)),n.x+=c,r.x+=c,n.y+=o,r.y+=o,i.w=i.w-c-s,i.h=i.h-o-l,i.w<=0||i.h<=0?null:{aP:{x:n.x,y:n.y},bP:{x:r.x,y:r.y},size:{w:i.w,h:i.h}}}(this.copyImageData.width,this.copyImageData.height,{x:Math.round(this.lastDot.x-n),y:Math.round(this.lastDot.y-n)},{x:Math.round(e-n),y:Math.round(t-n)},{w:i,h:o});if(s){var l={aP:s.aP,bP:s.bP,size:s.size,brush:{center:{x:e,y:t},size:n,opacity:r,alphaLock:this.settingLockLayerAlpha}};this.updateRedrawBounds({x1:l.bP.x,y1:l.bP.y,x2:l.bP.x+2*l.brush.size,y2:l.bP.y+2*l.brush.size}),this.drawBuffer.push(l)}this.lastDot={x:e,y:t}}else this.lastDot={x:e,y:t}}},{key:"continueLine",value:function(e,t,n,r){var i=this;this.drawBuffer=[],null===this.bezierLine&&(this.bezierLine=new a.BB.BezierLine,this.bezierLine.add(this.lastInput.x,this.lastInput.y,0,(function(){})));var o=[],s=function(e){var t=a.BB.mix(i.lastInput2.pressure,r,e.t),n=i.settingOpacity*(i.settingHasOpacityPressure?t*t:1),s=Math.max(.1,i.settingSize*(i.settingHasSizePressure?t:1));o.push([e.x,e.y,s,n,e.angle])},c=n*this.settingSpacing/3;null===e?this.bezierLine.addFinal(c,s):this.bezierLine.add(e,t,c,s);for(var u=0;u<o.length;u++){var h=o[u];this.prepDot(h[0],h[1],h[2],h[3]),h}this.copyFromCanvas();for(var p=0;p<this.drawBuffer.length;p++)l(this.copyImageData,this.drawBuffer[p])}},{key:"startLine",value:function(e,t,n){this.historyEntry={tool:["brush","SmudgeBrush"],actions:[]},n=a.BB.clamp(n,0,1);var r=this.settingHasOpacityPressure?this.settingOpacity*n*n:this.settingOpacity,i=this.settingHasSizePressure?Math.max(.1,n*this.settingSize):Math.max(.1,this.settingSize);this.lastDot=null,this.isDrawing=!0,this.copyImageData=new ImageData(this.context.canvas.width,this.context.canvas.height);var o=Math.ceil(this.context.canvas.width/s)*Math.ceil(this.context.canvas.height/s);this.copiedCells="0".repeat(o).split("").map((function(e){return!1})),this.prepDot(e,t,i,r),this.lineToolLastDot=i*this.settingSpacing,this.lastInput.x=e,this.lastInput.y=t,this.lastInput.pressure=n,this.lastInput2.pressure=n,this.completeRedrawBounds=null}},{key:"goLine",value:function(e,t,n){if(this.isDrawing){this.redrawBounds=null;var r=a.BB.clamp(n,0,1),i=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);this.continueLine(e,t,i,this.lastInput.pressure),this.redrawBounds&&(this.context.putImageData(this.copyImageData,0,0,this.redrawBounds.x1,this.redrawBounds.y1,this.redrawBounds.x2-this.redrawBounds.x1-1,this.redrawBounds.y2-this.redrawBounds.y1-1),this.updateCompleteRedrawBounds(this.redrawBounds.x1,this.redrawBounds.y1,this.redrawBounds.x2,this.redrawBounds.y2)),this.lastInput.x=e,this.lastInput.y=t,this.lastInput2.pressure=this.lastInput.pressure,this.lastInput.pressure=r}}},{key:"endLine",value:function(){this.redrawBounds=null;var e=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);if(this.context.save(),this.continueLine(null,null,e,this.lastInput.pressure),this.context.restore(),this.isDrawing=!1,this.bezierLine=null,this.redrawBounds&&(this.context.putImageData(this.copyImageData,0,0,this.redrawBounds.x1,this.redrawBounds.y1,this.redrawBounds.x2-this.redrawBounds.x1-1,this.redrawBounds.y2-this.redrawBounds.y1-1),this.updateCompleteRedrawBounds(this.redrawBounds.x1,this.redrawBounds.y1,this.redrawBounds.x2,this.redrawBounds.y2)),this.historyEntry&&this.completeRedrawBounds){var t=this.copyImageData;if(!(0===this.completeRedrawBounds.x1&&0===this.completeRedrawBounds.y1&&this.completeRedrawBounds.x2>=this.context.canvas.width-1&&this.completeRedrawBounds.y2>=this.context.canvas.height-1)){var n=a.BB.canvas(this.completeRedrawBounds.x2-this.completeRedrawBounds.x1+1,this.completeRedrawBounds.y2-this.completeRedrawBounds.y1+1);n.getContext("2d").drawImage(this.context.canvas,-this.completeRedrawBounds.x1,-this.completeRedrawBounds.y1),t=n}this.historyEntry.actions.push({action:"drawImage",params:[t,this.completeRedrawBounds.x1,this.completeRedrawBounds.y1]}),this.history.push(this.historyEntry),this.historyEntry=void 0}this.copyImageData=null}},{key:"drawImage",value:function(e,t,n){e instanceof ImageData?this.context.putImageData(e,t,n):(this.context.clearRect(t,n,e.width,e.height),this.context.drawImage(e,t,n))}},{key:"drawLineSegment",value:function(e,t,n,r){}},{key:"getIsDrawing",value:function(){return this.isDrawing}},{key:"setColor",value:function(e){this.settingColor.r===e.r&&this.settingColor.g===e.g&&this.settingColor.b===e.b||(this.settingColor={r:e.r,g:e.g,b:e.b},this.settingColorStr=a.BB.ColorConverter.toRgbStr(this.settingColor))}},{key:"setContext",value:function(e){this.context=e}},{key:"setHistory",value:function(e){this.history=e}},{key:"setSize",value:function(e){this.settingSize=e}},{key:"setOpacity",value:function(e){this.settingOpacity=e}},{key:"setSpacing",value:function(e){this.settingSpacing=e}},{key:"sizePressure",value:function(e){this.settingHasSizePressure=!!e}},{key:"opacityPressure",value:function(e){this.settingHasOpacityPressure=!!e}},{key:"setLockAlpha",value:function(e){this.settingLockLayerAlpha=!!e}},{key:"getSpacing",value:function(){return this.settingSpacing}},{key:"getSize",value:function(){return this.settingSize}},{key:"getOpacity",value:function(){return this.settingOpacity}},{key:"getLockAlpha",value:function(){return this.settingLockLayerAlpha}}]),e}()})),r.register("6Nq1H",(function(e,n){t(e.exports,"ChemyBrush",(function(){return o}));var i=r("4gaLD"),a=r("eWjiX"),o=function(){"use strict";function e(){i.classCallCheck(this,e),this.settingSize=.25,this.settingOpacity=1,this.settingLockLayerAlpha=!1,this.settingIsEraser=!1,this.settingMode="fill",this.settingDistort=0,this.settingXSymmetry=!1,this.settingYSymmetry=!1,this.settingGradient=!1,this.isDrawing=!1}return i.createClass(e,[{key:"updateCompleteRedrawBounds",value:function(e,t){var n={x1:e,y1:t,x2:e,y2:t};this.settingXSymmetry&&(n=a.BB.updateBounds(n,{x1:-e+this.copyCanvas.width,y1:t,x2:-e+this.copyCanvas.width,y2:t})),this.settingYSymmetry&&(n=a.BB.updateBounds(n,{x1:e,y1:-t+this.copyCanvas.height,x2:e,y2:-t+this.copyCanvas.height}));var r="stroke"===this.settingMode?this.settingSize+1:1;n.x1=Math.floor(n.x1-r),n.y1=Math.floor(n.y1-r),n.x2=Math.ceil(n.x2+r),n.y2=Math.ceil(n.y2+r),this.completeRedrawBounds=a.BB.updateBounds(this.completeRedrawBounds,n)}},{key:"drawShape",value:function(){this.context.save(),this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),this.context.drawImage(this.copyCanvas,0,0);var e=i.objectSpread({},this.settingColor);if(this.settingIsEraser?(e.r=255,e.g=255,e.b=255,this.settingLockLayerAlpha?this.context.globalCompositeOperation="source-atop":this.context.globalCompositeOperation="destination-out"):this.settingLockLayerAlpha&&(this.context.globalCompositeOperation="source-atop"),this.path){var t=this,n=new Path2D;this.path.forEach((function(e,t){0===t?n.moveTo(e.x,e.y):n.lineTo(e.x,e.y)}));var r=a.BB.ColorConverter.toRgbaStr({r:e.r,g:e.g,b:e.b,a:this.settingOpacity});if(this.settingGradient){var o=this.path[0].x>this.path[this.path.length-1].x,s=this.context.createLinearGradient(0,o?this.minY:this.maxY,0,o?this.maxY:this.minY);s.addColorStop(0,a.BB.ColorConverter.toRgbaStr({r:e.r,g:e.g,b:e.b,a:this.settingOpacity})),s.addColorStop(1,a.BB.ColorConverter.toRgbaStr({r:e.r,g:e.g,b:e.b,a:0})),r=s}"fill"===this.settingMode?this.context.fillStyle=r:(this.context.lineWidth=2*this.settingSize,this.context.lineJoin="bevel",this.context.strokeStyle=r);var l=function(){"fill"===t.settingMode?t.context.fill(n):t.context.stroke(n)};l(),this.settingXSymmetry&&(this.context.save(),this.context.translate(this.context.canvas.width/2,0),this.context.scale(-1,1),this.context.translate(-this.context.canvas.width/2,0),l(),this.context.restore()),this.settingYSymmetry&&(this.context.save(),this.context.translate(0,this.context.canvas.height/2),this.context.scale(1,-1),this.context.translate(0,-this.context.canvas.height/2),l(),this.context.restore(),this.settingXSymmetry&&(this.context.save(),this.context.translate(this.context.canvas.width/2,this.context.canvas.height/2),this.context.scale(-1,-1),this.context.translate(-this.context.canvas.width/2,-this.context.canvas.height/2),l(),this.context.restore()))}this.context.restore()}},{key:"setHistory",value:function(e){this.history=e}},{key:"getSize",value:function(){return"stroke"===this.settingMode?this.settingSize:0}},{key:"setSize",value:function(e){this.settingSize=e}},{key:"getOpacity",value:function(){return this.settingOpacity}},{key:"setOpacity",value:function(e){this.settingOpacity=e}},{key:"setColor",value:function(e){this.settingColor=a.BB.copyObj(e)}},{key:"setContext",value:function(e){this.context=e}},{key:"setMode",value:function(e){this.settingMode=e}},{key:"getMode",value:function(){return this.settingMode}},{key:"setDistort",value:function(e){this.settingDistort=a.BB.clamp(e,0,1)}},{key:"getDistort",value:function(){return this.settingDistort}},{key:"setXSymmetry",value:function(e){this.settingXSymmetry=!!e}},{key:"getXSymmetry",value:function(){return this.settingXSymmetry}},{key:"setYSymmetry",value:function(e){this.settingYSymmetry=!!e}},{key:"getYSymmetry",value:function(){return this.settingYSymmetry}},{key:"setGradient",value:function(e){this.settingGradient=!!e}},{key:"getGradient",value:function(){return this.settingGradient}},{key:"getLockAlpha",value:function(){return this.settingLockLayerAlpha}},{key:"setLockAlpha",value:function(e){this.settingLockLayerAlpha=!!e}},{key:"getIsEraser",value:function(){return this.settingIsEraser}},{key:"setIsEraser",value:function(e){this.settingIsEraser=!!e}},{key:"getIsDrawing",value:function(){return this.isDrawing}},{key:"startLine",value:function(e,t){this.isDrawing=!0,this.path=[{x:e,y:t}],this.minY=t,this.maxY=t,this.copyCanvas=a.BB.canvas(this.context.canvas.width,this.context.canvas.height),this.copyCanvas.getContext("2d").drawImage(this.context.canvas,0,0),this.completeRedrawBounds=null,this.updateCompleteRedrawBounds(e,t)}},{key:"goLine",value:function(e,t){if(this.isDrawing){var n={x:e,y:t};this.settingDistort>0&&(n.x+=(Math.random()-.5)*this.settingDistort*80,n.y+=(Math.random()-.5)*this.settingDistort*80),this.minY=Math.min(this.minY,n.y),this.maxY=Math.max(this.maxY,n.y),this.path.push(n),this.updateCompleteRedrawBounds(e,t),this.drawShape()}}},{key:"endLine",value:function(){if(this.isDrawing=!1,this.completeRedrawBounds=a.BB.boundsInArea(this.completeRedrawBounds,this.copyCanvas.width,this.copyCanvas.height),this.path.length>1&&this.completeRedrawBounds){var e=a.BB.canvas(this.completeRedrawBounds.x2-this.completeRedrawBounds.x1+1,this.completeRedrawBounds.y2-this.completeRedrawBounds.y1+1);e.getContext("2d").drawImage(this.context.canvas,-this.completeRedrawBounds.x1,-this.completeRedrawBounds.y1),this.history.push({tool:["brush","ChemyBrush"],actions:[{action:"drawImage",params:[e,this.completeRedrawBounds.x1,this.completeRedrawBounds.y1]}]})}this.path=null,this.copyCanvas=null}},{key:"drawImage",value:function(e,t,n){this.context.save(),this.context.clearRect(t,n,e.width,e.height),this.context.drawImage(e,t,n),this.context.restore()}},{key:"drawLineSegment",value:function(e,t,n,r){}}]),e}()})),r.register("3P46L",(function(e,n){t(e.exports,"brushesUI",(function(){return h}));var i=r("cVFne"),a=r("9mjXI"),o=r("iYbUv"),s=r("brjBD"),l=r("9rc5F"),c=r("dS2qM"),u=r("vCnsd"),h={penBrush:i.penBrushUi,blendBrush:a.blendBrushUi,sketchyBrush:o.sketchyBrushUi,pixelBrush:s.pixelBrushUi,chemyBrush:u.chemyBrushUi,smudgeBrush:c.smudgeBrushUi,eraserBrush:l.eraserBrushUi}})),r.register("cVFne",(function(n,i){t(n.exports,"penBrushUi",(function(){return m}));var a,o,s=r("eWjiX"),l=r("dAXbp"),c=r("7NTKy"),u=r("gWfkn"),h=r("lXqiv"),p=r("llzZ0"),d=r("fCJWy"),g=r("7gVvp"),f=r("74D3O"),v=r("1mH1z"),m=(a={image:e(g),tooltip:v.LANG("brush-pen"),sizeSlider:{min:.5,max:100,curve:s.BB.quadraticSplineInput(.5,100,.1)},opacitySlider:{min:0,max:1,curve:[[0,.01],[.5,.3],[1,1]]},Ui:null},o=[v.LANG("brush-pen-circle"),v.LANG("brush-pen-chalk"),v.LANG("brush-pen-calligraphy"),v.LANG("brush-pen-square")],v.languageStrings.subscribe((function(){a.tooltip=v.LANG("brush-pen"),o=[v.LANG("brush-pen-circle"),v.LANG("brush-pen-chalk"),v.LANG("brush-pen-calligraphy"),v.LANG("brush-pen-square")]})),a.Ui=function(e){var t,n,r=function(){for(var e=0;e<y.length;e++)y[e].className=e===x?"brush-alpha-selected":"brush-alpha"},i=function(e){m.setSize(e),m.setSpacing(Math.max(2,B.interpolate(e))/15)},g=document.createElement("div"),m=new l.brushes.PenBrush;m.setHistory(u.klHistory),e.onSizeChange(m.getSize());for(var y=[],x=0,b=0;b<4;b++)!function(e){var t=s.BB.el({title:o[e],onClick:function(){var t;x=t=e,m.setAlpha(t),r()}}),n=s.BB.canvas(70,70),i=n.getContext("2d");0===e||3===e?0===e?(i.beginPath(),i.arc(35,35,30,0,2*Math.PI),i.closePath(),i.fill()):i.fillRect(5,5,60,60):1===e?i.drawImage(f.genBrushAlpha01(60),5,5):2===e&&i.drawImage(f.genBrushAlpha02(60),5,5),t.style.backgroundImage="url("+n.toDataURL("image/png")+")",y.push(t)}(b);r();var w=new h.Checkbox({init:m.getLockAlpha(),label:v.LANG("brush-lock-alpha"),callback:function(e){m.setLockAlpha(e)},doHighlight:!0,title:v.LANG("brush-lock-alpha-title"),css:{cssFloat:"right",textAlign:"right"}}),B=new s.BB.SplineInterpolator([[0,15],[8,7],[14,4],[30,3],[50,2.7],[100,2]]);!function(){t=new p.KlSlider({label:v.LANG("brush-size"),width:225,height:30,min:a.sizeSlider.min,max:a.sizeSlider.max,initValue:m.getSize(),eventResMs:c.eventResMs,onChange:function(t){i(t),e.onSizeChange(t)},curve:a.sizeSlider.curve,formatFunc:function(e){return(e*=2)<10?Math.round(10*e)/10:Math.round(e)}}),n=new p.KlSlider({label:v.LANG("opacity"),width:225,height:30,min:a.opacitySlider.min,max:a.opacitySlider.max,initValue:a.opacitySlider.max,eventResMs:c.eventResMs,onChange:function(t){m.setOpacity(t),e.onOpacityChange(t)},curve:a.opacitySlider.curve,formatFunc:function(e){return Math.round(100*e)}});var r=d.penPressureToggle(!0,(function(e){m.sizePressure(e)})),o=d.penPressureToggle(!1,(function(e){m.opacityPressure(e)}));g.append(s.BB.el({content:[t.getElement(),r],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),s.BB.el({content:[n.getElement(),o],css:{display:"flex",justifyContent:"space-between",alignItems:"center"}}));for(var l=document.createElement("div"),u=0;u<y.length;u++)l.appendChild(y[u]);l.style.marginTop="10px",g.appendChild(l),l.appendChild(w.getElement())}(),this.increaseSize=function(e){m.isDrawing()||t.increaseValue(e)},this.decreaseSize=function(e){m.isDrawing()||t.decreaseValue(e)},this.getSize=function(){return m.getSize()},this.setSize=function(e){i(e),t.setValue(e)},this.getOpacity=function(){return m.getOpacity()},this.setOpacity=function(e){m.setOpacity(e),n.setValue(e)},this.setColor=function(e){m.setColor(e)},this.setContext=function(e){m.setContext(e)},this.startLine=function(e,t,n){m.startLine(e,t,n)},this.goLine=function(e,t,n){m.goLine(e,t,n)},this.endLine=function(e,t){m.endLine(e,t)},this.getBrush=function(){return m},this.isDrawing=function(){return m.isDrawing()},this.getElement=function(){return g}},a)})),r.register("7NTKy",(function(e,n){t(e.exports,"eventResMs",(function(){return r}));var r=20})),r.register("7gVvp",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("iiCd6")})),r.register("9mjXI",(function(n,i){t(n.exports,"blendBrushUi",(function(){return f}));var a,o=r("eWjiX"),s=r("fCJWy"),l=r("7NTKy"),c=r("lXqiv"),u=r("dAXbp"),h=r("gWfkn"),p=r("llzZ0"),d=r("cQSIC"),g=r("1mH1z"),f=(a={image:e(d),tooltip:g.LANG("brush-blend"),sizeSlider:{min:.5,max:100,curve:o.BB.quadraticSplineInput(.5,100,.1)},opacitySlider:{min:.01,max:1},Ui:null},g.languageStrings.subscribe((function(){a.tooltip=g.LANG("brush-blend")})),a.Ui=function(e){var t,n,r=function(e){d.setSize(e)},i=document.createElement("div"),d=new u.brushes.BlendBrush;d.setHistory(h.klHistory),e.onSizeChange(d.getSize()),function(){t=new p.KlSlider({label:g.LANG("brush-size"),width:225,height:30,min:a.sizeSlider.min,max:a.sizeSlider.max,initValue:29,eventResMs:l.eventResMs,onChange:function(t){r(t),e.onSizeChange(t)},curve:a.sizeSlider.curve,formatFunc:function(e){return e*=2,Math.round(e)}}),n=new p.KlSlider({label:g.LANG("opacity"),width:225,height:30,min:a.opacitySlider.min,max:a.opacitySlider.max,initValue:d.getOpacity(),eventResMs:l.eventResMs,onChange:function(t){d.setOpacity(t),e.onOpacityChange(t)},formatFunc:function(e){return Math.round(100*e)}});var u=new p.KlSlider({label:g.LANG("brush-blending"),width:225,height:30,min:0,max:100,initValue:100*d.getBlending(),eventResMs:l.eventResMs,onChange:function(e){d.setBlending(e/100)}});u.getElement().style.marginTop="10px";var h=s.penPressureToggle(!0,(function(e){d.setSizePressure(e)})),f=s.penPressureToggle(!1,(function(e){d.setOpacityPressure(e)})),v=new c.Checkbox({init:d.getLockAlpha(),label:g.LANG("brush-lock-alpha"),callback:function(e){d.setLockAlpha(e)},doHighlight:!0,title:g.LANG("brush-lock-alpha-title"),css:{marginTop:"10px",display:"inline-block"}});i.append(o.BB.el({content:[t.getElement(),h],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),o.BB.el({content:[n.getElement(),f],css:{display:"flex",justifyContent:"space-between",alignItems:"center"}}),u.getElement(),v.getElement())}(),this.increaseSize=function(e){d.getIsDrawing()||t.increaseValue(e)},this.decreaseSize=function(e){d.getIsDrawing()||t.decreaseValue(e)},this.getSize=function(){return d.getSize()},this.setSize=function(e){r(e),t.setValue(e)},this.getOpacity=function(){return d.getOpacity()},this.setOpacity=function(e){d.setOpacity(e),n.setValue(e)},this.setColor=function(e){d.setColor(e)},this.setContext=function(e){d.setContext(e)},this.startLine=function(e,t,n){d.startLine(e,t,n)},this.goLine=function(e,t,n,r){d.goLine(e,t,n,r)},this.endLine=function(){d.endLine()},this.getBrush=function(){return d},this.isDrawing=function(){return d.getIsDrawing()},this.getElement=function(){return i}},a)})),r.register("cQSIC",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("6fRlX")})),r.register("iYbUv",(function(n,i){t(n.exports,"sketchyBrushUi",(function(){return p}));var a,o=r("dAXbp"),s=r("7NTKy"),l=r("gWfkn"),c=r("llzZ0"),u=r("bteky"),h=r("1mH1z"),p=(a={image:e(u),tooltip:h.LANG("brush-sketchy"),sizeSlider:{min:.5,max:10},opacitySlider:{min:.01,max:1},Ui:null},h.languageStrings.subscribe((function(){a.tooltip=h.LANG("brush-sketchy")})),a.Ui=function(e){var t,n,r=document.createElement("div"),i=new o.brushes.SketchyBrush;i.setHistory(l.klHistory),e.onSizeChange(i.getSize()),function(){t=new c.KlSlider({label:h.LANG("brush-size"),width:250,height:30,min:a.sizeSlider.min,max:a.sizeSlider.max,initValue:i.getSize(),eventResMs:s.eventResMs,onChange:function(t){i.setSize(t),e.onSizeChange(i.getSize())},formatFunc:function(e){return(e*=2)<10?Math.round(10*e)/10:Math.round(e)}}),n=new c.KlSlider({label:h.LANG("opacity"),width:250,height:30,min:a.opacitySlider.min,max:a.opacitySlider.max,initValue:i.getOpacity(),eventResMs:s.eventResMs,onChange:function(t){i.setOpacity(t),e.onOpacityChange(t)},formatFunc:function(e){return Math.round(100*e)}});var o=new c.KlSlider({label:h.LANG("brush-blending"),width:250,height:30,min:0,max:100,initValue:100*i.getBlending(),eventResMs:s.eventResMs,onChange:function(e){i.setBlending(e/100)}}),l=new c.KlSlider({label:h.LANG("brush-sketchy-scale"),width:250,height:30,min:1,max:20,initValue:i.getScale(),eventResMs:s.eventResMs,onChange:function(e){i.setScale(e)}});n.getElement().style.marginTop="10px",o.getElement().style.marginTop="10px",l.getElement().style.marginTop="10px",r.appendChild(t.getElement()),r.appendChild(n.getElement()),r.appendChild(o.getElement()),r.appendChild(l.getElement())}(),this.increaseSize=function(e){i.isDrawing()||t.increaseValue(e)},this.decreaseSize=function(e){i.isDrawing()||t.decreaseValue(e)},this.getSize=function(){return i.getSize()},this.setSize=function(e){!function(e){i.setSize(e)}(e),t.setValue(e)},this.getOpacity=function(){return i.getOpacity()},this.setOpacity=function(e){i.setOpacity(e),n.setValue(e)},this.setColor=function(e){i.setColor(e)},this.setContext=function(e){i.setContext(e)},this.startLine=function(e,t,n){i.startLine(e,t,n)},this.goLine=function(e,t,n){i.goLine(e,t,n,null)},this.endLine=function(){i.endLine()},this.getSeed=function(){return parseInt(i.getSeed())},this.setSeed=function(e){i.setSeed(parseInt(e))},this.getBrush=function(){return i},this.isDrawing=function(){return i.isDrawing()},this.getElement=function(){return r}},a)})),r.register("bteky",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("hC7PC")})),r.register("brjBD",(function(n,i){t(n.exports,"pixelBrushUi",(function(){return f}));var a,o=r("eWjiX"),s=r("dAXbp"),l=r("7NTKy"),c=r("gWfkn"),u=r("lXqiv"),h=r("llzZ0"),p=r("fCJWy"),d=r("4PDnu"),g=r("1mH1z"),f=(a={image:e(d),tooltip:g.LANG("brush-pixel"),sizeSlider:{min:.5,max:100,curve:o.BB.quadraticSplineInput(.5,100,.1)},opacitySlider:{min:0,max:1,curve:[[0,.01],[.5,.3],[1,1]]},Ui:null},g.languageStrings.subscribe((function(){a.tooltip=g.LANG("brush-pixel")})),a.Ui=function(e){var t,n,r=function(e){d.setSize(e),d.setSpacing(y.interpolate(e)/e)},i=document.createElement("div"),d=new s.brushes.PixelBrush;d.setHistory(c.klHistory),e.onSizeChange(d.getSize());var f=new u.Checkbox({init:d.getLockAlpha(),label:g.LANG("brush-lock-alpha"),callback:function(e){d.setLockAlpha(e)},doHighlight:!0,title:g.LANG("brush-lock-alpha-title"),css:{marginRight:"10px"}}),v=new u.Checkbox({init:d.getIsEraser(),label:g.LANG("eraser"),callback:function(e){d.setIsEraser(e)},css:{marginRight:"10px"}}),m=new u.Checkbox({init:d.getUseDither(),label:g.LANG("brush-pixel-dither"),callback:function(e){d.setUseDither(e)}}),y=new o.BB.SplineInterpolator([[.5,.45],[100,4]]);!function(){t=new h.KlSlider({label:g.LANG("brush-size"),width:225,height:30,min:a.sizeSlider.min,max:a.sizeSlider.max,initValue:d.getSize(),eventResMs:l.eventResMs,onChange:function(t){t=Math.round(2*t)/2,r(t),e.onSizeChange(t)},curve:a.sizeSlider.curve,formatFunc:function(e){return e*=2,Math.round(e)}}),n=new h.KlSlider({label:g.LANG("opacity"),width:225,height:30,min:a.opacitySlider.min,max:a.opacitySlider.max,initValue:a.opacitySlider.max,eventResMs:l.eventResMs,onChange:function(t){d.setOpacity(t),e.onOpacityChange(t)},curve:a.opacitySlider.curve,formatFunc:function(e){return Math.round(100*e)}});var s=p.penPressureToggle(!0,(function(e){d.sizePressure(e)}));i.append(o.BB.el({content:[t.getElement(),s],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),n.getElement());var c=o.BB.el({parent:i,css:{display:"flex",marginTop:"10px"}});c.appendChild(f.getElement()),c.appendChild(v.getElement()),c.appendChild(m.getElement())}(),this.increaseSize=function(e){d.isDrawing()||t.increaseValue(e)},this.decreaseSize=function(e){d.isDrawing()||t.decreaseValue(e)},this.getSize=function(){return d.getSize()},this.setSize=function(e){r(e),t.setValue(e)},this.getOpacity=function(){return d.getOpacity()},this.setOpacity=function(e){d.setOpacity(e),n.setValue(e)},this.setColor=function(e){d.setColor(e)},this.setContext=function(e){d.setContext(e)},this.startLine=function(e,t,n){d.startLine(e,t,n)},this.goLine=function(e,t,n){d.goLine(e,t,n)},this.endLine=function(e,t){d.endLine(e,t)},this.getBrush=function(){return d},this.isDrawing=function(){return d.isDrawing()},this.getElement=function(){return i}},a)})),r.register("4PDnu",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("eZgVv")})),r.register("9rc5F",(function(n,i){t(n.exports,"eraserBrushUi",(function(){return f}));var a,o=r("eWjiX"),s=r("dAXbp"),l=r("7NTKy"),c=r("gWfkn"),u=r("llzZ0"),h=r("fCJWy"),p=r("lXqiv"),d=r("984eq"),g=r("1mH1z"),f=(a={image:e(d),tooltip:g.LANG("eraser")+" [E]",sizeSlider:{min:.5,max:200,curve:o.BB.quadraticSplineInput(.5,200,.1)},opacitySlider:{min:.01,max:1},Ui:null},g.languageStrings.subscribe((function(){a.tooltip=g.LANG("eraser")+" [E]"})),a.Ui=function(e){var t,n,r=function(e){d.setSize(e)},i=document.createElement("div"),d=new s.brushes.EraserBrush;d.setHistory(c.klHistory),e.onSizeChange(d.getSize());var f=!1;!function(){t=new u.KlSlider({label:g.LANG("brush-size"),width:225,height:30,min:a.sizeSlider.min,max:a.sizeSlider.max,initValue:30,eventResMs:l.eventResMs,onChange:function(t){r(t),e.onSizeChange(t)},curve:a.sizeSlider.curve,formatFunc:function(e){return(e*=2)<10?Math.round(10*e)/10:Math.round(e)}}),n=new u.KlSlider({label:g.LANG("opacity"),width:225,height:30,min:a.opacitySlider.min,max:a.opacitySlider.max,initValue:1,eventResMs:l.eventResMs,onChange:function(t){d.setOpacity(t),e.onOpacityChange(t)},formatFunc:function(e){return Math.round(100*e)}});var s=h.penPressureToggle(!0,(function(e){d.sizePressure(e)})),c=h.penPressureToggle(!1,(function(e){d.opacityPressure(e)}));i.append(o.BB.el({content:[t.getElement(),s],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),o.BB.el({content:[n.getElement(),c],css:{display:"flex",justifyContent:"space-between",alignItems:"center"}}));var v=new p.Checkbox({init:!1,label:g.LANG("brush-eraser-transparent-bg"),callback:function(e){f=e,d.setTransparentBG(e)},css:{marginTop:"10px"}});i.appendChild(v.getElement())}(),this.increaseSize=function(e){d.isDrawing()||t.increaseValue(e)},this.decreaseSize=function(e){d.isDrawing()||t.decreaseValue(e)},this.getSize=function(){return d.getSize()},this.setSize=function(e){r(e),t.setValue(e)},this.getOpacity=function(){return d.getOpacity()},this.setOpacity=function(e){d.setOpacity(e),n.setValue(e)},this.setColor=function(e){},this.setContext=function(e){d.setContext(e)},this.startLine=function(e,t,n){d.startLine(e,t,n)},this.goLine=function(e,t,n){d.goLine(e,t,n)},this.endLine=function(){d.endLine()},this.getBrush=function(){return d},this.getIsTransparentBg=function(){return f},this.isDrawing=function(){return d.isDrawing()},this.getElement=function(){return i}},a)})),r.register("984eq",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("fPZin")})),r.register("dS2qM",(function(n,i){t(n.exports,"smudgeBrushUi",(function(){return f}));var a,o=r("eWjiX"),s=r("dAXbp"),l=r("7NTKy"),c=r("gWfkn"),u=r("lXqiv"),h=r("llzZ0"),p=r("fCJWy"),d=r("3QgTy"),g=r("1mH1z"),f=(a={image:e(d),tooltip:g.LANG("brush-smudge"),sizeSlider:{min:.5,max:100,curve:o.BB.quadraticSplineInput(.5,100,.1)},opacitySlider:{min:0,max:1,curve:[[0,.01],[.5,.3],[1,1]]},Ui:null},g.languageStrings.subscribe((function(){a.tooltip=g.LANG("brush-smudge")})),a.Ui=function(e){var t,n,r=function(e){d.setSize(e),d.setSpacing(Math.max(2,v.interpolate(e))/15)},i=document.createElement("div"),d=new s.brushes.SmudgeBrush;d.setHistory(c.klHistory),e.onSizeChange(d.getSize());var f=new u.Checkbox({init:d.getLockAlpha(),label:g.LANG("brush-lock-alpha"),callback:function(e){d.setLockAlpha(e)},doHighlight:!0,title:g.LANG("brush-lock-alpha-title")}),v=new o.BB.SplineInterpolator([[0,15],[8,7],[14,4],[30,3],[50,2.7],[100,2]]);!function(){t=new h.KlSlider({label:g.LANG("brush-size"),width:225,height:30,min:a.sizeSlider.min,max:a.sizeSlider.max,initValue:d.getSize(),eventResMs:l.eventResMs,onChange:function(t){r(t),e.onSizeChange(t)},curve:a.sizeSlider.curve,formatFunc:function(e){return(e*=2)<10?Math.round(10*e)/10:Math.round(e)}}),n=new h.KlSlider({label:g.LANG("opacity"),width:225,height:30,min:a.opacitySlider.min,max:a.opacitySlider.max,initValue:d.getOpacity(),eventResMs:l.eventResMs,onChange:function(t){d.setOpacity(t),e.onOpacityChange(t)},curve:a.opacitySlider.curve,formatFunc:function(e){return Math.round(100*e)}});var s=p.penPressureToggle(!1,(function(e){d.sizePressure(e)})),c=p.penPressureToggle(!1,(function(e){d.opacityPressure(e)}));i.append(o.BB.el({content:[t.getElement(),s],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),o.BB.el({content:[n.getElement(),c],css:{display:"flex",justifyContent:"space-between",alignItems:"center"}})),o.BB.el({parent:i,css:{marginTop:"10px"}}).append(f.getElement())}(),this.increaseSize=function(e){d.getIsDrawing()||t.increaseValue(e)},this.decreaseSize=function(e){d.getIsDrawing()||t.decreaseValue(e)},this.getSize=function(){return d.getSize()},this.setSize=function(e){r(e),t.setValue(e)},this.getOpacity=function(){return d.getOpacity()},this.setOpacity=function(e){d.setOpacity(e),n.setValue(e)},this.setColor=function(e){d.setColor(e)},this.setContext=function(e){d.setContext(e)},this.startLine=function(e,t,n){d.startLine(e,t,n)},this.goLine=function(e,t,n){d.goLine(e,t,n)},this.endLine=function(e,t){d.endLine()},this.getBrush=function(){return d},this.isDrawing=function(){return d.getIsDrawing()},this.getElement=function(){return i}},a)})),r.register("3QgTy",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("fp7H1")})),r.register("vCnsd",(function(n,i){t(n.exports,"chemyBrushUi",(function(){return v}));var a,o=r("eWjiX"),s=r("7NTKy"),l=r("lXqiv"),c=r("dAXbp"),u=r("gWfkn"),h=r("llzZ0"),p=r("18kre"),d=r("iskOY"),g=r("iDHln"),f=r("1mH1z"),v=(a={image:e(p),tooltip:f.LANG("brush-chemy"),sizeSlider:{min:.25,max:25,curve:o.BB.quadraticSplineInput(.25,25,.1),isDisabled:!0},opacitySlider:{min:.01,max:1},Ui:null},f.languageStrings.subscribe((function(){a.tooltip=f.LANG("brush-chemy")})),a.Ui=function(e){var t,n,r=function(e){p.setSize(e)},i=document.createElement("div"),p=new c.brushes.ChemyBrush;p.setHistory(u.klHistory),e.onSizeChange(p.getSize()),function(){t=new h.KlSlider({label:f.LANG("brush-size"),width:250,height:30,min:a.sizeSlider.min,max:a.sizeSlider.max,initValue:p.getSize(),eventResMs:s.eventResMs,isEnabled:"stroke"===p.getMode(),onChange:function(t){r(t),e.onSizeChange(p.getSize())},curve:a.sizeSlider.curve,formatFunc:function(e){return(e*=2)<5?Math.round(10*e)/10:Math.round(e)}}),n=new h.KlSlider({label:f.LANG("opacity"),width:250,height:30,min:a.opacitySlider.min,max:a.opacitySlider.max,initValue:p.getOpacity(),eventResMs:s.eventResMs,onChange:function(t){p.setOpacity(t),e.onOpacityChange(t)},formatFunc:function(e){return Math.round(100*e)}}),o.BB.css(n.getElement(),{marginTop:"10px"});var c=new l.Checkbox({init:p.getIsEraser(),label:f.LANG("eraser"),callback:function(e){p.setIsEraser(e)},css:{marginTop:"10px",marginLeft:"10px"}}),u=new l.Checkbox({init:p.getLockAlpha(),label:f.LANG("brush-lock-alpha"),callback:function(e){p.setLockAlpha(e)},doHighlight:!0,title:f.LANG("brush-lock-alpha-title"),css:{marginTop:"10px"}}),v=o.BB.el({css:{display:"flex",marginTop:"10px"}}),m=19,y=new d.Options({optionArr:[{id:"fill",label:o.BB.createSvg({elementType:"svg",width:"35",height:"35",childrenArr:[{elementType:"path",fill:"#000",style:"transform-origin: 0 0; transform: translate(-0.5px, -0.5px) scale(".concat(m,", ").concat(m,") translate(0.5px, 0.5px)"),d:"M 0,0 C 1.5,0 -0.5,1 1,1"}]}),title:f.LANG("brush-chemy-fill")},{id:"stroke",label:o.BB.createSvg({elementType:"svg",width:"35",height:"35",childrenArr:[{elementType:"path",fill:"none",stroke:"#000",style:"stroke-width: 0.12px; transform-origin: 0 0; transform: translate(-0.5px, -0.5px) scale(".concat(m,", ").concat(m,") translate(0.5px, 0.5px)"),d:"M 0,0 C 1.5,0 -0.5,1 1,1"}]}),title:f.LANG("brush-chemy-stroke")}],initId:p.getMode(),onChange:function(n){p.setMode(n),a.sizeSlider.isDisabled="fill"===p.getMode(),t.setIsEnabled(!a.sizeSlider.isDisabled),t.setValue(p.getSize()),e.onSizeChange(p.getSize()),e.onConfigChange()}}),x=new g.BoxToggle({label:o.BB.createSvg({elementType:"svg",width:"35",height:"35",childrenArr:[{elementType:"path",fill:"none",stroke:"#000",style:"stroke-width: 1px",d:"M ".concat(17.5,",").concat(8," ").concat(17.5,",").concat(27)}]}),title:f.LANG("brush-chemy-mirror-x"),init:p.getXSymmetry(),onChange:function(e){p.setXSymmetry(e)}}),b=new g.BoxToggle({label:o.BB.createSvg({elementType:"svg",width:"35",height:"35",childrenArr:[{elementType:"path",fill:"none",stroke:"#000",style:"stroke-width: 1px",d:"M ".concat(8,",").concat(17.5," ").concat(27,",").concat(17.5)}]}),title:f.LANG("brush-chemy-mirror-y"),init:p.getYSymmetry(),onChange:function(e){p.setYSymmetry(e)}}),w=new g.BoxToggle({label:o.BB.createSvg({elementType:"svg",width:"35",height:"35",childrenArr:[{elementType:"defs",childrenArr:[{elementType:"linearGradient",id:"gradient",x1:"0",y1:"0",x2:"0",y2:"1",childrenArr:[{elementType:"stop",offset:"0%","stop-color":"rgba(0,0,0,0)"},{elementType:"stop",offset:"100%","stop-color":"rgba(0,0,0,1)"}]}]},{elementType:"rect",fill:"url('#gradient')",x:"8",y:"8",width:"19",height:"19"}]}),title:f.LANG("brush-chemy-gradient"),init:p.getGradient(),onChange:function(e){p.setGradient(e)}});o.BB.css(x.getElement(),{marginLeft:"10px"});var B={marginLeft:"4px"};o.BB.css(b.getElement(),B),o.BB.css(w.getElement(),B),v.append(y.getElement(),x.getElement(),b.getElement(),w.getElement()),i.append(t.getElement(),n.getElement(),v,o.BB.el({content:[u.getElement(),c.getElement()],css:{display:"flex"}}))}(),this.increaseSize=function(e){p.getIsDrawing()||"stroke"!==p.getMode()||t.increaseValue(e)},this.decreaseSize=function(e){p.getIsDrawing()||"stroke"!==p.getMode()||t.decreaseValue(e)},this.getSize=function(){return p.getSize()},this.setSize=function(e){r(e),t.setValue(e)},this.getOpacity=function(){return p.getOpacity()},this.setOpacity=function(e){p.setOpacity(e),n.setValue(e)},this.setColor=function(e){p.setColor(e)},this.setContext=function(e){p.setContext(e)},this.startLine=function(e,t,n){p.startLine(e,t)},this.goLine=function(e,t,n,r){p.goLine(e,t)},this.endLine=function(){p.endLine()},this.getBrush=function(){return p},this.isDrawing=function(){return p.getIsDrawing()},this.getElement=function(){return i}},a)})),r.register("18kre",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("eX098")})),r.register("iDHln",(function(e,n){t(e.exports,"BoxToggle",(function(){return o}));var i=r("4gaLD"),a=r("eWjiX"),o=function(){"use strict";function e(t){var n=this;i.classCallCheck(this,e),this.value=!!t.init,this.el=a.BB.el({content:t.label,title:t.title,className:"string"==typeof t.label?"kl-box-toggle":"kl-box-toggle kl-box-toggle--custom-el",onClick:function(){n.value=!n.value,n.update(),t.onChange(n.value)},css:{cursor:"pointer"}}),"string"!=typeof t.label&&a.BB.css(t.label,{display:"block",pointerEvents:"none"}),this.update()}return i.createClass(e,[{key:"update",value:function(){this.value?a.BB.addClassName(this.el,"kl-box-toggle--active"):a.BB.removeClassName(this.el,"kl-box-toggle--active")}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(e){this.value=!!e,this.update()}},{key:"getElement",value:function(){return this.el}},{key:"destroy",value:function(){a.BB.destroyEl(this.el)}}]),e}()})),r.register("5ebUJ",(function(e,n){t(e.exports,"showIframePopup",(function(){return s}));var i=r("eWjiX"),a=r("ekHRj"),o=r("1mH1z");function s(e,t){if(t||!(window.innerHeight<500||window.innerWidth<700)){var n,r=i.BB.el({tagName:"iframe",custom:{src:e},css:{width:"100%",height:"100%"}}),s=i.BB.el({});t||(n=i.BB.el({tagName:"a",parent:s,content:o.LANG("modal-new-tab"),custom:{href:"help",target:"_blank"},onClick:function(){l.close()}}),r.onload=function(){i.BB.setAttributes(n,{href:""+r.contentWindow.location})});var l=new a.Popup({title:s,content:r,width:880,isMaxHeight:!0,onClose:function(){n&&i.BB.destroyEl(n)}})}else window.open(e)}})),r.register("bHZQg",(function(e,n){t(e.exports,"RadioList",(function(){return o}));var i=r("4gaLD"),a=r("eWjiX"),o=function(){"use strict";function e(t){var n=this;i.classCallCheck(this,e),this.inputs=[],this.el=a.BB.el({className:"kl-radio"}),t.items.forEach((function(e){var r=a.BB.el({tagName:"label"}),i=a.BB.el({tagName:"input",parent:r,custom:{name:t.name,value:e.value,type:"radio"}});t.ignoreFocus&&i.setAttribute("data-ignore-focus","true"),t.init===e.value&&(i.checked=!0),r.append(e.label),n.el.append(r),n.inputs.push(i)}))}return i.createClass(e,[{key:"getValue",value:function(){for(var e=0;e<this.inputs.length;e++)if(this.inputs[e].checked)return this.inputs[e].value;return null}},{key:"getElement",value:function(){return this.el}}]),e}()})),r.register("9pcu9",(function(n,i){t(n.exports,"BrowserStorageUi",(function(){return p}));var a=r("4gaLD"),o=r("cijLd"),s=r("eWjiX"),l=r("8yL1I"),c=r("5ebUJ"),u=r("hrnUX"),h=r("1mH1z"),p=function(){"use strict";function t(n,r,i,u){var p=this;a.classCallCheck(this,t);var d=this;this.projectStore=n,this.getProject=r,this.saveReminder=i,this.klRootEl=u,this.element=s.BB.el({css:{display:"grid",gridTemplateColumns:"1fr 0fr",gridTemplateRows:"0fr 0fr 0fr",gap:"0 0",gridTemplateAreas:'"title title" "preview store" "preview clear"'}});var g=s.BB.el({parent:this.element,content:h.LANG("file-storage"),css:{gridArea:"title",display:"flex",margin:"-5px 0"}});s.BB.el({parent:g,content:"?",title:h.LANG("file-storage-about"),css:{cursor:"pointer",marginLeft:"5px",width:"19px",height:"19px",borderRadius:"100%",textAlign:"center",lineHeight:"19px",fontWeight:"bold",boxShadow:"inset 0 0 0 1px #000"},onClick:function(){c.showIframePopup("./help/#help-browser-storage",!1)}});this.projectStore.isBroken()?s.BB.el({parent:this.element,content:"🔴 "+h.LANG("file-storage-cant-access"),css:{marginTop:"10px"}}):(this.previewEl=s.BB.el({parent:this.element,title:h.LANG("file-storage-thumb-title"),css:{gridArea:"preview",display:"flex",alignItems:"center",justifyContent:"center",marginTop:"10px",position:"relative",boxShadow:"inset 0 0 0 1px #aaa",background:"#cdcdcd",color:"#545454",colorScheme:"only light"}}),this.ageEl=s.BB.el({css:{position:"absolute",right:"0",bottom:"0",width:"100%",textAlign:"center",background:"rgba(0,0,0,0.7)",color:"#fff",textSize:"13px"}}),this.storeEl=s.BB.el({parent:this.element,tagName:"button",className:"gridButton",content:h.LANG("file-storage-store"),css:{gridArea:"store"},custom:{tabIndex:-1},onClick:function(){return p.store()}}),this.storeEl.tabIndex=-1,this.clearEl=s.BB.el({parent:this.element,tagName:"button",className:"gridButton",content:'<img src="'+e(l)+'" height="20"/> '+h.LANG("file-storage-clear"),css:{gridArea:"clear"},custom:{tabIndex:-1},onClick:function(){return p.clear()}}),this.projectStore.subscribe({onUpdate:function(e,t){p.updateThumb(e,t)}}),setInterval((function(){return p.updateAge()}),6e4),a.asyncToGenerator(e(o).mark((function t(){var n;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.projectStore.read();case 3:(n=e.sent)?d.updateThumb(n.timestamp,n.thumbnail):d.updateThumb(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),setTimeout((function(){throw new Error("storage-ui: failed initial read browser storage, "+e.t0)}),0);case 10:case"end":return e.stop()}}),t,null,[[0,7]])})))())}return a.createClass(t,[{key:"updateAge",value:function(){if(this.timestamp){var e,t=(new Date).getTime()-this.timestamp;t=Math.floor(t/1e3/60),e=h.LANG("file-storage-min-ago").replace("{x}",""+t),t>60&&(t=Math.floor(t/60),e=h.LANG("file-storage-hours-ago").replace("{x}",""+t),t>24&&(t=Math.floor(t/24),e=h.LANG("file-storage-days-ago").replace("{x}",""+t),t>31&&(e=h.LANG("file-storage-month-ago")))),this.ageEl.textContent=e}}},{key:"resetButtons",value:function(){this.timestamp?(this.storeEl.textContent=h.LANG("file-storage-overwrite"),this.storeEl.disabled=!1,this.clearEl.disabled=!1):(this.storeEl.textContent=h.LANG("file-storage-store"),this.storeEl.disabled=!1,this.clearEl.disabled=!0)}},{key:"updateThumb",value:function(e,t){this.timestamp=e,this.timestamp?(s.BB.css(t,{display:"block",maxWidth:"calc(100% - 2px)",maxHeight:"calc(100% - 2px)",margin:"0 auto",background:"url('"+s.BB.createCheckerCanvas(4).toDataURL("image/png")+"')",boxShadow:"0 0 0 1px #aaa",pointerEvents:"none"}),this.previewEl.innerHTML="",this.updateAge(),this.previewEl.append(t,this.ageEl)):this.previewEl.innerHTML=h.LANG("file-storage-empty"),this.resetButtons()}},{key:"store",value:function(){return a.asyncToGenerator(e(o).mark((function t(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.storeEl.textContent=h.LANG("file-storage-storing"),this.storeEl.disabled=!0,this.clearEl.disabled=!0,e.next=5,new Promise((function(e){setTimeout((function(){return e(null)}),20)}));case 5:return e.prev=5,e.next=8,this.projectStore.store(this.getProject());case 8:this.saveReminder.reset(),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(5),this.resetButtons(),u.KL.popup({target:this.klRootEl,type:"error",message:["".concat(h.LANG("file-storage-failed-1"),"<ul>"),"<li>".concat(h.LANG("file-storage-failed-2"),"</li>"),"<li>".concat(h.LANG("file-storage-failed-3"),"</li>"),"<li>".concat(h.LANG("file-storage-failed-4"),"</li>"),"</ul>"].join(""),buttons:["Ok"]}),setTimeout((function(){throw new Error("storage-ui: failed to store browser storage, "+e.t0)}),0);case 16:case"end":return e.stop()}}),t,this,[[5,11]])})).bind(this))()}},{key:"clear",value:function(){return a.asyncToGenerator(e(o).mark((function t(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.storeEl.disabled=!0,this.clearEl.disabled=!0,e.prev=2,e.next=5,this.projectStore.clear();case 5:e.next=12;break;case 7:e.prev=7,e.t0=e.catch(2),this.resetButtons(),u.KL.popup({target:this.klRootEl,type:"error",message:h.LANG("file-storage-failed-clear"),buttons:["Ok"]}),setTimeout((function(){throw new Error("storage-ui: failed to clear browser storage, "+e.t0)}),0);case 12:case"end":return e.stop()}}),t,this,[[2,7]])})).bind(this))()}},{key:"getElement",value:function(){return this.element}},{key:"show",value:function(){}},{key:"hide",value:function(){}}]),t}()})),r.register("6mTnI",(function(n,i){t(n.exports,"ProjectStore",(function(){return h}));var a=r("4gaLD"),o=r("cijLd"),s=r("3hwQ7"),l=r("9BlwZ"),c=r("6l0gQ");function u(e){return new Promise((function(t,n){e(t,n)}))}var h=function(){"use strict";function t(){var n=this;a.classCallCheck(this,t),this.listeners=[],this.accessHasFailed=!1,window.addEventListener("storage",(function(t){if("indexedDbUpdatedAt"===t.key&&0!==n.listeners.length)try{var r=n;a.asyncToGenerator(e(o).mark((function t(){var n;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.read();case 2:(n=e.sent)?r.emit(n.timestamp,n.thumbnail):r.emit();case 4:case"end":return e.stop()}}),t)})))()}catch(e){"db-error"===e.message&&(n.accessHasFailed=!0)}}))}return a.createClass(t,[{key:"lowLevelStore",value:function(t){return a.asyncToGenerator(e(o).mark((function n(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){l.storeKlProjectObj(t,e,n)}));case 2:case"end":return e.stop()}}),n)})))()}},{key:"lowLevelRead",value:function(){return a.asyncToGenerator(e(o).mark((function t(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(l.getKlProjectObj);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),t)})))()}},{key:"lowLevelClear",value:function(){return a.asyncToGenerator(e(o).mark((function t(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(l.clear);case 2:case"end":return e.stop()}}),t)})))()}},{key:"emit",value:function(e,t){this.listeners.forEach((function(n){n.onUpdate(e,t)}))}},{key:"updateTimestamp",value:function(){c.LocalStorage.setItem("indexedDbUpdatedAt",""+(new Date).getTime())}},{key:"read",value:function(){return a.asyncToGenerator(e(o).mark((function t(){var n,r;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,this.lowLevelRead();case 4:n=e.sent,e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(1),this.accessHasFailed=!0,new Error("db-error");case 11:if(n){e.next=13;break}return e.abrupt("return",null);case 13:return e.prev=14,e.next=17,s.ProjectConverter.readStorageProject(n);case 17:r=e.sent,e.next=23;break;case 20:throw e.prev=20,e.t1=e.catch(14),new Error("format-error");case 23:return e.abrupt("return",r);case 24:case"end":return e.stop()}}),t,this,[[1,7],[14,20]])})).bind(this))()}},{key:"store",value:function(t){var n=this;return a.asyncToGenerator(e(o).mark((function r(){var i,a,l;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=s.ProjectConverter.createStorageProject(t),e.next=4,this.lowLevelStore(i);case 4:e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),this.accessHasFailed=!0,new Error("db-error");case 10:return e.next=12,this.lowLevelRead();case 12:return a=e.sent,l=null,e.prev=14,e.next=17,s.ProjectConverter.readStorageProject(a);case 17:l=e.sent,e.next=27;break;case 20:return e.prev=20,e.t1=e.catch(14),e.next=24,this.lowLevelClear();case 24:throw this.updateTimestamp(),setTimeout((function(){return n.emit()}),0),new Error("format-error");case 27:this.updateTimestamp(),setTimeout((function(){return n.emit(l.timestamp,l.thumbnail)}),0);case 29:case"end":return e.stop()}}),r,this,[[0,6],[14,20]])})).bind(this))()}},{key:"clear",value:function(){var t=this;return a.asyncToGenerator(e(o).mark((function n(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.lowLevelClear();case 2:this.updateTimestamp(),setTimeout((function(){return t.emit()}),0);case 4:case"end":return e.stop()}}),n,this)})).bind(this))()}},{key:"subscribe",value:function(e){this.listeners.includes(e)||this.listeners.push(e)}},{key:"unsubscribe",value:function(e){for(var t=0;t<this.listeners.length;t++)if(e===this.listeners[t])return void this.listeners.splice(t,1)}},{key:"isBroken",value:function(){return this.accessHasFailed}}]),t}()})),r.register("3hwQ7",(function(n,i){t(n.exports,"ProjectConverter",(function(){return h}));var a=r("4gaLD"),o=r("cijLd"),s=r("eWjiX"),l=r("aSJRf"),c=r("2wCWz");function u(e){return new Promise((function(t,n){var r=new Image;try{r.src=s.BB.imageBlobToUrl(e)}catch(e){return void n("imageBlobToUrl, "+e.message)}r.onload=function(){URL.revokeObjectURL(r.src),t(r)},r.onabort=function(){n("layer image failed loading")},r.onerror=function(){n("layer image failed loading")}}))}var h=function(){"use strict";function t(){a.classCallCheck(this,t)}return a.createClass(t,null,[{key:"createThumbnail",value:function(e){var t=s.BB.fitInto(e.width,e.height,240,240).width/e.width;return l.drawProject(e,t)}},{key:"createStorageProject",value:function(e){return{id:1,timestamp:(new Date).getTime(),thumbnail:c.base64ToBlob(t.createThumbnail(e).toDataURL("image/png")),width:e.width,height:e.height,layers:e.layers.map((function(e){var t;if(!(e.image instanceof HTMLCanvasElement))throw new Error("Not implemented");return t=c.base64ToBlob(e.image.toDataURL("image/png")),{name:e.name,opacity:e.opacity,mixModeStr:e.mixModeStr,blob:t}}))}}},{key:"readStorageProject",value:function(n){return a.asyncToGenerator(e(o).mark((function r(){var i,a;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=n.width,e.t1=n.height,e.next=4,Promise.all(n.layers.map((function(e){return u(e.blob)})));case 4:if(e.t2=e.sent.map((function(e,t){return{name:n.layers[t].name,opacity:n.layers[t].opacity,mixModeStr:n.layers[t].mixModeStr,image:e}})),i={width:e.t0,height:e.t1,layers:e.t2},!n.thumbnail){e.next=13;break}return e.next=10,u(n.thumbnail);case 10:a=e.sent,e.next=14;break;case 13:a=t.createThumbnail(i);case 14:return e.abrupt("return",{project:i,timestamp:n.timestamp,thumbnail:a});case 15:case"end":return e.stop()}}),r)})))()}}]),t}()})),r.register("2wCWz",(function(e,n){function r(e){for(var t=e.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/),n=atob(t[3]),r=new ArrayBuffer(n.length),i=new Uint8Array(r),a=0;a<i.length;a++)i[a]=n.charCodeAt(a);return new Blob([i],{type:t[1]})}t(e.exports,"base64ToBlob",(function(){return r}))})),r.register("eK8ID",(function(n,i){t(n.exports,"FileTab",(function(){return v}));var a=r("4gaLD"),o=r("eWjiX"),s=r("hrnUX"),l=r("1gUFn"),c=r("lLh5u"),u=r("5xpQb"),h=r("4xKQD"),p=r("gswMe"),d=r("fcsnL"),g=r("9pcu9"),f=r("1mH1z"),v=function(){"use strict";function t(n,r,i,v,m,y,x,b,w,B,C,S){var k=this;a.classCallCheck(this,t),this.exportType=v;var L=this;this.div=document.createElement("div");setTimeout((function(){var t=function(){var e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div");return e.appendChild(t),e.appendChild(n),o.BB.css(t,{clear:"both"}),o.BB.css(n,{marginLeft:"10px",marginRight:"10px",marginTop:"10px",borderBottom:"1px solid rgba(0,0,0,0.2)",clear:"both"}),e},a=document.createElement("div"),A=document.createElement("button"),T=document.createElement("button"),I=document.createElement("button"),E=document.createElement("button"),M=document.createElement("button");A.style.cssFloat="left",o.BB.css(T,{cssFloat:"left",clear:"both"}),o.BB.css(M,{cssFloat:"left",clear:"both"}),A.tabIndex=-1,T.tabIndex=-1,I.tabIndex=-1,E.tabIndex=-1,M.tabIndex=-1,A.innerHTML="<img src='".concat(e(l),"' alt='icon' height='20'/>").concat(f.LANG("file-new")),T.innerHTML="<img src='".concat(e(c),"' alt='icon' height='20'/>").concat(f.LANG("file-save")),I.innerHTML="<img src='".concat(e(u),"' alt='icon' height='20'/>").concat(f.LANG("file-share")),E.innerHTML="<img style='float:left' src='".concat(e(h),"' height='20' alt='icon'/>").concat(f.LANG("file-upload")),M.innerHTML="<img src='".concat(e(d),"' alt='icon' height='20'/>").concat(f.LANG("file-copy")),M.title=f.LANG("file-copy-title"),A.className="gridButton",T.className="gridButton",I.className="gridButton",E.className="gridButton",M.className="gridButton",k.importButton=document.createElement("input"),k.importButton.tabIndex=-1,k.importButton.type="file",k.importButton.multiple=!0,k.importButton.accept="image",k.importButton.size="71",k.importButton.textContent="Import";var R,O,P=k.importButton;!function(){(P=document.createElement("div")).className="gridButton",P.style.position="relative",P.style.cursor="pointer",P.style.cssFloat="left";var t=document.createElement("div");t.style.width="120px",t.style.height="28px",t.style.overflow="hidden",t.style.cursor="pointer",t.style.position="relative",P.appendChild(t),t.appendChild(L.importButton);var n=document.createElement("button");n.innerHTML="<img style='float:left' height='20' src='"+e(p)+"' alt='icon'/>"+f.LANG("file-import"),n.tabIndex=-1,o.BB.css(n,{width:"120px",display:"box",position:"absolute",left:"0",top:"0",cursor:"pointer"}),o.BB.css(L.importButton,{display:"none"}),P.appendChild(n),n.onclick=function(){L.importButton.click()}}(),k.importButton.onchange=function(e){y(L.importButton.files,"default"),L.importButton.value=""},R=o.BB.el({css:{fontSize:"15px",marginLeft:"10px",marginTop:"10px",cssFloat:"left",width:"calc(50% - 15px)",height:"30px"}}),O=new s.KL.Select({optionArr:[["png",f.LANG("file-save-png")],["psd",f.LANG("file-save-psd")],["layers",f.LANG("file-save-layers")]],initValue:v,onChange:function(e){m(v=e),x()}}),o.BB.css(O.getElement(),{width:"120px",height:"30px"}),R.appendChild(O.getElement()),A.onclick=b,T.onclick=function(){x()},I.onclick=function(){I.disabled=!0,w((function(){I.disabled=!1}))},E.onclick=function(){B()},M.onclick=function(){M.blur(),C()};var D=document.createElement("div");D.textContent="⚠️ "+f.LANG("file-no-autosave"),o.BB.css(D,{textAlign:"center",marginTop:"10px",background:"rgb(243, 243, 161)",padding:"5px 0px",color:"rgba(0,0,0,0.65)",fontSize:"15px"}),L.fileBrowserStorage=new g.BrowserStorageUi(r,i,S,n),o.BB.css(L.fileBrowserStorage.getElement(),{margin:"10px"}),o.BB.append(a,[D,A,P,o.BB.el({css:{clear:"both"}}),T,R,o.BB.el({css:{clear:"both"}}),M,o.BB.canShareFiles()?I:null,o.BB.el({css:{clear:"both"}}),t(),L.fileBrowserStorage.getElement(),t(),E]),k.div.appendChild(a)}),1)}return a.createClass(t,[{key:"refresh",value:function(){}},{key:"getElement",value:function(){return this.div}},{key:"setIsVisible",value:function(e){e&&this.refresh()}},{key:"triggerImport",value:function(){this.importButton.click()}}]),t}()})),r.register("4xKQD",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("2oHM2")})),r.register("2umOB",(function(e,n){t(e.exports,"FilterTab",(function(){return c}));var i=r("4gaLD"),a=r("eWjiX"),o=r("hrnUX"),s=r("gWfkn"),l=r("1mH1z"),c=function(){"use strict";function e(t,n,r,a,o,s,l,c,u,h,p,d){i.classCallCheck(this,e),this.klRootEl=t,this.klColorSlider=n,this.layerManager=r,this.setCurrentLayer=a,this.klCanvasWorkspace=o,this.handUi=s,this.getCurrentColor=l,this.getKlMaxCanvasSize=c,this.getKlCanvas=u,this.getCurrentLayerCtx=h,this.isEmbed=p,this.statusOverlay=d,this.isInit=!1,this.div=document.createElement("div")}return i.createClass(e,[{key:"init",value:function(){var e=function(e,t){var n=document.createElement("button"),i=t[e].buttonLabel?t[e].buttonLabel:t[e].name,c='<img height="20" width="18" src="'+t[e].icon+'" alt="icon" />';return n.innerHTML=c+i,n.className="gridButton",a.BB.css(n,{lineHeight:"20px",fontSize:"12px"}),n.tabIndex=-1,n.onclick=function(){if("apply"in t[e])if(t[e].isInstant)n.blur(),h(null),r.statusOverlay.out('"'+t[e].name+'" '+l.LANG("filter-applied"),!0);else{var i,a=r.klColorSlider.getSecondaryRGB(),c=t[e].getDialog({context:r.getCurrentLayerCtx(),canvas:r.getKlCanvas(),maxWidth:r.getKlMaxCanvasSize(),maxHeight:r.getKlMaxCanvasSize(),currentColorRgb:{r:r.getCurrentColor().r,g:r.getCurrentColor().g,b:r.getCurrentColor().b},secondaryColorRgb:{r:a.r,g:a.g,b:a.b}});if(!c)return;c.errorCallback=function(e){setTimeout((function(){throw alert("Error: could not perform action"),e}),0),i()};var u={};"width"in c&&(u.width=c.width+"px"),o.KL.popup({target:r.klRootEl,message:"<b>"+t[e].name+"</b>",div:c.element,style:u,buttons:["Ok","Cancel"],clickOnEnter:"Ok",callback:function(n){!function(n,r){if("Cancel"!=n){var i;try{i=r.getInput()}catch(n){throw-1!==n.message.indexOf(".getInput is not a function")?"filterDialog.getInput is not a function, filter: "+t[e].name:n}h(i)}else r.destroy&&r.destroy()}(n,c)},closefunc:function(e){i=e}})}else alert("Application not fully loaded");function h(n){!1===t[e].apply({context:r.getCurrentLayerCtx(),canvas:r.getKlCanvas(),history:s.klHistory,input:n})&&alert("Couldn't apply the edit action"),!0===t[e].updateContext&&r.setCurrentLayer(r.getKlCanvas().getLayer(r.layerManager.getSelected())),!0===t[e].updatePos&&(r.klCanvasWorkspace.resetView(),r.handUi.update(r.klCanvasWorkspace.getScale(),r.klCanvasWorkspace.getAngleDeg())),r.layerManager.update()}},u[u.length]=n,n},t=function(e,t){if((t[e].webgl||t[e].ieFails)&&(!t[e].ieFails||"Microsoft Internet Explorer"===navigator.appName)){var n=t[e].buttonLabel?t[e].buttonLabel:t[e].name,r=document.createElement("button"),i='<img style="opacity: 0.5" src="img/'+t[e].icon+'" />',a=t[e].name;return a.length>11&&(a="<span style='font-size: 12px'>"+n+"</span>"),r.innerHTML=i+a,r.className="gridButton",r.disabled=!0,r}},n=function(n,a,o){for(var s in a)!a.hasOwnProperty[s]&&n.includes(s)&&(r.isEmbed&&!a[s].inEmbed||(a[s].webgl&&i||a[s].neededWithWebGL||!a[s].webgl&&!i&&(!a[s].ieFails||"Microsoft Internet Explorer"!=navigator.appName)?o.appendChild(e(s,a)):(o.appendChild(t(s,a)),a[s]=void 0)))},r=this,i=a.BB.hasWebGl(),c=o.KL.filterLib,u=[];if(a.BB.BbLog.emit({type:"init-filters"}),!o.KL.filterLibStatus.isLoaded)throw new Error("filters not loaded");var h=["cropExtend","flip","glPerspective","resize","rotate","transform"],p=[];for(var d in c)c.hasOwnProperty[d]||h.includes(d)||p.push(d);n(h,c,r.div);var g=document.createElement("div");if(g.className="gridHr",r.div.appendChild(g),n(p,c,r.div),!i){var f=a.BB.appendTextDiv(r.div,"Some actions are disabled because WebGL isn't working.");f.style.margin="10px",a.BB.css(f,{fontSize:"11px",color:"#555",background:"#ffe",padding:"10px",borderRadius:"10px",textAlign:"center"})}this.isInit=!0}},{key:"getElement",value:function(){return this.div}},{key:"show",value:function(){this.isInit||this.init(),this.div.style.display="block"}},{key:"hide",value:function(){this.div.style.display="none"}}]),e}()})),r.register("5ENro",(function(n,i){t(n.exports,"imgurUpload",(function(){return g}));var a=r("4gaLD"),o=r("cijLd"),s=r("eWjiX"),l=r("hrnUX"),c=r("j8sUl"),u=r("2wCWz"),h=r("1mH1z");function p(e,t,n,r,i){return d.apply(this,arguments)}function d(){return(d=a.asyncToGenerator(e(o).mark((function t(n,r,i,a,l){var p,d,g,f,v,m,y,x;return e(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p=u.base64ToBlob(n.toDataURL("image/"+a)),d=window.open(),g=d.document.createElement("div"),(f=d.document.createElement("img")).src=e(c),g.appendChild(f),s.BB.css(f,{filter:"invert(1)"}),d.document.body.style.backgroundColor="#121211",d.document.body.style.backgroundImage="linear-gradient(#2b2b2b 0%, #121211 50%)",d.document.body.style.backgroundRepeat="no-repeat",(v=d.document.createElement("div")).style.marginTop="10px",g.appendChild(v),v.textContent=h.LANG("upload-uploading"),d.document.body.appendChild(g),s.BB.css(g,{marginLeft:"auto",marginRight:"auto",marginTop:"100px",fontFamily:"Arial, sans-serif",fontSize:"20px",textAlign:"center",transition:"opacity 0.3s ease-in-out",opacity:"0",color:"#ccc"}),setTimeout((function(){g.style.opacity="1"}),20),t.prev=18,(y=new FormData).append("title",r),y.append("description",i),y.append("image",p),t.next=25,fetch("https://api.imgur.com/3/image",{method:"POST",headers:{Authorization:"Client-ID "+l},body:y});case 25:m=t.sent,t.next=32;break;case 28:throw t.prev=28,t.t0=t.catch(18),d.close(),new Error(t.t0);case 32:if(m.ok){t.next=35;break}throw d.close(),new Error;case 35:return t.next=37,m.json();case 37:return x=t.sent.data,d.location.href=x.link.replace(/\.(jpg|png)/,""),t.abrupt("return",x);case 40:case"end":return t.stop()}}),t,null,[[18,28]])})))).apply(this,arguments)}function g(t,n,r,i){if(!i)throw new Error("imgur key missing");var c=document.createElement("input");c.type="text",c.value=h.LANG("upload-title-untitled");var u=s.BB.el({tagName:"textarea",custom:{rows:2},css:{width:"100%",maxWidth:"100%"}}),d=document.createElement("div");d.textContent=h.LANG("upload-name")+":";var g=s.BB.el({content:h.LANG("upload-caption")+":",css:{marginTop:"10px"}}),f=document.createElement("div");f.innerHTML='<br/><a href="https://imgur.com/tos" target="_blank" rel="noopener noreferrer">'.concat(h.LANG("upload-tos"),"</a> ").concat(h.LANG("upload-tos-2"));var v=new l.KL.RadioList({name:"filetype",init:"jpeg",items:[{label:"JPG",value:"jpeg"},{label:"PNG",value:"png"}],ignoreFocus:!0});s.BB.css(v.getElement(),{marginBottom:"10px"});var m,y=document.createElement("div"),x=document.createElement("div");x.className="info-hint",x.textContent=h.LANG("upload-link-notice"),y.append(x,v.getElement(),d,c,g,u,f),l.KL.popup({target:n,message:"<b>".concat(h.LANG("upload-title"),"</b>"),type:"upload",div:y,buttons:[h.LANG("upload-submit"),"Cancel"],clickOnEnter:h.LANG("upload-submit"),primaries:[h.LANG("upload-submit")],autoFocus:h.LANG("upload-submit"),callback:(m=a.asyncToGenerator(e(o).mark((function a(s){var d;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s!==h.LANG("upload-submit")&&"Yes"!==s&&"Ok"!==s){e.next=12;break}return e.prev=1,e.next=4,p(t.getCompleteCanvas(1),c.value,u.value,v.getValue(),i);case 4:d=e.sent,l.KL.popup({target:n,type:"ok",message:"<h3>".concat(h.LANG("upload-success"),"</h3><br>").concat(h.LANG("upload-delete"),"<br><a target='_blank' rel=\"noopener noreferrer\" href='https://imgur.com/delete/").concat(d.deletehash,"'>imgur.com/<b>delete</b>/").concat(d.deletehash,"</a><br><br>"),buttons:["Ok"]}),r.reset(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),l.KL.popup({target:n,type:"error",message:h.LANG("upload-failed"),buttons:["Ok"]});case 12:case"end":return e.stop()}}),a,null,[[1,9]])}))),function(){return m.apply(this,arguments)})})}})),r.register("j8sUl",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("iGeXe")})),r.register("lkluh",(function(n,i){t(n.exports,"loadAgPsd",(function(){return c}));var a,o=r("4gaLD"),s=r("cijLd"),l=r("eWjiX");function c(){return u.apply(this,arguments)}function u(){return(u=o.asyncToGenerator(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=5;break}return e.next=3,r("bxnoy");case 3:a=e.sent,l.BB.BbLog.emit({type:"loaded-agpsd"});case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}})),r.register("bxnoy",(function(e,t){e.exports=r("ih7W4")(r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("kNYzr")).then((function(){return r("2m2jt")}))})),r.register("5ngYX",(function(e,n){t(e.exports,"SaveReminder",(function(){return l}));var i=r("4gaLD"),a=r("hrnUX"),o=r("eWjiX"),s=r("1mH1z"),l=function(){"use strict";function e(t,n,r,a,o){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"Klecks";i.classCallCheck(this,e),this.history=t,this.showReminder=n,this.changeTitle=r,this.onSaveAsPsd=a,this.isDrawing=o,this.title=s,this.lastSavedActionNumber=null}return i.createClass(e,[{key:"showPopup",value:function(){var e=this,t=Math.round((performance.now()-this.lastSavedAt)/1e3/60),n=o.BB.el({tagName:"button",className:"kl-button-primary",content:s.LANG("save-reminder-save-psd"),onClick:function(){return e.onSaveAsPsd()}});a.KL.popup({target:document.body,message:"<b>".concat(s.LANG("save-reminder-title"),"</b>"),div:o.BB.el({content:[o.BB.el({content:s.LANG("save-reminder-text",{a:"<strong>"+t,b:"</strong>"})+"<br><br>"}),n,o.BB.el({content:"<br>"+s.LANG("save-reminder-psd-layers")})]}),ignoreBackground:!0,callback:function(){o.BB.destroyEl(n),e.closeFunc=null,e.lastReminderShownAt=performance.now()},closefunc:function(t){e.closeFunc=t}}),setTimeout((function(){n.focus()}),40)}},{key:"init",value:function(){var e=this,t=function(e){e.preventDefault(),e.returnValue=""};null===this.lastSavedActionNumber&&(this.lastSavedActionNumber=this.history.getActionNumber(),this.lastReminderShownAt=performance.now(),this.lastSavedAt=performance.now(),this.showReminder&&setInterval((function(){if("visible"===document.visibilityState){var t=Math.abs(e.history.getActionNumber()-e.lastSavedActionNumber);0===a.KL.dialogCounter.get()&&!e.isDrawing()&&e.lastReminderShownAt+12e5<performance.now()&&t>=100&&e.showPopup()}}),5e3),this.history.addListener((function(){var n=e.history.getActionNumber();e.lastSavedActionNumber!==n?o.BB.setEventListener(window,"onbeforeunload",t):o.BB.setEventListener(window,"onbeforeunload",null)})),this.changeTitle&&document.addEventListener("visibilitychange",(function(){if("visible"===document.visibilityState)document.title=e.title,clearInterval(e.unsavedInterval);else{var t=e.history.getActionNumber();if(e.lastSavedActionNumber!==t){var n=e;document.title=s.LANG("unsaved")+" - "+e.title;var r=0;e.unsavedInterval=setInterval((function(){r=(r+1)%2,document.title=1===r?s.LANG("unsaved")+" · "+n.title:s.LANG("unsaved")+" - "+n.title}),18e4)}}})))}},{key:"reset",value:function(){null!==this.lastSavedActionNumber&&(this.lastSavedActionNumber=this.history.getActionNumber(),this.lastReminderShownAt=performance.now(),this.lastSavedAt=performance.now(),o.BB.setEventListener(window,"onbeforeunload",null),this.closeFunc&&this.closeFunc())}}]),e}()})),r.register("eyygR",(function(e,n){t(e.exports,"SaveToComputer",(function(){return l}));var i=r("4gaLD"),a=r("eWjiX"),o=r("hrnUX"),s=r("98ax7"),l=function(){"use strict";function e(t,n,r,a,o){i.classCallCheck(this,e),this.saveReminder=t,this.klRootEl=n,this.getExportType=r,this.getKlCanvas=a,this.filenameBase=o}return i.createClass(e,[{key:"save",value:function(e){var t=function(e,t,n){for(var r=e.toDataURL(n).match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/),i=atob(r[3]),a=new ArrayBuffer(i.length),o=new Uint8Array(a),l=0;l<o.length;l++)o[l]=i.charCodeAt(l);var c=new Blob([o],{type:r[1]});s.saveAs(c,t)},n=this;if(n.saveReminder.reset(),e||(e=n.getExportType()),"png"===e){var r="image/png",i=a.BB.getDate()+this.filenameBase+".png",l=n.getKlCanvas().getCompleteCanvas(1);try{t(l,i,r)}catch(e){var c=new Image;c.width=n.getKlCanvas().getWidth(),c.height=n.getKlCanvas().getHeight(),c.src=l.toDataURL(r),o.KL.exportDialog(n.klRootEl,c)}}else if("layers"===e)for(var u=a.BB.getDate()+this.filenameBase,h=n.getKlCanvas().getLayersFast(),p=0;p<h.length;p++){var d=h[p],g=[u,"_",(""+(p+1)).padStart(2,"0"),"_",d.name,".","png"];t(d.canvas,g.join(""),"image/png")}else if("psd"===e){for(var f=this,v=n.getKlCanvas().getLayersFast(),m={width:n.getKlCanvas().getWidth(),height:n.getKlCanvas().getHeight(),children:[],canvas:n.getKlCanvas().getCompleteCanvas(1)},y=0;y<v.length;y++){var x=v[y];m.children.push({name:x.name,opacity:x.opacity,canvas:x.canvas,blendMode:o.KL.PSD.blendKlToPsd(x.mixModeStr),left:0,top:0})}o.KL.loadAgPsd().then((function(e){var t=e.writePsdBuffer(m),n=new Blob([t],{type:"application/octet-stream"});s.saveAs(n,a.BB.getDate()+f.filenameBase+".psd")})).catch((function(){alert("Error: failed to load PSD library")}))}}}]),e}()})),r.register("98ax7",(function(e,t){var r,i;r=e.exports,i=function(){"use strict";var t=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){s(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()},r=function(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status},i=function(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}},a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(e,n,o){var s=a.URL||a.webkitURL,l=document.createElement("a");n=n||e.name||"download",l.download=n,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?i(l):r(l.href)?t(e,n,o):i(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){i(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,a){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob((s=e,void 0===(l=a)?l={autoBom:!1}:"object"!=typeof l&&(console.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\ufeff",s],{type:s.type}):s),n);else if(r(e))t(e,n,a);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout((function(){i(o)}))}var s,l}:function(e,n,r,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,r);var s="application/octet-stream"===e.type,l=/constructor/i.test(a.HTMLElement)||a.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&l||o)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},u.readAsDataURL(e)}else{var h=a.URL||a.webkitURL,p=h.createObjectURL(e);i?i.location=p:location.href=p,i=null,setTimeout((function(){h.revokeObjectURL(p)}),4e4)}});a.saveAs=s.saveAs=s,e.exports=s},"function"==typeof define&&define.amd?define([],i):void 0!==e.exports?i():(i(),r.FileSaver={})})),r.register("6rdi0",(function(e,n){t(e.exports,"UndoRedoCatchup",(function(){return s}));var i=r("4gaLD"),a=r("hrnUX"),o=r("gWfkn"),s=function(){"use strict";function e(t,n,r,a,o,s,l,c,u,h){i.classCallCheck(this,e),this.brushUiObj=t,this.layerPreview=n,this.layerManager=r,this.handUi=a,this.klCanvasWorkspace=o,this.getInitState=s,this.getKlCanvas=l,this.getCurrentLayerCtx=c,this.setCurrentLayerCtx=u,this.getCurrentBrush=h,this.doIgnore=!1}return i.createClass(e,[{key:"ignoreTest",value:function(){var e=this;return!this.doIgnore&&(this.doIgnore=!0,setTimeout((function(){e.doIgnore=!1}),0),!0)}},{key:"undo",value:function(){var e=this;if(!this.ignoreTest())return!1;if(!o.klHistory.canUndo())return!1;var t=o.klHistory.undo();o.klHistory.pause(!0);var n=this.getInitState(),r=this.getKlCanvas().getWidth(),i=this.getKlCanvas().getHeight();this.getKlCanvas().copy(n.canvas);var s=n.focus;this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(s));var l={};for(var c in a.KL.brushes)a.KL.brushes.hasOwnProperty(c)&&(l[c]=new a.KL.brushes[c],l[c].setContext(this.getCurrentLayerCtx()));l.SketchyBrush.setSeed(n.brushes.SketchyBrush.getSeed());for(var u=0;u<t.length;u++)!function(n){if("brush"===t[n].tool[0]){var r=l[t[n].tool[1]];if(t[n].actions)for(var i=0;i<t[n].actions.length;i++){var o=t[n].actions[i].params;r[t[n].actions[i].action].apply(r,o)}else{var c=t[n].params;r[t[n].action].apply(r,c)}}else if("canvas"===t[n].tool[0]){var u=t[n].params,h=e.getKlCanvas()[t[n].action].apply(e.getKlCanvas(),u);if("number"==typeof h)for(var p in s=h,e.setCurrentLayerCtx(e.getKlCanvas().getLayerContext(s)),l)l.hasOwnProperty(p)&&l[p].setContext(e.getCurrentLayerCtx())}else if("filter"===t[n].tool[0]){var d=[{context:e.getCurrentLayerCtx(),canvas:e.getKlCanvas(),input:t[n].params[0].input,history:new a.KL.DecoyKlHistory}];a.KL.filterLib[t[n].tool[1]][t[n].action].apply(null,d)}else if("misc"===t[n].tool[0]&&"focusLayer"===t[n].action)for(var g in s=t[n].params[0],e.setCurrentLayerCtx(e.getKlCanvas().getLayerContext(t[n].params[0])),l)l.hasOwnProperty(g)&&l[g].setContext(e.getCurrentLayerCtx());else if("misc"===t[n].tool[0]&&"importImage"===t[n].action){var f=e.getKlCanvas().addLayer();if("number"==typeof f)for(var v in s=f,t[n].params[1]&&e.getKlCanvas().renameLayer(s,t[n].params[1]),e.setCurrentLayerCtx(e.getKlCanvas().getLayerContext(s)),l)l.hasOwnProperty(v)&&l[v].setContext(e.getCurrentLayerCtx());e.getCurrentLayerCtx().drawImage(t[n].params[0],0,0)}}(u);return r===this.getKlCanvas().getWidth()&&i===this.getKlCanvas().getHeight()||(this.klCanvasWorkspace.resetView(),this.handUi.update(this.klCanvasWorkspace.getScale(),this.klCanvasWorkspace.getAngleDeg())),this.layerManager.update(s),this.layerPreview.setLayer(this.getKlCanvas().getLayer(s)),this.brushUiObj.sketchyBrush.setSeed(l.SketchyBrush.getSeed()),this.getCurrentBrush().setContext(this.getCurrentLayerCtx()),this.klCanvasWorkspace.setLastDrawEvent(null),o.klHistory.pause(!1),!0}},{key:"redo",value:function(){var e=this;if(!this.ignoreTest())return!1;if(!o.klHistory.canRedo())return!1;var t=o.klHistory.redo();o.klHistory.pause(!0);var n,r=this.getKlCanvas().getWidth(),i=this.getKlCanvas().getHeight(),s={};for(var l in a.KL.brushes)a.KL.brushes.hasOwnProperty(l)&&(s[l]=new a.KL.brushes[l],s[l].setContext(this.getCurrentLayerCtx()));s.SketchyBrush.setSeed(this.brushUiObj.sketchyBrush.getSeed());for(var c=0;c<t.length;c++)!function(r){if("brush"===t[r].tool[0]){var i=s[t[r].tool[1]];if(t[r].actions)for(var o=0;o<t[r].actions.length;o++){var l=t[r].actions[o].params;i[t[r].actions[o].action].apply(i,l)}else{var c=t[r].params;i[t[r].action].apply(i,c)}}else if("canvas"===t[r].tool[0]){var u=t[r].params,h=e.getKlCanvas()[t[r].action].apply(e.getKlCanvas(),u);if("number"==typeof h)for(var p in n=h,e.setCurrentLayerCtx(e.getKlCanvas().getLayerContext(n)),s)s.hasOwnProperty(p)&&s[p].setContext(e.getCurrentLayerCtx())}else if("filter"===t[r].tool[0]){var d=[{context:e.getCurrentLayerCtx(),canvas:e.getKlCanvas(),input:t[r].params[0].input,history:new a.KL.DecoyKlHistory}];a.KL.filterLib[t[r].tool[1]][t[r].action].apply(null,d)}else if("misc"===t[r].tool[0]&&"focusLayer"===t[r].action)for(var g in n=t[r].params[0],e.setCurrentLayerCtx(e.getKlCanvas().getLayerContext(t[r].params[0])),s)s.hasOwnProperty(g)&&s[g].setContext(e.getCurrentLayerCtx());else if("misc"===t[r].tool[0]&&"importImage"===t[r].action){var f=e.getKlCanvas().addLayer();if("number"==typeof f)for(var v in n=f,t[r].params[1]&&e.getKlCanvas().renameLayer(n,t[r].params[1]),e.setCurrentLayerCtx(e.getKlCanvas().getLayerContext(n)),s)s.hasOwnProperty(v)&&s[v].setContext(e.getCurrentLayerCtx());e.getCurrentLayerCtx().drawImage(t[r].params[0],0,0)}}(c);r===this.getKlCanvas().getWidth()&&i===this.getKlCanvas().getHeight()||(this.klCanvasWorkspace.resetView(),this.handUi.update(this.klCanvasWorkspace.getScale(),this.klCanvasWorkspace.getAngleDeg()));var u=this.getKlCanvas().getLayerIndex(this.getCurrentLayerCtx().canvas);return this.layerManager.update(u),this.layerPreview.setLayer(this.getKlCanvas().getLayer(u)),this.brushUiObj.sketchyBrush.setSeed(s.SketchyBrush.getSeed()),this.getCurrentBrush().setContext(this.getCurrentLayerCtx()),this.klCanvasWorkspace.setLastDrawEvent(null),o.klHistory.pause(!1),!0}},{key:"catchup",value:function(e){if(e&&e.bufferUpdate){var t=this,n=this.getInitState(),r=n.brushes,i=[e.bufferUpdate],o=n.canvas.getLayerContext(n.focus),s=n.canvas,l=n.focus;!function(e){if("brush"===i[0].tool[0]){var n=r[i[0].tool[1]];if(i[0].actions)for(var c=0;c<i[0].actions.length;c++){var u=i[0].actions[c].params;n[i[0].actions[c].action].apply(n,u)}else{var h=i[0].params;n[i[0].action].apply(n,h)}}else if("canvas"===i[0].tool[0]){var p=i[0].params,d=s[i[0].action].apply(s,p);if("number"==typeof d)for(var g in l=d,o=s.getLayerContext(l),r)r.hasOwnProperty(g)&&r[g].setContext(o)}else if("filter"===i[0].tool[0]){var f=[{context:o,canvas:s,input:i[0].params[0].input,history:new a.KL.DecoyKlHistory}];a.KL.filterLib[i[0].tool[1]][i[0].action].apply(null,f)}else if("misc"===i[0].tool[0]&&"focusLayer"===i[0].action)for(var v in l=i[0].params[0],o=s.getLayerContext(i[0].params[0]),r)r.hasOwnProperty(v)&&r[v].setContext(o);else if("misc"===i[0].tool[0]&&"importImage"===i[0].action){var m=s.addLayer();if("number"==typeof m)for(var y in l=m,i[0].params[1]&&t.getKlCanvas().renameLayer(l,i[0].params[1]),o=s.getLayerContext(l),r)r.hasOwnProperty(y)&&r[y].setContext(o);o.drawImage(i[0].params[0],0,0)}}(),n.focus=l}}}]),e}()})),r.register("7pyBK",(function(e,n){t(e.exports,"BrushSettingService",(function(){return a}));var i=r("4gaLD"),a=function(){"use strict";function e(t,n,r,a,o,s,l){if(i.classCallCheck(this,e),this.onSetColor=t,this.onSetSize=n,this.onSetOpacity=r,this.onGetColor=a,this.onGetSize=o,this.onGetOpacity=s,this.onGetSliderConfig=l,this.subscriberArr=[],e.instance)throw new Error("BrushSettingService already instantiated");e.instance=this}return i.createClass(e,[{key:"emit",value:function(e,t){for(var n=0;n<this.subscriberArr.length;n++)this.subscriberArr[n]!==t&&this.subscriberArr[n](e)}},{key:"emitColor",value:function(e,t){this.emit({type:"color",value:e},t)}},{key:"emitSize",value:function(e,t){this.emit({type:"size",value:e},t)}},{key:"emitOpacity",value:function(e,t){this.emit({type:"opacity",value:e},t)}},{key:"emitSliderConfig",value:function(e,t){this.emit({type:"sliderConfig",value:e},t)}},{key:"setColor",value:function(e,t){this.onSetColor(e),this.emitColor(e,t)}},{key:"setSize",value:function(e,t){this.onSetSize(e)}},{key:"setOpacity",value:function(e,t){this.onSetOpacity(e)}},{key:"getColor",value:function(){return this.onGetColor()}},{key:"getSize",value:function(){return this.onGetSize()}},{key:"getOpacity",value:function(){return this.onGetOpacity()}},{key:"getSliderConfig",value:function(){return this.onGetSliderConfig()}},{key:"subscribe",value:function(e){this.subscriberArr.includes(e)||this.subscriberArr.push(e)}},{key:"unsubscribe",value:function(e){for(var t=0;t<this.subscriberArr.length;t++)e===this.subscriberArr[t]&&(this.subscriberArr.splice(t,1),t--)}}]),e}()})),r.register("bIgqE",(function(n,i){t(n.exports,"SettingsTab",(function(){return f}));var a=r("4gaLD"),o=r("eWjiX"),s=r("1mH1z"),l=r("hrnUX"),c=r("fgfvl"),u=r("ekHRj"),h=r("6qSiv"),p=r("8oUiM"),d=r("7OLuX"),g=r("6l0gQ"),f=function(){"use strict";function t(n,i){a.classCallCheck(this,t);var f=function(){return o.BB.el({tagName:"a",content:s.LANG("licenses"),onClick:function(){r("eSypg").then((function(e){new u.Popup({title:o.BB.el({content:s.LANG("licenses")}),content:o.BB.el({content:o.BB.el({content:e.licenses.replace(/\n/g,"<br>"),css:{padding:"20px"}}),css:{height:"100%",overflowY:"scroll"}}),width:800,isMaxHeight:!0})}))}})},v=s.languageStrings.getLanguage();this.el=o.BB.el({content:"\n".concat(s.LANG("settings-language"),": ").concat(v.name," (").concat(v.code,")\n            "),css:{margin:"10px"}});var m=o.BB.el({content:s.LANG("settings-preferred-language")+":<br>",css:{marginTop:"10px"}}),y=[["auto",s.LANG("auto")]].concat(c.languages.map((function(e){return[e.code,e.name+" (".concat(e.code,")")]}))),x=new l.KL.Select({initValue:g.LocalStorage.getItem(s.LS_LANGUAGE_KEY)?g.LocalStorage.getItem(s.LS_LANGUAGE_KEY):"auto",optionArr:y,onChange:function(e){"auto"===e?g.LocalStorage.removeItem(s.LS_LANGUAGE_KEY):g.LocalStorage.setItem(s.LS_LANGUAGE_KEY,e),b.style.display="block"}}),b=o.BB.el({content:s.LANG("settings-language-reload"),css:{display:"none",marginTop:"5px"}});(m.append(x.getElement(),b),this.el.append(m),o.BB.el({tagName:"button",parent:this.el,content:'<img height="20" width="18" src="'+e(d)+'" alt="icon" style="margin-right: 5px"/>'+s.LANG("switch-ui-left-right"),onClick:function(){return n()},css:{marginTop:"20px"},custom:{tabIndex:"-1"}}),this.el.append(o.BB.el({className:"gridHr",css:{margin:"10px 0"}})),i)?(this.el.append(i),i.innerHTML||o.BB.el({parent:i,css:{textAlign:"center"}}).append(o.BB.el({content:'<img alt="icon" height="20" style="vertical-align:middle" src="'.concat(e(h),'"> <a href="https://bitbof.com" target="_blank" tabIndex="-1">bitbof</a> © 2022<br>')}),f())):o.BB.el({parent:this.el,css:{textAlign:"center"},content:'\n<img alt="Klecks" height="25" src="'.concat(e(p),'"><br>\n<img alt="icon" height="20" style="vertical-align:middle" src="').concat(e(h),'"> <a href="https://bitbof.com" target="_blank" tabIndex="-1">bitbof</a> © 2022<br>')}).append(f(),document.createTextNode(" | "),o.BB.el({tagName:"a",content:s.LANG("donate"),custom:{href:"https://kleki.com/donate/",target:"_blank"}}),document.createTextNode(" | "),o.BB.el({tagName:"a",content:s.LANG("source-code"),custom:{href:"https://klecks.org",target:"_blank"}}));window.addEventListener("storage",(function(e){e.key===s.LS_LANGUAGE_KEY&&x.setValue(g.LocalStorage.getItem(s.LS_LANGUAGE_KEY)?g.LocalStorage.getItem(s.LS_LANGUAGE_KEY):"auto")}))}return a.createClass(t,[{key:"getElement",value:function(){return this.el}}]),t}()})),r.register("6qSiv",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("kSWIa")})),r.register("7OLuX",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("4FMUg")})),r.register("eSypg",(function(e,t){e.exports=r("ih7W4")(r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("79hnx")).then((function(){return r("jNQF2")}))})),r.register("iVHpg",(function(e,n){t(e.exports,"ToolspaceScroller",(function(){return l}));var i=r("4gaLD"),a=r("eWjiX"),o=r("1mH1z"),s=r("i8UFO"),l=function(){"use strict";function e(t){var n=this;i.classCallCheck(this,e),this.toolspace=t.toolspace,this.upBtn=a.BB.el({parent:this.toolspace,title:o.LANG("scroll"),className:"kl-scroller",css:{top:"0",transform:"rotate(180deg)"}}),this.downBtn=a.BB.el({parent:this.toolspace,title:o.LANG("scroll"),className:"kl-scroller",css:{bottom:"0"}}),this.updateUiState(t.uiState);new a.BB.PointerListener({target:this.upBtn,onPointer:function(e){var t=n;if("pointerdown"===e.type&&(n.upInterval=setInterval((function(){t.toolspace.scrollBy(0,-13),t.update()}),20)),"pointerup"===e.type){var r=n;clearInterval(n.upInterval),setTimeout((function(){r.upInterval=null,r.update()}),50)}}}),new a.BB.PointerListener({target:this.downBtn,onPointer:function(e){var t=n;if("pointerdown"===e.type&&(n.downInterval=setInterval((function(){t.toolspace.scrollBy(0,13),t.update()}),20)),"pointerup"===e.type){var r=n;clearInterval(n.downInterval),setTimeout((function(){r.downInterval=null,r.update()}),50)}}});var r=function(e){n.toolspace.scrollBy(0,Math.round(.7*e.deltaY)),n.update()};this.upBtn.addEventListener("wheel",r),this.downBtn.addEventListener("wheel",r),this.update(),new MutationObserver((function(){return n.update()})).observe(this.toolspace,{attributes:!0,childList:!0,subtree:!0}),window.addEventListener("resize",(function(){return n.update()})),s.dialogCounter.subscribe((function(e){n.upBtn.style.opacity=e>=1?"0":"",n.downBtn.style.opacity=e>=1?"0":""}))}return i.createClass(e,[{key:"update",value:function(){this.toolspace.scrollHeight>this.toolspace.offsetHeight+3?(this.upInterval||(this.upBtn.style.display=0===this.toolspace.scrollTop?"none":"block"),this.downInterval||(this.downBtn.style.display=this.toolspace.scrollTop+this.toolspace.offsetHeight+1>=this.toolspace.scrollHeight?"none":"block")):(this.upBtn.style.display="none",this.downBtn.style.display="none")}},{key:"updateUiState",value:function(e){a.BB.css(this.upBtn,{left:"left"===e?"0":null,right:"right"===e?"0":null}),a.BB.css(this.downBtn,{left:"left"===e?"0":null,right:"right"===e?"0":null})}}]),e}()})),r.register("85H3x",(function(n,i){t(n.exports,"ToolspaceTopRow",(function(){return u}));var a=r("4gaLD"),o=r("eWjiX"),s=r("7OLuX"),l=r("kS5uZ"),c=r("1mH1z"),u=function(){"use strict";function t(n){a.classCallCheck(this,t);var r=function(e){var t=6+(e.extraPadding?e.extraPadding:0),n=o.BB.el({className:"toolspace-row-button nohighlight",title:e.title,onClick:e.onClick,css:{padding:e.content?"":e.contain?t+"px 0":""}});if(e.content)n.appendChild(e.content);else{var r=o.BB.el({css:{backgroundImage:"url('"+e.image+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:e.contain?"contain":"",height:"100%"}});r.style.pointerEvents="none",n.appendChild(r)}return n.pointerListener=new o.BB.PointerListener({target:n,onEnterLeave:function(e){e?o.BB.addClassName(n,"toolspace-row-button-hover"):o.BB.removeClassName(n,"toolspace-row-button-hover")}}),n},i=document.createElement("div");this.el=i,o.BB.css(i,{height:"36px",display:"flex",backgroundImage:"linear-gradient(to top, rgba(255, 255, 255, 0) 20%, rgba(255, 255, 255, 0.6) 100%)"});var u=r({onClick:n.onSubmit,title:c.LANG("submit-title"),content:o.BB.el({content:c.LANG("submit"),className:"toolspace-row-button__submit",css:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}}),contain:!0});u.style.width="45px";var h=r({onClick:n.onHelp,title:c.LANG("help"),image:e(l),contain:!0}),p=r({onClick:n.onLeftRight,title:c.LANG("switch-ui-left-right"),image:e(s),contain:!0});i.appendChild(u),i.appendChild(p),i.appendChild(h)}return a.createClass(t,[{key:"getElement",value:function(){return this.el}}]),t}()})),r.register("iUR3L",(function(e,n){t(e.exports,"importFilters",(function(){return b}));var i=r("kyVjY"),a=r("99EgS"),o=r("5deND"),s=r("4d8c6"),l=r("5Ta9b"),c=r("gMKRz"),u=r("7z464"),h=r("diAhN"),p=r("c1rJJ"),d=r("2elec"),g=r("gACTl"),f=r("dIv7c"),v=r("1NZ3i"),m=r("cJB4E"),y=r("gTwOE");function x(e,t){t.getDialog&&(e.getDialog=t.getDialog),e.apply=t.apply}function b(e){i.filterLibStatus.isLoaded||(e,x(i.filterLib.glBrightnessContrast,a.glBrightnessContrast),x(i.filterLib.cropExtend,o.cropExtend),x(i.filterLib.glCurves,s.glCurves),x(i.filterLib.flip,l.flip),x(i.filterLib.glHueSaturation,c.glHueSaturation),x(i.filterLib.invert,u.invert),x(i.filterLib.glPerspective,h.glPerspective),x(i.filterLib.resize,p.resize),x(i.filterLib.rotate,d.rotate),x(i.filterLib.glTiltShift,g.glTiltShift),x(i.filterLib.transform,f.transform),x(i.filterLib.glBlur,v.glBlur),x(i.filterLib.glUnsharpMask,m.glUnsharpMask),x(i.filterLib.toAlpha,y.toAlpha),i.filterLibStatus.isLoaded=!0)}})),r.register("99EgS",(function(e,n){t(e.exports,"glBrightnessContrast",(function(){return u}));var i=r("eWjiX"),a=r("llzZ0"),o=r("cH2YE"),s=r("i5nyl"),l=r("5RaQo"),c=r("1mH1z"),u={getDialog:function(e){var t=document.createElement("div"),n={element:t},r=e.context,u=e.canvas;if(!r||!u)return!1;var h=u.getLayers(),p=u.getLayerIndex(r.canvas),d=i.BB.fitInto(r.canvas.width,r.canvas.height,280,200,1),g=parseInt(""+d.width),f=parseInt(""+d.height),v=i.BB.canvas(g,f),m=v.getContext("2d");return m.save(),v.width>r.canvas.width&&(m.imageSmoothingEnabled=!1),m.drawImage(r.canvas,0,0,g,f),m.restore(),setTimeout((function(){var e=0,r=0;t.innerHTML=c.LANG("filter-bright-contrast-description")+"<br/><br/>";var u=l.getSharedFx();if(u){var d=u.texture(v);u.draw(d).update();var m=new a.KlSlider({label:c.LANG("filter-bright-contrast-brightness"),width:300,height:30,min:0,max:100,initValue:50*(e+1),eventResMs:o.eventResMs,onChange:function(t){e=t/50-1,u.draw(d).brightnessContrast(e,r).update(),B.render()}}),y=new a.KlSlider({label:c.LANG("filter-bright-contrast-contrast"),width:300,height:30,min:0,max:100,initValue:50*(r+1),eventResMs:o.eventResMs,onChange:function(t){r=t/50-1,u.draw(d).brightnessContrast(e,r).update(),B.render()}});m.getElement().style.marginBottom="10px",t.appendChild(m.getElement()),t.appendChild(y.getElement());var x=document.createElement("div");i.BB.css(x,{width:"340px",marginLeft:"-20px",height:"220px",backgroundColor:"#9e9e9e",marginTop:"10px",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",overflow:"hidden",position:"relative",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center",colorScheme:"only light"});for(var b=[],w=0;w<h.length;w++)b.push({image:w===p?u:h[w].context.canvas,opacity:h[w].opacity,mixModeStr:h[w].mixModeStr});var B=new s.KlCanvasPreview({width:parseInt(""+g),height:parseInt(""+f),layers:b}),C=i.BB.el({css:{position:"relative",boxShadow:"0 0 5px rgba(0,0,0,0.5)",width:parseInt(""+g)+"px",height:parseInt(""+f)+"px"}});C.appendChild(B.getElement()),x.appendChild(C),t.appendChild(x);try{u.draw(d).brightnessContrast(e,r).update(),B.render()}catch(e){t.errorCallback(e)}n.destroy=function(){m.destroy(),y.destroy(),d.destroy()},n.getInput=function(){return n.destroy(),{brightness:e,contrast:r}}}}),1),n},apply:function(e){var t=e.context,n=e.input.brightness,r=e.input.contrast,i=e.history;if(!t||null===n||null===r||!i)return!1;i.pause(!0);var a=l.getSharedFx();if(!a)return!1;var o=a.texture(t.canvas);return a.draw(o).brightnessContrast(n,r).update(),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(a,0,0),o.destroy(),i.pause(!1),i.push({tool:["filter","glBrightnessContrast"],action:"apply",params:[{input:e.input}]}),!0}}})),r.register("cH2YE",(function(e,n){t(e.exports,"eventResMs",(function(){return r}));var r=60})),r.register("5RaQo",(function(e,n){t(e.exports,"getSharedFx",(function(){return o}));var i=r("TEtAx"),a=null;try{a=i.fx.canvas()}catch(e){}function o(){if(!a||a._.gl.isContextLost())try{a=i.fx.canvas()}catch(e){}return a}})),r.register("TEtAx",(function(e,n){t(e.exports,"fx",(function(){return r}));var r=function(){var e,t=function(e,t,n){return Math.max(e,Math.min(t,n))},n=function(t){return{_:t,loadContentsOf:function(t){e=this._.gl,this._.loadContentsOf(t)},destroy:function(){e=this._.gl,this._.destroy()}}},r=function(e){return n(Q.fromElement(e))},i=function(t,n){var r=e.UNSIGNED_BYTE;if(e.getExtension("OES_texture_float")&&e.getExtension("OES_texture_float_linear")){var i=new Q(100,100,e.RGBA,e.FLOAT);try{i.drawTo((function(){r=e.FLOAT}))}catch(e){}i.destroy()}this._.texture&&this._.texture.destroy(),this._.spareTexture&&this._.spareTexture.destroy(),this.width=t,this.height=n,this._.texture=new Q(t,n,e.RGBA,r),this._.spareTexture=new Q(t,n,e.RGBA,r),this._.extraTexture=this._.extraTexture||new Q(0,0,e.RGBA,r),this._.flippedShader=this._.flippedShader||new _(null,"\r\n        uniform sampler2D texture;\r\n        varying vec2 texCoord;\r\n        void main() {\r\n            gl_FragColor = texture2D(texture, vec2(texCoord.x, 1.0 - texCoord.y));\r\n        }\r\n    ","flippedShader"),this._.isInitialized=!0},a=function(e,t,n){return this._.isInitialized&&e._.width==this.width&&e._.height==this.height||i.call(this,t||e._.width,n||e._.height),e._.use(),this._.texture.drawTo((function(){_.getDefaultShader().drawRect()})),this},o=function(){return this._.texture.use(),this._.flippedShader.drawRect(),this},s=function(e,t,n,r){(n||this._.texture).use(),this._.spareTexture.drawTo((function(){e.uniforms(t).drawRect()})),this._.spareTexture.swapWith(r||this._.texture)},l=function(e){return e.parentNode.insertBefore(this,e),e.parentNode.removeChild(e),this},c=function(){var t=new Q(this._.texture.width,this._.texture.height,e.RGBA,e.UNSIGNED_BYTE);return this._.texture.use(),t.drawTo((function(){_.getDefaultShader().drawRect()})),n(t)},u=function(){var t=this._.texture.width,n=this._.texture.height,r=new Uint8Array(t*n*4);return this._.texture.drawTo((function(){e.readPixels(0,0,t,n,e.RGBA,e.UNSIGNED_BYTE,r)})),r},h=function(t){return function(){return e=this._.gl,t.apply(this,arguments)}},p=function(e,t,n,r,i,a,o,s){var l=n-i,c=r-a,u=o-i,h=s-a,p=e-n+i-o,d=t-r+a-s,g=l*h-u*c,f=(p*h-u*d)/g,v=(l*d-p*c)/g;return[n-e+f*n,r-t+f*r,f,o-e+v*o,s-t+v*s,v,e,t,1]},d=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=t*a*c-t*o*l-n*i*c+n*o*s+r*i*l-r*a*s;return[(a*c-o*l)/u,(r*l-n*c)/u,(n*o-r*a)/u,(o*s-i*c)/u,(t*c-r*s)/u,(r*i-t*o)/u,(i*l-a*s)/u,(n*s-t*l)/u,(t*a-n*i)/u]},g=function(e){var t=e.length;this.xa=[],this.ya=[],this.u=[],this.y2=[],e.sort((function(e,t){return e[0]-t[0]}));for(var n=0;n<t;n++)this.xa.push(e[n][0]),this.ya.push(e[n][1]);this.u[0]=0,this.y2[0]=0;for(n=1;n<t-1;++n){var r=this.xa[n+1]-this.xa[n-1],i=(this.xa[n]-this.xa[n-1])/r,a=i*this.y2[n-1]+2;this.y2[n]=(i-1)/a;var o=(this.ya[n+1]-this.ya[n])/(this.xa[n+1]-this.xa[n])-(this.ya[n]-this.ya[n-1])/(this.xa[n]-this.xa[n-1]);this.u[n]=(6*o/r-i*this.u[n-1])/a}this.y2[t-1]=0;for(n=t-2;n>=0;--n)this.y2[n]=this.y2[n]*this.y2[n+1]+this.u[n]},f=function(e,t){return new _(null,e+"\r\n    uniform sampler2D texture;\r\n    uniform vec2 texSize;\r\n    varying vec2 texCoord;\r\n    void main() {\r\n        vec2 coord = texCoord * texSize;\r\n        "+t+"\r\n        gl_FragColor = texture2D(texture, coord / texSize);\r\n        vec2 clampedCoord = clamp(coord, vec2(0.0), texSize);\r\n        if (coord != clampedCoord) {\r\n            /* fade to transparent if we are outside the image */\r\n            gl_FragColor.a *= max(0.0, 1.0 - length(coord - clampedCoord));\r\n        }\r\n    }","warp")},v=function(n,r){return e.brightnessContrast=e.brightnessContrast||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform float brightness;\r\n        uniform float contrast;\r\n        varying vec2 texCoord;\r\n        void main() {\r\n            vec4 color = texture2D(texture, texCoord);\r\n            color.rgb += brightness;\r\n            if (contrast > 0.0) {\r\n                color.rgb = (color.rgb - 0.5) / (1.0 - contrast) + 0.5;\r\n            } else {\r\n                color.rgb = (color.rgb - 0.5) * (1.0 + contrast) + 0.5;\r\n            }\r\n            gl_FragColor = color;\r\n        }\r\n    ","brightnessContrast"),s.call(this,e.brightnessContrast,{brightness:t(-1,n,1),contrast:t(-1,r,1)}),this},m=function(e){for(var n=new g(e),r=[],i=0;i<256;i++)r.push(t(0,Math.floor(256*n.interpolate(i/255)),255));return r},y=function(t,n,r){t=m(t),1==arguments.length?n=r=t:(n=m(n),r=m(r));for(var i=[],a=0;a<256;a++)i.splice(i.length,0,t[a],n[a],r[a],255);return this._.extraTexture.initFromBytes(256,1,i),this._.extraTexture.use(1),e.curves=e.curves||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform sampler2D map;\r\n        varying vec2 texCoord;\r\n        void main() {\r\n            vec4 color = texture2D(texture, texCoord);\r\n            color.r = texture2D(map, vec2(color.r)).r;\r\n            color.g = texture2D(map, vec2(color.g)).g;\r\n            color.b = texture2D(map, vec2(color.b)).b;\r\n            gl_FragColor = color;\r\n        }\r\n    ","curves"),e.curves.textures({map:1}),s.call(this,e.curves,{}),this},x=function(t){e.denoise=e.denoise||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform float exponent;\r\n        uniform float strength;\r\n        uniform vec2 texSize;\r\n        varying vec2 texCoord;\r\n        void main() {\r\n            vec4 center = texture2D(texture, texCoord);\r\n            vec4 color = vec4(0.0);\r\n            float total = 0.0;\r\n            for (float x = -4.0; x <= 4.0; x += 1.0) {\r\n                for (float y = -4.0; y <= 4.0; y += 1.0) {\r\n                    vec4 sample = texture2D(texture, texCoord + vec2(x, y) / texSize);\r\n                    float weight = 1.0 - abs(dot(sample.rgb - center.rgb, vec3(0.25)));\r\n                    weight = pow(weight, exponent);\r\n                    color += sample * weight;\r\n                    total += weight;\r\n                }\r\n            }\r\n            gl_FragColor = color / total;\r\n        }\r\n    ","denoise");for(var n=0;n<2;n++)s.call(this,e.denoise,{exponent:Math.max(0,t),texSize:[this.width,this.height]});return this},b=function(n,r){return e.hueSaturation=e.hueSaturation||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform float hue;\r\n        uniform float saturation;\r\n        varying vec2 texCoord;\r\n        void main() {\r\n            vec4 color = texture2D(texture, texCoord);\r\n            \r\n            /* hue adjustment, wolfram alpha: RotationTransform[angle, {1, 1, 1}][{x, y, z}] */\r\n            float angle = hue * 3.14159265;\r\n            float s = sin(angle), c = cos(angle);\r\n            vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;\r\n            float len = length(color.rgb);\r\n            color.rgb = vec3(\r\n                dot(color.rgb, weights.xyz),\r\n                dot(color.rgb, weights.zxy),\r\n                dot(color.rgb, weights.yzx)\r\n            );\r\n            \r\n            /* saturation adjustment */\r\n            float average = (color.r + color.g + color.b) / 3.0;\r\n            if (saturation > 0.0) {\r\n                color.rgb += (average - color.rgb) * (1.0 - 1.0 / (1.001 - saturation));\r\n            } else {\r\n                color.rgb += (average - color.rgb) * (-saturation);\r\n            }\r\n            \r\n            gl_FragColor = color;\r\n        }\r\n    ","hueSaturation"),s.call(this,e.hueSaturation,{hue:t(-1,n,1),saturation:t(-1,r,1)}),this},w=function(n){return e.noise=e.noise||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform float amount;\r\n        varying vec2 texCoord;\r\n        float rand(vec2 co) {\r\n            return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\r\n        }\r\n        void main() {\r\n            vec4 color = texture2D(texture, texCoord);\r\n            \r\n            float diff = (rand(texCoord) - 0.5) * amount;\r\n            color.r += diff;\r\n            color.g += diff;\r\n            color.b += diff;\r\n            \r\n            gl_FragColor = color;\r\n        }\r\n    ","noise"),s.call(this,e.noise,{amount:t(0,n,1)}),this},B=function(n){return e.sepia=e.sepia||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform float amount;\r\n        varying vec2 texCoord;\r\n        void main() {\r\n            vec4 color = texture2D(texture, texCoord);\r\n            float r = color.r;\r\n            float g = color.g;\r\n            float b = color.b;\r\n            \r\n            color.r = min(1.0, (r * (1.0 - (0.607 * amount))) + (g * (0.769 * amount)) + (b * (0.189 * amount)));\r\n            color.g = min(1.0, (r * 0.349 * amount) + (g * (1.0 - (0.314 * amount))) + (b * 0.168 * amount));\r\n            color.b = min(1.0, (r * 0.272 * amount) + (g * 0.534 * amount) + (b * (1.0 - (0.869 * amount))));\r\n            \r\n            gl_FragColor = color;\r\n        }\r\n    ","sepia"),s.call(this,e.sepia,{amount:t(0,n,1)}),this},C=function(t,n){return e.unsharpMask=e.unsharpMask||new _(null,"\r\n        uniform sampler2D blurredTexture;\r\n        uniform sampler2D originalTexture;\r\n        uniform float strength;\r\n        uniform float threshold;\r\n        varying vec2 texCoord;\r\n        void main() {\r\n            vec4 blurred = texture2D(blurredTexture, texCoord);\r\n            vec4 original = texture2D(originalTexture, texCoord);\r\n            gl_FragColor = mix(blurred, original, 1.0 + strength);\r\n        }\r\n    ","unsharpMask"),this._.extraTexture.ensureFormat(this._.texture),this._.texture.use(),this._.extraTexture.drawTo((function(){_.getDefaultShader().drawRect()})),this._.extraTexture.use(1),this.triangleBlur(t),e.unsharpMask.textures({originalTexture:1}),s.call(this,e.unsharpMask,{strength:n}),this._.extraTexture.unuse(1),this},S=function(n){return e.vibrance=e.vibrance||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform float amount;\r\n        varying vec2 texCoord;\r\n        void main() {\r\n            vec4 color = texture2D(texture, texCoord);\r\n            float average = (color.r + color.g + color.b) / 3.0;\r\n            float mx = max(color.r, max(color.g, color.b));\r\n            float amt = (mx - average) * (-amount * 3.0);\r\n            color.rgb = mix(color.rgb, vec3(mx), amt);\r\n            gl_FragColor = color;\r\n        }\r\n    ","vibrance"),s.call(this,e.vibrance,{amount:t(-1,n,1)}),this},k=function(n,r){return e.vignette=e.vignette||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform float size;\r\n        uniform float amount;\r\n        varying vec2 texCoord;\r\n        void main() {\r\n            vec4 color = texture2D(texture, texCoord);\r\n            \r\n            float dist = distance(texCoord, vec2(0.5, 0.5));\r\n            color.rgb *= smoothstep(0.8, size * 0.799, dist * (amount + size));\r\n            \r\n            gl_FragColor = color;\r\n        }\r\n    ","vignette"),s.call(this,e.vignette,{size:t(0,n,1),amount:t(0,r,1)}),this},L=function(n,r,i){e.lensBlurPrePass=e.lensBlurPrePass||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform float power;\r\n        varying vec2 texCoord;\r\n        void main() {\r\n            vec4 color = texture2D(texture, texCoord);\r\n            color = pow(color, vec4(power));\r\n            gl_FragColor = vec4(color);\r\n        }\r\n    ","lensBlurPrePass");var a="\r\n        uniform sampler2D texture0;\r\n        uniform sampler2D texture1;\r\n        uniform vec2 delta0;\r\n        uniform vec2 delta1;\r\n        uniform float power;\r\n        varying vec2 texCoord;\r\n        "+q+"\r\n        vec4 sample(vec2 delta) {\r\n            /* randomize the lookup values to hide the fixed number of samples */\r\n            float offset = random(vec3(delta, 151.7182), 0.0);\r\n            \r\n            vec4 color = vec4(0.0);\r\n            float total = 0.0;\r\n            for (float t = 0.0; t <= 30.0; t++) {\r\n                float percent = (t + offset) / 30.0;\r\n                color += texture2D(texture0, texCoord + delta * percent);\r\n                total += 1.0;\r\n            }\r\n            return color / total;\r\n        }\r\n    ";e.lensBlur0=e.lensBlur0||new _(null,a+"\r\n        void main() {\r\n            gl_FragColor = sample(delta0);\r\n        }\r\n    ","lensBlur0"),e.lensBlur1=e.lensBlur1||new _(null,a+"\r\n        void main() {\r\n            gl_FragColor = (sample(delta0) + sample(delta1)) * 0.5;\r\n        }\r\n    ","lensBlur1"),e.lensBlur2=e.lensBlur2||new _(null,a+"\r\n        void main() {\r\n            vec4 color = (sample(delta0) + 2.0 * texture2D(texture1, texCoord)) / 3.0;\r\n            gl_FragColor = pow(color, vec4(power));\r\n        }\r\n    ","lensBlur2").textures({texture1:1});for(var o=[],l=0;l<3;l++){var c=i+l*Math.PI*2/3;o.push([n*Math.sin(c)/this.width,n*Math.cos(c)/this.height])}var u=Math.pow(10,t(-1,r,1));return s.call(this,e.lensBlurPrePass,{power:u}),this._.extraTexture.ensureFormat(this._.texture),s.call(this,e.lensBlur0,{delta0:o[0]},this._.texture,this._.extraTexture),s.call(this,e.lensBlur1,{delta0:o[1],delta1:o[2]},this._.extraTexture,this._.extraTexture),s.call(this,e.lensBlur0,{delta0:o[1]}),this._.extraTexture.use(1),s.call(this,e.lensBlur2,{power:1/u,delta0:o[2]}),this},A=function(t,n,r,i,a,o){e.tiltShift=e.tiltShift||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform float blurRadius;\r\n        uniform float gradientRadius;\r\n        uniform vec2 start;\r\n        uniform vec2 end;\r\n        uniform vec2 delta;\r\n        uniform vec2 texSize;\r\n        varying vec2 texCoord;\r\n        "+q+"\r\n        void main() {\r\n            vec4 color = vec4(0.0);\r\n            float total = 0.0;\r\n            \r\n            /* randomize the lookup values to hide the fixed number of samples */\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\r\n            \r\n            vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\r\n            float radius = smoothstep(0.0, 1.0, abs(dot(texCoord * texSize - start, normal)) / gradientRadius) * blurRadius;\r\n            for (float t = -30.0; t <= 30.0; t++) {\r\n                float percent = (t + offset - 0.5) / 30.0;\r\n                float weight = 1.0 - abs(percent);\r\n                vec4 sample = texture2D(texture, texCoord + delta / texSize * percent * radius);\r\n                \r\n                /* switch to pre-multiplied alpha to correctly blur transparent images */\r\n                sample.rgb *= sample.a;\r\n                \r\n                color += sample * weight;\r\n                total += weight;\r\n            }\r\n            \r\n            gl_FragColor = color / total;\r\n            \r\n            /* switch back from pre-multiplied alpha */\r\n            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\r\n        }\r\n    ","tiltShift");var l=r-t,c=i-n,u=Math.sqrt(l*l+c*c);return s.call(this,e.tiltShift,{blurRadius:a,gradientRadius:o,start:[t,n],end:[r,i],delta:[l/u,c/u],texSize:[this.width,this.height]}),s.call(this,e.tiltShift,{blurRadius:a,gradientRadius:o,start:[t,n],end:[r,i],delta:[-c/u,l/u],texSize:[this.width,this.height]}),this},T=function(t){return e.triangleBlur=e.triangleBlur||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform vec2 delta;\r\n        varying vec2 texCoord;\r\n        "+q+"\r\n        void main() {\r\n            vec4 color = vec4(0.0);\r\n            float total = 0.0;\r\n            \r\n            /* randomize the lookup values to hide the fixed number of samples */\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\r\n            \r\n            for (float t = -30.0; t <= 30.0; t++) {\r\n                float percent = (t + offset - 0.5) / 30.0;\r\n                float weight = 1.0 - abs(percent);\r\n                vec4 sample = texture2D(texture, texCoord + delta * percent);\r\n                \r\n                /* switch to pre-multiplied alpha to correctly blur transparent images */\r\n                sample.rgb *= sample.a;\r\n                \r\n                color += sample * weight;\r\n                total += weight;\r\n            }\r\n            \r\n            gl_FragColor = color / total;\r\n            \r\n            /* switch back from pre-multiplied alpha */\r\n            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\r\n        }\r\n    ","triangleBlur"),s.call(this,e.triangleBlur,{delta:[t/this.width,0]}),s.call(this,e.triangleBlur,{delta:[0,t/this.height]}),this},I=function(t,n,r){return e.zoomBlur=e.zoomBlur||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform vec2 center;\r\n        uniform float strength;\r\n        uniform vec2 texSize;\r\n        varying vec2 texCoord;\r\n        "+q+"\r\n        void main() {\r\n            vec4 color = vec4(0.0);\r\n            float total = 0.0;\r\n            vec2 toCenter = center - texCoord * texSize;\r\n            \r\n            /* randomize the lookup values to hide the fixed number of samples */\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\r\n            \r\n            for (float t = 0.0; t <= 40.0; t++) {\r\n                float percent = (t + offset) / 40.0;\r\n                float weight = 4.0 * (percent - percent * percent);\r\n                vec4 sample = texture2D(texture, texCoord + toCenter * percent * strength / texSize);\r\n                \r\n                /* switch to pre-multiplied alpha to correctly blur transparent images */\r\n                sample.rgb *= sample.a;\r\n                \r\n                color += sample * weight;\r\n                total += weight;\r\n            }\r\n            \r\n            gl_FragColor = color / total;\r\n            \r\n            /* switch back from pre-multiplied alpha */\r\n            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\r\n        }\r\n    ","zoomBlur"),s.call(this,e.zoomBlur,{center:[t,n],strength:r,texSize:[this.width,this.height]}),this},E=function(t,n,r,i){return e.colorHalftone=e.colorHalftone||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform vec2 center;\r\n        uniform float angle;\r\n        uniform float scale;\r\n        uniform vec2 texSize;\r\n        varying vec2 texCoord;\r\n        \r\n        float pattern(float angle) {\r\n            float s = sin(angle), c = cos(angle);\r\n            vec2 tex = texCoord * texSize - center;\r\n            vec2 point = vec2(\r\n                c * tex.x - s * tex.y,\r\n                s * tex.x + c * tex.y\r\n            ) * scale;\r\n            return (sin(point.x) * sin(point.y)) * 4.0;\r\n        }\r\n        \r\n        void main() {\r\n            vec4 color = texture2D(texture, texCoord);\r\n            vec3 cmy = 1.0 - color.rgb;\r\n            float k = min(cmy.x, min(cmy.y, cmy.z));\r\n            cmy = (cmy - k) / (1.0 - k);\r\n            cmy = clamp(cmy * 10.0 - 3.0 + vec3(pattern(angle + 0.26179), pattern(angle + 1.30899), pattern(angle)), 0.0, 1.0);\r\n            k = clamp(k * 10.0 - 5.0 + pattern(angle + 0.78539), 0.0, 1.0);\r\n            gl_FragColor = vec4(1.0 - cmy - k, color.a);\r\n        }\r\n    ","colorHalftone"),s.call(this,e.colorHalftone,{center:[t,n],angle:r,scale:Math.PI/i,texSize:[this.width,this.height]}),this},M=function(t,n,r,i){return e.dotScreen=e.dotScreen||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform vec2 center;\r\n        uniform float angle;\r\n        uniform float scale;\r\n        uniform vec2 texSize;\r\n        varying vec2 texCoord;\r\n        \r\n        float pattern() {\r\n            float s = sin(angle), c = cos(angle);\r\n            vec2 tex = texCoord * texSize - center;\r\n            vec2 point = vec2(\r\n                c * tex.x - s * tex.y,\r\n                s * tex.x + c * tex.y\r\n            ) * scale;\r\n            return (sin(point.x) * sin(point.y)) * 4.0;\r\n        }\r\n        \r\n        void main() {\r\n            vec4 color = texture2D(texture, texCoord);\r\n            float average = (color.r + color.g + color.b) / 3.0;\r\n            gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\r\n        }\r\n    ","dotScreen"),s.call(this,e.dotScreen,{center:[t,n],angle:r,scale:Math.PI/i,texSize:[this.width,this.height]}),this},R=function(t){return e.edgeWork1=e.edgeWork1||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform vec2 delta;\r\n        varying vec2 texCoord;\r\n        "+q+"\r\n        void main() {\r\n            vec2 color = vec2(0.0);\r\n            vec2 total = vec2(0.0);\r\n            \r\n            /* randomize the lookup values to hide the fixed number of samples */\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\r\n            \r\n            for (float t = -30.0; t <= 30.0; t++) {\r\n                float percent = (t + offset - 0.5) / 30.0;\r\n                float weight = 1.0 - abs(percent);\r\n                vec3 sample = texture2D(texture, texCoord + delta * percent).rgb;\r\n                float average = (sample.r + sample.g + sample.b) / 3.0;\r\n                color.x += average * weight;\r\n                total.x += weight;\r\n                if (abs(t) < 15.0) {\r\n                    weight = weight * 2.0 - 1.0;\r\n                    color.y += average * weight;\r\n                    total.y += weight;\r\n                }\r\n            }\r\n            gl_FragColor = vec4(color / total, 0.0, 1.0);\r\n        }\r\n    ","edgeWork1"),e.edgeWork2=e.edgeWork2||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform vec2 delta;\r\n        varying vec2 texCoord;\r\n        "+q+"\r\n        void main() {\r\n            vec2 color = vec2(0.0);\r\n            vec2 total = vec2(0.0);\r\n            \r\n            /* randomize the lookup values to hide the fixed number of samples */\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\r\n            \r\n            for (float t = -30.0; t <= 30.0; t++) {\r\n                float percent = (t + offset - 0.5) / 30.0;\r\n                float weight = 1.0 - abs(percent);\r\n                vec2 sample = texture2D(texture, texCoord + delta * percent).xy;\r\n                color.x += sample.x * weight;\r\n                total.x += weight;\r\n                if (abs(t) < 15.0) {\r\n                    weight = weight * 2.0 - 1.0;\r\n                    color.y += sample.y * weight;\r\n                    total.y += weight;\r\n                }\r\n            }\r\n            float c = clamp(10000.0 * (color.y / total.y - color.x / total.x) + 0.5, 0.0, 1.0);\r\n            gl_FragColor = vec4(c, c, c, 1.0);\r\n        }\r\n    ","edgeWork2"),s.call(this,e.edgeWork1,{delta:[t/this.width,0]}),s.call(this,e.edgeWork2,{delta:[0,t/this.height]}),this},O=function(t,n,r){return e.hexagonalPixelate=e.hexagonalPixelate||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform vec2 center;\r\n        uniform float scale;\r\n        uniform vec2 texSize;\r\n        varying vec2 texCoord;\r\n        void main() {\r\n            vec2 tex = (texCoord * texSize - center) / scale;\r\n            tex.y /= 0.866025404;\r\n            tex.x -= tex.y * 0.5;\r\n            \r\n            vec2 a;\r\n            if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) a = vec2(floor(tex.x), floor(tex.y));\r\n            else a = vec2(ceil(tex.x), ceil(tex.y));\r\n            vec2 b = vec2(ceil(tex.x), floor(tex.y));\r\n            vec2 c = vec2(floor(tex.x), ceil(tex.y));\r\n            \r\n            vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\r\n            vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\r\n            vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\r\n            vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\r\n            \r\n            float alen = length(TEX - A);\r\n            float blen = length(TEX - B);\r\n            float clen = length(TEX - C);\r\n            \r\n            vec2 choice;\r\n            if (alen < blen) {\r\n                if (alen < clen) choice = a;\r\n                else choice = c;\r\n            } else {\r\n                if (blen < clen) choice = b;\r\n                else choice = c;\r\n            }\r\n            \r\n            choice.x += choice.y * 0.5;\r\n            choice.y *= 0.866025404;\r\n            choice *= scale / texSize;\r\n            gl_FragColor = texture2D(texture, choice + center / texSize);\r\n        }\r\n    ","hexagonalPixelate"),s.call(this,e.hexagonalPixelate,{center:[t,n],scale:r,texSize:[this.width,this.height]}),this},P=function(t){return e.ink=e.ink||new _(null,"\r\n        uniform sampler2D texture;\r\n        uniform float strength;\r\n        uniform vec2 texSize;\r\n        varying vec2 texCoord;\r\n        void main() {\r\n            vec2 dx = vec2(1.0 / texSize.x, 0.0);\r\n            vec2 dy = vec2(0.0, 1.0 / texSize.y);\r\n            vec4 color = texture2D(texture, texCoord);\r\n            float bigTotal = 0.0;\r\n            float smallTotal = 0.0;\r\n            vec3 bigAverage = vec3(0.0);\r\n            vec3 smallAverage = vec3(0.0);\r\n            for (float x = -2.0; x <= 2.0; x += 1.0) {\r\n                for (float y = -2.0; y <= 2.0; y += 1.0) {\r\n                    vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\r\n                    bigAverage += sample;\r\n                    bigTotal += 1.0;\r\n                    if (abs(x) + abs(y) < 2.0) {\r\n                        smallAverage += sample;\r\n                        smallTotal += 1.0;\r\n                    }\r\n                }\r\n            }\r\n            vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\r\n            gl_FragColor = vec4(color.rgb - dot(edge, edge) * strength * 100000.0, color.a);\r\n        }\r\n    ","ink"),s.call(this,e.ink,{strength:t*t*t*t*t,texSize:[this.width,this.height]}),this},D=function(n,r,i,a){return e.bulgePinch=e.bulgePinch||f("\r\n        uniform float radius;\r\n        uniform float strength;\r\n        uniform vec2 center;\r\n    ","\r\n        coord -= center;\r\n        float distance = length(coord);\r\n        if (distance < radius) {\r\n            float percent = distance / radius;\r\n            if (strength > 0.0) {\r\n                coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\r\n            } else {\r\n                coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\r\n            }\r\n        }\r\n        coord += center;\r\n    "),s.call(this,e.bulgePinch,{radius:i,strength:t(-1,a,1),center:[n,r],texSize:[this.width,this.height]}),this},G=function(t,n,r){if(e.matrixWarp=e.matrixWarp||f("\r\n        uniform mat3 matrix;\r\n        uniform bool useTextureSpace;\r\n    ","\r\n        if (useTextureSpace) coord = coord / texSize * 2.0 - 1.0;\r\n        vec3 warp = matrix * vec3(coord, 1.0);\r\n        coord = warp.xy / warp.z;\r\n        if (useTextureSpace) coord = (coord * 0.5 + 0.5) * texSize;\r\n    "),4==(t=Array.prototype.concat.apply([],t)).length)t=[t[0],t[1],0,t[2],t[3],0,0,0,1];else if(9!=t.length)throw"can only warp with 2x2 or 3x3 matrix";return s.call(this,e.matrixWarp,{matrix:n?d(t):t,texSize:[this.width,this.height],useTextureSpace:0|r}),this},N=function(e,t){var n=p.apply(null,t),r=p.apply(null,e),i=function(e,t){return[e[0]*t[0]+e[1]*t[3]+e[2]*t[6],e[0]*t[1]+e[1]*t[4]+e[2]*t[7],e[0]*t[2]+e[1]*t[5]+e[2]*t[8],e[3]*t[0]+e[4]*t[3]+e[5]*t[6],e[3]*t[1]+e[4]*t[4]+e[5]*t[7],e[3]*t[2]+e[4]*t[5]+e[5]*t[8],e[6]*t[0]+e[7]*t[3]+e[8]*t[6],e[6]*t[1]+e[7]*t[4]+e[8]*t[7],e[6]*t[2]+e[7]*t[5]+e[8]*t[8]]}(d(n),r);return this.matrixWarp(i)},j=function(t,n,r,i){return e.swirl=e.swirl||f("\r\n        uniform float radius;\r\n        uniform float angle;\r\n        uniform vec2 center;\r\n    ","\r\n        coord -= center;\r\n        float distance = length(coord);\r\n        if (distance < radius) {\r\n            float percent = (radius - distance) / radius;\r\n            float theta = percent * percent * angle;\r\n            float s = sin(theta);\r\n            float c = cos(theta);\r\n            coord = vec2(\r\n                coord.x * c - coord.y * s,\r\n                coord.x * s + coord.y * c\r\n            );\r\n        }\r\n        coord += center;\r\n    "),s.call(this,e.swirl,{radius:r,center:[t,n],angle:i,texSize:[this.width,this.height]}),this},z=function(){return e.invert=e.invert||new _(null,"\r\n    uniform sampler2D texture;\r\n    uniform vec2 texSize;\r\n    varying vec2 texCoord;\r\n    \r\n    void main() {\r\n        vec4 color = texture2D(texture, texCoord);\r\n        gl_FragColor = vec4(1.0 - color.r, 1.0 - color.g, 1.0 - color.b, color.a);\r\n    }\r\n","invert"),s.call(this,e.invert,{texSize:[this.width,this.height]}),this},H=function(t,n){return e.toAlpha=e.toAlpha||new _(null,"\r\n    uniform bool isInverted;\r\n    uniform vec4 replace;\r\n    uniform sampler2D texture;\r\n    uniform vec2 texSize;\r\n    varying vec2 texCoord;\r\n    \r\n    void main() {\r\n        vec4 color = texture2D(texture, texCoord);\r\n        float alpha = (color.r + color.g + color.b) / 3.0;\r\n        if (isInverted) alpha = 1.0 - alpha;\r\n        alpha = min(color.a, alpha);\r\n        if (replace.a > 0.0) color = replace;\r\n        gl_FragColor = vec4(color.r, color.g, color.b, alpha);\r\n    }\r\n","toAlpha"),s.call(this,e.toAlpha,{isInverted:t?1:0,replace:n?[n.r/255,n.g/255,n.b/255,n.a]:[0,0,0,0],texSize:[this.width,this.height]}),this},U={};!function(){var t,n,r=function(){};try{document.createElement("canvas").getContext("experimental-webgl")}catch(e){}e&&-1===e.getSupportedExtensions().indexOf("OES_texture_float_linear")&&(function(e){if(!e.getExtension("OES_texture_float"))return!1;var t=e.createFramebuffer(),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,2,2,0,e.RGBA,e.FLOAT,new Float32Array([2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]));var i=e.createProgram(),a=e.createShader(e.VERTEX_SHADER),o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(a,"\r\n      attribute vec2 vertex;\r\n      void main() {\r\n        gl_Position = vec4(vertex, 0.0, 1.0);\r\n      }\r\n    "),e.shaderSource(o,"\r\n      uniform sampler2D texture;\r\n      void main() {\r\n        gl_FragColor = texture2D(texture, vec2(0.5));\r\n      }\r\n    "),e.compileShader(a),e.compileShader(o),e.attachShader(i,a),e.attachShader(i,o),e.linkProgram(i);var s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0]),e.STREAM_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0);var l=new Uint8Array(4);return e.useProgram(i),e.viewport(0,0,1,1),e.bindTexture(e.TEXTURE_2D,r),e.drawArrays(e.POINTS,0,1),e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,l),127===l[0]||128===l[0]}(e)&&(t=WebGLRenderingContext.prototype.getExtension,n=WebGLRenderingContext.prototype.getSupportedExtensions,WebGLRenderingContext.prototype.getExtension=function(e){return"OES_texture_float_linear"===e?(void 0===(n=this).$OES_texture_float_linear$&&Object.defineProperty(n,"$OES_texture_float_linear$",{enumerable:!1,configurable:!1,writable:!1,value:new r}),n.$OES_texture_float_linear$):t.call(this,e);var n},WebGLRenderingContext.prototype.getSupportedExtensions=function(){var e=n.call(this);return-1===e.indexOf("OES_texture_float_linear")&&e.push("OES_texture_float_linear"),e}))}(),U.canvas=function(){var t=document.createElement("canvas");try{e=t.getContext("experimental-webgl",{premultipliedAlpha:!1})}catch(t){e=null}if(!e)throw"This browser does not support WebGL";return t._={gl:e,isInitialized:!1,texture:null,spareTexture:null,flippedShader:null},t.texture=h(r),t.draw=h(a),t.update=h(o),t.replace=h(l),t.contents=h(c),t.getPixelArray=h(u),t.brightnessContrast=h(v),t.hexagonalPixelate=h(O),t.hueSaturation=h(b),t.colorHalftone=h(E),t.triangleBlur=h(T),t.unsharpMask=h(C),t.perspective=h(N),t.matrixWarp=h(G),t.bulgePinch=h(D),t.tiltShift=h(A),t.dotScreen=h(M),t.edgeWork=h(R),t.lensBlur=h(L),t.zoomBlur=h(I),t.noise=h(w),t.denoise=h(x),t.curves=h(y),t.swirl=h(j),t.ink=h(P),t.vignette=h(k),t.vibrance=h(S),t.sepia=h(B),t.invert=h(z),t.toAlpha=h(H),t},U.splineInterpolate=m;var X,F,W,K,V,Y,J,_=(X=function(e){return"[object Number]"==Object.prototype.toString.call(e)},F=function(t,n,r){var i=e.createShader(t);if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw"compile error: "+r+" - "+e.getShaderInfoLog(i);return i},W=function(t){var n=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,t);return null!==n&&0!==n.precision},K=function(t,n,r){if(this.vertexAttribute=null,this.texCoordAttribute=null,this.program=e.createProgram(),t=t||V,n=n||Y,null===J&&(J=W(e.HIGH_FLOAT)?"highp":W(e.MEDIUM_FLOAT)?"mediump":"lowp"),n="precision "+J+" float;"+n,e.attachShader(this.program,F(e.VERTEX_SHADER,t,r+"(vertex)")),e.attachShader(this.program,F(e.FRAGMENT_SHADER,n,r+"(fragment)")),e.linkProgram(this.program),!e.getProgramParameter(this.program,e.LINK_STATUS))throw"link error: "+e.getProgramInfoLog(this.program)},V="\r\n    attribute vec2 vertex;\r\n    attribute vec2 _texCoord;\r\n    varying vec2 texCoord;\r\n    void main() {\r\n        texCoord = _texCoord;\r\n        gl_Position = vec4(vertex * 2.0 - 1.0, 0.0, 1.0);\r\n    }",Y="\r\n    uniform sampler2D texture;\r\n    varying vec2 texCoord;\r\n    void main() {\r\n        gl_FragColor = texture2D(texture, texCoord);\r\n    }",J=null,K.prototype.destroy=function(){e.deleteProgram(this.program),this.program=null},K.prototype.uniforms=function(t){for(var n in e.useProgram(this.program),t)if(t.hasOwnProperty(n)){var r=e.getUniformLocation(this.program,n);if(null!==r){var i=t[n];if(a=i,"[object Array]"==Object.prototype.toString.call(a))switch(i.length){case 1:e.uniform1fv(r,new Float32Array(i));break;case 2:e.uniform2fv(r,new Float32Array(i));break;case 3:e.uniform3fv(r,new Float32Array(i));break;case 4:e.uniform4fv(r,new Float32Array(i));break;case 9:e.uniformMatrix3fv(r,!1,new Float32Array(i));break;case 16:e.uniformMatrix4fv(r,!1,new Float32Array(i));break;default:throw"dont't know how to load uniform \""+n+'" of length '+i.length}else{if(!X(i))throw'attempted to set uniform "'+n+'" to invalid value '+(i||"undefined").toString();e.uniform1f(r,i)}}}var a;return this},K.prototype.textures=function(t){for(var n in e.useProgram(this.program),t)t.hasOwnProperty(n)&&e.uniform1i(e.getUniformLocation(this.program,n),t[n]);return this},K.prototype.drawRect=function(t,n,r,i){var a,o=e.getParameter(e.VIEWPORT);n=n!==a?(n-o[1])/o[3]:0,t=t!==a?(t-o[0])/o[2]:0,r=r!==a?(r-o[0])/o[2]:1,i=i!==a?(i-o[1])/o[3]:1,null==e.vertexBuffer&&(e.vertexBuffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,e.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([t,n,t,i,r,n,r,i]),e.STATIC_DRAW),null==e.texCoordBuffer&&(e.texCoordBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,e.texCoordBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),e.STATIC_DRAW)),null==this.vertexAttribute&&(this.vertexAttribute=e.getAttribLocation(this.program,"vertex"),e.enableVertexAttribArray(this.vertexAttribute)),null==this.texCoordAttribute&&(this.texCoordAttribute=e.getAttribLocation(this.program,"_texCoord"),e.enableVertexAttribArray(this.texCoordAttribute)),e.useProgram(this.program),e.bindBuffer(e.ARRAY_BUFFER,e.vertexBuffer),e.vertexAttribPointer(this.vertexAttribute,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,e.texCoordBuffer),e.vertexAttribPointer(this.texCoordAttribute,2,e.FLOAT,!1,0,0),e.drawArrays(e.TRIANGLE_STRIP,0,4)},K.getDefaultShader=function(){return e.defaultShader=e.defaultShader||new K,e.defaultShader},K);g.prototype.interpolate=function(e){for(var t=0,n=this.ya.length-1;n-t>1;){var r=n+t>>1;this.xa[r]>e?n=r:t=r}var i=this.xa[n]-this.xa[t],a=(this.xa[n]-e)/i,o=(e-this.xa[t])/i;return a*this.ya[t]+o*this.ya[n]+((a*a*a-a)*this.y2[t]+(o*o*o-o)*this.y2[n])*(i*i)/6};var Q=function(){var t=function(t,n,r,i){this.gl=e,this.id=e.createTexture(),this.width=t,this.height=n,this.format=r,this.type=i,e.bindTexture(e.TEXTURE_2D,this.id),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t&&n&&e.texImage2D(e.TEXTURE_2D,0,this.format,t,n,0,this.format,this.type,null)},n=function(e){null==r&&(r=document.createElement("canvas")),r.width=e.width,r.height=e.height;var t=r.getContext("2d");return t.clearRect(0,0,r.width,r.height),t};t.fromElement=function(n){var r=new t(0,0,e.RGBA,e.UNSIGNED_BYTE);return r.loadContentsOf(n),r},t.prototype.loadContentsOf=function(t){this.width=t.width||t.videoWidth,this.height=t.height||t.videoHeight,e.bindTexture(e.TEXTURE_2D,this.id),e.texImage2D(e.TEXTURE_2D,0,this.format,this.format,this.type,t)},t.prototype.initFromBytes=function(t,n,r){this.width=t,this.height=n,this.format=e.RGBA,this.type=e.UNSIGNED_BYTE,e.bindTexture(e.TEXTURE_2D,this.id),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,n,0,e.RGBA,this.type,new Uint8Array(r))},t.prototype.destroy=function(){e.deleteTexture(this.id),this.id=null},t.prototype.use=function(t){e.activeTexture(e.TEXTURE0+(t||0)),e.bindTexture(e.TEXTURE_2D,this.id)},t.prototype.unuse=function(t){e.activeTexture(e.TEXTURE0+(t||0)),e.bindTexture(e.TEXTURE_2D,null)},t.prototype.ensureFormat=function(t,n,r,i){if(1==arguments.length){var a=arguments[0];t=a.width,n=a.height,r=a.format,i=a.type}t==this.width&&n==this.height&&r==this.format&&i==this.type||(this.width=t,this.height=n,this.format=r,this.type=i,e.bindTexture(e.TEXTURE_2D,this.id),e.texImage2D(e.TEXTURE_2D,0,this.format,t,n,0,this.format,this.type,null))},t.prototype.drawTo=function(t){if(e.framebuffer=e.framebuffer||e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,e.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.id,0),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE)throw new Error("incomplete framebuffer");e.viewport(0,0,this.width,this.height),t(),e.bindFramebuffer(e.FRAMEBUFFER,null)};var r=null;return t.prototype.fillUsingCanvas=function(t){return t(n(this)),this.format=e.RGBA,this.type=e.UNSIGNED_BYTE,e.bindTexture(e.TEXTURE_2D,this.id),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),this},t.prototype.toImage=function(t){this.use(),_.getDefaultShader().drawRect();var i=this.width*this.height*4,a=new Uint8Array(i),o=n(this),s=o.createImageData(this.width,this.height);e.readPixels(0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,a);for(var l=0;l<i;l++)s.data[l]=a[l];o.putImageData(s,0,0),t.src=r.toDataURL()},t.prototype.swapWith=function(e){var t;t=e.id,e.id=this.id,this.id=t,t=e.width,e.width=this.width,this.width=t,t=e.height,e.height=this.height,this.height=t,t=e.format,e.format=this.format,this.format=t},t}(),q="\r\n    float random(vec3 scale, float seed) {\r\n        /* use the fragment position for a different seed per-pixel */\r\n        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\r\n    }\r\n";return U}()})),r.register("5deND",(function(e,n){t(e.exports,"cropExtend",(function(){return u}));var i=r("eWjiX"),a=r("c4LUw"),o=r("lXqiv"),s=r("9A7OD"),l=r("32CBv"),c=r("1mH1z"),u={getDialog:function(e){var t=function(){y=parseInt(E.value),x=parseInt(M.value),b=parseInt(R.value),w=parseInt(O.value);var e=r.getWidth()+y+x,t=r.getHeight()+b+w;e<=0&&(B&&(y=-r.getWidth()-x+1,E.value=""+y),C&&(x=-r.getWidth()-y+1,M.value=""+x),e=1),e>L&&(B&&(y=-r.getWidth()-x+L,E.value=""+y),C&&(x=-r.getWidth()-y+L,M.value=""+x),e=L),t<=0&&(S&&(b=-r.getHeight()-w+1,R.value=""+b),k&&(w=-r.getHeight()-b+1,O.value=""+w),t=1),t>A&&(S&&(b=-r.getHeight()-w+A,R.value=""+b),k&&(w=-r.getHeight()-b+A,O.value=""+w),t=A),W.setTransform({x:-y,y:-b,width:e,height:t}),B=!1,C=!1,S=!1,k=!1},n=function(e){var t=i.BB.fitInto(e.width,e.height,260,180,1);m=t.width/e.width;var n=i.BB.centerWithin(340,220,t.width,t.height);u.style.width=r.getWidth()*m+"px",u.style.height=r.getHeight()*m+"px",F.style.left=n.x-e.x*m+"px",F.style.top=n.y-e.y*m+"px",y=parseInt(""+-e.x),b=parseInt(""+-e.y),x=parseInt(""+(e.x+e.width-r.getWidth())),w=parseInt(""+(e.y+e.height-r.getHeight())),E.value=""+y,R.value=""+b,M.value=""+x,O.value=""+w,i.BB.createCheckerDataUrl(parseInt(""+50*m),(function(e){U.style.background="url("+e+")",0!==N.a&&(u.style.background="url("+e+")")})),U.style.backgroundPosition=n.x+"px "+n.y+"px",W.setScale(m)},r=e.canvas;if(!r)return!1;var u=i.BB.canvas(),h=i.BB.fitInto(r.getWidth(),r.getHeight(),560,400,1),p=parseInt(""+h.width),d=parseInt(""+h.height),g=p/r.getWidth();u.width=p,u.height=d,u.style.display="block",u.getContext("2d").drawImage(r.getCompleteCanvas(g),0,0,p,d);var f=document.createElement("div"),v={element:f};f.innerHTML=c.LANG("filter-crop-description")+"<br/><br/>";var m,y=0,x=0,b=0,w=0,B=!1,C=!1,S=!1,k=!1,L=e.maxWidth,A=e.maxHeight,T=i.BB.el({css:{lineHeight:"30px",height:"35px"}}),I=i.BB.el({css:{lineHeight:"30px",height:"35px"}});f.appendChild(T),f.appendChild(I);var E=a.input({init:0,type:"number",min:-r.getWidth(),max:L,css:{width:"75px",marginRight:"20px"},callback:function(e){B=!0,t()}}),M=a.input({init:0,type:"number",min:-r.getWidth(),max:L,css:{width:"75px"},callback:function(e){C=!0,t()}}),R=a.input({init:0,type:"number",min:-r.getHeight(),max:A,css:{width:"75px",marginRight:"20px"},callback:function(e){S=!0,t()}}),O=a.input({init:0,type:"number",min:-r.getHeight(),max:A,css:{width:"75px"},callback:function(e){k=!0,t()}}),P={display:"inline-block",width:"60px"};T.append(i.BB.el({content:c.LANG("filter-crop-left")+":",css:P}),E,i.BB.el({content:c.LANG("filter-crop-right")+":",css:P}),M),I.append(i.BB.el({content:c.LANG("filter-crop-top")+":",css:P}),R,i.BB.el({content:c.LANG("filter-crop-bottom")+":",css:P}),O);var D=!0,G=new o.Checkbox({init:!0,label:c.LANG("filter-crop-rule-thirds"),allowTab:!0,callback:function(e){D=e,W.showThirds(D)}});f.appendChild(i.BB.el({css:{clear:"both"}}));var N={r:0,g:0,b:0,a:0},j=[{r:0,g:0,b:0,a:0},{r:255,g:255,b:255,a:1},{r:0,g:0,b:0,a:1}];j.push({r:e.currentColorRgb.r,g:e.currentColorRgb.g,b:e.currentColorRgb.b,a:1}),j.push({r:e.secondaryColorRgb.r,g:e.secondaryColorRgb.g,b:e.secondaryColorRgb.b,a:1});var z=new s.ColorOptions({label:c.LANG("filter-crop-fill"),colorArr:j,onChange:function(e){N=e,function(e){var t;0===e.a?(t="rgba(0,0,0,0.5)",X.style.background="",u.style.background=""):(t=e.r+e.g+e.b<382.5?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.5)",X.style.background=i.BB.ColorConverter.toRgbStr(e),i.BB.createCheckerDataUrl(parseInt(""+50*m),(function(e){u.style.background="url("+e+")"}))),u.style.boxShadow="0 0 3px 1px "+t}(e)}}),H=i.BB.el({css:{display:"flex",justifyContent:"space-between"}});f.appendChild(H),H.appendChild(G.getElement()),H.appendChild(z.getElement());var U=i.BB.el({css:{width:"340px",marginTop:"10px",marginLeft:"-20px",height:"220px",backgroundColor:"#9e9e9e",position:"relative",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",overflow:"hidden",userSelect:"none",colorScheme:"only light",touchAction:"none"}});U.oncontextmenu=function(){return!1};var X=i.BB.el({css:{position:"absolute",left:"0",top:"0",bottom:"0",right:"0"}});U.appendChild(X);var F=document.createElement("div");F.style.position="absolute",F.style.left="0px",F.style.top="0px",U.appendChild(F),i.BB.appendTextDiv(F,"").appendChild(u),u.style.boxShadow="0 0 3px 1px rgba(0,0,0,0.5)",u.style.position="absolute",u.style.left="0px",u.style.top="0px",f.appendChild(U);var W=new l.Cropper({x:0,y:0,width:r.getWidth(),height:r.getHeight(),scale:m,callback:n,maxW:L,maxH:A});return n(W.getTransform()),F.appendChild(W.getElement()),v.destroy=function(){W.destroy(),G.destroy()},v.getInput=function(){return v.destroy(),{left:y,right:x,top:b,bottom:w,fillColor:0===N.a?null:N}},v},apply:function(e){var t=e.canvas,n=e.history;return!(!t||!n||isNaN(e.input.left)||isNaN(e.input.right)||isNaN(e.input.top)||isNaN(e.input.bottom))&&(n.pause(!0),t.resizeCanvas(e.input),n.pause(!1),n.push({tool:["filter","cropExtend"],action:"apply",params:[{input:JSON.parse(JSON.stringify(e.input))}]}),!0)}}})),r.register("4d8c6",(function(e,n){t(e.exports,"glCurves",(function(){return c}));var i=r("eWjiX"),a=r("iskOY"),o=r("i5nyl"),s=r("5RaQo"),l=r("1mH1z"),c={getDialog:function(e){var t=e.context,n=e.canvas;if(!t||!n)return!1;var r=n.getLayers(),c=n.getLayerIndex(t.canvas),u=i.BB.fitInto(t.canvas.width,t.canvas.height,280,200,1),h=parseInt(""+u.width),p=parseInt(""+u.height),d=i.BB.canvas(h,p),g=d.getContext("2d");g.save(),d.width>t.canvas.width&&(g.imageSmoothingEnabled=!1),g.drawImage(t.canvas,0,0,h,p),g.restore();var f,v=document.createElement("div"),m={element:v};return setTimeout((function(){t.canvas.width;v.innerHTML=l.LANG("filter-curves-description")+"<br/><br/>";var e={r:[[0,0],[1/3,1/3],[2/3,2/3],[1,1]],g:[[0,0],[1/3,1/3],[2/3,2/3],[1,1]],b:[[0,0],[1/3,1/3],[2/3,2/3],[1,1]]},n=s.getSharedFx();if(n){var u,g=n.texture(d);n.draw(g).update();var y=new function(e){var t=document.createElement("div");t.oncontextmenu=function(){return!1},t.style.position="relative",t.style.marginBottom="10px";var n="All",r=e.curves;u=new a.Options({optionArr:[{id:"All",label:l.LANG("filter-curves-all")},{id:"Red",label:l.LANG("red")},{id:"Green",label:l.LANG("green")},{id:"Blue",label:l.LANG("blue")}],initialId:"All",onChange:function(e){"All"===(n=e)&&(r={r:[[0,0],[1/3,1/3],[2/3,2/3],[1,1]],g:[[0,0],[1/3,1/3],[2/3,2/3],[1,1]],b:[[0,0],[1/3,1/3],[2/3,2/3],[1,1]]});var t=r.r;"Green"===n&&(t=r.g),"Blue"===n&&(t=r.b),v.setPos(0,c-t[0][1]*c),m.setPos(t[1][0]*s,c-t[1][1]*c),y.setPos(t[2][0]*s,c-t[2][1]*c),x.setPos(s,c-t[3][1]*c),b()}}),t.appendChild(u.getElement());var o=document.createElement("div");i.BB.css(o,{position:"relative",marginTop:"10px",colorScheme:"only light"}),t.appendChild(o);var s=300,c=100,h=i.BB.canvas(s,c);i.BB.css(h,{background:"#c6c6c6",boxShadow:"0 0 0 1px rgba(0,0,0,0.3)"});var p=h.getContext("2d");function d(e){return Math.max(0,Math.min(1,e))}function g(e,t,n,r){var a=t,l=e,u=document.createElement("div");return i.BB.css(u,{position:"absolute",left:e-7+"px",top:t-7+"px",width:"14px",height:"14px",background:"#fff",cursor:"move",borderRadius:"14px",boxShadow:"inset 0 0 0 2px #000",userSelect:"none",touchAction:"none"}),u.pointerListener=new i.BB.PointerListener({target:u,maxPointers:1,onPointer:function(o){o.eventPreventDefault(),"pointerdown"===o.type&&(l=e,a=t),"left"===o.button&&"pointermove"===o.type&&(r||(l+=o.dX),e=Math.max(0,Math.min(s,l)),a+=o.dY,t=Math.max(0,Math.min(c,a)),i.BB.css(u,{left:e-7+"px",top:t-7+"px"}),n({x:e,y:t}))}}),o.appendChild(u),u.setPos=function(n,r){a=t=r,l=e=n,i.BB.css(u,{left:e-7+"px",top:t-7+"px"})},u}function f(e,t,i){"All"===n&&(r.r[e]=[d(t/s),d(1-i/c)],r.g[e]=[d(t/s),d(1-i/c)],r.b[e]=[d(t/s),d(1-i/c)]),"Red"===n&&(r.r[e]=[d(t/s),d(1-i/c)]),"Green"===n&&(r.g[e]=[d(t/s),d(1-i/c)]),"Blue"===n&&(r.b[e]=[d(t/s),d(1-i/c)])}o.appendChild(h);var v=g(0,c,(function(e){f(0,e.x,e.y),b()}),!0),m=g(s/3,c/3*2,(function(e){f(1,e.x,e.y),b()})),y=g(s/3*2,c/3,(function(e){f(2,e.x,e.y),b()})),x=g(s,0,(function(e){f(3,e.x,e.y),b()}),!0);function b(){h.width=h.width,p=h.getContext("2d");for(var t={r:[],g:[],b:[]},a=0;a<r.r.length;a++)t.r.push(r.r[a]),t.g.push(r.g[a]),t.b.push(r.b[a]);function o(e){p.beginPath();for(var t=new i.BB.SplineInterpolator(e),n=0;n<100;n++){var r=t.interpolate(n/100);r=Math.max(0,Math.min(1,r)),0===n?p.moveTo(n/100*s,c-r*c):p.lineTo(n/100*s,c-r*c)}p.stroke()}p.save(),"All"===n?(p.strokeStyle="black",o(t.r)):(p.globalAlpha=.5,p.strokeStyle="red",o(t.r),p.strokeStyle="green",o(t.g),p.strokeStyle="blue",o(t.b)),p.restore(),e.callback(t)}b(),this.getDiv=function(){return t},this.destroy=function(){v.pointerListener.destroy(),m.pointerListener.destroy(),y.pointerListener.destroy(),x.pointerListener.destroy()}}({curves:e,callback:function(t){e=t,function(){try{n.draw(g).curves(e.r,e.g,e.b).update(),f&&f.render()}catch(e){v.errorCallback(e)}}()}});v.appendChild(y.getDiv());var x=document.createElement("div");i.BB.css(x,{width:"340px",marginLeft:"-20px",height:"220px",backgroundColor:"#9e9e9e",marginTop:"10px",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",overflow:"hidden",position:"relative",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center",colorScheme:"only light"});for(var b=[],w=0;w<r.length;w++)b.push({image:w===c?n:r[w].context.canvas,opacity:r[w].opacity,mixModeStr:r[w].mixModeStr});f=new o.KlCanvasPreview({width:parseInt(""+h),height:parseInt(""+p),layers:b});var B=i.BB.el({css:{position:"relative",boxShadow:"0 0 5px rgba(0,0,0,0.5)",width:parseInt(""+h)+"px",height:parseInt(""+p)+"px"}});B.appendChild(f.getElement()),x.appendChild(B),v.appendChild(x),m.destroy=function(){y.destroy(),g.destroy(),u.destroy()},m.getInput=function(){return m.destroy(),{curves:e}}}}),1),m},apply:function(e){var t=e.context,n=e.input.curves,r=e.history;if(!t||null===n||!r)return!1;r.pause(!0);var i=s.getSharedFx();if(!i)return!1;var a=i.texture(t.canvas);return i.draw(a).curves(n.r,n.g,n.b).update(),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(i,0,0),a.destroy(),r.pause(!1),r.push({tool:["filter","glCurves"],action:"apply",params:[{input:e.input}]}),!0}}})),r.register("5Ta9b",(function(n,i){t(n.exports,"flip",(function(){return u}));var a=r("eWjiX"),o=r("lXqiv"),s=r("i5nyl"),l=r("1RI49"),c=r("1mH1z"),u={getDialog:function(t){var n=function(){var e=L.image.getContext("2d");e.save(),e.clearRect(0,0,L.image.width,L.image.height),x&&(m&&(e.translate(L.image.width,0),e.scale(-1,1)),y&&(e.translate(0,L.image.height),e.scale(1,-1)));for(var t=0;t<u.length;t++)e.save(),x||h!==t||(m&&(e.translate(L.image.width,0),e.scale(-1,1)),y&&(e.translate(0,L.image.height),e.scale(1,-1))),e.canvas.width>u[t].context.canvas.width&&(e.imageSmoothingEnabled=!1),e.globalAlpha=u[t].opacity,e.globalCompositeOperation=u[t].mixModeStr,e.drawImage(u[t].context.canvas,0,0,L.image.width,L.image.height),e.restore();A.render(),e.restore()},r=t.context,i=t.canvas;if(!r||!i)return!1;var u=i.getLayers(),h=i.getLayerIndex(r.canvas),p=a.BB.fitInto(r.canvas.width,r.canvas.height,280,200,1),d=parseInt(""+p.width),g=parseInt(""+p.height),f=document.createElement("div"),v={element:f},m=!0,y=!1,x=!0;f.innerHTML=c.LANG("filter-flip-description")+"<br/><br/>";var b=new o.Checkbox({init:m,label:c.LANG("filter-flip-horizontal")+" ⟷",allowTab:!0,callback:function(e){m=e,n()},css:{marginBottom:"10px"}}),w=new o.Checkbox({init:y,label:c.LANG("filter-flip-vertical")+" ↕",allowTab:!0,callback:function(e){y=e,n()},css:{marginBottom:"10px"}});f.appendChild(b.getElement()),f.appendChild(w.getElement());var B=document.createElement("div");a.BB.setEventListener(B,"onpointerdown",(function(){return!1})),B.textContent=c.LANG("filter-flip-image"),B.style.width="150px",B.style.height="30px",B.style.paddingTop="10px",B.style.textAlign="center",B.style.cssFloat="left",B.style.paddingBottom="0px",B.style.borderTopLeftRadius="10px",B.style.boxShadow="inset 0px 5px 10px rgba(0,0,0,0.5)",B.style.background="url("+e(l)+") no-repeat 12px 16px",B.style.backgroundSize="8%",B.style.backgroundColor="#9e9e9e";var C=document.createElement("div");a.BB.setEventListener(C,"onpointerdown",(function(){return!1})),C.textContent=c.LANG("filter-flip-layer"),C.style.width="150px",C.style.height="30px",C.style.paddingTop="10px",C.style.textAlign="center",C.style.cssFloat="left",C.style.paddingBottom="0px",C.style.borderTopRightRadius="10px",C.style.cursor="pointer",C.style.backgroundColor="rgba(0, 0, 0, 0.1)",C.style.backgroundSize="8%",a.BB.setEventListener(B,"onpointerover",(function(){!1===x&&(B.style.backgroundColor="#ccc")})),a.BB.setEventListener(B,"onpointerout",(function(){!1===x&&(B.style.backgroundColor="rgba(0, 0, 0, 0.1)")})),a.BB.setEventListener(C,"onpointerover",(function(){!0===x&&(C.style.backgroundColor="#ccc")})),a.BB.setEventListener(C,"onpointerout",(function(){!0===x&&(C.style.backgroundColor="rgba(0, 0, 0, 0.1)")})),B.onclick=function(){x=!0,C.style.background="",C.style.backgroundColor="rgba(0, 0, 0, 0.1)",C.style.boxShadow="",C.style.cursor="pointer",B.style.background="url("+e(l)+") no-repeat 12px 16px",B.style.backgroundSize="8%",B.style.backgroundColor="#9e9e9e",B.style.cursor="default",B.style.boxShadow="inset 0px 5px 10px rgba(0,0,0,0.5)",n()},C.onclick=function(){x=!1,B.style.background="",B.style.backgroundColor="rgba(0, 0, 0, 0.1)",B.style.boxShadow="",B.style.cursor="pointer",C.style.background="url("+e(l)+") no-repeat 12px 16px",C.style.backgroundSize="8%",C.style.backgroundColor="#9e9e9e",C.style.cursor="default",C.style.boxShadow="inset 0px 5px 10px rgba(0,0,0,0.5)",n()};var S=document.createElement("div");S.appendChild(B),S.appendChild(C),f.appendChild(S);var k=document.createElement("div");a.BB.css(k,{width:"340px",marginLeft:"-20px",height:"220px",backgroundColor:"#9e9e9e",marginTop:"10px",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",overflow:"hidden",position:"relative",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center",colorScheme:"only light"});var L={image:a.BB.canvas(Math.round(d),Math.round(g)),opacity:1,mixModeStr:"source-over"},A=new s.KlCanvasPreview({width:Math.round(d),height:Math.round(g),layers:[L]}),T=a.BB.el({css:{position:"relative",boxShadow:"0 0 5px rgba(0,0,0,0.5)",width:parseInt(""+d)+"px",height:parseInt(""+g)+"px"}});return T.appendChild(A.getElement()),k.appendChild(T),setTimeout(n,0),f.appendChild(k),v.destroy=function(){b.destroy(),w.destroy()},v.getInput=function(){return v.destroy(),{horizontal:m,vertical:y,flipCanvas:x}},v},apply:function(e){var t=e.context,n=e.canvas,r=e.history,i=e.input.horizontal,a=e.input.vertical,o=e.input.flipCanvas;return!!(t&&n&&r)&&(r.pause(!0),n.flip(i,a,o?null:n.getLayerIndex(t.canvas)),r.pause(!1),r.push({tool:["filter","flip"],action:"apply",params:[{input:e.input}]}),!0)}}})),r.register("1RI49",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("eFiVD")})),r.register("gMKRz",(function(e,n){t(e.exports,"glHueSaturation",(function(){return u}));var i=r("eWjiX"),a=r("cH2YE"),o=r("llzZ0"),s=r("i5nyl"),l=r("5RaQo"),c=r("1mH1z"),u={getDialog:function(e){var t=e.context,n=e.canvas;if(!t||!n)return!1;var r=n.getLayers(),u=n.getLayerIndex(t.canvas),h=i.BB.fitInto(t.canvas.width,t.canvas.height,280,200,1),p=parseInt(""+h.width),d=parseInt(""+h.height),g=i.BB.canvas(p,d),f=g.getContext("2d");f.save(),g.width>t.canvas.width&&(f.imageSmoothingEnabled=!1),f.drawImage(t.canvas,0,0,p,d),f.restore();var v=document.createElement("div"),m={element:v};return setTimeout((function(){var e=0,t=0;v.innerHTML=c.LANG("filter-hue-sat-description")+"<br/><br/>";var n=l.getSharedFx();if(n){var h=n.texture(g);n.draw(h).update();var f=new o.KlSlider({label:c.LANG("filter-hue-sat-hue"),width:300,height:30,min:-100,max:100,initValue:100*e,eventResMs:a.eventResMs,onChange:function(r){e=r/100,n.draw(h).hueSaturation(e,t).update(),B.render()}}),y=new o.KlSlider({label:c.LANG("filter-hue-sat-saturation"),width:300,height:30,min:0,max:100,initValue:50*(t+1),eventResMs:a.eventResMs,onChange:function(r){t=r/50-1,n.draw(h).hueSaturation(e,t).update(),B.render()}});f.getElement().style.marginBottom="10px",v.appendChild(f.getElement()),v.appendChild(y.getElement());var x=document.createElement("div");i.BB.css(x,{width:"340px",marginLeft:"-20px",height:"220px",backgroundColor:"#9e9e9e",marginTop:"10px",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",overflow:"hidden",position:"relative",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center",colorScheme:"only light"});for(var b=[],w=0;w<r.length;w++)b.push({image:w===u?n:r[w].context.canvas,opacity:r[w].opacity,mixModeStr:r[w].mixModeStr});var B=new s.KlCanvasPreview({width:parseInt(""+p),height:parseInt(""+d),layers:b}),C=i.BB.el({css:{position:"relative",boxShadow:"0 0 5px rgba(0,0,0,0.5)",width:parseInt(""+p)+"px",height:parseInt(""+d)+"px"}});C.appendChild(B.getElement()),x.appendChild(C),v.appendChild(x);try{n.draw(h).hueSaturation(e,t).update(),B.render()}catch(e){v.errorCallback(e)}m.destroy=function(){f.destroy(),y.destroy(),h.destroy()},m.getInput=function(){return m.destroy(),{hue:e,Saturation:t}}}}),1),m},apply:function(e){var t=e.context,n=e.input.hue,r=e.history,i=e.input.Saturation;if(!t||null===n||null===i||!r)return!1;r.pause(!0);var a=l.getSharedFx();if(!a)return!1;var o=a.texture(t.canvas);return a.draw(o).hueSaturation(n,i).update(),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(a,0,0),o.destroy(),r.pause(!1),r.push({tool:["filter","glHueSaturation"],action:"apply",params:[{input:e.input}]}),!0}}})),r.register("7z464",(function(e,n){t(e.exports,"invert",(function(){return a}));var i=r("5RaQo"),a={apply:function(e){var t=e.context,n=e.history;if(!t||!n)return!1;n.pause(!0);var r=i.getSharedFx();if(!r)return!1;var a=r.texture(t.canvas);return r.draw(a).invert().update(),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(r,0,0),a.destroy(),n.pause(!1),n.push({tool:["filter","invert"],action:"apply",params:[{input:e.input}]}),!0}}})),r.register("diAhN",(function(n,i){t(n.exports,"glPerspective",(function(){return u}));var a=r("eWjiX"),o=r("i5nyl"),s=r("1RI49"),l=r("5RaQo"),c=r("1mH1z"),u={getDialog:function(t){var n=t.context,r=t.canvas;if(!n||!r)return!1;var i=window.innerWidth<550,u=r.getLayers(),h=r.getLayerIndex(n.canvas),p=a.BB.fitInto(n.canvas.width,n.canvas.height,i?280:490,i?200:240,1),d=parseInt(""+p.width),g=parseInt(""+p.height),f=Math.min(d,n.canvas.width),v=Math.min(g,n.canvas.height),m=a.BB.canvas(f,v),y=m.getContext("2d");y.save(),f>n.canvas.width&&(y.imageSmoothingEnabled=!1),y.drawImage(n.canvas,0,0,f,v),y.restore();var x=d/n.canvas.width,b=document.createElement("div"),w={element:b};i||(w.width=500);var B=[];return setTimeout((function(){b.innerHTML=c.LANG("filter-perspective-description")+"<br/><br/>";var t=l.getSharedFx();if(t){var n,r,p,y,C,S,k,L,A=t.texture(m);t.draw(A).update(),n=z(0,0,H),r=z(d,0,H),p=z(d,g,H),y=z(0,g,H),C=z(0,0),S=z(d,0),k=z(d,g),L=z(0,g);var T=!1,I=document.createElement("div");a.BB.setEventListener(I,"onpointerdown",(function(){return!1})),I.textContent=c.LANG("filter-perspective-before"),I.style.width="150px",I.style.height="30px",I.style.marginLeft=i?"0":"100px",I.style.paddingTop="10px",I.style.textAlign="center",I.style.cssFloat="left",I.style.paddingBottom="0px",I.style.borderTopLeftRadius="10px",I.style.cursor="pointer",I.style.backgroundColor="rgba(0, 0, 0, 0.1)",I.style.backgroundSize="8%";var E=document.createElement("div");a.BB.setEventListener(E,"onpointerdown",(function(){return!1})),E.textContent=c.LANG("filter-perspective-after"),E.style.width="150px",E.style.height="30px",E.style.paddingTop="10px",E.style.textAlign="center",E.style.cssFloat="left",E.style.paddingBottom="0px",E.style.borderTopRightRadius="10px",E.style.boxShadow="inset 0px 5px 10px rgba(0,0,0,0.5)",E.style.background="url("+e(s)+") no-repeat 12px 16px",E.style.backgroundSize="8%",E.style.backgroundColor="#9e9e9e",a.BB.setEventListener(I,"onpointerover",(function(){!1===T&&(I.style.backgroundColor="#ccc")})),a.BB.setEventListener(I,"onpointerout",(function(){!1===T&&(I.style.backgroundColor="rgba(0, 0, 0, 0.1)")})),a.BB.setEventListener(E,"onpointerover",(function(){!0===T&&(E.style.backgroundColor="#ccc")})),a.BB.setEventListener(E,"onpointerout",(function(){!0===T&&(E.style.backgroundColor="rgba(0, 0, 0, 0.1)")})),I.onclick=function(){I.style.background="url("+e(s)+") no-repeat 12px 16px",I.style.backgroundSize="8%",I.style.backgroundColor="#9e9e9e",I.style.boxShadow="inset 0px 5px 10px rgba(0,0,0,0.5)",I.style.cursor="default",E.style.background="",E.style.backgroundColor="rgba(0, 0, 0, 0.1)",E.style.boxShadow="",E.style.cursor="pointer",C.style.display="none",S.style.display="none",k.style.display="none",L.style.display="none",n.style.display="block",r.style.display="block",p.style.display="block",y.style.display="block",n.copy(C),r.copy(S),p.copy(k),y.copy(L),T=!0,j()},E.onclick=function(){T=!1,E.style.background="url("+e(s)+") no-repeat 12px 16px",E.style.backgroundSize="8%",E.style.backgroundColor="#9e9e9e",E.style.boxShadow="inset 0px 5px 10px rgba(0,0,0,0.5)",E.style.cursor="default",I.style.background="",I.style.backgroundColor="rgba(0, 0, 0, 0.1)",I.style.boxShadow="",I.style.cursor="pointer",n.style.display="none",r.style.display="none",p.style.display="none",y.style.display="none",C.style.display="block",S.style.display="block",k.style.display="block",L.style.display="block",C.copy(n),S.copy(r),k.copy(p),L.copy(y)};var M=document.createElement("div");M.appendChild(I),M.appendChild(E),b.appendChild(M);var R=document.createElement("div");R.oncontextmenu=function(){return!1},a.BB.css(R,{width:i?"340px":"540px",marginLeft:"-20px",height:i?"260px":"300px",backgroundColor:"#9e9e9e",marginTop:"10px",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",overflow:"hidden",position:"relative",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center",colorScheme:"only light"});for(var O=[],P=0;P<u.length;P++){var D=P===h?t:u[P].context.canvas;O.push({image:D,opacity:u[P].opacity,mixModeStr:u[P].mixModeStr})}var G=new o.KlCanvasPreview({width:parseInt(""+d),height:parseInt(""+g),layers:O}),N=a.BB.el({css:{position:"relative",boxShadow:"0 0 5px rgba(0,0,0,0.5)",width:parseInt(""+d)+"px",height:parseInt(""+g)+"px"}});N.appendChild(G.getElement()),R.appendChild(N),N.appendChild(C),N.appendChild(S),N.appendChild(k),N.appendChild(L),n.style.display="none",r.style.display="none",p.style.display="none",y.style.display="none",N.appendChild(n),N.appendChild(r),N.appendChild(p),N.appendChild(y),b.appendChild(R),j(),w.destroy=function(){for(var e=0;e<B.length;e++)B[e].destroy();A.destroy()},w.getInput=function(){return w.destroy(),{before:[n.x/x,n.y/x,r.x/x,r.y/x,p.x/x,p.y/x,y.x/x,y.y/x],after:[C.x/x,C.y/x,S.x/x,S.y/x,k.x/x,k.y/x,L.x/x,L.y/x]}}}function j(){try{t.draw(A).perspective([n.x,n.y,r.x,r.y,p.x,p.y,y.x,y.y].map((function(e,t){return t%2==0?e/d*f:e/g*v})),[C.x,C.y,S.x,S.y,k.x,k.y,L.x,L.y].map((function(e,t){return t%2==0?e/d*f:e/g*v}))).update(),G.render()}catch(e){b.errorCallback(e)}}function z(e,t,n){var r=document.createElement("div");r.x=e,r.y=t,a.BB.css(r,{width:"14px",height:"14px",backgroundColor:"#fff",boxShadow:"inset 0 0 0 2px #000",borderRadius:"14px",position:"absolute",cursor:"move",left:r.x-7+"px",top:r.y-7+"px",userSelect:"none",touchAction:"none"});var i=new a.BB.PointerListener({target:r,maxPointers:1,onPointer:function(e){e.eventPreventDefault(),"left"===e.button&&"pointermove"===e.type&&(r.x+=e.dX,r.y+=e.dY,r.style.left=r.x-7+"px",r.style.top=r.y-7+"px",n&&n(),j())}});return r.copy=function(e){r.x=e.x,r.y=e.y,r.style.left=r.x-7+"px",r.style.top=r.y-7+"px"},B.push(i),r}function H(){C.copy(n),S.copy(r),k.copy(p),L.copy(y)}}),1),w},apply:function(e){var t=e.context,n=e.history,r=e.input.before,i=e.input.after;if(!(t&&r&&i&&n))return!1;n.pause(!0);var a=l.getSharedFx();if(!a)return!1;var o=a.texture(t.canvas);t.canvas.width,t.canvas.height;return a.draw(o).perspective(r,i).update(),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(a,0,0),o.destroy(),n.pause(!1),n.push({tool:["filter","glPerspective"],action:"apply",params:[{input:e.input}]}),!0}}})),r.register("c1rJJ",(function(n,i){t(n.exports,"resize",(function(){return u}));var a=r("eWjiX"),o=r("lXqiv"),s=r("21VAD"),l=r("jfTWC"),c=r("1mH1z"),u={getDialog:function(t){var n=function(){if(0===B.value.length&&L||0===C.value.length&&k)return k=!1,void(L=!1);if(B.value=""+Math.max(1,parseInt(B.value)),C.value=""+Math.max(1,parseInt(C.value)),T&&(k&&(B.value=""+parseInt(""+parseInt(C.value)*A)),L&&(C.value=""+parseInt(""+parseInt(B.value)/A)),parseInt(B.value)>y||parseInt(C.value)>x)){var e=a.BB.fitInto(parseInt(B.value),parseInt(C.value),y,x,1);B.value=""+parseInt(""+e.width),C.value=""+parseInt(""+e.height)}parseInt(B.value)>y&&(B.value=""+y),parseInt(C.value)>x&&(C.value=""+x),k=!1,L=!1,v=parseInt(B.value),m=parseInt(C.value);var t=a.BB.fitInto(v,m,280,200,1),n=parseInt(""+t.width),i=parseInt(""+t.height);p=n/v;var o=a.BB.centerWithin(340,220,n,i);"smooth"===E.getValue()?(R.style.imageRendering=p>1?"pixelated":"",R.width=r.getWidth(),R.height=r.getHeight(),O.save(),O.imageSmoothingQuality="high",O.drawImage(d,0,0),a.BB.resizeCanvas(R,v,m),O.restore()):(R.style.imageRendering="pixelated",R.width=v,R.height=m,O.save(),O.imageSmoothingEnabled=!1,O.drawImage(d,0,0,R.width,R.height),O.restore()),R.style.width=Math.max(1,n)+"px",R.style.height=Math.max(1,i)+"px",D.style.left=o.x+"px",D.style.top=o.y+"px",D.style.width=Math.max(1,n)+"px",D.style.height=Math.max(1,i)+"px"},r=t.canvas;if(!r)return!1;var i=a.BB.fitInto(r.getWidth(),r.getHeight(),280,200,1),u=parseInt(""+i.width),h=parseInt(""+i.height),p=u/r.getWidth(),d=r.getCompleteCanvas(1),g=document.createElement("div"),f={element:g},v=r.getWidth(),m=r.getHeight();g.innerHTML=c.LANG("filter-resize-description")+"<br/><br/>";var y=t.maxWidth,x=t.maxHeight,b=a.BB.el({css:{width:"150px",height:"35px",lineHeight:"30px"}}),w=a.BB.el({css:{width:"150px",height:"35px",lineHeight:"30px"}}),B=a.BB.el({tagName:"input",css:{cssFloat:"right",width:"90px"},custom:{type:"number",min:"1",max:""+y,value:""+r.getWidth()}}),C=a.BB.el({tagName:"input",css:{cssFloat:"right",width:"90px"},custom:{type:"number",min:"1",max:""+x,value:""+r.getHeight()}});B.onclick=function(){this.focus(),L=!0,n()},C.onclick=function(){this.focus(),k=!0,n()},B.onchange=function(){L=!0,n()},C.onchange=function(){k=!0,n()},b.append(c.LANG("width")+": ",B),w.append(c.LANG("height")+": ",C);var S=a.BB.el({css:{background:"url("+e(l)+") no-repeat 140px 5px",backgroundSize:"50px 52px"}});S.append(b,w),g.appendChild(S);var k=!1,L=!1,A=r.getWidth()/r.getHeight(),T=!0,I=new o.Checkbox({init:!0,label:c.LANG("constrain-proportions"),allowTab:!0,callback:function(t){(T=t)?(B.value=""+r.getWidth(),C.value=""+r.getHeight(),S.style.background="url("+e(l)+") no-repeat 140px 5px",S.style.backgroundSize="50px 52px",n()):S.style.background=""}});g.appendChild(a.BB.el({css:{clear:"both"}}));var E=new s.Select({isFocusable:!0,optionArr:[["smooth",c.LANG("algorithm-smooth")],["pixelated",c.LANG("algorithm-pixelated")]],title:c.LANG("scaling-algorithm"),initValue:"smooth",onChange:function(){n()}}),M=a.BB.el({parent:g,css:{display:"flex",justifyContent:"space-between"}});M.appendChild(I.getElement()),M.appendChild(E.getElement());var R=a.BB.canvas(u,h);R.style.imageRendering="pixelated";var O=R.getContext("2d"),P=document.createElement("div");a.BB.css(P,{width:"340px",marginLeft:"-20px",height:"220px",display:"table",backgroundColor:"#9e9e9e",marginTop:"10px",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",position:"relative",userSelect:"none",colorScheme:"only light"});var D=a.BB.appendTextDiv(P,"");return D.appendChild(R),D.style.width=u+"px",D.style.height=h+"px",D.style.position="absolute",D.style.overflow="hidden",D.style.boxShadow="0 0 5px rgba(0,0,0,0.8)",D.style.overflow="hidden",a.BB.createCheckerDataUrl(8,(function(e){P.style.background="url("+e+")"})),g.appendChild(P),n(),f.destroy=function(){I.destroy()},f.getInput=function(){return f.destroy(),{width:v,height:m,algorithm:E.getValue()}},f},apply:function(e){var t=e.canvas,n=e.history,r=e.input.width,i=e.input.height,a=e.input.algorithm;return!(!t||!n)&&(n.pause(!0),t.resize(r,i,a),n.pause(!1),n.push({tool:["filter","resize"],action:"apply",params:[{input:e.input}]}),!0)}}})),r.register("jfTWC",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("2BZYe")})),r.register("2elec",(function(e,n){t(e.exports,"rotate",(function(){return o}));var i=r("eWjiX"),a=r("1mH1z"),o={getDialog:function(e){var t=function(){if(m.style.WebkitTransform="rotate("+p+"deg)",m.style.MozTransform="rotate("+p+"deg)",m.style.OTransform="rotate("+p+"deg)",m.style.msTransform="rotate("+p+"deg)",90===Math.abs(p%180)){var e=i.BB.fitInto(s,o,280,200,1),t=parseInt(""+e.height)/o;m.style.WebkitTransform="rotate("+p+"deg) scale("+t+")",m.style.MozTransform="rotate("+p+"deg) scale("+t+")",m.style.OTransform="rotate("+p+"deg) scale("+t+")",m.style.msTransform="rotate("+p+"deg) scale("+t+")"}},n=e.canvas;if(!n)return!1;var r=i.BB.fitInto(n.getWidth(),n.getHeight(),280,200,1),o=parseInt(""+r.width),s=parseInt(""+r.height),l=o/n.getWidth(),c=i.BB.canvas(o,s);c.style.display="block",c.getContext("2d").drawImage(n.getCompleteCanvas(l),0,0,o,s);var u=document.createElement("div"),h={element:u},p=0;u.innerHTML=a.LANG("filter-rotate-description")+"<br/><br/>";var d=document.createElement("button");d.innerHTML="<span style='font-size: 1.3em'>⟳</span> 90°";var g=document.createElement("button");g.innerHTML="<span style='font-size: 1.3em'>⟲</span> 90°",g.style.marginRight="5px",d.onclick=function(){p+=90,t()},g.onclick=function(){p-=90,t()},u.appendChild(g),u.appendChild(d);var f=document.createElement("div");i.BB.css(f,{width:"340px",marginLeft:"-20px",height:"220px",display:"table",backgroundColor:"#9e9e9e",marginTop:"10px",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",overflow:"hidden",position:"relative",userSelect:"none",colorScheme:"only light"});var v=document.createElement("div");v.style.display="table-cell",v.style.verticalAlign="middle";var m=i.BB.appendTextDiv(v,"");return m.appendChild(c),f.appendChild(v),m.style.width=o+"px",m.style.height=s+"px",m.style.marginLeft="auto",m.style.marginRight="auto",m.style.boxShadow="0 0 5px rgba(0,0,0,0.8)",m.style.overflow="hidden",i.BB.createCheckerDataUrl(4,(function(e){m.style.background="url("+e+")"})),m.style.transition="all 0.2s ease-out",u.appendChild(f),t(),h.getInput=function(){return{deg:p}},h},apply:function(e){var t=e.canvas,n=e.history,r=e.input.deg;return!(!t||!n)&&(n.pause(!0),t.rotate(r),n.pause(!1),n.push({tool:["filter","rotate"],action:"apply",params:[{input:e.input}]}),!0)}}})),r.register("gACTl",(function(e,n){t(e.exports,"glTiltShift",(function(){return u}));var i=r("eWjiX"),a=r("cH2YE"),o=r("llzZ0"),s=r("i5nyl"),l=r("5RaQo"),c=r("1mH1z"),u={getDialog:function(e){var t=e.context,n=e.canvas;if(!t||!n)return!1;var r=n.getLayers(),u=n.getLayerIndex(t.canvas),h=i.BB.fitInto(t.canvas.width,t.canvas.height,280,200,1),p=parseInt(""+h.width),d=parseInt(""+h.height),g=Math.min(p,t.canvas.width),f=Math.min(d,t.canvas.height),v=i.BB.canvas(g,f),m=v.getContext("2d");m.save(),g>t.canvas.width&&(m.imageSmoothingEnabled=!1),m.drawImage(t.canvas,0,0,g,f),m.restore();var y=g/t.canvas.width,x=p/t.canvas.width,b=document.createElement("div"),w={element:b},B=[];return setTimeout((function(){var e=20,t=200;b.innerHTML=c.LANG("filter-tilt-shift-description")+"<br/><br/>";var n=l.getSharedFx();if(n){var h,g,f=n.texture(v);n.draw(f).update(),h=E(parseInt(""+p/6),parseInt(""+d/2)),g=E(parseInt(""+(p-p/6)),parseInt(""+(d-d/3)));var m=new o.KlSlider({label:c.LANG("filter-tilt-shift-blur"),width:300,height:30,min:0,max:200,initValue:e,eventResMs:a.eventResMs,onChange:function(t){e=t,I()}});m.getElement().style.marginBottom="10px",b.appendChild(m.getElement());var C=new o.KlSlider({label:c.LANG("filter-tilt-shift-gradient"),width:300,height:30,min:0,max:1e3,initValue:t,eventResMs:a.eventResMs,onChange:function(e){t=e,I()}});b.appendChild(C.getElement());var S=document.createElement("div");S.oncontextmenu=function(){return!1},i.BB.css(S,{width:"340px",marginLeft:"-20px",height:"220px",backgroundColor:"#9e9e9e",marginTop:"10px",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",overflow:"hidden",position:"relative",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center",colorScheme:"only light"});for(var k=[],L=0;L<r.length;L++)k.push({image:L===u?n:r[L].context.canvas,opacity:r[L].opacity,mixModeStr:r[L].mixModeStr});var A=new s.KlCanvasPreview({width:parseInt(""+p),height:parseInt(""+d),layers:k}),T=i.BB.el({css:{position:"relative",boxShadow:"0 0 5px rgba(0,0,0,0.5)",width:parseInt(""+p)+"px",height:parseInt(""+d)+"px"}});T.appendChild(A.getElement()),S.appendChild(T),T.appendChild(h),T.appendChild(g),b.appendChild(S),I(),w.destroy=function(){for(var e=0;e<B.length;e++)B[e].destroy();m.destroy(),C.destroy(),f.destroy()},w.getInput=function(){return w.destroy(),{a:{x:h.x/x,y:h.y/x},b:{x:g.x/x,y:g.y/x},blur:e,gradient:t}}}function I(){try{n.draw(f).tiltShift(h.x/x*y,h.y/x*y,g.x/x*y,g.y/x*y,e*y,t*y).update(),A.render()}catch(e){b.errorCallback(e)}}function E(e,t){var n=i.BB.el({css:{width:"14px",height:"14px",backgroundColor:"#fff",boxShadow:"inset 0 0 0 2px #000",borderRadius:"14px",position:"absolute",cursor:"move",left:e-7+"px",top:t-7+"px",userSelect:"none",touchAction:"none"}});n.x=e,n.y=t;var r=new i.BB.PointerListener({target:n,maxPointers:1,onPointer:function(e){e.eventPreventDefault(),"left"===e.button&&"pointermove"===e.type&&(n.x+=e.dX,n.y+=e.dY,n.style.left=n.x-7+"px",n.style.top=n.y-7+"px",I())}});return B.push(r),n}}),1),w},apply:function(e){var t=e.context,n=e.history,r=e.input.a,i=e.input.b,a=e.input.blur,o=e.input.gradient;if(!t||!n)return!1;n.pause(!0);var s=l.getSharedFx();if(!s)return!1;var c=s.texture(t.canvas);return s.draw(c).tiltShift(r.x,r.y,i.x,i.y,a,o).update(),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(s,0,0),c.destroy(),n.pause(!1),n.push({tool:["filter","glTiltShift"],action:"apply",params:[{input:e.input}]}),!0}}})),r.register("dIv7c",(function(e,n){t(e.exports,"transform",(function(){return u}));var i=r("eWjiX"),a=r("lXqiv"),o=r("i5nyl"),s=r("cNhNm"),l=r("21VAD"),c=r("1mH1z"),u={getDialog:function(e){var t,n=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(p){var t=p.getTransform();if(JSON.stringify(t)!==ae||e){ae=JSON.stringify(t),w<1&&(t.x*=w,t.y*=w,t.width*=w,t.height*=w);var n=ee[f].image,r=n.getContext("2d");r.save(),r.clearRect(0,0,n.width,n.height),i.BB.drawTransformedImageWithBounds(r,g[f].context.canvas,t,B,"pixelated"===Z.getValue()||i.BB.testShouldPixelate(t,t.width/A.width,t.height/A.height)),r.restore(),re.render()}}},r=function(){p.setPos({x:parseInt(D.value)+A.x,y:parseInt(P.value)+A.y}),p.setAngleDeg(parseInt(G.value)),n()},u=e.context,h=e.canvas;if(!u||!h)return!1;var p,d=window.innerWidth<550,g=h.getLayers(),f=h.getLayerIndex(u.canvas),v=i.BB.fitInto(u.canvas.width,u.canvas.height,d?280:490,d?200:240,1),m=parseInt(""+v.width),y=parseInt(""+v.height),x=Math.min(m,u.canvas.width),b=Math.min(y,u.canvas.height),w=m/u.canvas.width,B={x:0,y:0,width:0,height:0},C={x1:null,y1:null,x2:null,y2:null},S=u.getImageData(0,0,u.canvas.width,u.canvas.height);if(S.data[3]>0&&S.data[S.data.length-1]>0)C.x1=0,C.y1=0,C.x2=u.canvas.width-1,C.y2=u.canvas.height-1;else for(t=3;t<S.data.length;t+=4)if(S.data[t]>0){var k=(t-3)/4%u.canvas.width,L=Math.floor((t-3)/4/u.canvas.width);(C.x1>k||null===C.x1)&&(C.x1=k),null===C.y1&&(C.y1=L),(C.x2<k||null===C.x2)&&(C.x2=k),(C.y2<L||null===C.y2)&&(C.y2=L)}if(null===C.x1||null===C.y1)return alert(c.LANG("filter-transform-empty")),!1;B.x=C.x1,B.y=C.y1,B.width=C.x2-C.x1+1,B.height=C.y2-C.y1+1;var A={x:B.x+B.width/2,y:B.y+B.height/2,width:B.width,height:B.height,angleDeg:0},T=document.createElement("div"),I={element:T};d||(I.width=500),T.innerHTML=c.LANG("filter-transform-description");var E=new i.BB.KeyListener({onDown:function(e){i.BB.isInputFocused(!0)||("left"===e&&(D.value=""+(parseFloat(D.value)-1),r()),"right"===e&&(D.value=""+(parseFloat(D.value)+1),r()),"up"===e&&(P.value=""+(parseFloat(P.value)-1),r()),"down"===e&&(P.value=""+(parseFloat(P.value)+1),r()))}}),M=document.createElement("div"),R=document.createElement("div"),O=document.createElement("div"),P=document.createElement("input"),D=document.createElement("input"),G=document.createElement("input");(M.style.width="100px",M.style.height="30px",R.style.width="100px",R.style.height="30px",R.style.display="inline-block",M.style.display="inline-block",O.style.display="inline-block",O.style.width="150px",O.style.height="30px",P.type="number",D.type="number",G.type="number",D.style.width="70px",P.style.width="70px",G.style.width="70px",P.value="0",D.value="0",G.value="0",P.onclick=function(){this.focus(),r()},D.onclick=function(){this.focus(),r()},G.onclick=function(){this.focus(),r()},P.onchange=function(){r()},D.onchange=function(){r()},G.onchange=function(){r()},P.onkeyup=function(){r()},D.onkeyup=function(){r()},G.onkeyup=function(){r()},M.append("X: ",D),R.append("Y: ",P),O.append(c.LANG("filter-transform-rotation")+": ",G),d)||i.BB.el({parent:T,css:{marginTop:"10px"}}).append(M,R,O);var N={marginLeft:"10px",marginTop:"10px"},j=i.BB.el({parent:T,css:{display:"flex",flexWrap:"wrap",marginLeft:"-10px"}}),z=i.BB.el({parent:j,tagName:"button",content:c.LANG("filter-transform-flip")+" X",onClick:function(){var e=p.getTransform();p.setSize(-e.width,e.height)},css:N}),H=i.BB.el({parent:j,tagName:"button",content:c.LANG("filter-transform-flip")+" Y",onClick:function(){var e=p.getTransform();p.setSize(e.width,-e.height)},css:N}),U=i.BB.el({parent:j,tagName:"button",content:"-90°",onClick:function(){var e=p.getTransform();e.angleDeg-=90,e.angleDeg%=360,p.setAngleDeg(e.angleDeg),G.value=""+Math.round(e.angleDeg),n()},css:N}),X=i.BB.el({parent:j,tagName:"button",content:"+90°",onClick:function(){var e=p.getTransform();e.angleDeg+=90,e.angleDeg%=360,p.setAngleDeg(e.angleDeg),G.value=""+Math.round(e.angleDeg),n()},css:N}),F=i.BB.el({parent:j,tagName:"button",content:"2x",onClick:function(){var e=p.getTransform();Y.getValue()?p.setSize(p.getRatio()*e.height*2,2*e.height):p.setSize(2*e.width,2*e.height)},css:N}),W=i.BB.el({parent:j,tagName:"button",content:"1/2x",onClick:function(){var e=p.getTransform();p.setSize(Math.round(e.width/2),Math.round(e.height/2))},css:N}),K=i.BB.el({parent:j,tagName:"button",content:c.LANG("center"),onClick:function(){var e=p.getTransform();p.setPos({x:u.canvas.width/2,y:u.canvas.height/2}),p.setAngleDeg(e.angleDeg),n()},css:N}),V=!0,Y=new a.Checkbox({init:!0,label:c.LANG("filter-transform-constrain"),title:c.LANG("constrain-proportions"),allowTab:!0,callback:function(e){V=e,p.setConstrained(V)},css:{display:"inline-block"}}),J=!1,_=new a.Checkbox({init:!0,label:c.LANG("filter-transform-snap"),title:c.LANG("filter-transform-snap-title"),allowTab:!0,callback:function(e){J=e,p.setSnapping(J)},css:{display:"inline-block",marginLeft:"10px"}}),Q=i.BB.el({});Q.append(Y.getElement(),_.getElement()),T.appendChild(i.BB.el({css:{clear:"both",height:"10px"}}));var q=i.BB.el({parent:T,css:{display:"flex",justifyContent:"space-between"}}),Z=new l.Select({isFocusable:!0,optionArr:[["smooth",c.LANG("algorithm-smooth")],["pixelated",c.LANG("algorithm-pixelated")]],initValue:"smooth",title:c.LANG("scaling-algorithm"),onChange:function(){n(!0)}});q.append(Q,Z.getElement());var $=document.createElement("div");$.oncontextmenu=function(){return!1},i.BB.css($,{width:d?"340px":"540px",marginLeft:"-20px",height:d?"260px":"300px",backgroundColor:"#9e9e9e",marginTop:"10px",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",overflow:"hidden",position:"relative",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center",colorScheme:"only light"});for(var ee=[],te=0;te<g.length;te++){var ne=void 0;if(te===f)(ne=i.BB.canvas(parseInt(""+x),parseInt(""+b))).getContext("2d").drawImage(g[te].context.canvas,0,0,ne.width,ne.height);else ne=g[te].context.canvas;ee.push({image:ne,opacity:g[te].opacity,mixModeStr:g[te].mixModeStr})}var re=new o.KlCanvasPreview({width:parseInt(""+m),height:parseInt(""+y),layers:ee}),ie=i.BB.el({css:{position:"relative",boxShadow:"0 0 5px rgba(0,0,0,0.5)",width:parseInt(""+m)+"px",height:parseInt(""+y)+"px"}});ie.appendChild(re.getElement()),$.appendChild(ie);var ae=void 0;return p=new s.FreeTransform({x:A.x,y:A.y,width:A.width,height:A.height,angleDeg:A.angleDeg,isConstrained:!0,snapX:[0,u.canvas.width],snapY:[0,u.canvas.height],callback:function(e){D.value=""+Math.round(e.x-A.x),P.value=""+Math.round(e.y-A.y),G.value=""+Math.round(e.angleDeg),n()},scale:w}),i.BB.css(p.getElement(),{position:"absolute",left:"0",top:"0"}),ie.appendChild(p.getElement()),n(),T.appendChild($),I.destroy=function(){E.destroy(),p.destroy(),Y.destroy(),_.destroy(),i.BB.destroyEl(z),i.BB.destroyEl(H),i.BB.destroyEl(U),i.BB.destroyEl(X),i.BB.destroyEl(F),i.BB.destroyEl(W),i.BB.destroyEl(K)},I.getInput=function(){var e=p.getTransform(),t={transform:e,bounds:B,isPixelated:"pixelated"===Z.getValue()||i.BB.testShouldPixelate(e,e.width/A.width,e.height/A.height)};return I.destroy(),JSON.parse(JSON.stringify(t))},I},apply:function(e){var t=e.context,n=e.history;if(!t||!n)return!1;n.pause(!0);var r=e.input,a=i.BB.copyCanvas(t.canvas);return t.clearRect(0,0,t.canvas.width,t.canvas.height),i.BB.drawTransformedImageWithBounds(t,a,r.transform,r.bounds,r.isPixelated),n.pause(!1),n.push({tool:["filter","transform"],action:"apply",params:[{input:r}]}),!0}}})),r.register("1NZ3i",(function(e,n){t(e.exports,"glBlur",(function(){return u}));var i=r("eWjiX"),a=r("llzZ0"),o=r("cH2YE"),s=r("i5nyl"),l=r("5RaQo"),c=r("1mH1z"),u={getDialog:function(e){var t=e.canvas,n=e.context;if(!t||!n)return!1;var r=t.getLayers(),u=t.getLayerIndex(n.canvas),h=i.BB.fitInto(n.canvas.width,n.canvas.height,280,200,1),p=parseInt(""+h.width),d=parseInt(""+h.height),g=Math.min(p,n.canvas.width),f=Math.min(d,n.canvas.height),v=i.BB.canvas(g,f),m=v.getContext("2d");m.save(),g>n.canvas.width&&(m.imageSmoothingEnabled=!1),m.drawImage(n.canvas,0,0,g,f),m.restore();var y=g/n.canvas.width,x=document.createElement("div"),b={element:x};return setTimeout((function(){var e=10;x.innerHTML=c.LANG("filter-triangle-blur-description")+"<br/><br/>";var t=l.getSharedFx();if(t){var n=t.texture(v);t.draw(n).update();var h=new a.KlSlider({label:c.LANG("radius"),width:300,height:30,min:1,max:200,initValue:e,eventResMs:o.eventResMs,onChange:function(r){e=r,t.draw(n).triangleBlur(e*y).update(),w.render()}});x.appendChild(h.getElement());var g=document.createElement("div");i.BB.css(g,{width:"340px",marginLeft:"-20px",height:"220px",backgroundColor:"#9e9e9e",marginTop:"10px",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",overflow:"hidden",position:"relative",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center",colorScheme:"only light"});for(var f=[],m=0;m<r.length;m++)f.push({image:m===u?t:r[m].context.canvas,opacity:r[m].opacity,mixModeStr:r[m].mixModeStr});var w=new s.KlCanvasPreview({width:parseInt(""+p),height:parseInt(""+d),layers:f}),B=i.BB.el({css:{position:"relative",boxShadow:"0 0 5px rgba(0,0,0,0.5)",width:parseInt(""+p)+"px",height:parseInt(""+d)+"px"}});B.appendChild(w.getElement()),g.appendChild(B),x.appendChild(g);try{t.draw(n).triangleBlur(e*y).update(),w.render()}catch(e){x.errorCallback(e)}b.destroy=function(){n.destroy(),h.destroy()},b.getInput=function(){return b.destroy(),{radius:e}}}}),1),b},apply:function(e){var t=e.context,n=e.history,r=e.input.radius;if(!t||!r||!n)return!1;n.pause(!0);var i=l.getSharedFx();if(!i)return!1;var a=i.texture(t.canvas);return i.draw(a).triangleBlur(r).update(),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(i,0,0),a.destroy(),n.pause(!1),n.push({tool:["filter","glBlur"],action:"apply",params:[{input:e.input}]}),!0}}})),r.register("cJB4E",(function(e,n){t(e.exports,"glUnsharpMask",(function(){return u}));var i=r("eWjiX"),a=r("cH2YE"),o=r("llzZ0"),s=r("i5nyl"),l=r("5RaQo"),c=r("1mH1z"),u={getDialog:function(e){var t=e.context,n=e.canvas;if(!t||!n)return!1;var r=n.getLayers(),u=n.getLayerIndex(t.canvas),h=i.BB.fitInto(t.canvas.width,t.canvas.height,280,200,1),p=parseInt(""+h.width),d=parseInt(""+h.height),g=Math.min(p,t.canvas.width),f=Math.min(d,t.canvas.height),v=i.BB.canvas(g,f),m=v.getContext("2d");m.save(),g>t.canvas.width&&(m.imageSmoothingEnabled=!1),m.drawImage(t.canvas,0,0,g,f),m.restore();var y=g/t.canvas.width,x=document.createElement("div"),b={element:x};return setTimeout((function(){var e=2,t=.51;x.innerHTML=c.LANG("filter-unsharp-mask-description")+"<br/><br/>";var n=l.getSharedFx();if(n){var h=n.texture(v);n.draw(h).update();var g=new o.KlSlider({label:c.LANG("radius"),width:300,height:30,min:0,max:200,initValue:2,eventResMs:a.eventResMs,onChange:function(r){e=r,n.draw(h).unsharpMask(e*y,t).update(),C.render()},curve:[[0,0],[.1,2],[.5,50],[1,200]]}),f=new o.KlSlider({label:c.LANG("filter-unsharp-mask-strength"),width:300,height:30,min:0,max:50,initValue:5.1,eventResMs:a.eventResMs,onChange:function(r){t=r/10,n.draw(h).unsharpMask(e*y,t).update(),C.render()},curve:[[0,0],[.1,2],[.5,10],[1,50]]});g.getElement().style.marginBottom="10px",x.appendChild(g.getElement()),x.appendChild(f.getElement());var m=document.createElement("div");i.BB.css(m,{width:"340px",marginLeft:"-20px",height:"220px",backgroundColor:"#9e9e9e",marginTop:"10px",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",overflow:"hidden",position:"relative",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center",colorScheme:"only light"});for(var w=[],B=0;B<r.length;B++)w.push({image:B===u?n:r[B].context.canvas,opacity:r[B].opacity,mixModeStr:r[B].mixModeStr});var C=new s.KlCanvasPreview({width:parseInt(""+p),height:parseInt(""+d),layers:w}),S=i.BB.el({css:{position:"relative",boxShadow:"0 0 5px rgba(0,0,0,0.5)",width:parseInt(""+p)+"px",height:parseInt(""+d)+"px"}});S.appendChild(C.getElement()),m.appendChild(S),x.appendChild(m);try{n.draw(h).unsharpMask(e*y,t).update(),C.render()}catch(e){x.errorCallback(e)}b.destroy=function(){g.destroy(),f.destroy(),h.destroy()},b.getInput=function(){return b.destroy(),{radius:e,strength:t}}}}),1),b},apply:function(e){var t=e.context,n=e.history,r=e.input.radius,i=e.input.strength;if(!t||null===r||null===i||!n)return!1;n.pause(!0);var a=l.getSharedFx();if(!a)return!1;var o=a.texture(t.canvas);return a.draw(o).unsharpMask(r,i).update(),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(a,0,0),o.destroy(),n.pause(!1),n.push({tool:["filter","glUnsharpMask"],action:"apply",params:[{input:e.input}]}),!0}}})),r.register("gTwOE",(function(e,n){t(e.exports,"toAlpha",(function(){return u}));var i=r("eWjiX"),a=r("iskOY"),o=r("9A7OD"),s=r("i5nyl"),l=r("5RaQo"),c=r("1mH1z"),u={getDialog:function(e){var t=e.context,n=e.canvas;if(!t||!n)return!1;var r=n.getLayers(),u=n.getLayerIndex(t.canvas),h=i.BB.fitInto(t.canvas.width,t.canvas.height,280,200,1),p=parseInt(""+h.width),d=parseInt(""+h.height),g=i.BB.canvas(p,d),f=g.getContext("2d");f.save(),g.width>t.canvas.width&&(f.imageSmoothingEnabled=!1),f.drawImage(t.canvas,0,0,p,d),f.restore();var v=document.createElement("div"),m={element:v};return setTimeout((function(){v.appendChild(i.BB.el({content:c.LANG("filter-to-alpha-description"),css:{marginBottom:"5px"}}));var t=l.getSharedFx();if(t){var n=t.texture(g);t.draw(n).update();var h="inverted-luminance",f=new a.Options({optionArr:[{id:"inverted-luminance",label:c.LANG("filter-to-alpha-inverted-lum")},{id:"luminance",label:c.LANG("filter-to-alpha-lum")}],initialId:h,onChange:function(e){h=e,L()}});v.appendChild(f.getElement());var y={r:0,g:0,b:0,a:1},x=[null,{r:0,g:0,b:0,a:1},{r:255,g:255,b:255,a:1}];x.push({r:e.currentColorRgb.r,g:e.currentColorRgb.g,b:e.currentColorRgb.b,a:1}),x.push({r:e.secondaryColorRgb.r,g:e.secondaryColorRgb.g,b:e.secondaryColorRgb.b,a:1});var b=new o.ColorOptions({label:c.LANG("filter-to-alpha-replace"),colorArr:x,initialIndex:1,onChange:function(e){y=e,L()}});b.getElement().style.marginTop="10px",v.appendChild(b.getElement());var w=document.createElement("div");i.BB.css(w,{width:"340px",marginLeft:"-20px",height:"220px",backgroundColor:"#9e9e9e",marginTop:"10px",boxShadow:"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset",overflow:"hidden",position:"relative",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center",colorScheme:"only light"});for(var B=[],C=0;C<r.length;C++)B.push({image:C===u?t:r[C].context.canvas,opacity:r[C].opacity,mixModeStr:r[C].mixModeStr});var S=new s.KlCanvasPreview({width:parseInt(""+p),height:parseInt(""+d),layers:B}),k=i.BB.el({css:{position:"relative",boxShadow:"0 0 5px rgba(0,0,0,0.5)",width:parseInt(""+p)+"px",height:parseInt(""+d)+"px"}});k.appendChild(S.getElement()),w.appendChild(k),v.appendChild(w),setTimeout((function(){try{L()}catch(e){v.errorCallback(e)}}),1),m.destroy=function(){n.destroy(),f.destroy()},m.getInput=function(){return m.destroy(),{sourceId:h,selectedRgbaObj:y}}}function L(){t.draw(n).toAlpha("inverted-luminance"===h,y).update(),S.render()}}),1),m},apply:function(e){var t=e.context,n=e.history,r=e.input.sourceId,i=e.input.selectedRgbaObj;if(!t||!r||!n)return!1;n.pause(!0);var a=l.getSharedFx();if(!a)return!1;var o=a.texture(t.canvas);return a.draw(o).toAlpha("inverted-luminance"===r,i).update(),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(a,0,0),o.destroy(),n.pause(!1),n.push({tool:["filter","toAlpha"],action:"apply",params:[{input:e.input}]}),!0}}})),r.register("3WOmu",(function(n,i){t(n.exports,"klCanvasToPsdBlob",(function(){return l}));var a=r("4gaLD"),o=r("cijLd"),s=r("hrnUX");function l(e){return c.apply(this,arguments)}function c(){return(c=a.asyncToGenerator(e(o).mark((function t(n){var i,a,l,c,u,h;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=n.getLayersFast(),a={width:n.getWidth(),height:n.getHeight(),children:[]},l=0;l<i.length;l++)c=i[l],a.children.push({name:c.name,opacity:c.opacity,canvas:c.canvas,blendMode:s.KL.PSD.blendKlToPsd(c.mixModeStr),left:0,top:0});return e.next=5,r("bxnoy");case 5:return u=e.sent,h=u.writePsdBuffer(a),e.abrupt("return",new Blob([h],{type:"application/octet-stream"}));case 8:case"end":return e.stop()}}),t)})))).apply(this,arguments)}})),r.register("eIlXd",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("k9Nks")})),r.register("23J3k",(function(e,t){e.exports=r("f6OTe").getBundleURL("dafOa")+r("2evKT").resolve("bBxqy")}))}();
//# sourceMappingURL=main-embed.32cff597.js.map

{"mappings":"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","sources":["src/app/script/main-embed.ts","src/app/script/polyfills.ts","node_modules/core-js/modules/es.symbol.js","node_modules/core-js/internals/export.js","node_modules/core-js/internals/global.js","node_modules/core-js/internals/object-get-own-property-descriptor.js","node_modules/core-js/internals/descriptors.js","node_modules/core-js/internals/fails.js","node_modules/core-js/internals/function-call.js","node_modules/core-js/internals/function-bind-native.js","node_modules/core-js/internals/object-property-is-enumerable.js","node_modules/core-js/internals/create-property-descriptor.js","node_modules/core-js/internals/to-indexed-object.js","node_modules/core-js/internals/indexed-object.js","node_modules/core-js/internals/function-uncurry-this.js","node_modules/core-js/internals/classof-raw.js","node_modules/core-js/internals/require-object-coercible.js","node_modules/core-js/internals/to-property-key.js","node_modules/core-js/internals/to-primitive.js","node_modules/core-js/internals/is-object.js","node_modules/core-js/internals/is-callable.js","node_modules/core-js/internals/is-symbol.js","node_modules/core-js/internals/get-built-in.js","node_modules/core-js/internals/object-is-prototype-of.js","node_modules/core-js/internals/use-symbol-as-uid.js","node_modules/core-js/internals/native-symbol.js","node_modules/core-js/internals/engine-v8-version.js","node_modules/core-js/internals/engine-user-agent.js","node_modules/core-js/internals/get-method.js","node_modules/core-js/internals/a-callable.js","node_modules/core-js/internals/try-to-string.js","node_modules/core-js/internals/ordinary-to-primitive.js","node_modules/core-js/internals/well-known-symbol.js","node_modules/core-js/internals/shared.js","node_modules/core-js/internals/is-pure.js","node_modules/core-js/internals/shared-store.js","node_modules/core-js/internals/set-global.js","node_modules/core-js/internals/has-own-property.js","node_modules/core-js/internals/to-object.js","node_modules/core-js/internals/uid.js","node_modules/core-js/internals/ie8-dom-define.js","node_modules/core-js/internals/document-create-element.js","node_modules/core-js/internals/create-non-enumerable-property.js","node_modules/core-js/internals/object-define-property.js","node_modules/core-js/internals/v8-prototype-define-bug.js","node_modules/core-js/internals/an-object.js","node_modules/core-js/internals/redefine.js","node_modules/core-js/internals/inspect-source.js","node_modules/core-js/internals/internal-state.js","node_modules/core-js/internals/native-weak-map.js","node_modules/core-js/internals/shared-key.js","node_modules/core-js/internals/hidden-keys.js","node_modules/core-js/internals/function-name.js","node_modules/core-js/internals/copy-constructor-properties.js","node_modules/core-js/internals/own-keys.js","node_modules/core-js/internals/object-get-own-property-names.js","node_modules/core-js/internals/object-keys-internal.js","node_modules/core-js/internals/array-includes.js","node_modules/core-js/internals/to-absolute-index.js","node_modules/core-js/internals/to-integer-or-infinity.js","node_modules/core-js/internals/length-of-array-like.js","node_modules/core-js/internals/to-length.js","node_modules/core-js/internals/enum-bug-keys.js","node_modules/core-js/internals/object-get-own-property-symbols.js","node_modules/core-js/internals/is-forced.js","node_modules/core-js/internals/function-apply.js","node_modules/core-js/internals/is-array.js","node_modules/core-js/internals/to-string.js","node_modules/core-js/internals/classof.js","node_modules/core-js/internals/to-string-tag-support.js","node_modules/core-js/internals/object-create.js","node_modules/core-js/internals/object-define-properties.js","node_modules/core-js/internals/object-keys.js","node_modules/core-js/internals/html.js","node_modules/core-js/internals/object-get-own-property-names-external.js","node_modules/core-js/internals/array-slice-simple.js","node_modules/core-js/internals/create-property.js","node_modules/core-js/internals/array-slice.js","node_modules/core-js/internals/well-known-symbol-wrapped.js","node_modules/core-js/internals/define-well-known-symbol.js","node_modules/core-js/internals/path.js","node_modules/core-js/internals/set-to-string-tag.js","node_modules/core-js/internals/array-iteration.js","node_modules/core-js/internals/function-bind-context.js","node_modules/core-js/internals/array-species-create.js","node_modules/core-js/internals/array-species-constructor.js","node_modules/core-js/internals/is-constructor.js","node_modules/core-js/modules/es.symbol.description.js","node_modules/core-js/modules/es.symbol.async-iterator.js","node_modules/core-js/modules/es.symbol.has-instance.js","node_modules/core-js/modules/es.symbol.is-concat-spreadable.js","node_modules/core-js/modules/es.symbol.iterator.js","node_modules/core-js/modules/es.symbol.match.js","node_modules/core-js/modules/es.symbol.replace.js","node_modules/core-js/modules/es.symbol.search.js","node_modules/core-js/modules/es.symbol.species.js","node_modules/core-js/modules/es.symbol.split.js","node_modules/core-js/modules/es.symbol.to-primitive.js","node_modules/core-js/modules/es.symbol.to-string-tag.js","node_modules/core-js/modules/es.symbol.unscopables.js","node_modules/core-js/modules/es.array.concat.js","node_modules/core-js/internals/array-method-has-species-support.js","node_modules/core-js/modules/es.array.copy-within.js","node_modules/core-js/internals/array-copy-within.js","node_modules/core-js/internals/add-to-unscopables.js","node_modules/core-js/modules/es.array.fill.js","node_modules/core-js/internals/array-fill.js","node_modules/core-js/modules/es.array.filter.js","node_modules/core-js/modules/es.array.find.js","node_modules/core-js/modules/es.array.find-index.js","node_modules/core-js/modules/es.array.flat.js","node_modules/core-js/internals/flatten-into-array.js","node_modules/core-js/modules/es.array.flat-map.js","node_modules/core-js/modules/es.array.from.js","node_modules/core-js/internals/array-from.js","node_modules/core-js/internals/call-with-safe-iteration-closing.js","node_modules/core-js/internals/iterator-close.js","node_modules/core-js/internals/is-array-iterator-method.js","node_modules/core-js/internals/iterators.js","node_modules/core-js/internals/get-iterator.js","node_modules/core-js/internals/get-iterator-method.js","node_modules/core-js/internals/check-correctness-of-iteration.js","node_modules/core-js/modules/es.array.includes.js","node_modules/core-js/modules/es.array.index-of.js","node_modules/core-js/internals/array-method-is-strict.js","node_modules/core-js/modules/es.array.iterator.js","node_modules/core-js/internals/define-iterator.js","node_modules/core-js/internals/create-iterator-constructor.js","node_modules/core-js/internals/iterators-core.js","node_modules/core-js/internals/object-get-prototype-of.js","node_modules/core-js/internals/correct-prototype-getter.js","node_modules/core-js/internals/object-set-prototype-of.js","node_modules/core-js/internals/a-possible-prototype.js","node_modules/core-js/modules/es.array.join.js","node_modules/core-js/modules/es.array.last-index-of.js","node_modules/core-js/internals/array-last-index-of.js","node_modules/core-js/modules/es.array.map.js","node_modules/core-js/modules/es.array.of.js","node_modules/core-js/modules/es.array.reduce.js","node_modules/core-js/internals/array-reduce.js","node_modules/core-js/internals/engine-is-node.js","node_modules/core-js/modules/es.array.reduce-right.js","node_modules/core-js/modules/es.array.reverse.js","node_modules/core-js/modules/es.array.slice.js","node_modules/core-js/modules/es.array.sort.js","node_modules/core-js/internals/array-sort.js","node_modules/core-js/internals/engine-ff-version.js","node_modules/core-js/internals/engine-is-ie-or-edge.js","node_modules/core-js/internals/engine-webkit-version.js","node_modules/core-js/modules/es.array.species.js","node_modules/core-js/internals/set-species.js","node_modules/core-js/modules/es.array.splice.js","node_modules/core-js/modules/es.array.unscopables.flat.js","node_modules/core-js/modules/es.array.unscopables.flat-map.js","node_modules/core-js/modules/es.array-buffer.constructor.js","node_modules/core-js/internals/array-buffer.js","node_modules/core-js/internals/array-buffer-native.js","node_modules/core-js/internals/redefine-all.js","node_modules/core-js/internals/an-instance.js","node_modules/core-js/internals/to-index.js","node_modules/core-js/internals/ieee754.js","node_modules/core-js/modules/es.array-buffer.slice.js","node_modules/core-js/internals/species-constructor.js","node_modules/core-js/internals/a-constructor.js","node_modules/core-js/modules/es.date.to-json.js","node_modules/core-js/modules/es.date.to-primitive.js","node_modules/core-js/internals/date-to-primitive.js","node_modules/core-js/modules/es.function.has-instance.js","node_modules/core-js/modules/es.function.name.js","node_modules/core-js/modules/es.json.to-string-tag.js","node_modules/core-js/modules/es.map.js","node_modules/core-js/internals/collection.js","node_modules/core-js/internals/internal-metadata.js","node_modules/core-js/internals/object-is-extensible.js","node_modules/core-js/internals/array-buffer-non-extensible.js","node_modules/core-js/internals/freezing.js","node_modules/core-js/internals/iterate.js","node_modules/core-js/internals/inherit-if-required.js","node_modules/core-js/internals/collection-strong.js","node_modules/core-js/modules/es.math.acosh.js","node_modules/core-js/internals/math-log1p.js","node_modules/core-js/modules/es.math.asinh.js","node_modules/core-js/modules/es.math.atanh.js","node_modules/core-js/modules/es.math.cbrt.js","node_modules/core-js/internals/math-sign.js","node_modules/core-js/modules/es.math.clz32.js","node_modules/core-js/modules/es.math.cosh.js","node_modules/core-js/internals/math-expm1.js","node_modules/core-js/modules/es.math.expm1.js","node_modules/core-js/modules/es.math.fround.js","node_modules/core-js/internals/math-fround.js","node_modules/core-js/modules/es.math.hypot.js","node_modules/core-js/modules/es.math.imul.js","node_modules/core-js/modules/es.math.log10.js","node_modules/core-js/internals/math-log10.js","node_modules/core-js/modules/es.math.log1p.js","node_modules/core-js/modules/es.math.log2.js","node_modules/core-js/modules/es.math.sign.js","node_modules/core-js/modules/es.math.sinh.js","node_modules/core-js/modules/es.math.tanh.js","node_modules/core-js/modules/es.math.to-string-tag.js","node_modules/core-js/modules/es.math.trunc.js","node_modules/core-js/modules/es.number.constructor.js","node_modules/core-js/internals/this-number-value.js","node_modules/core-js/internals/string-trim.js","node_modules/core-js/internals/whitespaces.js","node_modules/core-js/modules/es.number.epsilon.js","node_modules/core-js/modules/es.number.is-finite.js","node_modules/core-js/internals/number-is-finite.js","node_modules/core-js/modules/es.number.is-integer.js","node_modules/core-js/internals/is-integral-number.js","node_modules/core-js/modules/es.number.is-nan.js","node_modules/core-js/modules/es.number.is-safe-integer.js","node_modules/core-js/modules/es.number.max-safe-integer.js","node_modules/core-js/modules/es.number.min-safe-integer.js","node_modules/core-js/modules/es.number.parse-float.js","node_modules/core-js/internals/number-parse-float.js","node_modules/core-js/modules/es.number.parse-int.js","node_modules/core-js/internals/number-parse-int.js","node_modules/core-js/modules/es.number.to-fixed.js","node_modules/core-js/internals/string-repeat.js","node_modules/core-js/modules/es.object.assign.js","node_modules/core-js/internals/object-assign.js","node_modules/core-js/modules/es.object.define-getter.js","node_modules/core-js/internals/object-prototype-accessors-forced.js","node_modules/core-js/modules/es.object.define-setter.js","node_modules/core-js/modules/es.object.entries.js","node_modules/core-js/internals/object-to-array.js","node_modules/core-js/modules/es.object.freeze.js","node_modules/core-js/modules/es.object.from-entries.js","node_modules/core-js/modules/es.object.get-own-property-descriptor.js","node_modules/core-js/modules/es.object.get-own-property-descriptors.js","node_modules/core-js/modules/es.object.get-own-property-names.js","node_modules/core-js/modules/es.object.get-prototype-of.js","node_modules/core-js/modules/es.object.is.js","node_modules/core-js/internals/same-value.js","node_modules/core-js/modules/es.object.is-extensible.js","node_modules/core-js/modules/es.object.is-frozen.js","node_modules/core-js/modules/es.object.is-sealed.js","node_modules/core-js/modules/es.object.keys.js","node_modules/core-js/modules/es.object.lookup-getter.js","node_modules/core-js/modules/es.object.lookup-setter.js","node_modules/core-js/modules/es.object.prevent-extensions.js","node_modules/core-js/modules/es.object.seal.js","node_modules/core-js/modules/es.object.set-prototype-of.js","node_modules/core-js/modules/es.object.to-string.js","node_modules/core-js/internals/object-to-string.js","node_modules/core-js/modules/es.object.values.js","node_modules/core-js/modules/es.parse-float.js","node_modules/core-js/modules/es.parse-int.js","node_modules/core-js/modules/es.promise.js","node_modules/core-js/internals/native-promise-constructor.js","node_modules/core-js/internals/task.js","node_modules/core-js/internals/engine-is-ios.js","node_modules/core-js/internals/microtask.js","node_modules/core-js/internals/engine-is-ios-pebble.js","node_modules/core-js/internals/engine-is-webos-webkit.js","node_modules/core-js/internals/promise-resolve.js","node_modules/core-js/internals/new-promise-capability.js","node_modules/core-js/internals/host-report-errors.js","node_modules/core-js/internals/perform.js","node_modules/core-js/internals/queue.js","node_modules/core-js/internals/engine-is-browser.js","node_modules/core-js/modules/es.promise.finally.js","node_modules/core-js/modules/es.reflect.apply.js","node_modules/core-js/modules/es.reflect.construct.js","node_modules/core-js/internals/function-bind.js","node_modules/core-js/modules/es.reflect.define-property.js","node_modules/core-js/modules/es.reflect.delete-property.js","node_modules/core-js/modules/es.reflect.get.js","node_modules/core-js/internals/is-data-descriptor.js","node_modules/core-js/modules/es.reflect.get-own-property-descriptor.js","node_modules/core-js/modules/es.reflect.get-prototype-of.js","node_modules/core-js/modules/es.reflect.has.js","node_modules/core-js/modules/es.reflect.is-extensible.js","node_modules/core-js/modules/es.reflect.own-keys.js","node_modules/core-js/modules/es.reflect.prevent-extensions.js","node_modules/core-js/modules/es.reflect.set.js","node_modules/core-js/modules/es.reflect.set-prototype-of.js","node_modules/core-js/modules/es.regexp.constructor.js","node_modules/core-js/internals/is-regexp.js","node_modules/core-js/internals/regexp-flags.js","node_modules/core-js/internals/regexp-sticky-helpers.js","node_modules/core-js/internals/regexp-unsupported-dot-all.js","node_modules/core-js/internals/regexp-unsupported-ncg.js","node_modules/core-js/modules/es.regexp.exec.js","node_modules/core-js/internals/regexp-exec.js","node_modules/core-js/modules/es.regexp.flags.js","node_modules/core-js/modules/es.regexp.to-string.js","node_modules/core-js/modules/es.set.js","node_modules/core-js/modules/es.string.code-point-at.js","node_modules/core-js/internals/string-multibyte.js","node_modules/core-js/modules/es.string.ends-with.js","node_modules/core-js/internals/not-a-regexp.js","node_modules/core-js/internals/correct-is-regexp-logic.js","node_modules/core-js/modules/es.string.from-code-point.js","node_modules/core-js/modules/es.string.includes.js","node_modules/core-js/modules/es.string.iterator.js","node_modules/core-js/modules/es.string.match.js","node_modules/core-js/internals/fix-regexp-well-known-symbol-logic.js","node_modules/core-js/internals/advance-string-index.js","node_modules/core-js/internals/regexp-exec-abstract.js","node_modules/core-js/modules/es.string.pad-end.js","node_modules/core-js/internals/string-pad.js","node_modules/core-js/internals/string-pad-webkit-bug.js","node_modules/core-js/modules/es.string.pad-start.js","node_modules/core-js/modules/es.string.raw.js","node_modules/core-js/modules/es.string.repeat.js","node_modules/core-js/modules/es.string.replace.js","node_modules/core-js/internals/get-substitution.js","node_modules/core-js/modules/es.string.search.js","node_modules/core-js/modules/es.string.split.js","node_modules/core-js/modules/es.string.starts-with.js","node_modules/core-js/modules/es.string.trim.js","node_modules/core-js/internals/string-trim-forced.js","node_modules/core-js/modules/es.string.trim-end.js","node_modules/core-js/modules/es.string.trim-start.js","node_modules/core-js/modules/es.string.anchor.js","node_modules/core-js/internals/create-html.js","node_modules/core-js/internals/string-html-forced.js","node_modules/core-js/modules/es.string.big.js","node_modules/core-js/modules/es.string.blink.js","node_modules/core-js/modules/es.string.bold.js","node_modules/core-js/modules/es.string.fixed.js","node_modules/core-js/modules/es.string.fontcolor.js","node_modules/core-js/modules/es.string.fontsize.js","node_modules/core-js/modules/es.string.italics.js","node_modules/core-js/modules/es.string.link.js","node_modules/core-js/modules/es.string.small.js","node_modules/core-js/modules/es.string.strike.js","node_modules/core-js/modules/es.string.sub.js","node_modules/core-js/modules/es.string.sup.js","node_modules/core-js/modules/es.typed-array.float32-array.js","node_modules/core-js/internals/typed-array-constructor.js","node_modules/core-js/internals/typed-array-constructors-require-wrappers.js","node_modules/core-js/internals/array-buffer-view-core.js","node_modules/core-js/internals/to-offset.js","node_modules/core-js/internals/to-positive-integer.js","node_modules/core-js/internals/typed-array-from.js","node_modules/core-js/modules/es.typed-array.float64-array.js","node_modules/core-js/modules/es.typed-array.int8-array.js","node_modules/core-js/modules/es.typed-array.int16-array.js","node_modules/core-js/modules/es.typed-array.int32-array.js","node_modules/core-js/modules/es.typed-array.uint8-array.js","node_modules/core-js/modules/es.typed-array.uint8-clamped-array.js","node_modules/core-js/modules/es.typed-array.uint16-array.js","node_modules/core-js/modules/es.typed-array.uint32-array.js","node_modules/core-js/modules/es.typed-array.copy-within.js","node_modules/core-js/modules/es.typed-array.every.js","node_modules/core-js/modules/es.typed-array.fill.js","node_modules/core-js/modules/es.typed-array.filter.js","node_modules/core-js/internals/typed-array-from-species-and-list.js","node_modules/core-js/internals/array-from-constructor-and-list.js","node_modules/core-js/internals/typed-array-species-constructor.js","node_modules/core-js/modules/es.typed-array.find.js","node_modules/core-js/modules/es.typed-array.find-index.js","node_modules/core-js/modules/es.typed-array.for-each.js","node_modules/core-js/modules/es.typed-array.from.js","node_modules/core-js/modules/es.typed-array.includes.js","node_modules/core-js/modules/es.typed-array.index-of.js","node_modules/core-js/modules/es.typed-array.iterator.js","node_modules/core-js/modules/es.typed-array.join.js","node_modules/core-js/modules/es.typed-array.last-index-of.js","node_modules/core-js/modules/es.typed-array.map.js","node_modules/core-js/modules/es.typed-array.of.js","node_modules/core-js/modules/es.typed-array.reduce.js","node_modules/core-js/modules/es.typed-array.reduce-right.js","node_modules/core-js/modules/es.typed-array.reverse.js","node_modules/core-js/modules/es.typed-array.set.js","node_modules/core-js/modules/es.typed-array.slice.js","node_modules/core-js/modules/es.typed-array.some.js","node_modules/core-js/modules/es.typed-array.sort.js","node_modules/core-js/modules/es.typed-array.subarray.js","node_modules/core-js/modules/es.typed-array.to-locale-string.js","node_modules/core-js/modules/es.typed-array.to-string.js","node_modules/core-js/modules/es.weak-map.js","node_modules/core-js/internals/collection-weak.js","node_modules/core-js/modules/es.weak-set.js","node_modules/core-js/modules/es.aggregate-error.js","node_modules/core-js/internals/clear-error-stack.js","node_modules/core-js/internals/install-error-cause.js","node_modules/core-js/internals/normalize-string-argument.js","node_modules/core-js/internals/error-stack-installable.js","node_modules/core-js/modules/esnext.array.last-index.js","node_modules/core-js/modules/esnext.array.last-item.js","node_modules/core-js/modules/esnext.composite-key.js","node_modules/core-js/internals/composite-key.js","node_modules/core-js/modules/esnext.composite-symbol.js","node_modules/core-js/modules/es.global-this.js","node_modules/core-js/modules/esnext.map.delete-all.js","node_modules/core-js/internals/collection-delete-all.js","node_modules/core-js/modules/esnext.map.every.js","node_modules/core-js/internals/get-map-iterator.js","node_modules/core-js/modules/esnext.map.filter.js","node_modules/core-js/modules/esnext.map.find.js","node_modules/core-js/modules/esnext.map.find-key.js","node_modules/core-js/modules/esnext.map.from.js","node_modules/core-js/internals/collection-from.js","node_modules/core-js/modules/esnext.map.group-by.js","node_modules/core-js/modules/esnext.map.includes.js","node_modules/core-js/internals/same-value-zero.js","node_modules/core-js/modules/esnext.map.key-by.js","node_modules/core-js/modules/esnext.map.key-of.js","node_modules/core-js/modules/esnext.map.map-keys.js","node_modules/core-js/modules/esnext.map.map-values.js","node_modules/core-js/modules/esnext.map.merge.js","node_modules/core-js/modules/esnext.map.of.js","node_modules/core-js/internals/collection-of.js","node_modules/core-js/modules/esnext.map.reduce.js","node_modules/core-js/modules/esnext.map.some.js","node_modules/core-js/modules/esnext.map.update.js","node_modules/core-js/modules/esnext.math.clamp.js","node_modules/core-js/modules/esnext.math.deg-per-rad.js","node_modules/core-js/modules/esnext.math.degrees.js","node_modules/core-js/modules/esnext.math.fscale.js","node_modules/core-js/internals/math-scale.js","node_modules/core-js/modules/esnext.math.iaddh.js","node_modules/core-js/modules/esnext.math.imulh.js","node_modules/core-js/modules/esnext.math.isubh.js","node_modules/core-js/modules/esnext.math.rad-per-deg.js","node_modules/core-js/modules/esnext.math.radians.js","node_modules/core-js/modules/esnext.math.scale.js","node_modules/core-js/modules/esnext.math.seeded-prng.js","node_modules/core-js/modules/esnext.math.signbit.js","node_modules/core-js/modules/esnext.math.umulh.js","node_modules/core-js/modules/esnext.number.from-string.js","node_modules/core-js/modules/esnext.observable.js","node_modules/core-js/modules/es.promise.all-settled.js","node_modules/core-js/modules/es.promise.any.js","node_modules/core-js/modules/esnext.promise.try.js","node_modules/core-js/modules/esnext.reflect.define-metadata.js","node_modules/core-js/internals/reflect-metadata.js","node_modules/core-js/modules/esnext.reflect.delete-metadata.js","node_modules/core-js/modules/esnext.reflect.get-metadata.js","node_modules/core-js/modules/esnext.reflect.get-metadata-keys.js","node_modules/core-js/internals/array-unique-by.js","node_modules/core-js/modules/esnext.reflect.get-own-metadata.js","node_modules/core-js/modules/esnext.reflect.get-own-metadata-keys.js","node_modules/core-js/modules/esnext.reflect.has-metadata.js","node_modules/core-js/modules/esnext.reflect.has-own-metadata.js","node_modules/core-js/modules/esnext.reflect.metadata.js","node_modules/core-js/modules/esnext.set.add-all.js","node_modules/core-js/internals/collection-add-all.js","node_modules/core-js/modules/esnext.set.delete-all.js","node_modules/core-js/modules/esnext.set.difference.js","node_modules/core-js/modules/esnext.set.every.js","node_modules/core-js/internals/get-set-iterator.js","node_modules/core-js/modules/esnext.set.filter.js","node_modules/core-js/modules/esnext.set.find.js","node_modules/core-js/modules/esnext.set.from.js","node_modules/core-js/modules/esnext.set.intersection.js","node_modules/core-js/modules/esnext.set.is-disjoint-from.js","node_modules/core-js/modules/esnext.set.is-subset-of.js","node_modules/core-js/modules/esnext.set.is-superset-of.js","node_modules/core-js/modules/esnext.set.join.js","node_modules/core-js/modules/esnext.set.map.js","node_modules/core-js/modules/esnext.set.of.js","node_modules/core-js/modules/esnext.set.reduce.js","node_modules/core-js/modules/esnext.set.some.js","node_modules/core-js/modules/esnext.set.symmetric-difference.js","node_modules/core-js/modules/esnext.set.union.js","node_modules/core-js/modules/esnext.string.at.js","node_modules/core-js/modules/esnext.string.code-points.js","node_modules/core-js/modules/es.string.match-all.js","node_modules/core-js/modules/es.string.replace-all.js","node_modules/core-js/modules/esnext.symbol.dispose.js","node_modules/core-js/modules/esnext.symbol.observable.js","node_modules/core-js/modules/esnext.symbol.pattern-match.js","node_modules/core-js/modules/esnext.weak-map.delete-all.js","node_modules/core-js/modules/esnext.weak-map.from.js","node_modules/core-js/modules/esnext.weak-map.of.js","node_modules/core-js/modules/esnext.weak-set.add-all.js","node_modules/core-js/modules/esnext.weak-set.delete-all.js","node_modules/core-js/modules/esnext.weak-set.from.js","node_modules/core-js/modules/esnext.weak-set.of.js","node_modules/core-js/modules/web.dom-collections.for-each.js","node_modules/core-js/internals/dom-iterables.js","node_modules/core-js/internals/dom-token-list-prototype.js","node_modules/core-js/internals/array-for-each.js","node_modules/core-js/modules/web.dom-collections.iterator.js","node_modules/core-js/modules/web.immediate.js","node_modules/core-js/modules/web.queue-microtask.js","node_modules/core-js/modules/web.url.js","node_modules/core-js/internals/native-url.js","node_modules/core-js/internals/string-punycode-to-ascii.js","node_modules/core-js/modules/web.url-search-params.js","node_modules/core-js/internals/validate-arguments-length.js","node_modules/core-js/modules/web.url.to-json.js","node_modules/mdn-polyfills/Node.prototype.append.js","node_modules/mdn-polyfills/Node.prototype.prepend.js","src/app/script/app/kl-app.ts","src/app/script/klecks/kl.ts","src/app/script/klecks/history/kl-history.ts","src/app/script/klecks/ui/modals/popup.ts","src/app/script/klecks/ui/modals/modal-count.ts","src/app/script/bb/bb.ts","src/app/script/bb/input/event-listener.ts","src/app/script/bb/base/browser.ts","src/app/script/bb/base/create-canvas.ts","src/app/script/bb/base/base.ts","src/app/script/bb/input/key-listener.ts","src/app/script/bb/input/pointer-listener.ts","src/app/script/bb/math/math.ts","src/app/script/bb/input/event-chain.ts","src/app/script/bb/base/canvas.ts","src/app/script/bb/math/matrix.ts","src/app/script/bb/math/vec2.ts","src/app/script/bb/math/line.ts","src/app/script/bb/color/color.ts","src/app/script/bb/base/ui.ts","src/app/script/bb/base/bb-log.ts","src/app/script/bb/base/local-storage.ts","node_modules/@parcel/runtime-js/lib/runtime-34832b43d0ebd3bf.js","node_modules/@parcel/runtime-js/lib/runtime-a96f6567e6dac4f3.js","src/app/script/klecks/ui/base-components/checkbox.ts","src/app/script/klecks/ui/base-components/input.ts","src/app/script/klecks/ui/base-components/select.ts","src/app/script/klecks/ui/base-components/image-toggle.ts","src/app/script/klecks/ui/base-components/image-radio-list.ts","src/app/script/klecks/ui/base-components/pen-pressure-toggle.ts","node_modules/@parcel/runtime-js/lib/runtime-065238818b5d6d26.js","src/app/script/klecks/ui/base-components/kl-slider.ts","src/app/script/klecks/ui/base-components/slider-falloff.ts","src/app/script/klecks/ui/modals/color-slider-hex-dialog.ts","node_modules/@parcel/runtime-js/lib/runtime-ce95b2abc71314b0.js","src/app/script/klecks/ui/base-components/kl-color-slider.ts","node_modules/@parcel/runtime-js/lib/runtime-e7bece06ac3b91da.js","src/app/script/klecks/ui/base-components/kl-color-slider-small.ts","src/app/script/klecks/ui/base-components/point-slider.ts","src/app/script/klecks/ui/base-components/color-options.ts","src/app/script/klecks/ui/base-components/options.ts","src/app/script/klecks/ui/components/status-overlay.ts","node_modules/@parcel/runtime-js/lib/runtime-76fc4a9796871f89.js","src/app/script/klecks/ui/modals/export-dialog-deprecated.ts","src/app/script/klecks/ui/components/crop-copy.ts","src/app/script/klecks/ui/modals/clipboard-dialog.ts","src/app/script/klecks/ui/tool-tabs/kl-layer-manager.ts","node_modules/@parcel/runtime-js/lib/runtime-9e9c6514323b50ff.js","node_modules/@parcel/runtime-js/lib/runtime-f141aefb87a862aa.js","node_modules/@parcel/runtime-js/lib/runtime-e93ed5f4a72fe388.js","node_modules/@parcel/runtime-js/lib/runtime-e1e96fa0dcd63695.js","node_modules/@parcel/runtime-js/lib/runtime-2d2417fe7f53ff5b.js","src/app/script/klecks/canvas/kl-canvas.ts","src/app/script/klecks/image-operations/flood-fill.ts","src/app/script/klecks/image-operations/shape-tool.ts","src/app/script/klecks/image-operations/render-text.ts","src/app/script/klecks/canvas/draw-project.ts","src/app/script/klecks/canvas/translate-blending.ts","src/app/script/klecks/canvas-ui/workspace-svg-overlay.ts","src/app/script/klecks/canvas-ui/kl-canvas-workspace.ts","node_modules/@parcel/runtime-js/lib/runtime-ce6158b179cda36d.js","node_modules/@parcel/runtime-js/lib/runtime-9180b336d2c14eb8.js","node_modules/@parcel/runtime-js/lib/runtime-e98ceba16f4f3e8c.js","node_modules/@parcel/runtime-js/lib/runtime-1c4e2d66dbd3cd26.js","src/app/script/klecks/canvas-ui/canvas-preview.ts","src/app/script/klecks/ui/components/free-transform.ts","node_modules/@parcel/runtime-js/lib/runtime-7b1b46c773a5d5de.js","src/app/script/klecks/ui/components/free-transform-canvas.ts","src/app/script/klecks/ui/components/cropper.ts","src/app/script/klecks/ui/components/layer-preview.ts","src/app/script/klecks/ui/components/fitted-image.ts","src/app/script/klecks/ui/modals/show-import-as-layer-dialog.ts","src/app/script/klecks/ui/components/kl-image-dropper.ts","src/app/script/klecks/ui/components/overlay-toolspace.ts","src/app/script/klecks/ui/components/toolspace-top-row.ts","node_modules/@parcel/runtime-js/lib/runtime-c595ccae60beff87.js","node_modules/@parcel/runtime-js/lib/runtime-e5d7180bbee5b536.js","node_modules/@parcel/runtime-js/lib/runtime-6c52a4e8d76ec49b.js","node_modules/@parcel/runtime-js/lib/runtime-fa73233744fc505c.js","node_modules/@parcel/runtime-js/lib/runtime-b34e92e9fb9b8c68.js","node_modules/@parcel/runtime-js/lib/runtime-8a2022a1c05c8770.js","src/app/script/klecks/ui/components/tool-dropdown.ts","node_modules/@parcel/runtime-js/lib/runtime-760df77bff0950f0.js","node_modules/@parcel/runtime-js/lib/runtime-ff3da4d7dabee86d.js","node_modules/@parcel/runtime-js/lib/runtime-297f8366ec2375c9.js","node_modules/@parcel/runtime-js/lib/runtime-d831990ac91a582d.js","node_modules/@parcel/runtime-js/lib/runtime-621488e8bcab6d4d.js","src/app/script/klecks/ui/components/toolspace-tool-row.ts","node_modules/@parcel/runtime-js/lib/runtime-7355152122a84936.js","node_modules/@parcel/runtime-js/lib/runtime-81519c452bdfbaa9.js","node_modules/@parcel/runtime-js/lib/runtime-3fc59c96423b70ad.js","node_modules/@parcel/runtime-js/lib/runtime-1eef10cb07c9c851.js","src/app/script/klecks/ui/components/toolspace-stabilizer-row.ts","src/app/script/klecks/ui/components/tab-row.ts","node_modules/@parcel/runtime-js/lib/runtime-b9f67aff2ffaa235.js","src/app/script/klecks/ui/tool-tabs/hand-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-4486cf75fca81822.js","src/app/script/klecks/ui/tool-tabs/fill-ui.ts","src/app/script/klecks/ui/tool-tabs/text-ui.ts","src/app/script/klecks/ui/tool-tabs/shape-ui.ts","src/app/script/klecks/ui/modals/new-image-dialog.ts","src/app/script/klecks/ui/components/toolspace-collapser.ts","node_modules/@parcel/runtime-js/lib/runtime-3ca3a85d3436a84f.js","src/app/script/klecks/ui/modals/text-tool-dialog.ts","node_modules/@parcel/runtime-js/lib/runtime-47401ec572d2cfcf.js","node_modules/@parcel/runtime-js/lib/runtime-6476cf999a0e75d3.js","node_modules/@parcel/runtime-js/lib/runtime-4ee49cef2a1bfd51.js","node_modules/@parcel/runtime-js/lib/runtime-01d9fe07522d7373.js","node_modules/@parcel/runtime-js/lib/runtime-8450ca7f4e68dde7.js","src/app/script/klecks/ui/modals/show-import-image-dialog.ts","src/app/script/klecks/storage/psd.ts","src/app/script/klecks/storage/indexed-db.ts","src/app/script/klecks/filters/filters.ts","node_modules/@parcel/runtime-js/lib/runtime-08ec85fc3ea564e8.js","node_modules/@parcel/runtime-js/lib/runtime-c105dce751d9b16c.js","node_modules/@parcel/runtime-js/lib/runtime-272cd0cc0051d99c.js","node_modules/@parcel/runtime-js/lib/runtime-d623cec3e031c802.js","node_modules/@parcel/runtime-js/lib/runtime-4aa563d1de55ad17.js","node_modules/@parcel/runtime-js/lib/runtime-acf5209c71eb3497.js","node_modules/@parcel/runtime-js/lib/runtime-726a62492af9f94e.js","node_modules/@parcel/runtime-js/lib/runtime-f1cff4f2714da535.js","node_modules/@parcel/runtime-js/lib/runtime-06b47f2ffca8a188.js","node_modules/@parcel/runtime-js/lib/runtime-866a2902b0cdf580.js","node_modules/@parcel/runtime-js/lib/runtime-3b4878106cdf1b9c.js","node_modules/@parcel/runtime-js/lib/runtime-02847deebefdd0a7.js","node_modules/@parcel/runtime-js/lib/runtime-3dce3f08da564a07.js","src/app/script/klecks/brushes/brushes.ts","src/app/script/klecks/brushes/pen-brush.ts","src/app/script/klecks/brushes/brushes-common.ts","src/app/script/klecks/brushes/alphas/brush-alphas.ts","src/app/script/bb/math/perlin.ts","src/app/script/klecks/brushes/blend-brush.ts","src/app/script/klecks/brushes/sketchy-brush.ts","src/app/script/klecks/brushes/pixel-brush.ts","src/app/script/klecks/brushes/eraser-brush.ts","src/app/script/klecks/brushes/smudge-brush.ts","src/app/script/klecks/brushes/chemy-brush.ts","src/app/script/klecks/brushes-ui/brushes-ui.ts","src/app/script/klecks/brushes-ui/pen-brush-ui.ts","src/app/script/klecks/brushes-ui/brushes-consts.ts","node_modules/@parcel/runtime-js/lib/runtime-f5fee83b55dfe524.js","src/app/script/klecks/brushes-ui/blend-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-c1ff462122383f3a.js","src/app/script/klecks/brushes-ui/sketchy-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-c362cafb743e4bf7.js","src/app/script/klecks/brushes-ui/pixel-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-9083363aed84d015.js","src/app/script/klecks/brushes-ui/eraser-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-72d61ca9dbc6379a.js","src/app/script/klecks/brushes-ui/smudge-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-2e54934a27c8b910.js","src/app/script/klecks/brushes-ui/chemy-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-a3466c6b7be08d45.js","src/app/script/klecks/ui/base-components/box-toggle.ts","src/app/script/klecks/ui/modals/show-iframe-popup.ts","src/app/script/klecks/ui/base-components/radio-list.ts","src/app/script/klecks/ui/components/browser-storage-ui.ts","src/app/script/klecks/storage/project-store.ts","src/app/script/klecks/storage/project-converter.ts","src/app/script/klecks/storage/base-64-to-blob.ts","src/app/script/klecks/ui/tool-tabs/file-tab.ts","node_modules/@parcel/runtime-js/lib/runtime-174f5efa9e6f0131.js","src/app/script/klecks/ui/tool-tabs/filter-tab.ts","src/app/script/klecks/ui/modals/imgur-upload.ts","node_modules/@parcel/runtime-js/lib/runtime-257b8f01a8ca9ad6.js","src/app/script/klecks/storage/ag-psd-wrapper.ts","node_modules/@parcel/runtime-js/lib/runtime-5ea32053680ef652.js","src/app/script/klecks/ui/components/save-reminder.ts","src/app/script/klecks/storage/save-to-computer.ts","node_modules/file-saver/src/FileSaver.js","src/app/script/klecks/history/undo-redo-catchup.ts","src/app/script/klecks/brushes-ui/brush-setting-service.ts","src/app/script/klecks/ui/tool-tabs/settings-tab.ts","node_modules/@parcel/runtime-js/lib/runtime-3e3712af4386deba.js","node_modules/@parcel/runtime-js/lib/runtime-050615743b2088cc.js","node_modules/@parcel/runtime-js/lib/runtime-4135c6b241ed0f39.js","src/app/script/klecks/ui/components/toolspace-scroller.ts","src/app/script/embed/toolspace-top-row.ts","src/app/script/klecks/filters/filters-lazy.ts","src/app/script/klecks/filters/gl-brightness-contrast.ts","src/app/script/klecks/filters/filters-consts.ts","src/app/script/klecks/filters/shared-gl-fx.ts","src/app/script-vendor/glfx.ts","src/app/script/klecks/filters/crop-extend.ts","src/app/script/klecks/filters/gl-curves.ts","src/app/script/klecks/filters/flip.ts","src/app/script/klecks/filters/gl-perspective.ts","node_modules/@parcel/runtime-js/lib/runtime-0b614230dd5a2fbc.js","src/app/script/klecks/filters/gl-hue-saturation.ts","src/app/script/klecks/filters/invert.ts","src/app/script/klecks/filters/resize.ts","src/app/script/klecks/filters/gl-tilt-shift.ts","src/app/script/klecks/filters/rotate.ts","node_modules/@parcel/runtime-js/lib/runtime-c388461235ee692d.js","src/app/script/klecks/filters/transform.ts","src/app/script/klecks/filters/gl-blur.ts","src/app/script/klecks/filters/gl-unsharp-mask.ts","src/app/script/klecks/filters/to-alpha.ts","src/app/script/klecks/storage/kl-canvas-to-psd-blob.ts","node_modules/@parcel/runtime-js/lib/runtime-fe04d655c2a3180f.js","node_modules/@parcel/runtime-js/lib/runtime-f15ea15a7900b9a3.js"],"sourcesContent":["import './polyfills';\r\nimport {KlApp} from './app/kl-app';\r\nimport {IKlProject} from './klecks/kl.types';\r\nimport {SaveReminder} from './klecks/ui/components/save-reminder';\r\nimport {klHistory} from './klecks/history/kl-history';\r\nimport {klPsdToKlProject, readPsd} from './klecks/storage/psd';\r\nimport {LANG} from './language/language';\r\n\r\nexport interface IEmbedParams {\r\n    project?: IKlProject,\r\n    psdBlob?: Blob,\r\n    onSubmit: (onSuccess: () => void, onError: () => void) => void;\r\n    embedUrl: string;\r\n    logoImg?: any;\r\n    bottomBar?: HTMLElement;\r\n    aboutEl?: HTMLElement;\r\n}\r\n\r\nexport interface IReadPSD {\r\n    blob: Blob;\r\n    callback: (k: IKlProject) => void;\r\n}\r\n\r\nexport function Embed(p: IEmbedParams) {\r\n\r\n    let isInitialized: boolean = false;\r\n    let klApp;\r\n    const psdQueue: IReadPSD[] = []; // queue of psds waiting while ag-psd is loading\r\n    let agPsd: any | 'error';\r\n\r\n    let loadingScreenEl = document.getElementById(\"loading-screen\");\r\n    let loadingScreenTextEl = document.getElementById(\"loading-screen-text\");\r\n    if (loadingScreenTextEl) {\r\n        loadingScreenTextEl.textContent = LANG('embed-init-waiting');\r\n    }\r\n\r\n    function onProjectReady(project: IKlProject) {\r\n        try {\r\n            if (isInitialized) {\r\n                throw new Error('Already called openProject');\r\n            }\r\n            isInitialized = true;\r\n\r\n            const saveReminder = new SaveReminder(\r\n                klHistory,\r\n                false,\r\n                false,\r\n                () => {},\r\n                () => klApp ? klApp.isDrawing() : false,\r\n            );\r\n            klApp = new KlApp(\r\n                project,\r\n                {\r\n                    saveReminder,\r\n                    bottomBar: p.bottomBar,\r\n                    aboutEl: p.aboutEl,\r\n                    embed: {\r\n                        url: p.embedUrl,\r\n                        onSubmit: p.onSubmit,\r\n                    }\r\n                }\r\n            );\r\n            saveReminder.init();\r\n\r\n            if (loadingScreenEl && loadingScreenEl.parentNode) {\r\n                loadingScreenEl.parentNode.removeChild(loadingScreenEl);\r\n            }\r\n            loadingScreenEl = null;\r\n            loadingScreenTextEl = null;\r\n\r\n            document.body.appendChild(klApp.getEl());\r\n        } catch (e) {\r\n            if (loadingScreenTextEl) {\r\n                loadingScreenTextEl.textContent = '❌ ' + e;\r\n            }\r\n            if (loadingScreenEl) {\r\n                loadingScreenEl.className += 'loading-screen-error';\r\n            }\r\n            console.error(e);\r\n        }\r\n    }\r\n\r\n    if (p.project) {\r\n        onProjectReady(p.project);\r\n    }\r\n    this.openProject = onProjectReady;\r\n    this.initError = (error: string) => {\r\n        if (loadingScreenTextEl) {\r\n            loadingScreenTextEl.textContent = '❌ ' + error;\r\n        }\r\n        if (loadingScreenEl) {\r\n            loadingScreenEl.className += 'loading-screen-error';\r\n        }\r\n    };\r\n    this.getPNG = (): Blob => {\r\n        if (!klApp) {\r\n            throw new Error('App not initialized');\r\n        }\r\n        return klApp.getPNG();\r\n    };\r\n    this.getPSD = async (): Promise<Blob> => {\r\n        if (!klApp) {\r\n            throw new Error('App not initialized');\r\n        }\r\n        return await klApp.getPSD();\r\n    };\r\n    this.readPSDs = (psds: IReadPSD[]) => {\r\n        if (psds.length === 0) {\r\n            return;\r\n        }\r\n\r\n        const readItem = (item: IReadPSD) => {\r\n            try {\r\n                const psd = agPsd.readPsd(item.blob);\r\n                const project = klPsdToKlProject(readPsd(psd));\r\n                item.callback(project);\r\n            } catch (e) {\r\n                console.error('failed to read psd', e);\r\n                item.callback(null);\r\n            }\r\n        };\r\n\r\n        if (!agPsd) {\r\n            if (psdQueue.length === 0) {\r\n                // load ag-psd\r\n                (async () => {\r\n                    try {\r\n                        agPsd = await import('ag-psd');\r\n                    } catch (e) {\r\n                        agPsd = 'error';\r\n                    }\r\n                    while (psdQueue.length) {\r\n                        readItem(psdQueue.shift());\r\n                    }\r\n                })();\r\n            }\r\n            psds.forEach(item => {\r\n                psdQueue.push(item);\r\n            });\r\n        } else {\r\n            psds.forEach(readItem);\r\n        }\r\n    };\r\n}","import 'core-js';\r\nimport 'mdn-polyfills/Node.prototype.append';\r\nimport 'mdn-polyfills/Node.prototype.prepend';\r\n\r\nif (!('scrollTo' in Element.prototype)) {\r\n    Object.defineProperty(Element.prototype, 'scrollTo', {\r\n        value: function (x, y) {\r\n            this.scrollLeft = x;\r\n            this.scrollTop = y;\r\n        }\r\n    });\r\n}\r\n\r\nif (!('scrollBy' in Element.prototype)) {\r\n    Object.defineProperty(Element.prototype, 'scrollBy', {\r\n        value: function (x, y) {\r\n            this.scrollLeft += x;\r\n            this.scrollTop += y;\r\n        }\r\n    });\r\n}\r\n\r\n// sometimes Android WebView has no localStorage\r\nif (!('localStorage' in window)) {\r\n    try {\r\n        window['localStorage'] = {\r\n            getItem: () => null,\r\n            setItem: () => {},\r\n            removeItem: () => {},\r\n        } as any;\r\n    } catch (e) {\r\n        // maybe it doesn't let me set this\r\n    }\r\n}","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar apply = require('../internals/function-apply');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar IS_PURE = require('../internals/is-pure');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\nvar fails = require('../internals/fails');\nvar hasOwn = require('../internals/has-own-property');\nvar isArray = require('../internals/is-array');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar isSymbol = require('../internals/is-symbol');\nvar anObject = require('../internals/an-object');\nvar toObject = require('../internals/to-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar $toString = require('../internals/to-string');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar nativeObjectCreate = require('../internals/object-create');\nvar objectKeys = require('../internals/object-keys');\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertyNamesExternal = require('../internals/object-get-own-property-names-external');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar definePropertyModule = require('../internals/object-define-property');\nvar definePropertiesModule = require('../internals/object-define-properties');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar arraySlice = require('../internals/array-slice');\nvar redefine = require('../internals/redefine');\nvar shared = require('../internals/shared');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar uid = require('../internals/uid');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar wrappedWellKnownSymbolModule = require('../internals/well-known-symbol-wrapped');\nvar defineWellKnownSymbol = require('../internals/define-well-known-symbol');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar InternalStateModule = require('../internals/internal-state');\nvar $forEach = require('../internals/array-iteration').forEach;\n\nvar HIDDEN = sharedKey('hidden');\nvar SYMBOL = 'Symbol';\nvar PROTOTYPE = 'prototype';\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\n\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(SYMBOL);\n\nvar ObjectPrototype = Object[PROTOTYPE];\nvar $Symbol = global.Symbol;\nvar SymbolPrototype = $Symbol && $Symbol[PROTOTYPE];\nvar TypeError = global.TypeError;\nvar QObject = global.QObject;\nvar $stringify = getBuiltIn('JSON', 'stringify');\nvar nativeGetOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\nvar nativeDefineProperty = definePropertyModule.f;\nvar nativeGetOwnPropertyNames = getOwnPropertyNamesExternal.f;\nvar nativePropertyIsEnumerable = propertyIsEnumerableModule.f;\nvar push = uncurryThis([].push);\n\nvar AllSymbols = shared('symbols');\nvar ObjectPrototypeSymbols = shared('op-symbols');\nvar StringToSymbolRegistry = shared('string-to-symbol-registry');\nvar SymbolToStringRegistry = shared('symbol-to-string-registry');\nvar WellKnownSymbolsStore = shared('wks');\n\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar USE_SETTER = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDescriptor = DESCRIPTORS && fails(function () {\n  return nativeObjectCreate(nativeDefineProperty({}, 'a', {\n    get: function () { return nativeDefineProperty(this, 'a', { value: 7 }).a; }\n  })).a != 7;\n}) ? function (O, P, Attributes) {\n  var ObjectPrototypeDescriptor = nativeGetOwnPropertyDescriptor(ObjectPrototype, P);\n  if (ObjectPrototypeDescriptor) delete ObjectPrototype[P];\n  nativeDefineProperty(O, P, Attributes);\n  if (ObjectPrototypeDescriptor && O !== ObjectPrototype) {\n    nativeDefineProperty(ObjectPrototype, P, ObjectPrototypeDescriptor);\n  }\n} : nativeDefineProperty;\n\nvar wrap = function (tag, description) {\n  var symbol = AllSymbols[tag] = nativeObjectCreate(SymbolPrototype);\n  setInternalState(symbol, {\n    type: SYMBOL,\n    tag: tag,\n    description: description\n  });\n  if (!DESCRIPTORS) symbol.description = description;\n  return symbol;\n};\n\nvar $defineProperty = function defineProperty(O, P, Attributes) {\n  if (O === ObjectPrototype) $defineProperty(ObjectPrototypeSymbols, P, Attributes);\n  anObject(O);\n  var key = toPropertyKey(P);\n  anObject(Attributes);\n  if (hasOwn(AllSymbols, key)) {\n    if (!Attributes.enumerable) {\n      if (!hasOwn(O, HIDDEN)) nativeDefineProperty(O, HIDDEN, createPropertyDescriptor(1, {}));\n      O[HIDDEN][key] = true;\n    } else {\n      if (hasOwn(O, HIDDEN) && O[HIDDEN][key]) O[HIDDEN][key] = false;\n      Attributes = nativeObjectCreate(Attributes, { enumerable: createPropertyDescriptor(0, false) });\n    } return setSymbolDescriptor(O, key, Attributes);\n  } return nativeDefineProperty(O, key, Attributes);\n};\n\nvar $defineProperties = function defineProperties(O, Properties) {\n  anObject(O);\n  var properties = toIndexedObject(Properties);\n  var keys = objectKeys(properties).concat($getOwnPropertySymbols(properties));\n  $forEach(keys, function (key) {\n    if (!DESCRIPTORS || call($propertyIsEnumerable, properties, key)) $defineProperty(O, key, properties[key]);\n  });\n  return O;\n};\n\nvar $create = function create(O, Properties) {\n  return Properties === undefined ? nativeObjectCreate(O) : $defineProperties(nativeObjectCreate(O), Properties);\n};\n\nvar $propertyIsEnumerable = function propertyIsEnumerable(V) {\n  var P = toPropertyKey(V);\n  var enumerable = call(nativePropertyIsEnumerable, this, P);\n  if (this === ObjectPrototype && hasOwn(AllSymbols, P) && !hasOwn(ObjectPrototypeSymbols, P)) return false;\n  return enumerable || !hasOwn(this, P) || !hasOwn(AllSymbols, P) || hasOwn(this, HIDDEN) && this[HIDDEN][P]\n    ? enumerable : true;\n};\n\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(O, P) {\n  var it = toIndexedObject(O);\n  var key = toPropertyKey(P);\n  if (it === ObjectPrototype && hasOwn(AllSymbols, key) && !hasOwn(ObjectPrototypeSymbols, key)) return;\n  var descriptor = nativeGetOwnPropertyDescriptor(it, key);\n  if (descriptor && hasOwn(AllSymbols, key) && !(hasOwn(it, HIDDEN) && it[HIDDEN][key])) {\n    descriptor.enumerable = true;\n  }\n  return descriptor;\n};\n\nvar $getOwnPropertyNames = function getOwnPropertyNames(O) {\n  var names = nativeGetOwnPropertyNames(toIndexedObject(O));\n  var result = [];\n  $forEach(names, function (key) {\n    if (!hasOwn(AllSymbols, key) && !hasOwn(hiddenKeys, key)) push(result, key);\n  });\n  return result;\n};\n\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(O) {\n  var IS_OBJECT_PROTOTYPE = O === ObjectPrototype;\n  var names = nativeGetOwnPropertyNames(IS_OBJECT_PROTOTYPE ? ObjectPrototypeSymbols : toIndexedObject(O));\n  var result = [];\n  $forEach(names, function (key) {\n    if (hasOwn(AllSymbols, key) && (!IS_OBJECT_PROTOTYPE || hasOwn(ObjectPrototype, key))) {\n      push(result, AllSymbols[key]);\n    }\n  });\n  return result;\n};\n\n// `Symbol` constructor\n// https://tc39.es/ecma262/#sec-symbol-constructor\nif (!NATIVE_SYMBOL) {\n  $Symbol = function Symbol() {\n    if (isPrototypeOf(SymbolPrototype, this)) throw TypeError('Symbol is not a constructor');\n    var description = !arguments.length || arguments[0] === undefined ? undefined : $toString(arguments[0]);\n    var tag = uid(description);\n    var setter = function (value) {\n      if (this === ObjectPrototype) call(setter, ObjectPrototypeSymbols, value);\n      if (hasOwn(this, HIDDEN) && hasOwn(this[HIDDEN], tag)) this[HIDDEN][tag] = false;\n      setSymbolDescriptor(this, tag, createPropertyDescriptor(1, value));\n    };\n    if (DESCRIPTORS && USE_SETTER) setSymbolDescriptor(ObjectPrototype, tag, { configurable: true, set: setter });\n    return wrap(tag, description);\n  };\n\n  SymbolPrototype = $Symbol[PROTOTYPE];\n\n  redefine(SymbolPrototype, 'toString', function toString() {\n    return getInternalState(this).tag;\n  });\n\n  redefine($Symbol, 'withoutSetter', function (description) {\n    return wrap(uid(description), description);\n  });\n\n  propertyIsEnumerableModule.f = $propertyIsEnumerable;\n  definePropertyModule.f = $defineProperty;\n  definePropertiesModule.f = $defineProperties;\n  getOwnPropertyDescriptorModule.f = $getOwnPropertyDescriptor;\n  getOwnPropertyNamesModule.f = getOwnPropertyNamesExternal.f = $getOwnPropertyNames;\n  getOwnPropertySymbolsModule.f = $getOwnPropertySymbols;\n\n  wrappedWellKnownSymbolModule.f = function (name) {\n    return wrap(wellKnownSymbol(name), name);\n  };\n\n  if (DESCRIPTORS) {\n    // https://github.com/tc39/proposal-Symbol-description\n    nativeDefineProperty(SymbolPrototype, 'description', {\n      configurable: true,\n      get: function description() {\n        return getInternalState(this).description;\n      }\n    });\n    if (!IS_PURE) {\n      redefine(ObjectPrototype, 'propertyIsEnumerable', $propertyIsEnumerable, { unsafe: true });\n    }\n  }\n}\n\n$({ global: true, wrap: true, forced: !NATIVE_SYMBOL, sham: !NATIVE_SYMBOL }, {\n  Symbol: $Symbol\n});\n\n$forEach(objectKeys(WellKnownSymbolsStore), function (name) {\n  defineWellKnownSymbol(name);\n});\n\n$({ target: SYMBOL, stat: true, forced: !NATIVE_SYMBOL }, {\n  // `Symbol.for` method\n  // https://tc39.es/ecma262/#sec-symbol.for\n  'for': function (key) {\n    var string = $toString(key);\n    if (hasOwn(StringToSymbolRegistry, string)) return StringToSymbolRegistry[string];\n    var symbol = $Symbol(string);\n    StringToSymbolRegistry[string] = symbol;\n    SymbolToStringRegistry[symbol] = string;\n    return symbol;\n  },\n  // `Symbol.keyFor` method\n  // https://tc39.es/ecma262/#sec-symbol.keyfor\n  keyFor: function keyFor(sym) {\n    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol');\n    if (hasOwn(SymbolToStringRegistry, sym)) return SymbolToStringRegistry[sym];\n  },\n  useSetter: function () { USE_SETTER = true; },\n  useSimple: function () { USE_SETTER = false; }\n});\n\n$({ target: 'Object', stat: true, forced: !NATIVE_SYMBOL, sham: !DESCRIPTORS }, {\n  // `Object.create` method\n  // https://tc39.es/ecma262/#sec-object.create\n  create: $create,\n  // `Object.defineProperty` method\n  // https://tc39.es/ecma262/#sec-object.defineproperty\n  defineProperty: $defineProperty,\n  // `Object.defineProperties` method\n  // https://tc39.es/ecma262/#sec-object.defineproperties\n  defineProperties: $defineProperties,\n  // `Object.getOwnPropertyDescriptor` method\n  // https://tc39.es/ecma262/#sec-object.getownpropertydescriptors\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor\n});\n\n$({ target: 'Object', stat: true, forced: !NATIVE_SYMBOL }, {\n  // `Object.getOwnPropertyNames` method\n  // https://tc39.es/ecma262/#sec-object.getownpropertynames\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // `Object.getOwnPropertySymbols` method\n  // https://tc39.es/ecma262/#sec-object.getownpropertysymbols\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// Chrome 38 and 39 `Object.getOwnPropertySymbols` fails on primitives\n// https://bugs.chromium.org/p/v8/issues/detail?id=3443\n$({ target: 'Object', stat: true, forced: fails(function () { getOwnPropertySymbolsModule.f(1); }) }, {\n  getOwnPropertySymbols: function getOwnPropertySymbols(it) {\n    return getOwnPropertySymbolsModule.f(toObject(it));\n  }\n});\n\n// `JSON.stringify` method behavior with symbols\n// https://tc39.es/ecma262/#sec-json.stringify\nif ($stringify) {\n  var FORCED_JSON_STRINGIFY = !NATIVE_SYMBOL || fails(function () {\n    var symbol = $Symbol();\n    // MS Edge converts symbol values to JSON as {}\n    return $stringify([symbol]) != '[null]'\n      // WebKit converts symbol values to JSON as null\n      || $stringify({ a: symbol }) != '{}'\n      // V8 throws on boxed symbols\n      || $stringify(Object(symbol)) != '{}';\n  });\n\n  $({ target: 'JSON', stat: true, forced: FORCED_JSON_STRINGIFY }, {\n    // eslint-disable-next-line no-unused-vars -- required for `.length`\n    stringify: function stringify(it, replacer, space) {\n      var args = arraySlice(arguments);\n      var $replacer = replacer;\n      if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined\n      if (!isArray(replacer)) replacer = function (key, value) {\n        if (isCallable($replacer)) value = call($replacer, this, key, value);\n        if (!isSymbol(value)) return value;\n      };\n      args[1] = replacer;\n      return apply($stringify, null, args);\n    }\n  });\n}\n\n// `Symbol.prototype[@@toPrimitive]` method\n// https://tc39.es/ecma262/#sec-symbol.prototype-@@toprimitive\nif (!SymbolPrototype[TO_PRIMITIVE]) {\n  var valueOf = SymbolPrototype.valueOf;\n  // eslint-disable-next-line no-unused-vars -- required for .length\n  redefine(SymbolPrototype, TO_PRIMITIVE, function (hint) {\n    // TODO: improve hint logic\n    return call(valueOf, this);\n  });\n}\n// `Symbol.prototype[@@toStringTag]` property\n// https://tc39.es/ecma262/#sec-symbol.prototype-@@tostringtag\nsetToStringTag($Symbol, SYMBOL);\n\nhiddenKeys[HIDDEN] = true;\n","var global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar setGlobal = require('../internals/set-global');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar isForced = require('../internals/is-forced');\n\n/*\n  options.target      - name of the target object\n  options.global      - target is the global object\n  options.stat        - export as static methods of target\n  options.proto       - export as prototype methods of target\n  options.real        - real prototype method for the `pure` version\n  options.forced      - export even if the native feature is available\n  options.bind        - bind methods to the target, required for the `pure` version\n  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n  options.sham        - add a flag to not completely full polyfills\n  options.enumerable  - export as enumerable property\n  options.noTargetGet - prevent calling a getter on target\n  options.name        - the .name of the function if it does not match the key\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || setGlobal(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.noTargetGet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty == typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    // extend global\n    redefine(target, key, sourceProperty, options);\n  }\n};\n","var check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line es/no-global-this -- safe\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  // eslint-disable-next-line no-restricted-globals -- safe\n  check(typeof self == 'object' && self) ||\n  check(typeof global == 'object' && global) ||\n  // eslint-disable-next-line no-new-func -- fallback\n  (function () { return this; })() || Function('return this')();\n","var DESCRIPTORS = require('../internals/descriptors');\nvar call = require('../internals/function-call');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar hasOwn = require('../internals/has-own-property');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\n\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? $getOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPropertyKey(P);\n  if (IE8_DOM_DEFINE) try {\n    return $getOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (hasOwn(O, P)) return createPropertyDescriptor(!call(propertyIsEnumerableModule.f, O, P), O[P]);\n};\n","var fails = require('../internals/fails');\n\n// Detect IE8's incomplete defineProperty implementation\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n});\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n","var NATIVE_BIND = require('../internals/function-bind-native');\n\nvar call = Function.prototype.call;\n\nmodule.exports = NATIVE_BIND ? call.bind(call) : function () {\n  return call.apply(call, arguments);\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  var test = (function () { /* empty */ }).bind();\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return typeof test != 'function' || test.hasOwnProperty('prototype');\n});\n","'use strict';\nvar $propertyIsEnumerable = {}.propertyIsEnumerable;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !$propertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : $propertyIsEnumerable;\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = require('../internals/indexed-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n","var global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar classof = require('../internals/classof-raw');\n\nvar Object = global.Object;\nvar split = uncurryThis(''.split);\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return !Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split(it, '') : Object(it);\n} : Object;\n","var NATIVE_BIND = require('../internals/function-bind-native');\n\nvar FunctionPrototype = Function.prototype;\nvar bind = FunctionPrototype.bind;\nvar call = FunctionPrototype.call;\nvar uncurryThis = NATIVE_BIND && bind.bind(call, call);\n\nmodule.exports = NATIVE_BIND ? function (fn) {\n  return fn && uncurryThis(fn);\n} : function (fn) {\n  return fn && function () {\n    return call.apply(fn, arguments);\n  };\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nvar toString = uncurryThis({}.toString);\nvar stringSlice = uncurryThis(''.slice);\n\nmodule.exports = function (it) {\n  return stringSlice(toString(it), 8, -1);\n};\n","var global = require('../internals/global');\n\nvar TypeError = global.TypeError;\n\n// `RequireObjectCoercible` abstract operation\n// https://tc39.es/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on \" + it);\n  return it;\n};\n","var toPrimitive = require('../internals/to-primitive');\nvar isSymbol = require('../internals/is-symbol');\n\n// `ToPropertyKey` abstract operation\n// https://tc39.es/ecma262/#sec-topropertykey\nmodule.exports = function (argument) {\n  var key = toPrimitive(argument, 'string');\n  return isSymbol(key) ? key : key + '';\n};\n","var global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar isObject = require('../internals/is-object');\nvar isSymbol = require('../internals/is-symbol');\nvar getMethod = require('../internals/get-method');\nvar ordinaryToPrimitive = require('../internals/ordinary-to-primitive');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TypeError = global.TypeError;\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\n\n// `ToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-toprimitive\nmodule.exports = function (input, pref) {\n  if (!isObject(input) || isSymbol(input)) return input;\n  var exoticToPrim = getMethod(input, TO_PRIMITIVE);\n  var result;\n  if (exoticToPrim) {\n    if (pref === undefined) pref = 'default';\n    result = call(exoticToPrim, input, pref);\n    if (!isObject(result) || isSymbol(result)) return result;\n    throw TypeError(\"Can't convert object to primitive value\");\n  }\n  if (pref === undefined) pref = 'number';\n  return ordinaryToPrimitive(input, pref);\n};\n","var isCallable = require('../internals/is-callable');\n\nmodule.exports = function (it) {\n  return typeof it == 'object' ? it !== null : isCallable(it);\n};\n","// `IsCallable` abstract operation\n// https://tc39.es/ecma262/#sec-iscallable\nmodule.exports = function (argument) {\n  return typeof argument == 'function';\n};\n","var global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar isCallable = require('../internals/is-callable');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar Object = global.Object;\n\nmodule.exports = USE_SYMBOL_AS_UID ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  var $Symbol = getBuiltIn('Symbol');\n  return isCallable($Symbol) && isPrototypeOf($Symbol.prototype, Object(it));\n};\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\n\nvar aFunction = function (argument) {\n  return isCallable(argument) ? argument : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(global[namespace]) : global[namespace] && global[namespace][method];\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nmodule.exports = uncurryThis({}.isPrototypeOf);\n","/* eslint-disable es/no-symbol -- required for testing */\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\n\nmodule.exports = NATIVE_SYMBOL\n  && !Symbol.sham\n  && typeof Symbol.iterator == 'symbol';\n","/* eslint-disable es/no-symbol -- required for testing */\nvar V8_VERSION = require('../internals/engine-v8-version');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- required for testing\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  var symbol = Symbol();\n  // Chrome 38 Symbol has incorrect toString conversion\n  // `get-own-property-symbols` polyfill symbols converted to object are not Symbol instances\n  return !String(symbol) || !(Object(symbol) instanceof Symbol) ||\n    // Chrome 38-40 symbols are not inherited from DOM collections prototypes to instances\n    !Symbol.sham && V8_VERSION && V8_VERSION < 41;\n});\n","var global = require('../internals/global');\nvar userAgent = require('../internals/engine-user-agent');\n\nvar process = global.process;\nvar Deno = global.Deno;\nvar versions = process && process.versions || Deno && Deno.version;\nvar v8 = versions && versions.v8;\nvar match, version;\n\nif (v8) {\n  match = v8.split('.');\n  // in old Chrome, versions of V8 isn't V8 = Chrome / 10\n  // but their correct versions are not interesting for us\n  version = match[0] > 0 && match[0] < 4 ? 1 : +(match[0] + match[1]);\n}\n\n// BrowserFS NodeJS `process` polyfill incorrectly set `.v8` to `0.0`\n// so check `userAgent` even if `.v8` exists, but 0\nif (!version && userAgent) {\n  match = userAgent.match(/Edge\\/(\\d+)/);\n  if (!match || match[1] >= 74) {\n    match = userAgent.match(/Chrome\\/(\\d+)/);\n    if (match) version = +match[1];\n  }\n}\n\nmodule.exports = version;\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('navigator', 'userAgent') || '';\n","var aCallable = require('../internals/a-callable');\n\n// `GetMethod` abstract operation\n// https://tc39.es/ecma262/#sec-getmethod\nmodule.exports = function (V, P) {\n  var func = V[P];\n  return func == null ? undefined : aCallable(func);\n};\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar tryToString = require('../internals/try-to-string');\n\nvar TypeError = global.TypeError;\n\n// `Assert: IsCallable(argument) is true`\nmodule.exports = function (argument) {\n  if (isCallable(argument)) return argument;\n  throw TypeError(tryToString(argument) + ' is not a function');\n};\n","var global = require('../internals/global');\n\nvar String = global.String;\n\nmodule.exports = function (argument) {\n  try {\n    return String(argument);\n  } catch (error) {\n    return 'Object';\n  }\n};\n","var global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\n\nvar TypeError = global.TypeError;\n\n// `OrdinaryToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-ordinarytoprimitive\nmodule.exports = function (input, pref) {\n  var fn, val;\n  if (pref === 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  if (isCallable(fn = input.valueOf) && !isObject(val = call(fn, input))) return val;\n  if (pref !== 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var global = require('../internals/global');\nvar shared = require('../internals/shared');\nvar hasOwn = require('../internals/has-own-property');\nvar uid = require('../internals/uid');\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar WellKnownSymbolsStore = shared('wks');\nvar Symbol = global.Symbol;\nvar symbolFor = Symbol && Symbol['for'];\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!hasOwn(WellKnownSymbolsStore, name) || !(NATIVE_SYMBOL || typeof WellKnownSymbolsStore[name] == 'string')) {\n    var description = 'Symbol.' + name;\n    if (NATIVE_SYMBOL && hasOwn(Symbol, name)) {\n      WellKnownSymbolsStore[name] = Symbol[name];\n    } else if (USE_SYMBOL_AS_UID && symbolFor) {\n      WellKnownSymbolsStore[name] = symbolFor(description);\n    } else {\n      WellKnownSymbolsStore[name] = createWellKnownSymbol(description);\n    }\n  } return WellKnownSymbolsStore[name];\n};\n","var IS_PURE = require('../internals/is-pure');\nvar store = require('../internals/shared-store');\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.20.3',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: '© 2014-2022 Denis Pushkarev (zloirock.ru)',\n  license: 'https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE',\n  source: 'https://github.com/zloirock/core-js'\n});\n","module.exports = false;\n","var global = require('../internals/global');\nvar setGlobal = require('../internals/set-global');\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || setGlobal(SHARED, {});\n\nmodule.exports = store;\n","var global = require('../internals/global');\n\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar defineProperty = Object.defineProperty;\n\nmodule.exports = function (key, value) {\n  try {\n    defineProperty(global, key, { value: value, configurable: true, writable: true });\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar toObject = require('../internals/to-object');\n\nvar hasOwnProperty = uncurryThis({}.hasOwnProperty);\n\n// `HasOwnProperty` abstract operation\n// https://tc39.es/ecma262/#sec-hasownproperty\nmodule.exports = Object.hasOwn || function hasOwn(it, key) {\n  return hasOwnProperty(toObject(it), key);\n};\n","var global = require('../internals/global');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar Object = global.Object;\n\n// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nvar id = 0;\nvar postfix = Math.random();\nvar toString = uncurryThis(1.0.toString);\n\nmodule.exports = function (key) {\n  return 'Symbol(' + (key === undefined ? '' : key) + ')_' + toString(++id + postfix, 36);\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar createElement = require('../internals/document-create-element');\n\n// Thanks to IE8 for its funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var global = require('../internals/global');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\nvar V8_PROTOTYPE_DEFINE_BUG = require('../internals/v8-prototype-define-bug');\nvar anObject = require('../internals/an-object');\nvar toPropertyKey = require('../internals/to-property-key');\n\nvar TypeError = global.TypeError;\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar $defineProperty = Object.defineProperty;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nvar ENUMERABLE = 'enumerable';\nvar CONFIGURABLE = 'configurable';\nvar WRITABLE = 'writable';\n\n// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? V8_PROTOTYPE_DEFINE_BUG ? function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (typeof O === 'function' && P === 'prototype' && 'value' in Attributes && WRITABLE in Attributes && !Attributes[WRITABLE]) {\n    var current = $getOwnPropertyDescriptor(O, P);\n    if (current && current[WRITABLE]) {\n      O[P] = Attributes.value;\n      Attributes = {\n        configurable: CONFIGURABLE in Attributes ? Attributes[CONFIGURABLE] : current[CONFIGURABLE],\n        enumerable: ENUMERABLE in Attributes ? Attributes[ENUMERABLE] : current[ENUMERABLE],\n        writable: false\n      };\n    }\n  } return $defineProperty(O, P, Attributes);\n} : $defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return $defineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\n\n// V8 ~ Chrome 36-\n// https://bugs.chromium.org/p/v8/issues/detail?id=3334\nmodule.exports = DESCRIPTORS && fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(function () { /* empty */ }, 'prototype', {\n    value: 42,\n    writable: false\n  }).prototype != 42;\n});\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar String = global.String;\nvar TypeError = global.TypeError;\n\n// `Assert: Type(argument) is Object`\nmodule.exports = function (argument) {\n  if (isObject(argument)) return argument;\n  throw TypeError(String(argument) + ' is not an object');\n};\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar hasOwn = require('../internals/has-own-property');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar setGlobal = require('../internals/set-global');\nvar inspectSource = require('../internals/inspect-source');\nvar InternalStateModule = require('../internals/internal-state');\nvar CONFIGURABLE_FUNCTION_NAME = require('../internals/function-name').CONFIGURABLE;\n\nvar getInternalState = InternalStateModule.get;\nvar enforceInternalState = InternalStateModule.enforce;\nvar TEMPLATE = String(String).split('String');\n\n(module.exports = function (O, key, value, options) {\n  var unsafe = options ? !!options.unsafe : false;\n  var simple = options ? !!options.enumerable : false;\n  var noTargetGet = options ? !!options.noTargetGet : false;\n  var name = options && options.name !== undefined ? options.name : key;\n  var state;\n  if (isCallable(value)) {\n    if (String(name).slice(0, 7) === 'Symbol(') {\n      name = '[' + String(name).replace(/^Symbol\\(([^)]*)\\)/, '$1') + ']';\n    }\n    if (!hasOwn(value, 'name') || (CONFIGURABLE_FUNCTION_NAME && value.name !== name)) {\n      createNonEnumerableProperty(value, 'name', name);\n    }\n    state = enforceInternalState(value);\n    if (!state.source) {\n      state.source = TEMPLATE.join(typeof name == 'string' ? name : '');\n    }\n  }\n  if (O === global) {\n    if (simple) O[key] = value;\n    else setGlobal(key, value);\n    return;\n  } else if (!unsafe) {\n    delete O[key];\n  } else if (!noTargetGet && O[key]) {\n    simple = true;\n  }\n  if (simple) O[key] = value;\n  else createNonEnumerableProperty(O, key, value);\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, 'toString', function toString() {\n  return isCallable(this) && getInternalState(this).source || inspectSource(this);\n});\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar isCallable = require('../internals/is-callable');\nvar store = require('../internals/shared-store');\n\nvar functionToString = uncurryThis(Function.toString);\n\n// this helper broken in `core-js@3.4.1-3.4.4`, so we can't use `shared` helper\nif (!isCallable(store.inspectSource)) {\n  store.inspectSource = function (it) {\n    return functionToString(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n","var NATIVE_WEAK_MAP = require('../internals/native-weak-map');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar hasOwn = require('../internals/has-own-property');\nvar shared = require('../internals/shared-store');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar OBJECT_ALREADY_INITIALIZED = 'Object already initialized';\nvar TypeError = global.TypeError;\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP || shared.state) {\n  var store = shared.state || (shared.state = new WeakMap());\n  var wmget = uncurryThis(store.get);\n  var wmhas = uncurryThis(store.has);\n  var wmset = uncurryThis(store.set);\n  set = function (it, metadata) {\n    if (wmhas(store, it)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    wmset(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    if (hasOwn(it, STATE)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return hasOwn(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return hasOwn(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar inspectSource = require('../internals/inspect-source');\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = isCallable(WeakMap) && /native code/.test(inspectSource(WeakMap));\n","var shared = require('../internals/shared');\nvar uid = require('../internals/uid');\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n","module.exports = {};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar hasOwn = require('../internals/has-own-property');\n\nvar FunctionPrototype = Function.prototype;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getDescriptor = DESCRIPTORS && Object.getOwnPropertyDescriptor;\n\nvar EXISTS = hasOwn(FunctionPrototype, 'name');\n// additional protection from minified / mangled / dropped function names\nvar PROPER = EXISTS && (function something() { /* empty */ }).name === 'something';\nvar CONFIGURABLE = EXISTS && (!DESCRIPTORS || (DESCRIPTORS && getDescriptor(FunctionPrototype, 'name').configurable));\n\nmodule.exports = {\n  EXISTS: EXISTS,\n  PROPER: PROPER,\n  CONFIGURABLE: CONFIGURABLE\n};\n","var hasOwn = require('../internals/has-own-property');\nvar ownKeys = require('../internals/own-keys');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar definePropertyModule = require('../internals/object-define-property');\n\nmodule.exports = function (target, source, exceptions) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!hasOwn(target, key) && !(exceptions && hasOwn(exceptions, key))) {\n      defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n    }\n  }\n};\n","var getBuiltIn = require('../internals/get-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar anObject = require('../internals/an-object');\n\nvar concat = uncurryThis([].concat);\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? concat(keys, getOwnPropertySymbols(it)) : keys;\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n// eslint-disable-next-line es/no-object-getownpropertynames -- safe\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar hasOwn = require('../internals/has-own-property');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar indexOf = require('../internals/array-includes').indexOf;\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar push = uncurryThis([].push);\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !hasOwn(hiddenKeys, key) && hasOwn(O, key) && push(result, key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (hasOwn(O, key = names[i++])) {\n    ~indexOf(result, key) || push(result, key);\n  }\n  return result;\n};\n","var toIndexedObject = require('../internals/to-indexed-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = lengthOfArrayLike(O);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare -- NaN check\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.es/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.es/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n","var toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toIntegerOrInfinity(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n","var ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `ToIntegerOrInfinity` abstract operation\n// https://tc39.es/ecma262/#sec-tointegerorinfinity\nmodule.exports = function (argument) {\n  var number = +argument;\n  // eslint-disable-next-line no-self-compare -- safe\n  return number !== number || number === 0 ? 0 : (number > 0 ? floor : ceil)(number);\n};\n","var toLength = require('../internals/to-length');\n\n// `LengthOfArrayLike` abstract operation\n// https://tc39.es/ecma262/#sec-lengthofarraylike\nmodule.exports = function (obj) {\n  return toLength(obj.length);\n};\n","var toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.es/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toIntegerOrInfinity(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n","// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n","// eslint-disable-next-line es/no-object-getownpropertysymbols -- safe\nexports.f = Object.getOwnPropertySymbols;\n","var fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : isCallable(detection) ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n","var NATIVE_BIND = require('../internals/function-bind-native');\n\nvar FunctionPrototype = Function.prototype;\nvar apply = FunctionPrototype.apply;\nvar call = FunctionPrototype.call;\n\n// eslint-disable-next-line es/no-reflect -- safe\nmodule.exports = typeof Reflect == 'object' && Reflect.apply || (NATIVE_BIND ? call.bind(apply) : function () {\n  return call.apply(apply, arguments);\n});\n","var classof = require('../internals/classof-raw');\n\n// `IsArray` abstract operation\n// https://tc39.es/ecma262/#sec-isarray\n// eslint-disable-next-line es/no-array-isarray -- safe\nmodule.exports = Array.isArray || function isArray(argument) {\n  return classof(argument) == 'Array';\n};\n","var global = require('../internals/global');\nvar classof = require('../internals/classof');\n\nvar String = global.String;\n\nmodule.exports = function (argument) {\n  if (classof(argument) === 'Symbol') throw TypeError('Cannot convert a Symbol value to a string');\n  return String(argument);\n};\n","var global = require('../internals/global');\nvar TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar isCallable = require('../internals/is-callable');\nvar classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar Object = global.Object;\n\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && isCallable(O.callee) ? 'Arguments' : result;\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","/* global ActiveXObject -- old IE, WSH */\nvar anObject = require('../internals/an-object');\nvar definePropertiesModule = require('../internals/object-define-properties');\nvar enumBugKeys = require('../internals/enum-bug-keys');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar html = require('../internals/html');\nvar documentCreateElement = require('../internals/document-create-element');\nvar sharedKey = require('../internals/shared-key');\n\nvar GT = '>';\nvar LT = '<';\nvar PROTOTYPE = 'prototype';\nvar SCRIPT = 'script';\nvar IE_PROTO = sharedKey('IE_PROTO');\n\nvar EmptyConstructor = function () { /* empty */ };\n\nvar scriptTag = function (content) {\n  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;\n};\n\n// Create object with fake `null` prototype: use ActiveX Object with cleared prototype\nvar NullProtoObjectViaActiveX = function (activeXDocument) {\n  activeXDocument.write(scriptTag(''));\n  activeXDocument.close();\n  var temp = activeXDocument.parentWindow.Object;\n  activeXDocument = null; // avoid memory leak\n  return temp;\n};\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar NullProtoObjectViaIFrame = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var JS = 'java' + SCRIPT + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  // https://github.com/zloirock/core-js/issues/475\n  iframe.src = String(JS);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(scriptTag('document.F=Object'));\n  iframeDocument.close();\n  return iframeDocument.F;\n};\n\n// Check for document.domain and active x support\n// No need to use active x approach when document.domain is not set\n// see https://github.com/es-shims/es5-shim/issues/150\n// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n// avoid IE GC bug\nvar activeXDocument;\nvar NullProtoObject = function () {\n  try {\n    activeXDocument = new ActiveXObject('htmlfile');\n  } catch (error) { /* ignore */ }\n  NullProtoObject = typeof document != 'undefined'\n    ? document.domain && activeXDocument\n      ? NullProtoObjectViaActiveX(activeXDocument) // old IE\n      : NullProtoObjectViaIFrame()\n    : NullProtoObjectViaActiveX(activeXDocument); // WSH\n  var length = enumBugKeys.length;\n  while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];\n  return NullProtoObject();\n};\n\nhiddenKeys[IE_PROTO] = true;\n\n// `Object.create` method\n// https://tc39.es/ecma262/#sec-object.create\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    EmptyConstructor[PROTOTYPE] = anObject(O);\n    result = new EmptyConstructor();\n    EmptyConstructor[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = NullProtoObject();\n  return Properties === undefined ? result : definePropertiesModule.f(result, Properties);\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar V8_PROTOTYPE_DEFINE_BUG = require('../internals/v8-prototype-define-bug');\nvar definePropertyModule = require('../internals/object-define-property');\nvar anObject = require('../internals/an-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar objectKeys = require('../internals/object-keys');\n\n// `Object.defineProperties` method\n// https://tc39.es/ecma262/#sec-object.defineproperties\n// eslint-disable-next-line es/no-object-defineproperties -- safe\nexports.f = DESCRIPTORS && !V8_PROTOTYPE_DEFINE_BUG ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var props = toIndexedObject(Properties);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) definePropertyModule.f(O, key = keys[index++], props[key]);\n  return O;\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('document', 'documentElement');\n","/* eslint-disable es/no-object-getownpropertynames -- safe */\nvar classof = require('../internals/classof-raw');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar $getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar arraySlice = require('../internals/array-slice-simple');\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function (it) {\n  try {\n    return $getOwnPropertyNames(it);\n  } catch (error) {\n    return arraySlice(windowNames);\n  }\n};\n\n// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nmodule.exports.f = function getOwnPropertyNames(it) {\n  return windowNames && classof(it) == 'Window'\n    ? getWindowNames(it)\n    : $getOwnPropertyNames(toIndexedObject(it));\n};\n","var global = require('../internals/global');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar createProperty = require('../internals/create-property');\n\nvar Array = global.Array;\nvar max = Math.max;\n\nmodule.exports = function (O, start, end) {\n  var length = lengthOfArrayLike(O);\n  var k = toAbsoluteIndex(start, length);\n  var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n  var result = Array(max(fin - k, 0));\n  for (var n = 0; k < fin; k++, n++) createProperty(result, n, O[k]);\n  result.length = n;\n  return result;\n};\n","'use strict';\nvar toPropertyKey = require('../internals/to-property-key');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPropertyKey(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nmodule.exports = uncurryThis([].slice);\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nexports.f = wellKnownSymbol;\n","var path = require('../internals/path');\nvar hasOwn = require('../internals/has-own-property');\nvar wrappedWellKnownSymbolModule = require('../internals/well-known-symbol-wrapped');\nvar defineProperty = require('../internals/object-define-property').f;\n\nmodule.exports = function (NAME) {\n  var Symbol = path.Symbol || (path.Symbol = {});\n  if (!hasOwn(Symbol, NAME)) defineProperty(Symbol, NAME, {\n    value: wrappedWellKnownSymbolModule.f(NAME)\n  });\n};\n","var global = require('../internals/global');\n\nmodule.exports = global;\n","var defineProperty = require('../internals/object-define-property').f;\nvar hasOwn = require('../internals/has-own-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n\nmodule.exports = function (target, TAG, STATIC) {\n  if (target && !STATIC) target = target.prototype;\n  if (target && !hasOwn(target, TO_STRING_TAG)) {\n    defineProperty(target, TO_STRING_TAG, { configurable: true, value: TAG });\n  }\n};\n","var bind = require('../internals/function-bind-context');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar IndexedObject = require('../internals/indexed-object');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\nvar push = uncurryThis([].push);\n\n// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex, filterReject }` methods implementation\nvar createMethod = function (TYPE) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var IS_FILTER_REJECT = TYPE == 7;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  return function ($this, callbackfn, that, specificCreate) {\n    var O = toObject($this);\n    var self = IndexedObject(O);\n    var boundFunction = bind(callbackfn, that);\n    var length = lengthOfArrayLike(self);\n    var index = 0;\n    var create = specificCreate || arraySpeciesCreate;\n    var target = IS_MAP ? create($this, length) : IS_FILTER || IS_FILTER_REJECT ? create($this, 0) : undefined;\n    var value, result;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      value = self[index];\n      result = boundFunction(value, index, O);\n      if (TYPE) {\n        if (IS_MAP) target[index] = result; // map\n        else if (result) switch (TYPE) {\n          case 3: return true;              // some\n          case 5: return value;             // find\n          case 6: return index;             // findIndex\n          case 2: push(target, value);      // filter\n        } else switch (TYPE) {\n          case 4: return false;             // every\n          case 7: push(target, value);      // filterReject\n        }\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.forEach` method\n  // https://tc39.es/ecma262/#sec-array.prototype.foreach\n  forEach: createMethod(0),\n  // `Array.prototype.map` method\n  // https://tc39.es/ecma262/#sec-array.prototype.map\n  map: createMethod(1),\n  // `Array.prototype.filter` method\n  // https://tc39.es/ecma262/#sec-array.prototype.filter\n  filter: createMethod(2),\n  // `Array.prototype.some` method\n  // https://tc39.es/ecma262/#sec-array.prototype.some\n  some: createMethod(3),\n  // `Array.prototype.every` method\n  // https://tc39.es/ecma262/#sec-array.prototype.every\n  every: createMethod(4),\n  // `Array.prototype.find` method\n  // https://tc39.es/ecma262/#sec-array.prototype.find\n  find: createMethod(5),\n  // `Array.prototype.findIndex` method\n  // https://tc39.es/ecma262/#sec-array.prototype.findIndex\n  findIndex: createMethod(6),\n  // `Array.prototype.filterReject` method\n  // https://github.com/tc39/proposal-array-filtering\n  filterReject: createMethod(7)\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar NATIVE_BIND = require('../internals/function-bind-native');\n\nvar bind = uncurryThis(uncurryThis.bind);\n\n// optional / simple context binding\nmodule.exports = function (fn, that) {\n  aCallable(fn);\n  return that === undefined ? fn : NATIVE_BIND ? bind(fn, that) : function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","var arraySpeciesConstructor = require('../internals/array-species-constructor');\n\n// `ArraySpeciesCreate` abstract operation\n// https://tc39.es/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray, length) {\n  return new (arraySpeciesConstructor(originalArray))(length === 0 ? 0 : length);\n};\n","var global = require('../internals/global');\nvar isArray = require('../internals/is-array');\nvar isConstructor = require('../internals/is-constructor');\nvar isObject = require('../internals/is-object');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\nvar Array = global.Array;\n\n// a part of `ArraySpeciesCreate` abstract operation\n// https://tc39.es/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray) {\n  var C;\n  if (isArray(originalArray)) {\n    C = originalArray.constructor;\n    // cross-realm fallback\n    if (isConstructor(C) && (C === Array || isArray(C.prototype))) C = undefined;\n    else if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return C === undefined ? Array : C;\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\nvar classof = require('../internals/classof');\nvar getBuiltIn = require('../internals/get-built-in');\nvar inspectSource = require('../internals/inspect-source');\n\nvar noop = function () { /* empty */ };\nvar empty = [];\nvar construct = getBuiltIn('Reflect', 'construct');\nvar constructorRegExp = /^\\s*(?:class|function)\\b/;\nvar exec = uncurryThis(constructorRegExp.exec);\nvar INCORRECT_TO_STRING = !constructorRegExp.exec(noop);\n\nvar isConstructorModern = function isConstructor(argument) {\n  if (!isCallable(argument)) return false;\n  try {\n    construct(noop, empty, argument);\n    return true;\n  } catch (error) {\n    return false;\n  }\n};\n\nvar isConstructorLegacy = function isConstructor(argument) {\n  if (!isCallable(argument)) return false;\n  switch (classof(argument)) {\n    case 'AsyncFunction':\n    case 'GeneratorFunction':\n    case 'AsyncGeneratorFunction': return false;\n  }\n  try {\n    // we can't check .prototype since constructors produced by .bind haven't it\n    // `Function#toString` throws on some built-it function in some legacy engines\n    // (for example, `DOMQuad` and similar in FF41-)\n    return INCORRECT_TO_STRING || !!exec(constructorRegExp, inspectSource(argument));\n  } catch (error) {\n    return true;\n  }\n};\n\nisConstructorLegacy.sham = true;\n\n// `IsConstructor` abstract operation\n// https://tc39.es/ecma262/#sec-isconstructor\nmodule.exports = !construct || fails(function () {\n  var called;\n  return isConstructorModern(isConstructorModern.call)\n    || !isConstructorModern(Object)\n    || !isConstructorModern(function () { called = true; })\n    || called;\n}) ? isConstructorLegacy : isConstructorModern;\n","// `Symbol.prototype.description` getter\n// https://tc39.es/ecma262/#sec-symbol.prototype.description\n'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar hasOwn = require('../internals/has-own-property');\nvar isCallable = require('../internals/is-callable');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar toString = require('../internals/to-string');\nvar defineProperty = require('../internals/object-define-property').f;\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\n\nvar NativeSymbol = global.Symbol;\nvar SymbolPrototype = NativeSymbol && NativeSymbol.prototype;\n\nif (DESCRIPTORS && isCallable(NativeSymbol) && (!('description' in SymbolPrototype) ||\n  // Safari 12 bug\n  NativeSymbol().description !== undefined\n)) {\n  var EmptyStringDescriptionStore = {};\n  // wrap Symbol constructor for correct work with undefined description\n  var SymbolWrapper = function Symbol() {\n    var description = arguments.length < 1 || arguments[0] === undefined ? undefined : toString(arguments[0]);\n    var result = isPrototypeOf(SymbolPrototype, this)\n      ? new NativeSymbol(description)\n      // in Edge 13, String(Symbol(undefined)) === 'Symbol(undefined)'\n      : description === undefined ? NativeSymbol() : NativeSymbol(description);\n    if (description === '') EmptyStringDescriptionStore[result] = true;\n    return result;\n  };\n\n  copyConstructorProperties(SymbolWrapper, NativeSymbol);\n  SymbolWrapper.prototype = SymbolPrototype;\n  SymbolPrototype.constructor = SymbolWrapper;\n\n  var NATIVE_SYMBOL = String(NativeSymbol('test')) == 'Symbol(test)';\n  var symbolToString = uncurryThis(SymbolPrototype.toString);\n  var symbolValueOf = uncurryThis(SymbolPrototype.valueOf);\n  var regexp = /^Symbol\\((.*)\\)[^)]+$/;\n  var replace = uncurryThis(''.replace);\n  var stringSlice = uncurryThis(''.slice);\n\n  defineProperty(SymbolPrototype, 'description', {\n    configurable: true,\n    get: function description() {\n      var symbol = symbolValueOf(this);\n      var string = symbolToString(symbol);\n      if (hasOwn(EmptyStringDescriptionStore, symbol)) return '';\n      var desc = NATIVE_SYMBOL ? stringSlice(string, 7, -1) : replace(string, regexp, '$1');\n      return desc === '' ? undefined : desc;\n    }\n  });\n\n  $({ global: true, forced: true }, {\n    Symbol: SymbolWrapper\n  });\n}\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.asyncIterator` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.asynciterator\ndefineWellKnownSymbol('asyncIterator');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.hasInstance` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.hasinstance\ndefineWellKnownSymbol('hasInstance');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.isConcatSpreadable` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.isconcatspreadable\ndefineWellKnownSymbol('isConcatSpreadable');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.iterator` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.iterator\ndefineWellKnownSymbol('iterator');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.match` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.match\ndefineWellKnownSymbol('match');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.replace` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.replace\ndefineWellKnownSymbol('replace');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.search` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.search\ndefineWellKnownSymbol('search');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.species` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.species\ndefineWellKnownSymbol('species');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.split` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.split\ndefineWellKnownSymbol('split');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.toPrimitive` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.toprimitive\ndefineWellKnownSymbol('toPrimitive');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.toStringTag` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.tostringtag\ndefineWellKnownSymbol('toStringTag');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.unscopables` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.unscopables\ndefineWellKnownSymbol('unscopables');\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar isArray = require('../internals/is-array');\nvar isObject = require('../internals/is-object');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar createProperty = require('../internals/create-property');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar IS_CONCAT_SPREADABLE = wellKnownSymbol('isConcatSpreadable');\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_INDEX_EXCEEDED = 'Maximum allowed index exceeded';\nvar TypeError = global.TypeError;\n\n// We can't use this feature detection in V8 since it causes\n// deoptimization and serious performance degradation\n// https://github.com/zloirock/core-js/issues/679\nvar IS_CONCAT_SPREADABLE_SUPPORT = V8_VERSION >= 51 || !fails(function () {\n  var array = [];\n  array[IS_CONCAT_SPREADABLE] = false;\n  return array.concat()[0] !== array;\n});\n\nvar SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('concat');\n\nvar isConcatSpreadable = function (O) {\n  if (!isObject(O)) return false;\n  var spreadable = O[IS_CONCAT_SPREADABLE];\n  return spreadable !== undefined ? !!spreadable : isArray(O);\n};\n\nvar FORCED = !IS_CONCAT_SPREADABLE_SUPPORT || !SPECIES_SUPPORT;\n\n// `Array.prototype.concat` method\n// https://tc39.es/ecma262/#sec-array.prototype.concat\n// with adding support of @@isConcatSpreadable and @@species\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  concat: function concat(arg) {\n    var O = toObject(this);\n    var A = arraySpeciesCreate(O, 0);\n    var n = 0;\n    var i, k, length, len, E;\n    for (i = -1, length = arguments.length; i < length; i++) {\n      E = i === -1 ? O : arguments[i];\n      if (isConcatSpreadable(E)) {\n        len = lengthOfArrayLike(E);\n        if (n + len > MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        for (k = 0; k < len; k++, n++) if (k in E) createProperty(A, n, E[k]);\n      } else {\n        if (n >= MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        createProperty(A, n++, E);\n      }\n    }\n    A.length = n;\n    return A;\n  }\n});\n","var fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (METHOD_NAME) {\n  // We can't use this feature detection in V8 since it causes\n  // deoptimization and serious performance degradation\n  // https://github.com/zloirock/core-js/issues/677\n  return V8_VERSION >= 51 || !fails(function () {\n    var array = [];\n    var constructor = array.constructor = {};\n    constructor[SPECIES] = function () {\n      return { foo: 1 };\n    };\n    return array[METHOD_NAME](Boolean).foo !== 1;\n  });\n};\n","var $ = require('../internals/export');\nvar copyWithin = require('../internals/array-copy-within');\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.copyWithin` method\n// https://tc39.es/ecma262/#sec-array.prototype.copywithin\n$({ target: 'Array', proto: true }, {\n  copyWithin: copyWithin\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('copyWithin');\n","'use strict';\nvar toObject = require('../internals/to-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\nvar min = Math.min;\n\n// `Array.prototype.copyWithin` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.copywithin\n// eslint-disable-next-line es/no-array-prototype-copywithin -- safe\nmodule.exports = [].copyWithin || function copyWithin(target /* = 0 */, start /* = 0, end = @length */) {\n  var O = toObject(this);\n  var len = lengthOfArrayLike(O);\n  var to = toAbsoluteIndex(target, len);\n  var from = toAbsoluteIndex(start, len);\n  var end = arguments.length > 2 ? arguments[2] : undefined;\n  var count = min((end === undefined ? len : toAbsoluteIndex(end, len)) - from, len - to);\n  var inc = 1;\n  if (from < to && to < from + count) {\n    inc = -1;\n    from += count - 1;\n    to += count - 1;\n  }\n  while (count-- > 0) {\n    if (from in O) O[to] = O[from];\n    else delete O[to];\n    to += inc;\n    from += inc;\n  } return O;\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar create = require('../internals/object-create');\nvar definePropertyModule = require('../internals/object-define-property');\n\nvar UNSCOPABLES = wellKnownSymbol('unscopables');\nvar ArrayPrototype = Array.prototype;\n\n// Array.prototype[@@unscopables]\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\nif (ArrayPrototype[UNSCOPABLES] == undefined) {\n  definePropertyModule.f(ArrayPrototype, UNSCOPABLES, {\n    configurable: true,\n    value: create(null)\n  });\n}\n\n// add a key to Array.prototype[@@unscopables]\nmodule.exports = function (key) {\n  ArrayPrototype[UNSCOPABLES][key] = true;\n};\n","var $ = require('../internals/export');\nvar fill = require('../internals/array-fill');\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.fill` method\n// https://tc39.es/ecma262/#sec-array.prototype.fill\n$({ target: 'Array', proto: true }, {\n  fill: fill\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('fill');\n","'use strict';\nvar toObject = require('../internals/to-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\n// `Array.prototype.fill` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.fill\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = lengthOfArrayLike(O);\n  var argumentsLength = arguments.length;\n  var index = toAbsoluteIndex(argumentsLength > 1 ? arguments[1] : undefined, length);\n  var end = argumentsLength > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $filter = require('../internals/array-iteration').filter;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('filter');\n\n// `Array.prototype.filter` method\n// https://tc39.es/ecma262/#sec-array.prototype.filter\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    return $filter(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.es/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","'use strict';\nvar $ = require('../internals/export');\nvar $findIndex = require('../internals/array-iteration').findIndex;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\nvar FIND_INDEX = 'findIndex';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND_INDEX in []) Array(1)[FIND_INDEX](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.findIndex` method\n// https://tc39.es/ecma262/#sec-array.prototype.findindex\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $findIndex(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND_INDEX);\n","'use strict';\nvar $ = require('../internals/export');\nvar flattenIntoArray = require('../internals/flatten-into-array');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\n// `Array.prototype.flat` method\n// https://tc39.es/ecma262/#sec-array.prototype.flat\n$({ target: 'Array', proto: true }, {\n  flat: function flat(/* depthArg = 1 */) {\n    var depthArg = arguments.length ? arguments[0] : undefined;\n    var O = toObject(this);\n    var sourceLen = lengthOfArrayLike(O);\n    var A = arraySpeciesCreate(O, 0);\n    A.length = flattenIntoArray(A, O, O, sourceLen, 0, depthArg === undefined ? 1 : toIntegerOrInfinity(depthArg));\n    return A;\n  }\n});\n","'use strict';\nvar global = require('../internals/global');\nvar isArray = require('../internals/is-array');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar bind = require('../internals/function-bind-context');\n\nvar TypeError = global.TypeError;\n\n// `FlattenIntoArray` abstract operation\n// https://tc39.github.io/proposal-flatMap/#sec-FlattenIntoArray\nvar flattenIntoArray = function (target, original, source, sourceLen, start, depth, mapper, thisArg) {\n  var targetIndex = start;\n  var sourceIndex = 0;\n  var mapFn = mapper ? bind(mapper, thisArg) : false;\n  var element, elementLen;\n\n  while (sourceIndex < sourceLen) {\n    if (sourceIndex in source) {\n      element = mapFn ? mapFn(source[sourceIndex], sourceIndex, original) : source[sourceIndex];\n\n      if (depth > 0 && isArray(element)) {\n        elementLen = lengthOfArrayLike(element);\n        targetIndex = flattenIntoArray(target, original, element, elementLen, targetIndex, depth - 1) - 1;\n      } else {\n        if (targetIndex >= 0x1FFFFFFFFFFFFF) throw TypeError('Exceed the acceptable array length');\n        target[targetIndex] = element;\n      }\n\n      targetIndex++;\n    }\n    sourceIndex++;\n  }\n  return targetIndex;\n};\n\nmodule.exports = flattenIntoArray;\n","'use strict';\nvar $ = require('../internals/export');\nvar flattenIntoArray = require('../internals/flatten-into-array');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\n// `Array.prototype.flatMap` method\n// https://tc39.es/ecma262/#sec-array.prototype.flatmap\n$({ target: 'Array', proto: true }, {\n  flatMap: function flatMap(callbackfn /* , thisArg */) {\n    var O = toObject(this);\n    var sourceLen = lengthOfArrayLike(O);\n    var A;\n    aCallable(callbackfn);\n    A = arraySpeciesCreate(O, 0);\n    A.length = flattenIntoArray(A, O, O, sourceLen, 0, 1, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return A;\n  }\n});\n","var $ = require('../internals/export');\nvar from = require('../internals/array-from');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\n\nvar INCORRECT_ITERATION = !checkCorrectnessOfIteration(function (iterable) {\n  // eslint-disable-next-line es/no-array-from -- required for testing\n  Array.from(iterable);\n});\n\n// `Array.from` method\n// https://tc39.es/ecma262/#sec-array.from\n$({ target: 'Array', stat: true, forced: INCORRECT_ITERATION }, {\n  from: from\n});\n","'use strict';\nvar global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar toObject = require('../internals/to-object');\nvar callWithSafeIterationClosing = require('../internals/call-with-safe-iteration-closing');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar isConstructor = require('../internals/is-constructor');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar createProperty = require('../internals/create-property');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\nvar Array = global.Array;\n\n// `Array.from` method implementation\n// https://tc39.es/ecma262/#sec-array.from\nmodule.exports = function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n  var O = toObject(arrayLike);\n  var IS_CONSTRUCTOR = isConstructor(this);\n  var argumentsLength = arguments.length;\n  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;\n  var mapping = mapfn !== undefined;\n  if (mapping) mapfn = bind(mapfn, argumentsLength > 2 ? arguments[2] : undefined);\n  var iteratorMethod = getIteratorMethod(O);\n  var index = 0;\n  var length, result, step, iterator, next, value;\n  // if the target is not iterable or it's an array with the default iterator - use a simple case\n  if (iteratorMethod && !(this == Array && isArrayIteratorMethod(iteratorMethod))) {\n    iterator = getIterator(O, iteratorMethod);\n    next = iterator.next;\n    result = IS_CONSTRUCTOR ? new this() : [];\n    for (;!(step = call(next, iterator)).done; index++) {\n      value = mapping ? callWithSafeIterationClosing(iterator, mapfn, [step.value, index], true) : step.value;\n      createProperty(result, index, value);\n    }\n  } else {\n    length = lengthOfArrayLike(O);\n    result = IS_CONSTRUCTOR ? new this(length) : Array(length);\n    for (;length > index; index++) {\n      value = mapping ? mapfn(O[index], index) : O[index];\n      createProperty(result, index, value);\n    }\n  }\n  result.length = index;\n  return result;\n};\n","var anObject = require('../internals/an-object');\nvar iteratorClose = require('../internals/iterator-close');\n\n// call something on iterator step with safe closing on error\nmodule.exports = function (iterator, fn, value, ENTRIES) {\n  try {\n    return ENTRIES ? fn(anObject(value)[0], value[1]) : fn(value);\n  } catch (error) {\n    iteratorClose(iterator, 'throw', error);\n  }\n};\n","var call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar getMethod = require('../internals/get-method');\n\nmodule.exports = function (iterator, kind, value) {\n  var innerResult, innerError;\n  anObject(iterator);\n  try {\n    innerResult = getMethod(iterator, 'return');\n    if (!innerResult) {\n      if (kind === 'throw') throw value;\n      return value;\n    }\n    innerResult = call(innerResult, iterator);\n  } catch (error) {\n    innerError = true;\n    innerResult = error;\n  }\n  if (kind === 'throw') throw value;\n  if (innerError) throw innerResult;\n  anObject(innerResult);\n  return value;\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar Iterators = require('../internals/iterators');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar ArrayPrototype = Array.prototype;\n\n// check on default Array iterator\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayPrototype[ITERATOR] === it);\n};\n","module.exports = {};\n","var global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar tryToString = require('../internals/try-to-string');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\nvar TypeError = global.TypeError;\n\nmodule.exports = function (argument, usingIterator) {\n  var iteratorMethod = arguments.length < 2 ? getIteratorMethod(argument) : usingIterator;\n  if (aCallable(iteratorMethod)) return anObject(call(iteratorMethod, argument));\n  throw TypeError(tryToString(argument) + ' is not iterable');\n};\n","var classof = require('../internals/classof');\nvar getMethod = require('../internals/get-method');\nvar Iterators = require('../internals/iterators');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\n\nmodule.exports = function (it) {\n  if (it != undefined) return getMethod(it, ITERATOR)\n    || getMethod(it, '@@iterator')\n    || Iterators[classof(it)];\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var called = 0;\n  var iteratorWithReturn = {\n    next: function () {\n      return { done: !!called++ };\n    },\n    'return': function () {\n      SAFE_CLOSING = true;\n    }\n  };\n  iteratorWithReturn[ITERATOR] = function () {\n    return this;\n  };\n  // eslint-disable-next-line es/no-array-from, no-throw-literal -- required for testing\n  Array.from(iteratorWithReturn, function () { throw 2; });\n} catch (error) { /* empty */ }\n\nmodule.exports = function (exec, SKIP_CLOSING) {\n  if (!SKIP_CLOSING && !SAFE_CLOSING) return false;\n  var ITERATION_SUPPORT = false;\n  try {\n    var object = {};\n    object[ITERATOR] = function () {\n      return {\n        next: function () {\n          return { done: ITERATION_SUPPORT = true };\n        }\n      };\n    };\n    exec(object);\n  } catch (error) { /* empty */ }\n  return ITERATION_SUPPORT;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $includes = require('../internals/array-includes').includes;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.includes` method\n// https://tc39.es/ecma262/#sec-array.prototype.includes\n$({ target: 'Array', proto: true }, {\n  includes: function includes(el /* , fromIndex = 0 */) {\n    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('includes');\n","'use strict';\n/* eslint-disable es/no-array-prototype-indexof -- required for testing */\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar $IndexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar un$IndexOf = uncurryThis([].indexOf);\n\nvar NEGATIVE_ZERO = !!un$IndexOf && 1 / un$IndexOf([1], 1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\n\n// `Array.prototype.indexOf` method\n// https://tc39.es/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    var fromIndex = arguments.length > 1 ? arguments[1] : undefined;\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? un$IndexOf(this, searchElement, fromIndex) || 0\n      : $IndexOf(this, searchElement, fromIndex);\n  }\n});\n","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal -- required for testing\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n","'use strict';\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar Iterators = require('../internals/iterators');\nvar InternalStateModule = require('../internals/internal-state');\nvar defineProperty = require('../internals/object-define-property').f;\nvar defineIterator = require('../internals/define-iterator');\nvar IS_PURE = require('../internals/is-pure');\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar ARRAY_ITERATOR = 'Array Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(ARRAY_ITERATOR);\n\n// `Array.prototype.entries` method\n// https://tc39.es/ecma262/#sec-array.prototype.entries\n// `Array.prototype.keys` method\n// https://tc39.es/ecma262/#sec-array.prototype.keys\n// `Array.prototype.values` method\n// https://tc39.es/ecma262/#sec-array.prototype.values\n// `Array.prototype[@@iterator]` method\n// https://tc39.es/ecma262/#sec-array.prototype-@@iterator\n// `CreateArrayIterator` internal method\n// https://tc39.es/ecma262/#sec-createarrayiterator\nmodule.exports = defineIterator(Array, 'Array', function (iterated, kind) {\n  setInternalState(this, {\n    type: ARRAY_ITERATOR,\n    target: toIndexedObject(iterated), // target\n    index: 0,                          // next index\n    kind: kind                         // kind\n  });\n// `%ArrayIteratorPrototype%.next` method\n// https://tc39.es/ecma262/#sec-%arrayiteratorprototype%.next\n}, function () {\n  var state = getInternalState(this);\n  var target = state.target;\n  var kind = state.kind;\n  var index = state.index++;\n  if (!target || index >= target.length) {\n    state.target = undefined;\n    return { value: undefined, done: true };\n  }\n  if (kind == 'keys') return { value: index, done: false };\n  if (kind == 'values') return { value: target[index], done: false };\n  return { value: [index, target[index]], done: false };\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values%\n// https://tc39.es/ecma262/#sec-createunmappedargumentsobject\n// https://tc39.es/ecma262/#sec-createmappedargumentsobject\nvar values = Iterators.Arguments = Iterators.Array;\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n\n// V8 ~ Chrome 45- bug\nif (!IS_PURE && DESCRIPTORS && values.name !== 'values') try {\n  defineProperty(values, 'name', { value: 'values' });\n} catch (error) { /* empty */ }\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar IS_PURE = require('../internals/is-pure');\nvar FunctionName = require('../internals/function-name');\nvar isCallable = require('../internals/is-callable');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar Iterators = require('../internals/iterators');\nvar IteratorsCore = require('../internals/iterators-core');\n\nvar PROPER_FUNCTION_NAME = FunctionName.PROPER;\nvar CONFIGURABLE_FUNCTION_NAME = FunctionName.CONFIGURABLE;\nvar IteratorPrototype = IteratorsCore.IteratorPrototype;\nvar BUGGY_SAFARI_ITERATORS = IteratorsCore.BUGGY_SAFARI_ITERATORS;\nvar ITERATOR = wellKnownSymbol('iterator');\nvar KEYS = 'keys';\nvar VALUES = 'values';\nvar ENTRIES = 'entries';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Iterable, NAME, IteratorConstructor, next, DEFAULT, IS_SET, FORCED) {\n  createIteratorConstructor(IteratorConstructor, NAME, next);\n\n  var getIterationMethod = function (KIND) {\n    if (KIND === DEFAULT && defaultIterator) return defaultIterator;\n    if (!BUGGY_SAFARI_ITERATORS && KIND in IterablePrototype) return IterablePrototype[KIND];\n    switch (KIND) {\n      case KEYS: return function keys() { return new IteratorConstructor(this, KIND); };\n      case VALUES: return function values() { return new IteratorConstructor(this, KIND); };\n      case ENTRIES: return function entries() { return new IteratorConstructor(this, KIND); };\n    } return function () { return new IteratorConstructor(this); };\n  };\n\n  var TO_STRING_TAG = NAME + ' Iterator';\n  var INCORRECT_VALUES_NAME = false;\n  var IterablePrototype = Iterable.prototype;\n  var nativeIterator = IterablePrototype[ITERATOR]\n    || IterablePrototype['@@iterator']\n    || DEFAULT && IterablePrototype[DEFAULT];\n  var defaultIterator = !BUGGY_SAFARI_ITERATORS && nativeIterator || getIterationMethod(DEFAULT);\n  var anyNativeIterator = NAME == 'Array' ? IterablePrototype.entries || nativeIterator : nativeIterator;\n  var CurrentIteratorPrototype, methods, KEY;\n\n  // fix native\n  if (anyNativeIterator) {\n    CurrentIteratorPrototype = getPrototypeOf(anyNativeIterator.call(new Iterable()));\n    if (CurrentIteratorPrototype !== Object.prototype && CurrentIteratorPrototype.next) {\n      if (!IS_PURE && getPrototypeOf(CurrentIteratorPrototype) !== IteratorPrototype) {\n        if (setPrototypeOf) {\n          setPrototypeOf(CurrentIteratorPrototype, IteratorPrototype);\n        } else if (!isCallable(CurrentIteratorPrototype[ITERATOR])) {\n          redefine(CurrentIteratorPrototype, ITERATOR, returnThis);\n        }\n      }\n      // Set @@toStringTag to native iterators\n      setToStringTag(CurrentIteratorPrototype, TO_STRING_TAG, true, true);\n      if (IS_PURE) Iterators[TO_STRING_TAG] = returnThis;\n    }\n  }\n\n  // fix Array.prototype.{ values, @@iterator }.name in V8 / FF\n  if (PROPER_FUNCTION_NAME && DEFAULT == VALUES && nativeIterator && nativeIterator.name !== VALUES) {\n    if (!IS_PURE && CONFIGURABLE_FUNCTION_NAME) {\n      createNonEnumerableProperty(IterablePrototype, 'name', VALUES);\n    } else {\n      INCORRECT_VALUES_NAME = true;\n      defaultIterator = function values() { return call(nativeIterator, this); };\n    }\n  }\n\n  // export additional methods\n  if (DEFAULT) {\n    methods = {\n      values: getIterationMethod(VALUES),\n      keys: IS_SET ? defaultIterator : getIterationMethod(KEYS),\n      entries: getIterationMethod(ENTRIES)\n    };\n    if (FORCED) for (KEY in methods) {\n      if (BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME || !(KEY in IterablePrototype)) {\n        redefine(IterablePrototype, KEY, methods[KEY]);\n      }\n    } else $({ target: NAME, proto: true, forced: BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME }, methods);\n  }\n\n  // define iterator\n  if ((!IS_PURE || FORCED) && IterablePrototype[ITERATOR] !== defaultIterator) {\n    redefine(IterablePrototype, ITERATOR, defaultIterator, { name: DEFAULT });\n  }\n  Iterators[NAME] = defaultIterator;\n\n  return methods;\n};\n","'use strict';\nvar IteratorPrototype = require('../internals/iterators-core').IteratorPrototype;\nvar create = require('../internals/object-create');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar Iterators = require('../internals/iterators');\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (IteratorConstructor, NAME, next, ENUMERABLE_NEXT) {\n  var TO_STRING_TAG = NAME + ' Iterator';\n  IteratorConstructor.prototype = create(IteratorPrototype, { next: createPropertyDescriptor(+!ENUMERABLE_NEXT, next) });\n  setToStringTag(IteratorConstructor, TO_STRING_TAG, false, true);\n  Iterators[TO_STRING_TAG] = returnThis;\n  return IteratorConstructor;\n};\n","'use strict';\nvar fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\nvar create = require('../internals/object-create');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar redefine = require('../internals/redefine');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar BUGGY_SAFARI_ITERATORS = false;\n\n// `%IteratorPrototype%` object\n// https://tc39.es/ecma262/#sec-%iteratorprototype%-object\nvar IteratorPrototype, PrototypeOfArrayIteratorPrototype, arrayIterator;\n\n/* eslint-disable es/no-array-prototype-keys -- safe */\nif ([].keys) {\n  arrayIterator = [].keys();\n  // Safari 8 has buggy iterators w/o `next`\n  if (!('next' in arrayIterator)) BUGGY_SAFARI_ITERATORS = true;\n  else {\n    PrototypeOfArrayIteratorPrototype = getPrototypeOf(getPrototypeOf(arrayIterator));\n    if (PrototypeOfArrayIteratorPrototype !== Object.prototype) IteratorPrototype = PrototypeOfArrayIteratorPrototype;\n  }\n}\n\nvar NEW_ITERATOR_PROTOTYPE = IteratorPrototype == undefined || fails(function () {\n  var test = {};\n  // FF44- legacy iterators case\n  return IteratorPrototype[ITERATOR].call(test) !== test;\n});\n\nif (NEW_ITERATOR_PROTOTYPE) IteratorPrototype = {};\nelse if (IS_PURE) IteratorPrototype = create(IteratorPrototype);\n\n// `%IteratorPrototype%[@@iterator]()` method\n// https://tc39.es/ecma262/#sec-%iteratorprototype%-@@iterator\nif (!isCallable(IteratorPrototype[ITERATOR])) {\n  redefine(IteratorPrototype, ITERATOR, function () {\n    return this;\n  });\n}\n\nmodule.exports = {\n  IteratorPrototype: IteratorPrototype,\n  BUGGY_SAFARI_ITERATORS: BUGGY_SAFARI_ITERATORS\n};\n","var global = require('../internals/global');\nvar hasOwn = require('../internals/has-own-property');\nvar isCallable = require('../internals/is-callable');\nvar toObject = require('../internals/to-object');\nvar sharedKey = require('../internals/shared-key');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar IE_PROTO = sharedKey('IE_PROTO');\nvar Object = global.Object;\nvar ObjectPrototype = Object.prototype;\n\n// `Object.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.getprototypeof\nmodule.exports = CORRECT_PROTOTYPE_GETTER ? Object.getPrototypeOf : function (O) {\n  var object = toObject(O);\n  if (hasOwn(object, IE_PROTO)) return object[IE_PROTO];\n  var constructor = object.constructor;\n  if (isCallable(constructor) && object instanceof constructor) {\n    return constructor.prototype;\n  } return object instanceof Object ? ObjectPrototype : null;\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  function F() { /* empty */ }\n  F.prototype.constructor = null;\n  // eslint-disable-next-line es/no-object-getprototypeof -- required for testing\n  return Object.getPrototypeOf(new F()) !== F.prototype;\n});\n","/* eslint-disable no-proto -- safe */\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar anObject = require('../internals/an-object');\nvar aPossiblePrototype = require('../internals/a-possible-prototype');\n\n// `Object.setPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.setprototypeof\n// Works with __proto__ only. Old v8 can't work with null proto objects.\n// eslint-disable-next-line es/no-object-setprototypeof -- safe\nmodule.exports = Object.setPrototypeOf || ('__proto__' in {} ? function () {\n  var CORRECT_SETTER = false;\n  var test = {};\n  var setter;\n  try {\n    // eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\n    setter = uncurryThis(Object.getOwnPropertyDescriptor(Object.prototype, '__proto__').set);\n    setter(test, []);\n    CORRECT_SETTER = test instanceof Array;\n  } catch (error) { /* empty */ }\n  return function setPrototypeOf(O, proto) {\n    anObject(O);\n    aPossiblePrototype(proto);\n    if (CORRECT_SETTER) setter(O, proto);\n    else O.__proto__ = proto;\n    return O;\n  };\n}() : undefined);\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\n\nvar String = global.String;\nvar TypeError = global.TypeError;\n\nmodule.exports = function (argument) {\n  if (typeof argument == 'object' || isCallable(argument)) return argument;\n  throw TypeError(\"Can't set \" + String(argument) + ' as a prototype');\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar IndexedObject = require('../internals/indexed-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar un$Join = uncurryThis([].join);\n\nvar ES3_STRINGS = IndexedObject != Object;\nvar STRICT_METHOD = arrayMethodIsStrict('join', ',');\n\n// `Array.prototype.join` method\n// https://tc39.es/ecma262/#sec-array.prototype.join\n$({ target: 'Array', proto: true, forced: ES3_STRINGS || !STRICT_METHOD }, {\n  join: function join(separator) {\n    return un$Join(toIndexedObject(this), separator === undefined ? ',' : separator);\n  }\n});\n","var $ = require('../internals/export');\nvar lastIndexOf = require('../internals/array-last-index-of');\n\n// `Array.prototype.lastIndexOf` method\n// https://tc39.es/ecma262/#sec-array.prototype.lastindexof\n// eslint-disable-next-line es/no-array-prototype-lastindexof -- required for testing\n$({ target: 'Array', proto: true, forced: lastIndexOf !== [].lastIndexOf }, {\n  lastIndexOf: lastIndexOf\n});\n","'use strict';\n/* eslint-disable es/no-array-prototype-lastindexof -- safe */\nvar apply = require('../internals/function-apply');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar min = Math.min;\nvar $lastIndexOf = [].lastIndexOf;\nvar NEGATIVE_ZERO = !!$lastIndexOf && 1 / [1].lastIndexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('lastIndexOf');\nvar FORCED = NEGATIVE_ZERO || !STRICT_METHOD;\n\n// `Array.prototype.lastIndexOf` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.lastindexof\nmodule.exports = FORCED ? function lastIndexOf(searchElement /* , fromIndex = @[*-1] */) {\n  // convert -0 to +0\n  if (NEGATIVE_ZERO) return apply($lastIndexOf, this, arguments) || 0;\n  var O = toIndexedObject(this);\n  var length = lengthOfArrayLike(O);\n  var index = length - 1;\n  if (arguments.length > 1) index = min(index, toIntegerOrInfinity(arguments[1]));\n  if (index < 0) index = length + index;\n  for (;index >= 0; index--) if (index in O && O[index] === searchElement) return index || 0;\n  return -1;\n} : $lastIndexOf;\n","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar isConstructor = require('../internals/is-constructor');\nvar createProperty = require('../internals/create-property');\n\nvar Array = global.Array;\n\nvar ISNT_GENERIC = fails(function () {\n  function F() { /* empty */ }\n  return !(Array.of.call(F) instanceof F);\n});\n\n// `Array.of` method\n// https://tc39.es/ecma262/#sec-array.of\n// WebKit Array.of isn't generic\n$({ target: 'Array', stat: true, forced: ISNT_GENERIC }, {\n  of: function of(/* ...args */) {\n    var index = 0;\n    var argumentsLength = arguments.length;\n    var result = new (isConstructor(this) ? this : Array)(argumentsLength);\n    while (argumentsLength > index) createProperty(result, index, arguments[index++]);\n    result.length = argumentsLength;\n    return result;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $reduce = require('../internals/array-reduce').left;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar CHROME_VERSION = require('../internals/engine-v8-version');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar STRICT_METHOD = arrayMethodIsStrict('reduce');\n// Chrome 80-82 has a critical bug\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1049982\nvar CHROME_BUG = !IS_NODE && CHROME_VERSION > 79 && CHROME_VERSION < 83;\n\n// `Array.prototype.reduce` method\n// https://tc39.es/ecma262/#sec-array.prototype.reduce\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || CHROME_BUG }, {\n  reduce: function reduce(callbackfn /* , initialValue */) {\n    var length = arguments.length;\n    return $reduce(this, callbackfn, length, length > 1 ? arguments[1] : undefined);\n  }\n});\n","var global = require('../internals/global');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar IndexedObject = require('../internals/indexed-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\nvar TypeError = global.TypeError;\n\n// `Array.prototype.{ reduce, reduceRight }` methods implementation\nvar createMethod = function (IS_RIGHT) {\n  return function (that, callbackfn, argumentsLength, memo) {\n    aCallable(callbackfn);\n    var O = toObject(that);\n    var self = IndexedObject(O);\n    var length = lengthOfArrayLike(O);\n    var index = IS_RIGHT ? length - 1 : 0;\n    var i = IS_RIGHT ? -1 : 1;\n    if (argumentsLength < 2) while (true) {\n      if (index in self) {\n        memo = self[index];\n        index += i;\n        break;\n      }\n      index += i;\n      if (IS_RIGHT ? index < 0 : length <= index) {\n        throw TypeError('Reduce of empty array with no initial value');\n      }\n    }\n    for (;IS_RIGHT ? index >= 0 : length > index; index += i) if (index in self) {\n      memo = callbackfn(memo, self[index], index, O);\n    }\n    return memo;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.reduce` method\n  // https://tc39.es/ecma262/#sec-array.prototype.reduce\n  left: createMethod(false),\n  // `Array.prototype.reduceRight` method\n  // https://tc39.es/ecma262/#sec-array.prototype.reduceright\n  right: createMethod(true)\n};\n","var classof = require('../internals/classof-raw');\nvar global = require('../internals/global');\n\nmodule.exports = classof(global.process) == 'process';\n","'use strict';\nvar $ = require('../internals/export');\nvar $reduceRight = require('../internals/array-reduce').right;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar CHROME_VERSION = require('../internals/engine-v8-version');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar STRICT_METHOD = arrayMethodIsStrict('reduceRight');\n// Chrome 80-82 has a critical bug\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1049982\nvar CHROME_BUG = !IS_NODE && CHROME_VERSION > 79 && CHROME_VERSION < 83;\n\n// `Array.prototype.reduceRight` method\n// https://tc39.es/ecma262/#sec-array.prototype.reduceright\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || CHROME_BUG }, {\n  reduceRight: function reduceRight(callbackfn /* , initialValue */) {\n    return $reduceRight(this, callbackfn, arguments.length, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isArray = require('../internals/is-array');\n\nvar un$Reverse = uncurryThis([].reverse);\nvar test = [1, 2];\n\n// `Array.prototype.reverse` method\n// https://tc39.es/ecma262/#sec-array.prototype.reverse\n// fix for Safari 12.0 bug\n// https://bugs.webkit.org/show_bug.cgi?id=188794\n$({ target: 'Array', proto: true, forced: String(test) === String(test.reverse()) }, {\n  reverse: function reverse() {\n    // eslint-disable-next-line no-self-assign -- dirty hack\n    if (isArray(this)) this.length = this.length;\n    return un$Reverse(this);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar isArray = require('../internals/is-array');\nvar isConstructor = require('../internals/is-constructor');\nvar isObject = require('../internals/is-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar createProperty = require('../internals/create-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar un$Slice = require('../internals/array-slice');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('slice');\n\nvar SPECIES = wellKnownSymbol('species');\nvar Array = global.Array;\nvar max = Math.max;\n\n// `Array.prototype.slice` method\n// https://tc39.es/ecma262/#sec-array.prototype.slice\n// fallback for not array-like ES3 strings and DOM objects\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  slice: function slice(start, end) {\n    var O = toIndexedObject(this);\n    var length = lengthOfArrayLike(O);\n    var k = toAbsoluteIndex(start, length);\n    var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n    // inline `ArraySpeciesCreate` for usage native `Array#slice` where it's possible\n    var Constructor, result, n;\n    if (isArray(O)) {\n      Constructor = O.constructor;\n      // cross-realm fallback\n      if (isConstructor(Constructor) && (Constructor === Array || isArray(Constructor.prototype))) {\n        Constructor = undefined;\n      } else if (isObject(Constructor)) {\n        Constructor = Constructor[SPECIES];\n        if (Constructor === null) Constructor = undefined;\n      }\n      if (Constructor === Array || Constructor === undefined) {\n        return un$Slice(O, k, fin);\n      }\n    }\n    result = new (Constructor === undefined ? Array : Constructor)(max(fin - k, 0));\n    for (n = 0; k < fin; k++, n++) if (k in O) createProperty(result, n, O[k]);\n    result.length = n;\n    return result;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar internalSort = require('../internals/array-sort');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar FF = require('../internals/engine-ff-version');\nvar IE_OR_EDGE = require('../internals/engine-is-ie-or-edge');\nvar V8 = require('../internals/engine-v8-version');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\nvar test = [];\nvar un$Sort = uncurryThis(test.sort);\nvar push = uncurryThis(test.push);\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? un$Sort(array) : un$Sort(array, comparefn);\n\n    var items = [];\n    var arrayLength = lengthOfArrayLike(array);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) push(items, array[index]);\n    }\n\n    internalSort(items, getSortCompare(comparefn));\n\n    itemsLength = items.length;\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) delete array[index++];\n\n    return array;\n  }\n});\n","var arraySlice = require('../internals/array-slice-simple');\n\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    array,\n    mergeSort(arraySlice(array, 0, middle), comparefn),\n    mergeSort(arraySlice(array, middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (array, left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n\n  while (lindex < llength || rindex < rlength) {\n    array[lindex + rindex] = (lindex < llength && rindex < rlength)\n      ? comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]\n      : lindex < llength ? left[lindex++] : right[rindex++];\n  } return array;\n};\n\nmodule.exports = mergeSort;\n","var userAgent = require('../internals/engine-user-agent');\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n","var UA = require('../internals/engine-user-agent');\n\nmodule.exports = /MSIE|Trident/.test(UA);\n","var userAgent = require('../internals/engine-user-agent');\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n","var setSpecies = require('../internals/set-species');\n\n// `Array[@@species]` getter\n// https://tc39.es/ecma262/#sec-get-array-@@species\nsetSpecies('Array');\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\nvar definePropertyModule = require('../internals/object-define-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (CONSTRUCTOR_NAME) {\n  var Constructor = getBuiltIn(CONSTRUCTOR_NAME);\n  var defineProperty = definePropertyModule.f;\n\n  if (DESCRIPTORS && Constructor && !Constructor[SPECIES]) {\n    defineProperty(Constructor, SPECIES, {\n      configurable: true,\n      get: function () { return this; }\n    });\n  }\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toObject = require('../internals/to-object');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar createProperty = require('../internals/create-property');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('splice');\n\nvar TypeError = global.TypeError;\nvar max = Math.max;\nvar min = Math.min;\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_LENGTH_EXCEEDED = 'Maximum allowed length exceeded';\n\n// `Array.prototype.splice` method\n// https://tc39.es/ecma262/#sec-array.prototype.splice\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  splice: function splice(start, deleteCount /* , ...items */) {\n    var O = toObject(this);\n    var len = lengthOfArrayLike(O);\n    var actualStart = toAbsoluteIndex(start, len);\n    var argumentsLength = arguments.length;\n    var insertCount, actualDeleteCount, A, k, from, to;\n    if (argumentsLength === 0) {\n      insertCount = actualDeleteCount = 0;\n    } else if (argumentsLength === 1) {\n      insertCount = 0;\n      actualDeleteCount = len - actualStart;\n    } else {\n      insertCount = argumentsLength - 2;\n      actualDeleteCount = min(max(toIntegerOrInfinity(deleteCount), 0), len - actualStart);\n    }\n    if (len + insertCount - actualDeleteCount > MAX_SAFE_INTEGER) {\n      throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED);\n    }\n    A = arraySpeciesCreate(O, actualDeleteCount);\n    for (k = 0; k < actualDeleteCount; k++) {\n      from = actualStart + k;\n      if (from in O) createProperty(A, k, O[from]);\n    }\n    A.length = actualDeleteCount;\n    if (insertCount < actualDeleteCount) {\n      for (k = actualStart; k < len - actualDeleteCount; k++) {\n        from = k + actualDeleteCount;\n        to = k + insertCount;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n      for (k = len; k > len - actualDeleteCount + insertCount; k--) delete O[k - 1];\n    } else if (insertCount > actualDeleteCount) {\n      for (k = len - actualDeleteCount; k > actualStart; k--) {\n        from = k + actualDeleteCount - 1;\n        to = k + insertCount - 1;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n    }\n    for (k = 0; k < insertCount; k++) {\n      O[k + actualStart] = arguments[k + 2];\n    }\n    O.length = len - actualDeleteCount + insertCount;\n    return A;\n  }\n});\n","// this method was added to unscopables after implementation\n// in popular engines, so it's moved to a separate module\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('flat');\n","// this method was added to unscopables after implementation\n// in popular engines, so it's moved to a separate module\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('flatMap');\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar arrayBufferModule = require('../internals/array-buffer');\nvar setSpecies = require('../internals/set-species');\n\nvar ARRAY_BUFFER = 'ArrayBuffer';\nvar ArrayBuffer = arrayBufferModule[ARRAY_BUFFER];\nvar NativeArrayBuffer = global[ARRAY_BUFFER];\n\n// `ArrayBuffer` constructor\n// https://tc39.es/ecma262/#sec-arraybuffer-constructor\n$({ global: true, forced: NativeArrayBuffer !== ArrayBuffer }, {\n  ArrayBuffer: ArrayBuffer\n});\n\nsetSpecies(ARRAY_BUFFER);\n","'use strict';\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar NATIVE_ARRAY_BUFFER = require('../internals/array-buffer-native');\nvar FunctionName = require('../internals/function-name');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefineAll = require('../internals/redefine-all');\nvar fails = require('../internals/fails');\nvar anInstance = require('../internals/an-instance');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toLength = require('../internals/to-length');\nvar toIndex = require('../internals/to-index');\nvar IEEE754 = require('../internals/ieee754');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar defineProperty = require('../internals/object-define-property').f;\nvar arrayFill = require('../internals/array-fill');\nvar arraySlice = require('../internals/array-slice-simple');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar PROPER_FUNCTION_NAME = FunctionName.PROPER;\nvar CONFIGURABLE_FUNCTION_NAME = FunctionName.CONFIGURABLE;\nvar getInternalState = InternalStateModule.get;\nvar setInternalState = InternalStateModule.set;\nvar ARRAY_BUFFER = 'ArrayBuffer';\nvar DATA_VIEW = 'DataView';\nvar PROTOTYPE = 'prototype';\nvar WRONG_LENGTH = 'Wrong length';\nvar WRONG_INDEX = 'Wrong index';\nvar NativeArrayBuffer = global[ARRAY_BUFFER];\nvar $ArrayBuffer = NativeArrayBuffer;\nvar ArrayBufferPrototype = $ArrayBuffer && $ArrayBuffer[PROTOTYPE];\nvar $DataView = global[DATA_VIEW];\nvar DataViewPrototype = $DataView && $DataView[PROTOTYPE];\nvar ObjectPrototype = Object.prototype;\nvar Array = global.Array;\nvar RangeError = global.RangeError;\nvar fill = uncurryThis(arrayFill);\nvar reverse = uncurryThis([].reverse);\n\nvar packIEEE754 = IEEE754.pack;\nvar unpackIEEE754 = IEEE754.unpack;\n\nvar packInt8 = function (number) {\n  return [number & 0xFF];\n};\n\nvar packInt16 = function (number) {\n  return [number & 0xFF, number >> 8 & 0xFF];\n};\n\nvar packInt32 = function (number) {\n  return [number & 0xFF, number >> 8 & 0xFF, number >> 16 & 0xFF, number >> 24 & 0xFF];\n};\n\nvar unpackInt32 = function (buffer) {\n  return buffer[3] << 24 | buffer[2] << 16 | buffer[1] << 8 | buffer[0];\n};\n\nvar packFloat32 = function (number) {\n  return packIEEE754(number, 23, 4);\n};\n\nvar packFloat64 = function (number) {\n  return packIEEE754(number, 52, 8);\n};\n\nvar addGetter = function (Constructor, key) {\n  defineProperty(Constructor[PROTOTYPE], key, { get: function () { return getInternalState(this)[key]; } });\n};\n\nvar get = function (view, count, index, isLittleEndian) {\n  var intIndex = toIndex(index);\n  var store = getInternalState(view);\n  if (intIndex + count > store.byteLength) throw RangeError(WRONG_INDEX);\n  var bytes = getInternalState(store.buffer).bytes;\n  var start = intIndex + store.byteOffset;\n  var pack = arraySlice(bytes, start, start + count);\n  return isLittleEndian ? pack : reverse(pack);\n};\n\nvar set = function (view, count, index, conversion, value, isLittleEndian) {\n  var intIndex = toIndex(index);\n  var store = getInternalState(view);\n  if (intIndex + count > store.byteLength) throw RangeError(WRONG_INDEX);\n  var bytes = getInternalState(store.buffer).bytes;\n  var start = intIndex + store.byteOffset;\n  var pack = conversion(+value);\n  for (var i = 0; i < count; i++) bytes[start + i] = pack[isLittleEndian ? i : count - i - 1];\n};\n\nif (!NATIVE_ARRAY_BUFFER) {\n  $ArrayBuffer = function ArrayBuffer(length) {\n    anInstance(this, ArrayBufferPrototype);\n    var byteLength = toIndex(length);\n    setInternalState(this, {\n      bytes: fill(Array(byteLength), 0),\n      byteLength: byteLength\n    });\n    if (!DESCRIPTORS) this.byteLength = byteLength;\n  };\n\n  ArrayBufferPrototype = $ArrayBuffer[PROTOTYPE];\n\n  $DataView = function DataView(buffer, byteOffset, byteLength) {\n    anInstance(this, DataViewPrototype);\n    anInstance(buffer, ArrayBufferPrototype);\n    var bufferLength = getInternalState(buffer).byteLength;\n    var offset = toIntegerOrInfinity(byteOffset);\n    if (offset < 0 || offset > bufferLength) throw RangeError('Wrong offset');\n    byteLength = byteLength === undefined ? bufferLength - offset : toLength(byteLength);\n    if (offset + byteLength > bufferLength) throw RangeError(WRONG_LENGTH);\n    setInternalState(this, {\n      buffer: buffer,\n      byteLength: byteLength,\n      byteOffset: offset\n    });\n    if (!DESCRIPTORS) {\n      this.buffer = buffer;\n      this.byteLength = byteLength;\n      this.byteOffset = offset;\n    }\n  };\n\n  DataViewPrototype = $DataView[PROTOTYPE];\n\n  if (DESCRIPTORS) {\n    addGetter($ArrayBuffer, 'byteLength');\n    addGetter($DataView, 'buffer');\n    addGetter($DataView, 'byteLength');\n    addGetter($DataView, 'byteOffset');\n  }\n\n  redefineAll(DataViewPrototype, {\n    getInt8: function getInt8(byteOffset) {\n      return get(this, 1, byteOffset)[0] << 24 >> 24;\n    },\n    getUint8: function getUint8(byteOffset) {\n      return get(this, 1, byteOffset)[0];\n    },\n    getInt16: function getInt16(byteOffset /* , littleEndian */) {\n      var bytes = get(this, 2, byteOffset, arguments.length > 1 ? arguments[1] : undefined);\n      return (bytes[1] << 8 | bytes[0]) << 16 >> 16;\n    },\n    getUint16: function getUint16(byteOffset /* , littleEndian */) {\n      var bytes = get(this, 2, byteOffset, arguments.length > 1 ? arguments[1] : undefined);\n      return bytes[1] << 8 | bytes[0];\n    },\n    getInt32: function getInt32(byteOffset /* , littleEndian */) {\n      return unpackInt32(get(this, 4, byteOffset, arguments.length > 1 ? arguments[1] : undefined));\n    },\n    getUint32: function getUint32(byteOffset /* , littleEndian */) {\n      return unpackInt32(get(this, 4, byteOffset, arguments.length > 1 ? arguments[1] : undefined)) >>> 0;\n    },\n    getFloat32: function getFloat32(byteOffset /* , littleEndian */) {\n      return unpackIEEE754(get(this, 4, byteOffset, arguments.length > 1 ? arguments[1] : undefined), 23);\n    },\n    getFloat64: function getFloat64(byteOffset /* , littleEndian */) {\n      return unpackIEEE754(get(this, 8, byteOffset, arguments.length > 1 ? arguments[1] : undefined), 52);\n    },\n    setInt8: function setInt8(byteOffset, value) {\n      set(this, 1, byteOffset, packInt8, value);\n    },\n    setUint8: function setUint8(byteOffset, value) {\n      set(this, 1, byteOffset, packInt8, value);\n    },\n    setInt16: function setInt16(byteOffset, value /* , littleEndian */) {\n      set(this, 2, byteOffset, packInt16, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setUint16: function setUint16(byteOffset, value /* , littleEndian */) {\n      set(this, 2, byteOffset, packInt16, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setInt32: function setInt32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packInt32, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setUint32: function setUint32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packInt32, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setFloat32: function setFloat32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packFloat32, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setFloat64: function setFloat64(byteOffset, value /* , littleEndian */) {\n      set(this, 8, byteOffset, packFloat64, value, arguments.length > 2 ? arguments[2] : undefined);\n    }\n  });\n} else {\n  var INCORRECT_ARRAY_BUFFER_NAME = PROPER_FUNCTION_NAME && NativeArrayBuffer.name !== ARRAY_BUFFER;\n  /* eslint-disable no-new -- required for testing */\n  if (!fails(function () {\n    NativeArrayBuffer(1);\n  }) || !fails(function () {\n    new NativeArrayBuffer(-1);\n  }) || fails(function () {\n    new NativeArrayBuffer();\n    new NativeArrayBuffer(1.5);\n    new NativeArrayBuffer(NaN);\n    return INCORRECT_ARRAY_BUFFER_NAME && !CONFIGURABLE_FUNCTION_NAME;\n  })) {\n  /* eslint-enable no-new -- required for testing */\n    $ArrayBuffer = function ArrayBuffer(length) {\n      anInstance(this, ArrayBufferPrototype);\n      return new NativeArrayBuffer(toIndex(length));\n    };\n\n    $ArrayBuffer[PROTOTYPE] = ArrayBufferPrototype;\n\n    for (var keys = getOwnPropertyNames(NativeArrayBuffer), j = 0, key; keys.length > j;) {\n      if (!((key = keys[j++]) in $ArrayBuffer)) {\n        createNonEnumerableProperty($ArrayBuffer, key, NativeArrayBuffer[key]);\n      }\n    }\n\n    ArrayBufferPrototype.constructor = $ArrayBuffer;\n  } else if (INCORRECT_ARRAY_BUFFER_NAME && CONFIGURABLE_FUNCTION_NAME) {\n    createNonEnumerableProperty(NativeArrayBuffer, 'name', ARRAY_BUFFER);\n  }\n\n  // WebKit bug - the same parent prototype for typed arrays and data view\n  if (setPrototypeOf && getPrototypeOf(DataViewPrototype) !== ObjectPrototype) {\n    setPrototypeOf(DataViewPrototype, ObjectPrototype);\n  }\n\n  // iOS Safari 7.x bug\n  var testView = new $DataView(new $ArrayBuffer(2));\n  var $setInt8 = uncurryThis(DataViewPrototype.setInt8);\n  testView.setInt8(0, 2147483648);\n  testView.setInt8(1, 2147483649);\n  if (testView.getInt8(0) || !testView.getInt8(1)) redefineAll(DataViewPrototype, {\n    setInt8: function setInt8(byteOffset, value) {\n      $setInt8(this, byteOffset, value << 24 >> 24);\n    },\n    setUint8: function setUint8(byteOffset, value) {\n      $setInt8(this, byteOffset, value << 24 >> 24);\n    }\n  }, { unsafe: true });\n}\n\nsetToStringTag($ArrayBuffer, ARRAY_BUFFER);\nsetToStringTag($DataView, DATA_VIEW);\n\nmodule.exports = {\n  ArrayBuffer: $ArrayBuffer,\n  DataView: $DataView\n};\n","// eslint-disable-next-line es/no-typed-arrays -- safe\nmodule.exports = typeof ArrayBuffer != 'undefined' && typeof DataView != 'undefined';\n","var redefine = require('../internals/redefine');\n\nmodule.exports = function (target, src, options) {\n  for (var key in src) redefine(target, key, src[key], options);\n  return target;\n};\n","var global = require('../internals/global');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\n\nvar TypeError = global.TypeError;\n\nmodule.exports = function (it, Prototype) {\n  if (isPrototypeOf(Prototype, it)) return it;\n  throw TypeError('Incorrect invocation');\n};\n","var global = require('../internals/global');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toLength = require('../internals/to-length');\n\nvar RangeError = global.RangeError;\n\n// `ToIndex` abstract operation\n// https://tc39.es/ecma262/#sec-toindex\nmodule.exports = function (it) {\n  if (it === undefined) return 0;\n  var number = toIntegerOrInfinity(it);\n  var length = toLength(number);\n  if (number !== length) throw RangeError('Wrong length or index');\n  return length;\n};\n","// IEEE754 conversions based on https://github.com/feross/ieee754\nvar global = require('../internals/global');\n\nvar Array = global.Array;\nvar abs = Math.abs;\nvar pow = Math.pow;\nvar floor = Math.floor;\nvar log = Math.log;\nvar LN2 = Math.LN2;\n\nvar pack = function (number, mantissaLength, bytes) {\n  var buffer = Array(bytes);\n  var exponentLength = bytes * 8 - mantissaLength - 1;\n  var eMax = (1 << exponentLength) - 1;\n  var eBias = eMax >> 1;\n  var rt = mantissaLength === 23 ? pow(2, -24) - pow(2, -77) : 0;\n  var sign = number < 0 || number === 0 && 1 / number < 0 ? 1 : 0;\n  var index = 0;\n  var exponent, mantissa, c;\n  number = abs(number);\n  // eslint-disable-next-line no-self-compare -- NaN check\n  if (number != number || number === Infinity) {\n    // eslint-disable-next-line no-self-compare -- NaN check\n    mantissa = number != number ? 1 : 0;\n    exponent = eMax;\n  } else {\n    exponent = floor(log(number) / LN2);\n    c = pow(2, -exponent);\n    if (number * c < 1) {\n      exponent--;\n      c *= 2;\n    }\n    if (exponent + eBias >= 1) {\n      number += rt / c;\n    } else {\n      number += rt * pow(2, 1 - eBias);\n    }\n    if (number * c >= 2) {\n      exponent++;\n      c /= 2;\n    }\n    if (exponent + eBias >= eMax) {\n      mantissa = 0;\n      exponent = eMax;\n    } else if (exponent + eBias >= 1) {\n      mantissa = (number * c - 1) * pow(2, mantissaLength);\n      exponent = exponent + eBias;\n    } else {\n      mantissa = number * pow(2, eBias - 1) * pow(2, mantissaLength);\n      exponent = 0;\n    }\n  }\n  while (mantissaLength >= 8) {\n    buffer[index++] = mantissa & 255;\n    mantissa /= 256;\n    mantissaLength -= 8;\n  }\n  exponent = exponent << mantissaLength | mantissa;\n  exponentLength += mantissaLength;\n  while (exponentLength > 0) {\n    buffer[index++] = exponent & 255;\n    exponent /= 256;\n    exponentLength -= 8;\n  }\n  buffer[--index] |= sign * 128;\n  return buffer;\n};\n\nvar unpack = function (buffer, mantissaLength) {\n  var bytes = buffer.length;\n  var exponentLength = bytes * 8 - mantissaLength - 1;\n  var eMax = (1 << exponentLength) - 1;\n  var eBias = eMax >> 1;\n  var nBits = exponentLength - 7;\n  var index = bytes - 1;\n  var sign = buffer[index--];\n  var exponent = sign & 127;\n  var mantissa;\n  sign >>= 7;\n  while (nBits > 0) {\n    exponent = exponent * 256 + buffer[index--];\n    nBits -= 8;\n  }\n  mantissa = exponent & (1 << -nBits) - 1;\n  exponent >>= -nBits;\n  nBits += mantissaLength;\n  while (nBits > 0) {\n    mantissa = mantissa * 256 + buffer[index--];\n    nBits -= 8;\n  }\n  if (exponent === 0) {\n    exponent = 1 - eBias;\n  } else if (exponent === eMax) {\n    return mantissa ? NaN : sign ? -Infinity : Infinity;\n  } else {\n    mantissa = mantissa + pow(2, mantissaLength);\n    exponent = exponent - eBias;\n  } return (sign ? -1 : 1) * mantissa * pow(2, exponent - mantissaLength);\n};\n\nmodule.exports = {\n  pack: pack,\n  unpack: unpack\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar ArrayBufferModule = require('../internals/array-buffer');\nvar anObject = require('../internals/an-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toLength = require('../internals/to-length');\nvar speciesConstructor = require('../internals/species-constructor');\n\nvar ArrayBuffer = ArrayBufferModule.ArrayBuffer;\nvar DataView = ArrayBufferModule.DataView;\nvar DataViewPrototype = DataView.prototype;\nvar un$ArrayBufferSlice = uncurryThis(ArrayBuffer.prototype.slice);\nvar getUint8 = uncurryThis(DataViewPrototype.getUint8);\nvar setUint8 = uncurryThis(DataViewPrototype.setUint8);\n\nvar INCORRECT_SLICE = fails(function () {\n  return !new ArrayBuffer(2).slice(1, undefined).byteLength;\n});\n\n// `ArrayBuffer.prototype.slice` method\n// https://tc39.es/ecma262/#sec-arraybuffer.prototype.slice\n$({ target: 'ArrayBuffer', proto: true, unsafe: true, forced: INCORRECT_SLICE }, {\n  slice: function slice(start, end) {\n    if (un$ArrayBufferSlice && end === undefined) {\n      return un$ArrayBufferSlice(anObject(this), start); // FF fix\n    }\n    var length = anObject(this).byteLength;\n    var first = toAbsoluteIndex(start, length);\n    var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n    var result = new (speciesConstructor(this, ArrayBuffer))(toLength(fin - first));\n    var viewSource = new DataView(this);\n    var viewTarget = new DataView(result);\n    var index = 0;\n    while (first < fin) {\n      setUint8(viewTarget, index++, getUint8(viewSource, first++));\n    } return result;\n  }\n});\n","var anObject = require('../internals/an-object');\nvar aConstructor = require('../internals/a-constructor');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `SpeciesConstructor` abstract operation\n// https://tc39.es/ecma262/#sec-speciesconstructor\nmodule.exports = function (O, defaultConstructor) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? defaultConstructor : aConstructor(S);\n};\n","var global = require('../internals/global');\nvar isConstructor = require('../internals/is-constructor');\nvar tryToString = require('../internals/try-to-string');\n\nvar TypeError = global.TypeError;\n\n// `Assert: IsConstructor(argument) is true`\nmodule.exports = function (argument) {\n  if (isConstructor(argument)) return argument;\n  throw TypeError(tryToString(argument) + ' is not a constructor');\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toObject = require('../internals/to-object');\nvar toPrimitive = require('../internals/to-primitive');\n\nvar FORCED = fails(function () {\n  return new Date(NaN).toJSON() !== null\n    || Date.prototype.toJSON.call({ toISOString: function () { return 1; } }) !== 1;\n});\n\n// `Date.prototype.toJSON` method\n// https://tc39.es/ecma262/#sec-date.prototype.tojson\n$({ target: 'Date', proto: true, forced: FORCED }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  toJSON: function toJSON(key) {\n    var O = toObject(this);\n    var pv = toPrimitive(O, 'number');\n    return typeof pv == 'number' && !isFinite(pv) ? null : O.toISOString();\n  }\n});\n","var hasOwn = require('../internals/has-own-property');\nvar redefine = require('../internals/redefine');\nvar dateToPrimitive = require('../internals/date-to-primitive');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\nvar DatePrototype = Date.prototype;\n\n// `Date.prototype[@@toPrimitive]` method\n// https://tc39.es/ecma262/#sec-date.prototype-@@toprimitive\nif (!hasOwn(DatePrototype, TO_PRIMITIVE)) {\n  redefine(DatePrototype, TO_PRIMITIVE, dateToPrimitive);\n}\n","'use strict';\nvar global = require('../internals/global');\nvar anObject = require('../internals/an-object');\nvar ordinaryToPrimitive = require('../internals/ordinary-to-primitive');\n\nvar TypeError = global.TypeError;\n\n// `Date.prototype[@@toPrimitive](hint)` method implementation\n// https://tc39.es/ecma262/#sec-date.prototype-@@toprimitive\nmodule.exports = function (hint) {\n  anObject(this);\n  if (hint === 'string' || hint === 'default') hint = 'string';\n  else if (hint !== 'number') throw TypeError('Incorrect hint');\n  return ordinaryToPrimitive(this, hint);\n};\n","'use strict';\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar definePropertyModule = require('../internals/object-define-property');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar HAS_INSTANCE = wellKnownSymbol('hasInstance');\nvar FunctionPrototype = Function.prototype;\n\n// `Function.prototype[@@hasInstance]` method\n// https://tc39.es/ecma262/#sec-function.prototype-@@hasinstance\nif (!(HAS_INSTANCE in FunctionPrototype)) {\n  definePropertyModule.f(FunctionPrototype, HAS_INSTANCE, { value: function (O) {\n    if (!isCallable(this) || !isObject(O)) return false;\n    var P = this.prototype;\n    if (!isObject(P)) return O instanceof this;\n    // for environment w/o native `@@hasInstance` logic enough `instanceof`, but add this:\n    while (O = getPrototypeOf(O)) if (P === O) return true;\n    return false;\n  } });\n}\n","var DESCRIPTORS = require('../internals/descriptors');\nvar FUNCTION_NAME_EXISTS = require('../internals/function-name').EXISTS;\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar FunctionPrototype = Function.prototype;\nvar functionToString = uncurryThis(FunctionPrototype.toString);\nvar nameRE = /function\\b(?:\\s|\\/\\*[\\S\\s]*?\\*\\/|\\/\\/[^\\n\\r]*[\\n\\r]+)*([^\\s(/]*)/;\nvar regExpExec = uncurryThis(nameRE.exec);\nvar NAME = 'name';\n\n// Function instances `.name` property\n// https://tc39.es/ecma262/#sec-function-instances-name\nif (DESCRIPTORS && !FUNCTION_NAME_EXISTS) {\n  defineProperty(FunctionPrototype, NAME, {\n    configurable: true,\n    get: function () {\n      try {\n        return regExpExec(nameRE, functionToString(this))[1];\n      } catch (error) {\n        return '';\n      }\n    }\n  });\n}\n","var global = require('../internals/global');\nvar setToStringTag = require('../internals/set-to-string-tag');\n\n// JSON[@@toStringTag] property\n// https://tc39.es/ecma262/#sec-json-@@tostringtag\nsetToStringTag(global.JSON, 'JSON', true);\n","'use strict';\nvar collection = require('../internals/collection');\nvar collectionStrong = require('../internals/collection-strong');\n\n// `Map` constructor\n// https://tc39.es/ecma262/#sec-map-objects\ncollection('Map', function (init) {\n  return function Map() { return init(this, arguments.length ? arguments[0] : undefined); };\n}, collectionStrong);\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isForced = require('../internals/is-forced');\nvar redefine = require('../internals/redefine');\nvar InternalMetadataModule = require('../internals/internal-metadata');\nvar iterate = require('../internals/iterate');\nvar anInstance = require('../internals/an-instance');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar fails = require('../internals/fails');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar inheritIfRequired = require('../internals/inherit-if-required');\n\nmodule.exports = function (CONSTRUCTOR_NAME, wrapper, common) {\n  var IS_MAP = CONSTRUCTOR_NAME.indexOf('Map') !== -1;\n  var IS_WEAK = CONSTRUCTOR_NAME.indexOf('Weak') !== -1;\n  var ADDER = IS_MAP ? 'set' : 'add';\n  var NativeConstructor = global[CONSTRUCTOR_NAME];\n  var NativePrototype = NativeConstructor && NativeConstructor.prototype;\n  var Constructor = NativeConstructor;\n  var exported = {};\n\n  var fixMethod = function (KEY) {\n    var uncurriedNativeMethod = uncurryThis(NativePrototype[KEY]);\n    redefine(NativePrototype, KEY,\n      KEY == 'add' ? function add(value) {\n        uncurriedNativeMethod(this, value === 0 ? 0 : value);\n        return this;\n      } : KEY == 'delete' ? function (key) {\n        return IS_WEAK && !isObject(key) ? false : uncurriedNativeMethod(this, key === 0 ? 0 : key);\n      } : KEY == 'get' ? function get(key) {\n        return IS_WEAK && !isObject(key) ? undefined : uncurriedNativeMethod(this, key === 0 ? 0 : key);\n      } : KEY == 'has' ? function has(key) {\n        return IS_WEAK && !isObject(key) ? false : uncurriedNativeMethod(this, key === 0 ? 0 : key);\n      } : function set(key, value) {\n        uncurriedNativeMethod(this, key === 0 ? 0 : key, value);\n        return this;\n      }\n    );\n  };\n\n  var REPLACE = isForced(\n    CONSTRUCTOR_NAME,\n    !isCallable(NativeConstructor) || !(IS_WEAK || NativePrototype.forEach && !fails(function () {\n      new NativeConstructor().entries().next();\n    }))\n  );\n\n  if (REPLACE) {\n    // create collection constructor\n    Constructor = common.getConstructor(wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER);\n    InternalMetadataModule.enable();\n  } else if (isForced(CONSTRUCTOR_NAME, true)) {\n    var instance = new Constructor();\n    // early implementations not supports chaining\n    var HASNT_CHAINING = instance[ADDER](IS_WEAK ? {} : -0, 1) != instance;\n    // V8 ~ Chromium 40- weak-collections throws on primitives, but should return false\n    var THROWS_ON_PRIMITIVES = fails(function () { instance.has(1); });\n    // most early implementations doesn't supports iterables, most modern - not close it correctly\n    // eslint-disable-next-line no-new -- required for testing\n    var ACCEPT_ITERABLES = checkCorrectnessOfIteration(function (iterable) { new NativeConstructor(iterable); });\n    // for early implementations -0 and +0 not the same\n    var BUGGY_ZERO = !IS_WEAK && fails(function () {\n      // V8 ~ Chromium 42- fails only with 5+ elements\n      var $instance = new NativeConstructor();\n      var index = 5;\n      while (index--) $instance[ADDER](index, index);\n      return !$instance.has(-0);\n    });\n\n    if (!ACCEPT_ITERABLES) {\n      Constructor = wrapper(function (dummy, iterable) {\n        anInstance(dummy, NativePrototype);\n        var that = inheritIfRequired(new NativeConstructor(), dummy, Constructor);\n        if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n        return that;\n      });\n      Constructor.prototype = NativePrototype;\n      NativePrototype.constructor = Constructor;\n    }\n\n    if (THROWS_ON_PRIMITIVES || BUGGY_ZERO) {\n      fixMethod('delete');\n      fixMethod('has');\n      IS_MAP && fixMethod('get');\n    }\n\n    if (BUGGY_ZERO || HASNT_CHAINING) fixMethod(ADDER);\n\n    // weak collections should not contains .clear method\n    if (IS_WEAK && NativePrototype.clear) delete NativePrototype.clear;\n  }\n\n  exported[CONSTRUCTOR_NAME] = Constructor;\n  $({ global: true, forced: Constructor != NativeConstructor }, exported);\n\n  setToStringTag(Constructor, CONSTRUCTOR_NAME);\n\n  if (!IS_WEAK) common.setStrong(Constructor, CONSTRUCTOR_NAME, IS_MAP);\n\n  return Constructor;\n};\n","var $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar isObject = require('../internals/is-object');\nvar hasOwn = require('../internals/has-own-property');\nvar defineProperty = require('../internals/object-define-property').f;\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertyNamesExternalModule = require('../internals/object-get-own-property-names-external');\nvar isExtensible = require('../internals/object-is-extensible');\nvar uid = require('../internals/uid');\nvar FREEZING = require('../internals/freezing');\n\nvar REQUIRED = false;\nvar METADATA = uid('meta');\nvar id = 0;\n\nvar setMetadata = function (it) {\n  defineProperty(it, METADATA, { value: {\n    objectID: 'O' + id++, // object ID\n    weakData: {}          // weak collections IDs\n  } });\n};\n\nvar fastKey = function (it, create) {\n  // return a primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!hasOwn(it, METADATA)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMetadata(it);\n  // return object ID\n  } return it[METADATA].objectID;\n};\n\nvar getWeakData = function (it, create) {\n  if (!hasOwn(it, METADATA)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMetadata(it);\n  // return the store of weak collections IDs\n  } return it[METADATA].weakData;\n};\n\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZING && REQUIRED && isExtensible(it) && !hasOwn(it, METADATA)) setMetadata(it);\n  return it;\n};\n\nvar enable = function () {\n  meta.enable = function () { /* empty */ };\n  REQUIRED = true;\n  var getOwnPropertyNames = getOwnPropertyNamesModule.f;\n  var splice = uncurryThis([].splice);\n  var test = {};\n  test[METADATA] = 1;\n\n  // prevent exposing of metadata key\n  if (getOwnPropertyNames(test).length) {\n    getOwnPropertyNamesModule.f = function (it) {\n      var result = getOwnPropertyNames(it);\n      for (var i = 0, length = result.length; i < length; i++) {\n        if (result[i] === METADATA) {\n          splice(result, i, 1);\n          break;\n        }\n      } return result;\n    };\n\n    $({ target: 'Object', stat: true, forced: true }, {\n      getOwnPropertyNames: getOwnPropertyNamesExternalModule.f\n    });\n  }\n};\n\nvar meta = module.exports = {\n  enable: enable,\n  fastKey: fastKey,\n  getWeakData: getWeakData,\n  onFreeze: onFreeze\n};\n\nhiddenKeys[METADATA] = true;\n","var fails = require('../internals/fails');\nvar isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar ARRAY_BUFFER_NON_EXTENSIBLE = require('../internals/array-buffer-non-extensible');\n\n// eslint-disable-next-line es/no-object-isextensible -- safe\nvar $isExtensible = Object.isExtensible;\nvar FAILS_ON_PRIMITIVES = fails(function () { $isExtensible(1); });\n\n// `Object.isExtensible` method\n// https://tc39.es/ecma262/#sec-object.isextensible\nmodule.exports = (FAILS_ON_PRIMITIVES || ARRAY_BUFFER_NON_EXTENSIBLE) ? function isExtensible(it) {\n  if (!isObject(it)) return false;\n  if (ARRAY_BUFFER_NON_EXTENSIBLE && classof(it) == 'ArrayBuffer') return false;\n  return $isExtensible ? $isExtensible(it) : true;\n} : $isExtensible;\n","// FF26- bug: ArrayBuffers are non-extensible, but Object.isExtensible does not report it\nvar fails = require('../internals/fails');\n\nmodule.exports = fails(function () {\n  if (typeof ArrayBuffer == 'function') {\n    var buffer = new ArrayBuffer(8);\n    // eslint-disable-next-line es/no-object-isextensible, es/no-object-defineproperty -- safe\n    if (Object.isExtensible(buffer)) Object.defineProperty(buffer, 'a', { value: 8 });\n  }\n});\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-isextensible, es/no-object-preventextensions -- required for testing\n  return Object.isExtensible(Object.preventExtensions({}));\n});\n","var global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar tryToString = require('../internals/try-to-string');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar iteratorClose = require('../internals/iterator-close');\n\nvar TypeError = global.TypeError;\n\nvar Result = function (stopped, result) {\n  this.stopped = stopped;\n  this.result = result;\n};\n\nvar ResultPrototype = Result.prototype;\n\nmodule.exports = function (iterable, unboundFunction, options) {\n  var that = options && options.that;\n  var AS_ENTRIES = !!(options && options.AS_ENTRIES);\n  var IS_ITERATOR = !!(options && options.IS_ITERATOR);\n  var INTERRUPTED = !!(options && options.INTERRUPTED);\n  var fn = bind(unboundFunction, that);\n  var iterator, iterFn, index, length, result, next, step;\n\n  var stop = function (condition) {\n    if (iterator) iteratorClose(iterator, 'normal', condition);\n    return new Result(true, condition);\n  };\n\n  var callFn = function (value) {\n    if (AS_ENTRIES) {\n      anObject(value);\n      return INTERRUPTED ? fn(value[0], value[1], stop) : fn(value[0], value[1]);\n    } return INTERRUPTED ? fn(value, stop) : fn(value);\n  };\n\n  if (IS_ITERATOR) {\n    iterator = iterable;\n  } else {\n    iterFn = getIteratorMethod(iterable);\n    if (!iterFn) throw TypeError(tryToString(iterable) + ' is not iterable');\n    // optimisation for array iterators\n    if (isArrayIteratorMethod(iterFn)) {\n      for (index = 0, length = lengthOfArrayLike(iterable); length > index; index++) {\n        result = callFn(iterable[index]);\n        if (result && isPrototypeOf(ResultPrototype, result)) return result;\n      } return new Result(false);\n    }\n    iterator = getIterator(iterable, iterFn);\n  }\n\n  next = iterator.next;\n  while (!(step = call(next, iterator)).done) {\n    try {\n      result = callFn(step.value);\n    } catch (error) {\n      iteratorClose(iterator, 'throw', error);\n    }\n    if (typeof result == 'object' && result && isPrototypeOf(ResultPrototype, result)) return result;\n  } return new Result(false);\n};\n","var isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\n\n// makes subclassing work correct for wrapped built-ins\nmodule.exports = function ($this, dummy, Wrapper) {\n  var NewTarget, NewTargetPrototype;\n  if (\n    // it can work only with native `setPrototypeOf`\n    setPrototypeOf &&\n    // we haven't completely correct pre-ES6 way for getting `new.target`, so use this\n    isCallable(NewTarget = dummy.constructor) &&\n    NewTarget !== Wrapper &&\n    isObject(NewTargetPrototype = NewTarget.prototype) &&\n    NewTargetPrototype !== Wrapper.prototype\n  ) setPrototypeOf($this, NewTargetPrototype);\n  return $this;\n};\n","'use strict';\nvar defineProperty = require('../internals/object-define-property').f;\nvar create = require('../internals/object-create');\nvar redefineAll = require('../internals/redefine-all');\nvar bind = require('../internals/function-bind-context');\nvar anInstance = require('../internals/an-instance');\nvar iterate = require('../internals/iterate');\nvar defineIterator = require('../internals/define-iterator');\nvar setSpecies = require('../internals/set-species');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar fastKey = require('../internals/internal-metadata').fastKey;\nvar InternalStateModule = require('../internals/internal-state');\n\nvar setInternalState = InternalStateModule.set;\nvar internalStateGetterFor = InternalStateModule.getterFor;\n\nmodule.exports = {\n  getConstructor: function (wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER) {\n    var Constructor = wrapper(function (that, iterable) {\n      anInstance(that, Prototype);\n      setInternalState(that, {\n        type: CONSTRUCTOR_NAME,\n        index: create(null),\n        first: undefined,\n        last: undefined,\n        size: 0\n      });\n      if (!DESCRIPTORS) that.size = 0;\n      if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n    });\n\n    var Prototype = Constructor.prototype;\n\n    var getInternalState = internalStateGetterFor(CONSTRUCTOR_NAME);\n\n    var define = function (that, key, value) {\n      var state = getInternalState(that);\n      var entry = getEntry(that, key);\n      var previous, index;\n      // change existing entry\n      if (entry) {\n        entry.value = value;\n      // create new entry\n      } else {\n        state.last = entry = {\n          index: index = fastKey(key, true),\n          key: key,\n          value: value,\n          previous: previous = state.last,\n          next: undefined,\n          removed: false\n        };\n        if (!state.first) state.first = entry;\n        if (previous) previous.next = entry;\n        if (DESCRIPTORS) state.size++;\n        else that.size++;\n        // add to index\n        if (index !== 'F') state.index[index] = entry;\n      } return that;\n    };\n\n    var getEntry = function (that, key) {\n      var state = getInternalState(that);\n      // fast case\n      var index = fastKey(key);\n      var entry;\n      if (index !== 'F') return state.index[index];\n      // frozen object case\n      for (entry = state.first; entry; entry = entry.next) {\n        if (entry.key == key) return entry;\n      }\n    };\n\n    redefineAll(Prototype, {\n      // `{ Map, Set }.prototype.clear()` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.clear\n      // https://tc39.es/ecma262/#sec-set.prototype.clear\n      clear: function clear() {\n        var that = this;\n        var state = getInternalState(that);\n        var data = state.index;\n        var entry = state.first;\n        while (entry) {\n          entry.removed = true;\n          if (entry.previous) entry.previous = entry.previous.next = undefined;\n          delete data[entry.index];\n          entry = entry.next;\n        }\n        state.first = state.last = undefined;\n        if (DESCRIPTORS) state.size = 0;\n        else that.size = 0;\n      },\n      // `{ Map, Set }.prototype.delete(key)` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.delete\n      // https://tc39.es/ecma262/#sec-set.prototype.delete\n      'delete': function (key) {\n        var that = this;\n        var state = getInternalState(that);\n        var entry = getEntry(that, key);\n        if (entry) {\n          var next = entry.next;\n          var prev = entry.previous;\n          delete state.index[entry.index];\n          entry.removed = true;\n          if (prev) prev.next = next;\n          if (next) next.previous = prev;\n          if (state.first == entry) state.first = next;\n          if (state.last == entry) state.last = prev;\n          if (DESCRIPTORS) state.size--;\n          else that.size--;\n        } return !!entry;\n      },\n      // `{ Map, Set }.prototype.forEach(callbackfn, thisArg = undefined)` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.foreach\n      // https://tc39.es/ecma262/#sec-set.prototype.foreach\n      forEach: function forEach(callbackfn /* , that = undefined */) {\n        var state = getInternalState(this);\n        var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n        var entry;\n        while (entry = entry ? entry.next : state.first) {\n          boundFunction(entry.value, entry.key, this);\n          // revert to the last existing entry\n          while (entry && entry.removed) entry = entry.previous;\n        }\n      },\n      // `{ Map, Set}.prototype.has(key)` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.has\n      // https://tc39.es/ecma262/#sec-set.prototype.has\n      has: function has(key) {\n        return !!getEntry(this, key);\n      }\n    });\n\n    redefineAll(Prototype, IS_MAP ? {\n      // `Map.prototype.get(key)` method\n      // https://tc39.es/ecma262/#sec-map.prototype.get\n      get: function get(key) {\n        var entry = getEntry(this, key);\n        return entry && entry.value;\n      },\n      // `Map.prototype.set(key, value)` method\n      // https://tc39.es/ecma262/#sec-map.prototype.set\n      set: function set(key, value) {\n        return define(this, key === 0 ? 0 : key, value);\n      }\n    } : {\n      // `Set.prototype.add(value)` method\n      // https://tc39.es/ecma262/#sec-set.prototype.add\n      add: function add(value) {\n        return define(this, value = value === 0 ? 0 : value, value);\n      }\n    });\n    if (DESCRIPTORS) defineProperty(Prototype, 'size', {\n      get: function () {\n        return getInternalState(this).size;\n      }\n    });\n    return Constructor;\n  },\n  setStrong: function (Constructor, CONSTRUCTOR_NAME, IS_MAP) {\n    var ITERATOR_NAME = CONSTRUCTOR_NAME + ' Iterator';\n    var getInternalCollectionState = internalStateGetterFor(CONSTRUCTOR_NAME);\n    var getInternalIteratorState = internalStateGetterFor(ITERATOR_NAME);\n    // `{ Map, Set }.prototype.{ keys, values, entries, @@iterator }()` methods\n    // https://tc39.es/ecma262/#sec-map.prototype.entries\n    // https://tc39.es/ecma262/#sec-map.prototype.keys\n    // https://tc39.es/ecma262/#sec-map.prototype.values\n    // https://tc39.es/ecma262/#sec-map.prototype-@@iterator\n    // https://tc39.es/ecma262/#sec-set.prototype.entries\n    // https://tc39.es/ecma262/#sec-set.prototype.keys\n    // https://tc39.es/ecma262/#sec-set.prototype.values\n    // https://tc39.es/ecma262/#sec-set.prototype-@@iterator\n    defineIterator(Constructor, CONSTRUCTOR_NAME, function (iterated, kind) {\n      setInternalState(this, {\n        type: ITERATOR_NAME,\n        target: iterated,\n        state: getInternalCollectionState(iterated),\n        kind: kind,\n        last: undefined\n      });\n    }, function () {\n      var state = getInternalIteratorState(this);\n      var kind = state.kind;\n      var entry = state.last;\n      // revert to the last existing entry\n      while (entry && entry.removed) entry = entry.previous;\n      // get next entry\n      if (!state.target || !(state.last = entry = entry ? entry.next : state.state.first)) {\n        // or finish the iteration\n        state.target = undefined;\n        return { value: undefined, done: true };\n      }\n      // return step by kind\n      if (kind == 'keys') return { value: entry.key, done: false };\n      if (kind == 'values') return { value: entry.value, done: false };\n      return { value: [entry.key, entry.value], done: false };\n    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);\n\n    // `{ Map, Set }.prototype[@@species]` accessors\n    // https://tc39.es/ecma262/#sec-get-map-@@species\n    // https://tc39.es/ecma262/#sec-get-set-@@species\n    setSpecies(CONSTRUCTOR_NAME);\n  }\n};\n","var $ = require('../internals/export');\nvar log1p = require('../internals/math-log1p');\n\n// eslint-disable-next-line es/no-math-acosh -- required for testing\nvar $acosh = Math.acosh;\nvar log = Math.log;\nvar sqrt = Math.sqrt;\nvar LN2 = Math.LN2;\n\nvar FORCED = !$acosh\n  // V8 bug: https://code.google.com/p/v8/issues/detail?id=3509\n  || Math.floor($acosh(Number.MAX_VALUE)) != 710\n  // Tor Browser bug: Math.acosh(Infinity) -> NaN\n  || $acosh(Infinity) != Infinity;\n\n// `Math.acosh` method\n// https://tc39.es/ecma262/#sec-math.acosh\n$({ target: 'Math', stat: true, forced: FORCED }, {\n  acosh: function acosh(x) {\n    return (x = +x) < 1 ? NaN : x > 94906265.62425156\n      ? log(x) + LN2\n      : log1p(x - 1 + sqrt(x - 1) * sqrt(x + 1));\n  }\n});\n","var log = Math.log;\n\n// `Math.log1p` method implementation\n// https://tc39.es/ecma262/#sec-math.log1p\n// eslint-disable-next-line es/no-math-log1p -- safe\nmodule.exports = Math.log1p || function log1p(x) {\n  return (x = +x) > -1e-8 && x < 1e-8 ? x - x * x / 2 : log(1 + x);\n};\n","var $ = require('../internals/export');\n\n// eslint-disable-next-line es/no-math-asinh -- required for testing\nvar $asinh = Math.asinh;\nvar log = Math.log;\nvar sqrt = Math.sqrt;\n\nfunction asinh(x) {\n  return !isFinite(x = +x) || x == 0 ? x : x < 0 ? -asinh(-x) : log(x + sqrt(x * x + 1));\n}\n\n// `Math.asinh` method\n// https://tc39.es/ecma262/#sec-math.asinh\n// Tor Browser bug: Math.asinh(0) -> -0\n$({ target: 'Math', stat: true, forced: !($asinh && 1 / $asinh(0) > 0) }, {\n  asinh: asinh\n});\n","var $ = require('../internals/export');\n\n// eslint-disable-next-line es/no-math-atanh -- required for testing\nvar $atanh = Math.atanh;\nvar log = Math.log;\n\n// `Math.atanh` method\n// https://tc39.es/ecma262/#sec-math.atanh\n// Tor Browser bug: Math.atanh(-0) -> 0\n$({ target: 'Math', stat: true, forced: !($atanh && 1 / $atanh(-0) < 0) }, {\n  atanh: function atanh(x) {\n    return (x = +x) == 0 ? x : log((1 + x) / (1 - x)) / 2;\n  }\n});\n","var $ = require('../internals/export');\nvar sign = require('../internals/math-sign');\n\nvar abs = Math.abs;\nvar pow = Math.pow;\n\n// `Math.cbrt` method\n// https://tc39.es/ecma262/#sec-math.cbrt\n$({ target: 'Math', stat: true }, {\n  cbrt: function cbrt(x) {\n    return sign(x = +x) * pow(abs(x), 1 / 3);\n  }\n});\n","// `Math.sign` method implementation\n// https://tc39.es/ecma262/#sec-math.sign\n// eslint-disable-next-line es/no-math-sign -- safe\nmodule.exports = Math.sign || function sign(x) {\n  // eslint-disable-next-line no-self-compare -- NaN check\n  return (x = +x) == 0 || x != x ? x : x < 0 ? -1 : 1;\n};\n","var $ = require('../internals/export');\n\nvar floor = Math.floor;\nvar log = Math.log;\nvar LOG2E = Math.LOG2E;\n\n// `Math.clz32` method\n// https://tc39.es/ecma262/#sec-math.clz32\n$({ target: 'Math', stat: true }, {\n  clz32: function clz32(x) {\n    return (x >>>= 0) ? 31 - floor(log(x + 0.5) * LOG2E) : 32;\n  }\n});\n","var $ = require('../internals/export');\nvar expm1 = require('../internals/math-expm1');\n\n// eslint-disable-next-line es/no-math-cosh -- required for testing\nvar $cosh = Math.cosh;\nvar abs = Math.abs;\nvar E = Math.E;\n\n// `Math.cosh` method\n// https://tc39.es/ecma262/#sec-math.cosh\n$({ target: 'Math', stat: true, forced: !$cosh || $cosh(710) === Infinity }, {\n  cosh: function cosh(x) {\n    var t = expm1(abs(x) - 1) + 1;\n    return (t + 1 / (t * E * E)) * (E / 2);\n  }\n});\n","// eslint-disable-next-line es/no-math-expm1 -- safe\nvar $expm1 = Math.expm1;\nvar exp = Math.exp;\n\n// `Math.expm1` method implementation\n// https://tc39.es/ecma262/#sec-math.expm1\nmodule.exports = (!$expm1\n  // Old FF bug\n  || $expm1(10) > 22025.465794806719 || $expm1(10) < 22025.4657948067165168\n  // Tor Browser bug\n  || $expm1(-2e-17) != -2e-17\n) ? function expm1(x) {\n  return (x = +x) == 0 ? x : x > -1e-6 && x < 1e-6 ? x + x * x / 2 : exp(x) - 1;\n} : $expm1;\n","var $ = require('../internals/export');\nvar expm1 = require('../internals/math-expm1');\n\n// `Math.expm1` method\n// https://tc39.es/ecma262/#sec-math.expm1\n// eslint-disable-next-line es/no-math-expm1 -- required for testing\n$({ target: 'Math', stat: true, forced: expm1 != Math.expm1 }, { expm1: expm1 });\n","var $ = require('../internals/export');\nvar fround = require('../internals/math-fround');\n\n// `Math.fround` method\n// https://tc39.es/ecma262/#sec-math.fround\n$({ target: 'Math', stat: true }, { fround: fround });\n","var sign = require('../internals/math-sign');\n\nvar abs = Math.abs;\nvar pow = Math.pow;\nvar EPSILON = pow(2, -52);\nvar EPSILON32 = pow(2, -23);\nvar MAX32 = pow(2, 127) * (2 - EPSILON32);\nvar MIN32 = pow(2, -126);\n\nvar roundTiesToEven = function (n) {\n  return n + 1 / EPSILON - 1 / EPSILON;\n};\n\n// `Math.fround` method implementation\n// https://tc39.es/ecma262/#sec-math.fround\n// eslint-disable-next-line es/no-math-fround -- safe\nmodule.exports = Math.fround || function fround(x) {\n  var $abs = abs(x);\n  var $sign = sign(x);\n  var a, result;\n  if ($abs < MIN32) return $sign * roundTiesToEven($abs / MIN32 / EPSILON32) * MIN32 * EPSILON32;\n  a = (1 + EPSILON32 / EPSILON) * $abs;\n  result = a - (a - $abs);\n  // eslint-disable-next-line no-self-compare -- NaN check\n  if (result > MAX32 || result != result) return $sign * Infinity;\n  return $sign * result;\n};\n","var $ = require('../internals/export');\n\n// eslint-disable-next-line es/no-math-hypot -- required for testing\nvar $hypot = Math.hypot;\nvar abs = Math.abs;\nvar sqrt = Math.sqrt;\n\n// Chrome 77 bug\n// https://bugs.chromium.org/p/v8/issues/detail?id=9546\nvar BUGGY = !!$hypot && $hypot(Infinity, NaN) !== Infinity;\n\n// `Math.hypot` method\n// https://tc39.es/ecma262/#sec-math.hypot\n$({ target: 'Math', stat: true, forced: BUGGY }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  hypot: function hypot(value1, value2) {\n    var sum = 0;\n    var i = 0;\n    var aLen = arguments.length;\n    var larg = 0;\n    var arg, div;\n    while (i < aLen) {\n      arg = abs(arguments[i++]);\n      if (larg < arg) {\n        div = larg / arg;\n        sum = sum * div * div + 1;\n        larg = arg;\n      } else if (arg > 0) {\n        div = arg / larg;\n        sum += div * div;\n      } else sum += arg;\n    }\n    return larg === Infinity ? Infinity : larg * sqrt(sum);\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-math-imul -- required for testing\nvar $imul = Math.imul;\n\nvar FORCED = fails(function () {\n  return $imul(0xFFFFFFFF, 5) != -5 || $imul.length != 2;\n});\n\n// `Math.imul` method\n// https://tc39.es/ecma262/#sec-math.imul\n// some WebKit versions fails with big numbers, some has wrong arity\n$({ target: 'Math', stat: true, forced: FORCED }, {\n  imul: function imul(x, y) {\n    var UINT16 = 0xFFFF;\n    var xn = +x;\n    var yn = +y;\n    var xl = UINT16 & xn;\n    var yl = UINT16 & yn;\n    return 0 | xl * yl + ((UINT16 & xn >>> 16) * yl + xl * (UINT16 & yn >>> 16) << 16 >>> 0);\n  }\n});\n","var $ = require('../internals/export');\nvar log10 = require('../internals/math-log10');\n\n// `Math.log10` method\n// https://tc39.es/ecma262/#sec-math.log10\n$({ target: 'Math', stat: true }, {\n  log10: log10\n});\n","var log = Math.log;\nvar LOG10E = Math.LOG10E;\n\n// eslint-disable-next-line es/no-math-log10 -- safe\nmodule.exports = Math.log10 || function log10(x) {\n  return log(x) * LOG10E;\n};\n","var $ = require('../internals/export');\nvar log1p = require('../internals/math-log1p');\n\n// `Math.log1p` method\n// https://tc39.es/ecma262/#sec-math.log1p\n$({ target: 'Math', stat: true }, { log1p: log1p });\n","var $ = require('../internals/export');\n\nvar log = Math.log;\nvar LN2 = Math.LN2;\n\n// `Math.log2` method\n// https://tc39.es/ecma262/#sec-math.log2\n$({ target: 'Math', stat: true }, {\n  log2: function log2(x) {\n    return log(x) / LN2;\n  }\n});\n","var $ = require('../internals/export');\nvar sign = require('../internals/math-sign');\n\n// `Math.sign` method\n// https://tc39.es/ecma262/#sec-math.sign\n$({ target: 'Math', stat: true }, {\n  sign: sign\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar expm1 = require('../internals/math-expm1');\n\nvar abs = Math.abs;\nvar exp = Math.exp;\nvar E = Math.E;\n\nvar FORCED = fails(function () {\n  // eslint-disable-next-line es/no-math-sinh -- required for testing\n  return Math.sinh(-2e-17) != -2e-17;\n});\n\n// `Math.sinh` method\n// https://tc39.es/ecma262/#sec-math.sinh\n// V8 near Chromium 38 has a problem with very small numbers\n$({ target: 'Math', stat: true, forced: FORCED }, {\n  sinh: function sinh(x) {\n    return abs(x = +x) < 1 ? (expm1(x) - expm1(-x)) / 2 : (exp(x - 1) - exp(-x - 1)) * (E / 2);\n  }\n});\n","var $ = require('../internals/export');\nvar expm1 = require('../internals/math-expm1');\n\nvar exp = Math.exp;\n\n// `Math.tanh` method\n// https://tc39.es/ecma262/#sec-math.tanh\n$({ target: 'Math', stat: true }, {\n  tanh: function tanh(x) {\n    var a = expm1(x = +x);\n    var b = expm1(-x);\n    return a == Infinity ? 1 : b == Infinity ? -1 : (a - b) / (exp(x) + exp(-x));\n  }\n});\n","var setToStringTag = require('../internals/set-to-string-tag');\n\n// Math[@@toStringTag] property\n// https://tc39.es/ecma262/#sec-math-@@tostringtag\nsetToStringTag(Math, 'Math', true);\n","var $ = require('../internals/export');\n\nvar ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `Math.trunc` method\n// https://tc39.es/ecma262/#sec-math.trunc\n$({ target: 'Math', stat: true }, {\n  trunc: function trunc(it) {\n    return (it > 0 ? floor : ceil)(it);\n  }\n});\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isForced = require('../internals/is-forced');\nvar redefine = require('../internals/redefine');\nvar hasOwn = require('../internals/has-own-property');\nvar inheritIfRequired = require('../internals/inherit-if-required');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar isSymbol = require('../internals/is-symbol');\nvar toPrimitive = require('../internals/to-primitive');\nvar fails = require('../internals/fails');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar defineProperty = require('../internals/object-define-property').f;\nvar thisNumberValue = require('../internals/this-number-value');\nvar trim = require('../internals/string-trim').trim;\n\nvar NUMBER = 'Number';\nvar NativeNumber = global[NUMBER];\nvar NumberPrototype = NativeNumber.prototype;\nvar TypeError = global.TypeError;\nvar arraySlice = uncurryThis(''.slice);\nvar charCodeAt = uncurryThis(''.charCodeAt);\n\n// `ToNumeric` abstract operation\n// https://tc39.es/ecma262/#sec-tonumeric\nvar toNumeric = function (value) {\n  var primValue = toPrimitive(value, 'number');\n  return typeof primValue == 'bigint' ? primValue : toNumber(primValue);\n};\n\n// `ToNumber` abstract operation\n// https://tc39.es/ecma262/#sec-tonumber\nvar toNumber = function (argument) {\n  var it = toPrimitive(argument, 'number');\n  var first, third, radix, maxCode, digits, length, index, code;\n  if (isSymbol(it)) throw TypeError('Cannot convert a Symbol value to a number');\n  if (typeof it == 'string' && it.length > 2) {\n    it = trim(it);\n    first = charCodeAt(it, 0);\n    if (first === 43 || first === 45) {\n      third = charCodeAt(it, 2);\n      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix\n    } else if (first === 48) {\n      switch (charCodeAt(it, 1)) {\n        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal of /^0b[01]+$/i\n        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal of /^0o[0-7]+$/i\n        default: return +it;\n      }\n      digits = arraySlice(it, 2);\n      length = digits.length;\n      for (index = 0; index < length; index++) {\n        code = charCodeAt(digits, index);\n        // parseInt parses a string to a first unavailable symbol\n        // but ToNumber should return NaN if a string contains unavailable symbols\n        if (code < 48 || code > maxCode) return NaN;\n      } return parseInt(digits, radix);\n    }\n  } return +it;\n};\n\n// `Number` constructor\n// https://tc39.es/ecma262/#sec-number-constructor\nif (isForced(NUMBER, !NativeNumber(' 0o1') || !NativeNumber('0b1') || NativeNumber('+0x1'))) {\n  var NumberWrapper = function Number(value) {\n    var n = arguments.length < 1 ? 0 : NativeNumber(toNumeric(value));\n    var dummy = this;\n    // check on 1..constructor(foo) case\n    return isPrototypeOf(NumberPrototype, dummy) && fails(function () { thisNumberValue(dummy); })\n      ? inheritIfRequired(Object(n), dummy, NumberWrapper) : n;\n  };\n  for (var keys = DESCRIPTORS ? getOwnPropertyNames(NativeNumber) : (\n    // ES3:\n    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +\n    // ES2015 (in case, if modules with ES2015 Number statics required before):\n    'EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,' +\n    // ESNext\n    'fromString,range'\n  ).split(','), j = 0, key; keys.length > j; j++) {\n    if (hasOwn(NativeNumber, key = keys[j]) && !hasOwn(NumberWrapper, key)) {\n      defineProperty(NumberWrapper, key, getOwnPropertyDescriptor(NativeNumber, key));\n    }\n  }\n  NumberWrapper.prototype = NumberPrototype;\n  NumberPrototype.constructor = NumberWrapper;\n  redefine(global, NUMBER, NumberWrapper);\n}\n","var uncurryThis = require('../internals/function-uncurry-this');\n\n// `thisNumberValue` abstract operation\n// https://tc39.es/ecma262/#sec-thisnumbervalue\nmodule.exports = uncurryThis(1.0.valueOf);\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toString = require('../internals/to-string');\nvar whitespaces = require('../internals/whitespaces');\n\nvar replace = uncurryThis(''.replace);\nvar whitespace = '[' + whitespaces + ']';\nvar ltrim = RegExp('^' + whitespace + whitespace + '*');\nvar rtrim = RegExp(whitespace + whitespace + '*$');\n\n// `String.prototype.{ trim, trimStart, trimEnd, trimLeft, trimRight }` methods implementation\nvar createMethod = function (TYPE) {\n  return function ($this) {\n    var string = toString(requireObjectCoercible($this));\n    if (TYPE & 1) string = replace(string, ltrim, '');\n    if (TYPE & 2) string = replace(string, rtrim, '');\n    return string;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.{ trimLeft, trimStart }` methods\n  // https://tc39.es/ecma262/#sec-string.prototype.trimstart\n  start: createMethod(1),\n  // `String.prototype.{ trimRight, trimEnd }` methods\n  // https://tc39.es/ecma262/#sec-string.prototype.trimend\n  end: createMethod(2),\n  // `String.prototype.trim` method\n  // https://tc39.es/ecma262/#sec-string.prototype.trim\n  trim: createMethod(3)\n};\n","// a string of all valid unicode whitespaces\nmodule.exports = '\\u0009\\u000A\\u000B\\u000C\\u000D\\u0020\\u00A0\\u1680\\u2000\\u2001\\u2002' +\n  '\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n","var $ = require('../internals/export');\n\n// `Number.EPSILON` constant\n// https://tc39.es/ecma262/#sec-number.epsilon\n$({ target: 'Number', stat: true }, {\n  EPSILON: Math.pow(2, -52)\n});\n","var $ = require('../internals/export');\nvar numberIsFinite = require('../internals/number-is-finite');\n\n// `Number.isFinite` method\n// https://tc39.es/ecma262/#sec-number.isfinite\n$({ target: 'Number', stat: true }, { isFinite: numberIsFinite });\n","var global = require('../internals/global');\n\nvar globalIsFinite = global.isFinite;\n\n// `Number.isFinite` method\n// https://tc39.es/ecma262/#sec-number.isfinite\n// eslint-disable-next-line es/no-number-isfinite -- safe\nmodule.exports = Number.isFinite || function isFinite(it) {\n  return typeof it == 'number' && globalIsFinite(it);\n};\n","var $ = require('../internals/export');\nvar isIntegralNumber = require('../internals/is-integral-number');\n\n// `Number.isInteger` method\n// https://tc39.es/ecma262/#sec-number.isinteger\n$({ target: 'Number', stat: true }, {\n  isInteger: isIntegralNumber\n});\n","var isObject = require('../internals/is-object');\n\nvar floor = Math.floor;\n\n// `IsIntegralNumber` abstract operation\n// https://tc39.es/ecma262/#sec-isintegralnumber\n// eslint-disable-next-line es/no-number-isinteger -- safe\nmodule.exports = Number.isInteger || function isInteger(it) {\n  return !isObject(it) && isFinite(it) && floor(it) === it;\n};\n","var $ = require('../internals/export');\n\n// `Number.isNaN` method\n// https://tc39.es/ecma262/#sec-number.isnan\n$({ target: 'Number', stat: true }, {\n  isNaN: function isNaN(number) {\n    // eslint-disable-next-line no-self-compare -- NaN check\n    return number != number;\n  }\n});\n","var $ = require('../internals/export');\nvar isIntegralNumber = require('../internals/is-integral-number');\n\nvar abs = Math.abs;\n\n// `Number.isSafeInteger` method\n// https://tc39.es/ecma262/#sec-number.issafeinteger\n$({ target: 'Number', stat: true }, {\n  isSafeInteger: function isSafeInteger(number) {\n    return isIntegralNumber(number) && abs(number) <= 0x1FFFFFFFFFFFFF;\n  }\n});\n","var $ = require('../internals/export');\n\n// `Number.MAX_SAFE_INTEGER` constant\n// https://tc39.es/ecma262/#sec-number.max_safe_integer\n$({ target: 'Number', stat: true }, {\n  MAX_SAFE_INTEGER: 0x1FFFFFFFFFFFFF\n});\n","var $ = require('../internals/export');\n\n// `Number.MIN_SAFE_INTEGER` constant\n// https://tc39.es/ecma262/#sec-number.min_safe_integer\n$({ target: 'Number', stat: true }, {\n  MIN_SAFE_INTEGER: -0x1FFFFFFFFFFFFF\n});\n","var $ = require('../internals/export');\nvar parseFloat = require('../internals/number-parse-float');\n\n// `Number.parseFloat` method\n// https://tc39.es/ecma262/#sec-number.parseFloat\n// eslint-disable-next-line es/no-number-parsefloat -- required for testing\n$({ target: 'Number', stat: true, forced: Number.parseFloat != parseFloat }, {\n  parseFloat: parseFloat\n});\n","var global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar trim = require('../internals/string-trim').trim;\nvar whitespaces = require('../internals/whitespaces');\n\nvar charAt = uncurryThis(''.charAt);\nvar n$ParseFloat = global.parseFloat;\nvar Symbol = global.Symbol;\nvar ITERATOR = Symbol && Symbol.iterator;\nvar FORCED = 1 / n$ParseFloat(whitespaces + '-0') !== -Infinity\n  // MS Edge 18- broken with boxed symbols\n  || (ITERATOR && !fails(function () { n$ParseFloat(Object(ITERATOR)); }));\n\n// `parseFloat` method\n// https://tc39.es/ecma262/#sec-parsefloat-string\nmodule.exports = FORCED ? function parseFloat(string) {\n  var trimmedString = trim(toString(string));\n  var result = n$ParseFloat(trimmedString);\n  return result === 0 && charAt(trimmedString, 0) == '-' ? -0 : result;\n} : n$ParseFloat;\n","var $ = require('../internals/export');\nvar parseInt = require('../internals/number-parse-int');\n\n// `Number.parseInt` method\n// https://tc39.es/ecma262/#sec-number.parseint\n// eslint-disable-next-line es/no-number-parseint -- required for testing\n$({ target: 'Number', stat: true, forced: Number.parseInt != parseInt }, {\n  parseInt: parseInt\n});\n","var global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar trim = require('../internals/string-trim').trim;\nvar whitespaces = require('../internals/whitespaces');\n\nvar $parseInt = global.parseInt;\nvar Symbol = global.Symbol;\nvar ITERATOR = Symbol && Symbol.iterator;\nvar hex = /^[+-]?0x/i;\nvar exec = uncurryThis(hex.exec);\nvar FORCED = $parseInt(whitespaces + '08') !== 8 || $parseInt(whitespaces + '0x16') !== 22\n  // MS Edge 18- broken with boxed symbols\n  || (ITERATOR && !fails(function () { $parseInt(Object(ITERATOR)); }));\n\n// `parseInt` method\n// https://tc39.es/ecma262/#sec-parseint-string-radix\nmodule.exports = FORCED ? function parseInt(string, radix) {\n  var S = trim(toString(string));\n  return $parseInt(S, (radix >>> 0) || (exec(hex, S) ? 16 : 10));\n} : $parseInt;\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar thisNumberValue = require('../internals/this-number-value');\nvar $repeat = require('../internals/string-repeat');\nvar fails = require('../internals/fails');\n\nvar RangeError = global.RangeError;\nvar String = global.String;\nvar floor = Math.floor;\nvar repeat = uncurryThis($repeat);\nvar stringSlice = uncurryThis(''.slice);\nvar un$ToFixed = uncurryThis(1.0.toFixed);\n\nvar pow = function (x, n, acc) {\n  return n === 0 ? acc : n % 2 === 1 ? pow(x, n - 1, acc * x) : pow(x * x, n / 2, acc);\n};\n\nvar log = function (x) {\n  var n = 0;\n  var x2 = x;\n  while (x2 >= 4096) {\n    n += 12;\n    x2 /= 4096;\n  }\n  while (x2 >= 2) {\n    n += 1;\n    x2 /= 2;\n  } return n;\n};\n\nvar multiply = function (data, n, c) {\n  var index = -1;\n  var c2 = c;\n  while (++index < 6) {\n    c2 += n * data[index];\n    data[index] = c2 % 1e7;\n    c2 = floor(c2 / 1e7);\n  }\n};\n\nvar divide = function (data, n) {\n  var index = 6;\n  var c = 0;\n  while (--index >= 0) {\n    c += data[index];\n    data[index] = floor(c / n);\n    c = (c % n) * 1e7;\n  }\n};\n\nvar dataToString = function (data) {\n  var index = 6;\n  var s = '';\n  while (--index >= 0) {\n    if (s !== '' || index === 0 || data[index] !== 0) {\n      var t = String(data[index]);\n      s = s === '' ? t : s + repeat('0', 7 - t.length) + t;\n    }\n  } return s;\n};\n\nvar FORCED = fails(function () {\n  return un$ToFixed(0.00008, 3) !== '0.000' ||\n    un$ToFixed(0.9, 0) !== '1' ||\n    un$ToFixed(1.255, 2) !== '1.25' ||\n    un$ToFixed(1000000000000000128.0, 0) !== '1000000000000000128';\n}) || !fails(function () {\n  // V8 ~ Android 4.3-\n  un$ToFixed({});\n});\n\n// `Number.prototype.toFixed` method\n// https://tc39.es/ecma262/#sec-number.prototype.tofixed\n$({ target: 'Number', proto: true, forced: FORCED }, {\n  toFixed: function toFixed(fractionDigits) {\n    var number = thisNumberValue(this);\n    var fractDigits = toIntegerOrInfinity(fractionDigits);\n    var data = [0, 0, 0, 0, 0, 0];\n    var sign = '';\n    var result = '0';\n    var e, z, j, k;\n\n    // TODO: ES2018 increased the maximum number of fraction digits to 100, need to improve the implementation\n    if (fractDigits < 0 || fractDigits > 20) throw RangeError('Incorrect fraction digits');\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (number != number) return 'NaN';\n    if (number <= -1e21 || number >= 1e21) return String(number);\n    if (number < 0) {\n      sign = '-';\n      number = -number;\n    }\n    if (number > 1e-21) {\n      e = log(number * pow(2, 69, 1)) - 69;\n      z = e < 0 ? number * pow(2, -e, 1) : number / pow(2, e, 1);\n      z *= 0x10000000000000;\n      e = 52 - e;\n      if (e > 0) {\n        multiply(data, 0, z);\n        j = fractDigits;\n        while (j >= 7) {\n          multiply(data, 1e7, 0);\n          j -= 7;\n        }\n        multiply(data, pow(10, j, 1), 0);\n        j = e - 1;\n        while (j >= 23) {\n          divide(data, 1 << 23);\n          j -= 23;\n        }\n        divide(data, 1 << j);\n        multiply(data, 1, 1);\n        divide(data, 2);\n        result = dataToString(data);\n      } else {\n        multiply(data, 0, z);\n        multiply(data, 1 << -e, 0);\n        result = dataToString(data) + repeat('0', fractDigits);\n      }\n    }\n    if (fractDigits > 0) {\n      k = result.length;\n      result = sign + (k <= fractDigits\n        ? '0.' + repeat('0', fractDigits - k) + result\n        : stringSlice(result, 0, k - fractDigits) + '.' + stringSlice(result, k - fractDigits));\n    } else {\n      result = sign + result;\n    } return result;\n  }\n});\n","'use strict';\nvar global = require('../internals/global');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toString = require('../internals/to-string');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar RangeError = global.RangeError;\n\n// `String.prototype.repeat` method implementation\n// https://tc39.es/ecma262/#sec-string.prototype.repeat\nmodule.exports = function repeat(count) {\n  var str = toString(requireObjectCoercible(this));\n  var result = '';\n  var n = toIntegerOrInfinity(count);\n  if (n < 0 || n == Infinity) throw RangeError('Wrong number of repetitions');\n  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) result += str;\n  return result;\n};\n","var $ = require('../internals/export');\nvar assign = require('../internals/object-assign');\n\n// `Object.assign` method\n// https://tc39.es/ecma262/#sec-object.assign\n// eslint-disable-next-line es/no-object-assign -- required for testing\n$({ target: 'Object', stat: true, forced: Object.assign !== assign }, {\n  assign: assign\n});\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar call = require('../internals/function-call');\nvar fails = require('../internals/fails');\nvar objectKeys = require('../internals/object-keys');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar toObject = require('../internals/to-object');\nvar IndexedObject = require('../internals/indexed-object');\n\n// eslint-disable-next-line es/no-object-assign -- safe\nvar $assign = Object.assign;\n// eslint-disable-next-line es/no-object-defineproperty -- required for testing\nvar defineProperty = Object.defineProperty;\nvar concat = uncurryThis([].concat);\n\n// `Object.assign` method\n// https://tc39.es/ecma262/#sec-object.assign\nmodule.exports = !$assign || fails(function () {\n  // should have correct order of operations (Edge bug)\n  if (DESCRIPTORS && $assign({ b: 1 }, $assign(defineProperty({}, 'a', {\n    enumerable: true,\n    get: function () {\n      defineProperty(this, 'b', {\n        value: 3,\n        enumerable: false\n      });\n    }\n  }), { b: 2 })).b !== 1) return true;\n  // should work with symbols and should have deterministic property order (V8 bug)\n  var A = {};\n  var B = {};\n  // eslint-disable-next-line es/no-symbol -- safe\n  var symbol = Symbol();\n  var alphabet = 'abcdefghijklmnopqrst';\n  A[symbol] = 7;\n  alphabet.split('').forEach(function (chr) { B[chr] = chr; });\n  return $assign({}, A)[symbol] != 7 || objectKeys($assign({}, B)).join('') != alphabet;\n}) ? function assign(target, source) { // eslint-disable-line no-unused-vars -- required for `.length`\n  var T = toObject(target);\n  var argumentsLength = arguments.length;\n  var index = 1;\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  var propertyIsEnumerable = propertyIsEnumerableModule.f;\n  while (argumentsLength > index) {\n    var S = IndexedObject(arguments[index++]);\n    var keys = getOwnPropertySymbols ? concat(objectKeys(S), getOwnPropertySymbols(S)) : objectKeys(S);\n    var length = keys.length;\n    var j = 0;\n    var key;\n    while (length > j) {\n      key = keys[j++];\n      if (!DESCRIPTORS || call(propertyIsEnumerable, S, key)) T[key] = S[key];\n    }\n  } return T;\n} : $assign;\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar definePropertyModule = require('../internals/object-define-property');\n\n// `Object.prototype.__defineGetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__defineGetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __defineGetter__: function __defineGetter__(P, getter) {\n      definePropertyModule.f(toObject(this), P, { get: aCallable(getter), enumerable: true, configurable: true });\n    }\n  });\n}\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\n// Forced replacement object prototype accessors methods\nmodule.exports = IS_PURE || !fails(function () {\n  // This feature detection crashes old WebKit\n  // https://github.com/zloirock/core-js/issues/232\n  if (WEBKIT && WEBKIT < 535) return;\n  var key = Math.random();\n  // In FF throws only define methods\n  // eslint-disable-next-line no-undef, no-useless-call -- required for testing\n  __defineSetter__.call(null, key, function () { /* empty */ });\n  delete global[key];\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar definePropertyModule = require('../internals/object-define-property');\n\n// `Object.prototype.__defineSetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__defineSetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __defineSetter__: function __defineSetter__(P, setter) {\n      definePropertyModule.f(toObject(this), P, { set: aCallable(setter), enumerable: true, configurable: true });\n    }\n  });\n}\n","var $ = require('../internals/export');\nvar $entries = require('../internals/object-to-array').entries;\n\n// `Object.entries` method\n// https://tc39.es/ecma262/#sec-object.entries\n$({ target: 'Object', stat: true }, {\n  entries: function entries(O) {\n    return $entries(O);\n  }\n});\n","var DESCRIPTORS = require('../internals/descriptors');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar objectKeys = require('../internals/object-keys');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar $propertyIsEnumerable = require('../internals/object-property-is-enumerable').f;\n\nvar propertyIsEnumerable = uncurryThis($propertyIsEnumerable);\nvar push = uncurryThis([].push);\n\n// `Object.{ entries, values }` methods implementation\nvar createMethod = function (TO_ENTRIES) {\n  return function (it) {\n    var O = toIndexedObject(it);\n    var keys = objectKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) {\n      key = keys[i++];\n      if (!DESCRIPTORS || propertyIsEnumerable(O, key)) {\n        push(result, TO_ENTRIES ? [key, O[key]] : O[key]);\n      }\n    }\n    return result;\n  };\n};\n\nmodule.exports = {\n  // `Object.entries` method\n  // https://tc39.es/ecma262/#sec-object.entries\n  entries: createMethod(true),\n  // `Object.values` method\n  // https://tc39.es/ecma262/#sec-object.values\n  values: createMethod(false)\n};\n","var $ = require('../internals/export');\nvar FREEZING = require('../internals/freezing');\nvar fails = require('../internals/fails');\nvar isObject = require('../internals/is-object');\nvar onFreeze = require('../internals/internal-metadata').onFreeze;\n\n// eslint-disable-next-line es/no-object-freeze -- safe\nvar $freeze = Object.freeze;\nvar FAILS_ON_PRIMITIVES = fails(function () { $freeze(1); });\n\n// `Object.freeze` method\n// https://tc39.es/ecma262/#sec-object.freeze\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !FREEZING }, {\n  freeze: function freeze(it) {\n    return $freeze && isObject(it) ? $freeze(onFreeze(it)) : it;\n  }\n});\n","var $ = require('../internals/export');\nvar iterate = require('../internals/iterate');\nvar createProperty = require('../internals/create-property');\n\n// `Object.fromEntries` method\n// https://github.com/tc39/proposal-object-from-entries\n$({ target: 'Object', stat: true }, {\n  fromEntries: function fromEntries(iterable) {\n    var obj = {};\n    iterate(iterable, function (k, v) {\n      createProperty(obj, k, v);\n    }, { AS_ENTRIES: true });\n    return obj;\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar nativeGetOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeGetOwnPropertyDescriptor(1); });\nvar FORCED = !DESCRIPTORS || FAILS_ON_PRIMITIVES;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\n$({ target: 'Object', stat: true, forced: FORCED, sham: !DESCRIPTORS }, {\n  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(it, key) {\n    return nativeGetOwnPropertyDescriptor(toIndexedObject(it), key);\n  }\n});\n","var $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar ownKeys = require('../internals/own-keys');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar createProperty = require('../internals/create-property');\n\n// `Object.getOwnPropertyDescriptors` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptors\n$({ target: 'Object', stat: true, sham: !DESCRIPTORS }, {\n  getOwnPropertyDescriptors: function getOwnPropertyDescriptors(object) {\n    var O = toIndexedObject(object);\n    var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n    var keys = ownKeys(O);\n    var result = {};\n    var index = 0;\n    var key, descriptor;\n    while (keys.length > index) {\n      descriptor = getOwnPropertyDescriptor(O, key = keys[index++]);\n      if (descriptor !== undefined) createProperty(result, key, descriptor);\n    }\n    return result;\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names-external').f;\n\n// eslint-disable-next-line es/no-object-getownpropertynames -- required for testing\nvar FAILS_ON_PRIMITIVES = fails(function () { return !Object.getOwnPropertyNames(1); });\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  getOwnPropertyNames: getOwnPropertyNames\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toObject = require('../internals/to-object');\nvar nativeGetPrototypeOf = require('../internals/object-get-prototype-of');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeGetPrototypeOf(1); });\n\n// `Object.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.getprototypeof\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !CORRECT_PROTOTYPE_GETTER }, {\n  getPrototypeOf: function getPrototypeOf(it) {\n    return nativeGetPrototypeOf(toObject(it));\n  }\n});\n\n","var $ = require('../internals/export');\nvar is = require('../internals/same-value');\n\n// `Object.is` method\n// https://tc39.es/ecma262/#sec-object.is\n$({ target: 'Object', stat: true }, {\n  is: is\n});\n","// `SameValue` abstract operation\n// https://tc39.es/ecma262/#sec-samevalue\n// eslint-disable-next-line es/no-object-is -- safe\nmodule.exports = Object.is || function is(x, y) {\n  // eslint-disable-next-line no-self-compare -- NaN check\n  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;\n};\n","var $ = require('../internals/export');\nvar $isExtensible = require('../internals/object-is-extensible');\n\n// `Object.isExtensible` method\n// https://tc39.es/ecma262/#sec-object.isextensible\n// eslint-disable-next-line es/no-object-isextensible -- safe\n$({ target: 'Object', stat: true, forced: Object.isExtensible !== $isExtensible }, {\n  isExtensible: $isExtensible\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar ARRAY_BUFFER_NON_EXTENSIBLE = require('../internals/array-buffer-non-extensible');\n\n// eslint-disable-next-line es/no-object-isfrozen -- safe\nvar $isFrozen = Object.isFrozen;\nvar FAILS_ON_PRIMITIVES = fails(function () { $isFrozen(1); });\n\n// `Object.isFrozen` method\n// https://tc39.es/ecma262/#sec-object.isfrozen\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES || ARRAY_BUFFER_NON_EXTENSIBLE }, {\n  isFrozen: function isFrozen(it) {\n    if (!isObject(it)) return true;\n    if (ARRAY_BUFFER_NON_EXTENSIBLE && classof(it) == 'ArrayBuffer') return true;\n    return $isFrozen ? $isFrozen(it) : false;\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar ARRAY_BUFFER_NON_EXTENSIBLE = require('../internals/array-buffer-non-extensible');\n\n// eslint-disable-next-line es/no-object-issealed -- safe\nvar $isSealed = Object.isSealed;\nvar FAILS_ON_PRIMITIVES = fails(function () { $isSealed(1); });\n\n// `Object.isSealed` method\n// https://tc39.es/ecma262/#sec-object.issealed\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES || ARRAY_BUFFER_NON_EXTENSIBLE }, {\n  isSealed: function isSealed(it) {\n    if (!isObject(it)) return true;\n    if (ARRAY_BUFFER_NON_EXTENSIBLE && classof(it) == 'ArrayBuffer') return true;\n    return $isSealed ? $isSealed(it) : false;\n  }\n});\n","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar toObject = require('../internals/to-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\n\n// `Object.prototype.__lookupGetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__lookupGetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __lookupGetter__: function __lookupGetter__(P) {\n      var O = toObject(this);\n      var key = toPropertyKey(P);\n      var desc;\n      do {\n        if (desc = getOwnPropertyDescriptor(O, key)) return desc.get;\n      } while (O = getPrototypeOf(O));\n    }\n  });\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar toObject = require('../internals/to-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\n\n// `Object.prototype.__lookupSetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__lookupSetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __lookupSetter__: function __lookupSetter__(P) {\n      var O = toObject(this);\n      var key = toPropertyKey(P);\n      var desc;\n      do {\n        if (desc = getOwnPropertyDescriptor(O, key)) return desc.set;\n      } while (O = getPrototypeOf(O));\n    }\n  });\n}\n","var $ = require('../internals/export');\nvar isObject = require('../internals/is-object');\nvar onFreeze = require('../internals/internal-metadata').onFreeze;\nvar FREEZING = require('../internals/freezing');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-object-preventextensions -- safe\nvar $preventExtensions = Object.preventExtensions;\nvar FAILS_ON_PRIMITIVES = fails(function () { $preventExtensions(1); });\n\n// `Object.preventExtensions` method\n// https://tc39.es/ecma262/#sec-object.preventextensions\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !FREEZING }, {\n  preventExtensions: function preventExtensions(it) {\n    return $preventExtensions && isObject(it) ? $preventExtensions(onFreeze(it)) : it;\n  }\n});\n","var $ = require('../internals/export');\nvar isObject = require('../internals/is-object');\nvar onFreeze = require('../internals/internal-metadata').onFreeze;\nvar FREEZING = require('../internals/freezing');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-object-seal -- safe\nvar $seal = Object.seal;\nvar FAILS_ON_PRIMITIVES = fails(function () { $seal(1); });\n\n// `Object.seal` method\n// https://tc39.es/ecma262/#sec-object.seal\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !FREEZING }, {\n  seal: function seal(it) {\n    return $seal && isObject(it) ? $seal(onFreeze(it)) : it;\n  }\n});\n","var $ = require('../internals/export');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\n\n// `Object.setPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.setprototypeof\n$({ target: 'Object', stat: true }, {\n  setPrototypeOf: setPrototypeOf\n});\n","var TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar redefine = require('../internals/redefine');\nvar toString = require('../internals/object-to-string');\n\n// `Object.prototype.toString` method\n// https://tc39.es/ecma262/#sec-object.prototype.tostring\nif (!TO_STRING_TAG_SUPPORT) {\n  redefine(Object.prototype, 'toString', toString, { unsafe: true });\n}\n","'use strict';\nvar TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar classof = require('../internals/classof');\n\n// `Object.prototype.toString` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.tostring\nmodule.exports = TO_STRING_TAG_SUPPORT ? {}.toString : function toString() {\n  return '[object ' + classof(this) + ']';\n};\n","var $ = require('../internals/export');\nvar $values = require('../internals/object-to-array').values;\n\n// `Object.values` method\n// https://tc39.es/ecma262/#sec-object.values\n$({ target: 'Object', stat: true }, {\n  values: function values(O) {\n    return $values(O);\n  }\n});\n","var $ = require('../internals/export');\nvar $parseFloat = require('../internals/number-parse-float');\n\n// `parseFloat` method\n// https://tc39.es/ecma262/#sec-parsefloat-string\n$({ global: true, forced: parseFloat != $parseFloat }, {\n  parseFloat: $parseFloat\n});\n","var $ = require('../internals/export');\nvar $parseInt = require('../internals/number-parse-int');\n\n// `parseInt` method\n// https://tc39.es/ecma262/#sec-parseint-string-radix\n$({ global: true, forced: parseInt != $parseInt }, {\n  parseInt: $parseInt\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar NativePromise = require('../internals/native-promise-constructor');\nvar redefine = require('../internals/redefine');\nvar redefineAll = require('../internals/redefine-all');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar setSpecies = require('../internals/set-species');\nvar aCallable = require('../internals/a-callable');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar anInstance = require('../internals/an-instance');\nvar inspectSource = require('../internals/inspect-source');\nvar iterate = require('../internals/iterate');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar speciesConstructor = require('../internals/species-constructor');\nvar task = require('../internals/task').set;\nvar microtask = require('../internals/microtask');\nvar promiseResolve = require('../internals/promise-resolve');\nvar hostReportErrors = require('../internals/host-report-errors');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar Queue = require('../internals/queue');\nvar InternalStateModule = require('../internals/internal-state');\nvar isForced = require('../internals/is-forced');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_BROWSER = require('../internals/engine-is-browser');\nvar IS_NODE = require('../internals/engine-is-node');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar SPECIES = wellKnownSymbol('species');\nvar PROMISE = 'Promise';\n\nvar getInternalState = InternalStateModule.getterFor(PROMISE);\nvar setInternalState = InternalStateModule.set;\nvar getInternalPromiseState = InternalStateModule.getterFor(PROMISE);\nvar NativePromisePrototype = NativePromise && NativePromise.prototype;\nvar PromiseConstructor = NativePromise;\nvar PromisePrototype = NativePromisePrototype;\nvar TypeError = global.TypeError;\nvar document = global.document;\nvar process = global.process;\nvar newPromiseCapability = newPromiseCapabilityModule.f;\nvar newGenericPromiseCapability = newPromiseCapability;\n\nvar DISPATCH_EVENT = !!(document && document.createEvent && global.dispatchEvent);\nvar NATIVE_REJECTION_EVENT = isCallable(global.PromiseRejectionEvent);\nvar UNHANDLED_REJECTION = 'unhandledrejection';\nvar REJECTION_HANDLED = 'rejectionhandled';\nvar PENDING = 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\nvar HANDLED = 1;\nvar UNHANDLED = 2;\nvar SUBCLASSING = false;\n\nvar Internal, OwnPromiseCapability, PromiseWrapper, nativeThen;\n\nvar FORCED = isForced(PROMISE, function () {\n  var PROMISE_CONSTRUCTOR_SOURCE = inspectSource(PromiseConstructor);\n  var GLOBAL_CORE_JS_PROMISE = PROMISE_CONSTRUCTOR_SOURCE !== String(PromiseConstructor);\n  // V8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=830565\n  // We can't detect it synchronously, so just check versions\n  if (!GLOBAL_CORE_JS_PROMISE && V8_VERSION === 66) return true;\n  // We need Promise#finally in the pure version for preventing prototype pollution\n  if (IS_PURE && !PromisePrototype['finally']) return true;\n  // We can't use @@species feature detection in V8 since it causes\n  // deoptimization and performance degradation\n  // https://github.com/zloirock/core-js/issues/679\n  if (V8_VERSION >= 51 && /native code/.test(PROMISE_CONSTRUCTOR_SOURCE)) return false;\n  // Detect correctness of subclassing with @@species support\n  var promise = new PromiseConstructor(function (resolve) { resolve(1); });\n  var FakePromise = function (exec) {\n    exec(function () { /* empty */ }, function () { /* empty */ });\n  };\n  var constructor = promise.constructor = {};\n  constructor[SPECIES] = FakePromise;\n  SUBCLASSING = promise.then(function () { /* empty */ }) instanceof FakePromise;\n  if (!SUBCLASSING) return true;\n  // Unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n  return !GLOBAL_CORE_JS_PROMISE && IS_BROWSER && !NATIVE_REJECTION_EVENT;\n});\n\nvar INCORRECT_ITERATION = FORCED || !checkCorrectnessOfIteration(function (iterable) {\n  PromiseConstructor.all(iterable)['catch'](function () { /* empty */ });\n});\n\n// helpers\nvar isThenable = function (it) {\n  var then;\n  return isObject(it) && isCallable(then = it.then) ? then : false;\n};\n\nvar callReaction = function (reaction, state) {\n  var value = state.value;\n  var ok = state.state == FULFILLED;\n  var handler = ok ? reaction.ok : reaction.fail;\n  var resolve = reaction.resolve;\n  var reject = reaction.reject;\n  var domain = reaction.domain;\n  var result, then, exited;\n  try {\n    if (handler) {\n      if (!ok) {\n        if (state.rejection === UNHANDLED) onHandleUnhandled(state);\n        state.rejection = HANDLED;\n      }\n      if (handler === true) result = value;\n      else {\n        if (domain) domain.enter();\n        result = handler(value); // can throw\n        if (domain) {\n          domain.exit();\n          exited = true;\n        }\n      }\n      if (result === reaction.promise) {\n        reject(TypeError('Promise-chain cycle'));\n      } else if (then = isThenable(result)) {\n        call(then, result, resolve, reject);\n      } else resolve(result);\n    } else reject(value);\n  } catch (error) {\n    if (domain && !exited) domain.exit();\n    reject(error);\n  }\n};\n\nvar notify = function (state, isReject) {\n  if (state.notified) return;\n  state.notified = true;\n  microtask(function () {\n    var reactions = state.reactions;\n    var reaction;\n    while (reaction = reactions.get()) {\n      callReaction(reaction, state);\n    }\n    state.notified = false;\n    if (isReject && !state.rejection) onUnhandled(state);\n  });\n};\n\nvar dispatchEvent = function (name, promise, reason) {\n  var event, handler;\n  if (DISPATCH_EVENT) {\n    event = document.createEvent('Event');\n    event.promise = promise;\n    event.reason = reason;\n    event.initEvent(name, false, true);\n    global.dispatchEvent(event);\n  } else event = { promise: promise, reason: reason };\n  if (!NATIVE_REJECTION_EVENT && (handler = global['on' + name])) handler(event);\n  else if (name === UNHANDLED_REJECTION) hostReportErrors('Unhandled promise rejection', reason);\n};\n\nvar onUnhandled = function (state) {\n  call(task, global, function () {\n    var promise = state.facade;\n    var value = state.value;\n    var IS_UNHANDLED = isUnhandled(state);\n    var result;\n    if (IS_UNHANDLED) {\n      result = perform(function () {\n        if (IS_NODE) {\n          process.emit('unhandledRejection', value, promise);\n        } else dispatchEvent(UNHANDLED_REJECTION, promise, value);\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      state.rejection = IS_NODE || isUnhandled(state) ? UNHANDLED : HANDLED;\n      if (result.error) throw result.value;\n    }\n  });\n};\n\nvar isUnhandled = function (state) {\n  return state.rejection !== HANDLED && !state.parent;\n};\n\nvar onHandleUnhandled = function (state) {\n  call(task, global, function () {\n    var promise = state.facade;\n    if (IS_NODE) {\n      process.emit('rejectionHandled', promise);\n    } else dispatchEvent(REJECTION_HANDLED, promise, state.value);\n  });\n};\n\nvar bind = function (fn, state, unwrap) {\n  return function (value) {\n    fn(state, value, unwrap);\n  };\n};\n\nvar internalReject = function (state, value, unwrap) {\n  if (state.done) return;\n  state.done = true;\n  if (unwrap) state = unwrap;\n  state.value = value;\n  state.state = REJECTED;\n  notify(state, true);\n};\n\nvar internalResolve = function (state, value, unwrap) {\n  if (state.done) return;\n  state.done = true;\n  if (unwrap) state = unwrap;\n  try {\n    if (state.facade === value) throw TypeError(\"Promise can't be resolved itself\");\n    var then = isThenable(value);\n    if (then) {\n      microtask(function () {\n        var wrapper = { done: false };\n        try {\n          call(then, value,\n            bind(internalResolve, wrapper, state),\n            bind(internalReject, wrapper, state)\n          );\n        } catch (error) {\n          internalReject(wrapper, error, state);\n        }\n      });\n    } else {\n      state.value = value;\n      state.state = FULFILLED;\n      notify(state, false);\n    }\n  } catch (error) {\n    internalReject({ done: false }, error, state);\n  }\n};\n\n// constructor polyfill\nif (FORCED) {\n  // 25.4.3.1 Promise(executor)\n  PromiseConstructor = function Promise(executor) {\n    anInstance(this, PromisePrototype);\n    aCallable(executor);\n    call(Internal, this);\n    var state = getInternalState(this);\n    try {\n      executor(bind(internalResolve, state), bind(internalReject, state));\n    } catch (error) {\n      internalReject(state, error);\n    }\n  };\n  PromisePrototype = PromiseConstructor.prototype;\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  Internal = function Promise(executor) {\n    setInternalState(this, {\n      type: PROMISE,\n      done: false,\n      notified: false,\n      parent: false,\n      reactions: new Queue(),\n      rejection: false,\n      state: PENDING,\n      value: undefined\n    });\n  };\n  Internal.prototype = redefineAll(PromisePrototype, {\n    // `Promise.prototype.then` method\n    // https://tc39.es/ecma262/#sec-promise.prototype.then\n    // eslint-disable-next-line unicorn/no-thenable -- safe\n    then: function then(onFulfilled, onRejected) {\n      var state = getInternalPromiseState(this);\n      var reaction = newPromiseCapability(speciesConstructor(this, PromiseConstructor));\n      state.parent = true;\n      reaction.ok = isCallable(onFulfilled) ? onFulfilled : true;\n      reaction.fail = isCallable(onRejected) && onRejected;\n      reaction.domain = IS_NODE ? process.domain : undefined;\n      if (state.state == PENDING) state.reactions.add(reaction);\n      else microtask(function () {\n        callReaction(reaction, state);\n      });\n      return reaction.promise;\n    },\n    // `Promise.prototype.catch` method\n    // https://tc39.es/ecma262/#sec-promise.prototype.catch\n    'catch': function (onRejected) {\n      return this.then(undefined, onRejected);\n    }\n  });\n  OwnPromiseCapability = function () {\n    var promise = new Internal();\n    var state = getInternalState(promise);\n    this.promise = promise;\n    this.resolve = bind(internalResolve, state);\n    this.reject = bind(internalReject, state);\n  };\n  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {\n    return C === PromiseConstructor || C === PromiseWrapper\n      ? new OwnPromiseCapability(C)\n      : newGenericPromiseCapability(C);\n  };\n\n  if (!IS_PURE && isCallable(NativePromise) && NativePromisePrototype !== Object.prototype) {\n    nativeThen = NativePromisePrototype.then;\n\n    if (!SUBCLASSING) {\n      // make `Promise#then` return a polyfilled `Promise` for native promise-based APIs\n      redefine(NativePromisePrototype, 'then', function then(onFulfilled, onRejected) {\n        var that = this;\n        return new PromiseConstructor(function (resolve, reject) {\n          call(nativeThen, that, resolve, reject);\n        }).then(onFulfilled, onRejected);\n      // https://github.com/zloirock/core-js/issues/640\n      }, { unsafe: true });\n\n      // makes sure that native promise-based APIs `Promise#catch` properly works with patched `Promise#then`\n      redefine(NativePromisePrototype, 'catch', PromisePrototype['catch'], { unsafe: true });\n    }\n\n    // make `.constructor === Promise` work for native promise-based APIs\n    try {\n      delete NativePromisePrototype.constructor;\n    } catch (error) { /* empty */ }\n\n    // make `instanceof Promise` work for native promise-based APIs\n    if (setPrototypeOf) {\n      setPrototypeOf(NativePromisePrototype, PromisePrototype);\n    }\n  }\n}\n\n$({ global: true, wrap: true, forced: FORCED }, {\n  Promise: PromiseConstructor\n});\n\nsetToStringTag(PromiseConstructor, PROMISE, false, true);\nsetSpecies(PROMISE);\n\nPromiseWrapper = getBuiltIn(PROMISE);\n\n// statics\n$({ target: PROMISE, stat: true, forced: FORCED }, {\n  // `Promise.reject` method\n  // https://tc39.es/ecma262/#sec-promise.reject\n  reject: function reject(r) {\n    var capability = newPromiseCapability(this);\n    call(capability.reject, undefined, r);\n    return capability.promise;\n  }\n});\n\n$({ target: PROMISE, stat: true, forced: IS_PURE || FORCED }, {\n  // `Promise.resolve` method\n  // https://tc39.es/ecma262/#sec-promise.resolve\n  resolve: function resolve(x) {\n    return promiseResolve(IS_PURE && this === PromiseWrapper ? PromiseConstructor : this, x);\n  }\n});\n\n$({ target: PROMISE, stat: true, forced: INCORRECT_ITERATION }, {\n  // `Promise.all` method\n  // https://tc39.es/ecma262/#sec-promise.all\n  all: function all(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var $promiseResolve = aCallable(C.resolve);\n      var values = [];\n      var counter = 0;\n      var remaining = 1;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyCalled = false;\n        remaining++;\n        call($promiseResolve, C, promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  },\n  // `Promise.race` method\n  // https://tc39.es/ecma262/#sec-promise.race\n  race: function race(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var reject = capability.reject;\n    var result = perform(function () {\n      var $promiseResolve = aCallable(C.resolve);\n      iterate(iterable, function (promise) {\n        call($promiseResolve, C, promise).then(capability.resolve, reject);\n      });\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","var global = require('../internals/global');\n\nmodule.exports = global.Promise;\n","var global = require('../internals/global');\nvar apply = require('../internals/function-apply');\nvar bind = require('../internals/function-bind-context');\nvar isCallable = require('../internals/is-callable');\nvar hasOwn = require('../internals/has-own-property');\nvar fails = require('../internals/fails');\nvar html = require('../internals/html');\nvar arraySlice = require('../internals/array-slice');\nvar createElement = require('../internals/document-create-element');\nvar IS_IOS = require('../internals/engine-is-ios');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar set = global.setImmediate;\nvar clear = global.clearImmediate;\nvar process = global.process;\nvar Dispatch = global.Dispatch;\nvar Function = global.Function;\nvar MessageChannel = global.MessageChannel;\nvar String = global.String;\nvar counter = 0;\nvar queue = {};\nvar ONREADYSTATECHANGE = 'onreadystatechange';\nvar location, defer, channel, port;\n\ntry {\n  // Deno throws a ReferenceError on `location` access without `--location` flag\n  location = global.location;\n} catch (error) { /* empty */ }\n\nvar run = function (id) {\n  if (hasOwn(queue, id)) {\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\n\nvar runner = function (id) {\n  return function () {\n    run(id);\n  };\n};\n\nvar listener = function (event) {\n  run(event.data);\n};\n\nvar post = function (id) {\n  // old engines have not location.origin\n  global.postMessage(String(id), location.protocol + '//' + location.host);\n};\n\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif (!set || !clear) {\n  set = function setImmediate(fn) {\n    var args = arraySlice(arguments, 1);\n    queue[++counter] = function () {\n      apply(isCallable(fn) ? fn : Function(fn), undefined, args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clear = function clearImmediate(id) {\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if (IS_NODE) {\n    defer = function (id) {\n      process.nextTick(runner(id));\n    };\n  // Sphere (JS game engine) Dispatch API\n  } else if (Dispatch && Dispatch.now) {\n    defer = function (id) {\n      Dispatch.now(runner(id));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  // except iOS - https://github.com/zloirock/core-js/issues/624\n  } else if (MessageChannel && !IS_IOS) {\n    channel = new MessageChannel();\n    port = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = bind(port.postMessage, port);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if (\n    global.addEventListener &&\n    isCallable(global.postMessage) &&\n    !global.importScripts &&\n    location && location.protocol !== 'file:' &&\n    !fails(post)\n  ) {\n    defer = post;\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if (ONREADYSTATECHANGE in createElement('script')) {\n    defer = function (id) {\n      html.appendChild(createElement('script'))[ONREADYSTATECHANGE] = function () {\n        html.removeChild(this);\n        run(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function (id) {\n      setTimeout(runner(id), 0);\n    };\n  }\n}\n\nmodule.exports = {\n  set: set,\n  clear: clear\n};\n","var userAgent = require('../internals/engine-user-agent');\n\nmodule.exports = /(?:ipad|iphone|ipod).*applewebkit/i.test(userAgent);\n","var global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar macrotask = require('../internals/task').set;\nvar IS_IOS = require('../internals/engine-is-ios');\nvar IS_IOS_PEBBLE = require('../internals/engine-is-ios-pebble');\nvar IS_WEBOS_WEBKIT = require('../internals/engine-is-webos-webkit');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar MutationObserver = global.MutationObserver || global.WebKitMutationObserver;\nvar document = global.document;\nvar process = global.process;\nvar Promise = global.Promise;\n// Node.js 11 shows ExperimentalWarning on getting `queueMicrotask`\nvar queueMicrotaskDescriptor = getOwnPropertyDescriptor(global, 'queueMicrotask');\nvar queueMicrotask = queueMicrotaskDescriptor && queueMicrotaskDescriptor.value;\n\nvar flush, head, last, notify, toggle, node, promise, then;\n\n// modern engines have queueMicrotask method\nif (!queueMicrotask) {\n  flush = function () {\n    var parent, fn;\n    if (IS_NODE && (parent = process.domain)) parent.exit();\n    while (head) {\n      fn = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch (error) {\n        if (head) notify();\n        else last = undefined;\n        throw error;\n      }\n    } last = undefined;\n    if (parent) parent.enter();\n  };\n\n  // browsers with MutationObserver, except iOS - https://github.com/zloirock/core-js/issues/339\n  // also except WebOS Webkit https://github.com/zloirock/core-js/issues/898\n  if (!IS_IOS && !IS_NODE && !IS_WEBOS_WEBKIT && MutationObserver && document) {\n    toggle = true;\n    node = document.createTextNode('');\n    new MutationObserver(flush).observe(node, { characterData: true });\n    notify = function () {\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if (!IS_IOS_PEBBLE && Promise && Promise.resolve) {\n    // Promise.resolve without an argument throws an error in LG WebOS 2\n    promise = Promise.resolve(undefined);\n    // workaround of WebKit ~ iOS Safari 10.1 bug\n    promise.constructor = Promise;\n    then = bind(promise.then, promise);\n    notify = function () {\n      then(flush);\n    };\n  // Node.js without promises\n  } else if (IS_NODE) {\n    notify = function () {\n      process.nextTick(flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    // strange IE + webpack dev server bug - use .bind(global)\n    macrotask = bind(macrotask, global);\n    notify = function () {\n      macrotask(flush);\n    };\n  }\n}\n\nmodule.exports = queueMicrotask || function (fn) {\n  var task = { fn: fn, next: undefined };\n  if (last) last.next = task;\n  if (!head) {\n    head = task;\n    notify();\n  } last = task;\n};\n","var userAgent = require('../internals/engine-user-agent');\nvar global = require('../internals/global');\n\nmodule.exports = /ipad|iphone|ipod/i.test(userAgent) && global.Pebble !== undefined;\n","var userAgent = require('../internals/engine-user-agent');\n\nmodule.exports = /web0s(?!.*chrome)/i.test(userAgent);\n","var anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar newPromiseCapability = require('../internals/new-promise-capability');\n\nmodule.exports = function (C, x) {\n  anObject(C);\n  if (isObject(x) && x.constructor === C) return x;\n  var promiseCapability = newPromiseCapability.f(C);\n  var resolve = promiseCapability.resolve;\n  resolve(x);\n  return promiseCapability.promise;\n};\n","'use strict';\nvar aCallable = require('../internals/a-callable');\n\nvar PromiseCapability = function (C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aCallable(resolve);\n  this.reject = aCallable(reject);\n};\n\n// `NewPromiseCapability` abstract operation\n// https://tc39.es/ecma262/#sec-newpromisecapability\nmodule.exports.f = function (C) {\n  return new PromiseCapability(C);\n};\n","var global = require('../internals/global');\n\nmodule.exports = function (a, b) {\n  var console = global.console;\n  if (console && console.error) {\n    arguments.length == 1 ? console.error(a) : console.error(a, b);\n  }\n};\n","module.exports = function (exec) {\n  try {\n    return { error: false, value: exec() };\n  } catch (error) {\n    return { error: true, value: error };\n  }\n};\n","var Queue = function () {\n  this.head = null;\n  this.tail = null;\n};\n\nQueue.prototype = {\n  add: function (item) {\n    var entry = { item: item, next: null };\n    if (this.head) this.tail.next = entry;\n    else this.head = entry;\n    this.tail = entry;\n  },\n  get: function () {\n    var entry = this.head;\n    if (entry) {\n      this.head = entry.next;\n      if (this.tail === entry) this.tail = null;\n      return entry.item;\n    }\n  }\n};\n\nmodule.exports = Queue;\n","module.exports = typeof window == 'object';\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar NativePromise = require('../internals/native-promise-constructor');\nvar fails = require('../internals/fails');\nvar getBuiltIn = require('../internals/get-built-in');\nvar isCallable = require('../internals/is-callable');\nvar speciesConstructor = require('../internals/species-constructor');\nvar promiseResolve = require('../internals/promise-resolve');\nvar redefine = require('../internals/redefine');\n\n// Safari bug https://bugs.webkit.org/show_bug.cgi?id=200829\nvar NON_GENERIC = !!NativePromise && fails(function () {\n  // eslint-disable-next-line unicorn/no-thenable -- required for testing\n  NativePromise.prototype['finally'].call({ then: function () { /* empty */ } }, function () { /* empty */ });\n});\n\n// `Promise.prototype.finally` method\n// https://tc39.es/ecma262/#sec-promise.prototype.finally\n$({ target: 'Promise', proto: true, real: true, forced: NON_GENERIC }, {\n  'finally': function (onFinally) {\n    var C = speciesConstructor(this, getBuiltIn('Promise'));\n    var isFunction = isCallable(onFinally);\n    return this.then(\n      isFunction ? function (x) {\n        return promiseResolve(C, onFinally()).then(function () { return x; });\n      } : onFinally,\n      isFunction ? function (e) {\n        return promiseResolve(C, onFinally()).then(function () { throw e; });\n      } : onFinally\n    );\n  }\n});\n\n// makes sure that native promise-based APIs `Promise#finally` properly works with patched `Promise#then`\nif (!IS_PURE && isCallable(NativePromise)) {\n  var method = getBuiltIn('Promise').prototype['finally'];\n  if (NativePromise.prototype['finally'] !== method) {\n    redefine(NativePromise.prototype, 'finally', method, { unsafe: true });\n  }\n}\n","var $ = require('../internals/export');\nvar functionApply = require('../internals/function-apply');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar fails = require('../internals/fails');\n\n// MS Edge argumentsList argument is optional\nvar OPTIONAL_ARGUMENTS_LIST = !fails(function () {\n  // eslint-disable-next-line es/no-reflect -- required for testing\n  Reflect.apply(function () { /* empty */ });\n});\n\n// `Reflect.apply` method\n// https://tc39.es/ecma262/#sec-reflect.apply\n$({ target: 'Reflect', stat: true, forced: OPTIONAL_ARGUMENTS_LIST }, {\n  apply: function apply(target, thisArgument, argumentsList) {\n    return functionApply(aCallable(target), thisArgument, anObject(argumentsList));\n  }\n});\n","var $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar apply = require('../internals/function-apply');\nvar bind = require('../internals/function-bind');\nvar aConstructor = require('../internals/a-constructor');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar create = require('../internals/object-create');\nvar fails = require('../internals/fails');\n\nvar nativeConstruct = getBuiltIn('Reflect', 'construct');\nvar ObjectPrototype = Object.prototype;\nvar push = [].push;\n\n// `Reflect.construct` method\n// https://tc39.es/ecma262/#sec-reflect.construct\n// MS Edge supports only 2 arguments and argumentsList argument is optional\n// FF Nightly sets third argument as `new.target`, but does not create `this` from it\nvar NEW_TARGET_BUG = fails(function () {\n  function F() { /* empty */ }\n  return !(nativeConstruct(function () { /* empty */ }, [], F) instanceof F);\n});\n\nvar ARGS_BUG = !fails(function () {\n  nativeConstruct(function () { /* empty */ });\n});\n\nvar FORCED = NEW_TARGET_BUG || ARGS_BUG;\n\n$({ target: 'Reflect', stat: true, forced: FORCED, sham: FORCED }, {\n  construct: function construct(Target, args /* , newTarget */) {\n    aConstructor(Target);\n    anObject(args);\n    var newTarget = arguments.length < 3 ? Target : aConstructor(arguments[2]);\n    if (ARGS_BUG && !NEW_TARGET_BUG) return nativeConstruct(Target, args, newTarget);\n    if (Target == newTarget) {\n      // w/o altered newTarget, optimization for 0-4 arguments\n      switch (args.length) {\n        case 0: return new Target();\n        case 1: return new Target(args[0]);\n        case 2: return new Target(args[0], args[1]);\n        case 3: return new Target(args[0], args[1], args[2]);\n        case 4: return new Target(args[0], args[1], args[2], args[3]);\n      }\n      // w/o altered newTarget, lot of arguments case\n      var $args = [null];\n      apply(push, $args, args);\n      return new (apply(bind, Target, $args))();\n    }\n    // with altered newTarget, not support built-in constructors\n    var proto = newTarget.prototype;\n    var instance = create(isObject(proto) ? proto : ObjectPrototype);\n    var result = apply(Target, instance, args);\n    return isObject(result) ? result : instance;\n  }\n});\n","'use strict';\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar isObject = require('../internals/is-object');\nvar hasOwn = require('../internals/has-own-property');\nvar arraySlice = require('../internals/array-slice');\nvar NATIVE_BIND = require('../internals/function-bind-native');\n\nvar Function = global.Function;\nvar concat = uncurryThis([].concat);\nvar join = uncurryThis([].join);\nvar factories = {};\n\nvar construct = function (C, argsLength, args) {\n  if (!hasOwn(factories, argsLength)) {\n    for (var list = [], i = 0; i < argsLength; i++) list[i] = 'a[' + i + ']';\n    factories[argsLength] = Function('C,a', 'return new C(' + join(list, ',') + ')');\n  } return factories[argsLength](C, args);\n};\n\n// `Function.prototype.bind` method implementation\n// https://tc39.es/ecma262/#sec-function.prototype.bind\nmodule.exports = NATIVE_BIND ? Function.bind : function bind(that /* , ...args */) {\n  var F = aCallable(this);\n  var Prototype = F.prototype;\n  var partArgs = arraySlice(arguments, 1);\n  var boundFunction = function bound(/* args... */) {\n    var args = concat(partArgs, arraySlice(arguments));\n    return this instanceof boundFunction ? construct(F, args.length, args) : F.apply(that, args);\n  };\n  if (isObject(Prototype)) boundFunction.prototype = Prototype;\n  return boundFunction;\n};\n","var $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar anObject = require('../internals/an-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar definePropertyModule = require('../internals/object-define-property');\nvar fails = require('../internals/fails');\n\n// MS Edge has broken Reflect.defineProperty - throwing instead of returning false\nvar ERROR_INSTEAD_OF_FALSE = fails(function () {\n  // eslint-disable-next-line es/no-reflect -- required for testing\n  Reflect.defineProperty(definePropertyModule.f({}, 1, { value: 1 }), 1, { value: 2 });\n});\n\n// `Reflect.defineProperty` method\n// https://tc39.es/ecma262/#sec-reflect.defineproperty\n$({ target: 'Reflect', stat: true, forced: ERROR_INSTEAD_OF_FALSE, sham: !DESCRIPTORS }, {\n  defineProperty: function defineProperty(target, propertyKey, attributes) {\n    anObject(target);\n    var key = toPropertyKey(propertyKey);\n    anObject(attributes);\n    try {\n      definePropertyModule.f(target, key, attributes);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n});\n","var $ = require('../internals/export');\nvar anObject = require('../internals/an-object');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\n\n// `Reflect.deleteProperty` method\n// https://tc39.es/ecma262/#sec-reflect.deleteproperty\n$({ target: 'Reflect', stat: true }, {\n  deleteProperty: function deleteProperty(target, propertyKey) {\n    var descriptor = getOwnPropertyDescriptor(anObject(target), propertyKey);\n    return descriptor && !descriptor.configurable ? false : delete target[propertyKey];\n  }\n});\n","var $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar isObject = require('../internals/is-object');\nvar anObject = require('../internals/an-object');\nvar isDataDescriptor = require('../internals/is-data-descriptor');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\n\n// `Reflect.get` method\n// https://tc39.es/ecma262/#sec-reflect.get\nfunction get(target, propertyKey /* , receiver */) {\n  var receiver = arguments.length < 3 ? target : arguments[2];\n  var descriptor, prototype;\n  if (anObject(target) === receiver) return target[propertyKey];\n  descriptor = getOwnPropertyDescriptorModule.f(target, propertyKey);\n  if (descriptor) return isDataDescriptor(descriptor)\n    ? descriptor.value\n    : descriptor.get === undefined ? undefined : call(descriptor.get, receiver);\n  if (isObject(prototype = getPrototypeOf(target))) return get(prototype, propertyKey, receiver);\n}\n\n$({ target: 'Reflect', stat: true }, {\n  get: get\n});\n","var hasOwn = require('../internals/has-own-property');\n\nmodule.exports = function (descriptor) {\n  return descriptor !== undefined && (hasOwn(descriptor, 'value') || hasOwn(descriptor, 'writable'));\n};\n","var $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar anObject = require('../internals/an-object');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\n\n// `Reflect.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-reflect.getownpropertydescriptor\n$({ target: 'Reflect', stat: true, sham: !DESCRIPTORS }, {\n  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(target, propertyKey) {\n    return getOwnPropertyDescriptorModule.f(anObject(target), propertyKey);\n  }\n});\n","var $ = require('../internals/export');\nvar anObject = require('../internals/an-object');\nvar objectGetPrototypeOf = require('../internals/object-get-prototype-of');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\n// `Reflect.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-reflect.getprototypeof\n$({ target: 'Reflect', stat: true, sham: !CORRECT_PROTOTYPE_GETTER }, {\n  getPrototypeOf: function getPrototypeOf(target) {\n    return objectGetPrototypeOf(anObject(target));\n  }\n});\n","var $ = require('../internals/export');\n\n// `Reflect.has` method\n// https://tc39.es/ecma262/#sec-reflect.has\n$({ target: 'Reflect', stat: true }, {\n  has: function has(target, propertyKey) {\n    return propertyKey in target;\n  }\n});\n","var $ = require('../internals/export');\nvar anObject = require('../internals/an-object');\nvar $isExtensible = require('../internals/object-is-extensible');\n\n// `Reflect.isExtensible` method\n// https://tc39.es/ecma262/#sec-reflect.isextensible\n$({ target: 'Reflect', stat: true }, {\n  isExtensible: function isExtensible(target) {\n    anObject(target);\n    return $isExtensible(target);\n  }\n});\n","var $ = require('../internals/export');\nvar ownKeys = require('../internals/own-keys');\n\n// `Reflect.ownKeys` method\n// https://tc39.es/ecma262/#sec-reflect.ownkeys\n$({ target: 'Reflect', stat: true }, {\n  ownKeys: ownKeys\n});\n","var $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar anObject = require('../internals/an-object');\nvar FREEZING = require('../internals/freezing');\n\n// `Reflect.preventExtensions` method\n// https://tc39.es/ecma262/#sec-reflect.preventextensions\n$({ target: 'Reflect', stat: true, sham: !FREEZING }, {\n  preventExtensions: function preventExtensions(target) {\n    anObject(target);\n    try {\n      var objectPreventExtensions = getBuiltIn('Object', 'preventExtensions');\n      if (objectPreventExtensions) objectPreventExtensions(target);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n});\n","var $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar isDataDescriptor = require('../internals/is-data-descriptor');\nvar fails = require('../internals/fails');\nvar definePropertyModule = require('../internals/object-define-property');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\n// `Reflect.set` method\n// https://tc39.es/ecma262/#sec-reflect.set\nfunction set(target, propertyKey, V /* , receiver */) {\n  var receiver = arguments.length < 4 ? target : arguments[3];\n  var ownDescriptor = getOwnPropertyDescriptorModule.f(anObject(target), propertyKey);\n  var existingDescriptor, prototype, setter;\n  if (!ownDescriptor) {\n    if (isObject(prototype = getPrototypeOf(target))) {\n      return set(prototype, propertyKey, V, receiver);\n    }\n    ownDescriptor = createPropertyDescriptor(0);\n  }\n  if (isDataDescriptor(ownDescriptor)) {\n    if (ownDescriptor.writable === false || !isObject(receiver)) return false;\n    if (existingDescriptor = getOwnPropertyDescriptorModule.f(receiver, propertyKey)) {\n      if (existingDescriptor.get || existingDescriptor.set || existingDescriptor.writable === false) return false;\n      existingDescriptor.value = V;\n      definePropertyModule.f(receiver, propertyKey, existingDescriptor);\n    } else definePropertyModule.f(receiver, propertyKey, createPropertyDescriptor(0, V));\n  } else {\n    setter = ownDescriptor.set;\n    if (setter === undefined) return false;\n    call(setter, receiver, V);\n  } return true;\n}\n\n// MS Edge 17-18 Reflect.set allows setting the property to object\n// with non-writable property on the prototype\nvar MS_EDGE_BUG = fails(function () {\n  var Constructor = function () { /* empty */ };\n  var object = definePropertyModule.f(new Constructor(), 'a', { configurable: true });\n  // eslint-disable-next-line es/no-reflect -- required for testing\n  return Reflect.set(Constructor.prototype, 'a', 1, object) !== false;\n});\n\n$({ target: 'Reflect', stat: true, forced: MS_EDGE_BUG }, {\n  set: set\n});\n","var $ = require('../internals/export');\nvar anObject = require('../internals/an-object');\nvar aPossiblePrototype = require('../internals/a-possible-prototype');\nvar objectSetPrototypeOf = require('../internals/object-set-prototype-of');\n\n// `Reflect.setPrototypeOf` method\n// https://tc39.es/ecma262/#sec-reflect.setprototypeof\nif (objectSetPrototypeOf) $({ target: 'Reflect', stat: true }, {\n  setPrototypeOf: function setPrototypeOf(target, proto) {\n    anObject(target);\n    aPossiblePrototype(proto);\n    try {\n      objectSetPrototypeOf(target, proto);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n});\n","var DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isForced = require('../internals/is-forced');\nvar inheritIfRequired = require('../internals/inherit-if-required');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar defineProperty = require('../internals/object-define-property').f;\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar isRegExp = require('../internals/is-regexp');\nvar toString = require('../internals/to-string');\nvar regExpFlags = require('../internals/regexp-flags');\nvar stickyHelpers = require('../internals/regexp-sticky-helpers');\nvar redefine = require('../internals/redefine');\nvar fails = require('../internals/fails');\nvar hasOwn = require('../internals/has-own-property');\nvar enforceInternalState = require('../internals/internal-state').enforce;\nvar setSpecies = require('../internals/set-species');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar UNSUPPORTED_DOT_ALL = require('../internals/regexp-unsupported-dot-all');\nvar UNSUPPORTED_NCG = require('../internals/regexp-unsupported-ncg');\n\nvar MATCH = wellKnownSymbol('match');\nvar NativeRegExp = global.RegExp;\nvar RegExpPrototype = NativeRegExp.prototype;\nvar SyntaxError = global.SyntaxError;\nvar getFlags = uncurryThis(regExpFlags);\nvar exec = uncurryThis(RegExpPrototype.exec);\nvar charAt = uncurryThis(''.charAt);\nvar replace = uncurryThis(''.replace);\nvar stringIndexOf = uncurryThis(''.indexOf);\nvar stringSlice = uncurryThis(''.slice);\n// TODO: Use only propper RegExpIdentifierName\nvar IS_NCG = /^\\?<[^\\s\\d!#%&*+<=>@^][^\\s!#%&*+<=>@^]*>/;\nvar re1 = /a/g;\nvar re2 = /a/g;\n\n// \"new\" should create a new object, old webkit bug\nvar CORRECT_NEW = new NativeRegExp(re1) !== re1;\n\nvar MISSED_STICKY = stickyHelpers.MISSED_STICKY;\nvar UNSUPPORTED_Y = stickyHelpers.UNSUPPORTED_Y;\n\nvar BASE_FORCED = DESCRIPTORS &&\n  (!CORRECT_NEW || MISSED_STICKY || UNSUPPORTED_DOT_ALL || UNSUPPORTED_NCG || fails(function () {\n    re2[MATCH] = false;\n    // RegExp constructor can alter flags and IsRegExp works correct with @@match\n    return NativeRegExp(re1) != re1 || NativeRegExp(re2) == re2 || NativeRegExp(re1, 'i') != '/a/i';\n  }));\n\nvar handleDotAll = function (string) {\n  var length = string.length;\n  var index = 0;\n  var result = '';\n  var brackets = false;\n  var chr;\n  for (; index <= length; index++) {\n    chr = charAt(string, index);\n    if (chr === '\\\\') {\n      result += chr + charAt(string, ++index);\n      continue;\n    }\n    if (!brackets && chr === '.') {\n      result += '[\\\\s\\\\S]';\n    } else {\n      if (chr === '[') {\n        brackets = true;\n      } else if (chr === ']') {\n        brackets = false;\n      } result += chr;\n    }\n  } return result;\n};\n\nvar handleNCG = function (string) {\n  var length = string.length;\n  var index = 0;\n  var result = '';\n  var named = [];\n  var names = {};\n  var brackets = false;\n  var ncg = false;\n  var groupid = 0;\n  var groupname = '';\n  var chr;\n  for (; index <= length; index++) {\n    chr = charAt(string, index);\n    if (chr === '\\\\') {\n      chr = chr + charAt(string, ++index);\n    } else if (chr === ']') {\n      brackets = false;\n    } else if (!brackets) switch (true) {\n      case chr === '[':\n        brackets = true;\n        break;\n      case chr === '(':\n        if (exec(IS_NCG, stringSlice(string, index + 1))) {\n          index += 2;\n          ncg = true;\n        }\n        result += chr;\n        groupid++;\n        continue;\n      case chr === '>' && ncg:\n        if (groupname === '' || hasOwn(names, groupname)) {\n          throw new SyntaxError('Invalid capture group name');\n        }\n        names[groupname] = true;\n        named[named.length] = [groupname, groupid];\n        ncg = false;\n        groupname = '';\n        continue;\n    }\n    if (ncg) groupname += chr;\n    else result += chr;\n  } return [result, named];\n};\n\n// `RegExp` constructor\n// https://tc39.es/ecma262/#sec-regexp-constructor\nif (isForced('RegExp', BASE_FORCED)) {\n  var RegExpWrapper = function RegExp(pattern, flags) {\n    var thisIsRegExp = isPrototypeOf(RegExpPrototype, this);\n    var patternIsRegExp = isRegExp(pattern);\n    var flagsAreUndefined = flags === undefined;\n    var groups = [];\n    var rawPattern = pattern;\n    var rawFlags, dotAll, sticky, handled, result, state;\n\n    if (!thisIsRegExp && patternIsRegExp && flagsAreUndefined && pattern.constructor === RegExpWrapper) {\n      return pattern;\n    }\n\n    if (patternIsRegExp || isPrototypeOf(RegExpPrototype, pattern)) {\n      pattern = pattern.source;\n      if (flagsAreUndefined) flags = 'flags' in rawPattern ? rawPattern.flags : getFlags(rawPattern);\n    }\n\n    pattern = pattern === undefined ? '' : toString(pattern);\n    flags = flags === undefined ? '' : toString(flags);\n    rawPattern = pattern;\n\n    if (UNSUPPORTED_DOT_ALL && 'dotAll' in re1) {\n      dotAll = !!flags && stringIndexOf(flags, 's') > -1;\n      if (dotAll) flags = replace(flags, /s/g, '');\n    }\n\n    rawFlags = flags;\n\n    if (MISSED_STICKY && 'sticky' in re1) {\n      sticky = !!flags && stringIndexOf(flags, 'y') > -1;\n      if (sticky && UNSUPPORTED_Y) flags = replace(flags, /y/g, '');\n    }\n\n    if (UNSUPPORTED_NCG) {\n      handled = handleNCG(pattern);\n      pattern = handled[0];\n      groups = handled[1];\n    }\n\n    result = inheritIfRequired(NativeRegExp(pattern, flags), thisIsRegExp ? this : RegExpPrototype, RegExpWrapper);\n\n    if (dotAll || sticky || groups.length) {\n      state = enforceInternalState(result);\n      if (dotAll) {\n        state.dotAll = true;\n        state.raw = RegExpWrapper(handleDotAll(pattern), rawFlags);\n      }\n      if (sticky) state.sticky = true;\n      if (groups.length) state.groups = groups;\n    }\n\n    if (pattern !== rawPattern) try {\n      // fails in old engines, but we have no alternatives for unsupported regex syntax\n      createNonEnumerableProperty(result, 'source', rawPattern === '' ? '(?:)' : rawPattern);\n    } catch (error) { /* empty */ }\n\n    return result;\n  };\n\n  var proxy = function (key) {\n    key in RegExpWrapper || defineProperty(RegExpWrapper, key, {\n      configurable: true,\n      get: function () { return NativeRegExp[key]; },\n      set: function (it) { NativeRegExp[key] = it; }\n    });\n  };\n\n  for (var keys = getOwnPropertyNames(NativeRegExp), index = 0; keys.length > index;) {\n    proxy(keys[index++]);\n  }\n\n  RegExpPrototype.constructor = RegExpWrapper;\n  RegExpWrapper.prototype = RegExpPrototype;\n  redefine(global, 'RegExp', RegExpWrapper);\n}\n\n// https://tc39.es/ecma262/#sec-get-regexp-@@species\nsetSpecies('RegExp');\n","var isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\n// `IsRegExp` abstract operation\n// https://tc39.es/ecma262/#sec-isregexp\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : classof(it) == 'RegExp');\n};\n","'use strict';\nvar anObject = require('../internals/an-object');\n\n// `RegExp.prototype.flags` getter implementation\n// https://tc39.es/ecma262/#sec-get-regexp.prototype.flags\nmodule.exports = function () {\n  var that = anObject(this);\n  var result = '';\n  if (that.global) result += 'g';\n  if (that.ignoreCase) result += 'i';\n  if (that.multiline) result += 'm';\n  if (that.dotAll) result += 's';\n  if (that.unicode) result += 'u';\n  if (that.sticky) result += 'y';\n  return result;\n};\n","var fails = require('../internals/fails');\nvar global = require('../internals/global');\n\n// babel-minify and Closure Compiler transpiles RegExp('a', 'y') -> /a/y and it causes SyntaxError\nvar $RegExp = global.RegExp;\n\nvar UNSUPPORTED_Y = fails(function () {\n  var re = $RegExp('a', 'y');\n  re.lastIndex = 2;\n  return re.exec('abcd') != null;\n});\n\n// UC Browser bug\n// https://github.com/zloirock/core-js/issues/1008\nvar MISSED_STICKY = UNSUPPORTED_Y || fails(function () {\n  return !$RegExp('a', 'y').sticky;\n});\n\nvar BROKEN_CARET = UNSUPPORTED_Y || fails(function () {\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=773687\n  var re = $RegExp('^r', 'gy');\n  re.lastIndex = 2;\n  return re.exec('str') != null;\n});\n\nmodule.exports = {\n  BROKEN_CARET: BROKEN_CARET,\n  MISSED_STICKY: MISSED_STICKY,\n  UNSUPPORTED_Y: UNSUPPORTED_Y\n};\n","var fails = require('../internals/fails');\nvar global = require('../internals/global');\n\n// babel-minify and Closure Compiler transpiles RegExp('.', 's') -> /./s and it causes SyntaxError\nvar $RegExp = global.RegExp;\n\nmodule.exports = fails(function () {\n  var re = $RegExp('.', 's');\n  return !(re.dotAll && re.exec('\\n') && re.flags === 's');\n});\n","var fails = require('../internals/fails');\nvar global = require('../internals/global');\n\n// babel-minify and Closure Compiler transpiles RegExp('(?<a>b)', 'g') -> /(?<a>b)/g and it causes SyntaxError\nvar $RegExp = global.RegExp;\n\nmodule.exports = fails(function () {\n  var re = $RegExp('(?<a>b)', 'g');\n  return re.exec('b').groups.a !== 'b' ||\n    'b'.replace(re, '$<a>c') !== 'bc';\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar exec = require('../internals/regexp-exec');\n\n// `RegExp.prototype.exec` method\n// https://tc39.es/ecma262/#sec-regexp.prototype.exec\n$({ target: 'RegExp', proto: true, forced: /./.exec !== exec }, {\n  exec: exec\n});\n","'use strict';\n/* eslint-disable regexp/no-empty-capturing-group, regexp/no-empty-group, regexp/no-lazy-ends -- testing */\n/* eslint-disable regexp/no-useless-quantifier -- testing */\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar regexpFlags = require('../internals/regexp-flags');\nvar stickyHelpers = require('../internals/regexp-sticky-helpers');\nvar shared = require('../internals/shared');\nvar create = require('../internals/object-create');\nvar getInternalState = require('../internals/internal-state').get;\nvar UNSUPPORTED_DOT_ALL = require('../internals/regexp-unsupported-dot-all');\nvar UNSUPPORTED_NCG = require('../internals/regexp-unsupported-ncg');\n\nvar nativeReplace = shared('native-string-replace', String.prototype.replace);\nvar nativeExec = RegExp.prototype.exec;\nvar patchedExec = nativeExec;\nvar charAt = uncurryThis(''.charAt);\nvar indexOf = uncurryThis(''.indexOf);\nvar replace = uncurryThis(''.replace);\nvar stringSlice = uncurryThis(''.slice);\n\nvar UPDATES_LAST_INDEX_WRONG = (function () {\n  var re1 = /a/;\n  var re2 = /b*/g;\n  call(nativeExec, re1, 'a');\n  call(nativeExec, re2, 'a');\n  return re1.lastIndex !== 0 || re2.lastIndex !== 0;\n})();\n\nvar UNSUPPORTED_Y = stickyHelpers.BROKEN_CARET;\n\n// nonparticipating capturing group, copied from es5-shim's String#split patch.\nvar NPCG_INCLUDED = /()??/.exec('')[1] !== undefined;\n\nvar PATCH = UPDATES_LAST_INDEX_WRONG || NPCG_INCLUDED || UNSUPPORTED_Y || UNSUPPORTED_DOT_ALL || UNSUPPORTED_NCG;\n\nif (PATCH) {\n  patchedExec = function exec(string) {\n    var re = this;\n    var state = getInternalState(re);\n    var str = toString(string);\n    var raw = state.raw;\n    var result, reCopy, lastIndex, match, i, object, group;\n\n    if (raw) {\n      raw.lastIndex = re.lastIndex;\n      result = call(patchedExec, raw, str);\n      re.lastIndex = raw.lastIndex;\n      return result;\n    }\n\n    var groups = state.groups;\n    var sticky = UNSUPPORTED_Y && re.sticky;\n    var flags = call(regexpFlags, re);\n    var source = re.source;\n    var charsAdded = 0;\n    var strCopy = str;\n\n    if (sticky) {\n      flags = replace(flags, 'y', '');\n      if (indexOf(flags, 'g') === -1) {\n        flags += 'g';\n      }\n\n      strCopy = stringSlice(str, re.lastIndex);\n      // Support anchored sticky behavior.\n      if (re.lastIndex > 0 && (!re.multiline || re.multiline && charAt(str, re.lastIndex - 1) !== '\\n')) {\n        source = '(?: ' + source + ')';\n        strCopy = ' ' + strCopy;\n        charsAdded++;\n      }\n      // ^(? + rx + ) is needed, in combination with some str slicing, to\n      // simulate the 'y' flag.\n      reCopy = new RegExp('^(?:' + source + ')', flags);\n    }\n\n    if (NPCG_INCLUDED) {\n      reCopy = new RegExp('^' + source + '$(?!\\\\s)', flags);\n    }\n    if (UPDATES_LAST_INDEX_WRONG) lastIndex = re.lastIndex;\n\n    match = call(nativeExec, sticky ? reCopy : re, strCopy);\n\n    if (sticky) {\n      if (match) {\n        match.input = stringSlice(match.input, charsAdded);\n        match[0] = stringSlice(match[0], charsAdded);\n        match.index = re.lastIndex;\n        re.lastIndex += match[0].length;\n      } else re.lastIndex = 0;\n    } else if (UPDATES_LAST_INDEX_WRONG && match) {\n      re.lastIndex = re.global ? match.index + match[0].length : lastIndex;\n    }\n    if (NPCG_INCLUDED && match && match.length > 1) {\n      // Fix browsers whose `exec` methods don't consistently return `undefined`\n      // for NPCG, like IE8. NOTE: This doesn' work for /(.?)?/\n      call(nativeReplace, match[0], reCopy, function () {\n        for (i = 1; i < arguments.length - 2; i++) {\n          if (arguments[i] === undefined) match[i] = undefined;\n        }\n      });\n    }\n\n    if (match && groups) {\n      match.groups = object = create(null);\n      for (i = 0; i < groups.length; i++) {\n        group = groups[i];\n        object[group[0]] = match[group[1]];\n      }\n    }\n\n    return match;\n  };\n}\n\nmodule.exports = patchedExec;\n","var DESCRIPTORS = require('../internals/descriptors');\nvar objectDefinePropertyModule = require('../internals/object-define-property');\nvar regExpFlags = require('../internals/regexp-flags');\nvar fails = require('../internals/fails');\n\nvar RegExpPrototype = RegExp.prototype;\n\nvar FORCED = DESCRIPTORS && fails(function () {\n  // eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\n  return Object.getOwnPropertyDescriptor(RegExpPrototype, 'flags').get.call({ dotAll: true, sticky: true }) !== 'sy';\n});\n\n// `RegExp.prototype.flags` getter\n// https://tc39.es/ecma262/#sec-get-regexp.prototype.flags\nif (FORCED) objectDefinePropertyModule.f(RegExpPrototype, 'flags', {\n  configurable: true,\n  get: regExpFlags\n});\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar redefine = require('../internals/redefine');\nvar anObject = require('../internals/an-object');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar $toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar regExpFlags = require('../internals/regexp-flags');\n\nvar TO_STRING = 'toString';\nvar RegExpPrototype = RegExp.prototype;\nvar n$ToString = RegExpPrototype[TO_STRING];\nvar getFlags = uncurryThis(regExpFlags);\n\nvar NOT_GENERIC = fails(function () { return n$ToString.call({ source: 'a', flags: 'b' }) != '/a/b'; });\n// FF44- RegExp#toString has a wrong name\nvar INCORRECT_NAME = PROPER_FUNCTION_NAME && n$ToString.name != TO_STRING;\n\n// `RegExp.prototype.toString` method\n// https://tc39.es/ecma262/#sec-regexp.prototype.tostring\nif (NOT_GENERIC || INCORRECT_NAME) {\n  redefine(RegExp.prototype, TO_STRING, function toString() {\n    var R = anObject(this);\n    var p = $toString(R.source);\n    var rf = R.flags;\n    var f = $toString(rf === undefined && isPrototypeOf(RegExpPrototype, R) && !('flags' in RegExpPrototype) ? getFlags(R) : rf);\n    return '/' + p + '/' + f;\n  }, { unsafe: true });\n}\n","'use strict';\nvar collection = require('../internals/collection');\nvar collectionStrong = require('../internals/collection-strong');\n\n// `Set` constructor\n// https://tc39.es/ecma262/#sec-set-objects\ncollection('Set', function (init) {\n  return function Set() { return init(this, arguments.length ? arguments[0] : undefined); };\n}, collectionStrong);\n","'use strict';\nvar $ = require('../internals/export');\nvar codeAt = require('../internals/string-multibyte').codeAt;\n\n// `String.prototype.codePointAt` method\n// https://tc39.es/ecma262/#sec-string.prototype.codepointat\n$({ target: 'String', proto: true }, {\n  codePointAt: function codePointAt(pos) {\n    return codeAt(this, pos);\n  }\n});\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toString = require('../internals/to-string');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar charAt = uncurryThis(''.charAt);\nvar charCodeAt = uncurryThis(''.charCodeAt);\nvar stringSlice = uncurryThis(''.slice);\n\nvar createMethod = function (CONVERT_TO_STRING) {\n  return function ($this, pos) {\n    var S = toString(requireObjectCoercible($this));\n    var position = toIntegerOrInfinity(pos);\n    var size = S.length;\n    var first, second;\n    if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;\n    first = charCodeAt(S, position);\n    return first < 0xD800 || first > 0xDBFF || position + 1 === size\n      || (second = charCodeAt(S, position + 1)) < 0xDC00 || second > 0xDFFF\n        ? CONVERT_TO_STRING\n          ? charAt(S, position)\n          : first\n        : CONVERT_TO_STRING\n          ? stringSlice(S, position, position + 2)\n          : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.codePointAt` method\n  // https://tc39.es/ecma262/#sec-string.prototype.codepointat\n  codeAt: createMethod(false),\n  // `String.prototype.at` method\n  // https://github.com/mathiasbynens/String.prototype.at\n  charAt: createMethod(true)\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\nvar IS_PURE = require('../internals/is-pure');\n\n// eslint-disable-next-line es/no-string-prototype-endswith -- safe\nvar un$EndsWith = uncurryThis(''.endsWith);\nvar slice = uncurryThis(''.slice);\nvar min = Math.min;\n\nvar CORRECT_IS_REGEXP_LOGIC = correctIsRegExpLogic('endsWith');\n// https://github.com/zloirock/core-js/pull/702\nvar MDN_POLYFILL_BUG = !IS_PURE && !CORRECT_IS_REGEXP_LOGIC && !!function () {\n  var descriptor = getOwnPropertyDescriptor(String.prototype, 'endsWith');\n  return descriptor && !descriptor.writable;\n}();\n\n// `String.prototype.endsWith` method\n// https://tc39.es/ecma262/#sec-string.prototype.endswith\n$({ target: 'String', proto: true, forced: !MDN_POLYFILL_BUG && !CORRECT_IS_REGEXP_LOGIC }, {\n  endsWith: function endsWith(searchString /* , endPosition = @length */) {\n    var that = toString(requireObjectCoercible(this));\n    notARegExp(searchString);\n    var endPosition = arguments.length > 1 ? arguments[1] : undefined;\n    var len = that.length;\n    var end = endPosition === undefined ? len : min(toLength(endPosition), len);\n    var search = toString(searchString);\n    return un$EndsWith\n      ? un$EndsWith(that, search, end)\n      : slice(that, end - search.length, end) === search;\n  }\n});\n","var global = require('../internals/global');\nvar isRegExp = require('../internals/is-regexp');\n\nvar TypeError = global.TypeError;\n\nmodule.exports = function (it) {\n  if (isRegExp(it)) {\n    throw TypeError(\"The method doesn't accept regular expressions\");\n  } return it;\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\nmodule.exports = function (METHOD_NAME) {\n  var regexp = /./;\n  try {\n    '/./'[METHOD_NAME](regexp);\n  } catch (error1) {\n    try {\n      regexp[MATCH] = false;\n      return '/./'[METHOD_NAME](regexp);\n    } catch (error2) { /* empty */ }\n  } return false;\n};\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\n\nvar RangeError = global.RangeError;\nvar fromCharCode = String.fromCharCode;\n// eslint-disable-next-line es/no-string-fromcodepoint -- required for testing\nvar $fromCodePoint = String.fromCodePoint;\nvar join = uncurryThis([].join);\n\n// length should be 1, old FF problem\nvar INCORRECT_LENGTH = !!$fromCodePoint && $fromCodePoint.length != 1;\n\n// `String.fromCodePoint` method\n// https://tc39.es/ecma262/#sec-string.fromcodepoint\n$({ target: 'String', stat: true, forced: INCORRECT_LENGTH }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  fromCodePoint: function fromCodePoint(x) {\n    var elements = [];\n    var length = arguments.length;\n    var i = 0;\n    var code;\n    while (length > i) {\n      code = +arguments[i++];\n      if (toAbsoluteIndex(code, 0x10FFFF) !== code) throw RangeError(code + ' is not a valid code point');\n      elements[i] = code < 0x10000\n        ? fromCharCode(code)\n        : fromCharCode(((code -= 0x10000) >> 10) + 0xD800, code % 0x400 + 0xDC00);\n    } return join(elements, '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toString = require('../internals/to-string');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\n\nvar stringIndexOf = uncurryThis(''.indexOf);\n\n// `String.prototype.includes` method\n// https://tc39.es/ecma262/#sec-string.prototype.includes\n$({ target: 'String', proto: true, forced: !correctIsRegExpLogic('includes') }, {\n  includes: function includes(searchString /* , position = 0 */) {\n    return !!~stringIndexOf(\n      toString(requireObjectCoercible(this)),\n      toString(notARegExp(searchString)),\n      arguments.length > 1 ? arguments[1] : undefined\n    );\n  }\n});\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\nvar toString = require('../internals/to-string');\nvar InternalStateModule = require('../internals/internal-state');\nvar defineIterator = require('../internals/define-iterator');\n\nvar STRING_ITERATOR = 'String Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(STRING_ITERATOR);\n\n// `String.prototype[@@iterator]` method\n// https://tc39.es/ecma262/#sec-string.prototype-@@iterator\ndefineIterator(String, 'String', function (iterated) {\n  setInternalState(this, {\n    type: STRING_ITERATOR,\n    string: toString(iterated),\n    index: 0\n  });\n// `%StringIteratorPrototype%.next` method\n// https://tc39.es/ecma262/#sec-%stringiteratorprototype%.next\n}, function next() {\n  var state = getInternalState(this);\n  var string = state.string;\n  var index = state.index;\n  var point;\n  if (index >= string.length) return { value: undefined, done: true };\n  point = charAt(string, index);\n  state.index += point.length;\n  return { value: point, done: false };\n});\n","'use strict';\nvar call = require('../internals/function-call');\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar getMethod = require('../internals/get-method');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\n// @@match logic\nfixRegExpWellKnownSymbolLogic('match', function (MATCH, nativeMatch, maybeCallNative) {\n  return [\n    // `String.prototype.match` method\n    // https://tc39.es/ecma262/#sec-string.prototype.match\n    function match(regexp) {\n      var O = requireObjectCoercible(this);\n      var matcher = regexp == undefined ? undefined : getMethod(regexp, MATCH);\n      return matcher ? call(matcher, regexp, O) : new RegExp(regexp)[MATCH](toString(O));\n    },\n    // `RegExp.prototype[@@match]` method\n    // https://tc39.es/ecma262/#sec-regexp.prototype-@@match\n    function (string) {\n      var rx = anObject(this);\n      var S = toString(string);\n      var res = maybeCallNative(nativeMatch, rx, S);\n\n      if (res.done) return res.value;\n\n      if (!rx.global) return regExpExec(rx, S);\n\n      var fullUnicode = rx.unicode;\n      rx.lastIndex = 0;\n      var A = [];\n      var n = 0;\n      var result;\n      while ((result = regExpExec(rx, S)) !== null) {\n        var matchStr = toString(result[0]);\n        A[n] = matchStr;\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n        n++;\n      }\n      return n === 0 ? null : A;\n    }\n  ];\n});\n","'use strict';\n// TODO: Remove from `core-js@4` since it's moved to entry points\nrequire('../modules/es.regexp.exec');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar redefine = require('../internals/redefine');\nvar regexpExec = require('../internals/regexp-exec');\nvar fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nvar SPECIES = wellKnownSymbol('species');\nvar RegExpPrototype = RegExp.prototype;\n\nmodule.exports = function (KEY, exec, FORCED, SHAM) {\n  var SYMBOL = wellKnownSymbol(KEY);\n\n  var DELEGATES_TO_SYMBOL = !fails(function () {\n    // String methods call symbol-named RegEp methods\n    var O = {};\n    O[SYMBOL] = function () { return 7; };\n    return ''[KEY](O) != 7;\n  });\n\n  var DELEGATES_TO_EXEC = DELEGATES_TO_SYMBOL && !fails(function () {\n    // Symbol-named RegExp methods call .exec\n    var execCalled = false;\n    var re = /a/;\n\n    if (KEY === 'split') {\n      // We can't use real regex here since it causes deoptimization\n      // and serious performance degradation in V8\n      // https://github.com/zloirock/core-js/issues/306\n      re = {};\n      // RegExp[@@split] doesn't call the regex's exec method, but first creates\n      // a new one. We need to return the patched regex when creating the new one.\n      re.constructor = {};\n      re.constructor[SPECIES] = function () { return re; };\n      re.flags = '';\n      re[SYMBOL] = /./[SYMBOL];\n    }\n\n    re.exec = function () { execCalled = true; return null; };\n\n    re[SYMBOL]('');\n    return !execCalled;\n  });\n\n  if (\n    !DELEGATES_TO_SYMBOL ||\n    !DELEGATES_TO_EXEC ||\n    FORCED\n  ) {\n    var uncurriedNativeRegExpMethod = uncurryThis(/./[SYMBOL]);\n    var methods = exec(SYMBOL, ''[KEY], function (nativeMethod, regexp, str, arg2, forceStringMethod) {\n      var uncurriedNativeMethod = uncurryThis(nativeMethod);\n      var $exec = regexp.exec;\n      if ($exec === regexpExec || $exec === RegExpPrototype.exec) {\n        if (DELEGATES_TO_SYMBOL && !forceStringMethod) {\n          // The native String method already delegates to @@method (this\n          // polyfilled function), leasing to infinite recursion.\n          // We avoid it by directly calling the native @@method method.\n          return { done: true, value: uncurriedNativeRegExpMethod(regexp, str, arg2) };\n        }\n        return { done: true, value: uncurriedNativeMethod(str, regexp, arg2) };\n      }\n      return { done: false };\n    });\n\n    redefine(String.prototype, KEY, methods[0]);\n    redefine(RegExpPrototype, SYMBOL, methods[1]);\n  }\n\n  if (SHAM) createNonEnumerableProperty(RegExpPrototype[SYMBOL], 'sham', true);\n};\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\n\n// `AdvanceStringIndex` abstract operation\n// https://tc39.es/ecma262/#sec-advancestringindex\nmodule.exports = function (S, index, unicode) {\n  return index + (unicode ? charAt(S, index).length : 1);\n};\n","var global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar isCallable = require('../internals/is-callable');\nvar classof = require('../internals/classof-raw');\nvar regexpExec = require('../internals/regexp-exec');\n\nvar TypeError = global.TypeError;\n\n// `RegExpExec` abstract operation\n// https://tc39.es/ecma262/#sec-regexpexec\nmodule.exports = function (R, S) {\n  var exec = R.exec;\n  if (isCallable(exec)) {\n    var result = call(exec, R, S);\n    if (result !== null) anObject(result);\n    return result;\n  }\n  if (classof(R) === 'RegExp') return call(regexpExec, R, S);\n  throw TypeError('RegExp#exec called on incompatible receiver');\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $padEnd = require('../internals/string-pad').end;\nvar WEBKIT_BUG = require('../internals/string-pad-webkit-bug');\n\n// `String.prototype.padEnd` method\n// https://tc39.es/ecma262/#sec-string.prototype.padend\n$({ target: 'String', proto: true, forced: WEBKIT_BUG }, {\n  padEnd: function padEnd(maxLength /* , fillString = ' ' */) {\n    return $padEnd(this, maxLength, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","// https://github.com/tc39/proposal-string-pad-start-end\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar $repeat = require('../internals/string-repeat');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar repeat = uncurryThis($repeat);\nvar stringSlice = uncurryThis(''.slice);\nvar ceil = Math.ceil;\n\n// `String.prototype.{ padStart, padEnd }` methods implementation\nvar createMethod = function (IS_END) {\n  return function ($this, maxLength, fillString) {\n    var S = toString(requireObjectCoercible($this));\n    var intMaxLength = toLength(maxLength);\n    var stringLength = S.length;\n    var fillStr = fillString === undefined ? ' ' : toString(fillString);\n    var fillLen, stringFiller;\n    if (intMaxLength <= stringLength || fillStr == '') return S;\n    fillLen = intMaxLength - stringLength;\n    stringFiller = repeat(fillStr, ceil(fillLen / fillStr.length));\n    if (stringFiller.length > fillLen) stringFiller = stringSlice(stringFiller, 0, fillLen);\n    return IS_END ? S + stringFiller : stringFiller + S;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.padStart` method\n  // https://tc39.es/ecma262/#sec-string.prototype.padstart\n  start: createMethod(false),\n  // `String.prototype.padEnd` method\n  // https://tc39.es/ecma262/#sec-string.prototype.padend\n  end: createMethod(true)\n};\n","// https://github.com/zloirock/core-js/issues/280\nvar userAgent = require('../internals/engine-user-agent');\n\nmodule.exports = /Version\\/10(?:\\.\\d+){1,2}(?: [\\w./]+)?(?: Mobile\\/\\w+)? Safari\\//.test(userAgent);\n","'use strict';\nvar $ = require('../internals/export');\nvar $padStart = require('../internals/string-pad').start;\nvar WEBKIT_BUG = require('../internals/string-pad-webkit-bug');\n\n// `String.prototype.padStart` method\n// https://tc39.es/ecma262/#sec-string.prototype.padstart\n$({ target: 'String', proto: true, forced: WEBKIT_BUG }, {\n  padStart: function padStart(maxLength /* , fillString = ' ' */) {\n    return $padStart(this, maxLength, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","var $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toObject = require('../internals/to-object');\nvar toString = require('../internals/to-string');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\nvar push = uncurryThis([].push);\nvar join = uncurryThis([].join);\n\n// `String.raw` method\n// https://tc39.es/ecma262/#sec-string.raw\n$({ target: 'String', stat: true }, {\n  raw: function raw(template) {\n    var rawTemplate = toIndexedObject(toObject(template).raw);\n    var literalSegments = lengthOfArrayLike(rawTemplate);\n    var argumentsLength = arguments.length;\n    var elements = [];\n    var i = 0;\n    while (literalSegments > i) {\n      push(elements, toString(rawTemplate[i++]));\n      if (i === literalSegments) return join(elements, '');\n      if (i < argumentsLength) push(elements, toString(arguments[i]));\n    }\n  }\n});\n","var $ = require('../internals/export');\nvar repeat = require('../internals/string-repeat');\n\n// `String.prototype.repeat` method\n// https://tc39.es/ecma262/#sec-string.prototype.repeat\n$({ target: 'String', proto: true }, {\n  repeat: repeat\n});\n","'use strict';\nvar apply = require('../internals/function-apply');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar fails = require('../internals/fails');\nvar anObject = require('../internals/an-object');\nvar isCallable = require('../internals/is-callable');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar getMethod = require('../internals/get-method');\nvar getSubstitution = require('../internals/get-substitution');\nvar regExpExec = require('../internals/regexp-exec-abstract');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar REPLACE = wellKnownSymbol('replace');\nvar max = Math.max;\nvar min = Math.min;\nvar concat = uncurryThis([].concat);\nvar push = uncurryThis([].push);\nvar stringIndexOf = uncurryThis(''.indexOf);\nvar stringSlice = uncurryThis(''.slice);\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// IE <= 11 replaces $0 with the whole match, as if it was $&\n// https://stackoverflow.com/questions/6024666/getting-ie-to-replace-a-regex-with-the-literal-string-0\nvar REPLACE_KEEPS_$0 = (function () {\n  // eslint-disable-next-line regexp/prefer-escape-replacement-dollar-char -- required for testing\n  return 'a'.replace(/./, '$0') === '$0';\n})();\n\n// Safari <= 13.0.3(?) substitutes nth capture where n>m with an empty string\nvar REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE = (function () {\n  if (/./[REPLACE]) {\n    return /./[REPLACE]('a', '$0') === '';\n  }\n  return false;\n})();\n\nvar REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {\n  var re = /./;\n  re.exec = function () {\n    var result = [];\n    result.groups = { a: '7' };\n    return result;\n  };\n  // eslint-disable-next-line regexp/no-useless-dollar-replacements -- false positive\n  return ''.replace(re, '$<a>') !== '7';\n});\n\n// @@replace logic\nfixRegExpWellKnownSymbolLogic('replace', function (_, nativeReplace, maybeCallNative) {\n  var UNSAFE_SUBSTITUTE = REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE ? '$' : '$0';\n\n  return [\n    // `String.prototype.replace` method\n    // https://tc39.es/ecma262/#sec-string.prototype.replace\n    function replace(searchValue, replaceValue) {\n      var O = requireObjectCoercible(this);\n      var replacer = searchValue == undefined ? undefined : getMethod(searchValue, REPLACE);\n      return replacer\n        ? call(replacer, searchValue, O, replaceValue)\n        : call(nativeReplace, toString(O), searchValue, replaceValue);\n    },\n    // `RegExp.prototype[@@replace]` method\n    // https://tc39.es/ecma262/#sec-regexp.prototype-@@replace\n    function (string, replaceValue) {\n      var rx = anObject(this);\n      var S = toString(string);\n\n      if (\n        typeof replaceValue == 'string' &&\n        stringIndexOf(replaceValue, UNSAFE_SUBSTITUTE) === -1 &&\n        stringIndexOf(replaceValue, '$<') === -1\n      ) {\n        var res = maybeCallNative(nativeReplace, rx, S, replaceValue);\n        if (res.done) return res.value;\n      }\n\n      var functionalReplace = isCallable(replaceValue);\n      if (!functionalReplace) replaceValue = toString(replaceValue);\n\n      var global = rx.global;\n      if (global) {\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n      }\n      var results = [];\n      while (true) {\n        var result = regExpExec(rx, S);\n        if (result === null) break;\n\n        push(results, result);\n        if (!global) break;\n\n        var matchStr = toString(result[0]);\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n      }\n\n      var accumulatedResult = '';\n      var nextSourcePosition = 0;\n      for (var i = 0; i < results.length; i++) {\n        result = results[i];\n\n        var matched = toString(result[0]);\n        var position = max(min(toIntegerOrInfinity(result.index), S.length), 0);\n        var captures = [];\n        // NOTE: This is equivalent to\n        //   captures = result.slice(1).map(maybeToString)\n        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n        // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n        for (var j = 1; j < result.length; j++) push(captures, maybeToString(result[j]));\n        var namedCaptures = result.groups;\n        if (functionalReplace) {\n          var replacerArgs = concat([matched], captures, position, S);\n          if (namedCaptures !== undefined) push(replacerArgs, namedCaptures);\n          var replacement = toString(apply(replaceValue, undefined, replacerArgs));\n        } else {\n          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n        }\n        if (position >= nextSourcePosition) {\n          accumulatedResult += stringSlice(S, nextSourcePosition, position) + replacement;\n          nextSourcePosition = position + matched.length;\n        }\n      }\n      return accumulatedResult + stringSlice(S, nextSourcePosition);\n    }\n  ];\n}, !REPLACE_SUPPORTS_NAMED_GROUPS || !REPLACE_KEEPS_$0 || REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE);\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar toObject = require('../internals/to-object');\n\nvar floor = Math.floor;\nvar charAt = uncurryThis(''.charAt);\nvar replace = uncurryThis(''.replace);\nvar stringSlice = uncurryThis(''.slice);\nvar SUBSTITUTION_SYMBOLS = /\\$([$&'`]|\\d{1,2}|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&'`]|\\d{1,2})/g;\n\n// `GetSubstitution` abstract operation\n// https://tc39.es/ecma262/#sec-getsubstitution\nmodule.exports = function (matched, str, position, captures, namedCaptures, replacement) {\n  var tailPos = position + matched.length;\n  var m = captures.length;\n  var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n  if (namedCaptures !== undefined) {\n    namedCaptures = toObject(namedCaptures);\n    symbols = SUBSTITUTION_SYMBOLS;\n  }\n  return replace(replacement, symbols, function (match, ch) {\n    var capture;\n    switch (charAt(ch, 0)) {\n      case '$': return '$';\n      case '&': return matched;\n      case '`': return stringSlice(str, 0, position);\n      case \"'\": return stringSlice(str, tailPos);\n      case '<':\n        capture = namedCaptures[stringSlice(ch, 1, -1)];\n        break;\n      default: // \\d\\d?\n        var n = +ch;\n        if (n === 0) return match;\n        if (n > m) {\n          var f = floor(n / 10);\n          if (f === 0) return match;\n          if (f <= m) return captures[f - 1] === undefined ? charAt(ch, 1) : captures[f - 1] + charAt(ch, 1);\n          return match;\n        }\n        capture = captures[n - 1];\n    }\n    return capture === undefined ? '' : capture;\n  });\n};\n","'use strict';\nvar call = require('../internals/function-call');\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar sameValue = require('../internals/same-value');\nvar toString = require('../internals/to-string');\nvar getMethod = require('../internals/get-method');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\n// @@search logic\nfixRegExpWellKnownSymbolLogic('search', function (SEARCH, nativeSearch, maybeCallNative) {\n  return [\n    // `String.prototype.search` method\n    // https://tc39.es/ecma262/#sec-string.prototype.search\n    function search(regexp) {\n      var O = requireObjectCoercible(this);\n      var searcher = regexp == undefined ? undefined : getMethod(regexp, SEARCH);\n      return searcher ? call(searcher, regexp, O) : new RegExp(regexp)[SEARCH](toString(O));\n    },\n    // `RegExp.prototype[@@search]` method\n    // https://tc39.es/ecma262/#sec-regexp.prototype-@@search\n    function (string) {\n      var rx = anObject(this);\n      var S = toString(string);\n      var res = maybeCallNative(nativeSearch, rx, S);\n\n      if (res.done) return res.value;\n\n      var previousLastIndex = rx.lastIndex;\n      if (!sameValue(previousLastIndex, 0)) rx.lastIndex = 0;\n      var result = regExpExec(rx, S);\n      if (!sameValue(rx.lastIndex, previousLastIndex)) rx.lastIndex = previousLastIndex;\n      return result === null ? -1 : result.index;\n    }\n  ];\n});\n","'use strict';\nvar apply = require('../internals/function-apply');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar isRegExp = require('../internals/is-regexp');\nvar anObject = require('../internals/an-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar speciesConstructor = require('../internals/species-constructor');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar getMethod = require('../internals/get-method');\nvar arraySlice = require('../internals/array-slice-simple');\nvar callRegExpExec = require('../internals/regexp-exec-abstract');\nvar regexpExec = require('../internals/regexp-exec');\nvar stickyHelpers = require('../internals/regexp-sticky-helpers');\nvar fails = require('../internals/fails');\n\nvar UNSUPPORTED_Y = stickyHelpers.UNSUPPORTED_Y;\nvar MAX_UINT32 = 0xFFFFFFFF;\nvar min = Math.min;\nvar $push = [].push;\nvar exec = uncurryThis(/./.exec);\nvar push = uncurryThis($push);\nvar stringSlice = uncurryThis(''.slice);\n\n// Chrome 51 has a buggy \"split\" implementation when RegExp#exec !== nativeExec\n// Weex JS has frozen built-in prototypes, so use try / catch wrapper\nvar SPLIT_WORKS_WITH_OVERWRITTEN_EXEC = !fails(function () {\n  // eslint-disable-next-line regexp/no-empty-group -- required for testing\n  var re = /(?:)/;\n  var originalExec = re.exec;\n  re.exec = function () { return originalExec.apply(this, arguments); };\n  var result = 'ab'.split(re);\n  return result.length !== 2 || result[0] !== 'a' || result[1] !== 'b';\n});\n\n// @@split logic\nfixRegExpWellKnownSymbolLogic('split', function (SPLIT, nativeSplit, maybeCallNative) {\n  var internalSplit;\n  if (\n    'abbc'.split(/(b)*/)[1] == 'c' ||\n    // eslint-disable-next-line regexp/no-empty-group -- required for testing\n    'test'.split(/(?:)/, -1).length != 4 ||\n    'ab'.split(/(?:ab)*/).length != 2 ||\n    '.'.split(/(.?)(.?)/).length != 4 ||\n    // eslint-disable-next-line regexp/no-empty-capturing-group, regexp/no-empty-group -- required for testing\n    '.'.split(/()()/).length > 1 ||\n    ''.split(/.?/).length\n  ) {\n    // based on es5-shim implementation, need to rework it\n    internalSplit = function (separator, limit) {\n      var string = toString(requireObjectCoercible(this));\n      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      if (lim === 0) return [];\n      if (separator === undefined) return [string];\n      // If `separator` is not a regex, use native split\n      if (!isRegExp(separator)) {\n        return call(nativeSplit, string, separator, lim);\n      }\n      var output = [];\n      var flags = (separator.ignoreCase ? 'i' : '') +\n                  (separator.multiline ? 'm' : '') +\n                  (separator.unicode ? 'u' : '') +\n                  (separator.sticky ? 'y' : '');\n      var lastLastIndex = 0;\n      // Make `global` and avoid `lastIndex` issues by working with a copy\n      var separatorCopy = new RegExp(separator.source, flags + 'g');\n      var match, lastIndex, lastLength;\n      while (match = call(regexpExec, separatorCopy, string)) {\n        lastIndex = separatorCopy.lastIndex;\n        if (lastIndex > lastLastIndex) {\n          push(output, stringSlice(string, lastLastIndex, match.index));\n          if (match.length > 1 && match.index < string.length) apply($push, output, arraySlice(match, 1));\n          lastLength = match[0].length;\n          lastLastIndex = lastIndex;\n          if (output.length >= lim) break;\n        }\n        if (separatorCopy.lastIndex === match.index) separatorCopy.lastIndex++; // Avoid an infinite loop\n      }\n      if (lastLastIndex === string.length) {\n        if (lastLength || !exec(separatorCopy, '')) push(output, '');\n      } else push(output, stringSlice(string, lastLastIndex));\n      return output.length > lim ? arraySlice(output, 0, lim) : output;\n    };\n  // Chakra, V8\n  } else if ('0'.split(undefined, 0).length) {\n    internalSplit = function (separator, limit) {\n      return separator === undefined && limit === 0 ? [] : call(nativeSplit, this, separator, limit);\n    };\n  } else internalSplit = nativeSplit;\n\n  return [\n    // `String.prototype.split` method\n    // https://tc39.es/ecma262/#sec-string.prototype.split\n    function split(separator, limit) {\n      var O = requireObjectCoercible(this);\n      var splitter = separator == undefined ? undefined : getMethod(separator, SPLIT);\n      return splitter\n        ? call(splitter, separator, O, limit)\n        : call(internalSplit, toString(O), separator, limit);\n    },\n    // `RegExp.prototype[@@split]` method\n    // https://tc39.es/ecma262/#sec-regexp.prototype-@@split\n    //\n    // NOTE: This cannot be properly polyfilled in engines that don't support\n    // the 'y' flag.\n    function (string, limit) {\n      var rx = anObject(this);\n      var S = toString(string);\n      var res = maybeCallNative(internalSplit, rx, S, limit, internalSplit !== nativeSplit);\n\n      if (res.done) return res.value;\n\n      var C = speciesConstructor(rx, RegExp);\n\n      var unicodeMatching = rx.unicode;\n      var flags = (rx.ignoreCase ? 'i' : '') +\n                  (rx.multiline ? 'm' : '') +\n                  (rx.unicode ? 'u' : '') +\n                  (UNSUPPORTED_Y ? 'g' : 'y');\n\n      // ^(? + rx + ) is needed, in combination with some S slicing, to\n      // simulate the 'y' flag.\n      var splitter = new C(UNSUPPORTED_Y ? '^(?:' + rx.source + ')' : rx, flags);\n      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      if (lim === 0) return [];\n      if (S.length === 0) return callRegExpExec(splitter, S) === null ? [S] : [];\n      var p = 0;\n      var q = 0;\n      var A = [];\n      while (q < S.length) {\n        splitter.lastIndex = UNSUPPORTED_Y ? 0 : q;\n        var z = callRegExpExec(splitter, UNSUPPORTED_Y ? stringSlice(S, q) : S);\n        var e;\n        if (\n          z === null ||\n          (e = min(toLength(splitter.lastIndex + (UNSUPPORTED_Y ? q : 0)), S.length)) === p\n        ) {\n          q = advanceStringIndex(S, q, unicodeMatching);\n        } else {\n          push(A, stringSlice(S, p, q));\n          if (A.length === lim) return A;\n          for (var i = 1; i <= z.length - 1; i++) {\n            push(A, z[i]);\n            if (A.length === lim) return A;\n          }\n          q = p = e;\n        }\n      }\n      push(A, stringSlice(S, p));\n      return A;\n    }\n  ];\n}, !SPLIT_WORKS_WITH_OVERWRITTEN_EXEC, UNSUPPORTED_Y);\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\nvar IS_PURE = require('../internals/is-pure');\n\n// eslint-disable-next-line es/no-string-prototype-startswith -- safe\nvar un$StartsWith = uncurryThis(''.startsWith);\nvar stringSlice = uncurryThis(''.slice);\nvar min = Math.min;\n\nvar CORRECT_IS_REGEXP_LOGIC = correctIsRegExpLogic('startsWith');\n// https://github.com/zloirock/core-js/pull/702\nvar MDN_POLYFILL_BUG = !IS_PURE && !CORRECT_IS_REGEXP_LOGIC && !!function () {\n  var descriptor = getOwnPropertyDescriptor(String.prototype, 'startsWith');\n  return descriptor && !descriptor.writable;\n}();\n\n// `String.prototype.startsWith` method\n// https://tc39.es/ecma262/#sec-string.prototype.startswith\n$({ target: 'String', proto: true, forced: !MDN_POLYFILL_BUG && !CORRECT_IS_REGEXP_LOGIC }, {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = toString(requireObjectCoercible(this));\n    notARegExp(searchString);\n    var index = toLength(min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = toString(searchString);\n    return un$StartsWith\n      ? un$StartsWith(that, search, index)\n      : stringSlice(that, index, index + search.length) === search;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.es/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n","var PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]()\n      || non[METHOD_NAME]() !== non\n      || (PROPER_FUNCTION_NAME && whitespaces[METHOD_NAME].name !== METHOD_NAME);\n  });\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $trimEnd = require('../internals/string-trim').end;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\nvar FORCED = forcedStringTrimMethod('trimEnd');\n\nvar trimEnd = FORCED ? function trimEnd() {\n  return $trimEnd(this);\n// eslint-disable-next-line es/no-string-prototype-trimstart-trimend -- safe\n} : ''.trimEnd;\n\n// `String.prototype.{ trimEnd, trimRight }` methods\n// https://tc39.es/ecma262/#sec-string.prototype.trimend\n// https://tc39.es/ecma262/#String.prototype.trimright\n$({ target: 'String', proto: true, name: 'trimEnd', forced: FORCED }, {\n  trimEnd: trimEnd,\n  trimRight: trimEnd\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $trimStart = require('../internals/string-trim').start;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\nvar FORCED = forcedStringTrimMethod('trimStart');\n\nvar trimStart = FORCED ? function trimStart() {\n  return $trimStart(this);\n// eslint-disable-next-line es/no-string-prototype-trimstart-trimend -- safe\n} : ''.trimStart;\n\n// `String.prototype.{ trimStart, trimLeft }` methods\n// https://tc39.es/ecma262/#sec-string.prototype.trimstart\n// https://tc39.es/ecma262/#String.prototype.trimleft\n$({ target: 'String', proto: true, name: 'trimStart', forced: FORCED }, {\n  trimStart: trimStart,\n  trimLeft: trimStart\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.anchor` method\n// https://tc39.es/ecma262/#sec-string.prototype.anchor\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('anchor') }, {\n  anchor: function anchor(name) {\n    return createHTML(this, 'a', 'name', name);\n  }\n});\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toString = require('../internals/to-string');\n\nvar quot = /\"/g;\nvar replace = uncurryThis(''.replace);\n\n// `CreateHTML` abstract operation\n// https://tc39.es/ecma262/#sec-createhtml\nmodule.exports = function (string, tag, attribute, value) {\n  var S = toString(requireObjectCoercible(string));\n  var p1 = '<' + tag;\n  if (attribute !== '') p1 += ' ' + attribute + '=\"' + replace(toString(value), quot, '&quot;') + '\"';\n  return p1 + '>' + S + '</' + tag + '>';\n};\n","var fails = require('../internals/fails');\n\n// check the existence of a method, lowercase\n// of a tag and escaping quotes in arguments\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    var test = ''[METHOD_NAME]('\"');\n    return test !== test.toLowerCase() || test.split('\"').length > 3;\n  });\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.big` method\n// https://tc39.es/ecma262/#sec-string.prototype.big\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('big') }, {\n  big: function big() {\n    return createHTML(this, 'big', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.blink` method\n// https://tc39.es/ecma262/#sec-string.prototype.blink\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('blink') }, {\n  blink: function blink() {\n    return createHTML(this, 'blink', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.bold` method\n// https://tc39.es/ecma262/#sec-string.prototype.bold\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('bold') }, {\n  bold: function bold() {\n    return createHTML(this, 'b', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.fixed` method\n// https://tc39.es/ecma262/#sec-string.prototype.fixed\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('fixed') }, {\n  fixed: function fixed() {\n    return createHTML(this, 'tt', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.fontcolor` method\n// https://tc39.es/ecma262/#sec-string.prototype.fontcolor\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('fontcolor') }, {\n  fontcolor: function fontcolor(color) {\n    return createHTML(this, 'font', 'color', color);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.fontsize` method\n// https://tc39.es/ecma262/#sec-string.prototype.fontsize\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('fontsize') }, {\n  fontsize: function fontsize(size) {\n    return createHTML(this, 'font', 'size', size);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.italics` method\n// https://tc39.es/ecma262/#sec-string.prototype.italics\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('italics') }, {\n  italics: function italics() {\n    return createHTML(this, 'i', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.link` method\n// https://tc39.es/ecma262/#sec-string.prototype.link\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('link') }, {\n  link: function link(url) {\n    return createHTML(this, 'a', 'href', url);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.small` method\n// https://tc39.es/ecma262/#sec-string.prototype.small\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('small') }, {\n  small: function small() {\n    return createHTML(this, 'small', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.strike` method\n// https://tc39.es/ecma262/#sec-string.prototype.strike\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('strike') }, {\n  strike: function strike() {\n    return createHTML(this, 'strike', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.sub` method\n// https://tc39.es/ecma262/#sec-string.prototype.sub\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('sub') }, {\n  sub: function sub() {\n    return createHTML(this, 'sub', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.sup` method\n// https://tc39.es/ecma262/#sec-string.prototype.sup\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('sup') }, {\n  sup: function sup() {\n    return createHTML(this, 'sup', '', '');\n  }\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Float32Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Float32', function (init) {\n  return function Float32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS = require('../internals/typed-array-constructors-require-wrappers');\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar ArrayBufferModule = require('../internals/array-buffer');\nvar anInstance = require('../internals/an-instance');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar isIntegralNumber = require('../internals/is-integral-number');\nvar toLength = require('../internals/to-length');\nvar toIndex = require('../internals/to-index');\nvar toOffset = require('../internals/to-offset');\nvar toPropertyKey = require('../internals/to-property-key');\nvar hasOwn = require('../internals/has-own-property');\nvar classof = require('../internals/classof');\nvar isObject = require('../internals/is-object');\nvar isSymbol = require('../internals/is-symbol');\nvar create = require('../internals/object-create');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar typedArrayFrom = require('../internals/typed-array-from');\nvar forEach = require('../internals/array-iteration').forEach;\nvar setSpecies = require('../internals/set-species');\nvar definePropertyModule = require('../internals/object-define-property');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar InternalStateModule = require('../internals/internal-state');\nvar inheritIfRequired = require('../internals/inherit-if-required');\n\nvar getInternalState = InternalStateModule.get;\nvar setInternalState = InternalStateModule.set;\nvar nativeDefineProperty = definePropertyModule.f;\nvar nativeGetOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\nvar round = Math.round;\nvar RangeError = global.RangeError;\nvar ArrayBuffer = ArrayBufferModule.ArrayBuffer;\nvar ArrayBufferPrototype = ArrayBuffer.prototype;\nvar DataView = ArrayBufferModule.DataView;\nvar NATIVE_ARRAY_BUFFER_VIEWS = ArrayBufferViewCore.NATIVE_ARRAY_BUFFER_VIEWS;\nvar TYPED_ARRAY_CONSTRUCTOR = ArrayBufferViewCore.TYPED_ARRAY_CONSTRUCTOR;\nvar TYPED_ARRAY_TAG = ArrayBufferViewCore.TYPED_ARRAY_TAG;\nvar TypedArray = ArrayBufferViewCore.TypedArray;\nvar TypedArrayPrototype = ArrayBufferViewCore.TypedArrayPrototype;\nvar aTypedArrayConstructor = ArrayBufferViewCore.aTypedArrayConstructor;\nvar isTypedArray = ArrayBufferViewCore.isTypedArray;\nvar BYTES_PER_ELEMENT = 'BYTES_PER_ELEMENT';\nvar WRONG_LENGTH = 'Wrong length';\n\nvar fromList = function (C, list) {\n  aTypedArrayConstructor(C);\n  var index = 0;\n  var length = list.length;\n  var result = new C(length);\n  while (length > index) result[index] = list[index++];\n  return result;\n};\n\nvar addGetter = function (it, key) {\n  nativeDefineProperty(it, key, { get: function () {\n    return getInternalState(this)[key];\n  } });\n};\n\nvar isArrayBuffer = function (it) {\n  var klass;\n  return isPrototypeOf(ArrayBufferPrototype, it) || (klass = classof(it)) == 'ArrayBuffer' || klass == 'SharedArrayBuffer';\n};\n\nvar isTypedArrayIndex = function (target, key) {\n  return isTypedArray(target)\n    && !isSymbol(key)\n    && key in target\n    && isIntegralNumber(+key)\n    && key >= 0;\n};\n\nvar wrappedGetOwnPropertyDescriptor = function getOwnPropertyDescriptor(target, key) {\n  key = toPropertyKey(key);\n  return isTypedArrayIndex(target, key)\n    ? createPropertyDescriptor(2, target[key])\n    : nativeGetOwnPropertyDescriptor(target, key);\n};\n\nvar wrappedDefineProperty = function defineProperty(target, key, descriptor) {\n  key = toPropertyKey(key);\n  if (isTypedArrayIndex(target, key)\n    && isObject(descriptor)\n    && hasOwn(descriptor, 'value')\n    && !hasOwn(descriptor, 'get')\n    && !hasOwn(descriptor, 'set')\n    // TODO: add validation descriptor w/o calling accessors\n    && !descriptor.configurable\n    && (!hasOwn(descriptor, 'writable') || descriptor.writable)\n    && (!hasOwn(descriptor, 'enumerable') || descriptor.enumerable)\n  ) {\n    target[key] = descriptor.value;\n    return target;\n  } return nativeDefineProperty(target, key, descriptor);\n};\n\nif (DESCRIPTORS) {\n  if (!NATIVE_ARRAY_BUFFER_VIEWS) {\n    getOwnPropertyDescriptorModule.f = wrappedGetOwnPropertyDescriptor;\n    definePropertyModule.f = wrappedDefineProperty;\n    addGetter(TypedArrayPrototype, 'buffer');\n    addGetter(TypedArrayPrototype, 'byteOffset');\n    addGetter(TypedArrayPrototype, 'byteLength');\n    addGetter(TypedArrayPrototype, 'length');\n  }\n\n  $({ target: 'Object', stat: true, forced: !NATIVE_ARRAY_BUFFER_VIEWS }, {\n    getOwnPropertyDescriptor: wrappedGetOwnPropertyDescriptor,\n    defineProperty: wrappedDefineProperty\n  });\n\n  module.exports = function (TYPE, wrapper, CLAMPED) {\n    var BYTES = TYPE.match(/\\d+$/)[0] / 8;\n    var CONSTRUCTOR_NAME = TYPE + (CLAMPED ? 'Clamped' : '') + 'Array';\n    var GETTER = 'get' + TYPE;\n    var SETTER = 'set' + TYPE;\n    var NativeTypedArrayConstructor = global[CONSTRUCTOR_NAME];\n    var TypedArrayConstructor = NativeTypedArrayConstructor;\n    var TypedArrayConstructorPrototype = TypedArrayConstructor && TypedArrayConstructor.prototype;\n    var exported = {};\n\n    var getter = function (that, index) {\n      var data = getInternalState(that);\n      return data.view[GETTER](index * BYTES + data.byteOffset, true);\n    };\n\n    var setter = function (that, index, value) {\n      var data = getInternalState(that);\n      if (CLAMPED) value = (value = round(value)) < 0 ? 0 : value > 0xFF ? 0xFF : value & 0xFF;\n      data.view[SETTER](index * BYTES + data.byteOffset, value, true);\n    };\n\n    var addElement = function (that, index) {\n      nativeDefineProperty(that, index, {\n        get: function () {\n          return getter(this, index);\n        },\n        set: function (value) {\n          return setter(this, index, value);\n        },\n        enumerable: true\n      });\n    };\n\n    if (!NATIVE_ARRAY_BUFFER_VIEWS) {\n      TypedArrayConstructor = wrapper(function (that, data, offset, $length) {\n        anInstance(that, TypedArrayConstructorPrototype);\n        var index = 0;\n        var byteOffset = 0;\n        var buffer, byteLength, length;\n        if (!isObject(data)) {\n          length = toIndex(data);\n          byteLength = length * BYTES;\n          buffer = new ArrayBuffer(byteLength);\n        } else if (isArrayBuffer(data)) {\n          buffer = data;\n          byteOffset = toOffset(offset, BYTES);\n          var $len = data.byteLength;\n          if ($length === undefined) {\n            if ($len % BYTES) throw RangeError(WRONG_LENGTH);\n            byteLength = $len - byteOffset;\n            if (byteLength < 0) throw RangeError(WRONG_LENGTH);\n          } else {\n            byteLength = toLength($length) * BYTES;\n            if (byteLength + byteOffset > $len) throw RangeError(WRONG_LENGTH);\n          }\n          length = byteLength / BYTES;\n        } else if (isTypedArray(data)) {\n          return fromList(TypedArrayConstructor, data);\n        } else {\n          return call(typedArrayFrom, TypedArrayConstructor, data);\n        }\n        setInternalState(that, {\n          buffer: buffer,\n          byteOffset: byteOffset,\n          byteLength: byteLength,\n          length: length,\n          view: new DataView(buffer)\n        });\n        while (index < length) addElement(that, index++);\n      });\n\n      if (setPrototypeOf) setPrototypeOf(TypedArrayConstructor, TypedArray);\n      TypedArrayConstructorPrototype = TypedArrayConstructor.prototype = create(TypedArrayPrototype);\n    } else if (TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS) {\n      TypedArrayConstructor = wrapper(function (dummy, data, typedArrayOffset, $length) {\n        anInstance(dummy, TypedArrayConstructorPrototype);\n        return inheritIfRequired(function () {\n          if (!isObject(data)) return new NativeTypedArrayConstructor(toIndex(data));\n          if (isArrayBuffer(data)) return $length !== undefined\n            ? new NativeTypedArrayConstructor(data, toOffset(typedArrayOffset, BYTES), $length)\n            : typedArrayOffset !== undefined\n              ? new NativeTypedArrayConstructor(data, toOffset(typedArrayOffset, BYTES))\n              : new NativeTypedArrayConstructor(data);\n          if (isTypedArray(data)) return fromList(TypedArrayConstructor, data);\n          return call(typedArrayFrom, TypedArrayConstructor, data);\n        }(), dummy, TypedArrayConstructor);\n      });\n\n      if (setPrototypeOf) setPrototypeOf(TypedArrayConstructor, TypedArray);\n      forEach(getOwnPropertyNames(NativeTypedArrayConstructor), function (key) {\n        if (!(key in TypedArrayConstructor)) {\n          createNonEnumerableProperty(TypedArrayConstructor, key, NativeTypedArrayConstructor[key]);\n        }\n      });\n      TypedArrayConstructor.prototype = TypedArrayConstructorPrototype;\n    }\n\n    if (TypedArrayConstructorPrototype.constructor !== TypedArrayConstructor) {\n      createNonEnumerableProperty(TypedArrayConstructorPrototype, 'constructor', TypedArrayConstructor);\n    }\n\n    createNonEnumerableProperty(TypedArrayConstructorPrototype, TYPED_ARRAY_CONSTRUCTOR, TypedArrayConstructor);\n\n    if (TYPED_ARRAY_TAG) {\n      createNonEnumerableProperty(TypedArrayConstructorPrototype, TYPED_ARRAY_TAG, CONSTRUCTOR_NAME);\n    }\n\n    exported[CONSTRUCTOR_NAME] = TypedArrayConstructor;\n\n    $({\n      global: true, forced: TypedArrayConstructor != NativeTypedArrayConstructor, sham: !NATIVE_ARRAY_BUFFER_VIEWS\n    }, exported);\n\n    if (!(BYTES_PER_ELEMENT in TypedArrayConstructor)) {\n      createNonEnumerableProperty(TypedArrayConstructor, BYTES_PER_ELEMENT, BYTES);\n    }\n\n    if (!(BYTES_PER_ELEMENT in TypedArrayConstructorPrototype)) {\n      createNonEnumerableProperty(TypedArrayConstructorPrototype, BYTES_PER_ELEMENT, BYTES);\n    }\n\n    setSpecies(CONSTRUCTOR_NAME);\n  };\n} else module.exports = function () { /* empty */ };\n","/* eslint-disable no-new -- required for testing */\nvar global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar NATIVE_ARRAY_BUFFER_VIEWS = require('../internals/array-buffer-view-core').NATIVE_ARRAY_BUFFER_VIEWS;\n\nvar ArrayBuffer = global.ArrayBuffer;\nvar Int8Array = global.Int8Array;\n\nmodule.exports = !NATIVE_ARRAY_BUFFER_VIEWS || !fails(function () {\n  Int8Array(1);\n}) || !fails(function () {\n  new Int8Array(-1);\n}) || !checkCorrectnessOfIteration(function (iterable) {\n  new Int8Array();\n  new Int8Array(null);\n  new Int8Array(1.5);\n  new Int8Array(iterable);\n}, true) || fails(function () {\n  // Safari (11+) bug - a reason why even Safari 13 should load a typed array polyfill\n  return new Int8Array(new ArrayBuffer(2), 1, undefined).length !== 1;\n});\n","'use strict';\nvar NATIVE_ARRAY_BUFFER = require('../internals/array-buffer-native');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar hasOwn = require('../internals/has-own-property');\nvar classof = require('../internals/classof');\nvar tryToString = require('../internals/try-to-string');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar defineProperty = require('../internals/object-define-property').f;\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar uid = require('../internals/uid');\n\nvar Int8Array = global.Int8Array;\nvar Int8ArrayPrototype = Int8Array && Int8Array.prototype;\nvar Uint8ClampedArray = global.Uint8ClampedArray;\nvar Uint8ClampedArrayPrototype = Uint8ClampedArray && Uint8ClampedArray.prototype;\nvar TypedArray = Int8Array && getPrototypeOf(Int8Array);\nvar TypedArrayPrototype = Int8ArrayPrototype && getPrototypeOf(Int8ArrayPrototype);\nvar ObjectPrototype = Object.prototype;\nvar TypeError = global.TypeError;\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar TYPED_ARRAY_TAG = uid('TYPED_ARRAY_TAG');\nvar TYPED_ARRAY_CONSTRUCTOR = uid('TYPED_ARRAY_CONSTRUCTOR');\n// Fixing native typed arrays in Opera Presto crashes the browser, see #595\nvar NATIVE_ARRAY_BUFFER_VIEWS = NATIVE_ARRAY_BUFFER && !!setPrototypeOf && classof(global.opera) !== 'Opera';\nvar TYPED_ARRAY_TAG_REQUIRED = false;\nvar NAME, Constructor, Prototype;\n\nvar TypedArrayConstructorsList = {\n  Int8Array: 1,\n  Uint8Array: 1,\n  Uint8ClampedArray: 1,\n  Int16Array: 2,\n  Uint16Array: 2,\n  Int32Array: 4,\n  Uint32Array: 4,\n  Float32Array: 4,\n  Float64Array: 8\n};\n\nvar BigIntArrayConstructorsList = {\n  BigInt64Array: 8,\n  BigUint64Array: 8\n};\n\nvar isView = function isView(it) {\n  if (!isObject(it)) return false;\n  var klass = classof(it);\n  return klass === 'DataView'\n    || hasOwn(TypedArrayConstructorsList, klass)\n    || hasOwn(BigIntArrayConstructorsList, klass);\n};\n\nvar isTypedArray = function (it) {\n  if (!isObject(it)) return false;\n  var klass = classof(it);\n  return hasOwn(TypedArrayConstructorsList, klass)\n    || hasOwn(BigIntArrayConstructorsList, klass);\n};\n\nvar aTypedArray = function (it) {\n  if (isTypedArray(it)) return it;\n  throw TypeError('Target is not a typed array');\n};\n\nvar aTypedArrayConstructor = function (C) {\n  if (isCallable(C) && (!setPrototypeOf || isPrototypeOf(TypedArray, C))) return C;\n  throw TypeError(tryToString(C) + ' is not a typed array constructor');\n};\n\nvar exportTypedArrayMethod = function (KEY, property, forced, options) {\n  if (!DESCRIPTORS) return;\n  if (forced) for (var ARRAY in TypedArrayConstructorsList) {\n    var TypedArrayConstructor = global[ARRAY];\n    if (TypedArrayConstructor && hasOwn(TypedArrayConstructor.prototype, KEY)) try {\n      delete TypedArrayConstructor.prototype[KEY];\n    } catch (error) {\n      // old WebKit bug - some methods are non-configurable\n      try {\n        TypedArrayConstructor.prototype[KEY] = property;\n      } catch (error2) { /* empty */ }\n    }\n  }\n  if (!TypedArrayPrototype[KEY] || forced) {\n    redefine(TypedArrayPrototype, KEY, forced ? property\n      : NATIVE_ARRAY_BUFFER_VIEWS && Int8ArrayPrototype[KEY] || property, options);\n  }\n};\n\nvar exportTypedArrayStaticMethod = function (KEY, property, forced) {\n  var ARRAY, TypedArrayConstructor;\n  if (!DESCRIPTORS) return;\n  if (setPrototypeOf) {\n    if (forced) for (ARRAY in TypedArrayConstructorsList) {\n      TypedArrayConstructor = global[ARRAY];\n      if (TypedArrayConstructor && hasOwn(TypedArrayConstructor, KEY)) try {\n        delete TypedArrayConstructor[KEY];\n      } catch (error) { /* empty */ }\n    }\n    if (!TypedArray[KEY] || forced) {\n      // V8 ~ Chrome 49-50 `%TypedArray%` methods are non-writable non-configurable\n      try {\n        return redefine(TypedArray, KEY, forced ? property : NATIVE_ARRAY_BUFFER_VIEWS && TypedArray[KEY] || property);\n      } catch (error) { /* empty */ }\n    } else return;\n  }\n  for (ARRAY in TypedArrayConstructorsList) {\n    TypedArrayConstructor = global[ARRAY];\n    if (TypedArrayConstructor && (!TypedArrayConstructor[KEY] || forced)) {\n      redefine(TypedArrayConstructor, KEY, property);\n    }\n  }\n};\n\nfor (NAME in TypedArrayConstructorsList) {\n  Constructor = global[NAME];\n  Prototype = Constructor && Constructor.prototype;\n  if (Prototype) createNonEnumerableProperty(Prototype, TYPED_ARRAY_CONSTRUCTOR, Constructor);\n  else NATIVE_ARRAY_BUFFER_VIEWS = false;\n}\n\nfor (NAME in BigIntArrayConstructorsList) {\n  Constructor = global[NAME];\n  Prototype = Constructor && Constructor.prototype;\n  if (Prototype) createNonEnumerableProperty(Prototype, TYPED_ARRAY_CONSTRUCTOR, Constructor);\n}\n\n// WebKit bug - typed arrays constructors prototype is Object.prototype\nif (!NATIVE_ARRAY_BUFFER_VIEWS || !isCallable(TypedArray) || TypedArray === Function.prototype) {\n  // eslint-disable-next-line no-shadow -- safe\n  TypedArray = function TypedArray() {\n    throw TypeError('Incorrect invocation');\n  };\n  if (NATIVE_ARRAY_BUFFER_VIEWS) for (NAME in TypedArrayConstructorsList) {\n    if (global[NAME]) setPrototypeOf(global[NAME], TypedArray);\n  }\n}\n\nif (!NATIVE_ARRAY_BUFFER_VIEWS || !TypedArrayPrototype || TypedArrayPrototype === ObjectPrototype) {\n  TypedArrayPrototype = TypedArray.prototype;\n  if (NATIVE_ARRAY_BUFFER_VIEWS) for (NAME in TypedArrayConstructorsList) {\n    if (global[NAME]) setPrototypeOf(global[NAME].prototype, TypedArrayPrototype);\n  }\n}\n\n// WebKit bug - one more object in Uint8ClampedArray prototype chain\nif (NATIVE_ARRAY_BUFFER_VIEWS && getPrototypeOf(Uint8ClampedArrayPrototype) !== TypedArrayPrototype) {\n  setPrototypeOf(Uint8ClampedArrayPrototype, TypedArrayPrototype);\n}\n\nif (DESCRIPTORS && !hasOwn(TypedArrayPrototype, TO_STRING_TAG)) {\n  TYPED_ARRAY_TAG_REQUIRED = true;\n  defineProperty(TypedArrayPrototype, TO_STRING_TAG, { get: function () {\n    return isObject(this) ? this[TYPED_ARRAY_TAG] : undefined;\n  } });\n  for (NAME in TypedArrayConstructorsList) if (global[NAME]) {\n    createNonEnumerableProperty(global[NAME], TYPED_ARRAY_TAG, NAME);\n  }\n}\n\nmodule.exports = {\n  NATIVE_ARRAY_BUFFER_VIEWS: NATIVE_ARRAY_BUFFER_VIEWS,\n  TYPED_ARRAY_CONSTRUCTOR: TYPED_ARRAY_CONSTRUCTOR,\n  TYPED_ARRAY_TAG: TYPED_ARRAY_TAG_REQUIRED && TYPED_ARRAY_TAG,\n  aTypedArray: aTypedArray,\n  aTypedArrayConstructor: aTypedArrayConstructor,\n  exportTypedArrayMethod: exportTypedArrayMethod,\n  exportTypedArrayStaticMethod: exportTypedArrayStaticMethod,\n  isView: isView,\n  isTypedArray: isTypedArray,\n  TypedArray: TypedArray,\n  TypedArrayPrototype: TypedArrayPrototype\n};\n","var global = require('../internals/global');\nvar toPositiveInteger = require('../internals/to-positive-integer');\n\nvar RangeError = global.RangeError;\n\nmodule.exports = function (it, BYTES) {\n  var offset = toPositiveInteger(it);\n  if (offset % BYTES) throw RangeError('Wrong offset');\n  return offset;\n};\n","var global = require('../internals/global');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\n\nvar RangeError = global.RangeError;\n\nmodule.exports = function (it) {\n  var result = toIntegerOrInfinity(it);\n  if (result < 0) throw RangeError(\"The argument can't be less than 0\");\n  return result;\n};\n","var bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aConstructor = require('../internals/a-constructor');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar aTypedArrayConstructor = require('../internals/array-buffer-view-core').aTypedArrayConstructor;\n\nmodule.exports = function from(source /* , mapfn, thisArg */) {\n  var C = aConstructor(this);\n  var O = toObject(source);\n  var argumentsLength = arguments.length;\n  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;\n  var mapping = mapfn !== undefined;\n  var iteratorMethod = getIteratorMethod(O);\n  var i, length, result, step, iterator, next;\n  if (iteratorMethod && !isArrayIteratorMethod(iteratorMethod)) {\n    iterator = getIterator(O, iteratorMethod);\n    next = iterator.next;\n    O = [];\n    while (!(step = call(next, iterator)).done) {\n      O.push(step.value);\n    }\n  }\n  if (mapping && argumentsLength > 2) {\n    mapfn = bind(mapfn, arguments[2]);\n  }\n  length = lengthOfArrayLike(O);\n  result = new (aTypedArrayConstructor(C))(length);\n  for (i = 0; length > i; i++) {\n    result[i] = mapping ? mapfn(O[i], i) : O[i];\n  }\n  return result;\n};\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Float64Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Float64', function (init) {\n  return function Float64Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Int8Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Int8', function (init) {\n  return function Int8Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Int16Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Int16', function (init) {\n  return function Int16Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Int32Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Int32', function (init) {\n  return function Int32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Uint8Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Uint8', function (init) {\n  return function Uint8Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Uint8ClampedArray` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Uint8', function (init) {\n  return function Uint8ClampedArray(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n}, true);\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Uint16Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Uint16', function (init) {\n  return function Uint16Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Uint32Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Uint32', function (init) {\n  return function Uint32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $ArrayCopyWithin = require('../internals/array-copy-within');\n\nvar u$ArrayCopyWithin = uncurryThis($ArrayCopyWithin);\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.copyWithin` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.copywithin\nexportTypedArrayMethod('copyWithin', function copyWithin(target, start /* , end */) {\n  return u$ArrayCopyWithin(aTypedArray(this), target, start, arguments.length > 2 ? arguments[2] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $every = require('../internals/array-iteration').every;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.every` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.every\nexportTypedArrayMethod('every', function every(callbackfn /* , thisArg */) {\n  return $every(aTypedArray(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar call = require('../internals/function-call');\nvar $fill = require('../internals/array-fill');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.fill` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.fill\nexportTypedArrayMethod('fill', function fill(value /* , start, end */) {\n  var length = arguments.length;\n  return call(\n    $fill,\n    aTypedArray(this),\n    value,\n    length > 1 ? arguments[1] : undefined,\n    length > 2 ? arguments[2] : undefined\n  );\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $filter = require('../internals/array-iteration').filter;\nvar fromSpeciesAndList = require('../internals/typed-array-from-species-and-list');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.filter` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.filter\nexportTypedArrayMethod('filter', function filter(callbackfn /* , thisArg */) {\n  var list = $filter(aTypedArray(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  return fromSpeciesAndList(this, list);\n});\n","var arrayFromConstructorAndList = require('../internals/array-from-constructor-and-list');\nvar typedArraySpeciesConstructor = require('../internals/typed-array-species-constructor');\n\nmodule.exports = function (instance, list) {\n  return arrayFromConstructorAndList(typedArraySpeciesConstructor(instance), list);\n};\n","var lengthOfArrayLike = require('../internals/length-of-array-like');\n\nmodule.exports = function (Constructor, list) {\n  var index = 0;\n  var length = lengthOfArrayLike(list);\n  var result = new Constructor(length);\n  while (length > index) result[index] = list[index++];\n  return result;\n};\n","var ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar speciesConstructor = require('../internals/species-constructor');\n\nvar TYPED_ARRAY_CONSTRUCTOR = ArrayBufferViewCore.TYPED_ARRAY_CONSTRUCTOR;\nvar aTypedArrayConstructor = ArrayBufferViewCore.aTypedArrayConstructor;\n\n// a part of `TypedArraySpeciesCreate` abstract operation\n// https://tc39.es/ecma262/#typedarray-species-create\nmodule.exports = function (originalArray) {\n  return aTypedArrayConstructor(speciesConstructor(originalArray, originalArray[TYPED_ARRAY_CONSTRUCTOR]));\n};\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $find = require('../internals/array-iteration').find;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.find` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.find\nexportTypedArrayMethod('find', function find(predicate /* , thisArg */) {\n  return $find(aTypedArray(this), predicate, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $findIndex = require('../internals/array-iteration').findIndex;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.findIndex` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.findindex\nexportTypedArrayMethod('findIndex', function findIndex(predicate /* , thisArg */) {\n  return $findIndex(aTypedArray(this), predicate, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $forEach = require('../internals/array-iteration').forEach;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.forEach` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.foreach\nexportTypedArrayMethod('forEach', function forEach(callbackfn /* , thisArg */) {\n  $forEach(aTypedArray(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS = require('../internals/typed-array-constructors-require-wrappers');\nvar exportTypedArrayStaticMethod = require('../internals/array-buffer-view-core').exportTypedArrayStaticMethod;\nvar typedArrayFrom = require('../internals/typed-array-from');\n\n// `%TypedArray%.from` method\n// https://tc39.es/ecma262/#sec-%typedarray%.from\nexportTypedArrayStaticMethod('from', typedArrayFrom, TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS);\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $includes = require('../internals/array-includes').includes;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.includes` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.includes\nexportTypedArrayMethod('includes', function includes(searchElement /* , fromIndex */) {\n  return $includes(aTypedArray(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $indexOf = require('../internals/array-includes').indexOf;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.indexOf` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.indexof\nexportTypedArrayMethod('indexOf', function indexOf(searchElement /* , fromIndex */) {\n  return $indexOf(aTypedArray(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar ArrayIterators = require('../modules/es.array.iterator');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar Uint8Array = global.Uint8Array;\nvar arrayValues = uncurryThis(ArrayIterators.values);\nvar arrayKeys = uncurryThis(ArrayIterators.keys);\nvar arrayEntries = uncurryThis(ArrayIterators.entries);\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\nvar TypedArrayPrototype = Uint8Array && Uint8Array.prototype;\n\nvar GENERIC = !fails(function () {\n  TypedArrayPrototype[ITERATOR].call([1]);\n});\n\nvar ITERATOR_IS_VALUES = !!TypedArrayPrototype\n  && TypedArrayPrototype.values\n  && TypedArrayPrototype[ITERATOR] === TypedArrayPrototype.values\n  && TypedArrayPrototype.values.name === 'values';\n\nvar typedArrayValues = function values() {\n  return arrayValues(aTypedArray(this));\n};\n\n// `%TypedArray%.prototype.entries` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.entries\nexportTypedArrayMethod('entries', function entries() {\n  return arrayEntries(aTypedArray(this));\n}, GENERIC);\n// `%TypedArray%.prototype.keys` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.keys\nexportTypedArrayMethod('keys', function keys() {\n  return arrayKeys(aTypedArray(this));\n}, GENERIC);\n// `%TypedArray%.prototype.values` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.values\nexportTypedArrayMethod('values', typedArrayValues, GENERIC || !ITERATOR_IS_VALUES, { name: 'values' });\n// `%TypedArray%.prototype[@@iterator]` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype-@@iterator\nexportTypedArrayMethod(ITERATOR, typedArrayValues, GENERIC || !ITERATOR_IS_VALUES, { name: 'values' });\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\nvar $join = uncurryThis([].join);\n\n// `%TypedArray%.prototype.join` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.join\nexportTypedArrayMethod('join', function join(separator) {\n  return $join(aTypedArray(this), separator);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar apply = require('../internals/function-apply');\nvar $lastIndexOf = require('../internals/array-last-index-of');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.lastIndexOf` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.lastindexof\nexportTypedArrayMethod('lastIndexOf', function lastIndexOf(searchElement /* , fromIndex */) {\n  var length = arguments.length;\n  return apply($lastIndexOf, aTypedArray(this), length > 1 ? [searchElement, arguments[1]] : [searchElement]);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $map = require('../internals/array-iteration').map;\nvar typedArraySpeciesConstructor = require('../internals/typed-array-species-constructor');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.map` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.map\nexportTypedArrayMethod('map', function map(mapfn /* , thisArg */) {\n  return $map(aTypedArray(this), mapfn, arguments.length > 1 ? arguments[1] : undefined, function (O, length) {\n    return new (typedArraySpeciesConstructor(O))(length);\n  });\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS = require('../internals/typed-array-constructors-require-wrappers');\n\nvar aTypedArrayConstructor = ArrayBufferViewCore.aTypedArrayConstructor;\nvar exportTypedArrayStaticMethod = ArrayBufferViewCore.exportTypedArrayStaticMethod;\n\n// `%TypedArray%.of` method\n// https://tc39.es/ecma262/#sec-%typedarray%.of\nexportTypedArrayStaticMethod('of', function of(/* ...items */) {\n  var index = 0;\n  var length = arguments.length;\n  var result = new (aTypedArrayConstructor(this))(length);\n  while (length > index) result[index] = arguments[index++];\n  return result;\n}, TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS);\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $reduce = require('../internals/array-reduce').left;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.reduce` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.reduce\nexportTypedArrayMethod('reduce', function reduce(callbackfn /* , initialValue */) {\n  var length = arguments.length;\n  return $reduce(aTypedArray(this), callbackfn, length, length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $reduceRight = require('../internals/array-reduce').right;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.reduceRicht` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.reduceright\nexportTypedArrayMethod('reduceRight', function reduceRight(callbackfn /* , initialValue */) {\n  var length = arguments.length;\n  return $reduceRight(aTypedArray(this), callbackfn, length, length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\nvar floor = Math.floor;\n\n// `%TypedArray%.prototype.reverse` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.reverse\nexportTypedArrayMethod('reverse', function reverse() {\n  var that = this;\n  var length = aTypedArray(that).length;\n  var middle = floor(length / 2);\n  var index = 0;\n  var value;\n  while (index < middle) {\n    value = that[index];\n    that[index++] = that[--length];\n    that[length] = value;\n  } return that;\n});\n","'use strict';\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toOffset = require('../internals/to-offset');\nvar toIndexedObject = require('../internals/to-object');\nvar fails = require('../internals/fails');\n\nvar RangeError = global.RangeError;\nvar Int8Array = global.Int8Array;\nvar Int8ArrayPrototype = Int8Array && Int8Array.prototype;\nvar $set = Int8ArrayPrototype && Int8ArrayPrototype.set;\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\nvar WORKS_WITH_OBJECTS_AND_GEERIC_ON_TYPED_ARRAYS = !fails(function () {\n  // eslint-disable-next-line es/no-typed-arrays -- required for testing\n  var array = new Uint8ClampedArray(2);\n  call($set, array, { length: 1, 0: 3 }, 1);\n  return array[1] !== 3;\n});\n\n// https://bugs.chromium.org/p/v8/issues/detail?id=11294 and other\nvar TO_OBJECT_BUG = WORKS_WITH_OBJECTS_AND_GEERIC_ON_TYPED_ARRAYS && ArrayBufferViewCore.NATIVE_ARRAY_BUFFER_VIEWS && fails(function () {\n  var array = new Int8Array(2);\n  array.set(1);\n  array.set('2', 1);\n  return array[0] !== 0 || array[1] !== 2;\n});\n\n// `%TypedArray%.prototype.set` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.set\nexportTypedArrayMethod('set', function set(arrayLike /* , offset */) {\n  aTypedArray(this);\n  var offset = toOffset(arguments.length > 1 ? arguments[1] : undefined, 1);\n  var src = toIndexedObject(arrayLike);\n  if (WORKS_WITH_OBJECTS_AND_GEERIC_ON_TYPED_ARRAYS) return call($set, this, src, offset);\n  var length = this.length;\n  var len = lengthOfArrayLike(src);\n  var index = 0;\n  if (len + offset > length) throw RangeError('Wrong length');\n  while (index < len) this[offset + index] = src[index++];\n}, !WORKS_WITH_OBJECTS_AND_GEERIC_ON_TYPED_ARRAYS || TO_OBJECT_BUG);\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar typedArraySpeciesConstructor = require('../internals/typed-array-species-constructor');\nvar fails = require('../internals/fails');\nvar arraySlice = require('../internals/array-slice');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\nvar FORCED = fails(function () {\n  // eslint-disable-next-line es/no-typed-arrays -- required for testing\n  new Int8Array(1).slice();\n});\n\n// `%TypedArray%.prototype.slice` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.slice\nexportTypedArrayMethod('slice', function slice(start, end) {\n  var list = arraySlice(aTypedArray(this), start, end);\n  var C = typedArraySpeciesConstructor(this);\n  var index = 0;\n  var length = list.length;\n  var result = new C(length);\n  while (length > index) result[index] = list[index++];\n  return result;\n}, FORCED);\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $some = require('../internals/array-iteration').some;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.some` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.some\nexportTypedArrayMethod('some', function some(callbackfn /* , thisArg */) {\n  return $some(aTypedArray(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar aCallable = require('../internals/a-callable');\nvar internalSort = require('../internals/array-sort');\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar FF = require('../internals/engine-ff-version');\nvar IE_OR_EDGE = require('../internals/engine-is-ie-or-edge');\nvar V8 = require('../internals/engine-v8-version');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\nvar Array = global.Array;\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\nvar Uint16Array = global.Uint16Array;\nvar un$Sort = Uint16Array && uncurryThis(Uint16Array.prototype.sort);\n\n// WebKit\nvar ACCEPT_INCORRECT_ARGUMENTS = !!un$Sort && !(fails(function () {\n  un$Sort(new Uint16Array(2), null);\n}) && fails(function () {\n  un$Sort(new Uint16Array(2), {});\n}));\n\nvar STABLE_SORT = !!un$Sort && !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 74;\n  if (FF) return FF < 67;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 602;\n\n  var array = new Uint16Array(516);\n  var expected = Array(516);\n  var index, mod;\n\n  for (index = 0; index < 516; index++) {\n    mod = index % 4;\n    array[index] = 515 - index;\n    expected[index] = index - 2 * mod + 3;\n  }\n\n  un$Sort(array, function (a, b) {\n    return (a / 4 | 0) - (b / 4 | 0);\n  });\n\n  for (index = 0; index < 516; index++) {\n    if (array[index] !== expected[index]) return true;\n  }\n});\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (y !== y) return -1;\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (x !== x) return 1;\n    if (x === 0 && y === 0) return 1 / x > 0 && 1 / y < 0 ? 1 : -1;\n    return x > y;\n  };\n};\n\n// `%TypedArray%.prototype.sort` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.sort\nexportTypedArrayMethod('sort', function sort(comparefn) {\n  if (comparefn !== undefined) aCallable(comparefn);\n  if (STABLE_SORT) return un$Sort(this, comparefn);\n\n  return internalSort(aTypedArray(this), getSortCompare(comparefn));\n}, !STABLE_SORT || ACCEPT_INCORRECT_ARGUMENTS);\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar toLength = require('../internals/to-length');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar typedArraySpeciesConstructor = require('../internals/typed-array-species-constructor');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.subarray` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.subarray\nexportTypedArrayMethod('subarray', function subarray(begin, end) {\n  var O = aTypedArray(this);\n  var length = O.length;\n  var beginIndex = toAbsoluteIndex(begin, length);\n  var C = typedArraySpeciesConstructor(O);\n  return new C(\n    O.buffer,\n    O.byteOffset + beginIndex * O.BYTES_PER_ELEMENT,\n    toLength((end === undefined ? length : toAbsoluteIndex(end, length)) - beginIndex)\n  );\n});\n","'use strict';\nvar global = require('../internals/global');\nvar apply = require('../internals/function-apply');\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar fails = require('../internals/fails');\nvar arraySlice = require('../internals/array-slice');\n\nvar Int8Array = global.Int8Array;\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\nvar $toLocaleString = [].toLocaleString;\n\n// iOS Safari 6.x fails here\nvar TO_LOCALE_STRING_BUG = !!Int8Array && fails(function () {\n  $toLocaleString.call(new Int8Array(1));\n});\n\nvar FORCED = fails(function () {\n  return [1, 2].toLocaleString() != new Int8Array([1, 2]).toLocaleString();\n}) || !fails(function () {\n  Int8Array.prototype.toLocaleString.call([1, 2]);\n});\n\n// `%TypedArray%.prototype.toLocaleString` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.tolocalestring\nexportTypedArrayMethod('toLocaleString', function toLocaleString() {\n  return apply(\n    $toLocaleString,\n    TO_LOCALE_STRING_BUG ? arraySlice(aTypedArray(this)) : aTypedArray(this),\n    arraySlice(arguments)\n  );\n}, FORCED);\n","'use strict';\nvar exportTypedArrayMethod = require('../internals/array-buffer-view-core').exportTypedArrayMethod;\nvar fails = require('../internals/fails');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nvar Uint8Array = global.Uint8Array;\nvar Uint8ArrayPrototype = Uint8Array && Uint8Array.prototype || {};\nvar arrayToString = [].toString;\nvar join = uncurryThis([].join);\n\nif (fails(function () { arrayToString.call({}); })) {\n  arrayToString = function toString() {\n    return join(this);\n  };\n}\n\nvar IS_NOT_ARRAY_METHOD = Uint8ArrayPrototype.toString != arrayToString;\n\n// `%TypedArray%.prototype.toString` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.tostring\nexportTypedArrayMethod('toString', arrayToString, IS_NOT_ARRAY_METHOD);\n","'use strict';\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar redefineAll = require('../internals/redefine-all');\nvar InternalMetadataModule = require('../internals/internal-metadata');\nvar collection = require('../internals/collection');\nvar collectionWeak = require('../internals/collection-weak');\nvar isObject = require('../internals/is-object');\nvar isExtensible = require('../internals/object-is-extensible');\nvar enforceInternalState = require('../internals/internal-state').enforce;\nvar NATIVE_WEAK_MAP = require('../internals/native-weak-map');\n\nvar IS_IE11 = !global.ActiveXObject && 'ActiveXObject' in global;\nvar InternalWeakMap;\n\nvar wrapper = function (init) {\n  return function WeakMap() {\n    return init(this, arguments.length ? arguments[0] : undefined);\n  };\n};\n\n// `WeakMap` constructor\n// https://tc39.es/ecma262/#sec-weakmap-constructor\nvar $WeakMap = collection('WeakMap', wrapper, collectionWeak);\n\n// IE11 WeakMap frozen keys fix\n// We can't use feature detection because it crash some old IE builds\n// https://github.com/zloirock/core-js/issues/485\nif (NATIVE_WEAK_MAP && IS_IE11) {\n  InternalWeakMap = collectionWeak.getConstructor(wrapper, 'WeakMap', true);\n  InternalMetadataModule.enable();\n  var WeakMapPrototype = $WeakMap.prototype;\n  var nativeDelete = uncurryThis(WeakMapPrototype['delete']);\n  var nativeHas = uncurryThis(WeakMapPrototype.has);\n  var nativeGet = uncurryThis(WeakMapPrototype.get);\n  var nativeSet = uncurryThis(WeakMapPrototype.set);\n  redefineAll(WeakMapPrototype, {\n    'delete': function (key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeDelete(this, key) || state.frozen['delete'](key);\n      } return nativeDelete(this, key);\n    },\n    has: function has(key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeHas(this, key) || state.frozen.has(key);\n      } return nativeHas(this, key);\n    },\n    get: function get(key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeHas(this, key) ? nativeGet(this, key) : state.frozen.get(key);\n      } return nativeGet(this, key);\n    },\n    set: function set(key, value) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        nativeHas(this, key) ? nativeSet(this, key, value) : state.frozen.set(key, value);\n      } else nativeSet(this, key, value);\n      return this;\n    }\n  });\n}\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar redefineAll = require('../internals/redefine-all');\nvar getWeakData = require('../internals/internal-metadata').getWeakData;\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar anInstance = require('../internals/an-instance');\nvar iterate = require('../internals/iterate');\nvar ArrayIterationModule = require('../internals/array-iteration');\nvar hasOwn = require('../internals/has-own-property');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar setInternalState = InternalStateModule.set;\nvar internalStateGetterFor = InternalStateModule.getterFor;\nvar find = ArrayIterationModule.find;\nvar findIndex = ArrayIterationModule.findIndex;\nvar splice = uncurryThis([].splice);\nvar id = 0;\n\n// fallback for uncaught frozen keys\nvar uncaughtFrozenStore = function (store) {\n  return store.frozen || (store.frozen = new UncaughtFrozenStore());\n};\n\nvar UncaughtFrozenStore = function () {\n  this.entries = [];\n};\n\nvar findUncaughtFrozen = function (store, key) {\n  return find(store.entries, function (it) {\n    return it[0] === key;\n  });\n};\n\nUncaughtFrozenStore.prototype = {\n  get: function (key) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) return entry[1];\n  },\n  has: function (key) {\n    return !!findUncaughtFrozen(this, key);\n  },\n  set: function (key, value) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) entry[1] = value;\n    else this.entries.push([key, value]);\n  },\n  'delete': function (key) {\n    var index = findIndex(this.entries, function (it) {\n      return it[0] === key;\n    });\n    if (~index) splice(this.entries, index, 1);\n    return !!~index;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function (wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER) {\n    var Constructor = wrapper(function (that, iterable) {\n      anInstance(that, Prototype);\n      setInternalState(that, {\n        type: CONSTRUCTOR_NAME,\n        id: id++,\n        frozen: undefined\n      });\n      if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n    });\n\n    var Prototype = Constructor.prototype;\n\n    var getInternalState = internalStateGetterFor(CONSTRUCTOR_NAME);\n\n    var define = function (that, key, value) {\n      var state = getInternalState(that);\n      var data = getWeakData(anObject(key), true);\n      if (data === true) uncaughtFrozenStore(state).set(key, value);\n      else data[state.id] = value;\n      return that;\n    };\n\n    redefineAll(Prototype, {\n      // `{ WeakMap, WeakSet }.prototype.delete(key)` methods\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.delete\n      // https://tc39.es/ecma262/#sec-weakset.prototype.delete\n      'delete': function (key) {\n        var state = getInternalState(this);\n        if (!isObject(key)) return false;\n        var data = getWeakData(key);\n        if (data === true) return uncaughtFrozenStore(state)['delete'](key);\n        return data && hasOwn(data, state.id) && delete data[state.id];\n      },\n      // `{ WeakMap, WeakSet }.prototype.has(key)` methods\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.has\n      // https://tc39.es/ecma262/#sec-weakset.prototype.has\n      has: function has(key) {\n        var state = getInternalState(this);\n        if (!isObject(key)) return false;\n        var data = getWeakData(key);\n        if (data === true) return uncaughtFrozenStore(state).has(key);\n        return data && hasOwn(data, state.id);\n      }\n    });\n\n    redefineAll(Prototype, IS_MAP ? {\n      // `WeakMap.prototype.get(key)` method\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.get\n      get: function get(key) {\n        var state = getInternalState(this);\n        if (isObject(key)) {\n          var data = getWeakData(key);\n          if (data === true) return uncaughtFrozenStore(state).get(key);\n          return data ? data[state.id] : undefined;\n        }\n      },\n      // `WeakMap.prototype.set(key, value)` method\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.set\n      set: function set(key, value) {\n        return define(this, key, value);\n      }\n    } : {\n      // `WeakSet.prototype.add(value)` method\n      // https://tc39.es/ecma262/#sec-weakset.prototype.add\n      add: function add(value) {\n        return define(this, value, true);\n      }\n    });\n\n    return Constructor;\n  }\n};\n","'use strict';\nvar collection = require('../internals/collection');\nvar collectionWeak = require('../internals/collection-weak');\n\n// `WeakSet` constructor\n// https://tc39.es/ecma262/#sec-weakset-constructor\ncollection('WeakSet', function (init) {\n  return function WeakSet() { return init(this, arguments.length ? arguments[0] : undefined); };\n}, collectionWeak);\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar create = require('../internals/object-create');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar clearErrorStack = require('../internals/clear-error-stack');\nvar installErrorCause = require('../internals/install-error-cause');\nvar iterate = require('../internals/iterate');\nvar normalizeStringArgument = require('../internals/normalize-string-argument');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar ERROR_STACK_INSTALLABLE = require('../internals/error-stack-installable');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar Error = global.Error;\nvar push = [].push;\n\nvar $AggregateError = function AggregateError(errors, message /* , options */) {\n  var options = arguments.length > 2 ? arguments[2] : undefined;\n  var isInstance = isPrototypeOf(AggregateErrorPrototype, this);\n  var that;\n  if (setPrototypeOf) {\n    that = setPrototypeOf(new Error(), isInstance ? getPrototypeOf(this) : AggregateErrorPrototype);\n  } else {\n    that = isInstance ? this : create(AggregateErrorPrototype);\n    createNonEnumerableProperty(that, TO_STRING_TAG, 'Error');\n  }\n  if (message !== undefined) createNonEnumerableProperty(that, 'message', normalizeStringArgument(message));\n  if (ERROR_STACK_INSTALLABLE) createNonEnumerableProperty(that, 'stack', clearErrorStack(that.stack, 1));\n  installErrorCause(that, options);\n  var errorsArray = [];\n  iterate(errors, push, { that: errorsArray });\n  createNonEnumerableProperty(that, 'errors', errorsArray);\n  return that;\n};\n\nif (setPrototypeOf) setPrototypeOf($AggregateError, Error);\nelse copyConstructorProperties($AggregateError, Error, { name: true });\n\nvar AggregateErrorPrototype = $AggregateError.prototype = create(Error.prototype, {\n  constructor: createPropertyDescriptor(1, $AggregateError),\n  message: createPropertyDescriptor(1, ''),\n  name: createPropertyDescriptor(1, 'AggregateError')\n});\n\n// `AggregateError` constructor\n// https://tc39.es/ecma262/#sec-aggregate-error-constructor\n$({ global: true }, {\n  AggregateError: $AggregateError\n});\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nvar replace = uncurryThis(''.replace);\n\nvar TEST = (function (arg) { return String(Error(arg).stack); })('zxcasd');\nvar V8_OR_CHAKRA_STACK_ENTRY = /\\n\\s*at [^:]*:[^\\n]*/;\nvar IS_V8_OR_CHAKRA_STACK = V8_OR_CHAKRA_STACK_ENTRY.test(TEST);\n\nmodule.exports = function (stack, dropEntries) {\n  if (IS_V8_OR_CHAKRA_STACK && typeof stack == 'string') {\n    while (dropEntries--) stack = replace(stack, V8_OR_CHAKRA_STACK_ENTRY, '');\n  } return stack;\n};\n","var isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\n// `InstallErrorCause` abstract operation\n// https://tc39.es/proposal-error-cause/#sec-errorobjects-install-error-cause\nmodule.exports = function (O, options) {\n  if (isObject(options) && 'cause' in options) {\n    createNonEnumerableProperty(O, 'cause', options.cause);\n  }\n};\n","var toString = require('../internals/to-string');\n\nmodule.exports = function (argument, $default) {\n  return argument === undefined ? arguments.length < 2 ? '' : $default : toString(argument);\n};\n","var fails = require('../internals/fails');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = !fails(function () {\n  var error = Error('a');\n  if (!('stack' in error)) return true;\n  // eslint-disable-next-line es/no-object-defineproperty -- safe\n  Object.defineProperty(error, 'stack', createPropertyDescriptor(1, 7));\n  return error.stack !== 7;\n});\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar defineProperty = require('../internals/object-define-property').f;\n\n// `Array.prototype.lastIndex` getter\n// https://github.com/keithamus/proposal-array-last\nif (DESCRIPTORS && !('lastIndex' in [])) {\n  defineProperty(Array.prototype, 'lastIndex', {\n    configurable: true,\n    get: function lastIndex() {\n      var O = toObject(this);\n      var len = lengthOfArrayLike(O);\n      return len == 0 ? 0 : len - 1;\n    }\n  });\n\n  addToUnscopables('lastIndex');\n}\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar defineProperty = require('../internals/object-define-property').f;\n\n// `Array.prototype.lastIndex` accessor\n// https://github.com/keithamus/proposal-array-last\nif (DESCRIPTORS && !('lastItem' in [])) {\n  defineProperty(Array.prototype, 'lastItem', {\n    configurable: true,\n    get: function lastItem() {\n      var O = toObject(this);\n      var len = lengthOfArrayLike(O);\n      return len == 0 ? undefined : O[len - 1];\n    },\n    set: function lastItem(value) {\n      var O = toObject(this);\n      var len = lengthOfArrayLike(O);\n      return O[len == 0 ? 0 : len - 1] = value;\n    }\n  });\n\n  addToUnscopables('lastItem');\n}\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar apply = require('../internals/function-apply');\nvar getCompositeKeyNode = require('../internals/composite-key');\nvar getBuiltIn = require('../internals/get-built-in');\nvar create = require('../internals/object-create');\n\nvar Object = global.Object;\n\nvar initializer = function () {\n  var freeze = getBuiltIn('Object', 'freeze');\n  return freeze ? freeze(create(null)) : create(null);\n};\n\n// https://github.com/tc39/proposal-richer-keys/tree/master/compositeKey\n$({ global: true }, {\n  compositeKey: function compositeKey() {\n    return apply(getCompositeKeyNode, Object, arguments).get('object', initializer);\n  }\n});\n","// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.map');\nrequire('../modules/es.weak-map');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar create = require('../internals/object-create');\nvar isObject = require('../internals/is-object');\n\nvar Object = global.Object;\nvar TypeError = global.TypeError;\nvar Map = getBuiltIn('Map');\nvar WeakMap = getBuiltIn('WeakMap');\n\nvar Node = function () {\n  // keys\n  this.object = null;\n  this.symbol = null;\n  // child nodes\n  this.primitives = null;\n  this.objectsByIndex = create(null);\n};\n\nNode.prototype.get = function (key, initializer) {\n  return this[key] || (this[key] = initializer());\n};\n\nNode.prototype.next = function (i, it, IS_OBJECT) {\n  var store = IS_OBJECT\n    ? this.objectsByIndex[i] || (this.objectsByIndex[i] = new WeakMap())\n    : this.primitives || (this.primitives = new Map());\n  var entry = store.get(it);\n  if (!entry) store.set(it, entry = new Node());\n  return entry;\n};\n\nvar root = new Node();\n\nmodule.exports = function () {\n  var active = root;\n  var length = arguments.length;\n  var i, it;\n  // for prevent leaking, start from objects\n  for (i = 0; i < length; i++) {\n    if (isObject(it = arguments[i])) active = active.next(i, it, true);\n  }\n  if (this === Object && active === root) throw TypeError('Composite keys must contain a non-primitive component');\n  for (i = 0; i < length; i++) {\n    if (!isObject(it = arguments[i])) active = active.next(i, it, false);\n  } return active;\n};\n","var $ = require('../internals/export');\nvar getCompositeKeyNode = require('../internals/composite-key');\nvar getBuiltIn = require('../internals/get-built-in');\nvar apply = require('../internals/function-apply');\n\n// https://github.com/tc39/proposal-richer-keys/tree/master/compositeKey\n$({ global: true }, {\n  compositeSymbol: function compositeSymbol() {\n    if (arguments.length == 1 && typeof arguments[0] == 'string') return getBuiltIn('Symbol')['for'](arguments[0]);\n    return apply(getCompositeKeyNode, null, arguments).get('symbol', getBuiltIn('Symbol'));\n  }\n});\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\n\n// `globalThis` object\n// https://tc39.es/ecma262/#sec-globalthis\n$({ global: true }, {\n  globalThis: global\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar deleteAll = require('../internals/collection-delete-all');\n\n// `Map.prototype.deleteAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  deleteAll: deleteAll\n});\n","'use strict';\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\n\n// https://github.com/tc39/collection-methods\nmodule.exports = function deleteAll(/* ...elements */) {\n  var collection = anObject(this);\n  var remover = aCallable(collection['delete']);\n  var allDeleted = true;\n  var wasDeleted;\n  for (var k = 0, len = arguments.length; k < len; k++) {\n    wasDeleted = call(remover, collection, arguments[k]);\n    allDeleted = allDeleted && wasDeleted;\n  }\n  return !!allDeleted;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.every` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  every: function every(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return !iterate(iterator, function (key, value, stop) {\n      if (!boundFunction(value, key, map)) return stop();\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","var call = require('../internals/function-call');\n\nmodule.exports = function (it) {\n  // eslint-disable-next-line es/no-map -- safe\n  return call(Map.prototype.entries, it);\n};\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.filter` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newMap = new (speciesConstructor(map, getBuiltIn('Map')))();\n    var setter = aCallable(newMap.set);\n    iterate(iterator, function (key, value) {\n      if (boundFunction(value, key, map)) call(setter, newMap, key, value);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true });\n    return newMap;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.find` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  find: function find(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (key, value, stop) {\n      if (boundFunction(value, key, map)) return stop(value);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).result;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.findKey` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  findKey: function findKey(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (key, value, stop) {\n      if (boundFunction(value, key, map)) return stop(key);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).result;\n  }\n});\n","var $ = require('../internals/export');\nvar from = require('../internals/collection-from');\n\n// `Map.from` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-map.from\n$({ target: 'Map', stat: true }, {\n  from: from\n});\n","'use strict';\n// https://tc39.github.io/proposal-setmap-offrom/\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar aConstructor = require('../internals/a-constructor');\nvar iterate = require('../internals/iterate');\n\nvar push = [].push;\n\nmodule.exports = function from(source /* , mapFn, thisArg */) {\n  var length = arguments.length;\n  var mapFn = length > 1 ? arguments[1] : undefined;\n  var mapping, array, n, boundFunction;\n  aConstructor(this);\n  mapping = mapFn !== undefined;\n  if (mapping) aCallable(mapFn);\n  if (source == undefined) return new this();\n  array = [];\n  if (mapping) {\n    n = 0;\n    boundFunction = bind(mapFn, length > 2 ? arguments[2] : undefined);\n    iterate(source, function (nextItem) {\n      call(push, array, boundFunction(nextItem, n++));\n    });\n  } else {\n    iterate(source, push, { that: array });\n  }\n  return new this(array);\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar getIterator = require('../internals/get-iterator');\nvar iterate = require('../internals/iterate');\n\nvar push = uncurryThis([].push);\n\n// `Map.groupBy` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', stat: true }, {\n  groupBy: function groupBy(iterable, keyDerivative) {\n    aCallable(keyDerivative);\n    var iterator = getIterator(iterable);\n    var newMap = new this();\n    var has = aCallable(newMap.has);\n    var get = aCallable(newMap.get);\n    var set = aCallable(newMap.set);\n    iterate(iterator, function (element) {\n      var derivedKey = keyDerivative(element);\n      if (!call(has, newMap, derivedKey)) call(set, newMap, derivedKey, [element]);\n      else push(call(get, newMap, derivedKey), element);\n    }, { IS_ITERATOR: true });\n    return newMap;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar anObject = require('../internals/an-object');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar sameValueZero = require('../internals/same-value-zero');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.includes` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  includes: function includes(searchElement) {\n    return iterate(getMapIterator(anObject(this)), function (key, value, stop) {\n      if (sameValueZero(value, searchElement)) return stop();\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","// `SameValueZero` abstract operation\n// https://tc39.es/ecma262/#sec-samevaluezero\nmodule.exports = function (x, y) {\n  // eslint-disable-next-line no-self-compare -- NaN check\n  return x === y || x != x && y != y;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar iterate = require('../internals/iterate');\nvar aCallable = require('../internals/a-callable');\n\n// `Map.keyBy` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', stat: true }, {\n  keyBy: function keyBy(iterable, keyDerivative) {\n    var newMap = new this();\n    aCallable(keyDerivative);\n    var setter = aCallable(newMap.set);\n    iterate(iterable, function (element) {\n      call(setter, newMap, keyDerivative(element), element);\n    });\n    return newMap;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.keyOf` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  keyOf: function keyOf(searchElement) {\n    return iterate(getMapIterator(anObject(this)), function (key, value, stop) {\n      if (value === searchElement) return stop(key);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).result;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.mapKeys` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  mapKeys: function mapKeys(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newMap = new (speciesConstructor(map, getBuiltIn('Map')))();\n    var setter = aCallable(newMap.set);\n    iterate(iterator, function (key, value) {\n      call(setter, newMap, boundFunction(value, key, map), value);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true });\n    return newMap;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.mapValues` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  mapValues: function mapValues(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newMap = new (speciesConstructor(map, getBuiltIn('Map')))();\n    var setter = aCallable(newMap.set);\n    iterate(iterator, function (key, value) {\n      call(setter, newMap, key, boundFunction(value, key, map));\n    }, { AS_ENTRIES: true, IS_ITERATOR: true });\n    return newMap;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.merge` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  merge: function merge(iterable /* ...iterables */) {\n    var map = anObject(this);\n    var setter = aCallable(map.set);\n    var argumentsLength = arguments.length;\n    var i = 0;\n    while (i < argumentsLength) {\n      iterate(arguments[i++], setter, { that: map, AS_ENTRIES: true });\n    }\n    return map;\n  }\n});\n","var $ = require('../internals/export');\nvar of = require('../internals/collection-of');\n\n// `Map.of` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-map.of\n$({ target: 'Map', stat: true }, {\n  of: of\n});\n","'use strict';\nvar arraySlice = require('../internals/array-slice');\n\n// https://tc39.github.io/proposal-setmap-offrom/\nmodule.exports = function of() {\n  return new this(arraySlice(arguments));\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar aCallable = require('../internals/a-callable');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\nvar TypeError = global.TypeError;\n\n// `Map.prototype.reduce` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  reduce: function reduce(callbackfn /* , initialValue */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var noInitial = arguments.length < 2;\n    var accumulator = noInitial ? undefined : arguments[1];\n    aCallable(callbackfn);\n    iterate(iterator, function (key, value) {\n      if (noInitial) {\n        noInitial = false;\n        accumulator = value;\n      } else {\n        accumulator = callbackfn(accumulator, value, key, map);\n      }\n    }, { AS_ENTRIES: true, IS_ITERATOR: true });\n    if (noInitial) throw TypeError('Reduce of empty map with no initial value');\n    return accumulator;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.some` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  some: function some(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (key, value, stop) {\n      if (boundFunction(value, key, map)) return stop();\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar aCallable = require('../internals/a-callable');\n\nvar TypeError = global.TypeError;\n\n// `Set.prototype.update` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  update: function update(key, callback /* , thunk */) {\n    var map = anObject(this);\n    var get = aCallable(map.get);\n    var has = aCallable(map.has);\n    var set = aCallable(map.set);\n    var length = arguments.length;\n    aCallable(callback);\n    var isPresentInMap = call(has, map, key);\n    if (!isPresentInMap && length < 3) {\n      throw TypeError('Updating absent value');\n    }\n    var value = isPresentInMap ? call(get, map, key) : aCallable(length > 2 ? arguments[2] : undefined)(key, map);\n    call(set, map, key, callback(value, key, map));\n    return map;\n  }\n});\n","var $ = require('../internals/export');\n\nvar min = Math.min;\nvar max = Math.max;\n\n// `Math.clamp` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  clamp: function clamp(x, lower, upper) {\n    return min(upper, max(lower, x));\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.DEG_PER_RAD` constant\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  DEG_PER_RAD: Math.PI / 180\n});\n","var $ = require('../internals/export');\n\nvar RAD_PER_DEG = 180 / Math.PI;\n\n// `Math.degrees` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  degrees: function degrees(radians) {\n    return radians * RAD_PER_DEG;\n  }\n});\n","var $ = require('../internals/export');\n\nvar scale = require('../internals/math-scale');\nvar fround = require('../internals/math-fround');\n\n// `Math.fscale` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  fscale: function fscale(x, inLow, inHigh, outLow, outHigh) {\n    return fround(scale(x, inLow, inHigh, outLow, outHigh));\n  }\n});\n","// `Math.scale` method implementation\n// https://rwaldron.github.io/proposal-math-extensions/\nmodule.exports = Math.scale || function scale(x, inLow, inHigh, outLow, outHigh) {\n  var nx = +x;\n  var nInLow = +inLow;\n  var nInHigh = +inHigh;\n  var nOutLow = +outLow;\n  var nOutHigh = +outHigh;\n  // eslint-disable-next-line no-self-compare -- NaN check\n  if (nx != nx || nInLow != nInLow || nInHigh != nInHigh || nOutLow != nOutLow || nOutHigh != nOutHigh) return NaN;\n  if (nx === Infinity || nx === -Infinity) return nx;\n  return (nx - nInLow) * (nOutHigh - nOutLow) / (nInHigh - nInLow) + nOutLow;\n};\n","var $ = require('../internals/export');\n\n// `Math.iaddh` method\n// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\n// TODO: Remove from `core-js@4`\n$({ target: 'Math', stat: true }, {\n  iaddh: function iaddh(x0, x1, y0, y1) {\n    var $x0 = x0 >>> 0;\n    var $x1 = x1 >>> 0;\n    var $y0 = y0 >>> 0;\n    return $x1 + (y1 >>> 0) + (($x0 & $y0 | ($x0 | $y0) & ~($x0 + $y0 >>> 0)) >>> 31) | 0;\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.imulh` method\n// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\n// TODO: Remove from `core-js@4`\n$({ target: 'Math', stat: true }, {\n  imulh: function imulh(u, v) {\n    var UINT16 = 0xFFFF;\n    var $u = +u;\n    var $v = +v;\n    var u0 = $u & UINT16;\n    var v0 = $v & UINT16;\n    var u1 = $u >> 16;\n    var v1 = $v >> 16;\n    var t = (u1 * v0 >>> 0) + (u0 * v0 >>> 16);\n    return u1 * v1 + (t >> 16) + ((u0 * v1 >>> 0) + (t & UINT16) >> 16);\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.isubh` method\n// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\n// TODO: Remove from `core-js@4`\n$({ target: 'Math', stat: true }, {\n  isubh: function isubh(x0, x1, y0, y1) {\n    var $x0 = x0 >>> 0;\n    var $x1 = x1 >>> 0;\n    var $y0 = y0 >>> 0;\n    return $x1 - (y1 >>> 0) - ((~$x0 & $y0 | ~($x0 ^ $y0) & $x0 - $y0 >>> 0) >>> 31) | 0;\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.RAD_PER_DEG` constant\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  RAD_PER_DEG: 180 / Math.PI\n});\n","var $ = require('../internals/export');\n\nvar DEG_PER_RAD = Math.PI / 180;\n\n// `Math.radians` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  radians: function radians(degrees) {\n    return degrees * DEG_PER_RAD;\n  }\n});\n","var $ = require('../internals/export');\nvar scale = require('../internals/math-scale');\n\n// `Math.scale` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  scale: scale\n});\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar anObject = require('../internals/an-object');\nvar numberIsFinite = require('../internals/number-is-finite');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar SEEDED_RANDOM = 'Seeded Random';\nvar SEEDED_RANDOM_GENERATOR = SEEDED_RANDOM + ' Generator';\nvar SEED_TYPE_ERROR = 'Math.seededPRNG() argument should have a \"seed\" field with a finite value.';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(SEEDED_RANDOM_GENERATOR);\nvar TypeError = global.TypeError;\n\nvar $SeededRandomGenerator = createIteratorConstructor(function SeededRandomGenerator(seed) {\n  setInternalState(this, {\n    type: SEEDED_RANDOM_GENERATOR,\n    seed: seed % 2147483647\n  });\n}, SEEDED_RANDOM, function next() {\n  var state = getInternalState(this);\n  var seed = state.seed = (state.seed * 1103515245 + 12345) % 2147483647;\n  return { value: (seed & 1073741823) / 1073741823, done: false };\n});\n\n// `Math.seededPRNG` method\n// https://github.com/tc39/proposal-seeded-random\n// based on https://github.com/tc39/proposal-seeded-random/blob/78b8258835b57fc2100d076151ab506bc3202ae6/demo.html\n$({ target: 'Math', stat: true, forced: true }, {\n  seededPRNG: function seededPRNG(it) {\n    var seed = anObject(it).seed;\n    if (!numberIsFinite(seed)) throw TypeError(SEED_TYPE_ERROR);\n    return new $SeededRandomGenerator(seed);\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.signbit` method\n// https://github.com/tc39/proposal-Math.signbit\n$({ target: 'Math', stat: true }, {\n  signbit: function signbit(x) {\n    return (x = +x) == x && x == 0 ? 1 / x == -Infinity : x < 0;\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.umulh` method\n// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\n// TODO: Remove from `core-js@4`\n$({ target: 'Math', stat: true }, {\n  umulh: function umulh(u, v) {\n    var UINT16 = 0xFFFF;\n    var $u = +u;\n    var $v = +v;\n    var u0 = $u & UINT16;\n    var v0 = $v & UINT16;\n    var u1 = $u >>> 16;\n    var v1 = $v >>> 16;\n    var t = (u1 * v0 >>> 0) + (u0 * v0 >>> 16);\n    return u1 * v1 + (t >>> 16) + ((u0 * v1 >>> 0) + (t & UINT16) >>> 16);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar parseInt = require('../internals/number-parse-int');\n\nvar INVALID_NUMBER_REPRESENTATION = 'Invalid number representation';\nvar INVALID_RADIX = 'Invalid radix';\nvar RangeError = global.RangeError;\nvar SyntaxError = global.SyntaxError;\nvar TypeError = global.TypeError;\nvar valid = /^[\\da-z]+$/;\nvar charAt = uncurryThis(''.charAt);\nvar exec = uncurryThis(valid.exec);\nvar numberToString = uncurryThis(1.0.toString);\nvar stringSlice = uncurryThis(''.slice);\n\n// `Number.fromString` method\n// https://github.com/tc39/proposal-number-fromstring\n$({ target: 'Number', stat: true }, {\n  fromString: function fromString(string, radix) {\n    var sign = 1;\n    var R, mathNum;\n    if (typeof string != 'string') throw TypeError(INVALID_NUMBER_REPRESENTATION);\n    if (!string.length) throw SyntaxError(INVALID_NUMBER_REPRESENTATION);\n    if (charAt(string, 0) == '-') {\n      sign = -1;\n      string = stringSlice(string, 1);\n      if (!string.length) throw SyntaxError(INVALID_NUMBER_REPRESENTATION);\n    }\n    R = radix === undefined ? 10 : toIntegerOrInfinity(radix);\n    if (R < 2 || R > 36) throw RangeError(INVALID_RADIX);\n    if (!exec(valid, string) || numberToString(mathNum = parseInt(string, R), R) !== string) {\n      throw SyntaxError(INVALID_NUMBER_REPRESENTATION);\n    }\n    return sign * mathNum;\n  }\n});\n","'use strict';\n// https://github.com/tc39/proposal-observable\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar setSpecies = require('../internals/set-species');\nvar aCallable = require('../internals/a-callable');\nvar isCallable = require('../internals/is-callable');\nvar isConstructor = require('../internals/is-constructor');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar anInstance = require('../internals/an-instance');\nvar defineProperty = require('../internals/object-define-property').f;\nvar redefine = require('../internals/redefine');\nvar redefineAll = require('../internals/redefine-all');\nvar getIterator = require('../internals/get-iterator');\nvar getMethod = require('../internals/get-method');\nvar iterate = require('../internals/iterate');\nvar hostReportErrors = require('../internals/host-report-errors');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar $$OBSERVABLE = wellKnownSymbol('observable');\nvar OBSERVABLE = 'Observable';\nvar SUBSCRIPTION = 'Subscription';\nvar SUBSCRIPTION_OBSERVER = 'SubscriptionObserver';\nvar getterFor = InternalStateModule.getterFor;\nvar setInternalState = InternalStateModule.set;\nvar getObservableInternalState = getterFor(OBSERVABLE);\nvar getSubscriptionInternalState = getterFor(SUBSCRIPTION);\nvar getSubscriptionObserverInternalState = getterFor(SUBSCRIPTION_OBSERVER);\nvar Array = global.Array;\n\nvar SubscriptionState = function (observer) {\n  this.observer = anObject(observer);\n  this.cleanup = undefined;\n  this.subscriptionObserver = undefined;\n};\n\nSubscriptionState.prototype = {\n  type: SUBSCRIPTION,\n  clean: function () {\n    var cleanup = this.cleanup;\n    if (cleanup) {\n      this.cleanup = undefined;\n      try {\n        cleanup();\n      } catch (error) {\n        hostReportErrors(error);\n      }\n    }\n  },\n  close: function () {\n    if (!DESCRIPTORS) {\n      var subscription = this.facade;\n      var subscriptionObserver = this.subscriptionObserver;\n      subscription.closed = true;\n      if (subscriptionObserver) subscriptionObserver.closed = true;\n    } this.observer = undefined;\n  },\n  isClosed: function () {\n    return this.observer === undefined;\n  }\n};\n\nvar Subscription = function (observer, subscriber) {\n  var subscriptionState = setInternalState(this, new SubscriptionState(observer));\n  var start;\n  if (!DESCRIPTORS) this.closed = false;\n  try {\n    if (start = getMethod(observer, 'start')) call(start, observer, this);\n  } catch (error) {\n    hostReportErrors(error);\n  }\n  if (subscriptionState.isClosed()) return;\n  var subscriptionObserver = subscriptionState.subscriptionObserver = new SubscriptionObserver(subscriptionState);\n  try {\n    var cleanup = subscriber(subscriptionObserver);\n    var subscription = cleanup;\n    if (cleanup != null) subscriptionState.cleanup = isCallable(cleanup.unsubscribe)\n      ? function () { subscription.unsubscribe(); }\n      : aCallable(cleanup);\n  } catch (error) {\n    subscriptionObserver.error(error);\n    return;\n  } if (subscriptionState.isClosed()) subscriptionState.clean();\n};\n\nSubscription.prototype = redefineAll({}, {\n  unsubscribe: function unsubscribe() {\n    var subscriptionState = getSubscriptionInternalState(this);\n    if (!subscriptionState.isClosed()) {\n      subscriptionState.close();\n      subscriptionState.clean();\n    }\n  }\n});\n\nif (DESCRIPTORS) defineProperty(Subscription.prototype, 'closed', {\n  configurable: true,\n  get: function () {\n    return getSubscriptionInternalState(this).isClosed();\n  }\n});\n\nvar SubscriptionObserver = function (subscriptionState) {\n  setInternalState(this, {\n    type: SUBSCRIPTION_OBSERVER,\n    subscriptionState: subscriptionState\n  });\n  if (!DESCRIPTORS) this.closed = false;\n};\n\nSubscriptionObserver.prototype = redefineAll({}, {\n  next: function next(value) {\n    var subscriptionState = getSubscriptionObserverInternalState(this).subscriptionState;\n    if (!subscriptionState.isClosed()) {\n      var observer = subscriptionState.observer;\n      try {\n        var nextMethod = getMethod(observer, 'next');\n        if (nextMethod) call(nextMethod, observer, value);\n      } catch (error) {\n        hostReportErrors(error);\n      }\n    }\n  },\n  error: function error(value) {\n    var subscriptionState = getSubscriptionObserverInternalState(this).subscriptionState;\n    if (!subscriptionState.isClosed()) {\n      var observer = subscriptionState.observer;\n      subscriptionState.close();\n      try {\n        var errorMethod = getMethod(observer, 'error');\n        if (errorMethod) call(errorMethod, observer, value);\n        else hostReportErrors(value);\n      } catch (err) {\n        hostReportErrors(err);\n      } subscriptionState.clean();\n    }\n  },\n  complete: function complete() {\n    var subscriptionState = getSubscriptionObserverInternalState(this).subscriptionState;\n    if (!subscriptionState.isClosed()) {\n      var observer = subscriptionState.observer;\n      subscriptionState.close();\n      try {\n        var completeMethod = getMethod(observer, 'complete');\n        if (completeMethod) call(completeMethod, observer);\n      } catch (error) {\n        hostReportErrors(error);\n      } subscriptionState.clean();\n    }\n  }\n});\n\nif (DESCRIPTORS) defineProperty(SubscriptionObserver.prototype, 'closed', {\n  configurable: true,\n  get: function () {\n    return getSubscriptionObserverInternalState(this).subscriptionState.isClosed();\n  }\n});\n\nvar $Observable = function Observable(subscriber) {\n  anInstance(this, ObservablePrototype);\n  setInternalState(this, {\n    type: OBSERVABLE,\n    subscriber: aCallable(subscriber)\n  });\n};\n\nvar ObservablePrototype = $Observable.prototype;\n\nredefineAll(ObservablePrototype, {\n  subscribe: function subscribe(observer) {\n    var length = arguments.length;\n    return new Subscription(isCallable(observer) ? {\n      next: observer,\n      error: length > 1 ? arguments[1] : undefined,\n      complete: length > 2 ? arguments[2] : undefined\n    } : isObject(observer) ? observer : {}, getObservableInternalState(this).subscriber);\n  }\n});\n\nredefineAll($Observable, {\n  from: function from(x) {\n    var C = isConstructor(this) ? this : $Observable;\n    var observableMethod = getMethod(anObject(x), $$OBSERVABLE);\n    if (observableMethod) {\n      var observable = anObject(call(observableMethod, x));\n      return observable.constructor === C ? observable : new C(function (observer) {\n        return observable.subscribe(observer);\n      });\n    }\n    var iterator = getIterator(x);\n    return new C(function (observer) {\n      iterate(iterator, function (it, stop) {\n        observer.next(it);\n        if (observer.closed) return stop();\n      }, { IS_ITERATOR: true, INTERRUPTED: true });\n      observer.complete();\n    });\n  },\n  of: function of() {\n    var C = isConstructor(this) ? this : $Observable;\n    var length = arguments.length;\n    var items = Array(length);\n    var index = 0;\n    while (index < length) items[index] = arguments[index++];\n    return new C(function (observer) {\n      for (var i = 0; i < length; i++) {\n        observer.next(items[i]);\n        if (observer.closed) return;\n      } observer.complete();\n    });\n  }\n});\n\nredefine(ObservablePrototype, $$OBSERVABLE, function () { return this; });\n\n$({ global: true }, {\n  Observable: $Observable\n});\n\nsetSpecies(OBSERVABLE);\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar iterate = require('../internals/iterate');\n\n// `Promise.allSettled` method\n// https://tc39.es/ecma262/#sec-promise.allsettled\n$({ target: 'Promise', stat: true }, {\n  allSettled: function allSettled(iterable) {\n    var C = this;\n    var capability = newPromiseCapabilityModule.f(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var promiseResolve = aCallable(C.resolve);\n      var values = [];\n      var counter = 0;\n      var remaining = 1;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyCalled = false;\n        remaining++;\n        call(promiseResolve, C, promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = { status: 'fulfilled', value: value };\n          --remaining || resolve(values);\n        }, function (error) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = { status: 'rejected', reason: error };\n          --remaining || resolve(values);\n        });\n      });\n      --remaining || resolve(values);\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar aCallable = require('../internals/a-callable');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar iterate = require('../internals/iterate');\n\nvar PROMISE_ANY_ERROR = 'No one promise resolved';\n\n// `Promise.any` method\n// https://tc39.es/ecma262/#sec-promise.any\n$({ target: 'Promise', stat: true }, {\n  any: function any(iterable) {\n    var C = this;\n    var AggregateError = getBuiltIn('AggregateError');\n    var capability = newPromiseCapabilityModule.f(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var promiseResolve = aCallable(C.resolve);\n      var errors = [];\n      var counter = 0;\n      var remaining = 1;\n      var alreadyResolved = false;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyRejected = false;\n        remaining++;\n        call(promiseResolve, C, promise).then(function (value) {\n          if (alreadyRejected || alreadyResolved) return;\n          alreadyResolved = true;\n          resolve(value);\n        }, function (error) {\n          if (alreadyRejected || alreadyResolved) return;\n          alreadyRejected = true;\n          errors[index] = error;\n          --remaining || reject(new AggregateError(errors, PROMISE_ANY_ERROR));\n        });\n      });\n      --remaining || reject(new AggregateError(errors, PROMISE_ANY_ERROR));\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\n\n// `Promise.try` method\n// https://github.com/tc39/proposal-promise-try\n$({ target: 'Promise', stat: true }, {\n  'try': function (callbackfn) {\n    var promiseCapability = newPromiseCapabilityModule.f(this);\n    var result = perform(callbackfn);\n    (result.error ? promiseCapability.reject : promiseCapability.resolve)(result.value);\n    return promiseCapability.promise;\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar toMetadataKey = ReflectMetadataModule.toKey;\nvar ordinaryDefineOwnMetadata = ReflectMetadataModule.set;\n\n// `Reflect.defineMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  defineMetadata: function defineMetadata(metadataKey, metadataValue, target /* , targetKey */) {\n    var targetKey = arguments.length < 4 ? undefined : toMetadataKey(arguments[3]);\n    ordinaryDefineOwnMetadata(metadataKey, metadataValue, anObject(target), targetKey);\n  }\n});\n","// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.map');\nrequire('../modules/es.weak-map');\nvar getBuiltIn = require('../internals/get-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar shared = require('../internals/shared');\n\nvar Map = getBuiltIn('Map');\nvar WeakMap = getBuiltIn('WeakMap');\nvar push = uncurryThis([].push);\n\nvar metadata = shared('metadata');\nvar store = metadata.store || (metadata.store = new WeakMap());\n\nvar getOrCreateMetadataMap = function (target, targetKey, create) {\n  var targetMetadata = store.get(target);\n  if (!targetMetadata) {\n    if (!create) return;\n    store.set(target, targetMetadata = new Map());\n  }\n  var keyMetadata = targetMetadata.get(targetKey);\n  if (!keyMetadata) {\n    if (!create) return;\n    targetMetadata.set(targetKey, keyMetadata = new Map());\n  } return keyMetadata;\n};\n\nvar ordinaryHasOwnMetadata = function (MetadataKey, O, P) {\n  var metadataMap = getOrCreateMetadataMap(O, P, false);\n  return metadataMap === undefined ? false : metadataMap.has(MetadataKey);\n};\n\nvar ordinaryGetOwnMetadata = function (MetadataKey, O, P) {\n  var metadataMap = getOrCreateMetadataMap(O, P, false);\n  return metadataMap === undefined ? undefined : metadataMap.get(MetadataKey);\n};\n\nvar ordinaryDefineOwnMetadata = function (MetadataKey, MetadataValue, O, P) {\n  getOrCreateMetadataMap(O, P, true).set(MetadataKey, MetadataValue);\n};\n\nvar ordinaryOwnMetadataKeys = function (target, targetKey) {\n  var metadataMap = getOrCreateMetadataMap(target, targetKey, false);\n  var keys = [];\n  if (metadataMap) metadataMap.forEach(function (_, key) { push(keys, key); });\n  return keys;\n};\n\nvar toMetadataKey = function (it) {\n  return it === undefined || typeof it == 'symbol' ? it : String(it);\n};\n\nmodule.exports = {\n  store: store,\n  getMap: getOrCreateMetadataMap,\n  has: ordinaryHasOwnMetadata,\n  get: ordinaryGetOwnMetadata,\n  set: ordinaryDefineOwnMetadata,\n  keys: ordinaryOwnMetadataKeys,\n  toKey: toMetadataKey\n};\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar toMetadataKey = ReflectMetadataModule.toKey;\nvar getOrCreateMetadataMap = ReflectMetadataModule.getMap;\nvar store = ReflectMetadataModule.store;\n\n// `Reflect.deleteMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  deleteMetadata: function deleteMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    var metadataMap = getOrCreateMetadataMap(anObject(target), targetKey, false);\n    if (metadataMap === undefined || !metadataMap['delete'](metadataKey)) return false;\n    if (metadataMap.size) return true;\n    var targetMetadata = store.get(target);\n    targetMetadata['delete'](targetKey);\n    return !!targetMetadata.size || store['delete'](target);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\n\nvar ordinaryHasOwnMetadata = ReflectMetadataModule.has;\nvar ordinaryGetOwnMetadata = ReflectMetadataModule.get;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\nvar ordinaryGetMetadata = function (MetadataKey, O, P) {\n  var hasOwn = ordinaryHasOwnMetadata(MetadataKey, O, P);\n  if (hasOwn) return ordinaryGetOwnMetadata(MetadataKey, O, P);\n  var parent = getPrototypeOf(O);\n  return parent !== null ? ordinaryGetMetadata(MetadataKey, parent, P) : undefined;\n};\n\n// `Reflect.getMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  getMetadata: function getMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    return ordinaryGetMetadata(metadataKey, anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar $arrayUniqueBy = require('../internals/array-unique-by');\n\nvar arrayUniqueBy = uncurryThis($arrayUniqueBy);\nvar concat = uncurryThis([].concat);\nvar ordinaryOwnMetadataKeys = ReflectMetadataModule.keys;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\nvar ordinaryMetadataKeys = function (O, P) {\n  var oKeys = ordinaryOwnMetadataKeys(O, P);\n  var parent = getPrototypeOf(O);\n  if (parent === null) return oKeys;\n  var pKeys = ordinaryMetadataKeys(parent, P);\n  return pKeys.length ? oKeys.length ? arrayUniqueBy(concat(oKeys, pKeys)) : pKeys : oKeys;\n};\n\n// `Reflect.getMetadataKeys` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  getMetadataKeys: function getMetadataKeys(target /* , targetKey */) {\n    var targetKey = arguments.length < 2 ? undefined : toMetadataKey(arguments[1]);\n    return ordinaryMetadataKeys(anObject(target), targetKey);\n  }\n});\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toObject = require('../internals/to-object');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\nvar Map = getBuiltIn('Map');\nvar MapPrototype = Map.prototype;\nvar mapForEach = uncurryThis(MapPrototype.forEach);\nvar mapHas = uncurryThis(MapPrototype.has);\nvar mapSet = uncurryThis(MapPrototype.set);\nvar push = uncurryThis([].push);\n\n// `Array.prototype.uniqueBy` method\n// https://github.com/tc39/proposal-array-unique\nmodule.exports = function uniqueBy(resolver) {\n  var that = toObject(this);\n  var length = lengthOfArrayLike(that);\n  var result = arraySpeciesCreate(that, 0);\n  var map = new Map();\n  var resolverFunction = resolver != null ? aCallable(resolver) : function (value) {\n    return value;\n  };\n  var index, item, key;\n  for (index = 0; index < length; index++) {\n    item = that[index];\n    key = resolverFunction(item);\n    if (!mapHas(map, key)) mapSet(map, key, item);\n  }\n  mapForEach(map, function (value) {\n    push(result, value);\n  });\n  return result;\n};\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar ordinaryGetOwnMetadata = ReflectMetadataModule.get;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\n// `Reflect.getOwnMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  getOwnMetadata: function getOwnMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    return ordinaryGetOwnMetadata(metadataKey, anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar ordinaryOwnMetadataKeys = ReflectMetadataModule.keys;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\n// `Reflect.getOwnMetadataKeys` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  getOwnMetadataKeys: function getOwnMetadataKeys(target /* , targetKey */) {\n    var targetKey = arguments.length < 2 ? undefined : toMetadataKey(arguments[1]);\n    return ordinaryOwnMetadataKeys(anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\n\nvar ordinaryHasOwnMetadata = ReflectMetadataModule.has;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\nvar ordinaryHasMetadata = function (MetadataKey, O, P) {\n  var hasOwn = ordinaryHasOwnMetadata(MetadataKey, O, P);\n  if (hasOwn) return true;\n  var parent = getPrototypeOf(O);\n  return parent !== null ? ordinaryHasMetadata(MetadataKey, parent, P) : false;\n};\n\n// `Reflect.hasMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  hasMetadata: function hasMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    return ordinaryHasMetadata(metadataKey, anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar ordinaryHasOwnMetadata = ReflectMetadataModule.has;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\n// `Reflect.hasOwnMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  hasOwnMetadata: function hasOwnMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    return ordinaryHasOwnMetadata(metadataKey, anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar toMetadataKey = ReflectMetadataModule.toKey;\nvar ordinaryDefineOwnMetadata = ReflectMetadataModule.set;\n\n// `Reflect.metadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  metadata: function metadata(metadataKey, metadataValue) {\n    return function decorator(target, key) {\n      ordinaryDefineOwnMetadata(metadataKey, metadataValue, anObject(target), toMetadataKey(key));\n    };\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar addAll = require('../internals/collection-add-all');\n\n// `Set.prototype.addAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  addAll: addAll\n});\n","'use strict';\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\n\n// https://github.com/tc39/collection-methods\nmodule.exports = function addAll(/* ...elements */) {\n  var set = anObject(this);\n  var adder = aCallable(set.add);\n  for (var k = 0, len = arguments.length; k < len; k++) {\n    call(adder, set, arguments[k]);\n  }\n  return set;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar deleteAll = require('../internals/collection-delete-all');\n\n// `Set.prototype.deleteAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  deleteAll: deleteAll\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.difference` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  difference: function difference(iterable) {\n    var set = anObject(this);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))(set);\n    var remover = aCallable(newSet['delete']);\n    iterate(iterable, function (value) {\n      call(remover, newSet, value);\n    });\n    return newSet;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.every` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  every: function every(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return !iterate(iterator, function (value, stop) {\n      if (!boundFunction(value, value, set)) return stop();\n    }, { IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","var call = require('../internals/function-call');\n\nmodule.exports = function (it) {\n  // eslint-disable-next-line es/no-set -- safe\n  return call(Set.prototype.values, it);\n};\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.filter` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))();\n    var adder = aCallable(newSet.add);\n    iterate(iterator, function (value) {\n      if (boundFunction(value, value, set)) call(adder, newSet, value);\n    }, { IS_ITERATOR: true });\n    return newSet;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.find` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  find: function find(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (value, stop) {\n      if (boundFunction(value, value, set)) return stop(value);\n    }, { IS_ITERATOR: true, INTERRUPTED: true }).result;\n  }\n});\n","var $ = require('../internals/export');\nvar from = require('../internals/collection-from');\n\n// `Set.from` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-set.from\n$({ target: 'Set', stat: true }, {\n  from: from\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.intersection` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  intersection: function intersection(iterable) {\n    var set = anObject(this);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))();\n    var hasCheck = aCallable(set.has);\n    var adder = aCallable(newSet.add);\n    iterate(iterable, function (value) {\n      if (call(hasCheck, set, value)) call(adder, newSet, value);\n    });\n    return newSet;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.isDisjointFrom` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isDisjointFrom\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  isDisjointFrom: function isDisjointFrom(iterable) {\n    var set = anObject(this);\n    var hasCheck = aCallable(set.has);\n    return !iterate(iterable, function (value, stop) {\n      if (call(hasCheck, set, value) === true) return stop();\n    }, { INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar isCallable = require('../internals/is-callable');\nvar anObject = require('../internals/an-object');\nvar getIterator = require('../internals/get-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.isSubsetOf` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isSubsetOf\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  isSubsetOf: function isSubsetOf(iterable) {\n    var iterator = getIterator(this);\n    var otherSet = anObject(iterable);\n    var hasCheck = otherSet.has;\n    if (!isCallable(hasCheck)) {\n      otherSet = new (getBuiltIn('Set'))(iterable);\n      hasCheck = aCallable(otherSet.has);\n    }\n    return !iterate(iterator, function (value, stop) {\n      if (call(hasCheck, otherSet, value) === false) return stop();\n    }, { IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.isSupersetOf` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isSupersetOf\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  isSupersetOf: function isSupersetOf(iterable) {\n    var set = anObject(this);\n    var hasCheck = aCallable(set.has);\n    return !iterate(iterable, function (value, stop) {\n      if (call(hasCheck, set, value) === false) return stop();\n    }, { INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar anObject = require('../internals/an-object');\nvar toString = require('../internals/to-string');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\nvar arrayJoin = uncurryThis([].join);\nvar push = [].push;\n\n// `Set.prototype.join` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  join: function join(separator) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var sep = separator === undefined ? ',' : toString(separator);\n    var result = [];\n    iterate(iterator, push, { that: result, IS_ITERATOR: true });\n    return arrayJoin(result, sep);\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.map` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  map: function map(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))();\n    var adder = aCallable(newSet.add);\n    iterate(iterator, function (value) {\n      call(adder, newSet, boundFunction(value, value, set));\n    }, { IS_ITERATOR: true });\n    return newSet;\n  }\n});\n","var $ = require('../internals/export');\nvar of = require('../internals/collection-of');\n\n// `Set.of` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-set.of\n$({ target: 'Set', stat: true }, {\n  of: of\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar IS_PURE = require('../internals/is-pure');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\nvar TypeError = global.TypeError;\n\n// `Set.prototype.reduce` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  reduce: function reduce(callbackfn /* , initialValue */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var noInitial = arguments.length < 2;\n    var accumulator = noInitial ? undefined : arguments[1];\n    aCallable(callbackfn);\n    iterate(iterator, function (value) {\n      if (noInitial) {\n        noInitial = false;\n        accumulator = value;\n      } else {\n        accumulator = callbackfn(accumulator, value, value, set);\n      }\n    }, { IS_ITERATOR: true });\n    if (noInitial) throw TypeError('Reduce of empty set with no initial value');\n    return accumulator;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.some` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  some: function some(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (value, stop) {\n      if (boundFunction(value, value, set)) return stop();\n    }, { IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.symmetricDifference` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  symmetricDifference: function symmetricDifference(iterable) {\n    var set = anObject(this);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))(set);\n    var remover = aCallable(newSet['delete']);\n    var adder = aCallable(newSet.add);\n    iterate(iterable, function (value) {\n      call(remover, newSet, value) || call(adder, newSet, value);\n    });\n    return newSet;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar getBuiltIn = require('../internals/get-built-in');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.union` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  union: function union(iterable) {\n    var set = anObject(this);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))(set);\n    iterate(iterable, aCallable(newSet.add), { that: newSet });\n    return newSet;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar charAt = require('../internals/string-multibyte').charAt;\nvar fails = require('../internals/fails');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toString = require('../internals/to-string');\n\nvar FORCED = fails(function () {\n  return '𠮷'.at(-2) !== '𠮷';\n});\n\n// `String.prototype.at` method\n// https://github.com/mathiasbynens/String.prototype.at\n$({ target: 'String', proto: true, forced: FORCED }, {\n  at: function at(index) {\n    var S = toString(requireObjectCoercible(this));\n    var len = S.length;\n    var relativeIndex = toIntegerOrInfinity(index);\n    var k = relativeIndex >= 0 ? relativeIndex : len + relativeIndex;\n    return (k < 0 || k >= len) ? undefined : charAt(S, k);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toString = require('../internals/to-string');\nvar InternalStateModule = require('../internals/internal-state');\nvar StringMultibyteModule = require('../internals/string-multibyte');\n\nvar codeAt = StringMultibyteModule.codeAt;\nvar charAt = StringMultibyteModule.charAt;\nvar STRING_ITERATOR = 'String Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(STRING_ITERATOR);\n\n// TODO: unify with String#@@iterator\nvar $StringIterator = createIteratorConstructor(function StringIterator(string) {\n  setInternalState(this, {\n    type: STRING_ITERATOR,\n    string: string,\n    index: 0\n  });\n}, 'String', function next() {\n  var state = getInternalState(this);\n  var string = state.string;\n  var index = state.index;\n  var point;\n  if (index >= string.length) return { value: undefined, done: true };\n  point = charAt(string, index);\n  state.index += point.length;\n  return { value: { codePoint: codeAt(point, 0), position: index }, done: false };\n});\n\n// `String.prototype.codePoints` method\n// https://github.com/tc39/proposal-string-prototype-codepoints\n$({ target: 'String', proto: true }, {\n  codePoints: function codePoints() {\n    return new $StringIterator(toString(requireObjectCoercible(this)));\n  }\n});\n","'use strict';\n/* eslint-disable es/no-string-prototype-matchall -- safe */\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar anObject = require('../internals/an-object');\nvar classof = require('../internals/classof-raw');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar isRegExp = require('../internals/is-regexp');\nvar regExpFlags = require('../internals/regexp-flags');\nvar getMethod = require('../internals/get-method');\nvar redefine = require('../internals/redefine');\nvar fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar speciesConstructor = require('../internals/species-constructor');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar regExpExec = require('../internals/regexp-exec-abstract');\nvar InternalStateModule = require('../internals/internal-state');\nvar IS_PURE = require('../internals/is-pure');\n\nvar MATCH_ALL = wellKnownSymbol('matchAll');\nvar REGEXP_STRING = 'RegExp String';\nvar REGEXP_STRING_ITERATOR = REGEXP_STRING + ' Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(REGEXP_STRING_ITERATOR);\nvar RegExpPrototype = RegExp.prototype;\nvar TypeError = global.TypeError;\nvar getFlags = uncurryThis(regExpFlags);\nvar stringIndexOf = uncurryThis(''.indexOf);\nvar un$MatchAll = uncurryThis(''.matchAll);\n\nvar WORKS_WITH_NON_GLOBAL_REGEX = !!un$MatchAll && !fails(function () {\n  un$MatchAll('a', /./);\n});\n\nvar $RegExpStringIterator = createIteratorConstructor(function RegExpStringIterator(regexp, string, $global, fullUnicode) {\n  setInternalState(this, {\n    type: REGEXP_STRING_ITERATOR,\n    regexp: regexp,\n    string: string,\n    global: $global,\n    unicode: fullUnicode,\n    done: false\n  });\n}, REGEXP_STRING, function next() {\n  var state = getInternalState(this);\n  if (state.done) return { value: undefined, done: true };\n  var R = state.regexp;\n  var S = state.string;\n  var match = regExpExec(R, S);\n  if (match === null) return { value: undefined, done: state.done = true };\n  if (state.global) {\n    if (toString(match[0]) === '') R.lastIndex = advanceStringIndex(S, toLength(R.lastIndex), state.unicode);\n    return { value: match, done: false };\n  }\n  state.done = true;\n  return { value: match, done: false };\n});\n\nvar $matchAll = function (string) {\n  var R = anObject(this);\n  var S = toString(string);\n  var C, flagsValue, flags, matcher, $global, fullUnicode;\n  C = speciesConstructor(R, RegExp);\n  flagsValue = R.flags;\n  if (flagsValue === undefined && isPrototypeOf(RegExpPrototype, R) && !('flags' in RegExpPrototype)) {\n    flagsValue = getFlags(R);\n  }\n  flags = flagsValue === undefined ? '' : toString(flagsValue);\n  matcher = new C(C === RegExp ? R.source : R, flags);\n  $global = !!~stringIndexOf(flags, 'g');\n  fullUnicode = !!~stringIndexOf(flags, 'u');\n  matcher.lastIndex = toLength(R.lastIndex);\n  return new $RegExpStringIterator(matcher, S, $global, fullUnicode);\n};\n\n// `String.prototype.matchAll` method\n// https://tc39.es/ecma262/#sec-string.prototype.matchall\n$({ target: 'String', proto: true, forced: WORKS_WITH_NON_GLOBAL_REGEX }, {\n  matchAll: function matchAll(regexp) {\n    var O = requireObjectCoercible(this);\n    var flags, S, matcher, rx;\n    if (regexp != null) {\n      if (isRegExp(regexp)) {\n        flags = toString(requireObjectCoercible('flags' in RegExpPrototype\n          ? regexp.flags\n          : getFlags(regexp)\n        ));\n        if (!~stringIndexOf(flags, 'g')) throw TypeError('`.matchAll` does not allow non-global regexes');\n      }\n      if (WORKS_WITH_NON_GLOBAL_REGEX) return un$MatchAll(O, regexp);\n      matcher = getMethod(regexp, MATCH_ALL);\n      if (matcher === undefined && IS_PURE && classof(regexp) == 'RegExp') matcher = $matchAll;\n      if (matcher) return call(matcher, regexp, O);\n    } else if (WORKS_WITH_NON_GLOBAL_REGEX) return un$MatchAll(O, regexp);\n    S = toString(O);\n    rx = new RegExp(regexp, 'g');\n    return IS_PURE ? call($matchAll, rx, S) : rx[MATCH_ALL](S);\n  }\n});\n\nIS_PURE || MATCH_ALL in RegExpPrototype || redefine(RegExpPrototype, MATCH_ALL, $matchAll);\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar isCallable = require('../internals/is-callable');\nvar isRegExp = require('../internals/is-regexp');\nvar toString = require('../internals/to-string');\nvar getMethod = require('../internals/get-method');\nvar regExpFlags = require('../internals/regexp-flags');\nvar getSubstitution = require('../internals/get-substitution');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar REPLACE = wellKnownSymbol('replace');\nvar RegExpPrototype = RegExp.prototype;\nvar TypeError = global.TypeError;\nvar getFlags = uncurryThis(regExpFlags);\nvar indexOf = uncurryThis(''.indexOf);\nvar replace = uncurryThis(''.replace);\nvar stringSlice = uncurryThis(''.slice);\nvar max = Math.max;\n\nvar stringIndexOf = function (string, searchValue, fromIndex) {\n  if (fromIndex > string.length) return -1;\n  if (searchValue === '') return fromIndex;\n  return indexOf(string, searchValue, fromIndex);\n};\n\n// `String.prototype.replaceAll` method\n// https://tc39.es/ecma262/#sec-string.prototype.replaceall\n$({ target: 'String', proto: true }, {\n  replaceAll: function replaceAll(searchValue, replaceValue) {\n    var O = requireObjectCoercible(this);\n    var IS_REG_EXP, flags, replacer, string, searchString, functionalReplace, searchLength, advanceBy, replacement;\n    var position = 0;\n    var endOfLastMatch = 0;\n    var result = '';\n    if (searchValue != null) {\n      IS_REG_EXP = isRegExp(searchValue);\n      if (IS_REG_EXP) {\n        flags = toString(requireObjectCoercible('flags' in RegExpPrototype\n          ? searchValue.flags\n          : getFlags(searchValue)\n        ));\n        if (!~indexOf(flags, 'g')) throw TypeError('`.replaceAll` does not allow non-global regexes');\n      }\n      replacer = getMethod(searchValue, REPLACE);\n      if (replacer) {\n        return call(replacer, searchValue, O, replaceValue);\n      } else if (IS_PURE && IS_REG_EXP) {\n        return replace(toString(O), searchValue, replaceValue);\n      }\n    }\n    string = toString(O);\n    searchString = toString(searchValue);\n    functionalReplace = isCallable(replaceValue);\n    if (!functionalReplace) replaceValue = toString(replaceValue);\n    searchLength = searchString.length;\n    advanceBy = max(1, searchLength);\n    position = stringIndexOf(string, searchString, 0);\n    while (position !== -1) {\n      replacement = functionalReplace\n        ? toString(replaceValue(searchString, position, string))\n        : getSubstitution(searchString, string, position, [], undefined, replaceValue);\n      result += stringSlice(string, endOfLastMatch, position) + replacement;\n      endOfLastMatch = position + searchLength;\n      position = stringIndexOf(string, searchString, position + advanceBy);\n    }\n    if (endOfLastMatch < string.length) {\n      result += stringSlice(string, endOfLastMatch);\n    }\n    return result;\n  }\n});\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.dispose` well-known symbol\n// https://github.com/tc39/proposal-using-statement\ndefineWellKnownSymbol('dispose');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.observable` well-known symbol\n// https://github.com/tc39/proposal-observable\ndefineWellKnownSymbol('observable');\n","// TODO: remove from `core-js@4`\nvar defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.patternMatch` well-known symbol\n// https://github.com/tc39/proposal-pattern-matching\ndefineWellKnownSymbol('patternMatch');\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar deleteAll = require('../internals/collection-delete-all');\n\n// `WeakMap.prototype.deleteAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'WeakMap', proto: true, real: true, forced: IS_PURE }, {\n  deleteAll: deleteAll\n});\n","var $ = require('../internals/export');\nvar from = require('../internals/collection-from');\n\n// `WeakMap.from` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-weakmap.from\n$({ target: 'WeakMap', stat: true }, {\n  from: from\n});\n","var $ = require('../internals/export');\nvar of = require('../internals/collection-of');\n\n// `WeakMap.of` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-weakmap.of\n$({ target: 'WeakMap', stat: true }, {\n  of: of\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar addAll = require('../internals/collection-add-all');\n\n// `WeakSet.prototype.addAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'WeakSet', proto: true, real: true, forced: IS_PURE }, {\n  addAll: addAll\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar deleteAll = require('../internals/collection-delete-all');\n\n// `WeakSet.prototype.deleteAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'WeakSet', proto: true, real: true, forced: IS_PURE }, {\n  deleteAll: deleteAll\n});\n","var $ = require('../internals/export');\nvar from = require('../internals/collection-from');\n\n// `WeakSet.from` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-weakset.from\n$({ target: 'WeakSet', stat: true }, {\n  from: from\n});\n","var $ = require('../internals/export');\nvar of = require('../internals/collection-of');\n\n// `WeakSet.of` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-weakset.of\n$({ target: 'WeakSet', stat: true }, {\n  of: of\n});\n","var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar DOMTokenListPrototype = require('../internals/dom-token-list-prototype');\nvar forEach = require('../internals/array-for-each');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nvar handlePrototype = function (CollectionPrototype) {\n  // some Chrome versions have non-configurable methods on DOMTokenList\n  if (CollectionPrototype && CollectionPrototype.forEach !== forEach) try {\n    createNonEnumerableProperty(CollectionPrototype, 'forEach', forEach);\n  } catch (error) {\n    CollectionPrototype.forEach = forEach;\n  }\n};\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  if (DOMIterables[COLLECTION_NAME]) {\n    handlePrototype(global[COLLECTION_NAME] && global[COLLECTION_NAME].prototype);\n  }\n}\n\nhandlePrototype(DOMTokenListPrototype);\n","// iterable DOM collections\n// flag - `iterable` interface - 'entries', 'keys', 'values', 'forEach' methods\nmodule.exports = {\n  CSSRuleList: 0,\n  CSSStyleDeclaration: 0,\n  CSSValueList: 0,\n  ClientRectList: 0,\n  DOMRectList: 0,\n  DOMStringList: 0,\n  DOMTokenList: 1,\n  DataTransferItemList: 0,\n  FileList: 0,\n  HTMLAllCollection: 0,\n  HTMLCollection: 0,\n  HTMLFormElement: 0,\n  HTMLSelectElement: 0,\n  MediaList: 0,\n  MimeTypeArray: 0,\n  NamedNodeMap: 0,\n  NodeList: 1,\n  PaintRequestList: 0,\n  Plugin: 0,\n  PluginArray: 0,\n  SVGLengthList: 0,\n  SVGNumberList: 0,\n  SVGPathSegList: 0,\n  SVGPointList: 0,\n  SVGStringList: 0,\n  SVGTransformList: 0,\n  SourceBufferList: 0,\n  StyleSheetList: 0,\n  TextTrackCueList: 0,\n  TextTrackList: 0,\n  TouchList: 0\n};\n","// in old WebKit versions, `element.classList` is not an instance of global `DOMTokenList`\nvar documentCreateElement = require('../internals/document-create-element');\n\nvar classList = documentCreateElement('span').classList;\nvar DOMTokenListPrototype = classList && classList.constructor && classList.constructor.prototype;\n\nmodule.exports = DOMTokenListPrototype === Object.prototype ? undefined : DOMTokenListPrototype;\n","'use strict';\nvar $forEach = require('../internals/array-iteration').forEach;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar STRICT_METHOD = arrayMethodIsStrict('forEach');\n\n// `Array.prototype.forEach` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.foreach\nmodule.exports = !STRICT_METHOD ? function forEach(callbackfn /* , thisArg */) {\n  return $forEach(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n// eslint-disable-next-line es/no-array-prototype-foreach -- safe\n} : [].forEach;\n","var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar DOMTokenListPrototype = require('../internals/dom-token-list-prototype');\nvar ArrayIteratorMethods = require('../modules/es.array.iterator');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar ArrayValues = ArrayIteratorMethods.values;\n\nvar handlePrototype = function (CollectionPrototype, COLLECTION_NAME) {\n  if (CollectionPrototype) {\n    // some Chrome versions have non-configurable methods on DOMTokenList\n    if (CollectionPrototype[ITERATOR] !== ArrayValues) try {\n      createNonEnumerableProperty(CollectionPrototype, ITERATOR, ArrayValues);\n    } catch (error) {\n      CollectionPrototype[ITERATOR] = ArrayValues;\n    }\n    if (!CollectionPrototype[TO_STRING_TAG]) {\n      createNonEnumerableProperty(CollectionPrototype, TO_STRING_TAG, COLLECTION_NAME);\n    }\n    if (DOMIterables[COLLECTION_NAME]) for (var METHOD_NAME in ArrayIteratorMethods) {\n      // some Chrome versions have non-configurable methods on DOMTokenList\n      if (CollectionPrototype[METHOD_NAME] !== ArrayIteratorMethods[METHOD_NAME]) try {\n        createNonEnumerableProperty(CollectionPrototype, METHOD_NAME, ArrayIteratorMethods[METHOD_NAME]);\n      } catch (error) {\n        CollectionPrototype[METHOD_NAME] = ArrayIteratorMethods[METHOD_NAME];\n      }\n    }\n  }\n};\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  handlePrototype(global[COLLECTION_NAME] && global[COLLECTION_NAME].prototype, COLLECTION_NAME);\n}\n\nhandlePrototype(DOMTokenListPrototype, 'DOMTokenList');\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar task = require('../internals/task');\n\nvar FORCED = !global.setImmediate || !global.clearImmediate;\n\n// http://w3c.github.io/setImmediate/\n$({ global: true, bind: true, enumerable: true, forced: FORCED }, {\n  // `setImmediate` method\n  // http://w3c.github.io/setImmediate/#si-setImmediate\n  setImmediate: task.set,\n  // `clearImmediate` method\n  // http://w3c.github.io/setImmediate/#si-clearImmediate\n  clearImmediate: task.clear\n});\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar microtask = require('../internals/microtask');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar process = global.process;\n\n// `queueMicrotask` method\n// https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-queuemicrotask\n$({ global: true, enumerable: true, noTargetGet: true }, {\n  queueMicrotask: function queueMicrotask(fn) {\n    var domain = IS_NODE && process.domain;\n    microtask(domain ? domain.bind(fn) : fn);\n  }\n});\n","'use strict';\n// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.string.iterator');\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar USE_NATIVE_URL = require('../internals/native-url');\nvar global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar defineProperties = require('../internals/object-define-properties').f;\nvar redefine = require('../internals/redefine');\nvar anInstance = require('../internals/an-instance');\nvar hasOwn = require('../internals/has-own-property');\nvar assign = require('../internals/object-assign');\nvar arrayFrom = require('../internals/array-from');\nvar arraySlice = require('../internals/array-slice-simple');\nvar codeAt = require('../internals/string-multibyte').codeAt;\nvar toASCII = require('../internals/string-punycode-to-ascii');\nvar $toString = require('../internals/to-string');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar URLSearchParamsModule = require('../modules/web.url-search-params');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar setInternalState = InternalStateModule.set;\nvar getInternalURLState = InternalStateModule.getterFor('URL');\nvar URLSearchParams = URLSearchParamsModule.URLSearchParams;\nvar getInternalSearchParamsState = URLSearchParamsModule.getState;\n\nvar NativeURL = global.URL;\nvar TypeError = global.TypeError;\nvar parseInt = global.parseInt;\nvar floor = Math.floor;\nvar pow = Math.pow;\nvar charAt = uncurryThis(''.charAt);\nvar exec = uncurryThis(/./.exec);\nvar join = uncurryThis([].join);\nvar numberToString = uncurryThis(1.0.toString);\nvar pop = uncurryThis([].pop);\nvar push = uncurryThis([].push);\nvar replace = uncurryThis(''.replace);\nvar shift = uncurryThis([].shift);\nvar split = uncurryThis(''.split);\nvar stringSlice = uncurryThis(''.slice);\nvar toLowerCase = uncurryThis(''.toLowerCase);\nvar unshift = uncurryThis([].unshift);\n\nvar INVALID_AUTHORITY = 'Invalid authority';\nvar INVALID_SCHEME = 'Invalid scheme';\nvar INVALID_HOST = 'Invalid host';\nvar INVALID_PORT = 'Invalid port';\n\nvar ALPHA = /[a-z]/i;\n// eslint-disable-next-line regexp/no-obscure-range -- safe\nvar ALPHANUMERIC = /[\\d+-.a-z]/i;\nvar DIGIT = /\\d/;\nvar HEX_START = /^0x/i;\nvar OCT = /^[0-7]+$/;\nvar DEC = /^\\d+$/;\nvar HEX = /^[\\da-f]+$/i;\n/* eslint-disable regexp/no-control-character -- safe */\nvar FORBIDDEN_HOST_CODE_POINT = /[\\0\\t\\n\\r #%/:<>?@[\\\\\\]^|]/;\nvar FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT = /[\\0\\t\\n\\r #/:<>?@[\\\\\\]^|]/;\nvar LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE = /^[\\u0000-\\u0020]+|[\\u0000-\\u0020]+$/g;\nvar TAB_AND_NEW_LINE = /[\\t\\n\\r]/g;\n/* eslint-enable regexp/no-control-character -- safe */\nvar EOF;\n\n// https://url.spec.whatwg.org/#ipv4-number-parser\nvar parseIPv4 = function (input) {\n  var parts = split(input, '.');\n  var partsLength, numbers, index, part, radix, number, ipv4;\n  if (parts.length && parts[parts.length - 1] == '') {\n    parts.length--;\n  }\n  partsLength = parts.length;\n  if (partsLength > 4) return input;\n  numbers = [];\n  for (index = 0; index < partsLength; index++) {\n    part = parts[index];\n    if (part == '') return input;\n    radix = 10;\n    if (part.length > 1 && charAt(part, 0) == '0') {\n      radix = exec(HEX_START, part) ? 16 : 8;\n      part = stringSlice(part, radix == 8 ? 1 : 2);\n    }\n    if (part === '') {\n      number = 0;\n    } else {\n      if (!exec(radix == 10 ? DEC : radix == 8 ? OCT : HEX, part)) return input;\n      number = parseInt(part, radix);\n    }\n    push(numbers, number);\n  }\n  for (index = 0; index < partsLength; index++) {\n    number = numbers[index];\n    if (index == partsLength - 1) {\n      if (number >= pow(256, 5 - partsLength)) return null;\n    } else if (number > 255) return null;\n  }\n  ipv4 = pop(numbers);\n  for (index = 0; index < numbers.length; index++) {\n    ipv4 += numbers[index] * pow(256, 3 - index);\n  }\n  return ipv4;\n};\n\n// https://url.spec.whatwg.org/#concept-ipv6-parser\n// eslint-disable-next-line max-statements -- TODO\nvar parseIPv6 = function (input) {\n  var address = [0, 0, 0, 0, 0, 0, 0, 0];\n  var pieceIndex = 0;\n  var compress = null;\n  var pointer = 0;\n  var value, length, numbersSeen, ipv4Piece, number, swaps, swap;\n\n  var chr = function () {\n    return charAt(input, pointer);\n  };\n\n  if (chr() == ':') {\n    if (charAt(input, 1) != ':') return;\n    pointer += 2;\n    pieceIndex++;\n    compress = pieceIndex;\n  }\n  while (chr()) {\n    if (pieceIndex == 8) return;\n    if (chr() == ':') {\n      if (compress !== null) return;\n      pointer++;\n      pieceIndex++;\n      compress = pieceIndex;\n      continue;\n    }\n    value = length = 0;\n    while (length < 4 && exec(HEX, chr())) {\n      value = value * 16 + parseInt(chr(), 16);\n      pointer++;\n      length++;\n    }\n    if (chr() == '.') {\n      if (length == 0) return;\n      pointer -= length;\n      if (pieceIndex > 6) return;\n      numbersSeen = 0;\n      while (chr()) {\n        ipv4Piece = null;\n        if (numbersSeen > 0) {\n          if (chr() == '.' && numbersSeen < 4) pointer++;\n          else return;\n        }\n        if (!exec(DIGIT, chr())) return;\n        while (exec(DIGIT, chr())) {\n          number = parseInt(chr(), 10);\n          if (ipv4Piece === null) ipv4Piece = number;\n          else if (ipv4Piece == 0) return;\n          else ipv4Piece = ipv4Piece * 10 + number;\n          if (ipv4Piece > 255) return;\n          pointer++;\n        }\n        address[pieceIndex] = address[pieceIndex] * 256 + ipv4Piece;\n        numbersSeen++;\n        if (numbersSeen == 2 || numbersSeen == 4) pieceIndex++;\n      }\n      if (numbersSeen != 4) return;\n      break;\n    } else if (chr() == ':') {\n      pointer++;\n      if (!chr()) return;\n    } else if (chr()) return;\n    address[pieceIndex++] = value;\n  }\n  if (compress !== null) {\n    swaps = pieceIndex - compress;\n    pieceIndex = 7;\n    while (pieceIndex != 0 && swaps > 0) {\n      swap = address[pieceIndex];\n      address[pieceIndex--] = address[compress + swaps - 1];\n      address[compress + --swaps] = swap;\n    }\n  } else if (pieceIndex != 8) return;\n  return address;\n};\n\nvar findLongestZeroSequence = function (ipv6) {\n  var maxIndex = null;\n  var maxLength = 1;\n  var currStart = null;\n  var currLength = 0;\n  var index = 0;\n  for (; index < 8; index++) {\n    if (ipv6[index] !== 0) {\n      if (currLength > maxLength) {\n        maxIndex = currStart;\n        maxLength = currLength;\n      }\n      currStart = null;\n      currLength = 0;\n    } else {\n      if (currStart === null) currStart = index;\n      ++currLength;\n    }\n  }\n  if (currLength > maxLength) {\n    maxIndex = currStart;\n    maxLength = currLength;\n  }\n  return maxIndex;\n};\n\n// https://url.spec.whatwg.org/#host-serializing\nvar serializeHost = function (host) {\n  var result, index, compress, ignore0;\n  // ipv4\n  if (typeof host == 'number') {\n    result = [];\n    for (index = 0; index < 4; index++) {\n      unshift(result, host % 256);\n      host = floor(host / 256);\n    } return join(result, '.');\n  // ipv6\n  } else if (typeof host == 'object') {\n    result = '';\n    compress = findLongestZeroSequence(host);\n    for (index = 0; index < 8; index++) {\n      if (ignore0 && host[index] === 0) continue;\n      if (ignore0) ignore0 = false;\n      if (compress === index) {\n        result += index ? ':' : '::';\n        ignore0 = true;\n      } else {\n        result += numberToString(host[index], 16);\n        if (index < 7) result += ':';\n      }\n    }\n    return '[' + result + ']';\n  } return host;\n};\n\nvar C0ControlPercentEncodeSet = {};\nvar fragmentPercentEncodeSet = assign({}, C0ControlPercentEncodeSet, {\n  ' ': 1, '\"': 1, '<': 1, '>': 1, '`': 1\n});\nvar pathPercentEncodeSet = assign({}, fragmentPercentEncodeSet, {\n  '#': 1, '?': 1, '{': 1, '}': 1\n});\nvar userinfoPercentEncodeSet = assign({}, pathPercentEncodeSet, {\n  '/': 1, ':': 1, ';': 1, '=': 1, '@': 1, '[': 1, '\\\\': 1, ']': 1, '^': 1, '|': 1\n});\n\nvar percentEncode = function (chr, set) {\n  var code = codeAt(chr, 0);\n  return code > 0x20 && code < 0x7F && !hasOwn(set, chr) ? chr : encodeURIComponent(chr);\n};\n\n// https://url.spec.whatwg.org/#special-scheme\nvar specialSchemes = {\n  ftp: 21,\n  file: null,\n  http: 80,\n  https: 443,\n  ws: 80,\n  wss: 443\n};\n\n// https://url.spec.whatwg.org/#windows-drive-letter\nvar isWindowsDriveLetter = function (string, normalized) {\n  var second;\n  return string.length == 2 && exec(ALPHA, charAt(string, 0))\n    && ((second = charAt(string, 1)) == ':' || (!normalized && second == '|'));\n};\n\n// https://url.spec.whatwg.org/#start-with-a-windows-drive-letter\nvar startsWithWindowsDriveLetter = function (string) {\n  var third;\n  return string.length > 1 && isWindowsDriveLetter(stringSlice(string, 0, 2)) && (\n    string.length == 2 ||\n    ((third = charAt(string, 2)) === '/' || third === '\\\\' || third === '?' || third === '#')\n  );\n};\n\n// https://url.spec.whatwg.org/#single-dot-path-segment\nvar isSingleDot = function (segment) {\n  return segment === '.' || toLowerCase(segment) === '%2e';\n};\n\n// https://url.spec.whatwg.org/#double-dot-path-segment\nvar isDoubleDot = function (segment) {\n  segment = toLowerCase(segment);\n  return segment === '..' || segment === '%2e.' || segment === '.%2e' || segment === '%2e%2e';\n};\n\n// States:\nvar SCHEME_START = {};\nvar SCHEME = {};\nvar NO_SCHEME = {};\nvar SPECIAL_RELATIVE_OR_AUTHORITY = {};\nvar PATH_OR_AUTHORITY = {};\nvar RELATIVE = {};\nvar RELATIVE_SLASH = {};\nvar SPECIAL_AUTHORITY_SLASHES = {};\nvar SPECIAL_AUTHORITY_IGNORE_SLASHES = {};\nvar AUTHORITY = {};\nvar HOST = {};\nvar HOSTNAME = {};\nvar PORT = {};\nvar FILE = {};\nvar FILE_SLASH = {};\nvar FILE_HOST = {};\nvar PATH_START = {};\nvar PATH = {};\nvar CANNOT_BE_A_BASE_URL_PATH = {};\nvar QUERY = {};\nvar FRAGMENT = {};\n\nvar URLState = function (url, isBase, base) {\n  var urlString = $toString(url);\n  var baseState, failure, searchParams;\n  if (isBase) {\n    failure = this.parse(urlString);\n    if (failure) throw TypeError(failure);\n    this.searchParams = null;\n  } else {\n    if (base !== undefined) baseState = new URLState(base, true);\n    failure = this.parse(urlString, null, baseState);\n    if (failure) throw TypeError(failure);\n    searchParams = getInternalSearchParamsState(new URLSearchParams());\n    searchParams.bindURL(this);\n    this.searchParams = searchParams;\n  }\n};\n\nURLState.prototype = {\n  type: 'URL',\n  // https://url.spec.whatwg.org/#url-parsing\n  // eslint-disable-next-line max-statements -- TODO\n  parse: function (input, stateOverride, base) {\n    var url = this;\n    var state = stateOverride || SCHEME_START;\n    var pointer = 0;\n    var buffer = '';\n    var seenAt = false;\n    var seenBracket = false;\n    var seenPasswordToken = false;\n    var codePoints, chr, bufferCodePoints, failure;\n\n    input = $toString(input);\n\n    if (!stateOverride) {\n      url.scheme = '';\n      url.username = '';\n      url.password = '';\n      url.host = null;\n      url.port = null;\n      url.path = [];\n      url.query = null;\n      url.fragment = null;\n      url.cannotBeABaseURL = false;\n      input = replace(input, LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE, '');\n    }\n\n    input = replace(input, TAB_AND_NEW_LINE, '');\n\n    codePoints = arrayFrom(input);\n\n    while (pointer <= codePoints.length) {\n      chr = codePoints[pointer];\n      switch (state) {\n        case SCHEME_START:\n          if (chr && exec(ALPHA, chr)) {\n            buffer += toLowerCase(chr);\n            state = SCHEME;\n          } else if (!stateOverride) {\n            state = NO_SCHEME;\n            continue;\n          } else return INVALID_SCHEME;\n          break;\n\n        case SCHEME:\n          if (chr && (exec(ALPHANUMERIC, chr) || chr == '+' || chr == '-' || chr == '.')) {\n            buffer += toLowerCase(chr);\n          } else if (chr == ':') {\n            if (stateOverride && (\n              (url.isSpecial() != hasOwn(specialSchemes, buffer)) ||\n              (buffer == 'file' && (url.includesCredentials() || url.port !== null)) ||\n              (url.scheme == 'file' && !url.host)\n            )) return;\n            url.scheme = buffer;\n            if (stateOverride) {\n              if (url.isSpecial() && specialSchemes[url.scheme] == url.port) url.port = null;\n              return;\n            }\n            buffer = '';\n            if (url.scheme == 'file') {\n              state = FILE;\n            } else if (url.isSpecial() && base && base.scheme == url.scheme) {\n              state = SPECIAL_RELATIVE_OR_AUTHORITY;\n            } else if (url.isSpecial()) {\n              state = SPECIAL_AUTHORITY_SLASHES;\n            } else if (codePoints[pointer + 1] == '/') {\n              state = PATH_OR_AUTHORITY;\n              pointer++;\n            } else {\n              url.cannotBeABaseURL = true;\n              push(url.path, '');\n              state = CANNOT_BE_A_BASE_URL_PATH;\n            }\n          } else if (!stateOverride) {\n            buffer = '';\n            state = NO_SCHEME;\n            pointer = 0;\n            continue;\n          } else return INVALID_SCHEME;\n          break;\n\n        case NO_SCHEME:\n          if (!base || (base.cannotBeABaseURL && chr != '#')) return INVALID_SCHEME;\n          if (base.cannotBeABaseURL && chr == '#') {\n            url.scheme = base.scheme;\n            url.path = arraySlice(base.path);\n            url.query = base.query;\n            url.fragment = '';\n            url.cannotBeABaseURL = true;\n            state = FRAGMENT;\n            break;\n          }\n          state = base.scheme == 'file' ? FILE : RELATIVE;\n          continue;\n\n        case SPECIAL_RELATIVE_OR_AUTHORITY:\n          if (chr == '/' && codePoints[pointer + 1] == '/') {\n            state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n            pointer++;\n          } else {\n            state = RELATIVE;\n            continue;\n          } break;\n\n        case PATH_OR_AUTHORITY:\n          if (chr == '/') {\n            state = AUTHORITY;\n            break;\n          } else {\n            state = PATH;\n            continue;\n          }\n\n        case RELATIVE:\n          url.scheme = base.scheme;\n          if (chr == EOF) {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            url.path = arraySlice(base.path);\n            url.query = base.query;\n          } else if (chr == '/' || (chr == '\\\\' && url.isSpecial())) {\n            state = RELATIVE_SLASH;\n          } else if (chr == '?') {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            url.path = arraySlice(base.path);\n            url.query = '';\n            state = QUERY;\n          } else if (chr == '#') {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            url.path = arraySlice(base.path);\n            url.query = base.query;\n            url.fragment = '';\n            state = FRAGMENT;\n          } else {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            url.path = arraySlice(base.path);\n            url.path.length--;\n            state = PATH;\n            continue;\n          } break;\n\n        case RELATIVE_SLASH:\n          if (url.isSpecial() && (chr == '/' || chr == '\\\\')) {\n            state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n          } else if (chr == '/') {\n            state = AUTHORITY;\n          } else {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            state = PATH;\n            continue;\n          } break;\n\n        case SPECIAL_AUTHORITY_SLASHES:\n          state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n          if (chr != '/' || charAt(buffer, pointer + 1) != '/') continue;\n          pointer++;\n          break;\n\n        case SPECIAL_AUTHORITY_IGNORE_SLASHES:\n          if (chr != '/' && chr != '\\\\') {\n            state = AUTHORITY;\n            continue;\n          } break;\n\n        case AUTHORITY:\n          if (chr == '@') {\n            if (seenAt) buffer = '%40' + buffer;\n            seenAt = true;\n            bufferCodePoints = arrayFrom(buffer);\n            for (var i = 0; i < bufferCodePoints.length; i++) {\n              var codePoint = bufferCodePoints[i];\n              if (codePoint == ':' && !seenPasswordToken) {\n                seenPasswordToken = true;\n                continue;\n              }\n              var encodedCodePoints = percentEncode(codePoint, userinfoPercentEncodeSet);\n              if (seenPasswordToken) url.password += encodedCodePoints;\n              else url.username += encodedCodePoints;\n            }\n            buffer = '';\n          } else if (\n            chr == EOF || chr == '/' || chr == '?' || chr == '#' ||\n            (chr == '\\\\' && url.isSpecial())\n          ) {\n            if (seenAt && buffer == '') return INVALID_AUTHORITY;\n            pointer -= arrayFrom(buffer).length + 1;\n            buffer = '';\n            state = HOST;\n          } else buffer += chr;\n          break;\n\n        case HOST:\n        case HOSTNAME:\n          if (stateOverride && url.scheme == 'file') {\n            state = FILE_HOST;\n            continue;\n          } else if (chr == ':' && !seenBracket) {\n            if (buffer == '') return INVALID_HOST;\n            failure = url.parseHost(buffer);\n            if (failure) return failure;\n            buffer = '';\n            state = PORT;\n            if (stateOverride == HOSTNAME) return;\n          } else if (\n            chr == EOF || chr == '/' || chr == '?' || chr == '#' ||\n            (chr == '\\\\' && url.isSpecial())\n          ) {\n            if (url.isSpecial() && buffer == '') return INVALID_HOST;\n            if (stateOverride && buffer == '' && (url.includesCredentials() || url.port !== null)) return;\n            failure = url.parseHost(buffer);\n            if (failure) return failure;\n            buffer = '';\n            state = PATH_START;\n            if (stateOverride) return;\n            continue;\n          } else {\n            if (chr == '[') seenBracket = true;\n            else if (chr == ']') seenBracket = false;\n            buffer += chr;\n          } break;\n\n        case PORT:\n          if (exec(DIGIT, chr)) {\n            buffer += chr;\n          } else if (\n            chr == EOF || chr == '/' || chr == '?' || chr == '#' ||\n            (chr == '\\\\' && url.isSpecial()) ||\n            stateOverride\n          ) {\n            if (buffer != '') {\n              var port = parseInt(buffer, 10);\n              if (port > 0xFFFF) return INVALID_PORT;\n              url.port = (url.isSpecial() && port === specialSchemes[url.scheme]) ? null : port;\n              buffer = '';\n            }\n            if (stateOverride) return;\n            state = PATH_START;\n            continue;\n          } else return INVALID_PORT;\n          break;\n\n        case FILE:\n          url.scheme = 'file';\n          if (chr == '/' || chr == '\\\\') state = FILE_SLASH;\n          else if (base && base.scheme == 'file') {\n            if (chr == EOF) {\n              url.host = base.host;\n              url.path = arraySlice(base.path);\n              url.query = base.query;\n            } else if (chr == '?') {\n              url.host = base.host;\n              url.path = arraySlice(base.path);\n              url.query = '';\n              state = QUERY;\n            } else if (chr == '#') {\n              url.host = base.host;\n              url.path = arraySlice(base.path);\n              url.query = base.query;\n              url.fragment = '';\n              state = FRAGMENT;\n            } else {\n              if (!startsWithWindowsDriveLetter(join(arraySlice(codePoints, pointer), ''))) {\n                url.host = base.host;\n                url.path = arraySlice(base.path);\n                url.shortenPath();\n              }\n              state = PATH;\n              continue;\n            }\n          } else {\n            state = PATH;\n            continue;\n          } break;\n\n        case FILE_SLASH:\n          if (chr == '/' || chr == '\\\\') {\n            state = FILE_HOST;\n            break;\n          }\n          if (base && base.scheme == 'file' && !startsWithWindowsDriveLetter(join(arraySlice(codePoints, pointer), ''))) {\n            if (isWindowsDriveLetter(base.path[0], true)) push(url.path, base.path[0]);\n            else url.host = base.host;\n          }\n          state = PATH;\n          continue;\n\n        case FILE_HOST:\n          if (chr == EOF || chr == '/' || chr == '\\\\' || chr == '?' || chr == '#') {\n            if (!stateOverride && isWindowsDriveLetter(buffer)) {\n              state = PATH;\n            } else if (buffer == '') {\n              url.host = '';\n              if (stateOverride) return;\n              state = PATH_START;\n            } else {\n              failure = url.parseHost(buffer);\n              if (failure) return failure;\n              if (url.host == 'localhost') url.host = '';\n              if (stateOverride) return;\n              buffer = '';\n              state = PATH_START;\n            } continue;\n          } else buffer += chr;\n          break;\n\n        case PATH_START:\n          if (url.isSpecial()) {\n            state = PATH;\n            if (chr != '/' && chr != '\\\\') continue;\n          } else if (!stateOverride && chr == '?') {\n            url.query = '';\n            state = QUERY;\n          } else if (!stateOverride && chr == '#') {\n            url.fragment = '';\n            state = FRAGMENT;\n          } else if (chr != EOF) {\n            state = PATH;\n            if (chr != '/') continue;\n          } break;\n\n        case PATH:\n          if (\n            chr == EOF || chr == '/' ||\n            (chr == '\\\\' && url.isSpecial()) ||\n            (!stateOverride && (chr == '?' || chr == '#'))\n          ) {\n            if (isDoubleDot(buffer)) {\n              url.shortenPath();\n              if (chr != '/' && !(chr == '\\\\' && url.isSpecial())) {\n                push(url.path, '');\n              }\n            } else if (isSingleDot(buffer)) {\n              if (chr != '/' && !(chr == '\\\\' && url.isSpecial())) {\n                push(url.path, '');\n              }\n            } else {\n              if (url.scheme == 'file' && !url.path.length && isWindowsDriveLetter(buffer)) {\n                if (url.host) url.host = '';\n                buffer = charAt(buffer, 0) + ':'; // normalize windows drive letter\n              }\n              push(url.path, buffer);\n            }\n            buffer = '';\n            if (url.scheme == 'file' && (chr == EOF || chr == '?' || chr == '#')) {\n              while (url.path.length > 1 && url.path[0] === '') {\n                shift(url.path);\n              }\n            }\n            if (chr == '?') {\n              url.query = '';\n              state = QUERY;\n            } else if (chr == '#') {\n              url.fragment = '';\n              state = FRAGMENT;\n            }\n          } else {\n            buffer += percentEncode(chr, pathPercentEncodeSet);\n          } break;\n\n        case CANNOT_BE_A_BASE_URL_PATH:\n          if (chr == '?') {\n            url.query = '';\n            state = QUERY;\n          } else if (chr == '#') {\n            url.fragment = '';\n            state = FRAGMENT;\n          } else if (chr != EOF) {\n            url.path[0] += percentEncode(chr, C0ControlPercentEncodeSet);\n          } break;\n\n        case QUERY:\n          if (!stateOverride && chr == '#') {\n            url.fragment = '';\n            state = FRAGMENT;\n          } else if (chr != EOF) {\n            if (chr == \"'\" && url.isSpecial()) url.query += '%27';\n            else if (chr == '#') url.query += '%23';\n            else url.query += percentEncode(chr, C0ControlPercentEncodeSet);\n          } break;\n\n        case FRAGMENT:\n          if (chr != EOF) url.fragment += percentEncode(chr, fragmentPercentEncodeSet);\n          break;\n      }\n\n      pointer++;\n    }\n  },\n  // https://url.spec.whatwg.org/#host-parsing\n  parseHost: function (input) {\n    var result, codePoints, index;\n    if (charAt(input, 0) == '[') {\n      if (charAt(input, input.length - 1) != ']') return INVALID_HOST;\n      result = parseIPv6(stringSlice(input, 1, -1));\n      if (!result) return INVALID_HOST;\n      this.host = result;\n    // opaque host\n    } else if (!this.isSpecial()) {\n      if (exec(FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT, input)) return INVALID_HOST;\n      result = '';\n      codePoints = arrayFrom(input);\n      for (index = 0; index < codePoints.length; index++) {\n        result += percentEncode(codePoints[index], C0ControlPercentEncodeSet);\n      }\n      this.host = result;\n    } else {\n      input = toASCII(input);\n      if (exec(FORBIDDEN_HOST_CODE_POINT, input)) return INVALID_HOST;\n      result = parseIPv4(input);\n      if (result === null) return INVALID_HOST;\n      this.host = result;\n    }\n  },\n  // https://url.spec.whatwg.org/#cannot-have-a-username-password-port\n  cannotHaveUsernamePasswordPort: function () {\n    return !this.host || this.cannotBeABaseURL || this.scheme == 'file';\n  },\n  // https://url.spec.whatwg.org/#include-credentials\n  includesCredentials: function () {\n    return this.username != '' || this.password != '';\n  },\n  // https://url.spec.whatwg.org/#is-special\n  isSpecial: function () {\n    return hasOwn(specialSchemes, this.scheme);\n  },\n  // https://url.spec.whatwg.org/#shorten-a-urls-path\n  shortenPath: function () {\n    var path = this.path;\n    var pathSize = path.length;\n    if (pathSize && (this.scheme != 'file' || pathSize != 1 || !isWindowsDriveLetter(path[0], true))) {\n      path.length--;\n    }\n  },\n  // https://url.spec.whatwg.org/#concept-url-serializer\n  serialize: function () {\n    var url = this;\n    var scheme = url.scheme;\n    var username = url.username;\n    var password = url.password;\n    var host = url.host;\n    var port = url.port;\n    var path = url.path;\n    var query = url.query;\n    var fragment = url.fragment;\n    var output = scheme + ':';\n    if (host !== null) {\n      output += '//';\n      if (url.includesCredentials()) {\n        output += username + (password ? ':' + password : '') + '@';\n      }\n      output += serializeHost(host);\n      if (port !== null) output += ':' + port;\n    } else if (scheme == 'file') output += '//';\n    output += url.cannotBeABaseURL ? path[0] : path.length ? '/' + join(path, '/') : '';\n    if (query !== null) output += '?' + query;\n    if (fragment !== null) output += '#' + fragment;\n    return output;\n  },\n  // https://url.spec.whatwg.org/#dom-url-href\n  setHref: function (href) {\n    var failure = this.parse(href);\n    if (failure) throw TypeError(failure);\n    this.searchParams.update();\n  },\n  // https://url.spec.whatwg.org/#dom-url-origin\n  getOrigin: function () {\n    var scheme = this.scheme;\n    var port = this.port;\n    if (scheme == 'blob') try {\n      return new URLConstructor(scheme.path[0]).origin;\n    } catch (error) {\n      return 'null';\n    }\n    if (scheme == 'file' || !this.isSpecial()) return 'null';\n    return scheme + '://' + serializeHost(this.host) + (port !== null ? ':' + port : '');\n  },\n  // https://url.spec.whatwg.org/#dom-url-protocol\n  getProtocol: function () {\n    return this.scheme + ':';\n  },\n  setProtocol: function (protocol) {\n    this.parse($toString(protocol) + ':', SCHEME_START);\n  },\n  // https://url.spec.whatwg.org/#dom-url-username\n  getUsername: function () {\n    return this.username;\n  },\n  setUsername: function (username) {\n    var codePoints = arrayFrom($toString(username));\n    if (this.cannotHaveUsernamePasswordPort()) return;\n    this.username = '';\n    for (var i = 0; i < codePoints.length; i++) {\n      this.username += percentEncode(codePoints[i], userinfoPercentEncodeSet);\n    }\n  },\n  // https://url.spec.whatwg.org/#dom-url-password\n  getPassword: function () {\n    return this.password;\n  },\n  setPassword: function (password) {\n    var codePoints = arrayFrom($toString(password));\n    if (this.cannotHaveUsernamePasswordPort()) return;\n    this.password = '';\n    for (var i = 0; i < codePoints.length; i++) {\n      this.password += percentEncode(codePoints[i], userinfoPercentEncodeSet);\n    }\n  },\n  // https://url.spec.whatwg.org/#dom-url-host\n  getHost: function () {\n    var host = this.host;\n    var port = this.port;\n    return host === null ? ''\n      : port === null ? serializeHost(host)\n      : serializeHost(host) + ':' + port;\n  },\n  setHost: function (host) {\n    if (this.cannotBeABaseURL) return;\n    this.parse(host, HOST);\n  },\n  // https://url.spec.whatwg.org/#dom-url-hostname\n  getHostname: function () {\n    var host = this.host;\n    return host === null ? '' : serializeHost(host);\n  },\n  setHostname: function (hostname) {\n    if (this.cannotBeABaseURL) return;\n    this.parse(hostname, HOSTNAME);\n  },\n  // https://url.spec.whatwg.org/#dom-url-port\n  getPort: function () {\n    var port = this.port;\n    return port === null ? '' : $toString(port);\n  },\n  setPort: function (port) {\n    if (this.cannotHaveUsernamePasswordPort()) return;\n    port = $toString(port);\n    if (port == '') this.port = null;\n    else this.parse(port, PORT);\n  },\n  // https://url.spec.whatwg.org/#dom-url-pathname\n  getPathname: function () {\n    var path = this.path;\n    return this.cannotBeABaseURL ? path[0] : path.length ? '/' + join(path, '/') : '';\n  },\n  setPathname: function (pathname) {\n    if (this.cannotBeABaseURL) return;\n    this.path = [];\n    this.parse(pathname, PATH_START);\n  },\n  // https://url.spec.whatwg.org/#dom-url-search\n  getSearch: function () {\n    var query = this.query;\n    return query ? '?' + query : '';\n  },\n  setSearch: function (search) {\n    search = $toString(search);\n    if (search == '') {\n      this.query = null;\n    } else {\n      if ('?' == charAt(search, 0)) search = stringSlice(search, 1);\n      this.query = '';\n      this.parse(search, QUERY);\n    }\n    this.searchParams.update();\n  },\n  // https://url.spec.whatwg.org/#dom-url-searchparams\n  getSearchParams: function () {\n    return this.searchParams.facade;\n  },\n  // https://url.spec.whatwg.org/#dom-url-hash\n  getHash: function () {\n    var fragment = this.fragment;\n    return fragment ? '#' + fragment : '';\n  },\n  setHash: function (hash) {\n    hash = $toString(hash);\n    if (hash == '') {\n      this.fragment = null;\n      return;\n    }\n    if ('#' == charAt(hash, 0)) hash = stringSlice(hash, 1);\n    this.fragment = '';\n    this.parse(hash, FRAGMENT);\n  },\n  update: function () {\n    this.query = this.searchParams.serialize() || null;\n  }\n};\n\n// `URL` constructor\n// https://url.spec.whatwg.org/#url-class\nvar URLConstructor = function URL(url /* , base */) {\n  var that = anInstance(this, URLPrototype);\n  var base = arguments.length > 1 ? arguments[1] : undefined;\n  var state = setInternalState(that, new URLState(url, false, base));\n  if (!DESCRIPTORS) {\n    that.href = state.serialize();\n    that.origin = state.getOrigin();\n    that.protocol = state.getProtocol();\n    that.username = state.getUsername();\n    that.password = state.getPassword();\n    that.host = state.getHost();\n    that.hostname = state.getHostname();\n    that.port = state.getPort();\n    that.pathname = state.getPathname();\n    that.search = state.getSearch();\n    that.searchParams = state.getSearchParams();\n    that.hash = state.getHash();\n  }\n};\n\nvar URLPrototype = URLConstructor.prototype;\n\nvar accessorDescriptor = function (getter, setter) {\n  return {\n    get: function () {\n      return getInternalURLState(this)[getter]();\n    },\n    set: setter && function (value) {\n      return getInternalURLState(this)[setter](value);\n    },\n    configurable: true,\n    enumerable: true\n  };\n};\n\nif (DESCRIPTORS) {\n  defineProperties(URLPrototype, {\n    // `URL.prototype.href` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-href\n    href: accessorDescriptor('serialize', 'setHref'),\n    // `URL.prototype.origin` getter\n    // https://url.spec.whatwg.org/#dom-url-origin\n    origin: accessorDescriptor('getOrigin'),\n    // `URL.prototype.protocol` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-protocol\n    protocol: accessorDescriptor('getProtocol', 'setProtocol'),\n    // `URL.prototype.username` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-username\n    username: accessorDescriptor('getUsername', 'setUsername'),\n    // `URL.prototype.password` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-password\n    password: accessorDescriptor('getPassword', 'setPassword'),\n    // `URL.prototype.host` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-host\n    host: accessorDescriptor('getHost', 'setHost'),\n    // `URL.prototype.hostname` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-hostname\n    hostname: accessorDescriptor('getHostname', 'setHostname'),\n    // `URL.prototype.port` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-port\n    port: accessorDescriptor('getPort', 'setPort'),\n    // `URL.prototype.pathname` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-pathname\n    pathname: accessorDescriptor('getPathname', 'setPathname'),\n    // `URL.prototype.search` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-search\n    search: accessorDescriptor('getSearch', 'setSearch'),\n    // `URL.prototype.searchParams` getter\n    // https://url.spec.whatwg.org/#dom-url-searchparams\n    searchParams: accessorDescriptor('getSearchParams'),\n    // `URL.prototype.hash` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-hash\n    hash: accessorDescriptor('getHash', 'setHash')\n  });\n}\n\n// `URL.prototype.toJSON` method\n// https://url.spec.whatwg.org/#dom-url-tojson\nredefine(URLPrototype, 'toJSON', function toJSON() {\n  return getInternalURLState(this).serialize();\n}, { enumerable: true });\n\n// `URL.prototype.toString` method\n// https://url.spec.whatwg.org/#URL-stringification-behavior\nredefine(URLPrototype, 'toString', function toString() {\n  return getInternalURLState(this).serialize();\n}, { enumerable: true });\n\nif (NativeURL) {\n  var nativeCreateObjectURL = NativeURL.createObjectURL;\n  var nativeRevokeObjectURL = NativeURL.revokeObjectURL;\n  // `URL.createObjectURL` method\n  // https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL\n  if (nativeCreateObjectURL) redefine(URLConstructor, 'createObjectURL', bind(nativeCreateObjectURL, NativeURL));\n  // `URL.revokeObjectURL` method\n  // https://developer.mozilla.org/en-US/docs/Web/API/URL/revokeObjectURL\n  if (nativeRevokeObjectURL) redefine(URLConstructor, 'revokeObjectURL', bind(nativeRevokeObjectURL, NativeURL));\n}\n\nsetToStringTag(URLConstructor, 'URL');\n\n$({ global: true, forced: !USE_NATIVE_URL, sham: !DESCRIPTORS }, {\n  URL: URLConstructor\n});\n","var fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar ITERATOR = wellKnownSymbol('iterator');\n\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line unicorn/relative-url-style -- required for testing\n  var url = new URL('b?a=1&b=2&c=3', 'http://a');\n  var searchParams = url.searchParams;\n  var result = '';\n  url.pathname = 'c%20d';\n  searchParams.forEach(function (value, key) {\n    searchParams['delete']('b');\n    result += key + value;\n  });\n  return (IS_PURE && !url.toJSON)\n    || !searchParams.sort\n    || url.href !== 'http://a/c%20d?a=1&c=3'\n    || searchParams.get('c') !== '3'\n    || String(new URLSearchParams('?a=1')) !== 'a=1'\n    || !searchParams[ITERATOR]\n    // throws in Edge\n    || new URL('https://a@b').username !== 'a'\n    || new URLSearchParams(new URLSearchParams('a=b')).get('a') !== 'b'\n    // not punycoded in Edge\n    || new URL('http://тест').host !== 'xn--e1aybc'\n    // not escaped in Chrome 62-\n    || new URL('http://a#б').hash !== '#%D0%B1'\n    // fails in Chrome 66-\n    || result !== 'a1c3'\n    // throws in Safari\n    || new URL('http://x', undefined).host !== 'x';\n});\n","'use strict';\n// based on https://github.com/bestiejs/punycode.js/blob/master/punycode.js\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nvar maxInt = 2147483647; // aka. 0x7FFFFFFF or 2^31-1\nvar base = 36;\nvar tMin = 1;\nvar tMax = 26;\nvar skew = 38;\nvar damp = 700;\nvar initialBias = 72;\nvar initialN = 128; // 0x80\nvar delimiter = '-'; // '\\x2D'\nvar regexNonASCII = /[^\\0-\\u007E]/; // non-ASCII chars\nvar regexSeparators = /[.\\u3002\\uFF0E\\uFF61]/g; // RFC 3490 separators\nvar OVERFLOW_ERROR = 'Overflow: input needs wider integers to process';\nvar baseMinusTMin = base - tMin;\n\nvar RangeError = global.RangeError;\nvar exec = uncurryThis(regexSeparators.exec);\nvar floor = Math.floor;\nvar fromCharCode = String.fromCharCode;\nvar charCodeAt = uncurryThis(''.charCodeAt);\nvar join = uncurryThis([].join);\nvar push = uncurryThis([].push);\nvar replace = uncurryThis(''.replace);\nvar split = uncurryThis(''.split);\nvar toLowerCase = uncurryThis(''.toLowerCase);\n\n/**\n * Creates an array containing the numeric code points of each Unicode\n * character in the string. While JavaScript uses UCS-2 internally,\n * this function will convert a pair of surrogate halves (each of which\n * UCS-2 exposes as separate characters) into a single code point,\n * matching UTF-16.\n */\nvar ucs2decode = function (string) {\n  var output = [];\n  var counter = 0;\n  var length = string.length;\n  while (counter < length) {\n    var value = charCodeAt(string, counter++);\n    if (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n      // It's a high surrogate, and there is a next character.\n      var extra = charCodeAt(string, counter++);\n      if ((extra & 0xFC00) == 0xDC00) { // Low surrogate.\n        push(output, ((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n      } else {\n        // It's an unmatched surrogate; only append this code unit, in case the\n        // next code unit is the high surrogate of a surrogate pair.\n        push(output, value);\n        counter--;\n      }\n    } else {\n      push(output, value);\n    }\n  }\n  return output;\n};\n\n/**\n * Converts a digit/integer into a basic code point.\n */\nvar digitToBasic = function (digit) {\n  //  0..25 map to ASCII a..z or A..Z\n  // 26..35 map to ASCII 0..9\n  return digit + 22 + 75 * (digit < 26);\n};\n\n/**\n * Bias adaptation function as per section 3.4 of RFC 3492.\n * https://tools.ietf.org/html/rfc3492#section-3.4\n */\nvar adapt = function (delta, numPoints, firstTime) {\n  var k = 0;\n  delta = firstTime ? floor(delta / damp) : delta >> 1;\n  delta += floor(delta / numPoints);\n  while (delta > baseMinusTMin * tMax >> 1) {\n    delta = floor(delta / baseMinusTMin);\n    k += base;\n  }\n  return floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n};\n\n/**\n * Converts a string of Unicode symbols (e.g. a domain name label) to a\n * Punycode string of ASCII-only symbols.\n */\nvar encode = function (input) {\n  var output = [];\n\n  // Convert the input in UCS-2 to an array of Unicode code points.\n  input = ucs2decode(input);\n\n  // Cache the length.\n  var inputLength = input.length;\n\n  // Initialize the state.\n  var n = initialN;\n  var delta = 0;\n  var bias = initialBias;\n  var i, currentValue;\n\n  // Handle the basic code points.\n  for (i = 0; i < input.length; i++) {\n    currentValue = input[i];\n    if (currentValue < 0x80) {\n      push(output, fromCharCode(currentValue));\n    }\n  }\n\n  var basicLength = output.length; // number of basic code points.\n  var handledCPCount = basicLength; // number of code points that have been handled;\n\n  // Finish the basic string with a delimiter unless it's empty.\n  if (basicLength) {\n    push(output, delimiter);\n  }\n\n  // Main encoding loop:\n  while (handledCPCount < inputLength) {\n    // All non-basic code points < n have been handled already. Find the next larger one:\n    var m = maxInt;\n    for (i = 0; i < input.length; i++) {\n      currentValue = input[i];\n      if (currentValue >= n && currentValue < m) {\n        m = currentValue;\n      }\n    }\n\n    // Increase `delta` enough to advance the decoder's <n,i> state to <m,0>, but guard against overflow.\n    var handledCPCountPlusOne = handledCPCount + 1;\n    if (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n      throw RangeError(OVERFLOW_ERROR);\n    }\n\n    delta += (m - n) * handledCPCountPlusOne;\n    n = m;\n\n    for (i = 0; i < input.length; i++) {\n      currentValue = input[i];\n      if (currentValue < n && ++delta > maxInt) {\n        throw RangeError(OVERFLOW_ERROR);\n      }\n      if (currentValue == n) {\n        // Represent delta as a generalized variable-length integer.\n        var q = delta;\n        var k = base;\n        while (true) {\n          var t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n          if (q < t) break;\n          var qMinusT = q - t;\n          var baseMinusT = base - t;\n          push(output, fromCharCode(digitToBasic(t + qMinusT % baseMinusT)));\n          q = floor(qMinusT / baseMinusT);\n          k += base;\n        }\n\n        push(output, fromCharCode(digitToBasic(q)));\n        bias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n        delta = 0;\n        handledCPCount++;\n      }\n    }\n\n    delta++;\n    n++;\n  }\n  return join(output, '');\n};\n\nmodule.exports = function (input) {\n  var encoded = [];\n  var labels = split(replace(toLowerCase(input), regexSeparators, '\\u002E'), '.');\n  var i, label;\n  for (i = 0; i < labels.length; i++) {\n    label = labels[i];\n    push(encoded, exec(regexNonASCII, label) ? 'xn--' + encode(label) : label);\n  }\n  return join(encoded, '.');\n};\n","'use strict';\n// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.array.iterator');\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar USE_NATIVE_URL = require('../internals/native-url');\nvar redefine = require('../internals/redefine');\nvar redefineAll = require('../internals/redefine-all');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar InternalStateModule = require('../internals/internal-state');\nvar anInstance = require('../internals/an-instance');\nvar isCallable = require('../internals/is-callable');\nvar hasOwn = require('../internals/has-own-property');\nvar bind = require('../internals/function-bind-context');\nvar classof = require('../internals/classof');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar $toString = require('../internals/to-string');\nvar create = require('../internals/object-create');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar validateArgumentsLength = require('../internals/validate-arguments-length');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar arraySort = require('../internals/array-sort');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar URL_SEARCH_PARAMS = 'URLSearchParams';\nvar URL_SEARCH_PARAMS_ITERATOR = URL_SEARCH_PARAMS + 'Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalParamsState = InternalStateModule.getterFor(URL_SEARCH_PARAMS);\nvar getInternalIteratorState = InternalStateModule.getterFor(URL_SEARCH_PARAMS_ITERATOR);\n\nvar n$Fetch = getBuiltIn('fetch');\nvar N$Request = getBuiltIn('Request');\nvar Headers = getBuiltIn('Headers');\nvar RequestPrototype = N$Request && N$Request.prototype;\nvar HeadersPrototype = Headers && Headers.prototype;\nvar RegExp = global.RegExp;\nvar TypeError = global.TypeError;\nvar decodeURIComponent = global.decodeURIComponent;\nvar encodeURIComponent = global.encodeURIComponent;\nvar charAt = uncurryThis(''.charAt);\nvar join = uncurryThis([].join);\nvar push = uncurryThis([].push);\nvar replace = uncurryThis(''.replace);\nvar shift = uncurryThis([].shift);\nvar splice = uncurryThis([].splice);\nvar split = uncurryThis(''.split);\nvar stringSlice = uncurryThis(''.slice);\n\nvar plus = /\\+/g;\nvar sequences = Array(4);\n\nvar percentSequence = function (bytes) {\n  return sequences[bytes - 1] || (sequences[bytes - 1] = RegExp('((?:%[\\\\da-f]{2}){' + bytes + '})', 'gi'));\n};\n\nvar percentDecode = function (sequence) {\n  try {\n    return decodeURIComponent(sequence);\n  } catch (error) {\n    return sequence;\n  }\n};\n\nvar deserialize = function (it) {\n  var result = replace(it, plus, ' ');\n  var bytes = 4;\n  try {\n    return decodeURIComponent(result);\n  } catch (error) {\n    while (bytes) {\n      result = replace(result, percentSequence(bytes--), percentDecode);\n    }\n    return result;\n  }\n};\n\nvar find = /[!'()~]|%20/g;\n\nvar replacements = {\n  '!': '%21',\n  \"'\": '%27',\n  '(': '%28',\n  ')': '%29',\n  '~': '%7E',\n  '%20': '+'\n};\n\nvar replacer = function (match) {\n  return replacements[match];\n};\n\nvar serialize = function (it) {\n  return replace(encodeURIComponent(it), find, replacer);\n};\n\nvar URLSearchParamsIterator = createIteratorConstructor(function Iterator(params, kind) {\n  setInternalState(this, {\n    type: URL_SEARCH_PARAMS_ITERATOR,\n    iterator: getIterator(getInternalParamsState(params).entries),\n    kind: kind\n  });\n}, 'Iterator', function next() {\n  var state = getInternalIteratorState(this);\n  var kind = state.kind;\n  var step = state.iterator.next();\n  var entry = step.value;\n  if (!step.done) {\n    step.value = kind === 'keys' ? entry.key : kind === 'values' ? entry.value : [entry.key, entry.value];\n  } return step;\n}, true);\n\nvar URLSearchParamsState = function (init) {\n  this.entries = [];\n  this.url = null;\n\n  if (init !== undefined) {\n    if (isObject(init)) this.parseObject(init);\n    else this.parseQuery(typeof init == 'string' ? charAt(init, 0) === '?' ? stringSlice(init, 1) : init : $toString(init));\n  }\n};\n\nURLSearchParamsState.prototype = {\n  type: URL_SEARCH_PARAMS,\n  bindURL: function (url) {\n    this.url = url;\n    this.update();\n  },\n  parseObject: function (object) {\n    var iteratorMethod = getIteratorMethod(object);\n    var iterator, next, step, entryIterator, entryNext, first, second;\n\n    if (iteratorMethod) {\n      iterator = getIterator(object, iteratorMethod);\n      next = iterator.next;\n      while (!(step = call(next, iterator)).done) {\n        entryIterator = getIterator(anObject(step.value));\n        entryNext = entryIterator.next;\n        if (\n          (first = call(entryNext, entryIterator)).done ||\n          (second = call(entryNext, entryIterator)).done ||\n          !call(entryNext, entryIterator).done\n        ) throw TypeError('Expected sequence with length 2');\n        push(this.entries, { key: $toString(first.value), value: $toString(second.value) });\n      }\n    } else for (var key in object) if (hasOwn(object, key)) {\n      push(this.entries, { key: key, value: $toString(object[key]) });\n    }\n  },\n  parseQuery: function (query) {\n    if (query) {\n      var attributes = split(query, '&');\n      var index = 0;\n      var attribute, entry;\n      while (index < attributes.length) {\n        attribute = attributes[index++];\n        if (attribute.length) {\n          entry = split(attribute, '=');\n          push(this.entries, {\n            key: deserialize(shift(entry)),\n            value: deserialize(join(entry, '='))\n          });\n        }\n      }\n    }\n  },\n  serialize: function () {\n    var entries = this.entries;\n    var result = [];\n    var index = 0;\n    var entry;\n    while (index < entries.length) {\n      entry = entries[index++];\n      push(result, serialize(entry.key) + '=' + serialize(entry.value));\n    } return join(result, '&');\n  },\n  update: function () {\n    this.entries.length = 0;\n    this.parseQuery(this.url.query);\n  },\n  updateURL: function () {\n    if (this.url) this.url.update();\n  }\n};\n\n// `URLSearchParams` constructor\n// https://url.spec.whatwg.org/#interface-urlsearchparams\nvar URLSearchParamsConstructor = function URLSearchParams(/* init */) {\n  anInstance(this, URLSearchParamsPrototype);\n  var init = arguments.length > 0 ? arguments[0] : undefined;\n  setInternalState(this, new URLSearchParamsState(init));\n};\n\nvar URLSearchParamsPrototype = URLSearchParamsConstructor.prototype;\n\nredefineAll(URLSearchParamsPrototype, {\n  // `URLSearchParams.prototype.append` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-append\n  append: function append(name, value) {\n    validateArgumentsLength(arguments.length, 2);\n    var state = getInternalParamsState(this);\n    push(state.entries, { key: $toString(name), value: $toString(value) });\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.delete` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-delete\n  'delete': function (name) {\n    validateArgumentsLength(arguments.length, 1);\n    var state = getInternalParamsState(this);\n    var entries = state.entries;\n    var key = $toString(name);\n    var index = 0;\n    while (index < entries.length) {\n      if (entries[index].key === key) splice(entries, index, 1);\n      else index++;\n    }\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.get` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-get\n  get: function get(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = $toString(name);\n    var index = 0;\n    for (; index < entries.length; index++) {\n      if (entries[index].key === key) return entries[index].value;\n    }\n    return null;\n  },\n  // `URLSearchParams.prototype.getAll` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-getall\n  getAll: function getAll(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = $toString(name);\n    var result = [];\n    var index = 0;\n    for (; index < entries.length; index++) {\n      if (entries[index].key === key) push(result, entries[index].value);\n    }\n    return result;\n  },\n  // `URLSearchParams.prototype.has` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-has\n  has: function has(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = $toString(name);\n    var index = 0;\n    while (index < entries.length) {\n      if (entries[index++].key === key) return true;\n    }\n    return false;\n  },\n  // `URLSearchParams.prototype.set` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-set\n  set: function set(name, value) {\n    validateArgumentsLength(arguments.length, 1);\n    var state = getInternalParamsState(this);\n    var entries = state.entries;\n    var found = false;\n    var key = $toString(name);\n    var val = $toString(value);\n    var index = 0;\n    var entry;\n    for (; index < entries.length; index++) {\n      entry = entries[index];\n      if (entry.key === key) {\n        if (found) splice(entries, index--, 1);\n        else {\n          found = true;\n          entry.value = val;\n        }\n      }\n    }\n    if (!found) push(entries, { key: key, value: val });\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.sort` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-sort\n  sort: function sort() {\n    var state = getInternalParamsState(this);\n    arraySort(state.entries, function (a, b) {\n      return a.key > b.key ? 1 : -1;\n    });\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.forEach` method\n  forEach: function forEach(callback /* , thisArg */) {\n    var entries = getInternalParamsState(this).entries;\n    var boundFunction = bind(callback, arguments.length > 1 ? arguments[1] : undefined);\n    var index = 0;\n    var entry;\n    while (index < entries.length) {\n      entry = entries[index++];\n      boundFunction(entry.value, entry.key, this);\n    }\n  },\n  // `URLSearchParams.prototype.keys` method\n  keys: function keys() {\n    return new URLSearchParamsIterator(this, 'keys');\n  },\n  // `URLSearchParams.prototype.values` method\n  values: function values() {\n    return new URLSearchParamsIterator(this, 'values');\n  },\n  // `URLSearchParams.prototype.entries` method\n  entries: function entries() {\n    return new URLSearchParamsIterator(this, 'entries');\n  }\n}, { enumerable: true });\n\n// `URLSearchParams.prototype[@@iterator]` method\nredefine(URLSearchParamsPrototype, ITERATOR, URLSearchParamsPrototype.entries, { name: 'entries' });\n\n// `URLSearchParams.prototype.toString` method\n// https://url.spec.whatwg.org/#urlsearchparams-stringification-behavior\nredefine(URLSearchParamsPrototype, 'toString', function toString() {\n  return getInternalParamsState(this).serialize();\n}, { enumerable: true });\n\nsetToStringTag(URLSearchParamsConstructor, URL_SEARCH_PARAMS);\n\n$({ global: true, forced: !USE_NATIVE_URL }, {\n  URLSearchParams: URLSearchParamsConstructor\n});\n\n// Wrap `fetch` and `Request` for correct work with polyfilled `URLSearchParams`\nif (!USE_NATIVE_URL && isCallable(Headers)) {\n  var headersHas = uncurryThis(HeadersPrototype.has);\n  var headersSet = uncurryThis(HeadersPrototype.set);\n\n  var wrapRequestOptions = function (init) {\n    if (isObject(init)) {\n      var body = init.body;\n      var headers;\n      if (classof(body) === URL_SEARCH_PARAMS) {\n        headers = init.headers ? new Headers(init.headers) : new Headers();\n        if (!headersHas(headers, 'content-type')) {\n          headersSet(headers, 'content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n        }\n        return create(init, {\n          body: createPropertyDescriptor(0, $toString(body)),\n          headers: createPropertyDescriptor(0, headers)\n        });\n      }\n    } return init;\n  };\n\n  if (isCallable(n$Fetch)) {\n    $({ global: true, enumerable: true, forced: true }, {\n      fetch: function fetch(input /* , init */) {\n        return n$Fetch(input, arguments.length > 1 ? wrapRequestOptions(arguments[1]) : {});\n      }\n    });\n  }\n\n  if (isCallable(N$Request)) {\n    var RequestConstructor = function Request(input /* , init */) {\n      anInstance(this, RequestPrototype);\n      return new N$Request(input, arguments.length > 1 ? wrapRequestOptions(arguments[1]) : {});\n    };\n\n    RequestPrototype.constructor = RequestConstructor;\n    RequestConstructor.prototype = RequestPrototype;\n\n    $({ global: true, forced: true }, {\n      Request: RequestConstructor\n    });\n  }\n}\n\nmodule.exports = {\n  URLSearchParams: URLSearchParamsConstructor,\n  getState: getInternalParamsState\n};\n","var global = require('../internals/global');\n\nvar TypeError = global.TypeError;\n\nmodule.exports = function (passed, required) {\n  if (passed < required) throw TypeError('Not enough arguments');\n  return passed;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\n\n// `URL.prototype.toJSON` method\n// https://url.spec.whatwg.org/#dom-url-tojson\n$({ target: 'URL', proto: true, enumerable: true }, {\n  toJSON: function toJSON() {\n    return call(URL.prototype.toString, this);\n  }\n});\n","!function(){function t(){var e=Array.prototype.slice.call(arguments),n=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;n.appendChild(t?e:document.createTextNode(String(e)))}),this.appendChild(n)}[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty(\"append\")||Object.defineProperty(e,\"append\",{configurable:!0,enumerable:!0,writable:!0,value:t})})}();\n","!function(){function t(){var e=Array.prototype.slice.call(arguments),n=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;n.appendChild(t?e:document.createTextNode(String(e)))}),this.insertBefore(n,this.firstChild)}[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty(\"prepend\")||Object.defineProperty(e,\"prepend\",{configurable:!0,enumerable:!0,writable:!0,value:t})})}();\n","import {KL} from '../klecks/kl';\r\nimport {klHistory} from '../klecks/history/kl-history';\r\nimport {BB} from '../bb/bb';\r\nimport {showIframePopup} from '../klecks/ui/modals/show-iframe-popup';\r\n// @ts-ignore\r\nimport newImageImg from 'url:~/src/app/img/ui/new-image.svg';\r\n// @ts-ignore\r\nimport exportImg from 'url:~/src/app/img/ui/export.svg';\r\n// @ts-ignore\r\nimport shareImg from 'url:~/src/app/img/ui/share.svg';\r\n// @ts-ignore\r\nimport uploadImg from 'url:~/src/app/img/ui/upload.svg';\r\n// @ts-ignore\r\nimport importImg from 'url:~/src/app/img/ui/import.svg';\r\nimport {exportType} from '../klecks/ui/tool-tabs/file-tab';\r\nimport {ToolspaceTopRow} from \"../embed/toolspace-top-row\";\r\nimport {IInitState, IKlProject, IKlPsd} from '../klecks/kl.types';\r\nimport {importFilters} from '../klecks/filters/filters-lazy';\r\nimport {base64ToBlob} from '../klecks/storage/base-64-to-blob';\r\nimport {klCanvasToPsdBlob} from '../klecks/storage/kl-canvas-to-psd-blob';\r\nimport {ProjectStore} from '../klecks/storage/project-store';\r\nimport {SaveReminder} from \"../klecks/ui/components/save-reminder\";\r\nimport {KlCanvasWorkspace} from '../klecks/canvas-ui/kl-canvas-workspace';\r\nimport {KlCanvas} from '../klecks/canvas/kl-canvas';\r\nimport {LANG} from '../language/language';\r\n// @ts-ignore\r\nimport toolPaintImg from 'url:~/src/app/img/ui/tool-paint.svg';\r\n// @ts-ignore\r\nimport toolHandImg from 'url:~/src/app/img/ui/tool-hand.svg';\r\n// @ts-ignore\r\nimport toolFillImg from 'url:~/src/app/img/ui/tool-fill.svg';\r\n// @ts-ignore\r\nimport toolTextImg from 'url:~/src/app/img/ui/tool-text.svg';\r\n// @ts-ignore\r\nimport toolShapeImg from 'url:~/src/app/img/ui/tool-shape.svg';\r\n// @ts-ignore\r\nimport tabSettingsImg from 'url:~/src/app/img/ui/tab-settings.svg';\r\n// @ts-ignore\r\nimport tabLayersImg from 'url:~/src/app/img/ui/tab-layers.svg';\r\nimport {LocalStorage} from '../bb/base/local-storage';\r\n\r\n\r\ninterface IKlAppOptions {\r\n    saveReminder?: SaveReminder;\r\n    projectStore?: ProjectStore;\r\n    logoImg?: any; // app logo\r\n    bottomBar?: HTMLElement; // row at bottom of toolspace\r\n    embed?: {\r\n        url: string;\r\n        onSubmit: (onSuccess: () => void, onError: () => void) => void;\r\n    };\r\n    app?: {\r\n        filenameBase?: string; // part of filename when downloading drawing\r\n        imgurKey?: string; // for imgur uploads\r\n    };\r\n    aboutEl?: HTMLElement; // replaces info about Klecks in settings tab\r\n}\r\n\r\nimportFilters();\r\n\r\nexport function KlApp(pProject: IKlProject | null, pOptions: IKlAppOptions) {\r\n    // default 2048, unless your screen is bigger than that (that computer then probably has the horsepower for that)\r\n    // but not larger than 4096 - a fairly arbitrary decision\r\n    let klMaxCanvasSize = Math.min(4096, Math.max(2048, Math.max(window.screen.width, window.screen.height)));\r\n    let collapseThreshold = 820;\r\n    let uiState: 'left' | 'right' = (pOptions.embed ? 'left' : (LocalStorage.getItem('uiState') ? LocalStorage.getItem('uiState') : 'right')) as any;\r\n    const filenameBase = (pOptions.app && pOptions.app.filenameBase) ? pOptions.app.filenameBase : 'Klecks';\r\n    const projectStore = pOptions.projectStore;\r\n    let klRootEl = document.createElement(\"div\");\r\n    klRootEl.className = 'g-root';\r\n    let uiWidth: number = Math.max(0, window.innerWidth);\r\n    let uiHeight: number = Math.max(0, window.innerHeight);\r\n    const toolWidth = 271;\r\n    let exportType: exportType = 'png';\r\n    let klCanvas: KlCanvas = new KL.KlCanvas(\r\n        pProject ? {\r\n            projectObj: pProject\r\n        } : {\r\n            width: Math.min(klMaxCanvasSize, window.innerWidth < collapseThreshold ? uiWidth : uiWidth - toolWidth),\r\n            height: Math.min(klMaxCanvasSize, uiHeight)\r\n        }, pOptions.embed ? -1 : 0);\r\n    klCanvas.setHistory(klHistory);\r\n    let initState: IInitState = null;\r\n    let mainTabRow;\r\n\r\n    if (!pOptions.saveReminder) {\r\n        pOptions.saveReminder = {init: () => {}, reset: () => {}} as SaveReminder;\r\n    }\r\n\r\n    function translateSmoothing(s: number): number {\r\n        if (s == 1) {\r\n            return 1 - 0.5;\r\n        }\r\n        if (s == 2) {\r\n            return 1 - 0.16;\r\n        }\r\n        if (s == 3) {\r\n            return 1 - 0.035;\r\n        }\r\n        if (s == 4) {\r\n            return 1 - 0.0175;\r\n        }\r\n        if (s == 5) {\r\n            return 1 - 0.00875;\r\n        }\r\n        return s;\r\n    }\r\n\r\n    let isFirstImage = true;\r\n\r\n    if (pProject) {\r\n        pProject.layers.forEach(layer => {\r\n            layer.image = null;\r\n        });\r\n        pProject = null;\r\n    } else {\r\n        klHistory.pause(true);\r\n        klCanvas.addLayer();\r\n        klCanvas.layerFill(0, { r: 255, g: 255, b: 255});\r\n        klHistory.pause(false);\r\n    }\r\n    try {\r\n        initState = {\r\n            canvas: new KL.KlCanvas({copy: klCanvas}, pOptions.embed ? -1 : 0),\r\n            focus: klCanvas.getLayerCount() - 1,\r\n            brushes: {},\r\n        };\r\n    } catch (e) {\r\n        if (e.message === 'kl-create-canvas-error') {\r\n            klCanvas.destroy();\r\n        }\r\n        throw e;\r\n    }\r\n    for (let b in KL.brushes) {\r\n        if (KL.brushes.hasOwnProperty(b)) {\r\n            initState.brushes[b] = new KL.brushes[b]();\r\n            if (initState.canvas) {\r\n                initState.brushes[b].setContext(initState.canvas.getLayerContext(initState.focus));\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    let currentColor = new BB.RGB(0, 0, 0);\r\n    let currentBrush, currentBrushId;\r\n    let lastNonEraserBrushId = 0;\r\n    let currentLayerCtx = klCanvas.getLayerContext(klCanvas.getLayerCount() - 1);\r\n\r\n    function sizeWatcher(val) {\r\n        brushSettingService.emitSize(val);\r\n        if (klCanvasWorkspace) {\r\n            klCanvasWorkspace.setCursorSize(val * 2);\r\n        }\r\n    }\r\n\r\n    const brushSettingService = new KL.BrushSettingService(\r\n        (color) => {\r\n            klColorSlider.setColor(color);\r\n            currentBrush.setColor(color);\r\n            currentColor = BB.copyObj(color);\r\n        },\r\n        (size) => {\r\n            currentBrush.setSize(size);\r\n            klCanvasWorkspace.setCursorSize(size * 2);\r\n        },\r\n        (opacity) => {\r\n            currentBrush.setOpacity(opacity);\r\n        },\r\n        () => klColorSlider.getColor(),\r\n        () => brushUiObj[currentBrushId].getSize(),\r\n        () => brushUiObj[currentBrushId].getOpacity(),\r\n        () => {\r\n            return {\r\n                sizeSlider: KL.brushesUI[currentBrushId].sizeSlider,\r\n                opacitySlider: KL.brushesUI[currentBrushId].opacitySlider,\r\n            };\r\n        }\r\n    );\r\n\r\n    let lineSmoothing = new BB.EventChain.LineSmoothing({\r\n        smoothing: translateSmoothing(1),\r\n    });\r\n    let lineSanitizer = new BB.EventChain.LineSanitizer();\r\n\r\n    let drawEventChain = new BB.EventChain.EventChain({\r\n        chainArr: [\r\n            lineSanitizer,\r\n            lineSmoothing\r\n        ],\r\n    });\r\n\r\n    drawEventChain.setChainOut(function(event) {\r\n        if (event.type === 'down') {\r\n            toolspace.style.pointerEvents = 'none';\r\n            currentBrush.startLine(event.x, event.y, event.pressure);\r\n            klCanvasWorkspace.requestFrame();\r\n        }\r\n        if (event.type === 'move') {\r\n            currentBrush.goLine(event.x, event.y, event.pressure, false, event.isCoalesced)\r\n            klCanvasWorkspace.setLastDrawEvent(event.x, event.y, event.pressure);\r\n            klCanvasWorkspace.requestFrame();\r\n        }\r\n        if (event.type === 'up') {\r\n            toolspace.style.pointerEvents = '';\r\n            currentBrush.endLine();\r\n            klCanvasWorkspace.requestFrame();\r\n        }\r\n        if (event.type === 'line') {\r\n            currentBrush.getBrush().drawLineSegment(event.x0, event.y0, event.x1, event.y1);\r\n            klCanvasWorkspace.requestFrame();\r\n        }\r\n    });\r\n\r\n    let textToolSettings = {\r\n        size: 20,\r\n        align: 'left' as ('left' | 'center' | 'right'),\r\n        isBold: false,\r\n        isItalic: false,\r\n        font: 'sans-serif' as ('serif' | 'monospace' | 'sans-serif' | 'cursive' | 'fantasy'),\r\n        opacity: 1\r\n    };\r\n\r\n    const klCanvasWorkspace: KlCanvasWorkspace = new KL.KlCanvasWorkspace({\r\n        klCanvas: klCanvas,\r\n        width: Math.max(0, uiWidth - toolWidth),\r\n        height: uiHeight,\r\n        onDraw: drawEventChain.chainIn,\r\n        onPick: function(rgbObj, isDragDone) {\r\n            brushSettingService.setColor(rgbObj);\r\n            if (isDragDone) {\r\n                klColorSlider.pickingDone();\r\n                klCanvasWorkspace.setMode(toolspaceToolRow.getActive());\r\n            }\r\n        },\r\n        onFill: function(canvasX, canvasY) {\r\n            let layerIndex = klCanvas.getLayerIndex(currentLayerCtx.canvas);\r\n            klCanvas.floodFill(layerIndex, canvasX, canvasY, klColorSlider.getColor(), fillUi.getOpacity(), fillUi.getTolerance(), fillUi.getSample(), fillUi.getGrow(), fillUi.getContiguous());\r\n            klCanvasWorkspace.requestFrame();\r\n        },\r\n        onText: function(canvasX, canvasY, angleRad) {\r\n            if (KL.dialogCounter.get() > 0) {\r\n                return;\r\n            }\r\n\r\n            KL.textToolDialog({\r\n                klCanvas: klCanvas,\r\n                layerIndex: klCanvas.getLayerIndex(currentLayerCtx.canvas),\r\n                x: canvasX,\r\n                y: canvasY,\r\n                angleRad: angleRad,\r\n                color: klColorSlider.getColor(),\r\n                secondaryColor: klColorSlider.getSecondaryRGB(),\r\n                size: textToolSettings.size,\r\n                align: textToolSettings.align,\r\n                isBold: textToolSettings.isBold,\r\n                isItalic: textToolSettings.isItalic,\r\n                font: textToolSettings.font,\r\n                opacity: textToolSettings.opacity,\r\n                onConfirm: function(val) {\r\n\r\n                    let colorRGBA = val.color;\r\n                    colorRGBA.a = val.opacity;\r\n\r\n                    textToolSettings.size = val.size;\r\n                    textToolSettings.align = val.align;\r\n                    textToolSettings.isBold = val.isBold;\r\n                    textToolSettings.isItalic = val.isItalic;\r\n                    textToolSettings.font = val.font;\r\n                    textToolSettings.opacity = val.opacity;\r\n\r\n                    let layerIndex = klCanvas.getLayerIndex(currentLayerCtx.canvas);\r\n                    klCanvas.text(layerIndex, {\r\n                        textStr: val.textStr,\r\n                        x: val.x,\r\n                        y: val.y,\r\n                        size: val.size,\r\n                        font: val.font,\r\n                        align: val.align,\r\n                        isBold: val.isBold,\r\n                        isItalic: val.isItalic,\r\n                        angleRad: angleRad,\r\n                        color: BB.ColorConverter.toRgbaStr(colorRGBA)\r\n                    });\r\n                    klCanvasWorkspace.requestFrame();\r\n                }\r\n            });\r\n\r\n        },\r\n        onShape: function(typeStr, canvasX, canvasY, angleRad) {\r\n            if (typeStr === 'down') {\r\n                shapeTool.onDown(canvasX, canvasY, angleRad);\r\n            }\r\n            if (typeStr === 'move') {\r\n                shapeTool.onMove(canvasX, canvasY);\r\n            }\r\n            if (typeStr === 'up') {\r\n                shapeTool.onUp(canvasX, canvasY);\r\n            }\r\n        },\r\n\r\n        onViewChange: function(viewChangeObj) {\r\n\r\n            if (viewChangeObj.changed.includes('scale')) {\r\n                statusOverlay.out({\r\n                    type: 'transform',\r\n                    scale: viewChangeObj.scale,\r\n                    angleDeg: viewChangeObj.angle * 180 / Math.PI\r\n                });\r\n            }\r\n\r\n            toolspaceToolRow.setEnableZoomIn(viewChangeObj.scale !== klCanvasWorkspace.getMaxScale());\r\n            toolspaceToolRow.setEnableZoomOut(viewChangeObj.scale !== klCanvasWorkspace.getMinScale());\r\n\r\n            handUi.update(viewChangeObj.scale, viewChangeObj.angle * 180 / Math.PI);\r\n        },\r\n        onUndo: function() {\r\n            if (klHistory.canUndo()) {\r\n                if (undoRedoCatchup.undo()) {\r\n                    statusOverlay.out(LANG('undo'), true);\r\n                }\r\n            }\r\n        },\r\n        onRedo: function() {\r\n            if (klHistory.canRedo()) {\r\n                if (undoRedoCatchup.redo()) {\r\n                    statusOverlay.out(LANG('redo'), true);\r\n                }\r\n            }\r\n        },\r\n    });\r\n    let keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, event, comboStr) {\r\n            if (KL.dialogCounter.get() > 0) {\r\n                return;\r\n            }\r\n            if (BB.isInputFocused(true)) {\r\n                return;\r\n            }\r\n\r\n            let isDrawing = lineSanitizer.getIsDrawing() || klCanvasWorkspace.getIsDrawing();\r\n            if (isDrawing) {\r\n                return;\r\n            }\r\n\r\n            if (comboStr === 'plus') {\r\n                klCanvasWorkspace.zoomByStep(keyListener.isPressed('shift') ? 1/8 : 1/2);\r\n            }\r\n            if (comboStr === 'minus') {\r\n                klCanvasWorkspace.zoomByStep(keyListener.isPressed('shift') ? -1/8 : -1/2);\r\n            }\r\n            if (comboStr === 'home') {\r\n                klCanvasWorkspace.fitView();\r\n            }\r\n            if (comboStr === 'end') {\r\n                klCanvasWorkspace.resetView(true);\r\n            }\r\n            if (['ctrl+z', 'cmd+z'].includes(comboStr)) {\r\n                event.preventDefault();\r\n                undoRedoCatchup.undo();\r\n            }\r\n            if (\r\n                ['ctrl+y', 'cmd+y'].includes(comboStr) ||\r\n                (\r\n                    (\r\n                        BB.sameKeys('ctrl+shift+z', comboStr) ||\r\n                        BB.sameKeys('cmd+shift+z', comboStr)\r\n                    ) && keyStr === 'z'\r\n                )\r\n            ) {\r\n                event.preventDefault();\r\n                undoRedoCatchup.redo();\r\n            }\r\n            if (!pOptions.embed) {\r\n                if (['ctrl+s', 'cmd+s'].includes(comboStr)) {\r\n                    event.preventDefault();\r\n                    saveToComputer.save();\r\n                }\r\n                if (['ctrl+shift+s', 'cmd+shift+s'].includes(comboStr)) {\r\n                    event.preventDefault();\r\n\r\n                    (async () => {\r\n                        let success = true;\r\n                        try {\r\n                            await projectStore.store(klCanvas.getProject());\r\n                        } catch (e) {\r\n                            success = false;\r\n                            setTimeout(() => {\r\n                                throw new Error('keyboard-shortcut: failed to store browser storage, ' + e);\r\n                            }, 0);\r\n                            statusOverlay.out('❌ ' + LANG('file-storage-failed'), true);\r\n                        }\r\n                        if (success) {\r\n                            pOptions.saveReminder.reset();\r\n                            statusOverlay.out(LANG('file-storage-stored'), true);\r\n                        }\r\n                    })();\r\n                }\r\n                if (['ctrl+c', 'cmd+c'].includes(comboStr)) {\r\n                    event.preventDefault();\r\n                    copyToClipboard(true);\r\n                }\r\n            }\r\n            if (['ctrl+a', 'cmd+a'].includes(comboStr)) {\r\n                event.preventDefault();\r\n            }\r\n\r\n\r\n            if (keyListener.comboOnlyContains(['left', 'right', 'up', 'down'])) {\r\n                if (keyStr === 'left') {\r\n                    klCanvasWorkspace.translateView(1, 0);\r\n                }\r\n                if (keyStr === 'right') {\r\n                    klCanvasWorkspace.translateView(-1, 0);\r\n                }\r\n                if (keyStr === 'up') {\r\n                    klCanvasWorkspace.translateView(0, 1);\r\n                }\r\n                if (keyStr === 'down') {\r\n                    klCanvasWorkspace.translateView(0, -1);\r\n                }\r\n            }\r\n\r\n\r\n            if (['r+left','r+right'].includes(comboStr)) {\r\n                if (keyStr === 'left') {\r\n                    klCanvasWorkspace.setAngle(-15, true);\r\n                    handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n                }\r\n                if (keyStr === 'right') {\r\n                    klCanvasWorkspace.setAngle(15, true);\r\n                    handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n                }\r\n            }\r\n            if (['r+up'].includes(comboStr)) {\r\n                klCanvasWorkspace.setAngle(0);\r\n                handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n            }\r\n\r\n\r\n            if (comboStr === 'sqbr_open') {\r\n                currentBrush.decreaseSize(0.03 / klCanvasWorkspace.getScale());\r\n            }\r\n            if (comboStr === 'sqbr_close') {\r\n                currentBrush.increaseSize(0.03 / klCanvasWorkspace.getScale());\r\n            }\r\n            if (comboStr === 'enter') {\r\n                klCanvas.layerFill(klCanvas.getLayerIndex(currentLayerCtx.canvas), klColorSlider.getColor());\r\n                statusOverlay.out(LANG('filled'), true);\r\n            }\r\n            if (['delete', 'backspace'].includes(comboStr)) {\r\n                let layerIndex = klCanvas.getLayerIndex(currentLayerCtx.canvas);\r\n                if (layerIndex === 0 && !brushUiObj.eraserBrush.getIsTransparentBg()) {\r\n                    klCanvas.layerFill(layerIndex, {r: 255, g: 255, b: 255}, 'source-in');\r\n                } else {\r\n                    klCanvas.clearLayer(layerIndex);\r\n                }\r\n                statusOverlay.out(LANG('cleared-layer'), true);\r\n            }\r\n            if (comboStr === 'e') {\r\n                event.preventDefault();\r\n                klCanvasWorkspace.setMode('draw');\r\n                toolspaceToolRow.setActive('draw');\r\n                mainTabRow.open('draw');\r\n                updateMainTabVisibility();\r\n                brushTabRow.open('eraserBrush');\r\n            }\r\n            if (comboStr === 'b') {\r\n                event.preventDefault();\r\n                klCanvasWorkspace.setMode('draw');\r\n                toolspaceToolRow.setActive('draw');\r\n                mainTabRow.open('draw');\r\n                updateMainTabVisibility();\r\n                brushTabRow.open(lastNonEraserBrushId);\r\n            }\r\n            if (comboStr === 'g') {\r\n                event.preventDefault();\r\n                klCanvasWorkspace.setMode('fill');\r\n                toolspaceToolRow.setActive('fill');\r\n                mainTabRow.open('fill');\r\n                updateMainTabVisibility();\r\n            }\r\n            if (comboStr === 't') {\r\n                event.preventDefault();\r\n                klCanvasWorkspace.setMode('text');\r\n                toolspaceToolRow.setActive('text');\r\n                mainTabRow.open('text');\r\n                updateMainTabVisibility();\r\n            }\r\n            if (comboStr === 'u') {\r\n                event.preventDefault();\r\n                klCanvasWorkspace.setMode('shape');\r\n                toolspaceToolRow.setActive('shape');\r\n                mainTabRow.open('shape');\r\n                updateMainTabVisibility();\r\n            }\r\n            if (comboStr === 'x') {\r\n                event.preventDefault();\r\n                klColorSlider.swapColors();\r\n            }\r\n\r\n\r\n        },\r\n        onUp: function(keyStr, event) {\r\n        }\r\n    });\r\n\r\n    /**\r\n     *\r\n     * @param importedImage - convertedPsd | {type: 'image', width: number, height: number, canvas: image | canvas}\r\n     * @param filename - string e.g. 'drawing.psd'\r\n     * @param optionStr? - 'default' | 'layer' | 'image'\r\n     */\r\n    function importFinishedLoading(\r\n        importedImage: IKlPsd | {\r\n            type: 'image';\r\n            width: number;\r\n            height: number;\r\n            canvas: HTMLCanvasElement | HTMLImageElement;\r\n        },\r\n        filename: string,\r\n        optionStr: 'default' | 'layer' | 'image',\r\n    ) {\r\n        if (!importedImage || isNaN(importedImage.width) || isNaN(importedImage.height) || importedImage.width <= 0 || importedImage.height <= 0) {\r\n            KL.popup({\r\n                target: klRootEl,\r\n                type: \"error\",\r\n                message: LANG('import-broken-file'),\r\n                buttons: [\"Ok\"],\r\n            });\r\n            return;\r\n        }\r\n\r\n        function getResizedDimensions(width, height) {\r\n            let w = parseInt(width);\r\n            let h = parseInt(height);\r\n            if (w > klMaxCanvasSize) {\r\n                h = klMaxCanvasSize / w * h;\r\n                w = klMaxCanvasSize;\r\n            }\r\n            if (h > klMaxCanvasSize) {\r\n                w = klMaxCanvasSize / h * w;\r\n                h = klMaxCanvasSize;\r\n            }\r\n            w = parseInt('' + w);\r\n            h = parseInt('' + h);\r\n            return {\r\n                width: w,\r\n                height: h\r\n            }\r\n        }\r\n\r\n        function importAsImage(canvas) {\r\n            let resizedDimensions = getResizedDimensions(canvas.width, canvas.height);\r\n\r\n            //resize first\r\n            let tempCanvas = BB.canvas(canvas.width, canvas.height);\r\n            let tempCanvasCtx = tempCanvas.getContext('2d');\r\n            tempCanvasCtx.drawImage(canvas, 0, 0);\r\n\r\n            BB.resizeCanvas(tempCanvas, resizedDimensions.width, resizedDimensions.height);\r\n\r\n            klCanvas.reset({\r\n                width: resizedDimensions.width,\r\n                height: resizedDimensions.height,\r\n                image: tempCanvas,\r\n                layerName: filename\r\n            });\r\n\r\n            layerManager.update(0);\r\n            setCurrentLayer(klCanvas.getLayer(0));\r\n            klCanvasWorkspace.resetView();\r\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n\r\n            isFirstImage = false;\r\n        }\r\n\r\n        /**\r\n         *\r\n         * @param convertedPsdObj - if flattened then without layers\r\n         * @param cropObj? - {x: number, y: number, width: number, height: number}\r\n         */\r\n        function importAsImagePsd(convertedPsdObj: IKlPsd, cropObj?) {\r\n\r\n            // crop\r\n            function crop(targetCanvas, cropCanvas, cropObj) {\r\n                cropCanvas.width = cropCanvas.width;\r\n                cropCanvas.getContext('2d').drawImage(targetCanvas, -cropObj.x, -cropObj.y);\r\n                targetCanvas.width = cropObj.width;\r\n                targetCanvas.height = cropObj.height;\r\n                targetCanvas.getContext('2d').drawImage(cropCanvas, 0, 0);\r\n            }\r\n            if (cropObj && (cropObj.width !== convertedPsdObj.width ||cropObj.height !== convertedPsdObj.height)) {\r\n                let cropCanvas = BB.canvas(cropObj.width, cropObj.height);\r\n                convertedPsdObj.width = cropObj.width;\r\n                convertedPsdObj.height = cropObj.height;\r\n\r\n                if (!convertedPsdObj.layers) {\r\n                    crop(convertedPsdObj.canvas, cropCanvas, cropObj);\r\n                }\r\n                if (convertedPsdObj.layers) {\r\n                    for (let i = 0; i < convertedPsdObj.layers.length; i++) {\r\n                        let item = convertedPsdObj.layers[i];\r\n                        crop(item.image, cropCanvas, cropObj);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // resize\r\n            let resizedDimensions = getResizedDimensions(convertedPsdObj.width, convertedPsdObj.height);\r\n            convertedPsdObj.width = resizedDimensions.width;\r\n            convertedPsdObj.height = resizedDimensions.height;\r\n            if (!convertedPsdObj.layers) {\r\n                BB.resizeCanvas(convertedPsdObj.canvas, convertedPsdObj.width, convertedPsdObj.height);\r\n            }\r\n            if (convertedPsdObj.layers) {\r\n                for (let i = 0; i < convertedPsdObj.layers.length; i++) {\r\n                    let item = convertedPsdObj.layers[i];\r\n                    BB.resizeCanvas(item.image, convertedPsdObj.width, convertedPsdObj.height);\r\n                }\r\n            }\r\n\r\n            let layerIndex;\r\n            if (convertedPsdObj.layers) {\r\n                layerIndex = klCanvas.reset({\r\n                    width: convertedPsdObj.width,\r\n                    height: convertedPsdObj.height,\r\n                    layers: convertedPsdObj.layers\r\n                });\r\n            } else {\r\n                layerIndex = klCanvas.reset({\r\n                    width: convertedPsdObj.width,\r\n                    height: convertedPsdObj.height,\r\n                    image: convertedPsdObj.canvas\r\n                });\r\n            }\r\n            layerManager.update(layerIndex);\r\n            setCurrentLayer(klCanvas.getLayer(layerIndex));\r\n            klCanvasWorkspace.resetView();\r\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n\r\n            isFirstImage = false;\r\n        }\r\n\r\n        function importAsLayer(canvas) {\r\n            KL.showImportAsLayerDialog({\r\n                target: klRootEl,\r\n                klCanvas: klCanvas,\r\n                importImage: canvas,\r\n                callback: function(transformObj, isPixelated: boolean) {\r\n                    if (!transformObj) {\r\n                        return;\r\n                    }\r\n\r\n                    klHistory.pause(true);\r\n                    klCanvas.addLayer();\r\n                    let layers = klCanvas.getLayers();\r\n                    let activeLayerIndex = layers.length - 1;\r\n                    if (filename) {\r\n                        klCanvas.renameLayer(activeLayerIndex, filename);\r\n                    }\r\n                    let activeLayerContext = klCanvas.getLayerContext(activeLayerIndex);\r\n                    BB.drawTransformedImageWithBounds(activeLayerContext, canvas, transformObj, null, isPixelated);\r\n                    setCurrentLayer(klCanvas.getLayer(activeLayerIndex));\r\n                    layerManager.update(activeLayerIndex);\r\n\r\n                    klHistory.pause(false);\r\n\r\n                    klHistory.push({\r\n                        tool: [\"misc\"],\r\n                        action: \"importImage\",\r\n                        params: [BB.copyCanvas(activeLayerContext.canvas), filename]\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n\r\n        if (optionStr === 'default' || !optionStr) {\r\n            KL.showImportImageDialog({\r\n                image: importedImage,\r\n                target: klRootEl,\r\n                maxSize: klMaxCanvasSize,\r\n                callback: function(res) {\r\n                    if (res.type === 'as-image') {\r\n                        importAsImage(res.image);\r\n                    } else if (res.type === 'as-image-psd') {\r\n                        importAsImagePsd(res.image, res.cropObj);\r\n                    } else if (res.type === 'as-layer') {\r\n                        importAsLayer(res.image);\r\n                    } else if (res.type === 'cancel') {\r\n                        // nothing to do\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        if (optionStr === 'layer') {\r\n            importAsLayer(importedImage.canvas);\r\n        }\r\n        if (optionStr === 'image') {\r\n            if (importedImage.type === 'psd') {\r\n                importAsImagePsd(importedImage);\r\n            } else {\r\n                importAsImage(importedImage.canvas);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    function onPaste(e) {\r\n        if (KL.dialogCounter.get() > 0) {\r\n            return;\r\n        }\r\n\r\n        function retrieveImageFromClipboardAsBlob(pasteEvent, callback) {\r\n            if (pasteEvent.clipboardData == false) {\r\n                if (typeof (callback) == \"function\") {\r\n                    callback(undefined);\r\n                }\r\n            }\r\n\r\n            let items = pasteEvent.clipboardData.items;\r\n\r\n            if (items == undefined) {\r\n                if (typeof (callback) == \"function\") {\r\n                    callback(undefined);\r\n                }\r\n            } else {\r\n                for (let i = 0; i < items.length; i++) {\r\n                    if (items[i].type.indexOf(\"image\") == -1) {\r\n                        continue;\r\n                    }\r\n                    let blob = items[i].getAsFile();\r\n\r\n                    if (typeof (callback) == \"function\") {\r\n                        callback(blob);\r\n                    }\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n\r\n        if (e.clipboardData.files[0]) {\r\n            retrieveImageFromClipboardAsBlob(e, function (imageBlob) {\r\n                // If there's an image, display it in the canvas\r\n                if (imageBlob) {\r\n                    let img = new Image();\r\n                    img.onload = function () {\r\n                        URL.revokeObjectURL(img.src);\r\n                        importFinishedLoading({\r\n                            type: 'image',\r\n                            width: img.width,\r\n                            height: img.height,\r\n                            canvas: img\r\n                        }, null, 'default');\r\n                    };\r\n                    let URLObj = window.URL || window.webkitURL;\r\n                    img.src = URLObj.createObjectURL(imageBlob);\r\n                }\r\n            });\r\n        } else if (e.clipboardData.items[0]) {\r\n            e.clipboardData.items[0].getAsString(function(pasteStr) {\r\n                pasteStr = pasteStr.trim();\r\n                if (pasteStr.match(/^https?/)) {\r\n                    // url\r\n                    let img = new Image();\r\n                    img.onload = function () {\r\n                        importFinishedLoading({\r\n                            type: 'image',\r\n                            width: img.width,\r\n                            height: img.height,\r\n                            canvas: img\r\n                        }, null, 'default');\r\n                    };\r\n                    img.onerror = function (e) {\r\n                        console.log('error loading', e);\r\n                    };\r\n                    img.crossOrigin = 'Anonymous';\r\n                    img.src = pasteStr;\r\n\r\n                } else if (pasteStr.match(/^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/)) {\r\n                    // url\r\n                    let rgbObj = BB.ColorConverter.hexToRGB(pasteStr.replace('#', ''));\r\n                    brushSettingService.setColor(rgbObj);\r\n                }\r\n            });\r\n\r\n        }\r\n    }\r\n\r\n    function handleFileSelect(files, optionStr) {\r\n\r\n        function showWarningPsdFlattened() {\r\n            KL.popup({\r\n                target: klRootEl,\r\n                type: \"warning\",\r\n                message: LANG('import-psd-unsupported') + \"<br /><br />\",\r\n                buttons: [\"Ok\"],\r\n            });\r\n        }\r\n\r\n        let hasUnsupportedFile = false;\r\n        for (let i = 0, file; file = files[i]; i++) {\r\n            let extension = file.name.split(\".\");\r\n            extension = extension[extension.length - 1].toLowerCase();\r\n            if (extension === \"psd\") {\r\n\r\n                (function(f) {\r\n                    let loaderSizeBytes = 1024 * 1024 * 25; // 25mb\r\n                    let maxSizeBytes = 1024 * 1024 * 1024; // 1gb\r\n                    let maxResolution = 4096;\r\n\r\n                    if (f.size >= maxSizeBytes) { // pretty likely to break stuff\r\n                        KL.popup({\r\n                            target: klRootEl,\r\n                            type: \"error\",\r\n                            message: \"File too big. Unable to import.<br /><br />\",\r\n                            buttons: [\"Ok\"],\r\n                        });\r\n                        return;\r\n                    }\r\n\r\n                    let doShowLoader = files.length === 1 && f.size >= loaderSizeBytes;\r\n                    let loaderIsOpen = true;\r\n                    let closeLoader;\r\n\r\n                    if (doShowLoader) {\r\n                        KL.popup({\r\n                            target: klRootEl,\r\n                            message: LANG('import-opening'),\r\n                            callback: function (result) {\r\n                                loaderIsOpen = false;\r\n                                closeLoader = null;\r\n                            },\r\n                            closefunc: function (f) {\r\n                                closeLoader = f;\r\n                            }\r\n                        });\r\n                    }\r\n\r\n\r\n                    let reader = new FileReader();\r\n                    reader.onload = function (readerResult) {\r\n\r\n                        KL.loadAgPsd().then(function(agPsdLazy) {\r\n\r\n                            if (doShowLoader && !loaderIsOpen) {\r\n                                return;\r\n                            }\r\n\r\n                            try {\r\n                                let psd;\r\n\r\n                                // first pass, only read metadata\r\n                                psd = agPsdLazy.readPsd(\r\n                                    (readerResult.target.result as any),\r\n                                    {\r\n                                        skipLayerImageData: true,\r\n                                        skipThumbnail: true,\r\n                                        skipCompositeImageData: true\r\n                                    });\r\n                                if (psd.width > maxResolution || psd.height > maxResolution) {\r\n                                    if (closeLoader) {\r\n                                        closeLoader();\r\n                                    }\r\n                                    KL.popup({\r\n                                        target: klRootEl,\r\n                                        type: \"error\",\r\n                                        //message: \"Image exceeds maximum dimensions of \" + maxResolution + \" x \" + maxResolution + \" pixels. Unable to import.\"\r\n                                        message: LANG('import-psd-too-large').replace(/{x}/g, '' + maxResolution)\r\n                                            + \"<br /><br />\"\r\n                                            + LANG('import-psd-size') + \": \" + psd.width + \" x \" + psd.height + ' pixels'\r\n                                            + \"<br /><br />\"\r\n                                        ,\r\n                                        buttons: [\"Ok\"],\r\n                                    });\r\n                                    return;\r\n                                }\r\n\r\n\r\n                                // second pass, now load actual data.\r\n                                psd = null;\r\n\r\n                                try {\r\n                                    psd = agPsdLazy.readPsd((readerResult.target.result as any));\r\n                                } catch (e) {\r\n                                    //console.log('failed regular psd import', e);\r\n                                }\r\n                                if (psd) {\r\n                                    //console.log('psd', psd);\r\n                                    let convertedPsd = KL.PSD.readPsd(psd);\r\n                                    //console.log('converted', convertedPsd);\r\n                                    if (optionStr === 'image' && convertedPsd.error) {\r\n                                        showWarningPsdFlattened();\r\n                                    }\r\n\r\n                                    if (closeLoader) {\r\n                                        closeLoader();\r\n                                    }\r\n                                    importFinishedLoading(convertedPsd, f.name, optionStr);\r\n                                } else {\r\n                                    psd = agPsdLazy.readPsd((readerResult.target.result as any), { skipLayerImageData: true, skipThumbnail: true });\r\n                                    if (optionStr === 'image') {\r\n                                        showWarningPsdFlattened();\r\n                                    }\r\n\r\n                                    if (closeLoader) {\r\n                                        closeLoader();\r\n                                    }\r\n                                    importFinishedLoading({\r\n                                        type: 'psd',\r\n                                        width: psd.width,\r\n                                        height: psd.height,\r\n                                        canvas: psd.canvas,\r\n                                        error: true\r\n                                    }, f.name, optionStr);\r\n                                }\r\n\r\n\r\n                            } catch (e) {\r\n                                if (closeLoader) {\r\n                                    closeLoader();\r\n                                }\r\n                                KL.popup({\r\n                                    target: klRootEl,\r\n                                    type: \"error\",\r\n                                    message: \"Failed to load PSD.<br /><br />\",\r\n                                    buttons: [\"Ok\"],\r\n                                });\r\n                            }\r\n                        }).catch(() => {\r\n                            closeLoader();\r\n                            alert('Error: failed to load PSD library');\r\n                        });\r\n\r\n                    };\r\n                    reader.readAsArrayBuffer(f);\r\n                })(file);\r\n\r\n            } else if (file.type.match('image.*')) {\r\n                (function (f) {\r\n                    window.URL = window.URL || window.webkitURL;\r\n                    let url = window.URL.createObjectURL(f);\r\n                    let im = new Image();\r\n                    im.src = url;\r\n                    BB.loadImage(im, function () {\r\n                        importFinishedLoading({\r\n                            type: 'image',\r\n                            width: im.width,\r\n                            height: im.height,\r\n                            canvas: im\r\n                        }, f.name, optionStr);\r\n                    });\r\n                })(file);\r\n            } else {\r\n                hasUnsupportedFile = true;\r\n            }\r\n        }\r\n        if (hasUnsupportedFile) {\r\n            KL.popup({\r\n                target: klRootEl,\r\n                message: LANG('import-unsupported-file'),\r\n                type: 'error',\r\n                buttons: ['OK'],\r\n            });\r\n        }\r\n    }\r\n\r\n    if (!pOptions.embed) {\r\n        new KL.KlImageDropper({\r\n            target: document.body,\r\n            onDrop: function(files, optionStr) {\r\n                if (KL.dialogCounter.get() > 0) {\r\n                    return;\r\n                }\r\n                handleFileSelect(files, optionStr);\r\n            },\r\n            enabledTest: function() {\r\n                return KL.dialogCounter.get() === 0;\r\n            }\r\n        });\r\n\r\n        BB.addEventListener(window, 'paste', onPaste, false);\r\n    }\r\n\r\n    const brushUiObj: any = {};\r\n\r\n    // create brush UIs\r\n    for (let b in KL.brushesUI) {\r\n        if (KL.brushesUI.hasOwnProperty(b)) {\r\n            let ui = new KL.brushesUI[b].Ui({\r\n                onSizeChange: sizeWatcher,\r\n                onOpacityChange: function(opacity) {\r\n                    brushSettingService.emitOpacity(opacity);\r\n                },\r\n                onConfigChange: () => {\r\n                    brushSettingService.emitSliderConfig({\r\n                        sizeSlider: KL.brushesUI[currentBrushId].sizeSlider,\r\n                        opacitySlider: KL.brushesUI[currentBrushId].opacitySlider\r\n                    });\r\n                }\r\n            });\r\n            brushUiObj[b] = ui;\r\n            ui.getElement().style.padding = 10 + 'px';\r\n        }\r\n    }\r\n\r\n\r\n    BB.css(klRootEl, {\r\n        position: 'absolute',\r\n        left: '0',\r\n        top: '0',\r\n        right: '0',\r\n        bottom: '0'\r\n    });\r\n\r\n    let statusOverlay = new KL.StatusOverlay();\r\n\r\n    const toolspace = BB.el({});\r\n    const toolspaceInner = BB.el({\r\n        parent: toolspace,\r\n    });\r\n    toolspace.oncontextmenu = function () {\r\n        return false;\r\n    };\r\n    toolspace.onclick = BB.handleClick;\r\n\r\n\r\n    let toolspaceCollapser = new KL.ToolspaceCollapser({\r\n        onChange: function() {\r\n            updateCollapse();\r\n        }\r\n    });\r\n    function updateCollapse() {\r\n\r\n        //collapser\r\n        if (uiWidth < collapseThreshold) {\r\n            toolspaceCollapser.getElement().style.display = 'block';\r\n\r\n            toolspaceCollapser.setDirection(uiState);\r\n            if (toolspaceCollapser.isOpen()) {\r\n                if (uiState === 'left') {\r\n                    BB.css(toolspaceCollapser.getElement(), {\r\n                        left: '271px',\r\n                        right: '',\r\n                    });\r\n                    BB.css(klCanvasWorkspace.getElement(), {\r\n                        left: '271px'\r\n                    });\r\n                } else {\r\n                    BB.css(toolspaceCollapser.getElement(), {\r\n                        left: '',\r\n                        right: '271px'\r\n                    });\r\n                    BB.css(klCanvasWorkspace.getElement(), {\r\n                        left: '0'\r\n                    });\r\n                }\r\n                toolspace.style.display = 'block';\r\n                klCanvasWorkspace.setSize(Math.max(0, uiWidth - toolWidth), uiHeight);\r\n                statusOverlay.setWide(false);\r\n\r\n            } else {\r\n                if (uiState === 'left') {\r\n                    BB.css(toolspaceCollapser.getElement(), {\r\n                        left: '0',\r\n                        right: '',\r\n                    });\r\n                    BB.css(klCanvasWorkspace.getElement(), {\r\n                        left: '0'\r\n                    });\r\n                } else {\r\n                    BB.css(toolspaceCollapser.getElement(), {\r\n                        left: '',\r\n                        right: '0'\r\n                    });\r\n                    BB.css(klCanvasWorkspace.getElement(), {\r\n                        left: '0'\r\n                    });\r\n                }\r\n                toolspace.style.display = 'none';\r\n                klCanvasWorkspace.setSize(Math.max(0, uiWidth), uiHeight);\r\n                statusOverlay.setWide(true);\r\n\r\n            }\r\n\r\n        } else {\r\n            toolspaceCollapser.getElement().style.display = 'none';\r\n            if (uiState === 'left') {\r\n                BB.css(klCanvasWorkspace.getElement(), {\r\n                    left: '271px'\r\n                });\r\n            } else {\r\n                BB.css(klCanvasWorkspace.getElement(), {\r\n                    left: '0'\r\n                });\r\n            }\r\n            toolspace.style.display = 'block';\r\n            klCanvasWorkspace.setSize(Math.max(0, uiWidth - toolWidth), uiHeight);\r\n            statusOverlay.setWide(false);\r\n\r\n        }\r\n    }\r\n    updateCollapse();\r\n\r\n    function updateUi() {\r\n        if (uiState === 'left') {\r\n            BB.css(toolspace, {\r\n                left: '0',\r\n                right: '',\r\n                borderLeft: 'none',\r\n                borderRight: '1px solid rgb(135, 135, 135)'\r\n            });\r\n            BB.css(klCanvasWorkspace.getElement(), {\r\n                left: '271px'\r\n            });\r\n        } else {\r\n            BB.css(toolspace, {\r\n                left: '',\r\n                right: '0',\r\n                borderLeft: '1px solid rgb(135, 135, 135)',\r\n                borderRight: 'none'\r\n            });\r\n            BB.css(klCanvasWorkspace.getElement(), {\r\n                left: '0'\r\n            });\r\n        }\r\n        statusOverlay.setUiState(uiState);\r\n        layerPreview.setUiState('' + uiState);\r\n        layerManager.setUiState('' + uiState);\r\n        updateCollapse();\r\n        toolspaceScroller.updateUiState(uiState);\r\n    }\r\n\r\n\r\n\r\n    let overlayToolspace;\r\n    setTimeout(function() {\r\n        overlayToolspace = new KL.OverlayToolspace({\r\n            enabledTest: function() {\r\n                return KL.dialogCounter.get() === 0 && !lineSanitizer.getIsDrawing();\r\n            },\r\n            brushSettingService,\r\n        });\r\n        klRootEl.appendChild(overlayToolspace.getElement());\r\n    }, 0);\r\n\r\n    BB.append(klRootEl, [klCanvasWorkspace.getElement(), toolspace, toolspaceCollapser.getElement()]);\r\n\r\n    BB.css(toolspace, {\r\n        position: \"absolute\",\r\n        right: '0',\r\n        top: '0',\r\n        bottom: '0',\r\n        width: (toolWidth - 1) + \"px\",\r\n\r\n        overflow: \"hidden\",\r\n        backgroundColor: \"#ddd\",\r\n        borderLeft: \"1px solid rgb(135, 135, 135)\",\r\n        userSelect: 'none',\r\n        touchAction: 'none'\r\n    });\r\n\r\n    let toolspaceTopRow;\r\n    if (pOptions.embed) {\r\n        toolspaceTopRow = new ToolspaceTopRow({\r\n            onHelp: () => {\r\n                showIframePopup(pOptions.embed.url + '/help.html', !!pOptions.embed);\r\n            },\r\n            onSubmit: () => {\r\n                KL.popup({\r\n                    target: klRootEl,\r\n                    message: LANG('submit-prompt'),\r\n                    buttons: [LANG('submit'), 'Cancel'],\r\n                    callback: async (result) => {\r\n                        if (result !== LANG('submit')) {\r\n                            return;\r\n                        }\r\n\r\n                        let overlay = BB.el({\r\n                            parent: klRootEl,\r\n                            className: 'upload-overlay',\r\n                            content: '<div class=\"spinner\"></div> ' + LANG('submit-submitting'),\r\n                        });\r\n\r\n                        pOptions.embed.onSubmit(\r\n                            () => {\r\n                                pOptions.saveReminder.reset();\r\n                                klRootEl.removeChild(overlay);\r\n                            },\r\n                            () => {\r\n                                klRootEl.removeChild(overlay);\r\n                            });\r\n                    }\r\n                });\r\n            },\r\n            onLeftRight: () => {\r\n                uiState = uiState === 'left' ? 'right' : 'left';\r\n                updateUi();\r\n            },\r\n        });\r\n    } else {\r\n        toolspaceTopRow = new KL.ToolspaceTopRow({\r\n            logoImg: pOptions.logoImg,\r\n            onLogo: function() {\r\n                showIframePopup('./home/', !!pOptions.embed);\r\n            },\r\n            onNew: function() {\r\n                showNewImageDialog();\r\n            },\r\n            onImport: function() {\r\n                fileTab.triggerImport();\r\n            },\r\n            onSave: function() {\r\n                saveToComputer.save();\r\n            },\r\n            onShare: function() {\r\n                shareImage();\r\n            },\r\n            onHelp: function() {\r\n                showIframePopup('./help/', !!pOptions.embed);\r\n            },\r\n        });\r\n    }\r\n    BB.addClassName(toolspaceTopRow.getElement(), 'toolspace-row-shadow');\r\n    toolspaceTopRow.getElement().style.marginBottom = '10px';\r\n    toolspaceInner.appendChild(toolspaceTopRow.getElement());\r\n\r\n    let toolspaceToolRow = new KL.ToolspaceToolRow({\r\n        onActivate: function(activeStr) {\r\n            if (activeStr === 'draw') {\r\n                klCanvasWorkspace.setMode('draw');\r\n            } else if (activeStr === 'hand') {\r\n                klCanvasWorkspace.setMode('hand');\r\n            } else if (activeStr === 'fill') {\r\n                klCanvasWorkspace.setMode('fill');\r\n            } else if (activeStr === 'text') {\r\n                klCanvasWorkspace.setMode('text');\r\n            } else if (activeStr === 'shape') {\r\n                klCanvasWorkspace.setMode('shape');\r\n            } else {\r\n                throw new Error('unknown activeStr');\r\n            }\r\n            mainTabRow.open(activeStr);\r\n            updateMainTabVisibility();\r\n            klColorSlider.pickingDone();\r\n        },\r\n        onZoomIn: function() {\r\n            klCanvasWorkspace.zoomByStep(keyListener.isPressed('shift') ? 1/8 : 1/2);\r\n        },\r\n        onZoomOut: function() {\r\n            klCanvasWorkspace.zoomByStep(keyListener.isPressed('shift') ? -1/8 : -1/2);\r\n        },\r\n        onUndo: function() {\r\n            undoRedoCatchup.undo();\r\n        },\r\n        onRedo: function() {\r\n            undoRedoCatchup.redo();\r\n        }\r\n    });\r\n    toolspaceToolRow.setIsSmall(uiHeight < 540);\r\n    klHistory.addListener(function() {\r\n        toolspaceToolRow.setEnableUndo(klHistory.canUndo());\r\n        toolspaceToolRow.setEnableRedo(klHistory.canRedo());\r\n    });\r\n    BB.addClassName(toolspaceToolRow.getElement(), 'toolspace-row-shadow');\r\n    toolspaceInner.appendChild(toolspaceToolRow.getElement());\r\n\r\n    let klColorSlider;\r\n\r\n    function setCurrentBrush(brushId) {\r\n        if (brushId !== 'eraserBrush') {\r\n            lastNonEraserBrushId = brushId;\r\n        }\r\n\r\n        if (klColorSlider) {\r\n            if (brushId === 'eraserBrush') {\r\n                klColorSlider.enable(false);\r\n            } else {\r\n                klColorSlider.enable(true);\r\n            }\r\n        }\r\n\r\n        currentBrushId = brushId;\r\n        currentBrush = brushUiObj[brushId];\r\n        currentBrush.setColor(currentColor);\r\n        currentBrush.setContext(currentLayerCtx);\r\n        klCanvasWorkspace.setMode('draw');\r\n        toolspaceToolRow.setActive('draw');\r\n        updateMainTabVisibility();\r\n    }\r\n\r\n    function setCurrentLayer(layer) { //BrushContext(p_context) {\r\n        currentLayerCtx = layer.context;\r\n        currentBrush.setContext(layer.context);\r\n        layerPreview.setLayer(layer);\r\n    }\r\n\r\n    function setBrushColor(p_color) {\r\n        currentColor = p_color;\r\n        currentBrush.setColor(p_color);\r\n        brushSettingService.emitColor(p_color);\r\n        klColorSlider.pickingDone();\r\n    }\r\n\r\n    klColorSlider = new KL.KlColorSlider({\r\n        width: 250,\r\n        height: 30,\r\n        svHeight: 100,\r\n        startValue: new BB.RGB(0, 0, 0),\r\n        onPick: setBrushColor\r\n    });\r\n    klColorSlider.setHeight(Math.max(163, Math.min(400, uiHeight - 505)));\r\n    klColorSlider.setPickCallback(function (doPick) {\r\n\r\n        if (doPick) {\r\n            klCanvasWorkspace.setMode('pick');\r\n        } else {\r\n            klCanvasWorkspace.setMode(toolspaceToolRow.getActive());\r\n            updateMainTabVisibility();\r\n        }\r\n\r\n    });\r\n    let brushDiv = document.createElement(\"div\");\r\n    let colorDiv = document.createElement(\"div\");\r\n    BB.css(colorDiv, {\r\n        margin: '10px',\r\n        display: 'flex',\r\n        flexWrap: 'wrap',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'flex-end'\r\n    });\r\n    let toolspaceStabilizerRow = new KL.ToolspaceStabilizerRow({\r\n        smoothing: 1,\r\n        onSelect: function(v) {\r\n            lineSmoothing.setSmoothing(translateSmoothing(v));\r\n        }\r\n    });\r\n\r\n\r\n    brushDiv.appendChild(colorDiv);\r\n    BB.append(\r\n        colorDiv,\r\n        [klColorSlider.getElement(), klColorSlider.getOutputElement(), toolspaceStabilizerRow.getElement()]\r\n    );\r\n\r\n    let brushTabRow = new KL.TabRow({\r\n        initialId: 'penBrush',\r\n        useAccent: true,\r\n        tabArr: (function () {\r\n            let result = [];\r\n\r\n            function createTab(keyStr) {\r\n                return {\r\n                    id: keyStr,\r\n                    image: KL.brushesUI[keyStr].image,\r\n                    title: KL.brushesUI[keyStr].tooltip,\r\n                    onOpen: function() {\r\n                        brushUiObj[keyStr].getElement().style.display = 'block';\r\n                        setCurrentBrush(keyStr);\r\n                        klColorSlider.pickingDone();\r\n                        brushSettingService.emitSliderConfig({\r\n                            sizeSlider: KL.brushesUI[keyStr].sizeSlider,\r\n                            opacitySlider: KL.brushesUI[keyStr].opacitySlider\r\n                        });\r\n                        sizeWatcher(brushUiObj[keyStr].getSize());\r\n                        brushSettingService.emitOpacity(brushUiObj[keyStr].getOpacity());\r\n                    },\r\n                    onClose: function() {\r\n                        brushUiObj[keyStr].getElement().style.display = 'none';\r\n                    }\r\n                };\r\n            }\r\n\r\n            let keyArr = Object.keys(brushUiObj);\r\n            for (let i = 0; i < keyArr.length; i++) {\r\n                result.push(createTab(keyArr[i]));\r\n            }\r\n            return result;\r\n        })()\r\n    });\r\n    brushDiv.appendChild(brushTabRow.getElement());\r\n    for (let b in KL.brushesUI) {\r\n        if (KL.brushesUI.hasOwnProperty(b)) {\r\n            brushDiv.appendChild(brushUiObj[b].getElement());\r\n        }\r\n    }\r\n\r\n    const handUi = new KL.HandUi({\r\n        scale: 1,\r\n        angleDeg: 0,\r\n        onReset: function() {\r\n            klCanvasWorkspace.resetView(true);\r\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n        },\r\n        onFit: function() {\r\n            klCanvasWorkspace.fitView();\r\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n        },\r\n        onAngleChange: function(angleDeg, isRelative) {\r\n            klCanvasWorkspace.setAngle(angleDeg, isRelative);\r\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n        },\r\n    });\r\n\r\n    let fillUi = new KL.FillUi({\r\n        colorSlider: klColorSlider\r\n    });\r\n\r\n    let textUi = new KL.TextUi({\r\n        colorSlider: klColorSlider\r\n    });\r\n\r\n    let shapeUi = new KL.ShapeUi({\r\n        colorSlider: klColorSlider\r\n    });\r\n\r\n    let shapeTool = new KL.ShapeTool({\r\n        onShape: function(isDone, x1, y1, x2, y2, angleRad) {\r\n\r\n            let layerIndex = klCanvas.getLayerIndex(currentLayerCtx.canvas);\r\n\r\n            let shapeObj: any = {\r\n                type: shapeUi.getShape(),\r\n                x1: x1,\r\n                y1: y1,\r\n                x2: x2,\r\n                y2: y2,\r\n                angleRad: angleRad,\r\n                isOutwards: shapeUi.getIsOutwards(),\r\n                opacity: shapeUi.getOpacity(),\r\n                isEraser: shapeUi.getIsEraser()\r\n            };\r\n            if (shapeUi.getShape() === 'line') {\r\n                shapeObj.strokeRgb = klColorSlider.getColor();\r\n                shapeObj.lineWidth = shapeUi.getLineWidth();\r\n                shapeObj.isAngleSnap = shapeUi.getIsSnap() || keyListener.isPressed('shift');\r\n            } else {\r\n                shapeObj.isFixedRatio = shapeUi.getIsFixed() || keyListener.isPressed('shift');\r\n                if (shapeUi.getMode() === 'stroke') {\r\n                    shapeObj.strokeRgb = klColorSlider.getColor();\r\n                    shapeObj.lineWidth = shapeUi.getLineWidth();\r\n                } else {\r\n                    shapeObj.fillRgb = klColorSlider.getColor();\r\n                }\r\n            }\r\n\r\n            if (isDone) {\r\n                klCanvas.setComposite(layerIndex, null);\r\n                klCanvas.drawShape(layerIndex, shapeObj);\r\n            } else {\r\n                klCanvas.setComposite(layerIndex, {\r\n                    draw: function(ctx) {\r\n                        KL.drawShape(ctx, shapeObj);\r\n                    }\r\n                });\r\n            }\r\n            klCanvasWorkspace.requestFrame();\r\n\r\n        }\r\n    });\r\n\r\n    const layerManager = KL.klLayerManager(klCanvas, function (val) {\r\n        setCurrentLayer(klCanvas.getLayer(val));\r\n        klHistory.push({\r\n            tool: [\"misc\"],\r\n            action: \"focusLayer\",\r\n            params: [val]\r\n        });\r\n    }, klRootEl) as any;\r\n    const layerPreview = new KL.LayerPreview({\r\n        klRootEl: klRootEl,\r\n        onClick: function () {\r\n            mainTabRow.open('layers');\r\n        }\r\n    });\r\n    layerPreview.setIsVisible(uiHeight >= 579);\r\n    layerPreview.setLayer(klCanvas.getLayer(klCanvas.getLayerIndex(currentLayerCtx.canvas)));\r\n\r\n    const filterTab = new KL.FilterTab(\r\n        klRootEl,\r\n        klColorSlider,\r\n        layerManager,\r\n        setCurrentLayer,\r\n        klCanvasWorkspace,\r\n        handUi,\r\n        () => { //get current color\r\n            return currentColor;\r\n        },\r\n        () => { // get max canvas size\r\n            return klMaxCanvasSize;\r\n        },\r\n        () => { // get kl canvas\r\n            return klCanvas;\r\n        },\r\n        () => { // get current layer ctx\r\n            return currentLayerCtx;\r\n        },\r\n        !!pOptions.embed,\r\n        statusOverlay,\r\n    );\r\n\r\n    const undoRedoCatchup = new KL.UndoRedoCatchup(\r\n        brushUiObj,\r\n        layerPreview,\r\n        layerManager,\r\n        handUi,\r\n        klCanvasWorkspace,\r\n        () => {\r\n            if (!initState) {\r\n                throw new Error('initState not initialized');\r\n            }\r\n            return initState;\r\n        },\r\n        () => klCanvas,\r\n        () => currentLayerCtx,\r\n        (clctx) => {\r\n            currentLayerCtx = clctx;\r\n        },\r\n        () => currentBrush,\r\n    );\r\n    klHistory.addListener((p) => {\r\n        undoRedoCatchup.catchup(p);\r\n    });\r\n\r\n    function showNewImageDialog() {\r\n        KL.newImageDialog({\r\n            currentColor: currentColor,\r\n            secondaryColor: klColorSlider.getSecondaryRGB(),\r\n            maxCanvasSize: klMaxCanvasSize,\r\n            canvasWidth: klCanvas.getWidth(),\r\n            canvasHeight: klCanvas.getHeight(),\r\n            workspaceWidth: window.innerWidth < collapseThreshold ? uiWidth : uiWidth - toolWidth,\r\n            workspaceHeight: uiHeight,\r\n            onConfirm: function(width, height, color) {\r\n                klCanvas.reset({\r\n                    width: width,\r\n                    height: height,\r\n                    color: color.a === 1 ? color : null\r\n                });\r\n\r\n                layerManager.update(0);\r\n                setCurrentLayer(klCanvas.getLayer(0));\r\n                klCanvasWorkspace.resetView();\r\n                handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n\r\n                isFirstImage = false;\r\n            },\r\n            onCancel: function() {}\r\n        });\r\n    }\r\n\r\n    function shareImage(callback?) {\r\n        BB.shareCanvas({\r\n            canvas: klCanvas.getCompleteCanvas(1),\r\n            fileName: BB.getDate() + filenameBase + '.png',\r\n            title: BB.getDate() + filenameBase + '.png',\r\n            callback: callback ? callback : function() {}\r\n        });\r\n    }\r\n\r\n    const saveToComputer = new KL.SaveToComputer(\r\n        pOptions.saveReminder,\r\n        klRootEl,\r\n        () => exportType,\r\n        () => klCanvas,\r\n        filenameBase,\r\n    );\r\n\r\n    const fileTab = pOptions.embed ? null : new KL.FileTab(\r\n        klRootEl,\r\n        projectStore,\r\n        () => klCanvas.getProject(),\r\n        exportType,\r\n        (type) => {\r\n            exportType = type;\r\n        },\r\n        handleFileSelect,\r\n        () => {\r\n            saveToComputer.save();\r\n        },\r\n        showNewImageDialog,\r\n        shareImage,\r\n        () => { // on upload\r\n            KL.imgurUpload(klCanvas, klRootEl, pOptions.saveReminder, pOptions.app && pOptions.app.imgurKey ? pOptions.app.imgurKey : null, );\r\n        },\r\n        copyToClipboard,\r\n        pOptions.saveReminder,\r\n    );\r\n\r\n    const settingsTab = new KL.SettingsTab(\r\n        () => {\r\n            uiState = uiState === 'left' ? 'right' : 'left';\r\n            updateUi();\r\n            if (!pOptions.embed) {\r\n                LocalStorage.setItem('uiState', uiState);\r\n            }\r\n        },\r\n        pOptions.aboutEl\r\n    );\r\n\r\n    mainTabRow = new KL.TabRow({\r\n        initialId: 'draw',\r\n        tabArr: [\r\n            {\r\n                id: 'draw',\r\n                title: LANG('tool-brush'),\r\n                image: toolPaintImg,\r\n                onOpen: function() {\r\n                    if (currentBrushId === 'eraserBrush') {\r\n                        klColorSlider.enable(false);\r\n                    }\r\n                    BB.append(\r\n                        colorDiv,\r\n                        [klColorSlider.getElement(), klColorSlider.getOutputElement(), toolspaceStabilizerRow.getElement()]\r\n                    );\r\n                    brushDiv.style.display = 'block';\r\n                },\r\n                onClose: function() {\r\n                    brushDiv.style.display = 'none';\r\n                },\r\n                css: {\r\n                    minWidth: '45px',\r\n                }\r\n            },\r\n            {\r\n                id: 'hand',\r\n                title: LANG('tool-hand'),\r\n                image: toolHandImg,\r\n                isVisible: false,\r\n                onOpen: function() {\r\n                    handUi.setIsVisible(true);\r\n                },\r\n                onClose: function() {\r\n                    handUi.setIsVisible(false);\r\n                },\r\n                css: {\r\n                    minWidth: '45px',\r\n                }\r\n            },\r\n            {\r\n                id: 'fill',\r\n                title: LANG('tool-paint-bucket'),\r\n                image: toolFillImg,\r\n                isVisible: false,\r\n                onOpen: function() {\r\n                    klColorSlider.enable(true);\r\n                    fillUi.setIsVisible(true);\r\n                },\r\n                onClose: function() {\r\n                    fillUi.setIsVisible(false);\r\n                },\r\n                css: {\r\n                    minWidth: '45px',\r\n                }\r\n            },\r\n            {\r\n                id: 'text',\r\n                title: LANG('tool-text'),\r\n                image: toolTextImg,\r\n                isVisible: false,\r\n                onOpen: function() {\r\n                    klColorSlider.enable(true);\r\n                    textUi.setIsVisible(true);\r\n                },\r\n                onClose: function() {\r\n                    textUi.setIsVisible(false);\r\n                },\r\n                css: {\r\n                    minWidth: '45px',\r\n                }\r\n            },\r\n            {\r\n                id: 'shape',\r\n                title: LANG('tool-shape'),\r\n                image: toolShapeImg,\r\n                isVisible: false,\r\n                onOpen: function() {\r\n                    klColorSlider.enable(true);\r\n                    shapeUi.setIsVisible(true);\r\n                },\r\n                onClose: function() {\r\n                    shapeUi.setIsVisible(false);\r\n                },\r\n                css: {\r\n                    minWidth: '45px',\r\n                }\r\n            },\r\n            {\r\n                id: 'layers',\r\n                title: LANG('tab-layers'),\r\n                image: tabLayersImg,\r\n                onOpen: function() {\r\n                    layerManager.update();\r\n                    layerManager.style.display = 'block';\r\n                },\r\n                onClose: function() {\r\n                    layerManager.style.display = 'none';\r\n                },\r\n                css: {\r\n                    minWidth: '45px',\r\n                }\r\n            },\r\n            {\r\n                id: 'edit',\r\n                label: LANG('tab-edit'),\r\n                onOpen: function() {\r\n                    filterTab.show();\r\n                },\r\n                onClose: function() {\r\n                    filterTab.hide();\r\n                },\r\n                css: {\r\n                    padding: '0 7px',\r\n                },\r\n            },\r\n            {\r\n                id: 'file',\r\n                label: LANG('tab-file'),\r\n                isVisible: !!fileTab,\r\n                onOpen: function() {\r\n                    if (!fileTab) {\r\n                        return;\r\n                    }\r\n                    fileTab.getElement().style.display = 'block';\r\n                    fileTab.setIsVisible(true);\r\n                },\r\n                onClose: function() {\r\n                    if (!fileTab) {\r\n                        return;\r\n                    }\r\n                    fileTab.getElement().style.display = 'none';\r\n                    fileTab.setIsVisible(false);\r\n                },\r\n                css: {\r\n                    padding: '0 7px',\r\n                },\r\n            },\r\n            {\r\n                id: 'settings',\r\n                title: LANG('tab-settings'),\r\n                image: tabSettingsImg,\r\n                onOpen: function() {\r\n                    settingsTab.getElement().style.display = 'block';\r\n                    // settingsTab.setIsVisible(true);\r\n                },\r\n                onClose: function() {\r\n                    settingsTab.getElement().style.display = 'none';\r\n                    // settingsTab.setIsVisible(false);\r\n                },\r\n                css: {\r\n                    minWidth: '45px',\r\n                }\r\n            }\r\n        ]\r\n    });\r\n    function updateMainTabVisibility() {\r\n        if (!mainTabRow) {\r\n            return;\r\n        }\r\n\r\n        let toolObj = {\r\n            'draw': {},\r\n            'hand': {},\r\n            'fill': {},\r\n            'text': {},\r\n            'shape': {}\r\n        };\r\n\r\n        let activeStr = toolspaceToolRow.getActive();\r\n        let oldTabId = mainTabRow.getOpenedTabId();\r\n\r\n        let keysArr = Object.keys(toolObj);\r\n        for (let i = 0; i < keysArr.length; i++) {\r\n            if (activeStr === keysArr[i]) {\r\n                mainTabRow.setIsVisible(keysArr[i], true);\r\n            } else {\r\n                mainTabRow.setIsVisible(keysArr[i], false);\r\n                if (oldTabId === keysArr[i]) {\r\n                    mainTabRow.open(activeStr);\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    function copyToClipboard(showCrop?) {\r\n        KL.clipboardDialog(klRootEl, klCanvas.getCompleteCanvas(1), function (inputObj) {\r\n            if (inputObj.left === 0 && inputObj.right === 0 && inputObj.top === 0 && inputObj.bottom === 0) {\r\n                return;\r\n            }\r\n            //do a crop\r\n            let p = {\r\n                context: currentLayerCtx,\r\n                canvas: klCanvas,\r\n                input: inputObj, //{left,right,top,bottom}\r\n                history: klHistory\r\n            };\r\n            KL.filterLib.cropExtend.apply(p);\r\n            layerManager.update();\r\n            klCanvasWorkspace.resetView();\r\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n        }, statusOverlay, showCrop);\r\n    }\r\n\r\n    const bottomBarWrapper = BB.el({\r\n        css: {\r\n            width: \"270px\",\r\n            position: \"absolute\",\r\n            bottom: '0',\r\n            left: '0'\r\n        },\r\n    });\r\n    if (pOptions.bottomBar) {\r\n        bottomBarWrapper.append(pOptions.bottomBar);\r\n        const observer = new MutationObserver(() => updateBottomBar());\r\n        observer.observe(\r\n            toolspaceInner,\r\n            {\r\n                attributes: true,\r\n                childList: true,\r\n                subtree: true,\r\n            }\r\n        );\r\n    }\r\n    function updateBottomBar() {\r\n        if (!pOptions.bottomBar) {\r\n            return;\r\n        }\r\n        const threshold = 617; //590\r\n        const isVisible = (\r\n            threshold < window.innerHeight &&\r\n            toolspaceInner.scrollHeight + 50 < window.innerHeight\r\n        );\r\n        bottomBarWrapper.style.display = isVisible ? '' : 'none';\r\n    }\r\n\r\n\r\n\r\n    BB.append(toolspaceInner, [\r\n        layerPreview.getElement(),\r\n        mainTabRow.getElement(),\r\n        brushDiv,\r\n        handUi.getElement(),\r\n        fillUi.getElement(),\r\n        textUi.getElement(),\r\n        shapeUi.getElement(),\r\n        layerManager,\r\n        filterTab.getElement(),\r\n        fileTab ? fileTab.getElement() : null,\r\n        settingsTab.getElement(),\r\n        BB.el({\r\n            css: {\r\n                height: '10px', // a bit of spacing at the bottom\r\n            }\r\n        }),\r\n        bottomBarWrapper ? bottomBarWrapper : null\r\n    ]);\r\n\r\n    const toolspaceScroller = new KL.ToolspaceScroller({\r\n        toolspace,\r\n        uiState,\r\n    });\r\n\r\n    // --- interface ---\r\n\r\n    this.getEl = () => {\r\n        return klRootEl;\r\n    };\r\n\r\n    this.resize = (w, h) => {\r\n\r\n        // iPad scrolls down when increasing text zoom\r\n        if (window.scrollY > 0) {\r\n            window.scrollTo(0, 0);\r\n        }\r\n\r\n        if (uiWidth === Math.max(0, w) && uiHeight === Math.max(0, h)) {\r\n            return;\r\n        }\r\n\r\n        uiWidth = Math.max(0, w);\r\n        uiHeight = Math.max(0, h);\r\n\r\n        updateCollapse();\r\n        updateBottomBar();\r\n\r\n        layerPreview.setIsVisible(uiHeight >= 579);\r\n        klColorSlider.setHeight(Math.max(163, Math.min(400, uiHeight - 505)));\r\n        toolspaceToolRow.setIsSmall(uiHeight < 540);\r\n    };\r\n\r\n    this.out = (msg) => {\r\n        statusOverlay.out(msg);\r\n    };\r\n\r\n    this.getPNG = function(): Blob {\r\n        return base64ToBlob(klCanvas.getCompleteCanvas(1).toDataURL('image/png'));\r\n    };\r\n\r\n    this.getPSD = async function() {\r\n        return await klCanvasToPsdBlob(klCanvas);\r\n    };\r\n\r\n    this.swapUiLeftRight = () => {\r\n        uiState = uiState === 'left' ? 'right' : 'left';\r\n        if (!pOptions.embed) {\r\n            LocalStorage.setItem('uiState', uiState);\r\n        }\r\n        updateUi();\r\n    };\r\n\r\n    this.saveAsPsd = () => {\r\n        saveToComputer.save('psd');\r\n    };\r\n\r\n    this.isDrawing = () => {\r\n        return lineSanitizer.getIsDrawing() || klCanvasWorkspace.getIsDrawing();\r\n    };\r\n\r\n    // --- end interface ---\r\n\r\n    this.resize(uiWidth, uiHeight);\r\n    updateUi();\r\n\r\n    {\r\n        BB.addEventListener(window, 'resize', () => {\r\n            this.resize(window.innerWidth, window.innerHeight);\r\n        });\r\n        BB.addEventListener(window, 'orientationchange', () => {\r\n            this.resize(window.innerWidth, window.innerHeight);\r\n        });\r\n\r\n        // iPad doesn't trigger 'resize' event when using text zoom, although it's resizing the window.\r\n        // Workaround: place a div in the body that fills the window, and use a ResizeObserver\r\n        const windowResizeWatcher = BB.el({\r\n            parent: document.body,\r\n            css: {\r\n                position: 'fixed',\r\n                left: '0',\r\n                top: '0',\r\n                right: '0',\r\n                bottom: '0',\r\n                pointerEvents: 'none',\r\n                zIndex: '-1',\r\n                userSelect: 'none',\r\n            }\r\n        });\r\n        try {\r\n            // Not all browsers support ResizeObserver. Not critical though.\r\n            const observer = new ResizeObserver(() => this.resize(window.innerWidth, window.innerHeight));\r\n            observer.observe(windowResizeWatcher);\r\n        } catch (e) {\r\n            windowResizeWatcher.parentNode.removeChild(windowResizeWatcher);\r\n        }\r\n\r\n        // prevent ctrl scroll -> zooming page\r\n        BB.addEventListener(this.getEl(), 'wheel', (event) => {\r\n            event.preventDefault();\r\n        });\r\n        //maybe prevent zooming on safari mac os - I can't test it\r\n        const prevent = (e) => {\r\n            e.preventDefault();\r\n        }\r\n        window.addEventListener('gesturestart', prevent);\r\n        window.addEventListener('gesturechange', prevent);\r\n        window.addEventListener('gestureend', prevent);\r\n    }\r\n}","import {DecoyKlHistory, klHistory} from './history/kl-history';\r\nimport {Popup, popup} from './ui/modals/popup';\r\nimport {dialogCounter} from './ui/modals/modal-count';\r\nimport {Checkbox} from './ui/base-components/checkbox';\r\nimport {input} from './ui/base-components/input';\r\nimport {Select} from './ui/base-components/select';\r\nimport {ImageToggle} from './ui/base-components/image-toggle';\r\nimport {ImageRadioList} from './ui/base-components/image-radio-list';\r\nimport {penPressureToggle} from './ui/base-components/pen-pressure-toggle';\r\nimport {KlSlider} from './ui/base-components/kl-slider';\r\nimport {calcSliderFalloffFactor} from './ui/base-components/slider-falloff';\r\nimport {HexColorDialog} from './ui/modals/color-slider-hex-dialog';\r\nimport {KlColorSlider} from './ui/base-components/kl-color-slider';\r\nimport {KlSmallColorSlider} from './ui/base-components/kl-color-slider-small';\r\nimport {PointSlider} from './ui/base-components/point-slider';\r\nimport {ColorOptions} from './ui/base-components/color-options';\r\nimport {Options} from './ui/base-components/options';\r\nimport {StatusOverlay} from './ui/components/status-overlay';\r\nimport {exportDialog} from './ui/modals/export-dialog-deprecated';\r\nimport {CropCopy} from './ui/components/crop-copy';\r\nimport {clipboardDialog} from './ui/modals/clipboard-dialog';\r\nimport {klLayerManager} from './ui/tool-tabs/kl-layer-manager';\r\nimport {WorkspaceSvgOverlay} from './canvas-ui/workspace-svg-overlay';\r\nimport {KlCanvasWorkspace} from './canvas-ui/kl-canvas-workspace';\r\nimport {KlCanvasPreview} from './canvas-ui/canvas-preview';\r\nimport {FreeTransform} from './ui/components/free-transform';\r\nimport {FreeTransformCanvas} from './ui/components/free-transform-canvas';\r\nimport {Cropper} from './ui/components/cropper';\r\nimport {LayerPreview} from './ui/components/layer-preview';\r\nimport {FittedImage} from './ui/components/fitted-image';\r\nimport {showImportAsLayerDialog} from './ui/modals/show-import-as-layer-dialog';\r\nimport {KlImageDropper} from './ui/components/kl-image-dropper';\r\nimport {OverlayToolspace} from './ui/components/overlay-toolspace';\r\nimport {ToolspaceTopRow} from './ui/components/toolspace-top-row';\r\nimport {ToolDropdown} from './ui/components/tool-dropdown';\r\nimport {ToolspaceToolRow} from './ui/components/toolspace-tool-row';\r\nimport {ToolspaceStabilizerRow} from './ui/components/toolspace-stabilizer-row';\r\nimport {TabRow} from './ui/components/tab-row';\r\nimport {HandUi} from './ui/tool-tabs/hand-ui';\r\nimport {FillUi} from './ui/tool-tabs/fill-ui';\r\nimport {TextUi} from './ui/tool-tabs/text-ui';\r\nimport {ShapeUi} from './ui/tool-tabs/shape-ui';\r\nimport {newImageDialog} from './ui/modals/new-image-dialog';\r\nimport {ToolspaceCollapser} from './ui/components/toolspace-collapser';\r\nimport {renderText} from './image-operations/render-text';\r\nimport {textToolDialog} from './ui/modals/text-tool-dialog';\r\nimport {showImportImageDialog} from './ui/modals/show-import-image-dialog';\r\nimport {floodFillBits} from './image-operations/flood-fill';\r\nimport * as PSD from './storage/psd';\r\nimport {drawShape, ShapeTool} from './image-operations/shape-tool';\r\nimport {KlCanvas} from './canvas/kl-canvas';\r\nimport * as indexedDb from './storage/indexed-db';\r\nimport {filterLib, filterLibStatus} from './filters/filters';\r\nimport {brushes} from './brushes/brushes';\r\nimport {brushesUI} from './brushes-ui/brushes-ui';\r\nimport {showIframePopup} from './ui/modals/show-iframe-popup';\r\nimport {RadioList} from './ui/base-components/radio-list';\r\nimport {BrowserStorageUi} from './ui/components/browser-storage-ui';\r\nimport {drawProject} from './canvas/draw-project';\r\nimport {ProjectStore} from './storage/project-store';\r\nimport {FileTab} from \"./ui/tool-tabs/file-tab\";\r\nimport {FilterTab} from \"./ui/tool-tabs/filter-tab\";\r\nimport {imgurUpload} from \"./ui/modals/imgur-upload\";\r\nimport {loadAgPsd} from \"./storage/ag-psd-wrapper\";\r\nimport {SaveReminder} from \"./ui/components/save-reminder\";\r\nimport {SaveToComputer} from \"./storage/save-to-computer\";\r\nimport {UndoRedoCatchup} from \"./history/undo-redo-catchup\";\r\nimport {setDbName} from './storage/indexed-db';\r\nimport {BrushSettingService} from './brushes-ui/brush-setting-service';\r\nimport {BoxToggle} from './ui/base-components/box-toggle';\r\nimport {SettingsTab} from './ui/tool-tabs/settings-tab';\r\nimport {ToolspaceScroller} from './ui/components/toolspace-scroller';\r\n\r\n/**\r\n * paint tool functionality\r\n */\r\nexport const KL = {\r\n\r\n    // --- brushes ---\r\n    brushes,\r\n    brushesUI,\r\n    BrushSettingService,\r\n\r\n    // --- canvas ---\r\n    KlCanvas,\r\n    drawProject,\r\n\r\n    // --- canvas ui ---\r\n    WorkspaceSvgOverlay,\r\n    KlCanvasWorkspace,\r\n    KlCanvasPreview,\r\n\r\n    // --- filters ---\r\n    filterLibStatus,\r\n    filterLib,\r\n\r\n    // --- history ---\r\n    UndoRedoCatchup,\r\n\r\n    // --- image operations ---\r\n    renderText,\r\n    floodFillBits,\r\n    ShapeTool,\r\n    drawShape,\r\n\r\n    // --- storage ---\r\n    PSD,\r\n    setDbName,\r\n    indexedDb,\r\n    ProjectStore,\r\n    loadAgPsd,\r\n    SaveToComputer,\r\n\r\n    // --- ui - base components ---\r\n    calcSliderFalloffFactor,\r\n    Checkbox,\r\n    input,\r\n    Select,\r\n    ImageToggle,\r\n    ImageRadioList,\r\n    RadioList,\r\n    penPressureToggle,\r\n    KlSlider,\r\n    HexColorDialog,\r\n    KlColorSlider,\r\n    KlSmallColorSlider,\r\n    PointSlider,\r\n    ColorOptions,\r\n    Options,\r\n    BoxToggle,\r\n\r\n    // --- ui - components ---\r\n    StatusOverlay,\r\n    CropCopy,\r\n    FreeTransform,\r\n    FreeTransformCanvas,\r\n    Cropper,\r\n    LayerPreview,\r\n    FittedImage,\r\n    KlImageDropper,\r\n    OverlayToolspace,\r\n    ToolspaceTopRow,\r\n    ToolDropdown,\r\n    ToolspaceToolRow,\r\n    ToolspaceStabilizerRow,\r\n    TabRow,\r\n    ToolspaceCollapser,\r\n    BrowserStorageUi,\r\n    SaveReminder,\r\n    ToolspaceScroller,\r\n\r\n    // --- ui - modals ---\r\n    dialogCounter,\r\n    popup,\r\n    Popup,\r\n    exportDialog,\r\n    clipboardDialog,\r\n    showImportAsLayerDialog,\r\n    newImageDialog,\r\n    textToolDialog,\r\n    showImportImageDialog,\r\n    showIframePopup,\r\n    imgurUpload,\r\n\r\n    // --- ui - tool tabs ---\r\n    HandUi,\r\n    FillUi,\r\n    TextUi,\r\n    ShapeUi,\r\n    FileTab,\r\n    FilterTab,\r\n    SettingsTab,\r\n    klLayerManager,\r\n\r\n\r\n    klHistory,\r\n    DecoyKlHistory,\r\n};","\r\nexport interface IHistoryEntry {\r\n    tool: string[];\r\n    action?: string;\r\n    params?: any[];\r\n\r\n    actions?: {\r\n        action: string;\r\n        params: any[];\r\n    }[]\r\n}\r\n\r\nexport interface IHistoryBroadcast {\r\n    bufferUpdate: IHistoryEntry;\r\n}\r\n\r\nexport type IHistoryListener = (p: IHistoryBroadcast | null) => void;\r\n\r\nlet historyInstance: boolean = false;\r\n\r\nexport interface KlHistoryInterface {\r\n    pause (b: boolean): void;\r\n    addListener (l: IHistoryListener): void;\r\n    push (e: IHistoryEntry): void;\r\n    undo (): (IHistoryEntry | null)[];\r\n    redo (): (IHistoryEntry | null)[];\r\n    getAll (): (IHistoryEntry | null)[];\r\n    canRedo (): boolean;\r\n    canUndo (): boolean;\r\n    getState (): number;\r\n    getActionNumber (): number;\r\n}\r\n\r\nexport class DecoyKlHistory implements KlHistoryInterface {\r\n    pause (b: boolean): void {}\r\n    addListener (l: IHistoryListener): void {}\r\n    push (e: IHistoryEntry): void {}\r\n    undo (): (IHistoryEntry | null)[] { return []; }\r\n    redo (): (IHistoryEntry | null)[] { return []; }\r\n    getAll (): (IHistoryEntry | null)[] { return []; }\r\n    canRedo (): boolean { return false; }\r\n    canUndo (): boolean { return false; }\r\n    getState (): number { return 0; }\r\n    getActionNumber (): number { return 0; }\r\n}\r\n\r\nexport class KlHistory implements KlHistoryInterface {\r\n\r\n    private state: number; // on .push state increments by one\r\n    private dataArr: (IHistoryEntry | null)[]; // null if beyond max undo to trigger garbage collection\r\n    private listeners: IHistoryListener[];\r\n    private pauseStack: number; // how often paused without unpause\r\n    private readonly max: number = 20; // max number undo steps\r\n    private maxState: number; // can't go backwards -> max state is the buffer image(klCanvas)\r\n    private actionNumber: number; // current action the user is on. untouched document = -1 because dataArr.length is 0\r\n    \r\n    private broadcast (p: IHistoryBroadcast | null): void {\r\n        setTimeout(() => {\r\n            for (let i = 0; i < this.listeners.length; i++) {\r\n                this.listeners[i](p);\r\n            }\r\n            this.state++;\r\n        }, 1);\r\n    }\r\n    \r\n    // ---- public ----\r\n    \r\n    constructor () {\r\n        if (historyInstance) {\r\n            throw new Error('klHistory already instantiated');\r\n        }\r\n        historyInstance = true;\r\n        this.state = 0;\r\n        this.dataArr = [];\r\n        this.listeners = [];\r\n        this.pauseStack = 0;\r\n        this.maxState = -1;\r\n        this.actionNumber = -1;\r\n    }\r\n\r\n    /**\r\n     * you need pause because there are sometimes actions that would cause other\r\n     * undo steps\r\n     * for example a filter that does something crazy with two layers and then merges them\r\n     * you want that to be one undo step, and prevent merging from causing its undo step.\r\n     * so while that filter is doing its magic you should pause possible undo steps that\r\n     * that are caused by a part of its code(in this example: merging layers)\r\n     *\r\n     * @param b\r\n     */\r\n    pause (b: boolean): void {\r\n        if (b === false) {\r\n            this.pauseStack = Math.max(0, this.pauseStack - 1);\r\n        } else {\r\n            this.pauseStack++;\r\n        }\r\n    }\r\n\r\n    addListener (l: IHistoryListener): void {\r\n        this.listeners.push(l);\r\n    }\r\n\r\n    push (e: IHistoryEntry): void {\r\n        if (this.pauseStack > 0) {\r\n            return;\r\n        }\r\n        while (this.actionNumber < this.dataArr.length - 1) {\r\n            this.dataArr.pop();\r\n        }\r\n\r\n        //taking care of actions that shouldn't cause a new undo step\r\n        const top = this.dataArr[this.dataArr.length - 1];\r\n        if (e.action === 'layerOpacity' && top && top.action === 'layerOpacity' && top.params[0] === e.params[0]) {\r\n            this.dataArr[this.dataArr.length - 1] = e;\r\n            this.state++; //still needs to increment because something changed\r\n            return;\r\n        }\r\n        if (e.action === 'focusLayer' && top && top.action === 'focusLayer') {\r\n            this.dataArr[this.dataArr.length - 1] = e;\r\n            this.state++;\r\n            return;\r\n        }\r\n\r\n\r\n        this.dataArr[this.dataArr.length] = e;\r\n        this.actionNumber = this.dataArr.length - 1;\r\n        const maxBefore = this.maxState;\r\n        this.maxState = Math.max(this.maxState, this.actionNumber - this.max);\r\n        if (maxBefore < this.maxState) {\r\n            this.broadcast({bufferUpdate: this.dataArr[this.maxState]});\r\n        } else {\r\n            this.broadcast(null);\r\n        }\r\n        if (this.maxState >= 0) {\r\n            this.dataArr[this.maxState] = null; //to free some memory...imported images take a lot of space\r\n        }\r\n    }\r\n\r\n    undo (): (IHistoryEntry | null)[] {\r\n        let result;\r\n        if (this.canUndo()) {\r\n            result = [];\r\n            for (let i = this.maxState + 1; i < this.actionNumber; i++) {\r\n                result.push(this.dataArr[i]);\r\n            }\r\n            this.actionNumber--;\r\n            this.broadcast(null);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    redo (): (IHistoryEntry | null)[] {\r\n        const result = [];\r\n        if (this.canRedo()) {\r\n            this.actionNumber++;\r\n            result.push(this.dataArr[this.actionNumber]);\r\n            this.broadcast(null);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    getAll (): (IHistoryEntry | null)[] {\r\n        return [].concat(this.dataArr);\r\n    }\r\n\r\n    canRedo (): boolean {\r\n        return this.actionNumber < this.dataArr.length - 1;\r\n    }\r\n\r\n    canUndo (): boolean {\r\n        return this.actionNumber > this.maxState;\r\n    }\r\n\r\n    getState (): number {\r\n        return this.state;\r\n    }\r\n\r\n    /**\r\n     * actionNumber - number of undo-able actions a user has done (e.g. if drawn 5 lines total -> 5)\r\n     */\r\n    getActionNumber (): number {\r\n        return (this.actionNumber + 1);\r\n    }\r\n    \r\n}\r\n\r\nexport const klHistory = new KlHistory();\r\n","import {dialogCounter} from './modal-count';\r\nimport {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport checkImg from 'url:~/src/app/img/ui/check.svg';\r\n// @ts-ignore\r\nimport cancelImg from 'url:~/src/app/img/ui/cancel.svg';\r\nimport {LANG} from '../../../language/language';\r\nimport {IKeyString} from '../../../bb/bb.types';\r\n\r\nwindow.onscroll = (e) => {\r\n    e.preventDefault();\r\n}\r\n\r\nexport function popup (\r\n    p: {\r\n        target: HTMLElement;\r\n        div?: HTMLElement; // node with content\r\n        message: string; // can be html\r\n        callback?: (result: string) => void;\r\n        buttons?: string[]; // \"Ok\", and \"Cancel\" will be automatically translated\r\n        primaries?: string[];\r\n        type?: 'error' | 'warning' | 'upload' | 'ok'; // todo\r\n        closefunc?: (f: () => void) => void; // returns a function you can call to close (Cancel) the dialog\r\n        style?: IKeyString;\r\n        clickOnEnter?: string; // name of button - will be clicked if enter key pressed\r\n        autoFocus?: false | string; // name of  to automatically focus - default 'Ok' - false -> none\r\n        ignoreBackground?: boolean; // deafult false; if true clicking on background doesn't close\r\n    }\r\n): void {\r\n    dialogCounter.increase();\r\n    let isClosed = false;\r\n\r\n\r\n    // need this extra layer because chrome mobile otherwise scrolls the page and then glitches as the address bar goes away\r\n    const rootRootEl = BB.el({\r\n        parent: document.body,\r\n        css: {\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0',\r\n            right: '0',\r\n            bottom: '0',\r\n            overflow: 'hidden',\r\n        }\r\n    });\r\n    const rootEl = BB.el({\r\n        parent: rootRootEl,\r\n        className: 'kl-popup',\r\n    });\r\n\r\n    const scrollContent = BB.el({\r\n        parent: rootEl,\r\n        css: {\r\n            width: '100%',\r\n            minHeight: '100%',\r\n            // padding: '10px 0',\r\n            position: 'relative',\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            justifyContent: 'center',\r\n            alignItems: 'center',\r\n        }\r\n    });\r\n\r\n    const bgEl = BB.el({\r\n        parent: scrollContent,\r\n        onClick: () => {\r\n            if (p.ignoreBackground) {\r\n                return;\r\n            }\r\n            close('Cancel');\r\n        },\r\n        css: {\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0',\r\n            zIndex: '0',\r\n            width: '100%',\r\n            height: '100%',\r\n        }\r\n    });\r\n\r\n    const titleHeight = 40;\r\n    const xButton = BB.el({\r\n        tagName: 'button',\r\n        className: 'popup-x',\r\n        content: `<img alt=\"${LANG('modal-close')}\" height=\"20\" src=\"${cancelImg}\">`,\r\n        title: LANG('modal-close'),\r\n        onClick: () => {\r\n            close('Cancel');\r\n        },\r\n        css: {\r\n            width: titleHeight + 'px',\r\n            height: titleHeight + 'px',\r\n            lineHeight: titleHeight + 'px',\r\n            position: 'absolute',\r\n            right: '0',\r\n            top: '0',\r\n            background: 'none',\r\n            boxShadow: 'none',\r\n        }\r\n    });\r\n\r\n    const boxClasses = ['kl-popup-box'];\r\n    boxClasses.push('kl-popup-box--sm');\r\n    const boxEl = BB.el({\r\n        content: [\r\n            xButton,\r\n            BB.el({\r\n                content:p.message,\r\n                css: {\r\n                    marginBottom: p.div ? '10px' : null,\r\n                    marginRight: '15px',\r\n                }\r\n            }),\r\n            p.div,\r\n        ],\r\n        className: boxClasses.join(' '),\r\n        css: p.style ? p.style : null,\r\n    });\r\n\r\n    scrollContent.append(\r\n        BB.el({\r\n            css: {\r\n                flex: '0.5',\r\n            }\r\n        }),\r\n        boxEl,\r\n        BB.el({\r\n            css: {\r\n                flex: '1',\r\n            }\r\n        })\r\n    );\r\n\r\n    if (p.type === 'error') {\r\n        BB.addClassName(boxEl, 'poperror');\r\n    }\r\n    if (p.type === 'ok') {\r\n        BB.addClassName(boxEl, 'popok');\r\n    }\r\n    if (p.type === 'warning') {\r\n        BB.addClassName(boxEl, 'popwarning');\r\n    }\r\n    if (p.type === 'upload') {\r\n        BB.addClassName(boxEl, 'popupload');\r\n    }\r\n\r\n    const keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, e, comboStr) {\r\n            if (isClosed) {\r\n                return;\r\n            }\r\n            if (clickOnEnterBtn && comboStr === 'enter' && !BB.isInputFocused()) {\r\n                e.stopPropagation();\r\n                setTimeout(function() {\r\n                    clickOnEnterBtn.click();\r\n                }, 10);\r\n            }\r\n            if (comboStr === 'esc') {\r\n                e.stopPropagation();\r\n                close('Cancel');\r\n            }\r\n        }\r\n    });\r\n    // prevent ctrl scroll -> zooming page\r\n    const wheelPrevent = (event) => {\r\n        if (keyListener.isPressed('ctrl')) {\r\n            event.preventDefault();\r\n        }\r\n    };\r\n    BB.addEventListener(rootEl, 'wheel', wheelPrevent);\r\n    rootEl.onclick = BB.handleClick;\r\n\r\n    let autoFocus = null;\r\n    if (p.autoFocus) {\r\n        autoFocus = p.autoFocus;\r\n    } else if (p.autoFocus === false) {\r\n        autoFocus = null;\r\n    } else {\r\n        autoFocus = 'Ok';\r\n    }\r\n\r\n    const buttonRowEl = p.buttons && p.buttons.length > 0 ? BB.el({\r\n        parent: boxEl,\r\n        css: {\r\n            display: 'flex',\r\n            flexWrap: 'wrap',\r\n            justifyContent: 'flex-end',\r\n            marginTop: '12px', // 8px already via buttons\r\n            marginLeft: '-8px',\r\n        }\r\n    }) : null;\r\n    let clickOnEnterBtn;\r\n    const btnElArr = [];\r\n    if (p.buttons) {\r\n        p.buttons.forEach(buttonName => {\r\n            const btnClasses = ['kl-popup__btn'];\r\n            if (buttonName === 'Ok' || (p.primaries && p.primaries.includes(buttonName))) {\r\n                btnClasses.push('kl-button-primary');\r\n            }\r\n            let iconUrl;\r\n            let label = buttonName;\r\n            if (buttonName === 'Ok') {\r\n                label = LANG('modal-ok');\r\n                iconUrl = checkImg;\r\n            }\r\n            if (buttonName === 'Cancel') {\r\n                label = LANG('modal-cancel');\r\n                iconUrl = cancelImg;\r\n            }\r\n            let iconImg = null;\r\n            if (iconUrl) {\r\n                iconImg = BB.el({\r\n                    tagName: 'img',\r\n                    custom: {\r\n                        src: iconUrl,\r\n                        height: '17',\r\n                    }\r\n                });\r\n            }\r\n            const btn = BB.el({\r\n                parent: buttonRowEl,\r\n                tagName: 'button',\r\n                className: btnClasses.join(' '),\r\n                content: [iconImg, label],\r\n                onClick: () => {\r\n                    close(buttonName);\r\n                },\r\n            });\r\n            btnElArr.push(btn);\r\n            if (autoFocus === buttonName) {\r\n                setTimeout(() => {\r\n                    btn.focus();\r\n                    rootEl.scrollTo(0, 0);\r\n                }, 10);\r\n                setTimeout(() => {\r\n                    // safari needs a separate timeout\r\n                    rootEl.scrollTo(0, 0);\r\n                }, 20);\r\n            }\r\n            if (buttonName === p.clickOnEnter) {\r\n                clickOnEnterBtn = btn;\r\n            }\r\n        });\r\n    }\r\n\r\n    function close (value: string) {\r\n        if (isClosed) {\r\n            return;\r\n        }\r\n\r\n        isClosed = true;\r\n        BB.clearSelection();\r\n        {\r\n            /*\r\n            Unfocus anything that is focused.\r\n\r\n            If an Input is focused in Firefox, and it gets detached from the DOM via a Node\r\n            that isn't its direct parent, then Firefox will keep anything attached to this\r\n            Input in memory. It will not be garbage collected until a new Input is focused.\r\n\r\n            Workaround: Temporarily create an input, focus it, detach it.\r\n             */\r\n            const focusEl = BB.el({\r\n                parent: document.body,\r\n                tagName: 'input',\r\n                css: {\r\n                    opacity: '0',\r\n                    width: '0',\r\n                    height: '0',\r\n                }\r\n            }) as HTMLInputElement;\r\n            setTimeout(() => {\r\n                focusEl.select();\r\n                focusEl.focus();\r\n                focusEl.parentNode.removeChild(focusEl);\r\n            }, 10);\r\n        }\r\n        document.body.removeChild(rootRootEl);\r\n        dialogCounter.decrease();\r\n        BB.destroyEl(xButton);\r\n        BB.destroyEl(bgEl);\r\n        keyListener.destroy();\r\n        BB.removeEventListener(rootEl, 'wheel', wheelPrevent);\r\n        rootEl.onclick = null;\r\n        btnElArr.forEach(item => {\r\n            BB.destroyEl(item);\r\n        });\r\n        btnElArr.splice(0, btnElArr.length);\r\n\r\n        if (p.callback) {\r\n            p.callback(value);\r\n        }\r\n    }\r\n\r\n    if (p.closefunc) {\r\n        p.closefunc(function () {\r\n            close('Cancel');\r\n        });\r\n    }\r\n\r\n}\r\n\r\n\r\n/**\r\n * popups that fill whole height, with some padding.\r\n * currently only used for iframe popups.\r\n *\r\n * p = {\r\n *      title: DOM Element | string, // optional (todo allow string)\r\n *      icon: 'ok', // optional todo\r\n *      content: DOM Element, // optional\r\n *      buttonArr: [ // optional todo\r\n *          'Ok',\r\n *          'Cancel'\r\n *      ],\r\n *      autoFocus: string | false, //todo\r\n *      clickOnEnter: string, //todo\r\n *      onClose: function(result: string), // optional (todo result)\r\n *\r\n *      //size and position\r\n *      width: 500,\r\n *      isMaxHeight: boolean //todo, currently always true\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const Popup = function(p) {\r\n    dialogCounter.increase();\r\n    const parent = document.body;\r\n    const div = BB.el({\r\n        parent: parent,\r\n        className: 'g-root',\r\n        css: {\r\n            position: 'fixed',\r\n            left: '0',\r\n            top: '0',\r\n            bottom: '0',\r\n            right: '0',\r\n            background: 'rgba(0, 0, 0, 0.45)',\r\n            overflow: 'auto',\r\n            animationName: 'consoleIn',\r\n            animationDuration: '0.3s',\r\n            animationTimingFunction: 'ease-out'\r\n        }\r\n    });\r\n    div.onclick = BB.handleClick;\r\n\r\n    let updateInterval;\r\n\r\n    function close() {\r\n        dialogCounter.decrease();\r\n        div.onclick = null;\r\n        parent.removeChild(div);\r\n        clearInterval(updateInterval);\r\n        window.removeEventListener('resize', updatePos);\r\n        keyListener.destroy();\r\n        BB.destroyEl(xButton);\r\n        BB.destroyEl(bgEl);\r\n        if (p.onClose) {\r\n            p.onClose();\r\n        }\r\n    }\r\n\r\n    //background element registering clicks\r\n    const bgEl = BB.el({\r\n        parent: div,\r\n        css: {\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0',\r\n            bottom: '0',\r\n            right: '0'\r\n        },\r\n        onClick: close\r\n    });\r\n\r\n    //the actual popup box\r\n    const popupEl = BB.el({\r\n        parent: div,\r\n        css: {\r\n            position: 'absolute',\r\n            width: (BB.isCssMinMaxSupported() ?\r\n                'min(calc(100% - 40px), ' + (p.width ? p.width : 400) + 'px)' :\r\n                (p.width ? p.width : 400) + 'px'),\r\n            height: 'calc(100% - 40px)',\r\n            background: '#eee',\r\n            borderRadius: '10px',\r\n            overflow: 'hidden',\r\n            boxShadow: 'rgba(0, 0, 0, 0.25) 0px 5px 60px'\r\n        }\r\n    });\r\n\r\n    //x and y position via script. flex not powerful enough imo\r\n    function updatePos() {\r\n        const elW = popupEl.offsetWidth;\r\n        const elH = popupEl.offsetHeight;\r\n\r\n        BB.css(popupEl, {\r\n            left: Math.max(0, (window.innerWidth - elW) / 2) + 'px',\r\n            top: Math.max(20, (window.innerHeight - elH) / 2 - (elH * 0.20)) + 'px'\r\n        });\r\n    }\r\n    //todo also update when popup changes size - resizeobserver and fallback\r\n    //updateInterval = setInterval(updatePos, 100);\r\n    updatePos();\r\n    window.addEventListener('resize', updatePos);\r\n\r\n    //title row in popup\r\n    const titleHeight = 40;\r\n    const titleEl = BB.el({\r\n        parent: popupEl,\r\n        css: {\r\n            height: titleHeight + 'px',\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            paddingLeft: (titleHeight / 2) + 'px'\r\n        }\r\n    });\r\n    if (p.title) {\r\n        titleEl.appendChild(p.title);\r\n    }\r\n    const xButton = BB.el({\r\n        parent: titleEl,\r\n        tagName: 'button',\r\n        className: 'popup-x',\r\n        content: `<img alt=\"${LANG('modal-close')}\" height=\"20\" src=\"${cancelImg}\">`,\r\n        title: LANG('modal-close'),\r\n        onClick: close,\r\n        css: {\r\n            width: titleHeight + 'px',\r\n            height: titleHeight + 'px',\r\n            lineHeight: titleHeight + 'px',\r\n            background: 'none',\r\n            boxShadow: 'none',\r\n        },\r\n        custom: {\r\n            tabindex: '0',\r\n        }\r\n    });\r\n\r\n    const contentEl = BB.el({\r\n        parent: popupEl,\r\n        css: {\r\n            height: 'calc(100% - ' + titleHeight + 'px)'\r\n        }\r\n    });\r\n    if (p.content) {\r\n        contentEl.appendChild(p.content);\r\n    }\r\n\r\n    const keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, e) {\r\n            if (keyStr === 'esc') {\r\n                e.stopPropagation();\r\n                close();\r\n            }\r\n        }\r\n    });\r\n\r\n\r\n    // --- interface ---\r\n    this.close = function() {\r\n        close();\r\n    };\r\n};","\r\n// not the best\r\n\r\n/**\r\n * how many modals are open\r\n */\r\n\r\nexport class DialogCounter {\r\n    private listeners: ((v: number) => void)[] = [];\r\n    private count = 0;\r\n\r\n    private emit (): void {\r\n        this.listeners.forEach(item => {\r\n            item(this.count);\r\n        });\r\n    }\r\n\r\n    increase (v?: number): void {\r\n        if (v !== undefined) {\r\n            this.count += v;\r\n        } else {\r\n            this.count++;\r\n        }\r\n        this.emit();\r\n    }\r\n    decrease (v?: number): void {\r\n        if (v !== undefined) {\r\n            this.count -= v;\r\n        } else {\r\n            this.count--;\r\n        }\r\n        this.emit();\r\n    }\r\n    get (): number {\r\n        return this.count;\r\n    }\r\n    subscribe (listener: (v: number) => void): void {\r\n        this.listeners.push(listener);\r\n    }\r\n}\r\n\r\nexport const dialogCounter = new DialogCounter();\r\n","import * as BBEventListener from './input/event-listener';\r\nimport {\r\n    addClassName, append, centerWithin, copyObj, createSvg,\r\n    css, dateDayDifference, decToFraction,\r\n    fitInto, gcd, getDate,\r\n    handleClick, imageBlobToUrl,\r\n    insertAfter, loadImage,\r\n    reduce,\r\n    removeClassName, setAttributes, shareCanvas\r\n} from './base/base';\r\nimport {\r\n    canShareFiles,\r\n    eventUsesHighResTimeStamp,\r\n    getVisitor,\r\n    hasPointerEvents,\r\n    hasWebGl,\r\n    isCssMinMaxSupported,\r\n    mouseEventHasMovement\r\n} from './base/browser';\r\nimport {KeyListener, sameKeys} from './input/key-listener';\r\nimport {PointerListener} from './input/pointer-listener';\r\nimport * as EventChain from './input/event-chain';\r\nimport {\r\n    convertToAlphaChannelCanvas,\r\n    copyCanvas,\r\n    createCheckerCanvas, createCheckerDataUrl,\r\n    drawTransformedImageOnCanvas,\r\n    drawTransformedImageWithBounds, freeCanvas, resizeCanvas, testShouldPixelate\r\n} from './base/canvas';\r\nimport {Matrix} from './math/matrix';\r\nimport {Vec2} from './math/vec2';\r\nimport {BezierLine, PointLine, projectPointOnLine, quadraticSplineInput, SplineInterpolator} from './math/line';\r\nimport {CMYK, ColorConverter, HSV, RGB, testIsWhiteBestContrast} from './color/color';\r\nimport {appendTextDiv, clearSelection, destroyEl, el, isInputFocused, makeUnfocusable} from './base/ui';\r\nimport {\r\n    pointsToAngleDeg,\r\n    clamp,\r\n    dist,\r\n    mix,\r\n    pointsToAngleRad,\r\n    rotate,\r\n    rotateAround,\r\n    intDxy,\r\n    roundEven, roundUneven, distSquared, lenSquared, updateBounds, boundsInArea\r\n} from './math/math';\r\nimport {createCanvas} from './base/create-canvas';\r\nimport {BbLog} from './base/bb-log';\r\nimport {LocalStorage} from './base/local-storage';\r\n\r\nexport const BB = {\r\n\r\n    // ---- browser ----\r\n    eventUsesHighResTimeStamp,\r\n    mouseEventHasMovement,\r\n    hasPointerEvents,\r\n    hasWebGl,\r\n    getVisitor,\r\n    isCssMinMaxSupported,\r\n    canShareFiles,\r\n\r\n    // ---- base ----\r\n    insertAfter,\r\n    loadImage,\r\n    css,\r\n    setAttributes,\r\n    addClassName,\r\n    removeClassName,\r\n    append,\r\n    fitInto,\r\n    centerWithin,\r\n    getDate,\r\n    gcd,\r\n    reduce,\r\n    decToFraction,\r\n    imageBlobToUrl,\r\n    dateDayDifference,\r\n    copyObj,\r\n    shareCanvas,\r\n    handleClick,\r\n    createSvg,\r\n    BbLog,\r\n    LocalStorage,\r\n\r\n    // ---- math ----\r\n    mix,\r\n    dist,\r\n    distSquared,\r\n    lenSquared,\r\n    pointsToAngleRad,\r\n    pointsToAngleDeg,\r\n    clamp,\r\n    rotate,\r\n    rotateAround,\r\n    Matrix,\r\n    Vec2,\r\n    intDxy,\r\n    roundEven,\r\n    roundUneven,\r\n    updateBounds,\r\n    boundsInArea,\r\n\r\n    // ---- line ----\r\n    projectPointOnLine,\r\n    PointLine,\r\n    BezierLine,\r\n    SplineInterpolator,\r\n    quadraticSplineInput,\r\n\r\n    // ---- canvas ----\r\n    canvas: createCanvas,\r\n    copyCanvas,\r\n    testShouldPixelate,\r\n    drawTransformedImageWithBounds,\r\n    drawTransformedImageOnCanvas,\r\n    createCheckerCanvas,\r\n    createCheckerDataUrl,\r\n    resizeCanvas,\r\n    convertToAlphaChannelCanvas,\r\n    freeCanvas,\r\n\r\n    // ---- color ----\r\n    HSV,\r\n    RGB,\r\n    CMYK,\r\n    ColorConverter,\r\n    testIsWhiteBestContrast,\r\n\r\n    // ---- UI ----\r\n    appendTextDiv,\r\n    clearSelection,\r\n    makeUnfocusable,\r\n    el,\r\n    destroyEl,\r\n    isInputFocused: isInputFocused,\r\n\r\n\r\n    // ---- events / input ----\r\n\r\n    addEventListener: BBEventListener.addEventListener,\r\n    removeEventListener: BBEventListener.removeEventListener,\r\n    setEventListener: BBEventListener.setEventListener,\r\n\r\n    KeyListener,\r\n    PointerListener,\r\n    sameKeys,\r\n\r\n    EventChain,\r\n\r\n};\r\n","import {hasPointerEvents} from '../base/browser';\r\n\r\nconst listenerFuncObj = {}; // for debugging\r\n\r\nexport const setEventListener = function (DomEl, type, listener) {\r\n    if (!hasPointerEvents) {\r\n        type = type.replace('pointer', 'mouse');\r\n    }\r\n    DomEl[type] = listener;\r\n};\r\n\r\nexport const addEventListener = function (DomEl, type, listener, options?) {\r\n    if (!hasPointerEvents) {\r\n        type = type.replace('pointer', 'mouse');\r\n    }\r\n    /*if (!(type in listenerFuncObj)) {\r\n        listenerFuncObj[type] = [];\r\n    }\r\n    listenerFuncObj[type].push(listener);*/\r\n    DomEl.addEventListener(type, listener, options);\r\n};\r\n\r\nexport const removeEventListener = function (DomEl, type, listener, options?) {\r\n    if (!hasPointerEvents) {\r\n        type = type.replace('pointer', 'mouse');\r\n    }\r\n    /*if (type in listenerFuncObj) {\r\n        for (let i = 0; i < listenerFuncObj[type].length; i++) {\r\n            if (listenerFuncObj[type][i] === listener) {\r\n                listenerFuncObj[type].splice(i, 1);\r\n                i--;\r\n            }\r\n        }\r\n    }*/\r\n    DomEl.removeEventListener(type, listener, options);\r\n};","import {createCanvas} from './create-canvas';\r\n\r\nexport const isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\r\n\r\nexport const eventUsesHighResTimeStamp = (function() {\r\n\r\n    let eventUsesHighResTimeStamp: boolean | null = null;\r\n    if (document.body) {\r\n        (function() {\r\n            const event = new Event('');\r\n            eventUsesHighResTimeStamp = event.timeStamp < 1000 * 60 * 60;\r\n        })();\r\n    } else {\r\n        window.addEventListener('DOMContentLoaded', function(event) {\r\n            eventUsesHighResTimeStamp = event.timeStamp < 1000 * 60 * 60;\r\n        });\r\n    }\r\n\r\n    return function(): boolean {\r\n        if (eventUsesHighResTimeStamp === null) {\r\n            throw 'eventUsesHighResTimeStamp not initialized';\r\n        }\r\n        return eventUsesHighResTimeStamp;\r\n    }\r\n})();\r\n\r\nexport const mouseEventHasMovement = (() => {\r\n\r\n    // no support: IE, Safari, Safari iOS\r\n    // supported but broken: Firefox\r\n\r\n    if (!('MouseEvent' in window)) {\r\n        return false;\r\n    }\r\n    let mouseEvent;\r\n    try {\r\n        mouseEvent = new MouseEvent('mousemove'); // browsers not supporting the constructor don't have it\r\n    } catch (e) {\r\n        return false;\r\n    }\r\n    if (!('movementX' in mouseEvent)) {\r\n        return false; // likely safari\r\n    }\r\n    return !isFirefox;\r\n})();\r\n\r\nexport const hasPointerEvents = !!window.PointerEvent;\r\n\r\nexport const hasWebGl = (function() {\r\n\r\n    const hasWebgl = (function() {\r\n        const canvas = createCanvas();\r\n        try {\r\n            canvas.getContext('experimental-webgl', { premultipliedAlpha: false });\r\n            return true;\r\n        } catch (e) {\r\n            return false;\r\n        }\r\n    })();\r\n\r\n    return function() {\r\n        return hasWebgl;\r\n    }\r\n})();\r\n\r\nexport const getVisitor = (function () {\r\n    const visitor = {\r\n        chrome: false,\r\n        gl: false\r\n    };\r\n    //Chrome\r\n    if ((window as any).chrome && (window as any).chrome.app) {\r\n        visitor.chrome = true;\r\n    }\r\n    //WebGL\r\n    visitor.gl = hasWebGl();\r\n    return function () {\r\n        return JSON.parse(JSON.stringify(visitor));\r\n    }\r\n})();\r\n\r\nexport const isCssMinMaxSupported = (function() {\r\n    let result: boolean | null = null;\r\n\r\n    function test() {\r\n        const div = document.createElement('div');\r\n        div.style.position = 'absolute';\r\n        div.style.top = '0';\r\n        div.style.left = 'max(0px, 25px)';\r\n        document.body.appendChild(div);\r\n        setTimeout(function() {\r\n            result = div.offsetLeft === 25;\r\n            document.body.removeChild(div);\r\n        }, 25);\r\n    }\r\n\r\n    if (document.body) {\r\n        test();\r\n    } else {\r\n        window.addEventListener('DOMContentLoaded', function() {\r\n            test();\r\n        });\r\n    }\r\n\r\n    return function(): boolean {\r\n        if (result === null) {\r\n            throw new Error('isCssMinMaxSupported not initialized');\r\n        }\r\n        return result;\r\n    };\r\n})();\r\n\r\nexport const canShareFiles = function(): boolean {\r\n    return 'share' in navigator && 'canShare' in navigator;\r\n};","/*window['canvases'] = [];\r\n\r\nwindow['printCanvases'] = () => {\r\n    let total = 0;\r\n\r\n    console.log(window['canvases'].map(item => {\r\n        total += item.width * item.height;\r\n        return {w: item.width, h: item.height};\r\n    }));\r\n\r\n    console.log('total: ' + (total * 4 / 1000 / 1000) + 'mb');\r\n};*/\r\n\r\nexport function createCanvas(w?: number, h?: number): HTMLCanvasElement {\r\n    const result = document.createElement('canvas');\r\n    if (w && h) {\r\n        result.width = w;\r\n        result.height = h;\r\n    }\r\n    // window['canvases'].push(result);\r\n    return result;\r\n}","import {IKeyString, ISize2D, ISVG, IVector2D} from '../BB.types';\r\n\r\nexport function insertAfter (referenceNode: Element, newNode: Element): void {\r\n    if (referenceNode.parentNode) {\r\n        referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\r\n    }\r\n}\r\n\r\nexport function loadImage (im: HTMLImageElement, callback: () => void): void {\r\n    let counter = 0;\r\n\r\n    function check() {\r\n        if (counter === 1000) {\r\n            alert(\"couldn't load\");\r\n            return;\r\n        }\r\n        if (im.complete) {\r\n            counter++;\r\n            callback();\r\n        } else {\r\n            setTimeout(check, 1);\r\n        }\r\n    }\r\n\r\n    check();\r\n}\r\n\r\nexport function css (el: HTMLElement | SVGElement, styleObj: IKeyString): void {\r\n    const keyArr = Object.keys(styleObj);\r\n    let keyStr: string;\r\n    const style = (el.style as unknown) as IKeyString;\r\n    for (let i = 0; i < keyArr.length; i++) {\r\n        keyStr = keyArr[i];\r\n        style[keyStr] = styleObj[keyStr];\r\n        style.alignContent = 'true';\r\n        if (keyStr === 'userSelect') {\r\n            style.webkitUserSelect = styleObj[keyStr]; // safari\r\n        }\r\n    }\r\n}\r\n\r\nexport function setAttributes (el: HTMLElement, attrObj: IKeyString): void {\r\n    const keyArr = Object.keys(attrObj);\r\n    let keyStr;\r\n    for (let i = 0; i < keyArr.length; i++) {\r\n        keyStr = keyArr[i];\r\n        el.setAttribute(keyStr, attrObj[keyStr]);\r\n    }\r\n}\r\n\r\nexport function addClassName (el: HTMLElement | SVGElement, classStr: string): void {\r\n    const classAttr = el.getAttribute('class');\r\n    const splitArr = classAttr === null ? [] : classAttr.split(' ');\r\n    if (splitArr.includes(classStr)) {\r\n        return;\r\n    }\r\n    splitArr.push(classStr);\r\n    el.setAttribute('class', splitArr.join(' '));\r\n}\r\n\r\nexport function removeClassName (el: HTMLElement | SVGElement, classStr: string): void {\r\n    const classAttr = el.getAttribute('class');\r\n    const splitArr = classAttr === null ? [] : classAttr.split(' ');\r\n    if (!splitArr.includes(classStr)) {\r\n        return;\r\n    }\r\n    for (let i = 0; i < splitArr.length; i++) {\r\n        if (splitArr[i] === classStr) {\r\n            splitArr.splice(i, 1);\r\n            i--;\r\n        }\r\n    }\r\n    el.setAttribute('class', splitArr.join(' '));\r\n}\r\n\r\n/**\r\n * appendChild with an array\r\n * @param target\r\n * @param els\r\n */\r\nexport function append(target: HTMLElement, els: (HTMLElement | string | null)[]) {\r\n    const fragment = document.createDocumentFragment();\r\n    els.forEach(item => item ? fragment.append(item) : null);\r\n    target.append(fragment);\r\n}\r\n\r\n/**\r\n * a needs to fit into b\r\n * @param aw\r\n * @param ah\r\n * @param bw\r\n * @param bh\r\n * @param min\r\n */\r\nexport function fitInto (aw: number, ah: number, bw: number, bh: number, min?: number): ISize2D {\r\n    let width = aw * bw, height = ah * bw;\r\n    if (width > bw) {\r\n        height = bw / width * height;\r\n        width = bw;\r\n    }\r\n    if (height > bh) {\r\n        width = bh / height * width;\r\n        height = bh;\r\n    }\r\n    if (min) {\r\n        width = Math.max(min, width);\r\n        height = Math.max(min, height);\r\n    }\r\n    return {width, height};\r\n}\r\n\r\n/**\r\n * center b in a\r\n * @param aw\r\n * @param ah\r\n * @param bw\r\n * @param bh\r\n */\r\nexport function centerWithin (aw: number, ah: number, bw: number, bh: number): IVector2D {\r\n    return {\r\n        x: aw / 2 - bw / 2,\r\n        y: ah / 2 - bh / 2\r\n    };\r\n}\r\n\r\nexport function getDate (): string {\r\n    const date = new Date();\r\n    const year = date.getFullYear();\r\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\r\n    const day = date.getDate().toString().padStart(2, '0');\r\n    const minutes = (date.getHours() * 60 + date.getMinutes()).toString(36).padStart(3, '0');\r\n\r\n    return year + '_' + month + '_' + day + '_' + minutes + '_';\r\n}\r\n\r\nexport function gcd (a: number, b: number): number {\r\n    return b ? gcd(b, a % b) : a;\r\n}\r\n\r\nexport function reduce (numerator: number, denominator: number): [number, number] {\r\n    const g = gcd(numerator, denominator);\r\n    return [numerator / g, denominator / g];\r\n}\r\n\r\nexport function decToFraction (decimalNumber: number): [number, number] {\r\n    const len = decimalNumber.toString().length - 2;\r\n    const denominator = Math.pow(10, len);\r\n    const numerator = decimalNumber * denominator;\r\n    return reduce(numerator, denominator);\r\n}\r\n\r\n/**\r\n * blobObj isn't always a Blob, but rather an object, because Blob doesn't exist.\r\n * @param blobObj\r\n * @returns {string}\r\n */\r\nexport function imageBlobToUrl(blobObj: Blob): string {\r\n    if (!blobObj) {\r\n        throw new Error('blobObj is undefined or null');\r\n    }\r\n    if (window.Blob && blobObj instanceof Blob) {\r\n        return URL.createObjectURL(blobObj); // object url\r\n    } else if (blobObj.constructor.name === 'Object') {\r\n        const fauxBlob = (blobObj as unknown) as {type: string, encoding: string, data: string};\r\n        return 'data:' + fauxBlob.type + ';' + fauxBlob.encoding + ',' + fauxBlob.data; // data url\r\n    } else {\r\n        throw new Error('unknown blob format');\r\n    }\r\n}\r\n\r\nexport function dateDayDifference (dateA: string | Date, dateB: string | Date): number {\r\n    dateA = new Date(dateA);\r\n    dateB = new Date(dateB);\r\n    dateA.setHours(0, 0, 0, 0);\r\n    dateB.setHours(0, 0, 0, 0);\r\n    return (dateB.getTime() - dateA.getTime()) / (1000 * 60 * 60 * 24);\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\r\nexport function copyObj (obj: any): any {\r\n    return JSON.parse(JSON.stringify(obj));\r\n}\r\n\r\n/**\r\n * triggers Web Share API - share feature on mobile devices\r\n * Only works if they support file sharing - e.g. Safari can't do this yet\r\n * only call if BB.canShareFiles() -> true\r\n *\r\n * p = {\r\n *     canvas: Canvas,\r\n *     fileName: string,\r\n *     title: string\r\n * }\r\n *\r\n * @param p\r\n */\r\nexport function shareCanvas (p: {canvas: HTMLCanvasElement, fileName:string, title: string, callback: () => void}): void {\r\n    const mimetype = 'image/png';\r\n    const err = () => alert('sharing not supported');\r\n    p.canvas.toBlob(function(blob) {\r\n        if (blob === null) {\r\n            err();\r\n            p.callback();\r\n            return;\r\n        }\r\n        try {\r\n            const filesArray = [new File([blob], p.fileName, {type: mimetype})];\r\n            navigator.share({\r\n                title: p.title,\r\n                files: filesArray,\r\n            } as any)\r\n                .then(r => {\r\n\r\n                })\r\n                .catch(e => {\r\n                    err();\r\n            });\r\n        } catch(e) {\r\n            err();\r\n        }\r\n        p.callback();\r\n    }, mimetype);\r\n}\r\n\r\n/**\r\n * Prevent ipad from zooming in when double tapping. iPadOS 13 bug.\r\n * Give it your click event\r\n *\r\n * @param clickEvent\r\n * @returns {boolean}\r\n */\r\nexport function handleClick (clickEvent: MouseEvent): boolean {\r\n    const target: HTMLElement | null = clickEvent.target as HTMLElement;\r\n    if (!target) {\r\n        return false;\r\n    }\r\n    if (['A', 'LABEL', 'INPUT'].includes(target.tagName) || (target as any).allowClick) {\r\n        return true;\r\n    }\r\n    clickEvent.preventDefault();\r\n    return false;\r\n}\r\n\r\n\r\n/**\r\n * @param el {elementType: string, childrenArr: []el, ...svg attributes...}\r\n * @returns svg element tree\r\n */\r\nexport function createSvg (el: ISVG): SVGElement {\r\n    const result = document.createElementNS('http://www.w3.org/2000/svg', el.elementType);\r\n    const keyArr = Object.keys(el);\r\n    let keyStr;\r\n    for (let i = 0; i < keyArr.length; i++) {\r\n        keyStr = keyArr[i];\r\n        if (keyStr === 'childrenArr') {\r\n            for (let e = 0; e < el.childrenArr.length; e++) {\r\n                result.appendChild(createSvg(el.childrenArr[e]));\r\n            }\r\n        } else if (keyStr !== 'elementType') {\r\n            result.setAttribute(keyStr, el[keyStr] as string);\r\n        }\r\n    }\r\n    return result;\r\n}","import {addEventListener, removeEventListener} from './event-listener';\r\n\r\n\r\nconst globalKey = (() => {\r\n\r\n    const keyStrToKeyObj = { // keyStr not to contain a '+', because that's used for the comboStr\r\n        'space': [' ', 'Spacebar'], // Spacebar in IE\r\n        'alt': ['Alt', 'AltGraph'],\r\n        'shift': 'Shift',\r\n        'ctrl': 'Control',\r\n        'cmd': ['Meta', 'MetaLeft', 'MetaRight'],\r\n        'enter': 'Enter',\r\n        'esc': 'Escape',\r\n        'backspace': 'Backspace',\r\n        'delete': 'Delete',\r\n        'sqbr_open': '[',\r\n        'sqbr_close': ']',\r\n        'a': ['a', 'A'],\r\n        'b': ['b', 'B'],\r\n        'c': ['c', 'C'],\r\n        'e': ['e', 'E'],\r\n        'f': ['f', 'F'],\r\n        'g': ['g', 'G'],\r\n        'r': ['r', 'R'], // when holding shift\r\n        's': ['s', 'S'],\r\n        't': ['t', 'T'],\r\n        'u': ['u', 'U'],\r\n        'x': ['x', 'X'],\r\n        'y': ['y', 'Y'],\r\n        'z': ['z', 'Z'],\r\n        'plus': '+',\r\n        'minus': '-',\r\n        'left': 'ArrowLeft',\r\n        'right': 'ArrowRight',\r\n        'up': 'ArrowUp',\r\n        'down': 'ArrowDown',\r\n        'home': 'Home',\r\n        'end': 'End'\r\n    };\r\n    const keyToKeyStrArr = Object.keys(keyStrToKeyObj);\r\n    const isDownObj = {};\r\n    const keyToKeyStrObj = {}; // event.key to keyStr { ArrowLeft: 'left', ... }\r\n    let comboArr = [];\r\n    //a physical key's \"key\" can change as other keys get pressed. to keep track, need to also track the code\r\n    let codeIsDownObj = {}; // { KeyE: 'e', KeyF: null } - null not down, string, the associated keyStr\r\n    const listenerArr = [];\r\n\r\n    for (let i = 0; i < keyToKeyStrArr.length; i++) {\r\n        isDownObj[keyToKeyStrArr[i]] = false;\r\n\r\n        const code = keyStrToKeyObj[keyToKeyStrArr[i]];\r\n        if (typeof code === 'string') {\r\n            keyToKeyStrObj[keyStrToKeyObj[keyToKeyStrArr[i]]] = keyToKeyStrArr[i];\r\n        } else {\r\n            for (let e = 0; e < code.length; e++) {\r\n                keyToKeyStrObj[code[e]] = keyToKeyStrArr[i];\r\n            }\r\n        }\r\n    }\r\n\r\n    function emitDown(a, b, c, d?) {\r\n        listenerArr.forEach(item => {\r\n            if (!item[0]) {\r\n                return;\r\n            }\r\n            item[0](a, b, c, d);\r\n        });\r\n    }\r\n\r\n    function emitUp(a, b, c) {\r\n        listenerArr.forEach(item => {\r\n            if (!item[1]) {\r\n                return;\r\n            }\r\n            item[1](a, b, c);\r\n        });\r\n    }\r\n\r\n    function emitBlur() {\r\n        listenerArr.forEach(item => {\r\n            if (!item[2]) {\r\n                return;\r\n            }\r\n            item[2]();\r\n        });\r\n    }\r\n\r\n    function keyDown(e) {\r\n        const key = e.key;\r\n        const code = 'code' in e ? e.code : e.keyCode; // ie doesn't have code\r\n\r\n        if (key in keyToKeyStrObj) {\r\n            const keyStr = keyToKeyStrObj[key];\r\n            if (isDownObj[keyStr]) {\r\n                emitDown(keyStr, e, comboArr.join('+'), true);\r\n                return;\r\n            }\r\n            isDownObj[keyStr] = true;\r\n            codeIsDownObj[code] = keyStr;\r\n\r\n            //add to combo\r\n            comboArr.push(keyStr);\r\n\r\n            emitDown(keyStr, e, comboArr.join('+'));\r\n        }\r\n    }\r\n\r\n\r\n    function keyUp(e) {\r\n        const key = e.key;\r\n        const code = 'code' in e ? e.code : e.keyCode; // ie doesn't have code\r\n        const oldComboStr = comboArr.join('+');\r\n\r\n        // because of a macOS bug: when meta key is down, keyup of other keys does not fire.\r\n        // https://stackoverflow.com/questions/25438608/javascript-keyup-isnt-called-when-command-and-another-is-pressed\r\n        if ([\r\n            'Meta', 'MetaLeft', 'MetaRight',\r\n            'OSLeft', 'OSRight', // Firefox\r\n        ].includes(code)) {\r\n            blur(null);\r\n            return;\r\n        }\r\n\r\n        if (code in codeIsDownObj && codeIsDownObj[code] !== null) {\r\n            const keyStr = codeIsDownObj[code];\r\n            isDownObj[keyStr] = false;\r\n            codeIsDownObj[code] = null;\r\n\r\n            //remove from combo\r\n            for (let i = 0; i < comboArr.length; i++) {\r\n                if (comboArr[i] == keyStr) {\r\n                    comboArr.splice(i, 1);\r\n                    i--;\r\n                }\r\n            }\r\n\r\n            emitUp(keyStr, e, oldComboStr);\r\n        }\r\n    }\r\n\r\n    function blur(event) {\r\n        const oldComboStr = comboArr.join('+');\r\n        comboArr = [];\r\n        codeIsDownObj = {};\r\n\r\n        const eventArr = [];\r\n        for (let i = 0; i < keyToKeyStrArr.length; i++) {\r\n            if (isDownObj[keyToKeyStrArr[i]]) {\r\n                isDownObj[keyToKeyStrArr[i]] = false;\r\n                eventArr.push(keyToKeyStrArr[i]);\r\n            }\r\n        }\r\n        for (let i = 0; i < eventArr.length; i++) {\r\n            emitUp(\r\n                eventArr[i],\r\n                {\r\n                    preventDefault: function () {},\r\n                    stopPropagation: function () {},\r\n                },\r\n                oldComboStr,\r\n            );\r\n        }\r\n        emitBlur();\r\n    }\r\n\r\n\r\n\r\n    return {\r\n        add: (keyListener) => {\r\n            if (listenerArr.includes(keyListener)) {\r\n                return;\r\n            }\r\n            const first = listenerArr.length === 0;\r\n            listenerArr.push(keyListener);\r\n\r\n            if (first) {\r\n                addEventListener(document, 'keydown', keyDown);\r\n                addEventListener(document, 'keyup', keyUp);\r\n                addEventListener(window, 'blur', blur);\r\n            }\r\n        },\r\n        remove: (keyListener) => {\r\n            if (!listenerArr.includes(keyListener)) {\r\n                return;\r\n            }\r\n            const last = listenerArr.length === 1;\r\n            for (let i = 0; i < listenerArr.length; i++) {\r\n                if (listenerArr[i] === keyListener) {\r\n                    listenerArr.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n            if (last) {\r\n                removeEventListener(document, 'keydown', keyDown);\r\n                removeEventListener(document, 'keyup', keyUp);\r\n                removeEventListener(window, 'blur', blur);\r\n            }\r\n        },\r\n        getIsDown: () => {\r\n            return isDownObj;\r\n        },\r\n        getCombo: () => {\r\n            return comboArr;\r\n        },\r\n    };\r\n})();\r\n\r\n\r\n\r\n/**\r\n * Listens to key events in window. Makes combos easier - e.g. ctrl + z\r\n *\r\n * keyStr - see in implementation - my representation of a key. e.g. 'r' can be 'r' and 'R'\r\n * comboStr - string joins currently pressed keyStr with a +\r\n *              e.g. 'ctrl+z'\r\n *\r\n */\r\nexport class KeyListener {\r\n\r\n    private readonly onDown;\r\n    private readonly onUp;\r\n    private readonly onBlur;\r\n    private readonly ref;\r\n\r\n    constructor (\r\n        p: {\r\n            onDown?: (keyStr: string, e: KeyboardEvent, comboStr: string, isRepeat?: boolean) => void;\r\n            onUp?: (keyStr: string, e: KeyboardEvent, oldComboStr: string) => void;\r\n            onBlur?: () => void;\r\n        },\r\n    ) {\r\n        this.onDown = p.onDown;\r\n        this.onUp = p.onUp;\r\n        this.onBlur = p.onBlur;\r\n        this.ref = [this.onDown, this.onUp, this.onBlur];\r\n        globalKey.add(this.ref);\r\n    }\r\n\r\n    isPressed (keyStr: string): boolean {\r\n        if (!(keyStr in globalKey.getIsDown())) {\r\n            throw 'key \"' + keyStr + '\" not found';\r\n        }\r\n        return globalKey.getIsDown()[keyStr];\r\n    }\r\n\r\n    getComboStr (): string {\r\n        return globalKey.getCombo().join('+');\r\n    }\r\n\r\n    comboOnlyContains (keyStrArr: string[]): boolean {\r\n        for (let i = 0; i < globalKey.getCombo().length; i++) {\r\n            if (!keyStrArr.includes(globalKey.getCombo()[i])) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    destroy (): void {\r\n        globalKey.remove(this.ref);\r\n    }\r\n}\r\n\r\nexport function sameKeys(comboAStr: string, comboBStr: string): boolean {\r\n    return comboAStr.split('+').sort().join('+')=== comboBStr.split('+').sort().join('+');\r\n}","import {addEventListener, removeEventListener} from './event-listener';\r\n\r\n\r\n/**\r\n * Filters wheel events. removes swipe scrolling and pinch scrolling that trackpads do. (as best as it can)\r\n * Normalizes regular scrolls.\r\n *\r\n * Why:\r\n * - trackpad scrolling is different from old school mouse scrolling\r\n * - but there is not way to learn from the browser if it's trackpad scrolling\r\n * - browsers don't even give access to the raw swiping or pinching movement, but some abstraction on top, making the scrolling\r\n *      continue an arbitrary amount, at an arbitrary scale\r\n * - each browser does this differently. So you can't offer a coherent experience\r\n *\r\n * - also trackpads are painful to draw with. So supporting a trackpad-based workflow makes not much sense.\r\n *\r\n * @param callback - func({deltaY: number, pageX: number, pageY: number, clientX: number, clientY: number}\r\n * @constructor\r\n */\r\nimport {eventUsesHighResTimeStamp, hasPointerEvents, isFirefox} from '../base/browser';\r\nimport {mix} from '../math/math';\r\n\r\nconst WheelCleaner = function (callback) {\r\n    const sequenceTimeoutMs = 200;\r\n\r\n    const knownUnitArr = [100];\r\n    let sequenceLength = 0;\r\n    let sequenceUnit = null;\r\n    let endSequenceTimeout;\r\n    let toEmitDelta = null;\r\n    let position = null;\r\n\r\n\r\n    function emit(delta) {\r\n        callback({\r\n            deltaY: Math.round(delta / sequenceUnit),\r\n            pageX: position.pageX,\r\n            pageY: position.pageY,\r\n            clientX: position.clientX,\r\n            clientY: position.clientY,\r\n        });\r\n    }\r\n\r\n    function endSequence() {\r\n        if (toEmitDelta !== null) {\r\n            emit(toEmitDelta);\r\n            toEmitDelta = null;\r\n        }\r\n        if (sequenceUnit !== null && !(knownUnitArr.includes(sequenceUnit))) {\r\n            knownUnitArr.push(sequenceUnit);\r\n        }\r\n        sequenceLength = 0;\r\n        sequenceUnit = null;\r\n    }\r\n\r\n    // --- interface ---\r\n    this.process = function (event) {\r\n\r\n        position = {\r\n            pageX: event.pageX,\r\n            pageY: event.pageY,\r\n            clientX: event.clientX,\r\n            clientY: event.clientY,\r\n        };\r\n\r\n        clearTimeout(endSequenceTimeout);\r\n        endSequenceTimeout = setTimeout(endSequence, sequenceTimeoutMs);\r\n\r\n        //prep delta\r\n        let delta = event.deltaY;\r\n        if ('deltaMode' in event && event.deltaMode === 1) {\r\n            delta *= 100 / 3;\r\n        }\r\n        const absDelta = Math.abs(delta);\r\n\r\n\r\n        if (sequenceLength > 0 && sequenceUnit === null) {\r\n            //previously determined dirty sequence\r\n            toEmitDelta = null;\r\n            return;\r\n        }\r\n\r\n        //sequence begins\r\n        if (sequenceLength === 0) {\r\n            sequenceLength++;\r\n            if (absDelta < 50) {\r\n                //dirty - probably a swipe scroll or pinch scroll on trackpad\r\n                return;\r\n            }\r\n\r\n            sequenceUnit = absDelta;\r\n            if (knownUnitArr.includes(sequenceUnit)) {\r\n                //we know this unit - emit right away\r\n                emit(delta);\r\n            } else {\r\n                //unknown unit - wait until next event or sequence end, to have more certainty that it's clean\r\n                toEmitDelta = delta;\r\n            }\r\n            return;\r\n        }\r\n\r\n        //sequence continues\r\n        if (absDelta === 0) {\r\n            //ignore zero scroll\r\n            return;\r\n        }\r\n        if (\r\n            absDelta === sequenceUnit ||\r\n            (absDelta / sequenceUnit) % 1 < 0.0001// a multiple\r\n        ) {\r\n            //fine\r\n        } else if ((sequenceUnit / absDelta) % 1 < 0.0001) {\r\n            //unit was actually a multiple - update it\r\n            sequenceUnit = absDelta;\r\n\r\n        } else if (absDelta !== sequenceUnit) {\r\n            //not clean - delta is varying - probably a swipe scroll or pinch scroll on trackpad\r\n            sequenceUnit = null;\r\n            toEmitDelta = null;\r\n            return;\r\n        }\r\n\r\n\r\n        if (toEmitDelta !== null) {\r\n            emit(toEmitDelta);\r\n            toEmitDelta = null;\r\n        }\r\n        emit(delta);\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * PointerListener - for pointer events, wheel events. uses fallbacks. ideally consistent behavior across browsers\r\n * Has some workarounds for browser specific bugs. As browsers get better, this constructor should get smaller\r\n *\r\n * p = {\r\n *     target: DOM element,\r\n *     onPointer: func (pointerEvent), //optional\r\n *     onWheel: func (wheelEvent), //optional\r\n *     onEnterLeave: func (isOver: boolean), //optional\r\n *     maxPointers: int (1 - n), //default is 1\r\n *     fixScribble: boolean, // fix ipad scribble issue\r\n * }\r\n *\r\n * pointerEvent = {\r\n *     type: 'pointerdown'|'pointermove'|'pointerup',\r\n *     pointerId: long,\r\n *     pointerType: 'touch'|'mouse'|'pen',\r\n *     pageX: number,\r\n *     pageY: number,\r\n *     clientX: number,\r\n *     clientY: number,\r\n *     relX: number, //position relative to top left of target\r\n *     relY: number,\r\n *     dX: number, //movementX not supported by safari on iOS, so need my own\r\n *     dY: number,\r\n *     downPageX: number, //where was pointer when down-event occurred - set for down|move|up\r\n *     downPageY: number,\r\n *     coalescedArr: Array of {\r\n *         pageX: number,\r\n *         pageY: number,\r\n *         clientX: number,\r\n *         clientY: number,\r\n *         relX: number, //position relative to top left of target\r\n *         relY: number,\r\n *         dX: number,\r\n *         dY: number,\r\n *         time: number// same timescale as performance.now() - might be exact same number as in parent\r\n *     },\r\n *     time: number, // same timescale as performance.now()\r\n *     button: 'left'|'middle'|'right',\r\n *     pressure: number (0-1), // always 1 for touch and mouse\r\n *     eventPreventDefault: function(),\r\n *     eventStopPropagation: function(),\r\n * }\r\n *\r\n * wheelEvent = {\r\n *     deltaY: number, // increments of 1\r\n *     pageX: number,\r\n *     pageY: number,\r\n *     relX: number,\r\n *     relY: number,\r\n * }\r\n *\r\n * isOver(): boolean - if pointer over the target\r\n *\r\n * @param p\r\n */\r\nexport const PointerListener = (function () {\r\n\r\n    //keeping track of pointers for movement fallback\r\n    const pointerArr = [];\r\n\r\n    function addPointer(event) {\r\n        const pointerObj = {\r\n            pointerId: event.pointerId,\r\n            lastPageX: null,\r\n            lastPageY: null\r\n        };\r\n        pointerArr.push(pointerObj);\r\n\r\n        if (pointerArr.length > 15) {\r\n            pointerArr.shift();\r\n        }\r\n\r\n        return pointerObj;\r\n    }\r\n\r\n    function getPointer(event) {\r\n        for (let i = pointerArr.length - 1; i >= 0; i--) {\r\n            if (event.pointerId === pointerArr[i].pointerId) {\r\n                return pointerArr[i];\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n\r\n    let pressureNormalizeAvgCount = 0;\r\n    let pressureNormalizeAvgPressure = null;\r\n    let pressureNormalizeIsComplete = false;\r\n    let pressureNormalizeFactor = 1;\r\n\r\n    return function (p) {\r\n        const targetElement = p.target;\r\n        const onPointerCallback = p.onPointer;\r\n        const onWheelCallback = p.onWheel;\r\n        const onEnterLeaveCallback = p.onEnterLeave;\r\n        const maxPointers = 'maxPointers' in p ? p.maxPointers : 1;\r\n        const buttonsToStr = { // translation\r\n            '1': 'left',\r\n            '2': 'right',\r\n            '4': 'middle'\r\n        };\r\n        const wheelCleaner = new WheelCleaner(function (wheelEvent) {\r\n            if (isDestroyed) {\r\n                return;\r\n            }\r\n            if (onWheelCallback) {\r\n                const bounds = targetElement.getBoundingClientRect();\r\n                wheelEvent.relX = wheelEvent.clientX - bounds.left + targetElement.scrollLeft;\r\n                wheelEvent.relY = wheelEvent.clientY - bounds.top + targetElement.scrollTop;\r\n                onWheelCallback(wheelEvent);\r\n            }\r\n        });\r\n        let isDestroyed = false;\r\n\r\n        const timeStampOffset = eventUsesHighResTimeStamp() ? 0 : -performance.timing.navigationStart;\r\n\r\n\r\n        //to circumvent a chrome input glitch\r\n        let lastPointerType = '';\r\n        let didSkip = false;\r\n\r\n\r\n        /*\r\n        pointers that are pressing a button\r\n        dragObj = {\r\n            pointerId: long,\r\n            pointerType: 'mouse'|'pen'|'touch',\r\n            downPageX: number, //where was pointer when down-event occurred\r\n            downPageY: number,\r\n            button: long,\r\n            lastPageX: number, //pageX in previous event - only for touch events, because they don't have movementX/Y\r\n            lastPageY: number,\r\n            lastTimeStamp: number\r\n        }\r\n         */\r\n        const dragObjArr = [];\r\n        const dragPointerIdArr = [];\r\n\r\n        function getDragObj(pointerId) {\r\n            for (let i = 0; i < dragObjArr.length; i++) {\r\n                if (pointerId === dragObjArr[i].pointerId) {\r\n                    return dragObjArr[i];\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n\r\n        function removeDragObj(pointerId) {\r\n            let removedDragObj = null;\r\n            for (let i = 0; i < dragPointerIdArr.length; i++) {\r\n                if (dragPointerIdArr[i] === pointerId) {\r\n                    removedDragObj = dragObjArr[i];\r\n                    dragObjArr.splice(i, 1);\r\n                    dragPointerIdArr.splice(i, 1);\r\n                    i--;\r\n                }\r\n            }\r\n            return removedDragObj;\r\n        }\r\n\r\n\r\n        function normalizePressure(pressure, type?) {\r\n            if (pressure === 0 || pressure === 1) {\r\n                return pressure;\r\n            }\r\n\r\n            // was this there to prevent some glitch?\r\n            /*if (pressureNormalizeIsComplete && type === 'pointerdown' && pressure !== 1) {\r\n                pressure *= 0.004;\r\n            }*/\r\n\r\n            if (pressureNormalizeAvgCount < 60) {\r\n                if (pressureNormalizeAvgCount === 0) {\r\n                    pressureNormalizeAvgPressure = pressure;\r\n                } else {\r\n                    pressureNormalizeAvgPressure = mix(pressure, pressureNormalizeAvgPressure, 0.95);\r\n                }\r\n                pressureNormalizeAvgCount++;\r\n            } else if (!pressureNormalizeIsComplete) {\r\n                pressureNormalizeIsComplete = true;\r\n                //BB.throwOut('avg pressure decision!' + pressureNormalizeAvgPressure);\r\n                if (pressureNormalizeAvgPressure < 0.13) { // absurd pressure needed\r\n                    pressureNormalizeFactor = 2.3;\r\n                }\r\n            }\r\n\r\n\r\n            return Math.pow(pressure, 1 / pressureNormalizeFactor);\r\n        }\r\n\r\n\r\n        /**\r\n         *\r\n         * More trustworthy pointer attributes. that behave the same across browsers.\r\n         * returns a new object. this object also gets attached to the orig event. -> event.corrected\r\n         *\r\n         * @param event\r\n         * @returns {{pointerId: number, timeStamp: number, button, buttons, pointerType: (string|string|any), movementY: number, movementX: number, pressure, coalescedArr: [], pageY, pageX, clientX, clientY, eventPreventDefault: func, eventStopPropagation: func}\r\n         */\r\n        function correctPointerEvent(event) {\r\n            if (event.corrected) {\r\n                return event.corrected;\r\n            }\r\n\r\n            /*if (event.type === 'pointermove' && !window.hidePressureOut) {\r\n                if (event.type === 'pointermove') {\r\n                    BB.throwOut(event.pressure + ' ' + event.pointerType);\r\n                }\r\n            }*/\r\n\r\n            const correctedObj = {\r\n                pointerId: event.pointerId,\r\n                pointerType: event.pointerType,\r\n                pageX: event.pageX,\r\n                pageY: event.pageY,\r\n                clientX: event.clientX,\r\n                clientY: event.clientY,\r\n                movementX: event.movementX,\r\n                movementY: event.movementY,\r\n                timeStamp: event.timeStamp + timeStampOffset,\r\n                pressure: normalizePressure(event.pressure, event.type),\r\n                buttons: event.buttons,\r\n                button: event.button,\r\n                coalescedArr: [],\r\n                eventPreventDefault: function () {\r\n                    event.preventDefault();\r\n                },\r\n                eventStopPropagation: function () {\r\n                    event.stopPropagation();\r\n                }\r\n            };\r\n            event.corrected = correctedObj;\r\n\r\n            let customPressure = null;\r\n            if ('pointerId' in event) {\r\n                if ('pressure' in event && event.buttons !== 0 && (['mouse'].includes(event.pointerType) || (event.pointerType === 'touch' && event.pressure === 0))) {\r\n                    correctedObj.pressure = 1;\r\n                    customPressure = 1;\r\n                }\r\n            } else {\r\n                correctedObj.pointerId = 0;\r\n                correctedObj.pointerType = 'mouse';\r\n                correctedObj.pressure = event.buttons !== 0 ? 1 : 0;\r\n                customPressure = correctedObj.pressure;\r\n            }\r\n\r\n            if (isFirefox && event.pointerType != 'mouse' && event.type === 'pointermove' && event.buttons === 0) { // once again firefox\r\n                correctedObj.buttons = 1; //todo wrong if no buttons actually pressed\r\n            }\r\n\r\n            let coalescedEventArr = [];\r\n            if ('getCoalescedEvents' in event) {\r\n                coalescedEventArr = event.getCoalescedEvents();\r\n            }\r\n\r\n            // chrome somehow movementX not same scale as pageX. todo: only chrome?\r\n            // so make my own\r\n\r\n            let pointerObj = getPointer(correctedObj);\r\n            if (pointerObj === null) {\r\n                pointerObj = addPointer(correctedObj);\r\n            }\r\n\r\n            const totalLastX = pointerObj.lastPageX;\r\n            const totalLastY = pointerObj.lastPageY;\r\n\r\n            for (let i = 0; i < coalescedEventArr.length; i++) {\r\n                const eventItem = coalescedEventArr[i];\r\n\r\n                correctedObj.coalescedArr.push({\r\n                    pageX: eventItem.pageX,\r\n                    pageY: eventItem.pageY,\r\n                    clientX: eventItem.clientX,\r\n                    clientY: eventItem.clientY,\r\n                    movementX: pointerObj.lastPageX === null ? 0 : eventItem.pageX - pointerObj.lastPageX,\r\n                    movementY: pointerObj.lastPageY === null ? 0 : eventItem.pageY - pointerObj.lastPageY,\r\n                    timeStamp: eventItem.timeStamp === 0 ? correctedObj.timeStamp : (eventItem.timeStamp + timeStampOffset), // 0 in firefox\r\n                    pressure: customPressure === null ? normalizePressure(eventItem.pressure) : customPressure\r\n                });\r\n\r\n                pointerObj.lastPageX = eventItem.pageX;\r\n                pointerObj.lastPageY = eventItem.pageY;\r\n            }\r\n\r\n            pointerObj.lastPageX = correctedObj.pageX;\r\n            pointerObj.lastPageY = correctedObj.pageY;\r\n            correctedObj.movementX = totalLastX === null ? 0 : pointerObj.lastPageX - totalLastX;\r\n            correctedObj.movementY = totalLastY === null ? 0 : pointerObj.lastPageY - totalLastY;\r\n\r\n            return correctedObj;\r\n\r\n        }\r\n\r\n        /**\r\n         * creates a value for onPointer, from a pointer event handler\r\n         *\r\n         * @param typeStr string - 'pointerdown'|'pointermove'|'pointerup'\r\n         * @param correctedEvent - corrected pointer event from correctPointerEvent()\r\n         * @param custom - object for setting custom attributes\r\n         * @returns {{pointerId: number, pointerType: *, dX: (*), relY: number, dY: (*), relX: number, type: *, event: *, pageY: *, pageX: *}}\r\n         */\r\n        function createPointerOutEvent(typeStr, correctedEvent, custom?) {\r\n\r\n            const bounds = targetElement.getBoundingClientRect();\r\n            const result: any = {\r\n                type: typeStr,\r\n                pointerId: correctedEvent.pointerId,\r\n                pointerType: correctedEvent.pointerType,\r\n                pageX: correctedEvent.pageX,\r\n                pageY: correctedEvent.pageY,\r\n                clientX: correctedEvent.clientX,\r\n                clientY: correctedEvent.clientY,\r\n                relX: correctedEvent.clientX - bounds.left + targetElement.scrollLeft,\r\n                relY: correctedEvent.clientY - bounds.top + targetElement.scrollTop,\r\n                dX: correctedEvent.movementX,\r\n                dY: correctedEvent.movementY,\r\n                time: correctedEvent.timeStamp,\r\n                eventPreventDefault: correctedEvent.eventPreventDefault,\r\n                eventStopPropagation: correctedEvent.eventStopPropagation\r\n            };\r\n\r\n            if (typeStr === 'pointermove') {\r\n                result.coalescedArr = [];\r\n                if (correctedEvent.coalescedArr.length > 1) {\r\n                    let coalescedItem;\r\n                    for (let i = 0; i < correctedEvent.coalescedArr.length; i++) {\r\n                        coalescedItem = correctedEvent.coalescedArr[i];\r\n                        result.coalescedArr.push({\r\n                            pageX: coalescedItem.pageX,\r\n                            pageY: coalescedItem.pageY,\r\n                            clientX: coalescedItem.clientX,\r\n                            clientY: coalescedItem.clientY,\r\n                            relX: coalescedItem.clientX - bounds.left + targetElement.scrollLeft,\r\n                            relY: coalescedItem.clientY - bounds.top + targetElement.scrollTop,\r\n                            dX: coalescedItem.movementX,\r\n                            dY: coalescedItem.movementY,\r\n                            time: coalescedItem.timeStamp\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (custom) {\r\n                const keyArr = Object.keys(custom);\r\n                for (let i = 0; i < keyArr.length; i++) {\r\n                    result[keyArr[i]] = custom[keyArr[i]];\r\n                }\r\n            }\r\n\r\n            return result;\r\n        }\r\n\r\n        /**\r\n         * creates a value for onPointer, from a fallback touch event handler\r\n         *\r\n         * @param typeStr string - 'pointerdown'|'pointermove'|'pointerup'\r\n         * @param touchListItem - element from changed touch list\r\n         * @param touchEvent - touch event\r\n         * @param custom - object for setting custom attributes\r\n         * @returns {{pointerId: number, pointerType: string, relY: number, relX: number, type: *, event: *, pageY: *, pageX: *}}\r\n         */\r\n        function createTouchOutEvent(typeStr, touchListItem, touchEvent, custom) {\r\n            const bounds = targetElement.getBoundingClientRect();\r\n            const result: any = {\r\n                type: typeStr,\r\n                pointerId: touchListItem.identifier,\r\n                pointerType: 'touch',\r\n                pageX: touchListItem.pageX,\r\n                pageY: touchListItem.pageY,\r\n                clientX: touchListItem.clientX,\r\n                clientY: touchListItem.clientY,\r\n                relX: touchListItem.pageX - bounds.left + targetElement.scrollLeft,\r\n                relY: touchListItem.pageY - bounds.top + targetElement.scrollTop,\r\n                time: touchEvent.timeStamp + timeStampOffset,\r\n                eventPreventDefault: function() { touchEvent.preventDefault(); },\r\n                eventStopPropagation: function() { touchEvent.stopPropagation(); }\r\n            };\r\n\r\n            if (typeStr === 'pointermove') {\r\n                result.coalescedArr = [];\r\n            }\r\n\r\n            const keyArr = Object.keys(custom);\r\n            for (let i = 0; i < keyArr.length; i++) {\r\n                result[keyArr[i]] = custom[keyArr[i]];\r\n            }\r\n\r\n            return result;\r\n        }\r\n\r\n        function setupDocumentListeners() {\r\n            addEventListener(document, 'pointermove', onGlobalPointerMove);\r\n            addEventListener(document, 'pointerup', onGlobalPointerUp);\r\n            addEventListener(document, 'pointerleave', onGlobalPointerLeave);\r\n        }\r\n\r\n        function destroyDocumentListeners() {\r\n            removeEventListener(document, 'pointermove', onGlobalPointerMove);\r\n            removeEventListener(document, 'pointerup', onGlobalPointerUp);\r\n            removeEventListener(document, 'pointerleave', onGlobalPointerLeave);\r\n        }\r\n\r\n        let isOverCounter = 0; // might be multiple pointers\r\n        function onPointerEnter() {\r\n            isOverCounter++;\r\n            if (onEnterLeaveCallback) {\r\n                onEnterLeaveCallback(true);\r\n            }\r\n        }\r\n\r\n        function onPointerLeave() {\r\n            isOverCounter--;\r\n            if (onEnterLeaveCallback) {\r\n                onEnterLeaveCallback(false);\r\n            }\r\n        }\r\n\r\n        function onPointermove(event) {\r\n            event = correctPointerEvent(event);\r\n\r\n            const tempLastPointerType = lastPointerType;\r\n            lastPointerType = event.pointerType;\r\n\r\n            if (dragPointerIdArr.includes(event.pointerId) || dragPointerIdArr.length === maxPointers || event.pointerType === 'touch') {\r\n                didSkip = false;\r\n                return;\r\n            }\r\n\r\n            // chrome input glitch workaround - throws in a random mouse event with the wrong position when using a stylus\r\n            if (!didSkip && event.pointerType === 'mouse' && tempLastPointerType === 'pen') {\r\n                didSkip = true;\r\n                return;\r\n            }\r\n            didSkip = false;\r\n\r\n            const outEvent = createPointerOutEvent('pointermove', event);\r\n            onPointerCallback(outEvent);\r\n\r\n        }\r\n\r\n        function onPointerdown(event) {\r\n            //BB.throwOut('pointerdown ' + event.pointerId + ' | ' + dragPointerIdArr.length);\r\n            event = correctPointerEvent(event);\r\n            ////console.log('debug: ' + event.pointerId + ' pointerdown');\r\n            if (dragPointerIdArr.includes(event.pointerId) || dragPointerIdArr.length === maxPointers || !([1, 2, 4].includes(event.buttons))) {\r\n                //BB.throwOut('pointerdown ignored');\r\n                return;\r\n            }\r\n\r\n\r\n            //set up global listeners\r\n            if (dragObjArr.length === 0) {\r\n                setupDocumentListeners();\r\n            }\r\n            const dragObj = {\r\n                pointerId: event.pointerId,\r\n                pointerType: event.pointerType,\r\n                downPageX: event.pageX,\r\n                downPageY: event.pageY,\r\n                buttons: event.buttons,\r\n                lastPageX: event.pageX,\r\n                lastPageY: event.pageY,\r\n                lastTimeStamp: event.timeStamp\r\n            };\r\n            dragObjArr.push(dragObj);\r\n            setTouchTimeout(dragObj);\r\n            dragPointerIdArr.push(event.pointerId);\r\n\r\n            const outEvent = createPointerOutEvent('pointerdown', event, {\r\n                downPageX: event.pageX,\r\n                downPageY: event.pageY,\r\n                button: buttonsToStr[event.buttons],\r\n                pressure: event.pressure\r\n            });\r\n\r\n            onPointerCallback(outEvent);\r\n        }\r\n\r\n\r\n        function onGlobalPointerMove(event) {\r\n            //BB.throwOut('pointermove ' + event.pointerId);\r\n            event = correctPointerEvent(event);\r\n            ////console.log('debug: ' + event.pointerId + ' GLOBALpointermove');\r\n            if (!(dragPointerIdArr.includes(event.pointerId))) {\r\n                return;\r\n            }\r\n\r\n            const dragObj = getDragObj(event.pointerId);\r\n            clearTouchTimeout(dragObj);\r\n\r\n            //if pointer changes button its pressing -> turn into pointerup\r\n            if (event.buttons !== dragObj.buttons) {\r\n                //pointer up\r\n\r\n                //remove listener\r\n                if (dragObjArr.length === 1) {\r\n                    destroyDocumentListeners();\r\n                }\r\n                removeDragObj(event.pointerId);\r\n\r\n                const outEvent = createPointerOutEvent('pointerup', event, {\r\n                    downPageX: dragObj.downPageX,\r\n                    downPageY: dragObj.downPageY\r\n                });\r\n                onPointerCallback(outEvent);\r\n                return;\r\n\r\n            }\r\n\r\n            setTouchTimeout(dragObj);\r\n\r\n            // ipad likes to do this\r\n            if (\r\n                event.pointerType === 'pen' &&\r\n                event.pageX === dragObj.lastPageX &&\r\n                event.pageY === dragObj.lastPageY &&\r\n                event.timeStamp === dragObj.lastTimeStamp\r\n            ) {\r\n                //ignore\r\n                return;\r\n            }\r\n\r\n            const outEvent = createPointerOutEvent('pointermove', event, {\r\n                downPageX: dragObj.downPageX,\r\n                downPageY: dragObj.downPageY,\r\n                button: buttonsToStr[event.buttons],\r\n                pressure: event.pressure\r\n            });\r\n\r\n            dragObj.lastPageX = event.pageX;\r\n            dragObj.lastPageY = event.pageY;\r\n            dragObj.lastTimeStamp = event.timeStamp;\r\n\r\n            onPointerCallback(outEvent);\r\n\r\n        }\r\n\r\n        function onGlobalPointerUp(event) {\r\n            //BB.throwOut('pointerup ' + event.pointerId);\r\n            event = correctPointerEvent(event);\r\n            ////console.log('debug: ' + event.pointerId + ' GLOBALpointerup');\r\n            if (!(dragPointerIdArr.includes(event.pointerId))) {\r\n                return;\r\n            }\r\n\r\n            //remove listener\r\n            if (dragObjArr.length === 1) {\r\n                destroyDocumentListeners();\r\n            }\r\n            const dragObj = removeDragObj(event.pointerId);\r\n            clearTouchTimeout(dragObj);\r\n\r\n            const outEvent = createPointerOutEvent('pointerup', event, {\r\n                downPageX: dragObj.downPageX,\r\n                downPageY: dragObj.downPageY\r\n            });\r\n            onPointerCallback(outEvent);\r\n\r\n        }\r\n\r\n        function onGlobalPointerLeave(event) {\r\n            //BB.throwOut('pointerleave ' + event.pointerId);\r\n            event = correctPointerEvent(event);\r\n            ////console.log('debug: ' + event.pointerId + ' onGlobalPointerLeave', event);\r\n            if (!(dragPointerIdArr.includes(event.pointerId))) { //} || event.target !== document) {\r\n                return;\r\n            }\r\n\r\n            //remove listener\r\n            if (dragObjArr.length === 1) {\r\n                destroyDocumentListeners();\r\n            }\r\n            const dragObj = removeDragObj(event.pointerId);\r\n            clearTouchTimeout(dragObj);\r\n\r\n            const outEvent = createPointerOutEvent('pointerup', event, {\r\n                downPageX: dragObj.downPageX,\r\n                downPageY: dragObj.downPageY\r\n            });\r\n            onPointerCallback(outEvent);\r\n        }\r\n\r\n\r\n        /*\r\n        --- ipad pointer event glitch damage control ---\r\n\r\n        ipad pointer events are glitchy. doesn't always fire pointerup.\r\n        - when two fingers get really close to each other\r\n        - when finger moves out and back in bottom\r\n\r\n        This artificially fires a pointerup\r\n        */\r\n        function onTouchTimeout(dragObj) {\r\n\r\n            //create fake event\r\n            const fakeEvent = {\r\n                pointerId: dragObj.pointerId,\r\n                pointerType: dragObj.pointerType,\r\n                type: 'pointerup',\r\n                timeStamp: performance.now(),\r\n                pageX: 0,\r\n                pageY: 0,\r\n                clientX: 0,\r\n                clientY: 0,\r\n                preventDefault: function () {\r\n                },\r\n                stopPropagation: function () {\r\n                }\r\n            };\r\n\r\n            //call onGlobalPointerUp with it\r\n            onGlobalPointerUp(fakeEvent);\r\n        }\r\n\r\n        function setTouchTimeout(dragObj) {\r\n            if (dragObj.pointerType !== 'touch') {\r\n                return;\r\n            }\r\n            dragObj.touchTimeout = setTimeout(function () {\r\n                onTouchTimeout(dragObj);\r\n            }, 2500); // 2.5 seconds\r\n        }\r\n\r\n        function clearTouchTimeout(dragObj) {\r\n            if (!dragObj.touchTimeout) {\r\n                return;\r\n            }\r\n            clearTimeout(dragObj.touchTimeout);\r\n            dragObj.touchTimeout = null;\r\n        }\r\n\r\n\r\n        if (onEnterLeaveCallback) {\r\n            addEventListener(targetElement, 'pointerenter', onPointerEnter);\r\n            addEventListener(targetElement, 'pointerleave', onPointerLeave);\r\n        }\r\n        if (onPointerCallback) {\r\n            addEventListener(targetElement, 'pointermove', onPointermove);\r\n            addEventListener(targetElement, 'pointerdown', onPointerdown);\r\n        }\r\n        if (onWheelCallback) {\r\n            addEventListener(targetElement, 'wheel', wheelCleaner.process);\r\n        }\r\n\r\n\r\n        let onTouchstart;\r\n        let onTouchmove;\r\n        let onTouchend;\r\n\r\n        // --- touch fallback ---\r\n        if (!(hasPointerEvents)) {\r\n\r\n            onTouchstart = function (event) {\r\n                ////console.log('onTouchstart', event, event.changedTouches.length);\r\n                event.preventDefault(); // needs to stay, otherwise page scrolls on iOS12\r\n\r\n                const touchArr = event.changedTouches;\r\n                for (let i = 0; i < touchArr.length && dragObjArr.length < maxPointers; i++) {\r\n                    const touchObj = touchArr[i];\r\n\r\n                    //set up global listeners\r\n                    if (dragObjArr.length === 0) {\r\n                        addEventListener(document, 'touchmove', onTouchmove);\r\n                        addEventListener(document, 'touchend', onTouchend);\r\n                        addEventListener(document, 'touchcancel', onTouchend);\r\n                    }\r\n                    dragObjArr.push({\r\n                        pointerId: touchObj.identifier,\r\n                        downPageX: touchObj.pageX,\r\n                        downPageY: touchObj.pageY,\r\n                        buttons: 1,\r\n                        lastPageX: touchObj.pageX,\r\n                        lastPageY: touchObj.pageY,\r\n                    });\r\n                    dragPointerIdArr.push(touchObj.identifier);\r\n\r\n                    const outEvent = createTouchOutEvent('pointerdown', touchObj, event, {\r\n                        dX: 0,\r\n                        dY: 0,\r\n                        downPageX: touchObj.downPageX,\r\n                        downPageY: touchObj.downPageY,\r\n                        button: 'left',\r\n                        pressure: 1\r\n                    });\r\n                    onPointerCallback(outEvent);\r\n                }\r\n\r\n            }\r\n\r\n            onTouchmove = function (event) {\r\n                event.preventDefault(); // needs to stay, otherwise page scrolls on iOS12\r\n\r\n\r\n                const touchArr = event.changedTouches;\r\n                for (let i = 0; i < touchArr.length; i++) {\r\n                    const touchObj = touchArr[i];\r\n\r\n                    if (!(dragPointerIdArr.includes(touchObj.identifier))) {\r\n                        continue;\r\n                    }\r\n                    const dragObj = getDragObj(touchObj.identifier);\r\n\r\n                    const outEvent = createTouchOutEvent('pointermove', touchObj, event, {\r\n                        dX: touchObj.pageX - dragObj.lastPageX,\r\n                        dY: touchObj.pageY - dragObj.lastPageY,\r\n                        downPageX: dragObj.downPageX,\r\n                        downPageY: dragObj.downPageY,\r\n                        button: 'left',\r\n                        isCoalesced: false,\r\n                        pressure: 1\r\n                    });\r\n                    dragObj.lastPageX = touchObj.pageX;\r\n                    dragObj.lastPageY = touchObj.pageY;\r\n                    onPointerCallback(outEvent);\r\n\r\n                }\r\n\r\n            }\r\n\r\n            onTouchend = function (event) {\r\n                if (event.type !== 'touchcancel') {\r\n                    event.preventDefault(); // needs to stay, otherwise page scrolls on iOS12\r\n                }\r\n\r\n\r\n                const touchArr = event.changedTouches;\r\n                for (let i = 0; i < touchArr.length; i++) {\r\n                    const touchObj = touchArr[i];\r\n\r\n                    if (!(dragPointerIdArr.includes(touchObj.identifier))) {\r\n                        continue;\r\n                    }\r\n\r\n                    //remove listener\r\n                    if (dragObjArr.length === 1) {\r\n                        removeEventListener(document, 'touchmove', onTouchmove);\r\n                        removeEventListener(document, 'touchend', onTouchend);\r\n                        removeEventListener(document, 'touchcancel', onTouchend);\r\n                    }\r\n                    const dragObj = removeDragObj(touchObj.identifier);\r\n\r\n                    const outEvent = createTouchOutEvent('pointerup', touchObj, event, {\r\n                        dX: touchObj.pageX - dragObj.lastPageX,\r\n                        dY: touchObj.pageY - dragObj.lastPageY,\r\n                        downPageX: dragObj.downPageX,\r\n                        downPageY: dragObj.downPageY,\r\n                    });\r\n\r\n                    onPointerCallback(outEvent);\r\n                }\r\n\r\n            }\r\n\r\n            if (onPointerCallback) {\r\n                addEventListener(targetElement, 'touchstart', onTouchstart);\r\n            }\r\n\r\n        } else if (p.fixScribble) {\r\n            //ipad scribble workaround https://developer.apple.com/forums/thread/662874\r\n            onTouchmove = function(e) {\r\n                e.preventDefault();\r\n            }\r\n            addEventListener(targetElement, 'touchmove', onTouchmove);\r\n\r\n        }\r\n\r\n\r\n        // --- interface ---\r\n\r\n        this.isOver = function () {\r\n            return isOverCounter > 0;\r\n        };\r\n\r\n        this.destroy = function () {\r\n            if (isDestroyed) {\r\n                return;\r\n            }\r\n            isDestroyed = true;\r\n            removeEventListener(targetElement, 'pointerenter', onPointerEnter);\r\n            removeEventListener(targetElement, 'pointerleave', onPointerLeave);\r\n            removeEventListener(targetElement, 'pointermove', onPointermove);\r\n            removeEventListener(targetElement, 'pointerdown', onPointerdown);\r\n            removeEventListener(targetElement, 'wheel', wheelCleaner.process);\r\n            if (dragObjArr.length > 0) {\r\n                destroyDocumentListeners();\r\n            }\r\n\r\n            if (!(hasPointerEvents)) {\r\n                removeEventListener(targetElement, 'touchstart', onTouchstart);\r\n                if (dragObjArr.length > 0) {\r\n                    removeEventListener(document, 'touchmove', onTouchmove);\r\n                    removeEventListener(document, 'touchend', onTouchend);\r\n                    removeEventListener(document, 'touchcancel', onTouchend);\r\n                }\r\n            } else {\r\n                removeEventListener(targetElement, 'touchmove', onTouchmove);\r\n            }\r\n        };\r\n\r\n    }\r\n})();","import {IBounds, IVector2D} from '../BB.types';\r\n\r\nexport function mix (a: number, b: number, f: number): number {\r\n    return a * (1 - f) + b * f;\r\n}\r\n\r\nexport function dist (ax: number, ay: number, bx: number, by: number): number {\r\n    return Math.sqrt(Math.pow(ax - bx, 2) + Math.pow(ay - by, 2));\r\n}\r\n\r\nexport function distSquared (ax: number, ay: number, bx: number, by: number): number {\r\n    // faster because no square-root\r\n    return Math.pow(ax - bx, 2) + Math.pow(ay - by, 2);\r\n}\r\n\r\nexport function lenSquared (x: number, y: number): number {\r\n    // faster because no square-root\r\n    return x * x + y * y;\r\n}\r\n\r\nexport function pointsToAngleRad (p1: IVector2D, p2: IVector2D): number {\r\n    return Math.atan2(p2.y - p1.y, p2.x - p1.x);\r\n}\r\n\r\nexport function pointsToAngleDeg (p1: IVector2D, p2: IVector2D): number {\r\n    return pointsToAngleRad(p1, p2) * 180 / Math.PI;\r\n}\r\n\r\nexport function clamp (num: number, min: number, max: number): number {\r\n    return num <= min\r\n        ? min\r\n        : num >= max\r\n            ? max\r\n            : num;\r\n}\r\n\r\nexport function rotate (x: number, y: number, deg: number): IVector2D {\r\n    const theta = deg * (Math.PI / 180);\r\n    const cs = Math.cos(theta);\r\n    const sn = Math.sin(theta);\r\n\r\n    return {\r\n        x: x * cs - y * sn,\r\n        y: x * sn + y * cs\r\n    };\r\n}\r\n\r\nexport function rotateAround (center: IVector2D, point: IVector2D, deg: number): IVector2D {\r\n    const rot = rotate(point.x - center.x, point.y - center.y, deg);\r\n    rot.x += center.x;\r\n    rot.y += center.y;\r\n    return rot;\r\n}\r\n\r\nexport function intDxy(remainder: IVector2D, fDx: number, fDy: number) {\r\n    remainder.x += fDx;\r\n    remainder.y += fDy;\r\n    const dX = Math.round(remainder.x);\r\n    const dY = Math.round(remainder.y);\r\n    remainder.x -= dX;\r\n    remainder.y -= dY;\r\n    return {\r\n        dX,\r\n        dY,\r\n    };\r\n}\r\n\r\n/**\r\n * return closest even number\r\n * @param f\r\n */\r\nexport function roundEven(f: number) {\r\n    if (f % 1 === 0) {\r\n        if (f % 2 === 0) {\r\n            return f;\r\n        }\r\n        return f + 1;\r\n    }\r\n    const above = Math.ceil(f);\r\n    const below = Math.floor(f);\r\n    if (above % 2 === 0) {\r\n        return above;\r\n    } else {\r\n        return below;\r\n    }\r\n}\r\n\r\n/**\r\n * return closest uneven number\r\n * @param f\r\n */\r\nexport function roundUneven(f: number) {\r\n    if (f % 1 === 0) {\r\n        if (f % 2 === 0) {\r\n            return f + 1;\r\n        }\r\n        return f;\r\n    }\r\n    const above = Math.ceil(f);\r\n    const below = Math.floor(f);\r\n    if (above % 2 === 1) {\r\n        return above;\r\n    } else {\r\n        return below;\r\n    }\r\n}\r\n\r\n/**\r\n * update target so it includes bounds\r\n * @param target\r\n * @param bounds\r\n */\r\nexport function updateBounds (target: IBounds, bounds: IBounds): IBounds {\r\n    if (!bounds) {\r\n        return target;\r\n    }\r\n    if (!target) {\r\n        target = { x1: bounds.x1, y1: bounds.y1, x2: bounds.x2, y2: bounds.y2 };\r\n    } else {\r\n        target.x1 = Math.min(target.x1, bounds.x1);\r\n        target.y1 = Math.min(target.y1, bounds.y1);\r\n        target.x2 = Math.max(target.x2, bounds.x2);\r\n        target.y2 = Math.max(target.y2, bounds.y2);\r\n    }\r\n    return target;\r\n}\r\n\r\n/**\r\n * determine overlap of bounds with width&height\r\n */\r\nexport function boundsInArea (bounds: IBounds, width: number, height: number): IBounds | null {\r\n    let x1 = Math.max(0, bounds.x1);\r\n    let y1 = Math.max(0, bounds.y1);\r\n    let x2 = Math.min(width - 1, bounds.x2);\r\n    let y2 = Math.min(height - 1, bounds.y2);\r\n    if (x1 > x2 || y1 > y2) {\r\n        return null;\r\n    }\r\n    return { x1, y1, x2, y2 };\r\n}","import {clamp, dist, mix, pointsToAngleRad} from '../math/math';\r\n\r\n\r\ntype ChainOutFunc = (event?) => void;\r\n\r\n/**\r\n * for chaining event processing. useful for gestures (double tap, pinch zoom, max pointer filter).\r\n * each element in the chain might hold back the events, swallow them, or transform them\r\n *\r\n * p = {\r\n *     chainArr: ChainElement[]\r\n * }\r\n *\r\n * chainIn(event): null - feed an event into the chain\r\n * setChainOut(func): void - func(event) <- called when passed through chain\r\n * ^ each ChainElement needs these methods too\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const EventChain = function (p) {\r\n\r\n    const chainArr = p.chainArr;\r\n    let chainOut: ChainOutFunc = () => undefined;\r\n\r\n    function continueChain(i, event) {\r\n        for (; i < chainArr.length; i++) {\r\n            event = chainArr[i].chainIn(event);\r\n            if (event === null) {\r\n                return null;\r\n            }\r\n        }\r\n        chainOut(event);\r\n        return null;\r\n    }\r\n\r\n    for (let i = 0; i < chainArr.length; i++) {\r\n        (function (i) {\r\n            chainArr[i].setChainOut(function (event) {\r\n                continueChain(i + 1, event);\r\n            });\r\n        })(i);\r\n    }\r\n\r\n    // --- interface ---\r\n\r\n    this.chainIn = function (event) {\r\n        return continueChain(0, event);\r\n    };\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * A ChainElement. Detects double taps.\r\n *\r\n * p = {\r\n *     onDoubleTap: function({pageX: number, pageY: number}) - fires when double tap occurs\r\n * }\r\n *\r\n * chainIn\r\n * setChainOut\r\n * setAllowedPointerTypeArr(string[]): void - which pointer types are allowed\r\n * setAllowedButtonArr(string[]): void - which buttons are allowed\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const DoubleTapper = function (p) {\r\n\r\n    let chainOut: ChainOutFunc = function () {\r\n    };\r\n    const minSilenceBeforeDurationMs = 400;\r\n    const maxPressedDurationMs = 300;\r\n    const maxPressedDistancePx = 10;\r\n    const maxInbetweenDistancePx = 19;\r\n    const maxUpToUpDurationMs = 500;\r\n    const maxUntilSecondDownDurationMs = 300;\r\n    const minSilenceAfterMs = 250;\r\n\r\n    let allowedPointerTypeArr = ['touch', 'mouse', 'pen'];\r\n    let allowedButtonArr = ['left'];\r\n\r\n    let sequenceArr = [];\r\n    const pointersDownIdArr = [];\r\n    let lastUpTime = 0;\r\n    let nowTime = 0;\r\n\r\n    let eventQueueArr = [];\r\n\r\n\r\n    function fail() {\r\n        if (sequenceArr.length === 0) { // no gesture started -> can be ignored\r\n            return;\r\n        }\r\n        clearTimeout(timeoutObj.fail);\r\n        clearTimeout(timeoutObj.maxUntilSecondDown);\r\n        clearTimeout(timeoutObj.success);\r\n        timeoutObj.fail = null;\r\n        timeoutObj.maxUntilSecondDown = null;\r\n        timeoutObj.success = null;\r\n\r\n\r\n        for (let i = 0; i < eventQueueArr.length; i++) {\r\n            chainOut(eventQueueArr[i]);\r\n        }\r\n        eventQueueArr = [];\r\n\r\n        sequenceArr = [];\r\n    }\r\n\r\n    // double tap achieved\r\n    function success() {\r\n        timeoutObj.fail = null;\r\n        timeoutObj.success = null;\r\n        eventQueueArr = []; // events get swallowed\r\n        const lastSequenceItem = sequenceArr[sequenceArr.length - 1];\r\n        sequenceArr = [];\r\n        p.onDoubleTap({pageX: lastSequenceItem.pageX, pageY: lastSequenceItem.pageY});\r\n    }\r\n\r\n\r\n    const timeoutObj = {\r\n        fail: null,\r\n        maxUntilSecondDown: null,\r\n        success: null\r\n    };\r\n\r\n    //returns false if time already up. otherwise sets up timeout\r\n    function setupTimeout(timeoutStr, targetFunc, timeMS) {\r\n        const diff = timeMS - nowTime;\r\n        //console.log(fingers + ': ' + timeoutStr + ' diff', diff);\r\n        if (diff <= 0) { // time already up\r\n            return false;\r\n        }\r\n        timeoutObj[timeoutStr] = setTimeout(targetFunc, diff);\r\n        return true;\r\n    }\r\n\r\n\r\n    /**\r\n     * @param event object - a pointer event from BB.PointerListener\r\n     */\r\n    function processEvent(event) {\r\n\r\n        if (event.type === 'pointerdown') {\r\n            pointersDownIdArr.push(event.pointerId);\r\n        } else if (event.type === 'pointerup') {\r\n            for (let i = 0; i < pointersDownIdArr.length; i++) {\r\n                if (pointersDownIdArr[i] === event.pointerId) {\r\n                    pointersDownIdArr.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!allowedPointerTypeArr.includes(event.pointerType)) { //wrong input type -> fail\r\n            //console.log('wrong input type -> fail');\r\n            fail();\r\n            return;\r\n        }\r\n\r\n        nowTime = performance.now();\r\n        const lastSequenceItem = sequenceArr.length > 0 ? sequenceArr[sequenceArr.length - 1] : null;\r\n        if (event.type === 'pointerup') {\r\n            lastUpTime = event.time;\r\n        }\r\n\r\n        if (event.type === 'pointerdown') {\r\n            if (pointersDownIdArr.length > 1) { // more than one pointer down -> fail\r\n                //console.log('more than one pointer down -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n            if (timeoutObj.success !== null) { // silence-after not achieved -> fail\r\n                //console.log('silence-after not achieved -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n            if (sequenceArr.length === 0 && nowTime - lastUpTime < minSilenceBeforeDurationMs) { // silence before not achieved -> fail\r\n                //console.log('silence before not achieved -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n            if (!allowedButtonArr.includes(event.button)) { // wrong button -> fail\r\n                //console.log('wrong button -> fail', event.button, allowedButtonArr);\r\n                fail();\r\n                return;\r\n            }\r\n            if (lastSequenceItem && lastSequenceItem.isDown || sequenceArr.length > 2) { // jumbled -> fail\r\n                //console.log('jumbled -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n            if (lastSequenceItem) {\r\n                const distance = dist(lastSequenceItem.position[0], lastSequenceItem.position[1], event.pageX, event.pageY);\r\n                if (distance > maxInbetweenDistancePx) { //moved too much -> reset\r\n                    //console.log('maxInbetweenDistancePx -> reset');\r\n                    fail();\r\n\r\n                    if (nowTime - lastSequenceItem.time < minSilenceBeforeDurationMs) { //silence before not achieved -> fail\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n            sequenceArr.push({\r\n                isDown: true,\r\n                time: nowTime,\r\n                position: [event.pageX, event.pageY],\r\n                pointerId: event.pointerId\r\n            });\r\n            //maxUntilSecondDown\r\n\r\n            if (sequenceArr.length > 1) {\r\n                clearTimeout(timeoutObj.maxUntilSecondDown);\r\n            } else if (!setupTimeout('maxUntilSecondDown', fail, event.time + maxUntilSecondDownDurationMs)) {\r\n                //console.log('event.time + maxPressedDurationMs -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n\r\n\r\n            clearTimeout(timeoutObj.fail);\r\n            if (!setupTimeout('fail', fail, event.time + maxPressedDurationMs)) {\r\n                //console.log('event.time + maxPressedDurationMs -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n        }\r\n        if (lastSequenceItem && event.type === 'pointermove' && lastSequenceItem.pointerId === event.pointerId) {\r\n            /*if (lastSequenceItem.pointerId !== event.pointerId) { //another pointer mixing in -> fail\r\n                console.log('another pointer mixing in -> fail');\r\n                fail();\r\n                return;\r\n            }*/\r\n            const distance = dist(lastSequenceItem.position[0], lastSequenceItem.position[1], event.pageX, event.pageY);\r\n            if (distance > maxPressedDistancePx) { //moved too much -> fail\r\n                //console.log('maxPressedDistancePx -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n        }\r\n        if (lastSequenceItem && event.type === 'pointerup') {\r\n            if (lastSequenceItem.pointerId !== event.pointerId) { //another pointer mixing in -> fail\r\n                fail();\r\n                return;\r\n            }\r\n            if (nowTime >= lastSequenceItem.time + maxPressedDurationMs) { //pressed too long -> fail\r\n                fail();\r\n                return;\r\n            }\r\n            clearTimeout(timeoutObj.fail);\r\n\r\n            if (sequenceArr.length < 3) {\r\n                if (!setupTimeout('fail', fail, event.time + maxUpToUpDurationMs)) {\r\n                    fail();\r\n                    return;\r\n                }\r\n\r\n                sequenceArr = [\r\n                    lastSequenceItem,\r\n                    {\r\n                        isUp: true,\r\n                        time: nowTime,\r\n                        position: [event.pageX, event.pageY]\r\n                    }\r\n                ];\r\n                return;\r\n            }\r\n\r\n            if (nowTime < sequenceArr[1].time + maxUpToUpDurationMs) {\r\n                // double tap almost success\r\n                // only needs silence\r\n                sequenceArr.push({\r\n                    pageX: event.pageX,\r\n                    pageY: event.pageY\r\n                });\r\n                if (!setupTimeout('success', success, event.time + minSilenceAfterMs)) {\r\n                    fail();\r\n                }\r\n            } else { // time up -> fail\r\n                fail();\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.chainIn = function (event) {\r\n\r\n        processEvent(event);\r\n\r\n        if (sequenceArr.length === 0) { //existing events can not become a double tap\r\n            fail();\r\n            return event;\r\n        }\r\n        // events might become a double tap -> queue\r\n        eventQueueArr.push(event);\r\n        return null;\r\n    };\r\n\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n\r\n    this.setAllowedPointerTypeArr = function (arr) {\r\n        allowedPointerTypeArr = arr;\r\n    };\r\n\r\n    this.setAllowedButtonArr = function (arr) {\r\n        allowedButtonArr = arr;\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * A ChainElement. Detects a single tap, done with N 'touch' pointers\r\n *\r\n * p = {\r\n *      fingers: number - number of fingers\r\n *      onTap: function() - fires when tap occurs\r\n * }\r\n *\r\n * chainIn\r\n * setChainOut\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const NFingerTapper = function (p) {\r\n\r\n    const fingers = p.fingers;\r\n    let chainOut: ChainOutFunc = function () {\r\n    };\r\n\r\n    const minSilenceBeforeDurationMs = 50; //250;\r\n    const maxTapMs = 500;\r\n    const maxFirstLastFingerDownMs = 250;\r\n    const maxPressedDistancePx = 12; //5 + fingers * 5;\r\n    const silenceAfterDurationMs = 250;\r\n\r\n\r\n    /*\r\n        fingerObj = {\r\n            pointerId: number,\r\n            downTime: number,\r\n            downPageX: number,\r\n            downPageY: number,\r\n            isUp: boolean\r\n        }\r\n     */\r\n    let fingerArr = [];\r\n    let firstDownTime;\r\n    let eventQueueArr = [];\r\n    let lastEventTime = 0;\r\n    const pointersDownIdArr = [];\r\n\r\n    function fail() {\r\n        if (eventQueueArr.length === 0) {\r\n            return;\r\n        }\r\n        clearTimeout(timeoutObj.firstLastDownTimeout);\r\n        clearTimeout(timeoutObj.tapTimeout);\r\n        for (let i = 0; i < eventQueueArr.length; i++) {\r\n            chainOut(eventQueueArr[i]);\r\n        }\r\n        eventQueueArr = [];\r\n        fingerArr = [];\r\n    }\r\n\r\n    function success() {\r\n        clearTimeout(timeoutObj.firstLastDownTimeout);\r\n        clearTimeout(timeoutObj.tapTimeout);\r\n        eventQueueArr = []; // events get swallowed\r\n        fingerArr = [];\r\n        p.onTap();\r\n    }\r\n\r\n    let nowTime;\r\n    const timeoutObj = {\r\n        firstLastDownTimeout: null,\r\n        tapTimeout: null\r\n    };\r\n\r\n    function setupTimeout(timeoutStr, timeMS) {\r\n        const diff = timeMS - nowTime;\r\n        //console.log(fingers + ': ' + timeoutStr + ' diff', diff);\r\n        if (diff <= 0) { // time already up\r\n            return false;\r\n        }\r\n        timeoutObj[timeoutStr] = setTimeout(fail, diff);\r\n        return true;\r\n    }\r\n\r\n    function processEvent(event) {\r\n\r\n        const tempLastEventTime = lastEventTime;\r\n        lastEventTime = event.time;\r\n\r\n        if (event.type === 'pointerdown') {\r\n            pointersDownIdArr.push(event.pointerId);\r\n        } else if (event.type === 'pointerup') {\r\n            for (let i = 0; i < pointersDownIdArr.length; i++) {\r\n                if (pointersDownIdArr[i] === event.pointerId) {\r\n                    pointersDownIdArr.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (event.pointerType !== 'touch') {\r\n            if (fingerArr.length > 0) { // already in gesture -> fail\r\n                fail();\r\n            }\r\n            return;\r\n        }\r\n\r\n        nowTime = performance.now();\r\n\r\n        if (event.type === 'pointerdown') {\r\n            //console.log('down');\r\n            if (fingerArr.length + 1 !== pointersDownIdArr.length) { // failed before, and some fingers are still down -> fail\r\n                fail();\r\n                return;\r\n            }\r\n            if (fingerArr.length === fingers) { // too many fingers down -> fail\r\n                //console.log(fingers + ': too many fingers down -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n            if (fingerArr.length > 0 && event.time - maxFirstLastFingerDownMs > fingerArr[0].downTime) { // took too long to touch with all fingers -> fail\r\n                //console.log(fingers + ': took too long to touch with all fingers -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n            if (fingerArr.length === 0 && event.time - minSilenceBeforeDurationMs < tempLastEventTime) { // not enough silence before -> fail\r\n                //console.log(fingers + ': not enough silence before -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n\r\n            if (fingerArr.length === 0) {\r\n                firstDownTime = event.time;\r\n\r\n                if (!setupTimeout('firstLastDownTimeout', event.time + maxFirstLastFingerDownMs) || !setupTimeout('tapTimeout', event.time + maxTapMs)) { // timeouts already up -> fail\r\n                    fail();\r\n                    return;\r\n                }\r\n\r\n            }\r\n            fingerArr.push({\r\n                pointerId: event.pointerId,\r\n                downTime: event.time,\r\n                downPageX: event.pageX,\r\n                downPageY: event.pageY\r\n            });\r\n            return;\r\n\r\n        }\r\n\r\n        if (event.type === 'pointermove') {\r\n\r\n            if (fingerArr.length === 0) {\r\n                //not in a gesture -> ignore\r\n                return;\r\n            }\r\n\r\n            let fingerObj = null;\r\n            for (let i = 0; i < fingerArr.length; i++) {\r\n                if (fingerArr[i].pointerId === event.pointerId) {\r\n                    fingerObj = fingerArr[i];\r\n                    break;\r\n                }\r\n            }\r\n            if (fingerObj === null) { // finger not part of the tap is on screen -> fail\r\n                fail();\r\n                return;\r\n            }\r\n\r\n            if (event.time - maxTapMs > firstDownTime) { // tap took too long -> fail\r\n                //console.log(fingers + ': tap took too long -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n\r\n            const distance = dist(event.pageX, event.pageY, fingerObj.downPageX, fingerObj.downPageY);\r\n            if (distance > maxPressedDistancePx) { // finger moved too much -> fail\r\n                //console.log(fingers + ': a finger moved too much -> fail', distance);\r\n                fail();\r\n                return;\r\n            }\r\n\r\n        }\r\n\r\n        if (event.type === 'pointerup') {\r\n\r\n            if (fingerArr.length === 0) {\r\n                //not in a gesture -> ignore\r\n                return;\r\n            }\r\n\r\n            //console.log('up', event.pageX, event.pageY);\r\n            if (fingerArr.length !== fingers) { // not enough fingers -> fail\r\n                //console.log(fingers + ': not enough fingers -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n\r\n            let fingerObj = null;\r\n            let i = 0;\r\n            for (; i < fingerArr.length; i++) {\r\n                if (fingerArr[i].pointerId === event.pointerId) {\r\n                    fingerObj = fingerArr[i];\r\n                    break;\r\n                }\r\n            }\r\n            if (fingerObj === null) {\r\n                //do nothing\r\n                return;\r\n            }\r\n\r\n            if (event.time - maxTapMs > firstDownTime) { // tap took too long -> fail\r\n                //console.log(fingers + ': tap took too long -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n\r\n            const distance = dist(event.pageX, event.pageY, fingerObj.downPageX, fingerObj.downPageY);\r\n            if (distance > maxPressedDistancePx) { // finger moved too much -> fail\r\n                //console.log(fingers + ': b finger moved too much -> fail', distance, event.pageX, event.pageY);\r\n                //console.log(fingerArr);\r\n                fail();\r\n                return;\r\n            }\r\n\r\n            fingerObj.isUp = true;\r\n\r\n            let allAreUp = true;\r\n            for (let i = 0; i < fingerArr.length; i++) {\r\n                if (!fingerArr[i].isUp) {\r\n                    allAreUp = false;\r\n                    break;\r\n                }\r\n            }\r\n            //console.log('fingerArr', fingerArr);\r\n\r\n            if (allAreUp) { // success\r\n                success();\r\n                return true;\r\n            }\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.chainIn = function (event) {\r\n\r\n        const result = processEvent(event);\r\n\r\n        //console.log(fingerArr.length);\r\n\r\n        if (result === true) {\r\n            //tap success -> event gets swallowed\r\n            return null;\r\n        }\r\n        if (fingerArr.length === 0) {\r\n            return event;\r\n        } else {\r\n            eventQueueArr.push(event);\r\n        }\r\n\r\n        return null;\r\n\r\n    };\r\n\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * A ChainElement. Detects a pinch zooming (2 touch pointers). If one finger lifts, then will use the remaining.\r\n * Further pointers are ignored, but their events get swallowed during the pinching.\r\n * pinching ends when ALL pointers are lifted.\r\n * Events passed through if no pinching.\r\n *\r\n * p = {\r\n *      onPinch: function({type: 'end'} | {\r\n *          type: 'move',\r\n *          relX: number,\r\n *          relY: number,\r\n *          downRelX: number,\r\n *          downRelY: number,\r\n *          angleDeg: number,\r\n *          scale: number\r\n *      }) - fires when pinching occurs\r\n * }\r\n *\r\n * chainIn\r\n * setChainOut\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const PinchZoomer = function (p) {\r\n\r\n    const firstFingerMaxDistancePx = 10;\r\n    const untilSecondFingerDurationMs = 250;\r\n\r\n    let chainOut: ChainOutFunc = function () {\r\n    };\r\n    const pointersDownIdArr = [];\r\n    /*\r\n    gestureObj = {\r\n        touchPointerArr: Array of {\r\n            pointerId: number,\r\n            relX: number,\r\n            relY: number,\r\n            downRelX: number, // only for first\r\n            downRelY: number\r\n        },\r\n        otherPointerIdArr: number[],\r\n        isInProgress: boolean\r\n    }\r\n    */\r\n    let gestureObj = null;\r\n    let eventQueueArr = [];\r\n\r\n\r\n    function end() {\r\n        gestureObj = null;\r\n        eventQueueArr = [];\r\n    }\r\n\r\n    function fail(doSwallow?) {\r\n        if (!gestureObj) { // no gesture happening -> ignore\r\n            return;\r\n        }\r\n\r\n        clearTimeout(timeoutObj.secondFingerTimeout);\r\n        if (!doSwallow) {\r\n            for (let i = 0; i < eventQueueArr.length; i++) {\r\n                chainOut(eventQueueArr[i]);\r\n            }\r\n        }\r\n        end();\r\n    }\r\n\r\n\r\n    let nowTime;\r\n    const timeoutObj = {\r\n        secondFingerTimeout: null\r\n    };\r\n\r\n    function setupTimeout(timeoutStr, targetFunc, timeMS) {\r\n        const diff = timeMS - nowTime;\r\n        if (diff <= 0) { // time already up\r\n            return false;\r\n        }\r\n        timeoutObj[timeoutStr] = setTimeout(targetFunc, diff);\r\n        return true;\r\n    }\r\n\r\n\r\n    function processEvent(event) {\r\n\r\n        if (event.type === 'pointerdown') {\r\n            pointersDownIdArr.push(event.pointerId);\r\n\r\n        } else if (event.type === 'pointerup') {\r\n            for (let i = 0; i < pointersDownIdArr.length; i++) {\r\n                if (pointersDownIdArr[i] === event.pointerId) {\r\n                    pointersDownIdArr.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        //pass through scenarios\r\n        if (\r\n            !gestureObj && (\r\n                event.pointerType !== 'touch' || // wrong pointer type\r\n                (event.type === 'pointermove' && pointersDownIdArr.length > 0) || // failed before\r\n                pointersDownIdArr.length > 1 || // failed before\r\n                event.type === 'pointerup' // failed before\r\n            )\r\n        ) {\r\n            return;\r\n        }\r\n\r\n        nowTime = performance.now();\r\n\r\n\r\n        //pointer down\r\n        if (event.type === 'pointerdown') {\r\n\r\n            if (gestureObj) {\r\n                if (event.pointerType === 'touch') { // touch finger down - as nth pointer\r\n\r\n                    gestureObj.touchPointerArr.push({\r\n                        pointerId: event.pointerId,\r\n                        relX: event.relX,\r\n                        relY: event.relY\r\n                    });\r\n\r\n                    if (gestureObj.isInProgress) {\r\n                        continuePinch(gestureObj, {\r\n                            type: 'down',\r\n                            index: gestureObj.touchPointerArr.length - 1\r\n                        });\r\n                    } else {\r\n                        clearTimeout(timeoutObj.secondFingerTimeout);\r\n                        gestureObj.isInProgress = true;\r\n                        beginPinch(gestureObj);\r\n                    }\r\n                    return;\r\n\r\n                } else { // non-touch finger down - as nth pointer\r\n\r\n                    if (gestureObj.isInProgress) {\r\n                        gestureObj.otherPointerIdArr.push(event.pointerId);\r\n                    } else { // second pointer wrong type -> fail\r\n                        fail();\r\n                    }\r\n                    return;\r\n                }\r\n\r\n\r\n            } else {\r\n                // first finger down - can only be touch if no gestureObj\r\n                gestureObj = {\r\n                    touchPointerArr: [{\r\n                        pointerId: event.pointerId,\r\n                        relX: event.relX,\r\n                        relY: event.relY,\r\n                        downRelX: event.relX,\r\n                        downRelY: event.relY\r\n                    }],\r\n                    otherPointerIdArr: [],\r\n                    isInProgress: false\r\n                };\r\n                if (!setupTimeout('secondFingerTimeout', function () {\r\n                    fail();\r\n                }, event.time + untilSecondFingerDurationMs)) { // time ran out -> fail\r\n                    fail();\r\n                    return;\r\n                }\r\n                return;\r\n            }\r\n\r\n        }\r\n\r\n\r\n        //pointer move\r\n        if (event.type === 'pointermove' && event.pointerType === 'touch') {\r\n            //gesture object should always exist here\r\n\r\n            let touchPointerObj = null;\r\n            let i = 0;\r\n            for (; i < gestureObj.touchPointerArr.length; i++) {\r\n                if (event.pointerId === gestureObj.touchPointerArr[i].pointerId) {\r\n                    touchPointerObj = gestureObj.touchPointerArr[i];\r\n                    break;\r\n                }\r\n            }\r\n\r\n            //null should not be possible\r\n\r\n            touchPointerObj.relX = event.relX;\r\n            touchPointerObj.relY = event.relY;\r\n\r\n            if (!gestureObj.isInProgress) { // only one finger down & pinching hasn't started\r\n                const distance = dist(touchPointerObj.downRelX, touchPointerObj.downRelY, touchPointerObj.relX, touchPointerObj.relY);\r\n                if (distance > firstFingerMaxDistancePx) { // moved too much -> fail\r\n                    fail();\r\n                    return;\r\n                }\r\n\r\n            } else {\r\n                if (i < 2) { // only first two touches can affect pinching\r\n                    continuePinch(gestureObj, {\r\n                        type: 'move',\r\n                        index: i\r\n                    });\r\n                }\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n\r\n        //pointer up\r\n        if (event.type === 'pointerup') {\r\n            //gesture object should always exist here\r\n\r\n            if (event.pointerType === 'touch') {\r\n                let i = 0;\r\n                for (; i < gestureObj.touchPointerArr.length; i++) {\r\n                    if (gestureObj.touchPointerArr[i].pointerId === event.pointerId) {\r\n                        gestureObj.touchPointerArr.splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n                if (gestureObj.touchPointerArr.length > 0) {\r\n                    continuePinch(gestureObj, {\r\n                        type: 'up',\r\n                        index: i\r\n                    });\r\n                }\r\n\r\n            } else { // non-touch\r\n                for (let i = 0; i < gestureObj.otherPointerIdArr.length; i++) {\r\n                    if (gestureObj.otherPointerIdArr[i] === event.pointerId) {\r\n                        gestureObj.otherPointerIdArr.splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            //all fingers lifted?\r\n            if (gestureObj.touchPointerArr.length === 0 && gestureObj.otherPointerIdArr.length === 0) {\r\n                if (gestureObj.isInProgress) { // lifted last finger -> end of pinching\r\n                    end();\r\n                    endPinch();\r\n                } else { // lifted finger again before pinching started -> fail\r\n                    fail();\r\n                }\r\n                return;\r\n            }\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    // --- actual pinch transform logic ---\r\n\r\n    let pincherArr = [];\r\n\r\n    function beginPinch(gestureObj) {\r\n\r\n        for (let i = 0; i < gestureObj.touchPointerArr.length; i++) {\r\n            const pointerObj = gestureObj.touchPointerArr[i];\r\n            pincherArr.push({\r\n                pointerId: pointerObj.pointerId,\r\n                relX: pointerObj.relX,\r\n                relY: pointerObj.relY,\r\n                downRelX: pointerObj.relX,\r\n                downRelY: pointerObj.relY\r\n            });\r\n        }\r\n\r\n        const event: any = {\r\n            type: 'move',\r\n            angleRad: 0,\r\n            scale: 1\r\n        };\r\n\r\n        if (pincherArr.length === 1) {\r\n            event.relX = pincherArr[0].downRelX;\r\n            event.relY = pincherArr[0].downRelY;\r\n        } else {\r\n            event.relX = 0.5 * (pincherArr[0].downRelX + pincherArr[1].downRelX);\r\n            event.relY = 0.5 * (pincherArr[0].downRelY + pincherArr[1].downRelY);\r\n        }\r\n        event.downRelX = event.relX;\r\n        event.downRelY = event.relY;\r\n\r\n        p.onPinch(event);\r\n\r\n    }\r\n\r\n    //actionObj = {type: 'down'|'move'|'up', index: number}\r\n    function continuePinch(gestureObj, actionObj) {\r\n\r\n        if (actionObj.index > 1) { // only first two pointers matter\r\n            return;\r\n        }\r\n\r\n        if (actionObj.type === 'move') {\r\n\r\n            let event;\r\n            pincherArr[actionObj.index].relX = gestureObj.touchPointerArr[actionObj.index].relX;\r\n            pincherArr[actionObj.index].relY = gestureObj.touchPointerArr[actionObj.index].relY;\r\n\r\n            if (pincherArr.length === 1) {\r\n\r\n                event = {\r\n                    type: 'move',\r\n                    downRelX: pincherArr[0].downRelX,\r\n                    downRelY: pincherArr[0].downRelY,\r\n                    relX: pincherArr[0].relX,\r\n                    relY: pincherArr[0].relY,\r\n                    angleRad: 0,\r\n                    scale: 1\r\n                };\r\n\r\n            } else {\r\n\r\n                const startDist = dist(pincherArr[0].downRelX, pincherArr[0].downRelY, pincherArr[1].downRelX, pincherArr[1].downRelY);\r\n                const distance = dist(pincherArr[0].relX, pincherArr[0].relY, pincherArr[1].relX, pincherArr[1].relY);\r\n\r\n                const startAngle = pointsToAngleRad({\r\n                    x: pincherArr[0].downRelX,\r\n                    y: pincherArr[0].downRelY\r\n                }, {x: pincherArr[1].downRelX, y: pincherArr[1].downRelY});\r\n                const angle = pointsToAngleRad({\r\n                    x: pincherArr[0].relX,\r\n                    y: pincherArr[0].relY\r\n                }, {x: pincherArr[1].relX, y: pincherArr[1].relY});\r\n\r\n                event = {\r\n                    type: 'move',\r\n                    downRelX: 0.5 * (pincherArr[0].downRelX + pincherArr[1].downRelX),\r\n                    downRelY: 0.5 * (pincherArr[0].downRelY + pincherArr[1].downRelY),\r\n                    relX: 0.5 * (pincherArr[0].relX + pincherArr[1].relX),\r\n                    relY: 0.5 * (pincherArr[0].relY + pincherArr[1].relY),\r\n                    angleRad: angle - startAngle,\r\n                    scale: distance / startDist\r\n                };\r\n\r\n            }\r\n\r\n            p.onPinch(event);\r\n\r\n        } else if (actionObj.type === 'down' || actionObj.type === 'up') {\r\n            endPinch();\r\n            beginPinch(gestureObj);\r\n        }\r\n\r\n    }\r\n\r\n    function endPinch() {\r\n        pincherArr = [];\r\n        p.onPinch({\r\n            type: 'end'\r\n        });\r\n    }\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.chainIn = function (event) {\r\n        processEvent(event);\r\n        if (gestureObj) {\r\n            if (!gestureObj.isInProgress) { // might still fail -> into queue\r\n                eventQueueArr.push(event);\r\n            }\r\n        } else {\r\n            return event;\r\n        }\r\n        return null;\r\n    };\r\n\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * A ChainElement. Splits up coalesced events into their own pointermove events. Otherwise regular pass through.\r\n *\r\n * @constructor\r\n */\r\nexport const CoalescedExploder = function () {\r\n\r\n    let chainOut: ChainOutFunc = function () {\r\n    };\r\n\r\n    // --- interface ---\r\n\r\n    this.chainIn = function (event) {\r\n\r\n        if (event.type === 'pointermove') {\r\n\r\n            if (event.coalescedArr.length > 0) {\r\n\r\n                let eventCopy = JSON.parse(JSON.stringify(event));\r\n                eventCopy.coalescedArr = [];\r\n                let coalescedItem;\r\n\r\n                for (let i = 0; i < event.coalescedArr.length; i++) {\r\n\r\n                    if (i > 0) {\r\n                        eventCopy = JSON.parse(JSON.stringify(event));\r\n                    }\r\n                    coalescedItem = event.coalescedArr[i];\r\n\r\n                    eventCopy.pageX = coalescedItem.pageX;\r\n                    eventCopy.pageY = coalescedItem.pageY;\r\n                    eventCopy.relX = coalescedItem.relX;\r\n                    eventCopy.relY = coalescedItem.relY;\r\n                    eventCopy.dX = coalescedItem.dX;\r\n                    eventCopy.dY = coalescedItem.dY;\r\n                    eventCopy.time = coalescedItem.time;\r\n                    if (i < event.coalescedArr.length - 1) {\r\n                        eventCopy.isCoalesced = true;\r\n                    }\r\n\r\n                    chainOut(eventCopy);\r\n                }\r\n\r\n            } else {\r\n                return event;\r\n            }\r\n        } else {\r\n            return event;\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n};\r\n\r\nexport const OnePointerLimiter = function (pointers?) {\r\n\r\n    let chainOut: ChainOutFunc = function () {\r\n    };\r\n\r\n    let downPointerId = null;\r\n    const ignorePointerIdArr = [];\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.chainIn = function (event) {\r\n\r\n        if (ignorePointerIdArr.includes(event.pointerId)) {\r\n            if (event.type === 'pointerup') {\r\n                for (let i = 0; i < ignorePointerIdArr.length; i++) {\r\n                    if (ignorePointerIdArr[i] === event.pointerId) {\r\n                        ignorePointerIdArr.splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n\r\n        if (downPointerId === null) {\r\n            if (event.type === 'pointerdown') {\r\n                downPointerId = event.pointerId;\r\n            }\r\n            return event;\r\n\r\n        } else {\r\n            if (event.pointerId !== downPointerId) {\r\n                if (event.type === 'pointerdown') {\r\n                    ignorePointerIdArr.push(event.pointerId);\r\n                }\r\n                return null;\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                downPointerId = null;\r\n            }\r\n            return event;\r\n        }\r\n\r\n        return null;\r\n\r\n    };\r\n\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n\r\n};\r\n\r\n\r\n/**\r\n * Not really and event chain element. but pretty similar.\r\n *\r\n * Processes draw input events. When shift held -> linetool\r\n * line events - what KlCanvasWorkspace passes onDraw(e)\r\n *\r\n * p = {\r\n *     onDraw: function(drawEvent)\r\n * }\r\n *\r\n * pass input in with process(drawEvent)\r\n *\r\n * modifies draw event to include such events:\r\n * {\r\n *     type: 'line',\r\n *     x0: null, // you have to fill that in\r\n *     y0: null, // you have to fill that in\r\n *     pressure0: null, // you have to fill that in\r\n *     x1: number,\r\n *     y1: number,\r\n *     pressure1: number\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const LinetoolProcessor = function (p) {\r\n\r\n    let downEvent = null;\r\n    let eventQueue = [];\r\n    let direction = null;\r\n    const DIR_X = 0, DIR_Y = 1;\r\n\r\n    this.process = function (event) {\r\n        if (event.type === 'down') {\r\n            downEvent = event;\r\n            direction = null;\r\n\r\n            if (event.shiftIsPressed) {\r\n\r\n                p.onDraw({\r\n                    type: 'line',\r\n                    x0: null,\r\n                    y0: null,\r\n                    pressure0: null,\r\n                    x1: event.x,\r\n                    y1: event.y,\r\n                    pressure1: event.pressure\r\n                });\r\n\r\n                eventQueue.push(event);\r\n                return;\r\n            }\r\n\r\n        }\r\n\r\n        if (event.type === 'move') {\r\n\r\n            if (event.shiftIsPressed) {\r\n\r\n                if (direction === null) {\r\n                    const dX = Math.abs(event.x - downEvent.x);\r\n                    const dY = Math.abs(event.y - downEvent.y);\r\n\r\n                    if (dX > 5 || dY > 5) {\r\n                        direction = dX > dY ? DIR_X : DIR_Y;\r\n\r\n                        for (let i = 0; i < eventQueue.length; i++) {\r\n                            const e = eventQueue[i];\r\n                            if (direction === DIR_X) {\r\n                                e.y = downEvent.y;\r\n                            } else {\r\n                                e.x = downEvent.x;\r\n                            }\r\n                            p.onDraw(JSON.parse(JSON.stringify(e)));\r\n                        }\r\n                        eventQueue = [];\r\n                    }\r\n                }\r\n\r\n                if (direction === null) {\r\n                    eventQueue.push(event);\r\n                    return;\r\n                }\r\n\r\n                if (direction === DIR_X) {\r\n                    event.y = downEvent.y;\r\n                } else {\r\n                    event.x = downEvent.x;\r\n                }\r\n\r\n            } else {\r\n                if (eventQueue.length > 0) {\r\n                    for (let i = 0; i < eventQueue.length; i++) {\r\n                        p.onDraw(JSON.parse(JSON.stringify(eventQueue[i])));\r\n                    }\r\n                    eventQueue = [];\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        if (event.type === 'up') {\r\n            eventQueue = [];\r\n        }\r\n\r\n        p.onDraw(JSON.parse(JSON.stringify(event)));\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * cleans up DrawEvents. More trustworthy events. EventChain element\r\n *\r\n * that events can only go line this: down -> n x move -> up\r\n * so, sanitizes this: down, down, down. becomes only one down. the other downs are ignored/swallowed\r\n * @constructor\r\n */\r\nexport const LineSanitizer = function () {\r\n\r\n    let chainOut: ChainOutFunc = function () {\r\n    };\r\n\r\n    let isDrawing = false;\r\n\r\n    // --- interface ---\r\n    this.chainIn = function (event) {\r\n\r\n        if (event.type === 'down') {\r\n            if (isDrawing) {\r\n                //console.log('line sanitizer - down, but already drawing');\r\n                chainOut({\r\n                    type: 'up',\r\n                    scale: event.scale,\r\n                    shiftIsPressed: event.shiftIsPressed,\r\n                    isCoalesced: false\r\n                });\r\n            } else {\r\n                isDrawing = true;\r\n            }\r\n        }\r\n        if (!isDrawing && (event.type === 'move' || event.type === 'up')) {\r\n            //console.log('line sanitizer - ' + event.type + ' but not drawing');\r\n            return null;\r\n        }\r\n\r\n        if (event.type === 'up' && isDrawing) {\r\n            isDrawing = false;\r\n        }\r\n\r\n        return event;\r\n    };\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n    this.getIsDrawing = function () {\r\n        return isDrawing;\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * Line smoothing. EventChain element. Smoothing via blending new position with old position.\r\n * for onDraw events from KlCanvasWorkspace.\r\n *\r\n * p = {\r\n *     smoothing: number, // 0-1, 0: no smoothing, 1: 100% smoothing -> would never catch up\r\n * }\r\n *\r\n * smoothing > 0: will fire DrawEvents in interval when no new move events\r\n *\r\n * type: 'line' Events are just passed through.\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const LineSmoothing = function (p) {\r\n\r\n    let chainOut: ChainOutFunc = function () {\r\n    };\r\n    let smoothing = clamp(p.smoothing, 0, 1);\r\n    let lastMixedInput;\r\n    let interval;\r\n    let timeout;\r\n\r\n    // --- interface ---\r\n\r\n    this.chainIn = function (event) {\r\n        event = JSON.parse(JSON.stringify(event));\r\n        clearTimeout(timeout);\r\n        clearInterval(interval);\r\n\r\n        if (event.type === 'down') {\r\n            lastMixedInput = {\r\n                x: event.x,\r\n                y: event.y,\r\n                pressure: event.pressure\r\n            };\r\n        }\r\n\r\n        if (event.type === 'move') {\r\n\r\n            const inputX = event.x;\r\n            const inputY = event.y;\r\n            const inputPressure = event.pressure;\r\n\r\n            event.x = mix(event.x, lastMixedInput.x, smoothing);\r\n            event.y = mix(event.y, lastMixedInput.y, smoothing);\r\n            event.pressure = mix(event.pressure, lastMixedInput.pressure, smoothing);\r\n            lastMixedInput = {\r\n                x: event.x,\r\n                y: event.y,\r\n                pressure: event.pressure\r\n            };\r\n\r\n            if (smoothing > 0) {\r\n                timeout = setTimeout(function () {\r\n                    interval = setInterval(function () {\r\n                        event = JSON.parse(JSON.stringify(event));\r\n\r\n                        event.x = mix(inputX, lastMixedInput.x, smoothing);\r\n                        event.y = mix(inputY, lastMixedInput.y, smoothing);\r\n                        event.pressure = mix(inputPressure, lastMixedInput.pressure, smoothing);\r\n                        lastMixedInput = {\r\n                            x: event.x,\r\n                            y: event.y,\r\n                            pressure: event.pressure\r\n                        };\r\n\r\n                        chainOut(event);\r\n                    }, 35);\r\n                }, 80);\r\n            }\r\n\r\n        }\r\n\r\n        return event;\r\n    };\r\n\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n\r\n    this.setSmoothing = function (s) {\r\n        smoothing = clamp(s, 0, 1);\r\n    };\r\n};\r\n","import {IKeyString} from '../BB.types';\r\nimport {createCanvas} from './create-canvas';\r\n\r\nexport function copyCanvas(canvas: HTMLCanvasElement): HTMLCanvasElement {\r\n    const resultCanvas = createCanvas(canvas.width, canvas.height);\r\n    const ctx = resultCanvas.getContext('2d');\r\n    if (!ctx) {\r\n        throw new Error('2d context not supported or canvas already initialized');\r\n    }\r\n    ctx.drawImage(canvas, 0, 0);\r\n    return resultCanvas;\r\n}\r\n\r\n/**\r\n * Determine if should disable imageSmoothing for transformation.\r\n * ImageSmoothing can make images blurry even when they're in the original scale and aligned with the pixelgrid.\r\n */\r\nexport function testShouldPixelate(\r\n    transform: {x: number, y: number, width:number, height: number, angleDeg: number},\r\n    scaleX: number,\r\n    scaleY: number,\r\n): boolean {\r\n    if (\r\n        ![1, -1].includes(scaleX) || ![1, -1].includes(scaleY) ||\r\n        transform.width % 1 !== 0 || transform.height % 1 !== 0 ||\r\n        Math.abs(transform.angleDeg) % 90 !== 0\r\n    ) {\r\n        return false;\r\n    }\r\n    const whSwapped = Math.abs(transform.angleDeg - 90) % 180 === 0;\r\n    const width = whSwapped ? transform.height : transform.width;\r\n    const height = whSwapped ? transform.width : transform.height;\r\n    return (\r\n            (Math.abs(width) % 2 === 0 && transform.x % 1 === 0) ||\r\n            (Math.abs(width) % 2 === 1 && transform.x % 1 === 0.5)\r\n        ) &&\r\n        (\r\n            (Math.abs(height) % 2 === 0 && transform.y % 1 === 0) ||\r\n            (Math.abs(height) % 2 === 1 && transform.y % 1 === 0.5)\r\n        );\r\n}\r\n\r\n\r\n/**\r\n * @param destCtx - the canvas that will be drawn on\r\n * @param transformImage - image that will be drawn on canvas\r\n * @param transform - {x, y, width, height, angle} - x and y are center of transformImage\r\n * @param bounds object - optional {x, y, width, height} - crop of transformImage in transformImage image space\r\n * @param pixelated\r\n */\r\nexport function drawTransformedImageWithBounds(\r\n    destCtx: CanvasRenderingContext2D,\r\n    transformImage: HTMLImageElement | HTMLCanvasElement,\r\n    transform: {x: number, y: number, width:number, height: number, angleDeg: number},\r\n    bounds?: {x: number, y: number, width: number, height: number},\r\n    pixelated?: boolean,\r\n): void {\r\n    if (!bounds) {\r\n        bounds = {\r\n            x: 0,\r\n            y: 0,\r\n            width: transformImage.width,\r\n            height: transformImage.height\r\n        };\r\n    }\r\n\r\n    destCtx.save();\r\n    if (pixelated) {\r\n        destCtx.imageSmoothingEnabled = false;\r\n    } else {\r\n        destCtx.imageSmoothingEnabled = true;\r\n        destCtx.imageSmoothingQuality = 'high';\r\n    }\r\n\r\n    destCtx.translate(transform.x, transform.y);\r\n    destCtx.rotate(transform.angleDeg / 180 * Math.PI);\r\n    destCtx.scale(transform.width > 0 ? 1 : -1, transform.height > 0 ? 1 : -1);\r\n    destCtx.drawImage(\r\n        transformImage,\r\n        bounds.x, bounds.y, bounds.width, bounds.height,\r\n        -Math.abs(transform.width) / 2, -Math.abs(transform.height) / 2, Math.abs(transform.width), Math.abs(transform.height));\r\n\r\n    destCtx.restore();\r\n}\r\n\r\n/**\r\n * all transformations are optional\r\n * center is the point around which will be scaled and rotated\r\n *\r\n * @param baseCanvas canvas - the canvas that will be drawn on\r\n * @param transformImage image|canvas - image that will be drawn on canvas\r\n * @param transformObj {center: {x, y}, scale: {x, y}, translate: {x, y}, angleDegree}\r\n */\r\nexport function drawTransformedImageOnCanvas(\r\n    baseCanvas: HTMLCanvasElement,\r\n    transformImage: HTMLImageElement | HTMLCanvasElement,\r\n    transformObj: {\r\n        center: {x: number, y: number},\r\n        scale: {x: number, y: number},\r\n        translate: {x: number, y: number},\r\n        angleDegree: number,\r\n    },\r\n): void {\r\n    transformObj = JSON.parse(JSON.stringify(transformObj));\r\n    if (!transformObj.center) {\r\n        transformObj.center = {\r\n            x: transformImage.width / 2,\r\n            y: transformImage.height / 2\r\n        }\r\n    }\r\n    if (!transformObj.scale) {\r\n        transformObj.scale = {\r\n            x: 1,\r\n            y: 1\r\n        };\r\n    }\r\n    if (!transformObj.angleDegree) {\r\n        transformObj.angleDegree = 0;\r\n    }\r\n    if (!transformObj.translate) {\r\n        transformObj.translate = {\r\n            x: 0,\r\n            y: 0\r\n        };\r\n    }\r\n\r\n    const ctx = baseCanvas.getContext('2d');\r\n    if (!ctx) {\r\n        throw new Error('2d context not supported or canvas already initialized');\r\n    }\r\n    ctx.save();\r\n    if (\r\n        Math.abs(transformObj.scale.x - 1) >  0.000001 ||\r\n        Math.abs(transformObj.scale.y - 1) > 0.000001 ||\r\n        Math.abs(transformObj.angleDegree % 90) > 0.000001\r\n    ) {\r\n        ctx.imageSmoothingEnabled = true;\r\n        ctx.imageSmoothingQuality = 'high';\r\n    } else {\r\n        ctx.imageSmoothingEnabled = false;\r\n    }\r\n\r\n    ctx.translate(transformObj.translate.x, transformObj.translate.y);\r\n    ctx.translate(transformObj.center.x, transformObj.center.y);\r\n    ctx.rotate(transformObj.angleDegree / 180 * Math.PI);\r\n    ctx.scale(transformObj.scale.x, transformObj.scale.y);\r\n    ctx.translate(-transformObj.center.x, -transformObj.center.y);\r\n    ctx.drawImage(transformImage, 0, 0, transformImage.width, transformImage.height);\r\n\r\n    ctx.restore();\r\n}\r\n\r\nexport const createCheckerCanvas = function(size: number): HTMLCanvasElement {\r\n    const canvas = createCanvas();\r\n    let ctx;\r\n    if (size < 1) {\r\n        canvas.width = 1;\r\n        canvas.height = 1;\r\n        ctx = canvas.getContext('2d');\r\n        if (!ctx) {\r\n            throw new Error('2d context not supported or canvas already initialized');\r\n        }\r\n        ctx.fillStyle = 'rgb(128, 128, 128)';\r\n        ctx.fillRect(0, 0, 1, 1);\r\n    } else if (size > 200) {\r\n        canvas.width = 401;\r\n        canvas.height = 401;\r\n    } else {\r\n        canvas.width = size * 2;\r\n        canvas.height = size * 2;\r\n        ctx = canvas.getContext('2d');\r\n        if (!ctx) {\r\n            throw new Error('2d context not supported or canvas already initialized');\r\n        }\r\n        ctx.fillStyle = 'rgb(255, 255, 255)';\r\n        ctx.fillRect(0, 0, size * 2, size * 2);\r\n        ctx.fillStyle = 'rgb(200, 200, 200)';\r\n        ctx.fillRect(0, 0, size, size);\r\n        ctx.fillRect(size, size, size * 2, size * 2);\r\n    }\r\n    return canvas;\r\n};\r\n\r\nexport const createCheckerDataUrl = (function () {\r\n    const cache: IKeyString = { // previously created dataUrls\r\n        '8': 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMElEQVQ4T2M8ceLEfwY8wNzcHJ80A+OoAcMiDP7//483HZw8eRJ/Ohg1gIFx6IcBAIhJUqnarXQ1AAAAAElFTkSuQmCC',\r\n        '4': 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAJ0lEQVQoU2M8ceLEfwYkYG5ujsxlYKSDgv///6O44eTJk6huoL0CAGsOKVVu8UYvAAAAAElFTkSuQmCC'\r\n    };\r\n\r\n    return function (size: number, callback?: (s: string) => void) {\r\n        function create(size: number): string {\r\n            size = parseInt('' + size);\r\n            if (cache['' + size]) {\r\n                return cache['' + size];\r\n            }\r\n            const canvas = createCheckerCanvas(size);\r\n            const result = canvas.toDataURL('image/png');\r\n            cache['' + size] = result;\r\n            return result;\r\n        }\r\n\r\n        if (callback) { //async\r\n            setTimeout(function () {\r\n                callback(create(size));\r\n            }, 1);\r\n        } else { //sync\r\n            return create(size);\r\n        }\r\n    };\r\n})();\r\n\r\n/**\r\n * smooth resize image\r\n * @param canvas canvas - will be resized (modified)\r\n * @param w\r\n * @param h\r\n * @param tmp1 canvas - optional, provide to save resources\r\n * @param tmp2 canvas - optional, provide to save resources\r\n */\r\nexport function resizeCanvas(\r\n    canvas: HTMLCanvasElement,\r\n    w: number,\r\n    h: number,\r\n    tmp1?: HTMLCanvasElement,\r\n    tmp2?: HTMLCanvasElement,\r\n): void {\r\n\r\n    //determine base 2 exponents of old and new size\r\n    function getBase2Obj(oldW: number, oldH: number, newW: number, newH: number) {\r\n        const result = {\r\n            oldWidthEx: Math.round(Math.log2(oldW)),\r\n            oldHeightEx: Math.round(Math.log2(oldH)),\r\n            newWidthEx: Math.ceil(Math.log2(newW)),\r\n            newHeightEx: Math.ceil(Math.log2(newH))\r\n        };\r\n        result.oldWidthEx = Math.max(result.oldWidthEx, result.newWidthEx);\r\n        result.oldHeightEx = Math.max(result.oldHeightEx, result.newHeightEx);\r\n        return result;\r\n    }\r\n\r\n    if (!w || !h || (w === canvas.width && h === canvas.height)) {\r\n        return;\r\n    }\r\n    w = Math.max(w, 1);\r\n    h = Math.max(h, 1);\r\n    if (w <= canvas.width && h <= canvas.height) {\r\n\r\n        tmp1 = !tmp1 ? createCanvas() : tmp1;\r\n        tmp2 = !tmp2 ? createCanvas() : tmp2;\r\n\r\n        const base2 = getBase2Obj(canvas.width, canvas.height, w, h);\r\n\r\n        //initially scale to a base of 2. unless new size is too close to old. e.g. sizing from 900 to 600\r\n        tmp2.width = base2.oldWidthEx > base2.newWidthEx ? Math.pow(2, base2.oldWidthEx) : w;\r\n        tmp2.height = base2.oldHeightEx > base2.newHeightEx ? Math.pow(2, base2.oldHeightEx) : h;\r\n        tmp1.getContext('2d')!.save();\r\n        tmp2.getContext('2d')!.save();\r\n\r\n        let ew, eh;\r\n        let buffer1 = tmp1, buffer2 = tmp2;\r\n\r\n        ew = base2.oldWidthEx;\r\n        eh = base2.oldHeightEx;\r\n\r\n        let bufferCtx = buffer2.getContext('2d')!;\r\n        bufferCtx.imageSmoothingEnabled = true;\r\n        bufferCtx.imageSmoothingQuality  = 'high';\r\n        bufferCtx.globalCompositeOperation  = 'copy';\r\n        bufferCtx.drawImage(canvas, 0, 0, buffer2.width, buffer2.height);\r\n\r\n        let currentWidth = buffer2.width;\r\n        let currentHeight = buffer2.height;\r\n\r\n        //stepwise half the size\r\n        for (; ew > base2.newWidthEx || eh > base2.newHeightEx; ew--, eh--) {\r\n            bufferCtx = buffer1.getContext('2d')!;\r\n            bufferCtx.imageSmoothingEnabled = true;\r\n            bufferCtx.imageSmoothingQuality  = 'high';\r\n            bufferCtx.globalCompositeOperation  = 'copy';\r\n\r\n            const newWidth = (ew > base2.newWidthEx) ? currentWidth / 2 : currentWidth;\r\n            const newHeight = (eh > base2.newHeightEx) ? currentHeight / 2 : currentHeight;\r\n\r\n            //buffer also needs to be properly sized, unfortunately\r\n            buffer1.width = newWidth;\r\n            buffer1.height = newHeight;\r\n\r\n            bufferCtx.drawImage(\r\n                buffer2,\r\n                0, 0,\r\n                currentWidth, currentHeight,\r\n                0, 0,\r\n                newWidth, newHeight\r\n            );\r\n            currentWidth = newWidth;\r\n            currentHeight = newHeight;\r\n\r\n            //swap\r\n            const tmp = buffer1;\r\n            buffer1 = buffer2;\r\n            buffer2 = tmp;\r\n        }\r\n\r\n        //when no longer can be halved, bring to target size\r\n        canvas.width = w;\r\n        canvas.height = h;\r\n        const canvasCtx = canvas.getContext('2d')!;\r\n        canvasCtx.save();\r\n        canvasCtx.imageSmoothingEnabled = true;\r\n        canvasCtx.imageSmoothingQuality  = 'high';\r\n        canvasCtx.drawImage(\r\n            buffer2,\r\n            0, 0,\r\n            currentWidth, currentHeight,\r\n            0, 0,\r\n            w, h\r\n        );\r\n        canvasCtx.restore();\r\n        tmp1.getContext('2d')!.restore();\r\n        tmp2.getContext('2d')!.restore();\r\n\r\n    } else if (w >= canvas.width && h >= canvas.height) {\r\n\r\n        tmp1 = !tmp1 ? createCanvas() : tmp1;\r\n        tmp1.width = w;\r\n        tmp1.height = h;\r\n        const tmp1Ctx = tmp1.getContext('2d')!;\r\n        tmp1Ctx.save();\r\n        tmp1Ctx.imageSmoothingEnabled = true;\r\n        tmp1Ctx.imageSmoothingQuality  = 'high';\r\n        tmp1Ctx.drawImage(canvas, 0, 0, w, h);\r\n        tmp1Ctx.restore();\r\n\r\n        canvas.width = w;\r\n        canvas.height = h;\r\n        canvas.getContext('2d')!.drawImage(tmp1, 0, 0);\r\n\r\n    } else {\r\n        resizeCanvas(canvas, w, canvas.height, tmp1, tmp2);\r\n        resizeCanvas(canvas, w, h, tmp1, tmp2);\r\n    }\r\n}\r\n\r\n/**\r\n * puts naive greyscale version of image into alpha channel.\r\n * only writes a, doesn't write rgb\r\n * @param canvas\r\n */\r\nexport function convertToAlphaChannelCanvas(canvas: HTMLCanvasElement): void {\r\n    const imdat = canvas.getContext('2d')!.getImageData(0, 0, canvas.width, canvas.height);\r\n    for (let i = 0; i < imdat.data.length; i += 4) {\r\n        if (imdat.data[i + 3] === 0) {\r\n            continue;\r\n        }\r\n        imdat.data[i + 3] = (imdat.data[i] + imdat.data[i + 1] + imdat.data[i + 2]) / 3 * (imdat.data[i + 3] / 255);\r\n    }\r\n    canvas.getContext('2d')!.putImageData(imdat, 0, 0);\r\n}\r\n\r\n/**\r\n * Sometimes garbage collection is too slow, and canvases use up too much memory,\r\n * or there is a hard to fix memory leak.\r\n * This function manually makes the canvas use as little memory as possible.\r\n */\r\nexport function freeCanvas(canvas: HTMLCanvasElement): void {\r\n    canvas.width = 1;\r\n    canvas.height = 1;\r\n    const ctx = canvas.getContext('2d');\r\n    ctx && ctx.clearRect(0, 0, 1, 1);\r\n}","export const Matrix = (function () {\r\n\r\n    // https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Matrix_math_for_the_web\r\n    // yes not optimized - but it's not used for physics simulations.\r\n\r\n    // const perfTotal = 0;\r\n\r\n    // point • matrix\r\n    function multiplyMatrixAndPoint(matrix, point) {\r\n        const result = [\r\n            (point[0] * matrix[0]) + (point[1] * matrix[4]) + (point[2] * matrix[8]) + (point[3] * matrix[12]), // x\r\n            (point[0] * matrix[1]) + (point[1] * matrix[5]) + (point[2] * matrix[9]) + (point[3] * matrix[13]), // y\r\n            (point[0] * matrix[2]) + (point[1] * matrix[6]) + (point[2] * matrix[10]) + (point[3] * matrix[14]), // z\r\n            (point[0] * matrix[3]) + (point[1] * matrix[7]) + (point[2] * matrix[11]) + (point[3] * matrix[15]) // w\r\n        ];\r\n        return result;\r\n    }\r\n\r\n    //matrixB • matrixA\r\n    function multiplyMatrices(matrixA, matrixB) {\r\n\r\n        // Slice the second matrix up into rows\r\n        const row0 = [matrixB[0], matrixB[1], matrixB[2], matrixB[3]];\r\n        const row1 = [matrixB[4], matrixB[5], matrixB[6], matrixB[7]];\r\n        const row2 = [matrixB[8], matrixB[9], matrixB[10], matrixB[11]];\r\n        const row3 = [matrixB[12], matrixB[13], matrixB[14], matrixB[15]];\r\n\r\n        // Multiply each row by matrixA\r\n        const result0 = multiplyMatrixAndPoint(matrixA, row0);\r\n        const result1 = multiplyMatrixAndPoint(matrixA, row1);\r\n        const result2 = multiplyMatrixAndPoint(matrixA, row2);\r\n        const result3 = multiplyMatrixAndPoint(matrixA, row3);\r\n\r\n        // Turn the result rows back into a single matrix\r\n        return [\r\n            result0[0], result0[1], result0[2], result0[3],\r\n            result1[0], result1[1], result1[2], result1[3],\r\n            result2[0], result2[1], result2[2], result2[3],\r\n            result3[0], result3[1], result3[2], result3[3]\r\n        ];\r\n    }\r\n\r\n    function createTranslationMatrix(x, y) {\r\n        return [\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, 0,\r\n            x, y, 0, 1\r\n        ];\r\n    }\r\n\r\n    function createRotationMatrix(angleRad) {\r\n        //let angleRad = angleDeg / 360 * 2 * Math.PI;\r\n        return [\r\n            Math.cos(-angleRad), -Math.sin(-angleRad), 0, 0,\r\n            Math.sin(-angleRad), Math.cos(-angleRad), 0, 0,\r\n            0, 0, 1, 0,\r\n            0, 0, 0, 1\r\n        ];\r\n    }\r\n\r\n    function createScaleMatrix(f) {\r\n        return [\r\n            f, 0, 0, 0,\r\n            0, f, 0, 0,\r\n            0, 0, 1, 0,\r\n            0, 0, 0, 1\r\n        ];\r\n    }\r\n\r\n    return {\r\n        getIdentity: function () {\r\n            return [\r\n                1, 0, 0, 0,\r\n                0, 1, 0, 0,\r\n                0, 0, 1, 0,\r\n                0, 0, 0, 1\r\n            ];\r\n        },\r\n        multiplyMatrixAndPoint: multiplyMatrixAndPoint,\r\n        multiplyMatrices: multiplyMatrices,\r\n        createTranslationMatrix: createTranslationMatrix,\r\n        createRotationMatrix: createRotationMatrix,\r\n        createScaleMatrix: createScaleMatrix\r\n    };\r\n})();","import {IVector2D} from '../BB.types';\r\n\r\nexport const Vec2 = {\r\n    add: function (p1: IVector2D, p2: IVector2D): IVector2D {\r\n        return {x: p1.x + p2.x, y: p1.y + p2.y};\r\n    },\r\n    sub: function (p1: IVector2D, p2: IVector2D): IVector2D {\r\n        return {x: p1.x - p2.x, y: p1.y - p2.y};\r\n    },\r\n    nor: function (p: IVector2D): IVector2D {\r\n        const len = Math.sqrt(Math.pow(p.x, 2) + Math.pow(p.y, 2));\r\n        return {x: p.x / len, y: p.y / len};\r\n    },\r\n    len: function (p: IVector2D): number {\r\n        return Math.sqrt(Math.pow(p.x, 2) + Math.pow(p.y, 2));\r\n    },\r\n    dist: function (p1: IVector2D, p2: IVector2D): number {\r\n        return Vec2.len(Vec2.sub(p1, p2));\r\n    },\r\n    mul: function (p: IVector2D, s: number): IVector2D {\r\n        return {x: p.x * s, y: p.y * s};\r\n    },\r\n    angle: function (p1: IVector2D, p2: IVector2D): number {\r\n        return Math.atan2(p2.y - p1.y, p2.x - p1.x);\r\n    },\r\n    dot: function(a: IVector2D, b: IVector2D): number {\r\n        const aArr = [a.x, a.y];\r\n        const bArr = [b.x, b.y];\r\n        return aArr.map((x, i) => aArr[i] * bArr[i]).reduce((m, n) => m + n);\r\n    }\r\n};","import {Vec2} from './vec2';\r\nimport {pointsToAngleDeg, clamp, dist, mix} from './math';\r\nimport {IVector2D} from \"../bb.types\";\r\n\r\n/**\r\n * project p onto line\r\n * @param lineStart\r\n * @param lineEnd\r\n * @param p\r\n */\r\nexport const projectPointOnLine = function (lineStart: IVector2D, lineEnd: IVector2D, p: IVector2D): IVector2D {\r\n    let x, y;\r\n    if (lineStart.x === lineEnd.x) {\r\n        x = lineStart.x;\r\n        y = p.y;\r\n\r\n        return {\r\n            x: x,\r\n            y: y\r\n        };\r\n    }\r\n    const m = (lineEnd.y - lineStart.y) / (lineEnd.x - lineStart.x);\r\n    const b = lineStart.y - (m * lineStart.x);\r\n\r\n    x = (m * p.y + p.x - m * b) / (m * m + 1);\r\n    y = (m * m * p.y + m * p.x + b) / (m * m + 1);\r\n\r\n    return {\r\n        x: x,\r\n        y: y\r\n    };\r\n};\r\n\r\n\r\n\r\n/**\r\n * Operations on a line made up of points\r\n *\r\n * getAtDist(dist) - point when traveling *dist* along the line\r\n * getLength - gives you total length of line\r\n *\r\n * @param params object - {points: [{x:float, y:float}, ...]}\r\n * @constructor\r\n */\r\nexport const PointLine = function (params) {\r\n    const segmentArr = [];\r\n    const _this = this;\r\n\r\n    for (let i = 0; i < params.points.length; i++) {\r\n        (function (i) {\r\n            let length = undefined;\r\n            if (i < params.points.length - 1) {\r\n                length = dist(params.points[i].x, params.points[i].y, params.points[i + 1].x, params.points[i + 1].y);\r\n            }\r\n            segmentArr[i] = {\r\n                x: params.points[i].x,\r\n                y: params.points[i].y,\r\n                length: length\r\n            };\r\n        })(i);\r\n    }\r\n\r\n    /**\r\n     * @param dist number - distance in pixels, > 0\r\n     * @returns {{x: number, y: number}}\r\n     */\r\n    this.getAtDist = function (dist) {\r\n        let remainder = Math.min(_this.getLength(), dist);\r\n        let i = 0;\r\n\r\n        for (; remainder > segmentArr[i].length && i < segmentArr.length - 2; i++) {\r\n            remainder -= segmentArr[i].length;\r\n        }\r\n\r\n        const fac = Math.min(1, Math.max(0, remainder / segmentArr[i].length));\r\n\r\n        return {\r\n            x: (segmentArr[i].x * (1 - fac) + segmentArr[i + 1].x * fac),\r\n            y: (segmentArr[i].y * (1 - fac) + segmentArr[i + 1].y * fac)\r\n        };\r\n    };\r\n    this.getLength = function () {\r\n        let result = 0;\r\n        for (let i = 0; i < segmentArr.length - 1; i++) {\r\n            result += segmentArr[i].length;\r\n        }\r\n        return result;\r\n    };\r\n};\r\n\r\n/**\r\n * Each instance is one line made up of bezier interpolated segments.\r\n * You feed it points. It calculates control points on its own, and the resulting curve.\r\n *\r\n * @constructor\r\n */\r\nexport const BezierLine = function () {\r\n    const _this = this;\r\n    const pointArr = [];\r\n    let lastDot = 0;\r\n    let lastPoint;\r\n    let lastCallbackPoint;\r\n    let lastAngle;\r\n    let lastSpacing = null;\r\n\r\n    /**\r\n     * creates bezier curve from control points\r\n     *\r\n     * @param p1 - control point 1 {x: float, y: float}\r\n     * @param p2 - control point 2 {x: float, y: float}\r\n     * @param p3 - control point 3 {x: float, y: float}\r\n     * @param p4 - control point 4 {x: float, y: float}\r\n     * @param resolution - int\r\n     * @returns {Array} - bezier curve made up of points {x: float, y: float}\r\n     */\r\n    function getBezierPoints(p1, p2, p3, p4, resolution) {\r\n        const curvePoints = [];\r\n        let t, result;\r\n        for (let i = 0; i <= resolution; i++) {\r\n            t = i / resolution;\r\n            result = {};\r\n            result.x = Math.pow(1 - t, 3) * p1.x + 3 * Math.pow(1 - t, 2) * t * p2.x + 3 * (1 - t) * Math.pow(t, 2) * p3.x + Math.pow(t, 3) * p4.x;\r\n            result.y = Math.pow(1 - t, 3) * p1.y + 3 * Math.pow(1 - t, 2) * t * p2.y + 3 * (1 - t) * Math.pow(t, 2) * p3.y + Math.pow(t, 3) * p4.y;\r\n            curvePoints[curvePoints.length] = result;\r\n        }\r\n        return curvePoints;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * add now point to line\r\n     * line will go until the previous point\r\n     *\r\n     * @param x - coord of new point\r\n     * @param y - coord of new point\r\n     * @param spacing - space between each step\r\n     * @param callback - calls for each step - x, y, t - t is 0-1 how far along\r\n     * @param controlsCallback - calls that callback with the bezier control points p1, p2, p3, p4 - each {x: float, y: float}\r\n     */\r\n    this.add = function (x, y, spacing, callback, controlsCallback) {\r\n        if (lastPoint && x === lastPoint.x && y === lastPoint.y) {\r\n            return;\r\n        }\r\n        lastPoint = {x: x, y: y};\r\n        pointArr[pointArr.length] = {\r\n            x: x,\r\n            y: y,\r\n            spacing: spacing\r\n        };\r\n\r\n        //calculate directions\r\n        if (pointArr.length === 1) {\r\n            lastSpacing = spacing;\r\n            return;\r\n        } else if (pointArr.length === 2) {\r\n            pointArr[0].dir = Vec2.nor(Vec2.sub(pointArr[1], pointArr[0]));\r\n            lastDot = spacing;\r\n            lastSpacing = spacing;\r\n            return;\r\n        } else {\r\n            const pointM1 = pointArr[pointArr.length - 1];\r\n            const pointM2 = pointArr[pointArr.length - 2];\r\n            const pointM3 = pointArr[pointArr.length - 3];\r\n            pointM2.dir = Vec2.nor(Vec2.sub(pointM1, pointM3));\r\n            if (isNaN(pointM2.dir.x) || isNaN(pointM2.dir.y)) {\r\n                //when xy -3 == -1\r\n                pointM2.dir = JSON.parse(JSON.stringify(pointM3.dir));\r\n            }\r\n        }\r\n\r\n        //get bezier curve\r\n        const a = pointArr[pointArr.length - 3];\r\n        const b = pointArr[pointArr.length - 2];\r\n        const p1 = a;\r\n        const p2 = Vec2.add(a, Vec2.mul(a.dir, Vec2.dist(a, b) / 4));\r\n        const p3 = Vec2.sub(b, Vec2.mul(b.dir, Vec2.dist(a, b) / 4));\r\n        const p4 = b;\r\n\r\n\r\n        let pointLine;\r\n        if (callback) {\r\n            let curvePoints;\r\n            curvePoints = getBezierPoints(p1, p2, p3, p4, 20);\r\n            pointLine = new PointLine({points: curvePoints});\r\n        } else {\r\n            pointLine = new PointLine({points: [p1, p4]});\r\n        }\r\n\r\n        //interate over curve with spacing and callback\r\n        const len = pointLine.getLength();\r\n        let tempSpacing = mix(lastSpacing, spacing, clamp(lastDot / len, 0, 1));\r\n        let d = lastDot;\r\n        for (; d <= len; d += tempSpacing) {\r\n            tempSpacing = mix(lastSpacing, spacing, clamp(d / len, 0, 1));\r\n            const point = pointLine.getAtDist(d);\r\n            const angle = lastCallbackPoint ? pointsToAngleDeg(lastCallbackPoint, point) : undefined;\r\n            if (callback) {\r\n                callback({\r\n                    x: point.x,\r\n                    y: point.y,\r\n                    t: d / len,\r\n                    angle: angle,\r\n                    dAngle: lastCallbackPoint ? angle - lastAngle : 0\r\n                });\r\n            }\r\n            lastCallbackPoint = point;\r\n            lastAngle = angle;\r\n        }\r\n\r\n        if (callback) {\r\n            lastDot = d - len;\r\n        } else {\r\n            lastDot = 0;\r\n            controlsCallback({p1: p1, p2: p2, p3: p3, p4: p4});\r\n        }\r\n\r\n        lastSpacing = spacing;\r\n    };\r\n\r\n    this.addFinal = function(spacing, callback, controlsCallback) {\r\n        if (pointArr.length < 2) {\r\n            return;\r\n        }\r\n\r\n        const p1 = pointArr[pointArr.length - 2];\r\n        const p2 = pointArr[pointArr.length - 1];\r\n\r\n        const newP = Vec2.add(p2, Vec2.sub(p2, p1));\r\n\r\n        _this.add(newP.x, newP.y, spacing, callback, controlsCallback);\r\n    };\r\n\r\n};\r\n\r\n/**\r\n * from glfx.script by evanW:\r\n * from SplineInterpolator.cs in the Paint.NET source code\r\n *\r\n * points go 0 - 1. I think.\r\n *\r\n * @param points\r\n * @constructor\r\n */\r\nexport const SplineInterpolator = function (points) {\r\n    const n = points.length;\r\n    this.xa = [];\r\n    this.ya = [];\r\n    this.u = [];\r\n    this.y2 = [];\r\n    let i;\r\n\r\n    const first = points[0][0];\r\n    const last = points[points.length - 1][0];\r\n\r\n    points.sort(function (a, b) {\r\n        return a[0] - b[0];\r\n    });\r\n    for (i = 0; i < n; i++) {\r\n        this.xa.push(points[i][0]);\r\n        this.ya.push(points[i][1]);\r\n    }\r\n\r\n    this.u[0] = 0;\r\n    this.y2[0] = 0;\r\n\r\n    for (i = 1; i < n - 1; ++i) {\r\n        // This is the decomposition loop of the tridiagonal algorithm.\r\n        // y2 and u are used for temporary storage of the decomposed factors.\r\n        const wx = this.xa[i + 1] - this.xa[i - 1];\r\n        const sig = (this.xa[i] - this.xa[i - 1]) / wx;\r\n        const p = sig * this.y2[i - 1] + 2.0;\r\n\r\n        this.y2[i] = (sig - 1.0) / p;\r\n\r\n        const ddydx =\r\n            (this.ya[i + 1] - this.ya[i]) / (this.xa[i + 1] - this.xa[i]) -\r\n            (this.ya[i] - this.ya[i - 1]) / (this.xa[i] - this.xa[i - 1]);\r\n\r\n        this.u[i] = (6.0 * ddydx / wx - sig * this.u[i - 1]) / p;\r\n    }\r\n\r\n    this.y2[n - 1] = 0;\r\n\r\n    // This is the backsubstitution loop of the tridiagonal algorithm\r\n    for (i = n - 2; i >= 0; --i) {\r\n        this.y2[i] = this.y2[i] * this.y2[i + 1] + this.u[i];\r\n    }\r\n\r\n    this.getFirstX = function () {\r\n        return first;\r\n    };\r\n    this.getLastX = function () {\r\n        return last;\r\n    };\r\n};\r\n\r\nSplineInterpolator.prototype.interpolate = function (x) {\r\n    const n = this.ya.length;\r\n    let klo = 0;\r\n    let khi = n - 1;\r\n\r\n    // We will find the right place in the table by means of\r\n    // bisection. This is optimal if sequential calls to this\r\n    // routine are at random values of x. If sequential calls\r\n    // are in order, and closely spaced, one would do better\r\n    // to store previous values of klo and khi.\r\n    while (khi - klo > 1) {\r\n        const k = (khi + klo) >> 1;\r\n\r\n        if (this.xa[k] > x) {\r\n            khi = k;\r\n        } else {\r\n            klo = k;\r\n        }\r\n    }\r\n\r\n    const h = this.xa[khi] - this.xa[klo];\r\n    const a = (this.xa[khi] - x) / h;\r\n    const b = (x - this.xa[klo]) / h;\r\n\r\n    // Cubic spline polynomial is now evaluated.\r\n    return a * this.ya[klo] + b * this.ya[khi] +\r\n        ((a * a * a - a) * this.y2[klo] + (b * b * b - b) * this.y2[khi]) * (h * h) / 6.0;\r\n};\r\n\r\n/**\r\n * find x to y. simply by stepping through. suboptimal, so don't call often.\r\n * searches in x 0-1 range\r\n *\r\n * @param y\r\n * @param resolution\r\n */\r\nSplineInterpolator.prototype.findX = function (y, resolution) {\r\n    let x = null;\r\n    let dist = null;\r\n    for (let i = 0; i <= resolution; i++) {\r\n        const tempX = i / resolution;\r\n        const tempY = this.interpolate(tempX);\r\n        if (x === null) {\r\n            x = tempX;\r\n            dist = Math.abs(tempY - y);\r\n            continue;\r\n        }\r\n\r\n        const tempDist = Math.abs(tempY - y);\r\n\r\n        if (tempDist < dist) {\r\n            x = tempX;\r\n            dist = tempDist;\r\n        } else {\r\n            //distance increasing\r\n            break;\r\n        }\r\n    }\r\n    return x;\r\n};\r\n\r\n/**\r\n * input for a spline, following curve of quadratic function x^2 [0 - 1]\r\n * returns [[0, startVal], ..., [1, endVal]]\r\n * @param startVal\r\n * @param endVal\r\n * @param stepSize\r\n * @returns {[]}\r\n */\r\nexport const quadraticSplineInput = function (startVal, endVal, stepSize) {\r\n    function round(v, dec) {\r\n        return Math.round(v * Math.pow(10, dec)) / Math.pow(10, dec);\r\n    }\r\n\r\n    const resultArr = [];\r\n    for (let i = 0; i <= 1; i += stepSize) {\r\n        resultArr.push([round(i, 4), round(startVal + Math.pow(i, 2) * (endVal - startVal), 4)]);\r\n    }\r\n    return resultArr;\r\n};","\r\n\r\n\r\n// based on js color conversion http://www.webtoolkit.info/\r\n\r\n\r\nexport class HSV {\r\n    h: number;\r\n    s: number;\r\n    v: number;\r\n    constructor(h: number, s: number, v: number) {\r\n        this.h = Math.max(0, Math.min(360, h));\r\n        this.s = Math.max(0.001, Math.min(100, s)); //bug when 0\r\n        this.v = Math.max(0, Math.min(100, v));\r\n    }\r\n}\r\n\r\nexport class RGB {\r\n    r : number;\r\n    g: number;\r\n    b: number;\r\n    constructor(r: number, g: number, b: number) {\r\n        this.r = Math.max(0, Math.min(255, r));\r\n        this.g = Math.max(0, Math.min(255, g));\r\n        this.b = Math.max(0, Math.min(255, b));\r\n    }\r\n}\r\n\r\nexport class CMYK {\r\n    c: number;\r\n    m: number;\r\n    y: number;\r\n    k: number;\r\n    constructor(c: number, m: number, y: number, k: number) {\r\n        this.c = Math.max(0, Math.min(100, c));\r\n        this.m = Math.max(0, Math.min(100, m));\r\n        this.y = Math.max(0, Math.min(100, y));\r\n        this.k = Math.max(0, Math.min(100, k));\r\n    }\r\n}\r\n\r\nexport const ColorConverter = {\r\n\r\n    _RGBtoHSV: function (RGB: RGB): HSV {\r\n        const result = new HSV(0, 0, 0);\r\n\r\n        const r = RGB.r / 255;\r\n        const g = RGB.g / 255;\r\n        const b = RGB.b / 255;\r\n\r\n        const minVal = Math.min(r, g, b);\r\n        const maxVal = Math.max(r, g, b);\r\n        const delta = maxVal - minVal;\r\n\r\n        result.v = maxVal;\r\n\r\n        if (delta == 0) {\r\n            result.h = 0;\r\n            result.s = 0;\r\n        } else {\r\n            result.s = delta / maxVal;\r\n            const del_R = (((maxVal - r) / 6) + (delta / 2)) / delta;\r\n            const del_G = (((maxVal - g) / 6) + (delta / 2)) / delta;\r\n            const del_B = (((maxVal - b) / 6) + (delta / 2)) / delta;\r\n\r\n            if (r == maxVal) {\r\n                result.h = del_B - del_G;\r\n            } else if (g == maxVal) {\r\n                result.h = (1 / 3) + del_R - del_B;\r\n            } else if (b == maxVal) {\r\n                result.h = (2 / 3) + del_G - del_R;\r\n            }\r\n\r\n            if (result.h < 0) {\r\n                result.h += 1;\r\n            }\r\n            if (result.h > 1) {\r\n                result.h -= 1;\r\n            }\r\n        }\r\n\r\n        result.h = Math.round(result.h * 360);\r\n        result.s = Math.round(result.s * 100);\r\n        result.v = Math.round(result.v * 100);\r\n\r\n        return result;\r\n    },\r\n\r\n    _HSVtoRGB: function (HSV: HSV): RGB {\r\n        const result = new RGB(0, 0, 0);\r\n\r\n        let var_h, var_i, var_1, var_2, var_3, var_r, var_g, var_b;\r\n\r\n        const h = (HSV.h / 360) % 1;\r\n        const s = HSV.s / 100;\r\n        const v = HSV.v / 100;\r\n\r\n        if (s == 0) {\r\n            result.r = v * 255;\r\n            result.g = v * 255;\r\n            result.b = v * 255;\r\n        } else {\r\n            var_h = h * 6;\r\n            var_i = Math.floor(var_h);\r\n            var_1 = v * (1 - s);\r\n            var_2 = v * (1 - s * (var_h - var_i));\r\n            var_3 = v * (1 - s * (1 - (var_h - var_i)));\r\n\r\n            if (var_i == 0) {\r\n                var_r = v;\r\n                var_g = var_3;\r\n                var_b = var_1\r\n            } else if (var_i == 1) {\r\n                var_r = var_2;\r\n                var_g = v;\r\n                var_b = var_1\r\n            } else if (var_i == 2) {\r\n                var_r = var_1;\r\n                var_g = v;\r\n                var_b = var_3\r\n            } else if (var_i == 3) {\r\n                var_r = var_1;\r\n                var_g = var_2;\r\n                var_b = v\r\n            } else if (var_i == 4) {\r\n                var_r = var_3;\r\n                var_g = var_1;\r\n                var_b = v\r\n            } else {\r\n                var_r = v;\r\n                var_g = var_1;\r\n                var_b = var_2\r\n            }\r\n\r\n            result.r = var_r * 255;\r\n            result.g = var_g * 255;\r\n            result.b = var_b * 255;\r\n\r\n            result.r = Math.round(result.r);\r\n            result.g = Math.round(result.g);\r\n            result.b = Math.round(result.b);\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    _CMYKtoRGB: function (CMYK: CMYK): RGB {\r\n        const result = new RGB(0, 0, 0);\r\n\r\n        const c = CMYK.c / 100;\r\n        const m = CMYK.m / 100;\r\n        const y = CMYK.y / 100;\r\n        const k = CMYK.k / 100;\r\n\r\n        result.r = 1 - Math.min(1, c * (1 - k) + k);\r\n        result.g = 1 - Math.min(1, m * (1 - k) + k);\r\n        result.b = 1 - Math.min(1, y * (1 - k) + k);\r\n\r\n        result.r = Math.round(result.r * 255);\r\n        result.g = Math.round(result.g * 255);\r\n        result.b = Math.round(result.b * 255);\r\n\r\n        return result;\r\n    },\r\n\r\n    _RGBtoCMYK: function (RGB: RGB): CMYK {\r\n        const result = new CMYK(0, 0, 0, 0);\r\n\r\n        const r = RGB.r / 255;\r\n        const g = RGB.g / 255;\r\n        const b = RGB.b / 255;\r\n\r\n        result.k = Math.min(1 - r, 1 - g, 1 - b);\r\n        result.c = (1 - r - result.k) / (1 - result.k);\r\n        result.m = (1 - g - result.k) / (1 - result.k);\r\n        result.y = (1 - b - result.k) / (1 - result.k);\r\n\r\n        result.c = Math.round(result.c * 100);\r\n        result.m = Math.round(result.m * 100);\r\n        result.y = Math.round(result.y * 100);\r\n        result.k = Math.round(result.k * 100);\r\n\r\n        return result;\r\n    },\r\n\r\n    toRGB: function (o: RGB | HSV | CMYK): RGB {\r\n        if (o instanceof RGB) {\r\n            return o;\r\n        }\r\n        if (o instanceof HSV) {\r\n            return this._HSVtoRGB(o);\r\n        }\r\n        if (o instanceof CMYK) {\r\n            return this._CMYKtoRGB(o);\r\n        }\r\n    },\r\n\r\n    toHSV: function (o: RGB | HSV | CMYK): HSV {\r\n        if (o instanceof HSV) {\r\n            return o;\r\n        }\r\n        if (o instanceof RGB) {\r\n            return this._RGBtoHSV(o);\r\n        }\r\n        if (o instanceof CMYK) {\r\n            return this._RGBtoHSV(this._CMYKtoRGB(o));\r\n        }\r\n    },\r\n\r\n    toCMYK: function (o: RGB | HSV | CMYK): CMYK {\r\n        if (o instanceof CMYK) {\r\n            return o;\r\n        }\r\n        if (o instanceof RGB) {\r\n            return this._RGBtoCMYK(o);\r\n        }\r\n        if (o instanceof HSV) {\r\n            return this._RGBtoCMYK(this._HSVtoRGB(o));\r\n        }\r\n    },\r\n    toHexString: function (o: RGB): string {\r\n        if (o instanceof RGB) {\r\n            let ha = (parseInt('' + o.r)).toString(16);\r\n            let hb = (parseInt('' + o.g)).toString(16);\r\n            let hc = (parseInt('' + o.b)).toString(16);\r\n            if (ha.length == 1)\r\n                ha = '0' + ha;\r\n            if (hb.length == 1)\r\n                hb = '0' + hb;\r\n            if (hc.length == 1)\r\n                hc = '0' + hc;\r\n            return ha + hb + hc;\r\n        }\r\n    },\r\n    toRgbStr: function(rgbObj: {r: number, g: number, b: number}): string {\r\n        return 'rgb(' + Math.round(rgbObj.r) + ', ' + Math.round(rgbObj.g) + ', ' + Math.round(rgbObj.b) + ')';\r\n    },\r\n    toRgbaStr: function(rgbaObj: {r: number, g: number, b: number, a: number}): string {\r\n        return 'rgba(' + Math.round(rgbaObj.r) + ', ' + Math.round(rgbaObj.g) + ', ' + Math.round(rgbaObj.b) + ', ' + rgbaObj.a + ')';\r\n    },\r\n    hexToRGB: function(hexStr: string): RGB | null {\r\n        hexStr = hexStr.trim();\r\n        // Expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\r\n        const shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\r\n        hexStr = hexStr.replace(shorthandRegex, function(m, r, g, b) {\r\n            return r + r + g + g + b + b;\r\n        });\r\n\r\n        const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hexStr);\r\n        return result ? new RGB(\r\n            parseInt(result[1], 16),\r\n            parseInt(result[2], 16),\r\n            parseInt(result[3], 16)\r\n        ) : null;\r\n    }\r\n\r\n};\r\n\r\nexport function testIsWhiteBestContrast(rgbObj: {r: number, g: number, b: number}): boolean {\r\n    return (rgbObj.r * 0.299 + rgbObj.g * 0.587 + rgbObj.b * 0.114) < 125;\r\n}","import {addEventListener} from '../input/event-listener';\r\nimport {css} from './base';\r\nimport {BB} from '../bb';\r\n\r\n\r\nexport function appendTextDiv(target: HTMLElement, text: string): HTMLDivElement {\r\n    const div = document.createElement('div');\r\n    div.innerHTML = text;\r\n    target.appendChild(div);\r\n    return div;\r\n}\r\n\r\n/**\r\n * Is an input element focused.\r\n * Set attribute \"data-ignore-focus\" to \"true\" if its focus should be ignored.\r\n *\r\n * @param getAll - check all, even those with \"data-ignore-focus\" = \"true\"\r\n */\r\nexport function isInputFocused(getAll: boolean = false): boolean {\r\n    let result = document.activeElement && ['INPUT', 'TEXTAREA'].includes(document.activeElement.tagName);\r\n    if (getAll) {\r\n        return result;\r\n    } else {\r\n        return result && !document.activeElement.getAttribute('data-ignore-focus');\r\n    }\r\n}\r\n\r\n/**\r\n * clears text selection in window\r\n */\r\nexport function clearSelection(): void {\r\n    if (window.getSelection) {\r\n        const sel = window.getSelection();\r\n        if (sel) {\r\n            if (sel.empty) {\r\n                sel.empty();\r\n            } else if (sel.removeAllRanges) {\r\n                sel.removeAllRanges();\r\n            }\r\n        }\r\n    } else if ('selection' in document) {\r\n        (document as any).selection.empty();\r\n    }\r\n}\r\n\r\n/**\r\n * prevents being able to focus element.\r\n * warning: it creates a listener\r\n *\r\n * @param el - dom element\r\n */\r\nexport const makeUnfocusable = (function() {\r\n\r\n    function preventFocus(event: MouseEvent) {\r\n        event.preventDefault();\r\n        let didFocusRelated = false;\r\n        if (event.relatedTarget) {\r\n            try {\r\n                (event.relatedTarget as HTMLElement).focus();\r\n                didFocusRelated = true;\r\n            } catch(e) {\r\n                console.error('failed to focus');\r\n            }\r\n        }\r\n        if (!didFocusRelated) {\r\n            (event.currentTarget as HTMLElement).blur();\r\n        }\r\n    }\r\n\r\n    return function(el) {\r\n        el.setAttribute('tabindex', '-1');\r\n        addEventListener(el, 'focus', preventFocus);\r\n    };\r\n})();\r\n\r\n\r\nconst els: {\r\n    el: HTMLElement;\r\n    listeners: [string, any][];\r\n}[] = [];\r\n// window['els'] = els;\r\n\r\n/**\r\n *\r\n * Create DOM element - div by default\r\n * params = {\r\n * \t    parent: someOtherDiv,\r\n * \t    css: {\r\n * \t\t    width: \"500px\",\r\n * \t\t    backgroundColor: \"#fff\"\r\n * \t    },\r\n * \t    content: \"test\", //or  content: [divA, divB, divC]   or content: someDiv\r\n * \t    className: \"bla\",\r\n *      id: \"bla\"\r\n * }\r\n *\r\n *  If onClick or onChange is used, then BB.destroyEl MUST be called\r\n *  to prevent a memory leak.\r\n *\r\n * @param params\r\n */\r\nexport function el(\r\n    params: {\r\n        parent?: HTMLElement,\r\n        css?: { [key: string]: string },\r\n        custom?: { [key: string]: any },\r\n        content?: string | (HTMLElement | string | null)[] | HTMLElement | SVGElement,\r\n        textContent?: string,\r\n        className?: string,\r\n        title?: string,\r\n        id?: string,\r\n        tagName?: string,\r\n        onClick?: (e: Event) => void,\r\n        onChange?: (e: Event) => void,\r\n    }\r\n): HTMLElement {\r\n    const div = document.createElement(params.tagName ? params.tagName : 'div');\r\n    if (params.css) {\r\n        css(div, params.css);\r\n    }\r\n\r\n    if (params.content) {\r\n        if (typeof params.content === typeof 'aa') {\r\n            div.innerHTML = params.content as string;\r\n\r\n        } else if (Array.isArray(params.content)) {\r\n            BB.append(div, params.content);\r\n\r\n        } else {\r\n            div.appendChild(params.content as HTMLElement);\r\n\r\n        }\r\n    }\r\n    if (params.textContent) {\r\n        div.textContent = params.textContent;\r\n    }\r\n    if (params.className) {\r\n        div.className = params.className;\r\n    }\r\n    if (params.id) {\r\n        div.id = params.id;\r\n    }\r\n    if (params.parent) {\r\n        params.parent.appendChild(div);\r\n    }\r\n    if ('title' in params && params.title !== undefined) {\r\n        div.title = params.title;\r\n    }\r\n    const listeners = [];\r\n    if ('onClick' in params) {\r\n        addEventListener(div, 'click', params.onClick);\r\n        listeners.push(['click', params.onClick]);\r\n    }\r\n    if ('onChange' in params) {\r\n        addEventListener(div, 'change', params.onChange);\r\n        listeners.push(['change', params.onChange]);\r\n    }\r\n    if (listeners.length > 0) {\r\n        els.push({\r\n            el: div,\r\n            listeners: listeners,\r\n        })\r\n        /*div.style.backgroundColor = '#ff0';\r\n        div.style.border = '1px solid #ff0';*/\r\n    }\r\n    if ('custom' in params) {\r\n        const customKeyArr = Object.keys(params.custom);\r\n        for (let i = 0; i < customKeyArr.length; i++) {\r\n            div.setAttribute(customKeyArr[i], params.custom[customKeyArr[i]]);\r\n        }\r\n    }\r\n    return div;\r\n}\r\n\r\n/**\r\n * removes event listeners for Elements created via el()\r\n * @param el\r\n */\r\nexport function destroyEl(el: HTMLElement) {\r\n    for (let i = 0; i < els.length; i++) {\r\n        const item = els[i];\r\n        if (item.el === el) {\r\n            item.listeners.forEach(item => {\r\n                el.removeEventListener(item[0], item[1]);\r\n            });\r\n            els.splice(i, 1);\r\n            return;\r\n        }\r\n    }\r\n    // not found\r\n    return;\r\n}\r\n","\r\nexport class BbLog {\r\n\r\n    private static listeners: any[] = [];\r\n\r\n    constructor() {\r\n    }\r\n\r\n    static subscribe(listener) {\r\n        if (BbLog.listeners.includes(listener)) {\r\n            return;\r\n        }\r\n        BbLog.listeners.push(listener);\r\n    }\r\n\r\n    static unsubscribe(listener) {\r\n        for (let i = 0; i < BbLog.listeners.length; i++) {\r\n            if (listener === BbLog.listeners[i]) {\r\n                BbLog.listeners.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    static emit (msg) {\r\n        BbLog.listeners.forEach(item => {\r\n            item(msg);\r\n        });\r\n    }\r\n}","/**\r\n * LocalStorage wrapper that does not throw exceptions.\r\n * If cookies disabled in Safari localStorage interactions throw exception \"insecure operation\"\r\n */\r\nexport class LocalStorage {\r\n\r\n    private static error;\r\n\r\n    static getItem (key: string): string {\r\n        let result = null;\r\n        try {\r\n            result = localStorage.getItem(key);\r\n        } catch (e) {\r\n            this.error = e;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    static setItem (key: string, value: string): void {\r\n        try {\r\n            localStorage.setItem(key, value);\r\n        } catch (e) {\r\n            this.error = e;\r\n        }\r\n    }\r\n\r\n    static removeItem (key: string): void {\r\n        try {\r\n            localStorage.removeItem(key);\r\n        } catch (e) {\r\n            this.error = e;\r\n        }\r\n    }\r\n\r\n    static getError (): any {\r\n        return this.error;\r\n    }\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"l7FYj\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"kbyFQ\");","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * Checkbox - with label\r\n */\r\nexport class Checkbox {\r\n\r\n    private element: HTMLElement;\r\n    private check: HTMLInputElement;\r\n\r\n    // --- public ---\r\n\r\n    constructor (params: {\r\n        init?: boolean; // default false\r\n        label: string;\r\n        callback: (boolean) => void;\r\n        allowTab?: boolean; // default false\r\n        title?: string;\r\n        doHighlight?: boolean; // default false\r\n        css?: any;\r\n    }) {\r\n        this.element = BB.el({\r\n            className: 'kl-checkbox'\r\n        });\r\n\r\n        const innerEl = BB.el({\r\n            parent: this.element,\r\n            tagName: 'label',\r\n            className: 'kl-checkbox__inner'\r\n        });\r\n\r\n        this.check = BB.el({\r\n            parent: innerEl,\r\n            tagName: 'input',\r\n            css: {\r\n                marginLeft: '0',\r\n                display: 'inline-block'\r\n            },\r\n            custom: {\r\n                type: 'checkbox'\r\n            }\r\n        }) as HTMLInputElement;\r\n        this.check.checked = params.init;\r\n        if (params.doHighlight && this.check.checked) {\r\n            BB.addClassName(this.element, 'kl-checkbox--highlight');\r\n        }\r\n        if (!params.allowTab) {\r\n            this.check.tabIndex = -1;\r\n        }\r\n\r\n        if (params.title) {\r\n            innerEl.title = params.title;\r\n        }\r\n\r\n        const label = document.createElement('div');\r\n        label.style.display = 'inline-block';\r\n        label.innerHTML = params.label;\r\n        (label as any).allowClick = true;\r\n        innerEl.appendChild(label);\r\n\r\n        this.check.onchange = () => {\r\n            if (params.doHighlight) {\r\n                if (this.check.checked) {\r\n                    BB.addClassName(this.element, 'kl-checkbox--highlight');\r\n                } else {\r\n                    BB.removeClassName(this.element, 'kl-checkbox--highlight');\r\n                }\r\n            }\r\n            params.callback(this.check.checked);\r\n            setTimeout(() => {\r\n                this.check.blur();\r\n            }, 0);\r\n        };\r\n        if (params.css) {\r\n            BB.css(this.element, params.css);\r\n        }\r\n    }\r\n\r\n    getValue(): boolean {\r\n        return this.check.checked;\r\n    }\r\n\r\n    getElement(): HTMLElement {\r\n        return this.element;\r\n    }\r\n\r\n    destroy() {\r\n        this.check.onchange = null;\r\n    }\r\n\r\n}\r\n","import {BB} from '../../../bb/bb';\r\nimport {IKeyString} from '../../../bb/bb.types';\r\n\r\nexport const input = function (params: {\r\n    type?: 'button' | 'checkbox' | 'number' | 'text'; // default text\r\n    min?: number;\r\n    max?: number;\r\n    callback: (val: string) => void;\r\n    init: string | number;\r\n    css?: IKeyString;\r\n}) {\r\n    const result = document.createElement('input');\r\n    if (params.type) {\r\n        try {\r\n            result.type = params.type;\r\n        } catch(e) {} // ie can't deal with number\r\n    } else {\r\n        result.type = 'text';\r\n    }\r\n    if (params.min !== undefined) {\r\n        result.min = '' + params.min;\r\n    }\r\n    if (params.max !== undefined) {\r\n        result.max = '' + params.max;\r\n    }\r\n    result.value = '' + params.init;\r\n    if (params.callback) {\r\n        result.onchange = function() {\r\n            params.callback(result.value);\r\n        };\r\n    }\r\n    if (params.css) {\r\n        BB.css(result, params.css);\r\n    }\r\n\r\n    return result;\r\n};","import {BB} from '../../../bb/bb';\r\nimport {IKeyString} from '../../../bb/bb.types';\r\n\r\n/**\r\n * A select dropdown\r\n */\r\nexport class Select {\r\n\r\n    private selectEl: HTMLSelectElement;\r\n    private optionArr: ([string, string] | null)[]; // [value, label]\r\n    private changeListener: (event) => void;\r\n    private onChange: (val: string) => void;\r\n\r\n    \r\n    // --- public ---\r\n    constructor (p: {\r\n        isFocusable?: boolean; // default false\r\n        optionArr: ([string, string] | null)[], // [value, label]\r\n        initValue?: string; // default null\r\n        onChange: (val: string) => void;\r\n        css?: IKeyString;\r\n        title?: string;\r\n    }) {\r\n        this.selectEl = BB.el({\r\n            tagName: 'select',\r\n            title: p.title,\r\n            css: {\r\n                cursor: 'pointer',\r\n                fontSize: '15px',\r\n                padding: '3px',\r\n                background: '#fff', // makes safari pay attention to font-size\r\n                //webkitAppearance: 'none'\r\n                colorScheme: 'only light', // chrome doesn't properly invert the text color\r\n            }\r\n        }) as HTMLSelectElement;\r\n        if (p.css) {\r\n            BB.css(this.selectEl, p.css);\r\n        }\r\n\r\n        const isFocusable = p.isFocusable;\r\n        if (!isFocusable) {\r\n            this.selectEl.tabIndex = -1;\r\n        }\r\n        this.optionArr = p.optionArr;\r\n        for (let i = 0; i < this.optionArr.length; i++) {\r\n            if (this.optionArr[i] === null) {\r\n                continue;\r\n            }\r\n            const option = document.createElement('option');\r\n            option.value = this.optionArr[i][0];\r\n            option.textContent = this.optionArr[i][1];\r\n            this.selectEl.append(option);\r\n        }\r\n        this.onChange = p.onChange;\r\n        this.changeListener = (e) => {\r\n            if (!isFocusable) {\r\n                this.selectEl.blur();\r\n            }\r\n            this.onChange(this.selectEl.value);\r\n        };\r\n        this.selectEl.addEventListener('change', this.changeListener);\r\n        this.selectEl.value = 'initValue' in p ? p.initValue : null;\r\n    }\r\n\r\n    setValue (val) {\r\n        this.selectEl.value = val;\r\n    }\r\n\r\n    getValue () {\r\n        return this.selectEl.value;\r\n    }\r\n\r\n    setDeltaValue (delta) {\r\n        let index = 0;\r\n        for (let i = 0; i < this.optionArr.length; i++) {\r\n            if ('' + this.optionArr[i][0] === this.selectEl.value) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n        index = Math.max(0, Math.min(this.optionArr.length -1, index + delta));\r\n        this.selectEl.value = this.optionArr[index][0];\r\n        this.onChange(this.selectEl.value);\r\n    }\r\n\r\n    getElement () {\r\n        return this.selectEl;\r\n    }\r\n\r\n    destroy = () => {\r\n        this.selectEl.removeEventListener('change', this.changeListener);\r\n    }\r\n    \r\n}\r\n","import {BB} from '../../../bb/bb';\r\n\r\n\r\n/**\r\n * Toggle button with an image\r\n *\r\n * p = {\r\n *     initValue: boolean,\r\n *     title: string,\r\n *     isRadio: boolean, // if true, can't click when active\r\n *     onChange: function(boolean)\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const ImageToggle = function(p) {\r\n    let isActive = !!p.initValue;\r\n    const div = BB.el({\r\n        className: 'image-toggle',\r\n        title: p.title,\r\n        css: {\r\n            backgroundImage: \"url('\" + p.image + \"')\"\r\n        },\r\n        onClick: function(e) {\r\n            e.preventDefault();\r\n            if (p.isRadio && isActive) {\r\n                return;\r\n            }\r\n            isActive = !isActive;\r\n            update();\r\n            p.onChange(isActive);\r\n        },\r\n    });\r\n\r\n    function update() {\r\n        if (isActive) {\r\n            BB.addClassName(div, 'image-toggle-active');\r\n        } else {\r\n            BB.removeClassName(div, 'image-toggle-active');\r\n        }\r\n    }\r\n\r\n    update();\r\n\r\n    // --- interface ---\r\n    this.setValue = function(b) {\r\n        isActive = !!b;\r\n        update();\r\n    };\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n    this.getValue = function() {\r\n        return isActive;\r\n    };\r\n    this.destroy = () => {\r\n        BB.destroyEl(div);\r\n    };\r\n\r\n};","import {BB} from '../../../bb/bb';\r\nimport {ImageToggle} from './image-toggle';\r\n\r\n/**\r\n * Radio input group. each one has an image\r\n *\r\n * p = {\r\n *     optionArr: {\r\n *         id: string,\r\n *         title: string,\r\n *         image: string,\r\n *     }[],\r\n *     initId: string,\r\n *     sizePx: number,\r\n *     onChange: function(id: string): void\r\n * }\r\n *\r\n * @param p\r\n */\r\nexport const ImageRadioList = function(p) {\r\n\r\n    const div = BB.el({\r\n        className: 'image-radio-wrapper',\r\n        css: {\r\n            display: 'flex'\r\n        }\r\n    });\r\n\r\n    let activeIndex;\r\n    const optionArr = [];\r\n\r\n    function select(index, id) {\r\n        activeIndex = index;\r\n        for (let i = 0; i < optionArr.length; i++) {\r\n            optionArr[i].setValue(i === activeIndex);\r\n        }\r\n        p.onChange(id);\r\n    }\r\n\r\n    function createOption(index, o) {\r\n        if (o.id === p.initId) {\r\n            activeIndex = index;\r\n        }\r\n        const radioEl = new ImageToggle({\r\n            image: o.image,\r\n            title: o.title,\r\n            initValue: o.id === p.initId,\r\n            isRadio: true,\r\n            onChange: function() {\r\n                select(index, o.id);\r\n            }\r\n        });\r\n        div.appendChild(radioEl.getElement());\r\n\r\n        return radioEl;\r\n\r\n    }\r\n\r\n    for (let i = 0; i < p.optionArr.length; i++) {\r\n        optionArr.push(createOption(i, p.optionArr[i]));\r\n    }\r\n\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n    this.getValue = function() {\r\n        return p.optionArr[activeIndex].id;\r\n    };\r\n    this.destroy = () => {\r\n        optionArr.forEach(item => {\r\n            item.destroy();\r\n        })\r\n    };\r\n};","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport iconImg from 'url:~/src/app/img/ui/brush-pressure.svg';\r\nimport {LANG} from '../../../language/language';\r\n\r\n\r\n/**\r\n * small toggle button with a pen icon - representing toggling pressure sensitivity\r\n * @param isChecked - boolean - initial value\r\n * @param changeCallback - function(isChecked boolean) - called on change\r\n * @returns {HTMLElement} - the toggle button\r\n */\r\nexport const penPressureToggle = function(isChecked, changeCallback) {\r\n\r\n    const toggleDiv = BB.el({\r\n        css: {\r\n            cssFloat: 'right',\r\n            borderRadius: '3px',\r\n            width: '18px',\r\n            height: '18px',\r\n            backgroundImage: 'url(\"' + iconImg + '\")',\r\n            backgroundSize: 'contain',\r\n            backgroundRepeat: 'no-repeat',\r\n            cursor: 'pointer',\r\n            boxSizing: 'border-box',\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n\r\n    if (!BB.hasPointerEvents) {\r\n        toggleDiv.style.display = 'none';\r\n    }\r\n\r\n    function redraw() {\r\n        if (isChecked) {\r\n            BB.css(toggleDiv, {\r\n                backgroundColor: '#fff',\r\n                opacity: '0.9',\r\n                border: '1px solid var(--active-highlight-color)'\r\n            });\r\n        } else {\r\n            BB.css(toggleDiv, {\r\n                backgroundColor: 'transparent',\r\n                opacity: '0.5',\r\n                border: '1px solid #666'\r\n            });\r\n        }\r\n    }\r\n\r\n    toggleDiv.title = LANG('brush-toggle-pressure');\r\n    toggleDiv.onclick = function() {\r\n        isChecked = !isChecked;\r\n        redraw();\r\n        changeCallback(isChecked);\r\n    };\r\n\r\n    redraw();\r\n    changeCallback(isChecked);\r\n\r\n    return toggleDiv;\r\n};","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"5H9IS\");","import {BB} from '../../../bb/bb';\r\nimport {calcSliderFalloffFactor} from './slider-falloff';\r\nimport {IKlSliderConfig} from '../../kl.types';\r\nimport {languageStrings} from '../../../language/language';\r\n\r\n\r\n\r\n/**\r\n * big slider, e.g. used for brush size\r\n *\r\n * p = {\r\n *      label: 'Size',\r\n *      width: 500,\r\n *      height: 20,\r\n *      theme: 'compact-light',\r\n *      min: 0,\r\n *      max: 100,\r\n *      initValue: 10,\r\n *      resolution: 600, // if you want spline.find to use a different resolution\r\n *      curve: 'quadratic' | [...], // optional. array is BB.SplineInterpolator points. 0-1\r\n *      formatFunc: function(value) { // optional\r\n *          return Math.round(value);\r\n *      },\r\n *      onChange: function(value) {},\r\n *      isChangeOnFinal: true,\r\n *      eventResMs: 123,\r\n *      isEnabled?: boolean, // default = true\r\n * }\r\n *\r\n * Values can be spline interpolated\r\n * On change callback can be debounced\r\n *\r\n * @param p - obj\r\n * @constructor\r\n */\r\nexport const KlSlider = function (p) {\r\n    const _this = this;\r\n    let isEnabled = p.isEnabled !== false;\r\n    let useSpline = !!p.curve;\r\n    let splineInterpolator;\r\n\r\n    if (!p.label || !p.onChange) {\r\n        throw 'PcSlider missing params';\r\n    }\r\n    if (p.min != 0 && p.max != 0 && p.initValue != 0) {\r\n        if (!p.min || !p.max || !p.initValue) {\r\n            throw 'PcSlider broken params';\r\n        }\r\n    }\r\n    if (p.min >= p.max) {\r\n        throw 'PcSlider broken params';\r\n    }\r\n\r\n    const elementWidth = p.width;\r\n    const elementHeight = p.height;\r\n    const resolution = p.resolution ? p.resolution : elementWidth;\r\n    let min = p.min;\r\n    let max = p.max;\r\n    const onChange = p.onChange;\r\n    const isChangeOnFinal = !!p.isChangeOnFinal;\r\n    const formatFunc = p.formatFunc;\r\n    const eventResMs = p.eventResMs;\r\n\r\n    if (useSpline) {\r\n        const curveArr = p.curve === 'quadratic' ? BB.quadraticSplineInput(min, max, 0.1) : p.curve;\r\n        splineInterpolator = new BB.SplineInterpolator(curveArr);\r\n    }\r\n\r\n    function toLinearValue(value) {\r\n        if (useSpline) {\r\n            return splineInterpolator.findX(value, Math.floor(resolution * 1.5));\r\n        }\r\n        return (value - min) / (max - min);\r\n    }\r\n\r\n    function toValue(pLinearValue) {\r\n        let result = min + pLinearValue * (max - min);\r\n        if (useSpline) {\r\n            result = splineInterpolator.interpolate(pLinearValue);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    const div = BB.el({\r\n        className: 'sliderWrapper',\r\n        css: {\r\n            overflow: 'hidden',\r\n            position: 'relative',\r\n            width: elementWidth + 'px',\r\n            height: elementHeight + 'px',\r\n            userSelect: 'none'\r\n        }\r\n    });\r\n    const labelCaption = p.label;\r\n    const label = document.createElement('div');\r\n    const control = document.createElement('div');\r\n    const controlInner = document.createElement('div');\r\n    let linearValue = toLinearValue(p.initValue); //0 - 1\r\n\r\n    div.appendChild(control);\r\n    div.appendChild(label);\r\n    control.appendChild(controlInner);\r\n    control.className = 'sliderInner';\r\n\r\n\r\n    div.oncontextmenu = function () {\r\n        return false;\r\n    };\r\n    //control.style.backgroundColor = \"#aaa\";\r\n    label.innerHTML = labelCaption;\r\n\r\n    control.style.position = 'absolute';\r\n    control.style.left = '0';\r\n    control.style.top = '0';\r\n    control.style.width = (linearValue * elementWidth) + 'px';\r\n    control.style.height = elementHeight + 'px';\r\n\r\n    const labelFontSize = elementHeight - 14;\r\n    BB.css(label, {\r\n        position: 'absolute',\r\n        left: '7px',\r\n        top: (elementHeight / 2 - labelFontSize / 2 + 1) + 'px',\r\n        lineHeight: labelFontSize + 'px',\r\n        fontSize: labelFontSize + 'px',\r\n        pointerEvents: 'none'\r\n    });\r\n\r\n    function updateEnable (): void {\r\n        if (isEnabled) {\r\n            BB.css(div, {\r\n                opacity: null,\r\n                pointerEvents: null,\r\n            });\r\n        } else {\r\n            BB.css(div, {\r\n                opacity: '0.5',\r\n                pointerEvents: 'none',\r\n            });\r\n        }\r\n    }\r\n    updateEnable();\r\n\r\n    function getOutsideVal() {\r\n        let result = min + linearValue * (max - min);\r\n        if (useSpline) {\r\n            result = splineInterpolator.interpolate(linearValue);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function updateLabel() {\r\n        let outVal = toValue(linearValue);\r\n        outVal = formatFunc ? formatFunc(outVal) : parseInt(outVal);\r\n        outVal = outVal.toLocaleString(languageStrings.getCode());\r\n        label.innerHTML = labelCaption + '&nbsp;&nbsp;<span style=\"font-weight:bold\">' + outVal + '</span>';\r\n        control.style.width = (linearValue * elementWidth) + 'px';\r\n    }\r\n\r\n    let lastCallbackTime = 0;\r\n    function emit(isFinal) {\r\n        if (!isFinal && isChangeOnFinal) {\r\n            return;\r\n        }\r\n        if (eventResMs && !isFinal) {\r\n            const now = performance.now();\r\n            if (now - lastCallbackTime >= eventResMs) {\r\n                lastCallbackTime = now;\r\n                onChange(getOutsideVal());\r\n            }\r\n        } else {\r\n            onChange(getOutsideVal());\r\n        }\r\n    }\r\n\r\n    let virtualVal;\r\n    function onPointer(event) {\r\n        event.eventPreventDefault();\r\n\r\n        if (!isEnabled) {\r\n            return;\r\n        }\r\n\r\n        if (event.type === 'pointerdown') {\r\n            div.className = 'sliderWrapper sliderWrapperActive';\r\n\r\n            if (event.button === 'left') {\r\n                linearValue = event.relX / elementWidth;\r\n                linearValue = Math.max(0, Math.min(1, linearValue));\r\n                updateLabel();\r\n                emit(false);\r\n            }\r\n            virtualVal = linearValue;\r\n        }\r\n\r\n        if (event.type === 'pointermove' && ['left', 'right'].includes(event.button)) {\r\n\r\n            let deltaX = event.dX;\r\n            const deltaY = Math.abs(event.pageY - event.downPageY);\r\n            const factor = calcSliderFalloffFactor(deltaY, event.button === 'right');\r\n            deltaX *= factor;\r\n            deltaX /= elementWidth;\r\n\r\n            virtualVal += deltaX;\r\n            linearValue = Math.max(0, Math.min(1, virtualVal));\r\n\r\n            updateLabel();\r\n            emit(false);\r\n        }\r\n\r\n        if (event.type === 'pointerup') {\r\n            div.className = 'sliderWrapper';\r\n            emit(true);\r\n        }\r\n\r\n    }\r\n\r\n    let pointerListener;\r\n    const pointerListenerTimeout = setTimeout(() => {\r\n        pointerListener = new BB.PointerListener({\r\n            target: div,\r\n            maxPointers: 1,\r\n            fixScribble: true,\r\n            onPointer: onPointer,\r\n            onWheel: function(event) {\r\n                if (useSpline) {\r\n                    linearValue += -event.deltaY * (splineInterpolator.getLastX() - splineInterpolator.getFirstX()) / 40;\r\n                    linearValue = Math.max(splineInterpolator.getFirstX(), Math.min(splineInterpolator.getLastX(), linearValue));\r\n                } else {\r\n                    linearValue += -event.deltaY / 40;\r\n                    linearValue = Math.max(0, Math.min(1, linearValue));\r\n                }\r\n                updateLabel();\r\n                onChange(getOutsideVal());\r\n            }\r\n        });\r\n        updateLabel();\r\n    }, 1);\r\n\r\n\r\n    // --- interface ---\r\n    this.increaseValue = function (f) {\r\n        linearValue = Math.min(1, linearValue + Math.abs(f));\r\n        updateLabel();\r\n        onChange(getOutsideVal());\r\n    };\r\n    this.decreaseValue = function (f) {\r\n        linearValue = Math.max(0, linearValue - Math.abs(f));\r\n        updateLabel();\r\n        onChange(getOutsideVal());\r\n    };\r\n    this.setValue = function(v) {\r\n        linearValue = toLinearValue(v);\r\n        updateLabel();\r\n    };\r\n    this.getValue = function () {\r\n        return getOutsideVal();\r\n    };\r\n    this.update = function(config: IKlSliderConfig): void {\r\n        min = config.min;\r\n        max = config.max;\r\n        useSpline = !!config.curve;\r\n        if (useSpline) {\r\n            const curveArr = config.curve === 'quadratic' ? BB.quadraticSplineInput(min, max, 0.1) : config.curve;\r\n            splineInterpolator = new BB.SplineInterpolator(curveArr);\r\n        } else {\r\n            splineInterpolator = null;\r\n        }\r\n        _this.setIsEnabled(!config.isDisabled);\r\n    };\r\n    this.setIsEnabled = function (e: boolean): void {\r\n        isEnabled = !!e;\r\n        updateEnable();\r\n    };\r\n\r\n    this.destroy = function() {\r\n        clearTimeout(pointerListenerTimeout);\r\n        if (pointerListener) {\r\n            pointerListener.destroy();\r\n        }\r\n    };\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    }\r\n\r\n};","\r\n\r\n/**\r\n * to make sliders more finegrained.\r\n * @param deltaY number - how far pointer moved away vertically since down\r\n * @returns {number} the factor 0-1. 0 -> infinite movement for change of 1. 1 -> 1px for change of 1\r\n */\r\nexport const calcSliderFalloffFactor = function(deltaY, isRightButton) {\r\n    let result = Math.min(10, 1 + Math.pow(Math.floor(deltaY / 50), 2));\r\n    if (isRightButton) {\r\n        result *= 2;\r\n    }\r\n    return 1 / result;\r\n};\r\n","import {BB} from '../../../bb/bb';\r\nimport {input} from '../base-components/input';\r\nimport {popup} from './popup';\r\nimport {LANG} from '../../../language/language';\r\n// @ts-ignore\r\nimport copyImg from 'url:~/src/app/img/ui/copy.svg';\r\n\r\n/**\r\n * dialog for manually inputting the color\r\n * @param p {color: rgbObj, onClose: function(rgbObj | null)}\r\n * @constructor\r\n */\r\nexport const HexColorDialog = function (p) {\r\n\r\n    let lastValidRgb = new BB.RGB(p.color.r, p.color.g, p.color.b);\r\n\r\n    const div = BB.el({});\r\n\r\n    const previewEl = BB.el({\r\n        css: {\r\n            width: '20px',\r\n            height: '20px',\r\n            marginBottom: '10px',\r\n            boxShadow: 'inset 0 0 0 1px #fff, 0 0 0 1px #000',\r\n            background: '#' + BB.ColorConverter.toHexString(lastValidRgb),\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n    div.appendChild(previewEl);\r\n\r\n\r\n    // --- Hex ---\r\n    const hexRowEl = BB.el({\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            marginBottom: '15px'\r\n        }\r\n    });\r\n    const hexLabel = BB.el({\r\n        content: LANG('mci-hex'),\r\n        css: {\r\n            width: '60px'\r\n        }\r\n    });\r\n    const hexInput = input({\r\n        init: '#' + BB.ColorConverter.toHexString(lastValidRgb),\r\n        css: {\r\n            width: '80px'\r\n        },\r\n        callback: function() {\r\n            let rgbObj = BB.ColorConverter.hexToRGB(hexInput.value);\r\n            if (rgbObj === null) {\r\n                rgbObj = lastValidRgb;\r\n                hexInput.value = '#' + BB.ColorConverter.toHexString(lastValidRgb);\r\n            } else {\r\n                lastValidRgb = rgbObj;\r\n            }\r\n            previewEl.style.background = '#' + BB.ColorConverter.toHexString(rgbObj);\r\n\r\n            for (let i = 0; i < rgbArr.length; i++) {\r\n                rgbArr[i].update();\r\n            }\r\n        }\r\n    });\r\n    const copyButton = BB.el({\r\n        tagName: 'button',\r\n        content: '<img src=\"' + copyImg + '\" height=\"20\"/>',\r\n        title: LANG('mci-copy'),\r\n        css: {\r\n            marginLeft: '10px'\r\n        },\r\n        onClick: function() {\r\n            hexInput.select();\r\n            document.execCommand('copy');\r\n        }\r\n    });\r\n    hexRowEl.appendChild(hexLabel);\r\n    hexRowEl.appendChild(hexInput);\r\n    hexRowEl.appendChild(copyButton);\r\n    div.appendChild(hexRowEl);\r\n    setTimeout(function () {\r\n        hexInput.focus();\r\n        hexInput.select();\r\n    }, 0);\r\n\r\n\r\n    // --- R G B ---\r\n    function createRgbInputRow(labelStr, attributeStr) {\r\n        const result: any = {};\r\n\r\n        const rowEl = BB.el({\r\n            css: {\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                marginTop: '5px',\r\n            }\r\n        });\r\n        const labelEl = BB.el({\r\n            content: labelStr,\r\n            css: {\r\n                width: '60px'\r\n            }\r\n        });\r\n\r\n        const inputEl = input({\r\n            init: lastValidRgb[attributeStr],\r\n            min: 0,\r\n            max: 255,\r\n            type: 'number',\r\n            css: {\r\n                width: '80px'\r\n            },\r\n            callback: function() {\r\n                if (inputEl.value === '' || parseFloat(inputEl.value) < 0 || parseFloat(inputEl.value) > 255) {\r\n                    result.update();\r\n                    return;\r\n                }\r\n                inputEl.value = '' + Math.round(parseFloat(inputEl.value));\r\n                lastValidRgb[attributeStr] = inputEl.value;\r\n                previewEl.style.background = '#' + BB.ColorConverter.toHexString(lastValidRgb);\r\n                hexInput.value = '#' + BB.ColorConverter.toHexString(lastValidRgb);\r\n            }\r\n        });\r\n\r\n        rowEl.appendChild(labelEl);\r\n        rowEl.appendChild(inputEl);\r\n        div.appendChild(rowEl);\r\n\r\n\r\n        result.update = function() {\r\n            inputEl.value = lastValidRgb[attributeStr];\r\n        };\r\n        result.destroy = () => {\r\n            inputEl.onchange = null;\r\n        };\r\n        return result;\r\n    }\r\n    const rgbArr = [];\r\n    rgbArr.push(createRgbInputRow(LANG('red'), 'r'));\r\n    rgbArr.push(createRgbInputRow(LANG('green'), 'g'));\r\n    rgbArr.push(createRgbInputRow(LANG('blue'), 'b'));\r\n\r\n\r\n    popup({\r\n        target: document.body,\r\n        message: `<b>${LANG('manual-color-input')}</b>`,\r\n        div: div,\r\n        autoFocus: false,\r\n        clickOnEnter: 'Ok',\r\n        buttons: ['Ok', 'Cancel'],\r\n        callback: function (resultStr) {\r\n            BB.destroyEl(copyButton);\r\n            rgbArr.forEach(item => item.destroy());\r\n            rgbArr.splice(0, rgbArr.length);\r\n\r\n            p.onClose(resultStr === 'Ok' ? BB.ColorConverter.hexToRGB(hexInput.value) : null);\r\n        }\r\n    });\r\n\r\n};","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"la7yv\");","import {BB} from '../../../bb/bb';\r\nimport {HexColorDialog} from '../modals/color-slider-hex-dialog';\r\nimport {calcSliderFalloffFactor} from './slider-falloff';\r\n// @ts-ignore\r\nimport eyedropperImg from 'url:~/src/app/img/ui/tool-picker.svg';\r\nimport {LANG} from '../../../language/language';\r\n\r\n/**\r\n * big main HS+V color slider\r\n * 2 elements: slider, and colorpreview(output) + eyedropper\r\n *\r\n * p = {\r\n *     width: number,\r\n *     height: number, // hue slider and output height\r\n *     svHeight: number,\r\n *     startValue: rgb, // 0-255\r\n *     onPick: function(rgb)\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const KlColorSlider = function (p) {\r\n\r\n    const _this = this;\r\n    let pickCallback = function(result?) {};\r\n    const div = document.createElement('div');\r\n    div.style.position = 'relative';\r\n    div.className = 'colorSlider';\r\n    const outputDiv = BB.el({\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center'\r\n        }\r\n    });\r\n    const width = p.width;\r\n    let svHeight = p.svHeight;\r\n    const height = p.height;\r\n    const emitColor = p.onPick;\r\n\r\n    let primaryColorRGB = {\r\n        r: parseInt(p.startValue.r, 10),\r\n        g: parseInt(p.startValue.g, 10),\r\n        b: parseInt(p.startValue.b, 10)\r\n    };\r\n    let primaryColorHSV = BB.ColorConverter.toHSV(p.startValue); // BB.HSV\r\n    let secondaryColorRGB = {r: 255, g: 255, b: 255};\r\n    let secondaryColorHSV = BB.ColorConverter._RGBtoHSV(secondaryColorRGB); // BB.HSV\r\n\r\n    const svWrapper = BB.el({});\r\n    const svSvg = new DOMParser().parseFromString('<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\" preserveAspectRatio=\"none\"> <defs> <linearGradient id=\"value\" gradientTransform=\"rotate(90)\"> <stop offset=\"0\" stop-color=\"rgba(0,0,0,0)\"/> <stop offset=\"100%\" stop-color=\"rgba(0,0,0,1)\"/> </linearGradient> <linearGradient id=\"hue\" gradientTransform=\"rotate(0)\"> <stop offset=\"0\" stop-color=\"#fff\"/> <stop id=\"hue-stop\" offset=\"100%\" stop-color=\"#f00\"/> </linearGradient> </defs> <rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" fill=\"url(\\'#hue\\')\"/> <rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" fill=\"url(\\'#value\\')\"/></svg>', 'image/svg+xml').documentElement;\r\n    const hueStop = (svSvg as any).getElementById('hue-stop');\r\n    BB.setAttributes(hueStop, {\r\n        'stop-color': '#f0f'\r\n    });\r\n    BB.css(svSvg, {\r\n        width: width + 'px',\r\n        height: svHeight + 'px'\r\n    });\r\n    svWrapper.appendChild(svSvg);\r\n\r\n    const divH = document.createElement('div');\r\n    BB.css(divH, {\r\n        position: 'relative',\r\n        height: height + 'px'\r\n    });\r\n    const divPreview = document.createElement('div');\r\n    const controlH = document.createElement('div');\r\n\r\n    const enabled = true;\r\n\r\n    function updatePrimaryHSV(hsv) {\r\n        if (hsv.s === 0) {\r\n            primaryColorHSV = new BB.HSV(primaryColorHSV.h, hsv.s, hsv.v);\r\n        } else {\r\n            primaryColorHSV = new BB.HSV(hsv.h, hsv.s, hsv.v);\r\n        }\r\n    }\r\n\r\n    function createHueBg(targetEl) {\r\n        const im = new Image();\r\n        BB.css(im, {\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0',\r\n            display: 'none',\r\n            pointerEvents: 'none'\r\n        });\r\n        const cv = BB.canvas(width, height);\r\n        const ctx = cv.getContext('2d');\r\n        const gradH = ctx.createLinearGradient(0, 0, width, 0);\r\n        for (let i = 0; i < 1; i += 0.01) {\r\n            const col = BB.ColorConverter.toRGB(new BB.HSV(i * 360, 100, 100));\r\n            let ha = (parseInt('' + col.r)).toString(16);\r\n            let hb = (parseInt('' + col.g)).toString(16);\r\n            let hc = (parseInt('' + col.b)).toString(16);\r\n            if (ha.length === 1)\r\n                ha = '0' + ha;\r\n            if (hb.length === 1)\r\n                hb = '0' + hb;\r\n            if (hc.length === 1)\r\n                hc = '0' + hc;\r\n            gradH.addColorStop(i, '#' + ha + hb + hc);\r\n        }\r\n        ctx.fillStyle = gradH;\r\n        ctx.fillRect(0, 0, width, height);\r\n\r\n        targetEl.appendChild(im);\r\n        im.alt = 'hue';\r\n        im.src = cv.toDataURL('image/png');\r\n        im.style.display = 'block';\r\n    }\r\n\r\n\r\n    function updateSVCanvas() {\r\n        const rgb = BB.ColorConverter.toRGB(new BB.HSV(primaryColorHSV.h, 100, 100));\r\n        BB.setAttributes(hueStop, {\r\n            'stop-color': '#' + BB.ColorConverter.toHexString(rgb)\r\n        });\r\n    }\r\n\r\n    function updateSVPointer() {\r\n\r\n        const left = primaryColorHSV.s / 100 * width - 7;\r\n        const top = (1 - primaryColorHSV.v / 100) * svHeight - 6;\r\n        BB.css(pointerSV, {\r\n            left: left + 'px',\r\n            top: top + 'px'\r\n        });\r\n    }\r\n\r\n    function setColPreview() {\r\n        divPreview.style.backgroundColor = 'rgb(' + primaryColorRGB.r + ',' + primaryColorRGB.g + ',' + primaryColorRGB.b + ')';\r\n\r\n        if (BB.testIsWhiteBestContrast(primaryColorRGB)) {\r\n            BB.css(pickerButton, {\r\n                filter: 'invert(1)'\r\n            });\r\n            BB.css(hexButton, {\r\n                filter: 'invert(1)'\r\n            });\r\n        } else{\r\n            BB.css(pickerButton, {\r\n                filter: ''\r\n            });\r\n            BB.css(hexButton, {\r\n                filter: ''\r\n            });\r\n        }\r\n\r\n    }\r\n\r\n    updateSVCanvas();\r\n    div.style.width = width + 'px';\r\n    div.oncontextmenu = function () {\r\n        return false;\r\n    };\r\n\r\n    const SVContainer = document.createElement('div');\r\n    BB.css(SVContainer, {\r\n        width: width + 'px',\r\n        height: svHeight + 'px',\r\n        overflow: 'hidden',\r\n        display: 'block',\r\n        position: 'relative',\r\n        cursor: 'crosshair',\r\n        boxShadow: 'rgb(188, 188, 188) 0 0 0 1px'\r\n    });\r\n\r\n    const pointerSV = document.createElement('div');\r\n    BB.css(pointerSV, {\r\n        width: '12px',\r\n        height: '12px',\r\n        borderRadius: '6px',\r\n        position: 'absolute',\r\n        pointerEvents: 'none',\r\n        boxShadow: '0px 0px 0 1px #000, inset 0px 0px 0 1px #fff'\r\n    });\r\n\r\n    SVContainer.appendChild(svWrapper);\r\n    SVContainer.appendChild(pointerSV);\r\n    updateSVPointer();\r\n    div.appendChild(SVContainer);\r\n    div.appendChild(divH);\r\n    outputDiv.appendChild(divPreview);\r\n    BB.css(divPreview, {\r\n        display: 'flex',\r\n        justifyContent: 'space-between',\r\n        width: (height * 2.5) + 'px',\r\n        height: height + 'px',\r\n        //position: \"relative\",\r\n        boxShadow: 'rgb(188, 188, 188) 0 0 0 1px',\r\n        colorScheme: 'only light',\r\n    });\r\n\r\n    BB.css(divH, {\r\n        overflow: 'hidden',\r\n        position: 'relative',\r\n        width: width + 'px',\r\n        height: height + 'px',\r\n        cursor: 'ew-resize',\r\n        boxShadow: 'rgb(188, 188, 188) 0 0 0 1px',\r\n        marginTop: '1px',\r\n        marginBottom: '1px'\r\n    });\r\n\r\n    //divH.className = \"svSlider\";\r\n    BB.css(controlH, {\r\n        width: '1px',\r\n        height: height + 'px',\r\n        background: '#000',\r\n        borderLeft: '1px solid #fff',\r\n        position: 'absolute',\r\n        top: '0',\r\n        left: parseInt('' + (primaryColorHSV.h / 360 * width - 1)) + 'px'\r\n    });\r\n\r\n\r\n    const virtualHSV = {\r\n        h: 0,\r\n        s: 0,\r\n        v: 0\r\n    };\r\n    let svPointerListener;\r\n    let hPointerListener;\r\n\r\n\r\n    const pickerButton = BB.el({\r\n        title: LANG('eyedropper') + ' [Alt]',\r\n        className: 'color-picker-preview-button',\r\n        css: {\r\n            width: '30px',\r\n            height: '30px',\r\n            backgroundImage: 'url(' + eyedropperImg + ')',\r\n            backgroundRepeat:  'no-repeat',\r\n            backgroundSize: '70%',\r\n            backgroundPosition: 'center'\r\n        }\r\n    });\r\n    let isPicking = false;\r\n\r\n\r\n    pickerButton.onclick = function () {\r\n        if (isPicking === false) {\r\n            BB.removeClassName(pickerButton, 'color-picker-preview-button-hover');\r\n            BB.addClassName(pickerButton, 'color-picker-preview-button-active');\r\n            isPicking = true;\r\n            pickCallback(true);\r\n        } else {\r\n            pickCallback(false);\r\n            _this.pickingDone();\r\n        }\r\n    };\r\n    const pickerButtonPointerListener = new BB.PointerListener({\r\n        target: pickerButton,\r\n        onEnterLeave: function(isOver) {\r\n            if (isPicking) {\r\n                return;\r\n            }\r\n            if (isOver) {\r\n                BB.addClassName(pickerButton, 'color-picker-preview-button-hover');\r\n            } else {\r\n                BB.removeClassName(pickerButton, 'color-picker-preview-button-hover');\r\n            }\r\n        }\r\n    });\r\n    divPreview.appendChild(pickerButton);\r\n\r\n\r\n    const hexButton = BB.el({\r\n        content: '#',\r\n        className: 'color-picker-preview-button',\r\n        title: LANG('manual-color-input'),\r\n        css: {\r\n            height: '100%',\r\n            width: height + 'px',\r\n            lineHeight: height + 'px',\r\n            fontSize: (height * 0.65) + 'px'\r\n        },\r\n        onClick: function() {\r\n            HexColorDialog({\r\n                color: new BB.RGB(primaryColorRGB.r, primaryColorRGB.g, primaryColorRGB.b),\r\n                onClose: function(rgbObj) {\r\n                    if (!rgbObj) {\r\n                        return;\r\n                    }\r\n                    _this.setColor(rgbObj);\r\n                    emitColor(new BB.RGB(primaryColorRGB.r, primaryColorRGB.g, primaryColorRGB.b));\r\n                }\r\n            });\r\n        }\r\n    });\r\n    const hexButtonPointerListener = new BB.PointerListener({\r\n        target: hexButton,\r\n        onEnterLeave: function(isOver) {\r\n            if (isOver) {\r\n                BB.addClassName(hexButton, 'color-picker-preview-button-hover');\r\n            } else {\r\n                BB.removeClassName(hexButton, 'color-picker-preview-button-hover');\r\n            }\r\n        }\r\n    });\r\n    divPreview.appendChild(hexButton);\r\n\r\n    setColPreview();\r\n\r\n\r\n    setTimeout(function() {\r\n        createHueBg(divH);\r\n        divH.appendChild(controlH);\r\n        svPointerListener = new BB.PointerListener({\r\n            target: svWrapper,\r\n            maxPointers: 1,\r\n            fixScribble: true,\r\n            onPointer: function(event) {\r\n                if (event.type === 'pointerdown') {\r\n                    BB.css(SVContainer, {\r\n                        boxShadow: '0px 0px 0px 1px rgb(255,255,255)',\r\n                        zIndex: '1'\r\n                    });\r\n\r\n                    if (event.button === 'left') {\r\n\r\n                        virtualHSV.s = event.relX / width * 100;\r\n                        virtualHSV.v = 100 - event.relY / svHeight * 100;\r\n\r\n                        primaryColorHSV = new BB.HSV(primaryColorHSV.h, virtualHSV.s, virtualHSV.v);\r\n                        primaryColorRGB = BB.ColorConverter.toRGB(primaryColorHSV);\r\n\r\n                        updateSVPointer();\r\n                        setColPreview();\r\n                        emitColor(BB.ColorConverter.toRGB(primaryColorHSV));\r\n                    } else {\r\n                        virtualHSV.s = primaryColorHSV.s;\r\n                        virtualHSV.v = primaryColorHSV.v;\r\n                    }\r\n                }\r\n\r\n                if (event.type === 'pointermove' && ['left', 'right'].includes(event.button)) {\r\n\r\n                    let factor = 1;\r\n                    if (event.button === 'right') {\r\n                        factor = 0.5;\r\n                    }\r\n\r\n                    virtualHSV.s += event.dX / width * 100 * factor;\r\n                    virtualHSV.v -= event.dY / svHeight * 100 * factor;\r\n\r\n                    primaryColorHSV = new BB.HSV(primaryColorHSV.h, virtualHSV.s, virtualHSV.v);\r\n                    primaryColorRGB = BB.ColorConverter.toRGB(primaryColorHSV);\r\n                    updateSVPointer();\r\n                    setColPreview();\r\n                    emitColor(BB.ColorConverter.toRGB(primaryColorHSV));\r\n\r\n                }\r\n\r\n                if (event.type === 'pointerup') {\r\n                    BB.css(SVContainer, {\r\n                        boxShadow: '0 0 0 1px rgb(188, 188, 188)',\r\n                        zIndex: '0'\r\n                    });\r\n                }\r\n\r\n            }\r\n        });\r\n        hPointerListener = new BB.PointerListener({\r\n            target: divH,\r\n            maxPointers: 1,\r\n            fixScribble: true,\r\n            onPointer: function(event) {\r\n\r\n                if (event.type === 'pointerdown') {\r\n                    BB.css(divH, {\r\n                        boxShadow: '0px 0px 0px 1px rgba(255,255,255,1)'\r\n                    });\r\n\r\n                    if (event.button === 'left') {\r\n\r\n                        virtualHSV.h = event.relX / width * 359.99;\r\n\r\n                        primaryColorHSV = new BB.HSV(virtualHSV.h, primaryColorHSV.s, primaryColorHSV.v);\r\n                        primaryColorRGB = BB.ColorConverter.toRGB(primaryColorHSV);\r\n                        controlH.style.left = (Math.round(primaryColorHSV.h / 359.99 * width) - 1) + 'px';\r\n                        updateSVCanvas();\r\n                        setColPreview();\r\n                        emitColor(BB.ColorConverter.toRGB(primaryColorHSV));\r\n                    } else {\r\n                        virtualHSV.h = primaryColorHSV.h;\r\n                    }\r\n                }\r\n\r\n                if (event.type === 'pointermove' && ['left', 'right'].includes(event.button)) {\r\n\r\n                    const deltaY = Math.abs(event.pageY - event.downPageY);\r\n                    const factor = calcSliderFalloffFactor(deltaY, event.button === 'right');\r\n\r\n                    virtualHSV.h += event.dX / width * 359.99 * factor;\r\n\r\n                    if (event.button === 'right') {\r\n                        virtualHSV.h = virtualHSV.h % 359.99;\r\n                        if (virtualHSV.h < 0) {\r\n                            virtualHSV.h += 359.99;\r\n                        }\r\n                    }\r\n                    virtualHSV.h = Math.min(359.99, virtualHSV.h);\r\n                    primaryColorHSV = new BB.HSV(virtualHSV.h, primaryColorHSV.s, primaryColorHSV.v);\r\n                    primaryColorRGB = BB.ColorConverter.toRGB(primaryColorHSV);\r\n                    controlH.style.left = (Math.round(primaryColorHSV.h / 359.99 * width) - 1) + 'px';\r\n                    updateSVCanvas();\r\n                    setColPreview();\r\n                    emitColor(BB.ColorConverter.toRGB(primaryColorHSV));\r\n\r\n                }\r\n\r\n                if (event.type === 'pointerup') {\r\n                    BB.css(divH, {\r\n                        boxShadow: 'rgb(188, 188, 188) 0 0 0 1px'\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    }, 1);\r\n\r\n\r\n    // --- second color ---\r\n\r\n    const secondaryColorBtn = BB.el({\r\n        parent: outputDiv,\r\n        title: LANG('secondary-color') + ' [X]',\r\n        css: {\r\n            cursor: 'pointer',\r\n            marginLeft: '5px',\r\n            width: '22px',\r\n            height: '22px',\r\n            boxShadow: 'rgb(188, 188, 188) 0px 0px 0px 1px',\r\n            colorScheme: 'only light',\r\n        },\r\n        onClick: function(e) {\r\n            e.preventDefault();\r\n            swapColors();\r\n        }\r\n    });\r\n    function updateSecondaryColor() {\r\n        secondaryColorBtn.style.backgroundColor = BB.ColorConverter.toRgbStr(secondaryColorRGB);\r\n    }\r\n    function swapColors() {\r\n        // swap hsv\r\n        let tmp: any = secondaryColorHSV;\r\n        secondaryColorHSV = primaryColorHSV;\r\n        updatePrimaryHSV(tmp);\r\n        // swap rgb\r\n        tmp = secondaryColorRGB;\r\n        secondaryColorRGB = primaryColorRGB;\r\n        primaryColorRGB = tmp;\r\n\r\n        controlH.style.left = parseInt('' + (primaryColorHSV.h / 359 * width - 1)) + 'px';\r\n        updateSVCanvas();\r\n        updateSVPointer();\r\n        setColPreview();\r\n        updateSecondaryColor();\r\n\r\n        emitColor(new BB.RGB(primaryColorRGB.r, primaryColorRGB.g, primaryColorRGB.b));\r\n    }\r\n    updateSecondaryColor();\r\n\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.setColor = function (c) {\r\n        primaryColorRGB = {r: parseInt(c.r, 10), g: parseInt(c.g, 10), b: parseInt(c.b, 10)};\r\n        updatePrimaryHSV(BB.ColorConverter.toHSV(c));\r\n        controlH.style.left = parseInt('' + (primaryColorHSV.h / 359 * width - 1)) + 'px';\r\n        updateSVCanvas();\r\n        updateSVPointer();\r\n        setColPreview();\r\n    };\r\n\r\n    this.getColor = function () {\r\n        return new BB.RGB(primaryColorRGB.r, primaryColorRGB.g, primaryColorRGB.b);\r\n    };\r\n\r\n    this.getSecondaryRGB = function() {\r\n        return new BB.RGB(secondaryColorRGB.r, secondaryColorRGB.g, secondaryColorRGB.b);\r\n    };\r\n\r\n    this.setPickCallback = function (func) {\r\n        pickCallback = func;\r\n    };\r\n\r\n    this.pickingDone = function () {\r\n        if (!isPicking) {\r\n            return;\r\n        }\r\n        isPicking = false;\r\n        BB.removeClassName(pickerButton, 'color-picker-preview-button-active');\r\n    };\r\n\r\n    this.enable = function (e) {\r\n        if (e) {\r\n            div.style.pointerEvents = '';\r\n            div.style.opacity = '1';\r\n            outputDiv.style.pointerEvents = '';\r\n            outputDiv.style.opacity = '1';\r\n        } else {\r\n            div.style.pointerEvents = 'none';\r\n            div.style.opacity = '0.5';\r\n            outputDiv.style.pointerEvents = 'none';\r\n            outputDiv.style.opacity = '0.5';\r\n        }\r\n    };\r\n\r\n    this.setHeight = function (h) {\r\n        h = parseInt('' +(h - height * 2 - 3), 10);\r\n        if (h === svHeight) {\r\n            return;\r\n        }\r\n        svHeight = h;\r\n        BB.css(svSvg, {\r\n            width: width + 'px',\r\n            height: svHeight + 'px'\r\n        });\r\n        SVContainer.style.height = svHeight + 'px';\r\n        updateSVPointer();\r\n    };\r\n\r\n    this.swapColors = function() {\r\n        swapColors();\r\n    };\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.getOutputElement = function() {\r\n        return outputDiv;\r\n    }\r\n\r\n};","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"cTtMO\");","import {BB} from '../../../bb/bb';\r\nimport {calcSliderFalloffFactor} from './slider-falloff';\r\n\r\n\r\n/**\r\n * a small color slider\r\n *\r\n * params {\r\n * \t width: 200,\r\n * \t heightSV: 200,\r\n * \t heightH: 10,\r\n * \t color: {r,g,b}\r\n * \t callback: function(c){}\r\n * }\r\n *\r\n * @param params\r\n * @constructor\r\n */\r\nexport const KlSmallColorSlider = function (params) {\r\n    const div = document.createElement('div');\r\n    div.oncontextmenu = function(e) {\r\n        e.preventDefault();\r\n    };\r\n    let color = BB.ColorConverter.toHSV(new BB.RGB(params.color.r, params.color.g, params.color.b));\r\n    BB.css(div, {\r\n        width: params.width + 'px',\r\n        position: 'relative',\r\n        overflow: 'hidden',\r\n        userSelect: 'none'\r\n    });\r\n\r\n    const canvasSV = BB.canvas(10, 10);\r\n    canvasSV.style.width = params.width + 'px';\r\n    canvasSV.style.height = params.heightSV + 'px';\r\n    canvasSV.style.cursor = 'crosshair';\r\n\r\n    function updateSV() {\r\n        const ctx = canvasSV.getContext('2d');\r\n        for (let i = 0; i < canvasSV.height; i += 1) {\r\n            const gradient1 = ctx.createLinearGradient(0, 0, canvasSV.width, 0);\r\n\r\n            const colleft = BB.ColorConverter.toRGB(new BB.HSV(color.h, 1, 100 - (i / canvasSV.height * 100.0)));\r\n            const colright = BB.ColorConverter.toRGB(new BB.HSV(color.h, 100, 100 - (i / canvasSV.height * 100.0)));\r\n            gradient1.addColorStop(0, '#' + BB.ColorConverter.toHexString(colleft));\r\n            gradient1.addColorStop(1, '#' + BB.ColorConverter.toHexString(colright));\r\n            ctx.fillStyle = '#ff0000'; //needed for chrome...otherwise alpha problem\r\n            ctx.fillStyle = gradient1;\r\n            ctx.fillRect(0, i, canvasSV.width, 1);\r\n        }\r\n    }\r\n\r\n    updateSV();\r\n\r\n    const canvasH = BB.canvas(params.width, params.heightH);\r\n    canvasH.style.cursor = 'ew-resize';\r\n    (function () {\r\n        const ctx = canvasH.getContext('2d');\r\n\r\n        const gradH = ctx.createLinearGradient(0, 0, params.width, 0);\r\n        for (let i = 0; i < 1; i += 0.01) {\r\n            const col = BB.ColorConverter.toRGB(new BB.HSV(i * 360, 100, 100));\r\n            gradH.addColorStop(i, 'rgba(' + parseInt('' + col.r) + ', ' + parseInt('' + col.g) + ', ' + parseInt('' + col.b) + ', 1)');\r\n        }\r\n        ctx.fillStyle = gradH;\r\n        ctx.fillRect(0, 0, params.width, params.heightH);\r\n\r\n    })();\r\n    BB.css(canvasSV, {\r\n        width: params.width + 'px',\r\n        height: params.heightSV + 'px',\r\n        overflow: 'hidden',\r\n        position: 'relative'\r\n    });\r\n    canvasSV.style.cssFloat = 'left';\r\n    canvasH.style.cssFloat = 'left';\r\n\r\n    div.appendChild(canvasSV);\r\n    div.appendChild(canvasH);\r\n\r\n    const pointerSV = document.createElement('div');\r\n    BB.css(pointerSV, {\r\n        width: '8px',\r\n        height: '8px',\r\n        borderRadius: '8px',\r\n        position: 'absolute',\r\n        pointerEvents: 'none',\r\n        boxShadow: '0 0 0 1px #000, inset 0 0 0 1px #fff'\r\n    });\r\n    div.appendChild(pointerSV);\r\n\r\n    const pointerH = document.createElement('div');\r\n    BB.css(pointerH, {\r\n        width: '0',\r\n        height: params.heightH + 'px',\r\n        borderLeft: '1px solid #fff',\r\n        borderRight: '1px solid #000',\r\n        position: 'absolute',\r\n        top: params.heightSV + 'px',\r\n        pointerEvents: 'none'\r\n    });\r\n    div.appendChild(pointerH);\r\n\r\n\r\n    function updateSVPointer() {\r\n        const left = color.s / 100 * params.width - 4;\r\n        const top = (1 - color.v / 100) * params.heightSV - 4;\r\n        BB.css(pointerSV, {\r\n            left: left + 'px',\r\n            top: top + 'px'\r\n        });\r\n        /*if (top < params.heightSV/3) {\r\n        pointerSV.style.border = \"1px solid rgba(0,0,0,1)\";\r\n    } else {\r\n        pointerSV.style.border = \"1px solid rgba(255,255,255,1)\";\r\n    }*/\r\n    }\r\n\r\n    function updateHPointer() {\r\n        pointerH.style.left = (color.h / 359.999 * params.width - 1) + 'px';\r\n    }\r\n\r\n    updateSVPointer();\r\n    updateHPointer();\r\n\r\n    const virtualHSV = {\r\n        h: 0,\r\n        s: 0,\r\n        v: 0\r\n    };\r\n\r\n    let svPointerId = null;\r\n    const svPointerListener = new BB.PointerListener({\r\n        target: canvasSV,\r\n        maxPointers: 1,\r\n        fixScribble: true,\r\n        onPointer: function(event) {\r\n\r\n            if (event.type === 'pointerdown') {\r\n                svPointerId = event.pointerId;\r\n                if (event.button === 'left') {\r\n\r\n                    virtualHSV.s = event.relX / params.width * 100;\r\n                    virtualHSV.v = 100 - event.relY / params.heightSV * 100;\r\n\r\n                    color = new BB.HSV(color.h, virtualHSV.s, virtualHSV.v);\r\n\r\n                    updateSVPointer();\r\n                    params.callback(BB.ColorConverter.toRGB(color));\r\n                } else {\r\n                    virtualHSV.s = color.s;\r\n                    virtualHSV.v = color.v;\r\n                }\r\n            }\r\n\r\n            if (event.type === 'pointermove' && ['left', 'right'].includes(event.button) && svPointerId === event.pointerId) {\r\n\r\n                let factor = 1;\r\n                if (event.button === 'right') {\r\n                    factor = 0.5;\r\n                }\r\n\r\n                virtualHSV.s += event.dX / params.width * 100 * factor;\r\n                virtualHSV.v -= event.dY / params.heightSV * 100 * factor;\r\n\r\n                color = new BB.HSV(color.h, virtualHSV.s, virtualHSV.v);\r\n                updateSVPointer();\r\n                params.callback(BB.ColorConverter.toRGB(color));\r\n\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                svPointerId = null;\r\n            }\r\n\r\n        }\r\n    });\r\n\r\n    let hPointerId = null;\r\n    const hPointerListener = new BB.PointerListener({\r\n        target: canvasH,\r\n        maxPointers: 1,\r\n        fixScribble: true,\r\n        onPointer: function(event) {\r\n\r\n            if (event.type === 'pointerdown') {\r\n                hPointerId = event.pointerId;\r\n                if (event.button === 'left') {\r\n\r\n                    virtualHSV.h = event.relX / params.width * 359.99;\r\n\r\n                    color = new BB.HSV(virtualHSV.h, color.s, color.v);\r\n                    updateSV();\r\n                    updateHPointer();\r\n                    params.callback(BB.ColorConverter.toRGB(color));\r\n                } else {\r\n                    virtualHSV.h = color.h;\r\n                }\r\n            }\r\n\r\n            if (event.type === 'pointermove' && ['left', 'right'].includes(event.button) && hPointerId === event.pointerId) {\r\n\r\n                const deltaY = Math.abs(event.pageY - event.downPageY);\r\n                const factor = calcSliderFalloffFactor(deltaY, event.button === 'right');\r\n\r\n                virtualHSV.h += event.dX / params.width * 359.99 * factor;\r\n\r\n                if (event.button === 'right') {\r\n                    virtualHSV.h = virtualHSV.h % 359.99;\r\n                    if (virtualHSV.h < 0) {\r\n                        virtualHSV.h += 359.99;\r\n                    }\r\n                }\r\n                virtualHSV.h = Math.min(359.99, virtualHSV.h);\r\n                color = new BB.HSV(virtualHSV.h, color.s, color.v);\r\n                updateSV();\r\n                updateHPointer();\r\n                params.callback(BB.ColorConverter.toRGB(color));\r\n\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                hPointerId = null;\r\n            }\r\n        }\r\n    });\r\n\r\n\r\n    const cleardiv = document.createElement('div');\r\n    cleardiv.style.clear = 'both';\r\n    div.appendChild(cleardiv);\r\n\r\n    // --- interface ---\r\n    this.setColor = function (c) {\r\n        color = BB.ColorConverter.toHSV(new BB.RGB(c.r, c.g, c.b));\r\n        updateSV();\r\n        updateSVPointer();\r\n        updateHPointer();\r\n    };\r\n    this.getColor = function () {\r\n        return BB.ColorConverter.toRGB(color);\r\n    };\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n    this.destroy = function() {\r\n        svPointerListener.destroy();\r\n        hPointerListener.destroy();\r\n    };\r\n    this.end = function() {\r\n        svPointerId = null;\r\n        hPointerId = null;\r\n    };\r\n\r\n};","import {BB} from '../../../bb/bb';\r\n\r\n\r\n/**\r\n * a slider that looks like this\r\n * ------O----\r\n *\r\n * param: {init, width, pointSize, callback(value, isFirst, isLast)}\r\n *\r\n * @param param\r\n * @constructor\r\n */\r\nexport const PointSlider = function(param) {\r\n\r\n    const div = document.createElement('div');\r\n    div.style.position = 'relative';\r\n    const sliderLine = BB.el({});\r\n    const sliderPoint = BB.el({\r\n        css: {\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n    div.appendChild(sliderLine);\r\n    div.appendChild(sliderPoint);\r\n    let sliderPos;\r\n    let isDragging = false;\r\n\r\n    //sliderLine\r\n    {\r\n        BB.css(sliderLine, {\r\n            marginTop: parseInt('' + (param.pointSize / 2 - 1)) + 'px',\r\n            height: '2px',\r\n            background: '#aaa',\r\n            width: param.width + 'px'\r\n        });\r\n    }\r\n    //sliderPoint\r\n    const touchAreaEl = BB.el({ // expand clickable area\r\n        parent: sliderPoint,\r\n        css: {\r\n            // background: 'rgba(255,0,0,0.4)',\r\n            margin: '-7px 0 0 -7px',\r\n            width: 'calc(100% + 14px)',\r\n            height: 'calc(100% + 7px)',\r\n        }\r\n    });\r\n\r\n    function redrawPoint() {\r\n        sliderPoint.style.left = sliderPos + 'px';\r\n        if (isDragging) {\r\n            sliderPoint.style.boxShadow = '0 0 6px rgba(0,0,0,1)';\r\n        } else {\r\n            sliderPoint.style.boxShadow = '0 0 3px rgba(0,0,0,0.8)';\r\n        }\r\n    }\r\n    function getValue() {\r\n        return sliderPos /  (param.width - param.pointSize);\r\n    }\r\n\r\n    let pointerListener;\r\n    {\r\n        let isFirst;\r\n        sliderPos = BB.clamp(param.init * (param.width - param.pointSize), 0, param.width - param.pointSize);\r\n        BB.css(sliderPoint, {\r\n            position: 'absolute',\r\n            top: '0px',\r\n            backgroundColor: '#eaeaea',\r\n            boxShadow: '0 0 3px rgba(0,0,0,0.8)',\r\n            width: param.pointSize + 'px',\r\n            height: param.pointSize + 'px',\r\n            borderRadius: param.pointSize + 'px',\r\n            cursor: 'ew-resize',\r\n            transition: 'box-shadow 0.2s ease-in-out'\r\n        });\r\n        redrawPoint();\r\n        let imaginaryPos;\r\n        pointerListener = new BB.PointerListener({\r\n            target: sliderPoint,\r\n            fixScribble: true,\r\n            onPointer: function(event) {\r\n                if (event.type === 'pointerdown' && event.button === 'left') {\r\n                    isFirst = true;\r\n                    isDragging = true;\r\n                    imaginaryPos = sliderPos;\r\n                    redrawPoint();\r\n                    event.eventStopPropagation();\r\n                } else if (event.type === 'pointermove' && event.button === 'left') {\r\n                    event.eventStopPropagation();\r\n                    imaginaryPos = imaginaryPos + event.dX;\r\n                    sliderPos = parseInt('' + BB.clamp(imaginaryPos, 0, param.width - param.pointSize));\r\n                    redrawPoint();\r\n                    param.callback(getValue(), isFirst, false);\r\n                    isFirst = false;\r\n                }\r\n                if (event.type === 'pointerup') {\r\n                    event.eventStopPropagation();\r\n                    isDragging = false;\r\n                    redrawPoint();\r\n                    param.callback(getValue(), false, true);\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    // --- interface ---\r\n    this.getEl = function() {\r\n        return div;\r\n    };\r\n    this.setActive = function(isActive) {\r\n        if (isActive) {\r\n            sliderPoint.style.backgroundColor = '#fff';\r\n        } else {\r\n            sliderPoint.style.backgroundColor = '#eaeaea';\r\n        }\r\n    };\r\n    this.destroy = function() {\r\n        pointerListener.destroy();\r\n    };\r\n};","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * UI to pick between colors in colorArr. can display full transparent (checkerboard).\r\n * Can't deal with 0.5 alpha.\r\n * Rectangular buttons.\r\n *\r\n * p = {\r\n *     colorArr: rgba[], // duplicates are removed\r\n *     onChange: func(rgbaObj),\r\n *     label: string,\r\n *     initialIndex: int// optional, index before duplicates were removed\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const ColorOptions = function(p) {\r\n    const div = BB.el({\r\n        content: p.label ? p.label : '',\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n\r\n    let selectedIndex = 0;\r\n    const colorArr = [];\r\n    const buttonArr = [];\r\n    const buttonSize = 22;\r\n    const checkerUrl = BB.createCheckerDataUrl(5);\r\n\r\n    // build colorArr while removing duplicates\r\n    for (let i = 0; i < p.colorArr.length; i++) {\r\n        const item = p.colorArr[i];\r\n        let found = false;\r\n        for (let e = 0; e < colorArr.length; e++) {\r\n            const sItem = colorArr[e];\r\n            if (sItem === null || item === null) {\r\n                continue;\r\n            }\r\n            if (sItem.r === item.r && sItem.g === item.g && sItem.b === item.b && sItem.a === item.a) {\r\n                found = true;\r\n                break;\r\n            }\r\n        }\r\n        if (found) {\r\n            continue;\r\n        }\r\n        colorArr.push(item);\r\n        if ('initialIndex' in p && p.initialIndex === i) {\r\n            selectedIndex = colorArr.length - 1;\r\n        }\r\n    }\r\n\r\n    for (let i = 0; i < colorArr.length; i++) {\r\n        (function(i) {\r\n\r\n            const colorButton = BB.el({\r\n                content: colorArr[i] ? '' : 'X',\r\n                css: {\r\n                    width: buttonSize + 'px',\r\n                    height: buttonSize + 'px',\r\n                    backgroundColor: colorArr[i] ? BB.ColorConverter.toRgbaStr(colorArr[i]) : 'transparent',\r\n                    marginLeft: '7px',\r\n                    boxShadow: '0 0 0 1px #aaa',\r\n                    cursor: 'pointer',\r\n                    userSelect: 'none',\r\n                    textAlign: 'center',\r\n                    lineHeight: (buttonSize + 1) + 'px',\r\n                    color: '#aaa'\r\n                }\r\n            });\r\n            if (colorArr[i] && colorArr[i].a === 0) {\r\n                colorButton.style.backgroundImage = 'url(' + checkerUrl + ')';\r\n            }\r\n\r\n            colorButton.onclick = function(e) {\r\n                e.preventDefault();\r\n                selectedIndex = i;\r\n                update();\r\n                p.onChange(colorArr[i]);\r\n            };\r\n\r\n            (colorButton as any).setIsSelected = function(b) {\r\n                if (b) {\r\n                    BB.css(colorButton, {\r\n                        boxShadow: '0 0 0 2px var(--active-highlight-color), 0 0 5px 0 var(--active-highlight-color)',\r\n                        pointerEvents: 'none'\r\n                    });\r\n                } else {\r\n                    BB.css(colorButton, {\r\n                        boxShadow: '0 0 0 1px #aaa',\r\n                        pointerEvents: ''\r\n                    });\r\n                }\r\n            };\r\n\r\n\r\n            div.appendChild(colorButton);\r\n            buttonArr.push(colorButton);\r\n        })(i);\r\n    }\r\n\r\n\r\n    function update() {\r\n        for (let i = 0; i < buttonArr.length; i++) {\r\n            buttonArr[i].setIsSelected(i === selectedIndex);\r\n        }\r\n    }\r\n    update();\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.destroy = () => {\r\n        buttonArr.forEach(item => {\r\n            item.onclick = null;\r\n        });\r\n        buttonArr.splice(0, buttonArr.length);\r\n    };\r\n};","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * selectable options\r\n * p = {\r\n *     optionArr: {\r\n *          id: string,\r\n *          label: string | HTMLElement\r\n *     }[],\r\n *     initialId?: string,\r\n *     onChange: function(id string): void,\r\n *     changeOnInit?: boolean, // trigger change on creation\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const Options = function(p) {\r\n    const div = BB.el({});\r\n\r\n    const wrapperEl = BB.el({\r\n        parent: div,\r\n        className: 'kl-option-wrapper',\r\n        css: {\r\n            display: 'flex'\r\n        }\r\n    });\r\n\r\n    const optionArr: {\r\n        id: string;\r\n        el: HTMLElement;\r\n    }[] = [];\r\n    let selectedId = 'initialId' in p ? p.initialId : p.optionArr[0].id;\r\n\r\n    function createOption(o) {\r\n        const optionObj = {\r\n            id: o.id,\r\n            el: null,\r\n        };\r\n\r\n        const classArr = ['kl-option'];\r\n        if (p.isSmall) {\r\n            classArr.push('kl-option--small');\r\n        }\r\n        if (typeof o.label !== 'string') {\r\n            classArr.push('kl-option--custom-el');\r\n            BB.css(o.label, {\r\n                display: 'block',\r\n                pointerEvents: 'none',\r\n            });\r\n        }\r\n\r\n        optionObj.el = BB.el({\r\n            parent: wrapperEl,\r\n            content: o.label,\r\n            className: classArr.join(' '),\r\n            onClick: function() {\r\n                if (selectedId !== optionObj.id) {\r\n                    selectedId = optionObj.id;\r\n                    update();\r\n                    p.onChange(selectedId);\r\n                }\r\n            }\r\n        });\r\n\r\n        if (o.title) {\r\n            optionObj.el.title = o.title;\r\n        }\r\n\r\n        optionArr.push(optionObj);\r\n    }\r\n\r\n    function update() {\r\n        for (let i = 0; i < optionArr.length; i++) {\r\n            if (optionArr[i].id === selectedId) {\r\n                BB.addClassName(optionArr[i].el, 'kl-option-selected');\r\n            } else {\r\n                BB.removeClassName(optionArr[i].el, 'kl-option-selected');\r\n            }\r\n        }\r\n    }\r\n\r\n    for (let i = 0; i < p.optionArr.length; i++) {\r\n        createOption(p.optionArr[i]);\r\n    }\r\n\r\n    update();\r\n\r\n    if (p.changeOnInit) {\r\n        setTimeout(function() {\r\n            p.onChange(selectedId);\r\n        }, 0);\r\n    }\r\n\r\n    function getIndex() {\r\n        for (let i = 0; i < optionArr.length; i++) {\r\n            if (optionArr[i].id === selectedId) {\r\n                return i;\r\n            }\r\n        }\r\n    }\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n    this.getValue = function() {\r\n        return selectedId;\r\n    }\r\n    this.next = function() {\r\n        selectedId = optionArr[(getIndex() + 1) % optionArr.length].id;\r\n        update();\r\n        p.onChange(selectedId);\r\n    };\r\n    this.previous = function() {\r\n        selectedId = optionArr[(optionArr.length + getIndex() - 1) % optionArr.length].id;\r\n        update();\r\n        p.onChange(selectedId);\r\n    };\r\n    this.destroy = () => {\r\n        optionArr.forEach(item => {\r\n            BB.destroyEl(item.el);\r\n        });\r\n        optionArr.splice(0, optionArr.length);\r\n    };\r\n};","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport angleSvg from 'url:~/src/app/img/ui/angle.svg';\r\n\r\n\r\ntype TUiState = 'left' | 'right';\r\n\r\n/**\r\n * display little messages at the top of KlWorkspace\r\n */\r\nexport class StatusOverlay {\r\n\r\n    private el: HTMLDivElement;\r\n    private innerEl: HTMLDivElement;\r\n    private angleIm: HTMLImageElement;\r\n    private innerInnerEl: HTMLDivElement;\r\n    private isWide: boolean;\r\n    private uiState: TUiState;\r\n\r\n    private timeout: number;\r\n    private timeout2: number;\r\n    private timeout3: number;\r\n\r\n    private updateUiState() {\r\n        if (!this.el) {\r\n            return;\r\n        }\r\n        setTimeout(()=>{}, 100);\r\n        if (this.uiState === 'left') {\r\n            this.el.style.left = '271px';\r\n        } else {\r\n            this.el.style.removeProperty('left');\r\n        }\r\n    }\r\n\r\n    private init() {\r\n        this.el = BB.el({\r\n            className: \"top-overlay g-root\",\r\n            onClick: BB.handleClick,\r\n        }) as HTMLDivElement;\r\n\r\n        if (this.isWide) {\r\n            this.el.style.width = '100%';\r\n        }\r\n\r\n        this.updateUiState();\r\n\r\n        this.innerEl = BB.el({\r\n            className: 'top-overlay-inner',\r\n        }) as HTMLDivElement\r\n\r\n\r\n        this.angleIm = new Image();\r\n        this.angleIm.src = angleSvg;\r\n        BB.css(this.angleIm, {\r\n            verticalAlign: 'bottom',\r\n            width: '20px',\r\n            height: '20px',\r\n            marginLeft: '5px',\r\n            borderRadius: '10px'\r\n        });\r\n\r\n        this.innerInnerEl = document.createElement('div');\r\n        this.innerInnerEl.style.display = 'inline-block';\r\n\r\n        this.innerEl.appendChild(this.innerInnerEl);\r\n        this.innerEl.appendChild(this.angleIm);\r\n        this.el.appendChild(this.innerEl);\r\n        document.body.appendChild(this.el);\r\n        this.el.style.display = \"none\";\r\n    }\r\n\r\n\r\n    // --- public ---\r\n\r\n    constructor () {\r\n        this.init();\r\n    }\r\n\r\n    setWide(b: boolean) {\r\n        this.isWide = !!b;\r\n\r\n        if (!this.el) {\r\n            return;\r\n        }\r\n\r\n        if (this.isWide) {\r\n            this.el.style.width = '100%';\r\n            this.el.style.left = '';\r\n        } else {\r\n            this.el.style.removeProperty('width');\r\n            this.el.style.left = this.uiState === 'left' ? '271px' : '';\r\n        }\r\n    }\r\n\r\n    setUiState(state: TUiState) {\r\n        this.uiState = state;\r\n        this.updateUiState();\r\n    }\r\n\r\n    out(msg: string | {type: 'transform', angleDeg: number, scale: number}, doPulse?: boolean) {\r\n\r\n        if (msg && typeof msg === 'object') {\r\n\r\n            if (msg.type === 'transform') {\r\n                this.angleIm.style.display = 'inline-block';\r\n                this.angleIm.style.transform = 'rotate(' + msg.angleDeg + 'deg)';\r\n\r\n                if (msg.angleDeg % 90 === 0) {\r\n                    this.angleIm.style.boxShadow = 'inset 0 0 0 1px rgba(255, 255, 255, 0.7)';\r\n                } else {\r\n                    this.angleIm.style.boxShadow = '';\r\n                }\r\n\r\n                this.innerInnerEl.innerHTML = Math.round(msg.scale * 100) + \"%\";\r\n\r\n\r\n            } else {\r\n                this.angleIm.style.display = 'none';\r\n            }\r\n\r\n\r\n\r\n        } else if (typeof msg === 'string') {\r\n            this.angleIm.style.display = 'none';\r\n            this.innerInnerEl.innerHTML = msg;\r\n        }\r\n\r\n        if (doPulse) {\r\n            this.innerEl.style.animation = '';\r\n            setTimeout(\r\n                () => this.innerEl.style.animation = 'top-overlay-pulse 0.5s ease-out',\r\n                20\r\n            );\r\n            if (this.timeout3) {\r\n                clearTimeout(this.timeout3);\r\n            }\r\n            this.timeout3 = window.setTimeout(\r\n                () => this.innerEl.style.animation = '',\r\n                520\r\n            );\r\n        }\r\n\r\n\r\n\r\n        if (this.timeout) {\r\n            clearTimeout(this.timeout);\r\n        }\r\n        if (this.timeout2) {\r\n            clearTimeout(this.timeout2);\r\n        }\r\n        this.el.style.animationName = doPulse ? 'consoleInFast' : \"consoleIn\";\r\n        this.el.style.opacity = \"1\";\r\n        this.timeout = window.setTimeout(() => {\r\n            this.el.style.opacity = \"0\";\r\n            this.el.style.animationName = \"consoleOut\";\r\n            this.timeout2 = window.setTimeout(() => {\r\n                this.el.style.display = \"none\";\r\n                this.timeout2 = 0;\r\n            }, 450);\r\n            this.timeout = 0;\r\n        }, 1200);\r\n        this.el.style.display = \"flex\";\r\n    }\r\n\r\n\r\n}\r\n","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"iQ1f0\");","import {BB} from '../../../bb/bb';\r\nimport {popup} from './popup';\r\n\r\nexport function exportDialog(parent, image) {\r\n    let boxSize, aboutCloseFunc, aboutDiv, closed, aniToggle, imageContainer, coverImage, coverSize,\r\n        text, holding, aniTimeout, halfBoxSize;\r\n    boxSize = 22 * 2;\r\n    halfBoxSize = 22;\r\n    aboutCloseFunc = function () {\r\n    };\r\n    closed = false;\r\n    aniToggle = false;\r\n    aboutDiv = document.createElement(\"div\");\r\n    BB.css(aboutDiv, {\r\n        width: (7 * boxSize) + \"px\"\r\n    });\r\n\r\n    imageContainer = document.createElement(\"div\");\r\n    coverImage = new Image();\r\n    coverImage.src = image.src;\r\n\r\n    imageContainer.appendChild(coverImage);\r\n    imageContainer.appendChild(image);\r\n\r\n    BB.css(imageContainer, {\r\n        width: (6 * boxSize) + \"px\",\r\n        height: (4 * boxSize) + \"px\",\r\n        marginTop: (boxSize / 2 - 1) + \"px\",\r\n        marginLeft: (boxSize / 2 - 1) + \"px\",\r\n        position: \"relative\",\r\n        overflow: \"hidden\",\r\n        boxShadow: \"0 0 10px 4px rgba(255,255,255, 0)\",\r\n        border: \"1px solid rgba(255, 255, 255, 1)\",\r\n        transition: \"box-shadow 0.7s linear\"\r\n    });\r\n    BB.css(image, {\r\n        position: \"absolute\",\r\n        left: '0',\r\n        top: '0',\r\n        width: (6 * boxSize) + \"px\",\r\n        height: (4 * boxSize) + \"px\",\r\n        opacity: '0'\r\n    });\r\n    coverSize = {\r\n        width: (6 * boxSize),\r\n        height: (6 * boxSize / image.width) * image.height\r\n    };\r\n    if (coverSize.height < (4 * boxSize)) {\r\n        coverSize.height = (4 * boxSize);\r\n        coverSize.width = (coverSize.height / image.height) * image.width;\r\n    }\r\n    BB.css(coverImage, {\r\n        position: \"absolute\",\r\n        top: (2 * boxSize) + \"px\",\r\n        left: (3 * boxSize) + \"px\",\r\n        width: coverSize.width + \"px\",\r\n        height: coverSize.height + \"px\",\r\n        marginLeft: (-coverSize.width / 2) + \"px\",\r\n        marginTop: (-coverSize.height / 2) + \"px\"\r\n    });\r\n\r\n    function animation() {\r\n        if (closed) {\r\n            return;\r\n        }\r\n        aniToggle = !aniToggle;\r\n        if (aniToggle) {\r\n            BB.css(imageContainer, {\r\n                border: \"1px solid rgba(0, 0, 0, 1)\"\r\n            });\r\n        } else {\r\n            BB.css(imageContainer, {\r\n                border: \"1px solid rgba(200, 200, 200, 1)\"\r\n            });\r\n        }\r\n        setTimeout(animation, 510);\r\n    }\r\n\r\n    animation();\r\n\r\n    text = document.createElement(\"div\");\r\n    text.innerHTML = \"Right-Click or Press-Hold on the image, then save.\";\r\n    text.ontouchstart = function () {\r\n        return false;\r\n    };\r\n    BB.css(text, {\r\n        fontSize: (boxSize / 2.5) + \"px\",\r\n        color: \"#666\",\r\n        padding: \"10px\",\r\n        textAlign: \"center\"\r\n    });\r\n\r\n    aboutDiv.appendChild(imageContainer);\r\n    aboutDiv.appendChild(text);\r\n\r\n    holding = false;\r\n    image.ontouchstart = function () {\r\n        BB.css(imageContainer, {\r\n            boxShadow: \"0 0 10px 8px rgba(0,255,255, 1)\"\r\n        });\r\n        holding = true;\r\n        aniTimeout = setTimeout(function () {\r\n            holding = false;\r\n            BB.css(imageContainer, {\r\n                boxShadow: \"0 0 10px 4px rgba(0,255,255, 0)\"\r\n            });\r\n        }, 1500);\r\n    };\r\n    image.ontouchmove = function () {\r\n        BB.css(imageContainer, {\r\n            boxShadow: \"0 0 10px 4px rgba(0,255,255, 0)\"\r\n        });\r\n        holding = false;\r\n        clearTimeout(aniTimeout);\r\n    };\r\n    image.ontouchend = function () {\r\n        BB.css(imageContainer, {\r\n            boxShadow: \"0 0 10px 4px rgba(0,255,255, 0)\"\r\n        });\r\n        holding = false;\r\n        clearTimeout(aniTimeout);\r\n    };\r\n\r\n    popup({\r\n        target: parent,\r\n        message: \"<b>Save Image</b>\",\r\n        div: aboutDiv,\r\n        buttons: [\"Close\"],\r\n        callback: function (result) {\r\n            closed = true;\r\n        }\r\n    });\r\n}","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * element that lets you crop an image and copy it via right click\r\n *\r\n * param = {\r\n *     width: number,\r\n *     height: number,\r\n *     canvas: image | canvas,\r\n *     isNotCopy: boolean,\r\n *     onChange: function(width, height)\r\n * }\r\n *\r\n * @param param object\r\n * @constructor\r\n */\r\nexport function CropCopy(param) {\r\n    const div = document.createElement('div');\r\n    BB.css(div, {\r\n        position: 'relative',\r\n        height: param.height + 'px',\r\n        width: param.width + 'px',\r\n        overflow: 'hidden',\r\n        colorScheme: 'only light',\r\n    });\r\n    div.style.position = 'relative';\r\n\r\n    let crop;\r\n    function resetCrop() {\r\n        crop = {\r\n            x: 0,\r\n            y: 0,\r\n            width: param.canvas.width,\r\n            height: param.canvas.height\r\n        };\r\n    }\r\n    resetCrop();\r\n\r\n\r\n    function updateCroppedCanvas() {\r\n        croppedCanvas.width = Math.round(crop.width);\r\n        croppedCanvas.height = Math.round(crop.height);\r\n        let ctx = croppedCanvas.getContext('2d');\r\n        ctx.drawImage(param.canvas, Math.round(-crop.x), Math.round(-crop.y));\r\n        if (croppedImage) {\r\n            croppedImage.src = croppedCanvas.toDataURL('image/png');\r\n        }\r\n\r\n        if (param.onChange) {\r\n            param.onChange(croppedCanvas.width, croppedCanvas.height);\r\n        }\r\n    }\r\n    function updateSelectionRect() {\r\n        BB.css(selectionRect, {\r\n            left: (thumbX + crop.x * scaleW) + 'px',\r\n            top: (thumbY + crop.y * scaleH) + 'px',\r\n            width: (crop.width * scaleW) + 'px',\r\n            height: (crop.height * scaleH) + 'px'\r\n        });\r\n        if (param.onChange) {\r\n            param.onChange(Math.round(crop.width), Math.round(crop.height));\r\n        }\r\n    }\r\n    function isInsideSelectionRect(p) {\r\n        let rect = {\r\n            x: Math.round(thumbX + crop.x * scaleW),\r\n            y: Math.round(thumbY + crop.y * scaleH),\r\n            width: Math.round(crop.width * scaleW),\r\n            height: Math.round(crop.height * scaleH)\r\n        };\r\n        return rect.x <= p.x && p.x <= rect.x + rect.width &&\r\n            rect.y <= p.y && p.y <= rect.y + rect.height;\r\n    }\r\n\r\n    const croppedCanvas = BB.canvas();\r\n    let eventTarget = croppedCanvas;\r\n    let croppedImage = null;\r\n    if (!param.isNotCopy) { //navigator.appName === 'Microsoft Internet Explorer') { //i would prefer not using an image\r\n        croppedImage = new Image();\r\n        eventTarget = croppedImage;\r\n    }\r\n    BB.css(eventTarget, {\r\n        height: param.height + 'px',\r\n        width: param.width + 'px'\r\n    });\r\n    div.appendChild(eventTarget);\r\n    updateCroppedCanvas();\r\n\r\n    const padding = 20;\r\n    const previewWrapper = BB.el({\r\n        css: {\r\n            width: param.width + 'px',\r\n            height: param.height + 'px',\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0',\r\n            pointerEvents: 'none'\r\n        }\r\n    });\r\n    div.appendChild(previewWrapper);\r\n    BB.createCheckerDataUrl(4, function(v) {\r\n        previewWrapper.style.backgroundImage = 'url('+v+')';\r\n    });\r\n\r\n    const thumbSize = BB.fitInto(param.canvas.width, param.canvas.height, param.width - padding * 2, param.height - padding * 2, 1);\r\n    const thumbCanvas = BB.canvas(Math.round(thumbSize.width), Math.round(thumbSize.height));\r\n    thumbCanvas.style.imageRendering = 'pixelated';\r\n    const scaleW = thumbCanvas.width / param.canvas.width;\r\n    const scaleH = thumbCanvas.height / param.canvas.height;\r\n    const thumbCtx = thumbCanvas.getContext('2d');\r\n    thumbCtx.imageSmoothingEnabled = false;\r\n    thumbCtx.drawImage(param.canvas, 0, 0, thumbCanvas.width, thumbCanvas.height);\r\n    previewWrapper.appendChild(thumbCanvas);\r\n    const thumbX = parseInt('' + ((param.width - thumbCanvas.width) / 2));\r\n    const thumbY = parseInt('' + ((param.height - thumbCanvas.height) / 2));\r\n    BB.css(thumbCanvas, {\r\n        position: 'absolute',\r\n        left: thumbX + \"px\",\r\n        top: thumbY + \"px\"\r\n    });\r\n\r\n    const selectionRect = BB.el({\r\n        css: {\r\n            position: 'absolute',\r\n            boxShadow: '0 0 0 1px #fff, 0 0 0 2px #000, 0 0 40px 1px #000',\r\n        }\r\n    });\r\n    previewWrapper.appendChild(selectionRect);\r\n    updateSelectionRect();\r\n\r\n\r\n    function toOriginalSpace(p) {\r\n        return {\r\n            x: BB.clamp((p.x - thumbX) / scaleW, 0, param.canvas.width),\r\n            y: BB.clamp((p.y - thumbY) / scaleH, 0, param.canvas.height),\r\n        };\r\n    }\r\n    //gen crop from thumb-space points\r\n    function genCrop(p1, p2) {\r\n        let topLeftP = {\r\n            x: Math.min(p1.x, p2.x),\r\n            y: Math.min(p1.y, p2.y)\r\n        };\r\n        let bottomRightP = {\r\n            x: Math.max(p1.x, p2.x),\r\n            y: Math.max(p1.y, p2.y)\r\n        };\r\n        let origTopLeftP = toOriginalSpace(topLeftP);\r\n        let origBottomRightP = toOriginalSpace(bottomRightP);\r\n        origTopLeftP.x = Math.floor(origTopLeftP.x);\r\n        origTopLeftP.y = Math.floor(origTopLeftP.y);\r\n        origBottomRightP.x = Math.ceil(origBottomRightP.x);\r\n        origBottomRightP.y = Math.ceil(origBottomRightP.y);\r\n        return {\r\n            x: origTopLeftP.x,\r\n            y: origTopLeftP.y,\r\n            width: origBottomRightP.x - origTopLeftP.x,\r\n            height: origBottomRightP.y - origTopLeftP.y\r\n        };\r\n    }\r\n\r\n    function isReset() {\r\n        return crop.x === 0 && crop.y === 0 && crop.width === param.canvas.width && crop.height === param.canvas.height;\r\n    }\r\n\r\n    let startP;\r\n    let startCrop = null;\r\n    let isDragging = false;\r\n    let didMove = false;\r\n    let updateCropTimeout;\r\n    const pointerListener = new BB.PointerListener({\r\n        target: eventTarget,\r\n        fixScribble: true,\r\n        onPointer: function(event) {\r\n            let fullPos;\r\n            if (event.type === 'pointerdown' && event.button === 'left') {\r\n                event.eventPreventDefault();\r\n                isDragging = true;\r\n                startP = {\r\n                    x: event.relX,\r\n                    y: event.relY\r\n                };\r\n                if (!isReset() && isInsideSelectionRect(startP)) {\r\n                    startCrop = {\r\n                        x: crop.x,\r\n                        y: crop.y,\r\n                        width: crop.width,\r\n                        height: crop.height\r\n                    };\r\n                } else {\r\n                    crop = genCrop(startP, startP);\r\n                }\r\n            } else if (event.type === 'pointermove' && event.button === 'left') {\r\n                event.eventPreventDefault();\r\n                didMove = true;\r\n                if (startCrop) {\r\n                    crop.x = startCrop.x + Math.round((event.relX - startP.x) / scaleW);\r\n                    crop.y = startCrop.y + Math.round((event.relY - startP.y) / scaleH);\r\n                    crop.x = BB.clamp(crop.x, 0, param.canvas.width - crop.width);\r\n                    crop.y = BB.clamp(crop.y, 0, param.canvas.height - crop.height);\r\n                } else {\r\n                    crop = genCrop(startP, {x: event.relX, y: event.relY});\r\n                }\r\n                updateSelectionRect();\r\n            } else if (event.type === 'pointerup' && startP) {\r\n                event.eventPreventDefault();\r\n                isDragging = false;\r\n                startCrop = null;\r\n                startP = null;\r\n                if (crop.width === 0 || crop.height === 0 || !didMove) {\r\n                    resetCrop();\r\n                    updateSelectionRect();\r\n                }\r\n                didMove = false;\r\n                updateCropTimeout = setTimeout(updateCroppedCanvas, 1);\r\n            }\r\n        }\r\n    });\r\n\r\n    const keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, e, comboStr) {\r\n            if (isDragging) {\r\n                return;\r\n            }\r\n            let doUpdate = false;\r\n\r\n            let stepSize = Math.max(1, 1 / scaleW);\r\n            let shiftIsPressed = keyListener.isPressed('shift');\r\n\r\n            if (keyStr === 'left') {\r\n                if (shiftIsPressed) {\r\n                    crop.width = BB.clamp(crop.width - stepSize, 1, param.canvas.width - crop.x);\r\n                } else {\r\n                    crop.x = BB.clamp(crop.x - stepSize, 0, param.canvas.width - crop.width);\r\n                }\r\n                doUpdate = true;\r\n            }\r\n            if (keyStr === 'right') {\r\n                if (shiftIsPressed) {\r\n                    crop.width = BB.clamp(crop.width + stepSize, 1, param.canvas.width - crop.x);\r\n                } else {\r\n                    crop.x = BB.clamp(crop.x + stepSize, 0, param.canvas.width - crop.width);\r\n                }\r\n                doUpdate = true;\r\n            }\r\n            if (keyStr === 'up') {\r\n                if (shiftIsPressed) {\r\n                    crop.height = BB.clamp(crop.height - stepSize, 1, param.canvas.height - crop.y);\r\n                } else {\r\n                    crop.y = BB.clamp(crop.y - stepSize, 0, param.canvas.height - crop.height);\r\n                }\r\n                doUpdate = true;\r\n            }\r\n            if (keyStr === 'down') {\r\n                if (shiftIsPressed) {\r\n                    crop.height = BB.clamp(crop.height + stepSize, 1, param.canvas.height - crop.y);\r\n                } else {\r\n                    crop.y = BB.clamp(crop.y + stepSize, 0, param.canvas.height - crop.height);\r\n                }\r\n                doUpdate = true;\r\n            }\r\n\r\n            if (doUpdate) {\r\n                e.preventDefault();\r\n                updateSelectionRect();\r\n                clearTimeout(updateCropTimeout);\r\n                updateCropTimeout = setTimeout(updateCroppedCanvas, 100);\r\n            }\r\n        }\r\n    });\r\n\r\n    this.getEl = function() {\r\n        return div;\r\n    };\r\n    this.reset = function() {\r\n        resetCrop();\r\n        updateCroppedCanvas();\r\n        updateSelectionRect();\r\n    };\r\n    this.destroy = function() {\r\n        eventTarget.style.removeProperty('width');\r\n        eventTarget.style.removeProperty('height');\r\n        keyListener.destroy();\r\n        pointerListener.destroy();\r\n    };\r\n    this.isReset = function() {\r\n        return isReset();\r\n    };\r\n    this.getRect = function() {\r\n        return JSON.parse(JSON.stringify(crop));\r\n    };\r\n    this.getCroppedImage = function() {\r\n        return croppedCanvas;\r\n    };\r\n}\r\n","import {BB} from '../../../bb/bb';\r\nimport {popup} from './popup';\r\nimport {CropCopy} from '../components/crop-copy';\r\nimport {LANG} from '../../../language/language';\r\n\r\n/// <reference path=\"./types.d.ts\" />\r\n\r\n/**\r\n *\r\n * @param parent\r\n * @param fullCanvas\r\n * @param cropCallback\r\n * @param output - BB.Output\r\n * @param showCrop - boolean - show crop button\r\n */\r\nexport function clipboardDialog(parent, fullCanvas, cropCallback, output, showCrop) {\r\n    const div = document.createElement(\"div\");\r\n    const isSmall = window.innerWidth < 550 || window.innerHeight < 550;\r\n\r\n    let topWrapper = BB.el({\r\n        content: LANG('crop-drag-to-crop'),\r\n        css: {\r\n            textAlign: 'center'\r\n        }\r\n    });\r\n    div.appendChild(topWrapper);\r\n\r\n\r\n    let cropCopy = new CropCopy({\r\n        width: isSmall ? 340 : 540,\r\n        height: isSmall ? 300 : 350,\r\n        canvas: fullCanvas\r\n    });\r\n    BB.css(cropCopy.getEl(), {\r\n        marginTop: '10px',\r\n        marginLeft: '-20px',\r\n        borderTop: '1px solid #bbb',\r\n        borderBottom: '1px solid #bbb'\r\n    });\r\n    div.appendChild(cropCopy.getEl());\r\n\r\n    function toClipboard() {\r\n        const imgURL = cropCopy.getCroppedImage().toDataURL('image/png');\r\n        setTimeout(async function() {\r\n            try {\r\n                const data = await fetch(imgURL);\r\n                const blob = await data.blob();\r\n                await (navigator.clipboard as any).write([\r\n                    new ClipboardItem({\r\n                        [blob.type]: blob\r\n                    } as any) // todo check is possible?\r\n                ]);\r\n                setTimeout(function() {\r\n                    output.out(LANG('cropcopy-copied'), true);\r\n                }, 200);\r\n            } catch (err) {\r\n                console.error(err.name, err.message);\r\n            }\r\n        }, 0);\r\n    }\r\n\r\n    let keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, KeyEvent, comboStr) {\r\n            if (comboStr === 'ctrl+c') {\r\n                toClipboard();\r\n                closefunc();\r\n            }\r\n        }\r\n    });\r\n\r\n    let closefunc;\r\n    function blur() {\r\n        closefunc();\r\n    }\r\n    BB.addEventListener(window, \"blur\", blur);\r\n    popup({\r\n        target: parent,\r\n        message: '<b>' + (showCrop ? `${LANG('cropcopy-title-copy')} / ${LANG('cropcopy-title-crop')}` : `${LANG('cropcopy-title-copy')}`) + '</b>',\r\n        div: div,\r\n        style: isSmall ? {} : {\r\n            width: \"500px\"\r\n        },\r\n        buttons: showCrop ? [LANG('cropcopy-btn-copy'), LANG('cropcopy-btn-crop'), 'Cancel'] : [LANG('cropcopy-btn-copy'), 'Cancel'],\r\n        primaries: [LANG('cropcopy-btn-copy')],\r\n        callback: function (result) {\r\n            if (result === LANG('cropcopy-btn-copy')) {\r\n                toClipboard();\r\n            } else if (result === LANG('cropcopy-btn-crop')) {\r\n                let rectObj = cropCopy.getRect();\r\n                cropCallback({\r\n                    left: Math.round(-rectObj.x),\r\n                    right: Math.round(rectObj.x + rectObj.width - fullCanvas.width),\r\n                    top: Math.round(-rectObj.y),\r\n                    bottom: Math.round(rectObj.y + rectObj.height - fullCanvas.height)\r\n                });\r\n            }\r\n            BB.removeEventListener(window, \"blur\", blur);\r\n            cropCopy.destroy();\r\n            keyListener.destroy();\r\n        },\r\n        clickOnEnter: LANG('cropcopy-btn-copy'),\r\n        closefunc: function (func) {\r\n            closefunc = func;\r\n        }\r\n    });\r\n}","import {BB} from '../../../bb/bb';\r\nimport {popup} from '../modals/popup';\r\nimport {klHistory} from '../../history/kl-history';\r\nimport {Options} from '../base-components/options';\r\nimport {Select} from '../base-components/select';\r\nimport {PointSlider} from '../base-components/point-slider';\r\n// @ts-ignore\r\nimport addLayerImg from 'url:~/src/app/img/ui/add-layer.svg';\r\n// @ts-ignore\r\nimport duplicateLayerImg from 'url:~/src/app/img/ui/duplicate-layer.svg';\r\n// @ts-ignore\r\nimport mergeLayerImg from 'url:~/src/app/img/ui/merge-layers.svg';\r\n// @ts-ignore\r\nimport removeLayerImg from 'url:~/src/app/img/ui/remove-layer.svg';\r\n// @ts-ignore\r\nimport renameLayerImg from 'url:~/src/app/img/ui/rename-layer.svg';\r\nimport {KlCanvas, MAX_LAYERS} from '../../canvas/kl-canvas';\r\nimport {IMixMode} from '../../kl.types';\r\nimport {LANG} from '../../../language/language';\r\nimport {translateBlending} from '../../canvas/translate-blending';\r\n\r\n\r\nexport function klLayerManager(p_canvas: KlCanvas, p_func, p_rootDiv) {\r\n    let klCanvas: KlCanvas = p_canvas;\r\n    let layerElArr = [];\r\n    let layerHeight = 35;\r\n    let layerSpacing = 0;\r\n    let width = 250;\r\n    let oldHistoryState;\r\n    let updatefunc = p_func;\r\n    let uiState = 'right'; // 'left | 'right'\r\n\r\n\r\n    let largeThumbDiv = BB.el({\r\n        onClick: BB.handleClick,\r\n        css: {\r\n            position: \"absolute\",\r\n            right: \"280px\",\r\n            top: \"500px\",\r\n            background: \"#aaa\",\r\n            boxShadow: \"1px 1px 3px rgba(0,0,0,0.3)\",\r\n            pointerEvents: \"none\",\r\n            padding: '0',\r\n            border: \"1px solid #aaa\",\r\n            transition: \"opacity 0.3s ease-out\",\r\n            userSelect: 'none',\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n    BB.createCheckerDataUrl(4, function(url) {\r\n        largeThumbDiv.style.backgroundImage = \"url(\" + url + \")\";\r\n    });\r\n    let largeThumbCanvas = BB.canvas(200, 200);\r\n    largeThumbCanvas.style.display = \"block\";\r\n    largeThumbDiv.appendChild(largeThumbCanvas);\r\n    let largeThumbTimeout, largeThumbInTimeout;\r\n    let largeThumbInDocument = false;\r\n\r\n\r\n    let klCanvasLayerArr = klCanvas.getLayers();\r\n    let selectedSpotIndex = klCanvasLayerArr.length - 1;\r\n    let div = document.createElement(\"div\");\r\n    div.style.marginRight = \"10px\";\r\n    div.style.marginBottom = \"10px\";\r\n    div.style.marginLeft = \"10px\";\r\n    div.style.marginTop = \"10px\";\r\n    div.style.cursor = \"default\";\r\n\r\n    let listdiv = document.createElement(\"div\");\r\n    BB.css(listdiv, {\r\n        width: width + \"px\",\r\n        position: \"relative\"\r\n\r\n    });\r\n\r\n\r\n    function renameLayer(layer) {\r\n        let div = document.createElement('div');\r\n\r\n        let label = BB.el({\r\n            content: LANG('layers-rename-name') + ':',\r\n            css: {\r\n                marginRight: '5px'\r\n            }\r\n        });\r\n\r\n        const row = BB.el({\r\n            css: {\r\n                display: 'flex',\r\n            }\r\n        });\r\n        let input = document.createElement('input');\r\n        input.value = klCanvas.getLayer(layer).name;\r\n        input.setAttribute('data-ignore-focus', 'true');\r\n        const clearBtn = BB.el({\r\n            tagName: 'Button',\r\n            content: '<img src=\"' + removeLayerImg + '\" height=\"20\"/>',\r\n            title: LANG('layers-rename-clear'),\r\n            css: {\r\n                marginLeft: '10px',\r\n            },\r\n            onClick: () => {\r\n                input.value = '';\r\n                input.focus();\r\n            }\r\n        });\r\n        const suggestions = [\r\n            LANG('layers-rename-sketch'),\r\n            LANG('layers-rename-colors'),\r\n            LANG('layers-rename-lines'),\r\n            LANG('background'),\r\n            LANG('layers-rename-foreground'),\r\n        ];\r\n        const suggestionBtns = [];\r\n        const row2 = BB.el({\r\n            css: {\r\n                display: 'flex',\r\n                flexWrap: 'wrap',\r\n                marginTop: '5px',\r\n                marginLeft: '-5px',\r\n            }\r\n        }) as HTMLDivElement;\r\n        suggestions.forEach(item => {\r\n            const btn = BB.el({\r\n                parent: row2,\r\n                tagName: 'Button',\r\n                content: item,\r\n                onClick: () => {\r\n                    input.value = btn.textContent;\r\n                },\r\n                css: {\r\n                    margin: '5px 0 0 5px',\r\n                }\r\n            });\r\n            suggestionBtns.push(btn);\r\n        });\r\n\r\n        div.appendChild(label);\r\n        label.append(row, row2);\r\n        row.append(input, clearBtn);\r\n\r\n        setTimeout(function() {\r\n            input.focus();\r\n            input.select();\r\n        }, 10);\r\n\r\n        popup({\r\n            target: p_rootDiv,\r\n            message: `<b>${LANG('layers-rename-title')}</b>`,\r\n            div: div,\r\n            buttons: [LANG('layers-rename'), 'Cancel'],\r\n            primaries: [LANG('layers-rename')],\r\n            callback: function (val) {\r\n                BB.destroyEl(clearBtn);\r\n                suggestionBtns.forEach(item => {\r\n                    BB.destroyEl(item);\r\n                });\r\n                suggestionBtns.splice(0, suggestionBtns.length);\r\n                if (val === LANG('layers-rename')) {\r\n                    if (input.value === klCanvas.getLayer(layer).name) {\r\n                        return;\r\n                    }\r\n                    klCanvas.renameLayer(layer, input.value);\r\n                    createLayerList();\r\n                    klHistory.pause(true);\r\n                    updatefunc(layer);\r\n                    klHistory.pause(false);\r\n                }\r\n            },\r\n            clickOnEnter: LANG('layers-rename')\r\n        });\r\n    }\r\n\r\n\r\n    let layerListEl = BB.el({});\r\n\r\n    (div as any).disableButtons = function(){}; //probably remove\r\n    (div as any).enableButtons = function(){}; //probably remove\r\n    let addnewBtn = document.createElement(\"button\");\r\n    let duplicateBtn = document.createElement(\"button\");\r\n    let mergeBtn = document.createElement(\"button\");\r\n    let removeBtn = document.createElement(\"button\");\r\n    let renameBtn = document.createElement(\"button\");\r\n\r\n    function createButtons() {\r\n        let div = document.createElement(\"div\");\r\n        function async() {\r\n            BB.makeUnfocusable(addnewBtn);\r\n            BB.makeUnfocusable(duplicateBtn);\r\n            BB.makeUnfocusable(mergeBtn);\r\n            BB.makeUnfocusable(removeBtn);\r\n            BB.makeUnfocusable(renameBtn);\r\n\r\n            addnewBtn.style.cssFloat = 'left';\r\n            duplicateBtn.style.cssFloat = 'left';\r\n            mergeBtn.style.cssFloat = 'left';\r\n            removeBtn.style.cssFloat = 'left';\r\n            renameBtn.style.cssFloat = 'left';\r\n\r\n            addnewBtn.title = LANG('layers-new');\r\n            duplicateBtn.title = LANG('layers-duplicate');\r\n            removeBtn.title = LANG('layers-remove');\r\n            mergeBtn.title = LANG('layers-merge');\r\n            renameBtn.title = LANG('layers-rename-title');\r\n\r\n            addnewBtn.style.paddingLeft = \"5px\";\r\n            addnewBtn.style.paddingRight = \"3px\";\r\n\r\n            removeBtn.style.paddingLeft = \"5px\";\r\n            removeBtn.style.paddingRight = \"3px\";\r\n\r\n            duplicateBtn.style.paddingLeft = \"5px\";\r\n            duplicateBtn.style.paddingRight = \"3px\";\r\n\r\n            mergeBtn.style.paddingLeft = \"5px\";\r\n            mergeBtn.style.paddingRight = \"3px\";\r\n\r\n            renameBtn.style.height = \"30px\";\r\n            renameBtn.style.lineHeight = \"20px\";\r\n\r\n            addnewBtn.innerHTML = \"<img src='\" + addLayerImg + \"' height='20'/>\";\r\n            duplicateBtn.innerHTML = \"<img src='\" + duplicateLayerImg + \"' height='20'/>\";\r\n            mergeBtn.innerHTML = \"<img src='\" + mergeLayerImg + \"' height='20'/>\";\r\n            removeBtn.innerHTML = \"<img src='\" + removeLayerImg + \"' height='20'/>\";\r\n            renameBtn.innerHTML = \"<img src='\" + renameLayerImg + \"' height='20'/>\";\r\n            addnewBtn.style.marginRight = \"5px\";\r\n            removeBtn.style.marginRight = \"5px\";\r\n            duplicateBtn.style.marginRight = \"5px\";\r\n            mergeBtn.style.marginRight = \"5px\";\r\n            div.appendChild(addnewBtn);\r\n            div.appendChild(removeBtn);\r\n            div.appendChild(duplicateBtn);\r\n            div.appendChild(mergeBtn);\r\n            div.appendChild(renameBtn);\r\n            div.appendChild(BB.el({\r\n                css: {\r\n                    clear: 'both'\r\n                }\r\n            }));\r\n\r\n            let clearboth = document.createElement(\"div\");\r\n            clearboth.style.clear = \"both\";\r\n            clearboth.style.height = \"10px\";\r\n            div.appendChild(clearboth);\r\n\r\n\r\n            addnewBtn.onclick = function () {\r\n                if (klCanvas.addLayer(selectedSpotIndex) === false) {\r\n                    return;\r\n                }\r\n                klCanvasLayerArr = klCanvas.getLayers();\r\n\r\n                if (klCanvasLayerArr.length === MAX_LAYERS) {\r\n                    addnewBtn.disabled = true;\r\n                    duplicateBtn.disabled = true;\r\n                }\r\n                removeBtn.disabled = false;\r\n                selectedSpotIndex = selectedSpotIndex + 1;\r\n                createLayerList();\r\n                klHistory.pause(true);\r\n                updatefunc(selectedSpotIndex);\r\n                klHistory.pause(false);\r\n            };\r\n            duplicateBtn.onclick = function () {\r\n                if (klCanvas.duplicateLayer(selectedSpotIndex) === false) {\r\n                    return;\r\n                }\r\n                klCanvasLayerArr = klCanvas.getLayers();\r\n                if (klCanvasLayerArr.length === MAX_LAYERS) {\r\n                    addnewBtn.disabled = true;\r\n                    duplicateBtn.disabled = true;\r\n                }\r\n                removeBtn.disabled = false;\r\n                selectedSpotIndex++;\r\n                createLayerList();\r\n                klHistory.pause(true);\r\n                updatefunc(selectedSpotIndex);\r\n                klHistory.pause(false);\r\n            };\r\n            removeBtn.onclick = function () {\r\n                if (layerElArr.length <= 1) {\r\n                    return;\r\n                }\r\n\r\n                klCanvas.removeLayer(selectedSpotIndex);\r\n                if (selectedSpotIndex > 0) {\r\n                    selectedSpotIndex--;\r\n                }\r\n                klCanvasLayerArr = klCanvas.getLayers();\r\n                createLayerList();\r\n                klHistory.pause(true);\r\n                updatefunc(selectedSpotIndex);\r\n                klHistory.pause(false);\r\n                if (klCanvasLayerArr.length === 1) {\r\n                    removeBtn.disabled = true;\r\n                }\r\n                if (klCanvasLayerArr.length < MAX_LAYERS) {\r\n                    addnewBtn.disabled = false;\r\n                    duplicateBtn.disabled = false;\r\n                }\r\n            };\r\n            mergeBtn.onclick = function () {\r\n                if (selectedSpotIndex <= 0) {\r\n                    return;\r\n                }\r\n\r\n                function mergeDialog(p) {\r\n                    let div = document.createElement(\"div\");\r\n                    div.innerHTML = LANG('layers-merge-description');\r\n\r\n                    let options = new Options({\r\n                        optionArr: [\r\n                            {id: p.mixModeStr, label: translateBlending(p.mixModeStr)},\r\n                            {id: 'source-in', label: 'source-in'},\r\n                            {id: 'source-out', label: 'source-out'},\r\n                            {id: 'source-atop', label: 'source-atop'},\r\n                            {id: 'destination-in', label: 'destination-in'},\r\n                            {id: 'destination-out', label: 'destination-out'},\r\n                            {id: 'destination-atop', label: 'destination-atop'},\r\n                            {id: 'xor', label: 'xor'}\r\n                        ],\r\n                        initId: p.mixModeStr,\r\n                        onChange: function(id) {\r\n                            update();\r\n                        },\r\n                        isSmall: true\r\n                    });\r\n                    options.getElement().style.marginTop = '5px';\r\n                    div.appendChild(options.getElement());\r\n\r\n                    const thumbDimensions = BB.fitInto(p.topCanvas.width, p.topCanvas.height, 200, 200, 1);\r\n                    let preview = BB.canvas(thumbDimensions.width, thumbDimensions.height);\r\n                    preview.title = LANG('preview');\r\n                    let spacer = document.createElement(\"div\");\r\n                    spacer.innerHTML = \"<br/>\";\r\n                    spacer.style.clear = \"both\";\r\n                    div.appendChild(spacer);\r\n                    div.appendChild(preview);\r\n                    BB.css(preview, {\r\n                        display: \"block\",\r\n                        marginLeft: \"auto\",\r\n                        marginRight: \"auto\",\r\n                        colorScheme: 'only light',\r\n                    });\r\n                    preview.style.boxShadow = \"0 0 3px rgba(0,0,0,0.5)\";\r\n                    BB.createCheckerDataUrl(4, function(url) {\r\n                        preview.style.backgroundImage = \"url(\" + url + \")\";\r\n                    });\r\n\r\n                    let alphaCanvas = BB.copyCanvas(preview);\r\n                    alphaCanvas.getContext(\"2d\").drawImage(p.topCanvas, 0, 0, alphaCanvas.width, alphaCanvas.height);\r\n                    BB.convertToAlphaChannelCanvas(alphaCanvas);\r\n\r\n                    function update() {\r\n                        let ctx = preview.getContext(\"2d\");\r\n                        ctx.save();\r\n                        ctx.clearRect(0, 0, preview.width, preview.height);\r\n                        if (preview.width > p.topCanvas.width) {\r\n                            ctx.imageSmoothingEnabled = false;\r\n                        }\r\n                        ctx.drawImage(p.bottomCanvas, 0, 0, preview.width, preview.height);\r\n\r\n                        if (options.getValue() === 'as-alpha') {\r\n                            ctx.globalCompositeOperation = 'destination-in';\r\n                            ctx.globalAlpha = p.topOpacity;\r\n                            ctx.drawImage(alphaCanvas, 0, 0, preview.width, preview.height);\r\n                        } else {\r\n                            ctx.globalCompositeOperation = options.getValue();\r\n                            ctx.globalAlpha = p.topOpacity;\r\n                            ctx.drawImage(p.topCanvas, 0, 0, preview.width, preview.height);\r\n                        }\r\n                        ctx.restore();\r\n                    }\r\n\r\n                    update();\r\n\r\n\r\n                    let keyListener = new BB.KeyListener({\r\n                        onDown: function(keyStr) {\r\n                            if (keyStr === 'right') {\r\n                                options.next();\r\n                            }\r\n                            if (keyStr === 'left') {\r\n                                options.previous();\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    popup({\r\n                        target: p_rootDiv,\r\n                        message: `<b>${LANG('layers-merge-modal-title')}</b>`,\r\n                        div: div,\r\n                        buttons: [\"Ok\", \"Cancel\"],\r\n                        clickOnEnter: 'Ok',\r\n                        callback: function (val) {\r\n                            keyListener.destroy();\r\n                            options.destroy();\r\n                            if (val === \"Ok\") {\r\n                                p.callback(options.getValue());\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n                mergeDialog({\r\n                    topCanvas: klCanvasLayerArr[selectedSpotIndex].context.canvas,\r\n                    bottomCanvas: klCanvasLayerArr[selectedSpotIndex - 1].context.canvas,\r\n                    topOpacity: klCanvas.getLayer(selectedSpotIndex).opacity,\r\n                    mixModeStr: klCanvasLayerArr[selectedSpotIndex].mixModeStr,\r\n                    callback: function (mode) {\r\n                        klCanvas.mergeLayers(selectedSpotIndex, selectedSpotIndex - 1, mode);\r\n                        klCanvasLayerArr = klCanvas.getLayers();\r\n                        selectedSpotIndex--;\r\n                        if (klCanvasLayerArr.length === 1) {\r\n                            removeBtn.disabled = true;\r\n                        }\r\n                        if (klCanvasLayerArr.length < MAX_LAYERS) {\r\n                            addnewBtn.disabled = false;\r\n                            duplicateBtn.disabled = false;\r\n                        }\r\n                        createLayerList();\r\n                        klHistory.pause(true);\r\n                        updatefunc(selectedSpotIndex);\r\n                        klHistory.pause(false);\r\n                    }\r\n                });\r\n            };\r\n\r\n            renameBtn.onclick = function () {\r\n                renameLayer(selectedSpotIndex);\r\n            };\r\n        }\r\n        setTimeout(async, 1);\r\n        return div;\r\n    }\r\n    div.appendChild(createButtons());\r\n\r\n    let modeWrapper;\r\n    let modeSelect;\r\n    {\r\n        modeWrapper = BB.el({\r\n            content: LANG('layers-blending') + '&nbsp;',\r\n            css: {\r\n                fontSize: '15px'\r\n            }\r\n        });\r\n\r\n        modeSelect = new Select({\r\n            optionArr: [\r\n                'source-over',\r\n                null,\r\n                'darken',\r\n                'multiply',\r\n                'color-burn',\r\n                null,\r\n                'lighten',\r\n                'screen',\r\n                'color-dodge',\r\n                null,\r\n                'overlay',\r\n                'soft-light',\r\n                'hard-light',\r\n                null,\r\n                'difference',\r\n                'exclusion',\r\n                null,\r\n                'hue',\r\n                'saturation',\r\n                'color',\r\n                'luminosity',\r\n            ].map((item: IMixMode) => {\r\n                return item ? [item, translateBlending(item)] : null;\r\n            }),\r\n            onChange: function(val) {\r\n                klCanvas.setMixMode(selectedSpotIndex, val as IMixMode);\r\n                (div as any).update(selectedSpotIndex);\r\n            },\r\n            css: {\r\n                marginBottom: '10px'\r\n            }\r\n        });\r\n\r\n        modeWrapper.appendChild(modeSelect.getElement());\r\n        div.appendChild(modeWrapper);\r\n\r\n    }\r\n\r\n\r\n    function createLayerList() {\r\n        oldHistoryState = klHistory.getState();\r\n        function createLayerEntry(index) {\r\n            let layerName = klCanvas.getLayer(index).name;\r\n            let opacity = klCanvasLayerArr[index].opacity;\r\n            let layercanvas = klCanvasLayerArr[index].context.canvas;\r\n\r\n            let layer = document.createElement(\"div\");\r\n            layer.className = \"layerBox\";\r\n            layerElArr[index] = layer;\r\n            (layer as any).posY = ((klCanvasLayerArr.length - 1) * 35 - index * 35);\r\n            BB.css(layer, {\r\n                width: \"250px\",\r\n                height: \"34px\",\r\n                backgroundColor: \"rgb( 220, 220, 220)\",\r\n                border: \"1px solid #aaa\",\r\n                position: \"absolute\",\r\n                left: \"0 px\",\r\n                top: (layer as any).posY + \"px\",\r\n                transition: \"all 0.1s linear\",\r\n                borderRadius: \"5px\",\r\n                boxSizing: 'border-box'\r\n            });\r\n            let innerLayer = document.createElement(\"div\");\r\n            BB.css(innerLayer, {\r\n                position: \"relative\"\r\n            });\r\n\r\n            let container1 = document.createElement(\"div\");\r\n            BB.css(container1, {\r\n                width: \"250px\",\r\n                height: \"34px\"\r\n            });\r\n            let container2 = document.createElement(\"div\");\r\n            layer.appendChild(innerLayer);\r\n            innerLayer.appendChild(container1);\r\n            innerLayer.appendChild(container2);\r\n\r\n            (layer as any).spot = index;\r\n\r\n            //thumb\r\n            {\r\n                let thumbDimensions = BB.fitInto(layercanvas.width, layercanvas.height, 30, 30, 1);\r\n                let thumb = (layer as any).thumb = BB.canvas(thumbDimensions.width, thumbDimensions.height);\r\n\r\n                let thc = thumb.getContext(\"2d\");\r\n                thc.save();\r\n                if (thumb.width > layercanvas.width) {\r\n                    thc.imageSmoothingEnabled = false;\r\n                }\r\n                thc.drawImage(layercanvas, 0, 0, thumb.width, thumb.height);\r\n                thc.restore();\r\n                BB.css((layer as any).thumb, {\r\n                    position: \"absolute\",\r\n                    left: ((32 - (layer as any).thumb.width) / 2) + \"px\",\r\n                    top: ((32 - (layer as any).thumb.height) / 2) + \"px\",\r\n                    colorScheme: 'only light',\r\n                });\r\n                BB.createCheckerDataUrl(4, function(url) {\r\n                    thumb.style.backgroundImage = \"url(\" + url + \")\";\r\n                });\r\n            }\r\n\r\n            //layerlabel\r\n            {\r\n                (layer as any).label = document.createElement(\"div\");\r\n                (layer as any).lname = layerName;\r\n                (layer as any).label.append((layer as any).lname);\r\n\r\n                BB.css((layer as any).label, {\r\n                    position: \"absolute\",\r\n                    left: (1 + 32 + 5) + \"px\",\r\n                    top: 1 + \"px\",\r\n                    fontSize: \"13px\",\r\n                    width: \"170px\",\r\n                    height: \"20px\",\r\n                    overflow: \"hidden\",\r\n                    color: \"#666\",\r\n                    whiteSpace: 'nowrap'\r\n                });\r\n\r\n                (layer as any).label.ondblclick = function() {\r\n                    renameLayer((layer as any).spot);\r\n                };\r\n            }\r\n            //layerlabel\r\n            {\r\n                (layer as any).opacityLabel = document.createElement(\"div\");\r\n                (layer as any).opacity = opacity;\r\n                (layer as any).opacityLabel.append(parseInt('' + ((layer as any).opacity * 100)) + \"%\");\r\n\r\n                BB.css((layer as any).opacityLabel, {\r\n                    position: \"absolute\",\r\n                    left: (250 - 1 - 5 - 50) + \"px\",\r\n                    top: 1 + \"px\",\r\n                    fontSize: \"13px\",\r\n                    textAlign: \"right\",\r\n                    width: \"50px\",\r\n                    color: \"#666\",\r\n                    transition: \"color 0.2s ease-in-out\"\r\n                });\r\n            }\r\n\r\n            let oldOpacity;\r\n            let opacitySlider = new PointSlider({\r\n                init: (layer as any).opacity,\r\n                width: 204,\r\n                pointSize: 14,\r\n                callback: function(sliderValue, isFirst, isLast) {\r\n                    if (isFirst) {\r\n                        oldOpacity = klCanvas.getLayer((layer as any).spot).opacity;\r\n                        klHistory.pause(true);\r\n                        return;\r\n                    }\r\n                    if (isLast) {\r\n                        klHistory.pause(false);\r\n                        if (oldOpacity !== sliderValue) {\r\n                            klCanvas.layerOpacity((layer as any).spot, sliderValue);\r\n                        }\r\n                        return;\r\n                    }\r\n                    (layer as any).opacityLabel.innerHTML = Math.round(sliderValue * 100) + \"%\";\r\n                    klCanvas.layerOpacity((layer as any).spot, sliderValue);\r\n                }\r\n            });\r\n            BB.css(opacitySlider.getEl(), {\r\n                position: 'absolute',\r\n                left: '39px',\r\n                top: '17px'\r\n            });\r\n            (layer as any).opacitySlider = opacitySlider;\r\n\r\n            //larger layer preview - hover\r\n            BB.setEventListener((layer as any).thumb, 'onpointerover', function (e) {\r\n                if (e.buttons !== 0 && (!e.pointerType || e.pointerType !== 'touch')) { //shouldn't show while dragging\r\n                    return;\r\n                }\r\n\r\n                let thumbDimensions = BB.fitInto(layercanvas.width, layercanvas.height, 250, 250, 1);\r\n\r\n                if (largeThumbCanvas.width !== thumbDimensions.width || largeThumbCanvas.height !== thumbDimensions.height) {\r\n                    largeThumbCanvas.width = thumbDimensions.width;\r\n                    largeThumbCanvas.height = thumbDimensions.height;\r\n                }\r\n                let ctx = largeThumbCanvas.getContext(\"2d\");\r\n                ctx.save();\r\n                if (largeThumbCanvas.width > layercanvas.width) {\r\n                    ctx.imageSmoothingEnabled = false;\r\n                }\r\n                ctx.imageSmoothingQuality = 'high';\r\n                ctx.clearRect(0, 0, largeThumbCanvas.width, largeThumbCanvas.height);\r\n                ctx.drawImage(layercanvas, 0, 0, largeThumbCanvas.width, largeThumbCanvas.height);\r\n                ctx.restore();\r\n                BB.css(largeThumbDiv, {\r\n                    top: (e.clientY - largeThumbCanvas.height / 2) + \"px\",\r\n                    opacity: '0'\r\n                });\r\n                if (largeThumbInDocument === false) {\r\n                    document.body.appendChild(largeThumbDiv);\r\n                    largeThumbInDocument = true;\r\n                }\r\n                clearTimeout(largeThumbInTimeout);\r\n                largeThumbInTimeout = setTimeout(function () {\r\n                    BB.css(largeThumbDiv, {\r\n                        opacity: '1'\r\n                    });\r\n                }, 20);\r\n                clearTimeout(largeThumbTimeout);\r\n            });\r\n            BB.setEventListener((layer as any).thumb, 'onpointerout', function () {\r\n                clearTimeout(largeThumbInTimeout);\r\n                BB.css(largeThumbDiv, {\r\n                    opacity: '0'\r\n                });\r\n                clearTimeout(largeThumbTimeout);\r\n                largeThumbTimeout = setTimeout(function () {\r\n                    if (!largeThumbInDocument) {\r\n                        return;\r\n                    }\r\n                    document.body.removeChild(largeThumbDiv);\r\n                    largeThumbInDocument = false;\r\n                }, 300);\r\n            });\r\n\r\n            container1.appendChild((layer as any).thumb);\r\n            container1.appendChild((layer as any).label);\r\n            container1.appendChild((layer as any).opacityLabel);\r\n            container1.appendChild(opacitySlider.getEl());\r\n            let dragstart = false;\r\n            let freshSelection = false;\r\n\r\n            //events for moving layers up and down\r\n            function dragEventHandler(event) {\r\n                if (event.type === 'pointerdown' && event.button === 'left') {\r\n                    BB.css(layer, {\r\n                        transition: \"box-shadow 0.3s ease-in-out\"\r\n                    });\r\n                    //dragContainer.appendChild(layer);\r\n                    layer.style.zIndex = '1';\r\n                    lastpos = (layer as any).spot;\r\n                    freshSelection = false;\r\n                    if (!(layer as any).isSelected) {\r\n                        freshSelection = true;\r\n                        (div as any).activateLayer((layer as any).spot);\r\n                    }\r\n                    dragstart = true;\r\n\r\n                } else if (event.type === 'pointermove' && event.button === 'left') {\r\n\r\n                    if (dragstart) {\r\n                        dragstart = false;\r\n                        BB.css(layer, {\r\n                            boxShadow: \"1px 3px 5px rgba(0,0,0,0.4)\"\r\n                        });\r\n                    }\r\n                    (layer as any).posY += event.dY;\r\n                    let corrected = Math.max(0, Math.min((klCanvasLayerArr.length - 1) * (35), (layer as any).posY));\r\n                    layer.style.top = corrected + \"px\";\r\n                    updateLayersVerticalPosition((layer as any).spot, posToSpot((layer as any).posY));\r\n\r\n                }\r\n                if (event.type === 'pointerup') {\r\n                    BB.css(layer, {\r\n                        transition: \"all 0.1s linear\"\r\n                    });\r\n                    setTimeout(function () {\r\n                        BB.css(layer, {\r\n                            boxShadow: \"\"\r\n                        });\r\n                    }, 20);\r\n                    (layer as any).posY = Math.max(0, Math.min((klCanvasLayerArr.length - 1) * (35), (layer as any).posY));\r\n                    //regularContainer.appendChild(layer);\r\n                    layer.style.zIndex = \"\";\r\n                    let newSpot = posToSpot((layer as any).posY);\r\n                    let oldSpot = (layer as any).spot;\r\n                    move((layer as any).spot, newSpot);\r\n                    if (oldSpot != newSpot) {\r\n                        klHistory.pause(true);\r\n                        updatefunc(selectedSpotIndex);\r\n                        klHistory.pause(false);\r\n                    }\r\n                    if (oldSpot === newSpot && freshSelection) {\r\n                        updatefunc(selectedSpotIndex);\r\n                    }\r\n                    freshSelection = false;\r\n                }\r\n            }\r\n\r\n            (layer as any).pointerListener = new BB.PointerListener({\r\n                target: container1,\r\n                maxPointers: 1,\r\n                onPointer: dragEventHandler\r\n            });\r\n\r\n            layerListEl.appendChild(layer);\r\n        }\r\n        layerElArr = [];\r\n        while (layerListEl.firstChild) {\r\n            let child = layerListEl.firstChild;\r\n            (child as any).pointerListener.destroy();\r\n            (child as any).opacitySlider.destroy();\r\n            layerListEl.removeChild(child);\r\n        }\r\n        for (let i = 0; i < klCanvasLayerArr.length; i++) {\r\n            createLayerEntry(i);\r\n        }\r\n        (div as any).activateLayer(selectedSpotIndex);\r\n        updateHeight();\r\n    }\r\n\r\n\r\n    listdiv.appendChild(layerListEl);\r\n    div.appendChild(listdiv);\r\n\r\n\r\n    function posToSpot(p) {\r\n        let result = parseInt('' + ((p) / (layerHeight + layerSpacing) + 0.5));\r\n        result = Math.min(klCanvasLayerArr.length - 1, Math.max(0, result));\r\n        result = klCanvasLayerArr.length - result - 1;\r\n        return result;\r\n    }\r\n\r\n    let lastpos = 0;\r\n\r\n    //update css position of all layers that are not being dragged, while dragging\r\n    function updateLayersVerticalPosition(id, newspot) {\r\n        newspot = Math.min(klCanvasLayerArr.length - 1, Math.max(0, newspot));\r\n        if (newspot === lastpos) {\r\n            return;\r\n        }\r\n        for (let i = 0; i < klCanvasLayerArr.length; i++) {\r\n            if (layerElArr[i].spot === id) { // <- here\r\n                continue;\r\n            }\r\n            let posy = layerElArr[i].spot;\r\n            if (layerElArr[i].spot > id) {\r\n                posy--;\r\n            }\r\n            if (posy >= newspot) {\r\n                posy++;\r\n            }\r\n            layerElArr[i].posY = (layerHeight + layerSpacing) * (klCanvasLayerArr.length - posy - 1);\r\n            layerElArr[i].style.top = layerElArr[i].posY + \"px\";\r\n        }\r\n        lastpos = newspot;\r\n    }\r\n\r\n    function move(oldSpotIndex, newSpotIndex) {\r\n        if (isNaN(oldSpotIndex) || isNaN(newSpotIndex)) {\r\n            throw 'layermanager - invalid move';\r\n        }\r\n        for (let i = 0; i < klCanvasLayerArr.length; i++) {\r\n            (function (i) {\r\n                let posy = layerElArr[i].spot; // <- here\r\n                if (layerElArr[i].spot === oldSpotIndex) {\r\n                    posy = newSpotIndex;\r\n                } else {\r\n                    if (layerElArr[i].spot > oldSpotIndex)\r\n                        posy--;\r\n                    if (posy >= newSpotIndex)\r\n                        posy++;\r\n                }\r\n                layerElArr[i].spot = posy;\r\n                layerElArr[i].posY = (layerHeight + layerSpacing) * (klCanvasLayerArr.length - posy - 1);\r\n                layerElArr[i].style.top = layerElArr[i].posY + \"px\";\r\n            }(i));\r\n        }\r\n        if (oldSpotIndex === newSpotIndex) {\r\n            return;\r\n        }\r\n        klCanvas.moveLayer(selectedSpotIndex, newSpotIndex - oldSpotIndex);\r\n        klCanvasLayerArr = klCanvas.getLayers();\r\n        selectedSpotIndex = newSpotIndex;\r\n        mergeBtn.disabled = selectedSpotIndex === 0;\r\n    }\r\n\r\n\r\n    //updating the thumbs in interval\r\n    //don't update when: manager not visible || layer didn't change || is drawing\r\n    let updateThumbsInterval = setInterval(function() {\r\n        if (div.style.display !== \"block\") {\r\n            return;\r\n        }\r\n\r\n        let historyState = klHistory.getState();\r\n        if (historyState === oldHistoryState) {\r\n            return;\r\n        }\r\n        oldHistoryState = historyState;\r\n\r\n        for (let i = 0; i < layerElArr.length; i++) {\r\n            if (selectedSpotIndex === layerElArr[i].spot && klCanvasLayerArr[layerElArr[i].spot]) { // second check, because might be out of date\r\n                let ctx = layerElArr[i].thumb.getContext(\"2d\");\r\n                ctx.save();\r\n                ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n                if (klCanvasLayerArr[layerElArr[i].spot].context.canvas.width < layerElArr[i].thumb.width) {\r\n                    ctx.imageSmoothingEnabled = false;\r\n                }\r\n                ctx.drawImage(klCanvasLayerArr[layerElArr[i].spot].context.canvas, 0, 0, layerElArr[i].thumb.width, layerElArr[i].thumb.height);\r\n                ctx.restore();\r\n            }\r\n        }\r\n\r\n    }, 1);\r\n\r\n    function updateHeight() {\r\n        layerListEl.style.height = (layerElArr.length * 35) + 'px';\r\n    }\r\n\r\n    // ---- interface ----\r\n\r\n    (div as any).update = function (activeLayerSpotIndex) {\r\n        klCanvasLayerArr = klCanvas.getLayers();\r\n        if (activeLayerSpotIndex || activeLayerSpotIndex === 0) {\r\n            selectedSpotIndex = activeLayerSpotIndex;\r\n        }\r\n        removeBtn.disabled = klCanvasLayerArr.length === 1;\r\n        if (klCanvasLayerArr.length === MAX_LAYERS) {\r\n            addnewBtn.disabled = true;\r\n            duplicateBtn.disabled = true;\r\n        } else {\r\n            addnewBtn.disabled = false;\r\n            duplicateBtn.disabled = false;\r\n        }\r\n        setTimeout(function() {\r\n            createLayerList();\r\n        }, 1);\r\n    };\r\n    (div as any).getSelected = function () {\r\n        return selectedSpotIndex;\r\n    };\r\n    (div as any).activateLayer = function (spotIndex) {\r\n        if (spotIndex < 0 || spotIndex > layerElArr.length - 1) {\r\n            throw 'invalid spotIndex ' + spotIndex + ', layerElArr.length ' + layerElArr.length;\r\n        }\r\n        selectedSpotIndex = spotIndex;\r\n        modeSelect.setValue(klCanvasLayerArr[selectedSpotIndex].mixModeStr);\r\n        for (let i = 0; i < layerElArr.length; i++) {\r\n            if (selectedSpotIndex === layerElArr[i].spot) {\r\n                layerElArr[i].style.backgroundColor = \"rgb( 250, 250, 250)\";\r\n                layerElArr[i].label.style.color = \"#000\";\r\n                layerElArr[i].style.boxShadow = \"\";\r\n                layerElArr[i].style.border = \"1px solid var(--active-highlight-color)\";\r\n                layerElArr[i].opacitySlider.setActive(true);\r\n                layerElArr[i].isSelected = true;\r\n            } else {\r\n                layerElArr[i].style.backgroundColor = \"rgb( 220, 220, 220)\";\r\n                layerElArr[i].label.style.color = \"#666\";\r\n                layerElArr[i].style.boxShadow = \"\";\r\n                layerElArr[i].style.border = \"1px solid rgb(158, 158, 158)\";\r\n                layerElArr[i].opacitySlider.setActive(false);\r\n                layerElArr[i].isSelected = false;\r\n            }\r\n        }\r\n        mergeBtn.disabled = selectedSpotIndex === 0;\r\n    };\r\n    (div as any).setUiState = function(stateStr) {\r\n        uiState = '' + stateStr;\r\n\r\n        if (uiState === 'left') {\r\n            BB.css(largeThumbDiv, {\r\n                left: '280px',\r\n                right: ''\r\n            });\r\n        } else {\r\n            BB.css(largeThumbDiv, {\r\n                left: '',\r\n                right: '280px'\r\n            });\r\n        }\r\n    };\r\n\r\n    createLayerList();\r\n\r\n    return div;\r\n}\r\n","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"1mb1v\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"11KJK\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"floUo\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"kino6\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"hhQeq\");","import {BB} from '../../bb/bb';\r\nimport {floodFillBits} from '../image-operations/flood-fill';\r\nimport {drawShape} from '../image-operations/shape-tool';\r\nimport {IRenderTextParam, renderText} from '../image-operations/render-text';\r\nimport {IKlProject, IMixMode, IRGB, IShapeToolObject} from '../kl.types';\r\nimport {DecoyKlHistory, KlHistoryInterface} from '../history/kl-history';\r\nimport {drawProject} from './draw-project';\r\nimport {LANG} from '../../language/language';\r\n\r\n\r\nconst allowedMixModes = [\r\n    'source-over',\r\n    'darken',\r\n    'multiply',\r\n    'color-burn',\r\n    'lighten',\r\n    'screen',\r\n    'color-dodge',\r\n    'overlay',\r\n    'soft-light',\r\n    'hard-light',\r\n    'difference',\r\n    'exclusion',\r\n    'hue',\r\n    'saturation',\r\n    'color',\r\n    'luminosity',\r\n];\r\n\r\nexport const MAX_LAYERS = 16;\r\n\r\ninterface KlCanvasLayer extends HTMLCanvasElement {\r\n    name: string;\r\n    mixModeStr: IMixMode;\r\n    opacity: number;\r\n    compositeObj?: {\r\n        draw: (ctx: CanvasRenderingContext2D) => void;\r\n    },\r\n    index: number; // certain brushes need to know\r\n}\r\n\r\n/**\r\n * The image/canvas that the user paints on\r\n * Has layers. layers have names and opacity.\r\n *\r\n * Interacts with the history you specify (for undo/redo)\r\n */\r\nexport class KlCanvas {\r\n\r\n    // todo changeListener consistent concept\r\n    // todo history interaction, consistent concept - currently have to look at code to know if something pushes on history\r\n\r\n    private width: number;\r\n    private height: number;\r\n    private layerCanvasArr: KlCanvasLayer[];\r\n    private pickCanvas: HTMLCanvasElement; // canvas to draw into for color picker\r\n    private history: KlHistoryInterface;\r\n    private changeListenerArr:  (() => void)[]; // subscribers get notified when opacity changes\r\n\r\n\r\n    private init (w: number, h: number): void {\r\n        if (!w || !h || isNaN(w) || isNaN(h) || w < 1 || h < 1) {\r\n            throw new Error('init - invalid canvas size');\r\n        }\r\n        this.width = w;\r\n        this.height = h;\r\n    }\r\n\r\n    private emitChange (): void {\r\n        // some changes don't get captured by the history - e.g. changing opacity as the user drags the slider\r\n        this.changeListenerArr.forEach(item => item());\r\n    }\r\n\r\n    private updateIndices (): void {\r\n        this.layerCanvasArr.forEach((item, index) => {\r\n            item.index = index;\r\n        });\r\n    }\r\n\r\n    // ---- public ----\r\n\r\n    constructor (\r\n        params: {\r\n            projectObj: {\r\n                width: number;\r\n                height: number;\r\n                layers: {\r\n                    name: string;\r\n                    opacity: number;\r\n                    image: HTMLImageElement | HTMLCanvasElement; // already loaded!\r\n                }[];\r\n            }\r\n        } | {\r\n            // creates blank KlCanvas, 0 layers\r\n            width: number;\r\n            height: number;\r\n        } | {\r\n            copy: KlCanvas;\r\n        },\r\n        private layerNrOffset: number = 0,\r\n    ) {\r\n        this.layerCanvasArr = [];\r\n        this.pickCanvas = BB.canvas(1, 1);\r\n        this.history = new DecoyKlHistory();\r\n        if ('copy' in params) {\r\n            this.width = 1;\r\n            this.height = 1;\r\n        } else {\r\n            if ('width' in params && 'height' in params) {\r\n                this.width = params.width;\r\n                this.height = params.height;\r\n            } else {\r\n                this.width = 1;\r\n                this.height = 1;\r\n            }\r\n        }\r\n        this.init(this.width, this.height);\r\n\r\n        this.changeListenerArr = [];\r\n\r\n        if ('copy' in params) {\r\n            try {\r\n                this.copy(params.copy);\r\n            } catch (e) {\r\n                this.destroy();\r\n                throw e;\r\n            }\r\n        } else if ('projectObj' in params) {\r\n            const origLayers = [].concat(params.projectObj.layers);\r\n            this.init(params.projectObj.width, params.projectObj.height);\r\n\r\n            if (!origLayers.length) {\r\n                throw new Error('project.layers needs at least 1 layer');\r\n            }\r\n\r\n            for (let i = 0; i < origLayers.length; i++) {\r\n                if (origLayers[i].mixModeStr && !allowedMixModes.includes(origLayers[i].mixModeStr)) {\r\n                    throw new Error('unknown mixModeStr ' + origLayers[i].mixModeStr);\r\n                }\r\n\r\n                this.addLayer();\r\n                this.layerOpacity(i, origLayers[i].opacity);\r\n                this.layerCanvasArr[i].name = origLayers[i].name;\r\n                this.layerCanvasArr[i].mixModeStr = origLayers[i].mixModeStr ? origLayers[i].mixModeStr : 'source-over';\r\n                this.layerCanvasArr[i].getContext(\"2d\").drawImage(origLayers[i].image, 0, 0);\r\n            }\r\n        }\r\n        this.updateIndices();\r\n    }\r\n\r\n    setHistory (h: KlHistoryInterface): void {\r\n        this.history = h;\r\n    }\r\n\r\n    /**\r\n     * Resets canvas -> 1 layer, 100% opacity,\r\n     * unless layers provided.\r\n     * @param p\r\n     */\r\n    reset (\r\n        p: {\r\n            width: number;\r\n            height: number;\r\n            color?: IRGB; // optional - fill color\r\n            image?: HTMLImageElement | HTMLCanvasElement; // image drawn on layer\r\n            layerName?: string; // if via image\r\n            layers?: {\r\n                name: string;\r\n                opacity: number;\r\n                mixModeStr: IMixMode;\r\n                image: HTMLCanvasElement;\r\n            }[];\r\n        }\r\n    ): void | number {\r\n        if (!p.width || !p.height || p.width < 1 || p.height < 1 || isNaN(p.width) || isNaN(p.height) ) {\r\n            throw new Error('invalid canvas size');\r\n        }\r\n\r\n        this.history.pause(true);\r\n\r\n        this.width = p.width;\r\n        this.height = p.height;\r\n\r\n        this.layerCanvasArr.splice(1, Math.max(0, this.layerCanvasArr.length - 1));\r\n\r\n        if (p.layers) {\r\n            for (let i = 0; i < p.layers.length; i++) {\r\n                let item = p.layers[i];\r\n                if (!this.layerCanvasArr[i]) {\r\n                    this.addLayer();\r\n                }\r\n                this.layerCanvasArr[i].name = item.name;\r\n                this.layerCanvasArr[i].width = this.width;\r\n                this.layerCanvasArr[i].height = this.height;\r\n                this.layerCanvasArr[i].mixModeStr = item.mixModeStr ? item.mixModeStr : 'source-over';\r\n                this.layerCanvasArr[i].getContext(\"2d\").drawImage(item.image, 0, 0);\r\n                this.layerOpacity(i, item.opacity);\r\n            }\r\n        } else {\r\n            this.layerCanvasArr[0].name = p.layerName ? p.layerName : LANG('layers-layer') + \" 1\";\r\n            this.layerCanvasArr[0].width = this.width;\r\n            this.layerCanvasArr[0].height = this.height;\r\n            this.layerCanvasArr[0].mixModeStr = 'source-over';\r\n            this.layerOpacity(0, 1);\r\n            if (p.color) {\r\n                this.layerFill(0, p.color);\r\n            } else if (p.image) {\r\n                this.layerCanvasArr[0].getContext(\"2d\").drawImage(p.image, 0, 0);\r\n            }\r\n        }\r\n        this.updateIndices();\r\n\r\n        this.history.pause(false);\r\n\r\n        this.history.push({\r\n            tool: [\"canvas\"],\r\n            action: \"reset\",\r\n            params: [p] // dont screw with p\r\n        });\r\n\r\n        return this.layerCanvasArr.length - 1;\r\n    }\r\n\r\n    isLayerLimitReached (): boolean {\r\n        return this.layerCanvasArr.length >= MAX_LAYERS;\r\n    }\r\n\r\n    getWidth (): number {\r\n        return this.width;\r\n    }\r\n\r\n    getHeight (): number {\r\n        return this.height;\r\n    }\r\n\r\n    copy (toCopyCanvas: KlCanvas): void {\r\n        if (\r\n            toCopyCanvas.getWidth() < 1 ||\r\n            toCopyCanvas.getHeight() < 1 ||\r\n            isNaN(toCopyCanvas.getWidth()) ||\r\n            isNaN(toCopyCanvas.getHeight())\r\n        ) {\r\n            throw new Error('invalid canvas size');\r\n        }\r\n\r\n        // keep existing canvases\r\n\r\n        let origLayers = toCopyCanvas.getLayers();\r\n\r\n        while (this.layerCanvasArr.length > origLayers.length) {\r\n            this.removeLayer(this.layerCanvasArr.length - 1);\r\n        }\r\n\r\n        if (toCopyCanvas.getWidth() != this.width || toCopyCanvas.getHeight() != this.height) {\r\n            this.init(toCopyCanvas.getWidth(), toCopyCanvas.getHeight());\r\n        }\r\n        for (let i = 0; i < origLayers.length; i++) {\r\n            if (i >= this.layerCanvasArr.length) {\r\n                this.addLayer();\r\n            } else {\r\n                this.layerCanvasArr[i].width = this.width;\r\n                this.layerCanvasArr[i].height = this.height;\r\n            }\r\n            this.layerOpacity(i, origLayers[i].opacity);\r\n            this.layerCanvasArr[i].name = origLayers[i].name;\r\n            this.layerCanvasArr[i].mixModeStr = origLayers[i].mixModeStr;\r\n            this.layerCanvasArr[i].getContext(\"2d\").drawImage(origLayers[i].context.canvas, 0, 0);\r\n        }\r\n        this.updateIndices();\r\n    }\r\n\r\n    getLayerCount (): number {\r\n        return this.layerCanvasArr.length;\r\n    }\r\n\r\n    resize (w: number, h: number, algorithm: 'smooth' | 'pixelated' = 'smooth'): boolean {\r\n        if (!w || !h || (w === this.width && h === this.height) || isNaN(w) || isNaN(h) || w < 1 || h < 1) {\r\n            return false;\r\n        }\r\n        w = Math.max(w, 1);\r\n        h = Math.max(h, 1);\r\n\r\n        let tmp1, tmp2;\r\n\r\n        if (algorithm === 'pixelated') {\r\n            tmp1 = BB.canvas(w, h);\r\n            let tmp1Ctx = tmp1.getContext('2d');\r\n            tmp1Ctx.imageSmoothingEnabled = false;\r\n            for (let i = 0; i < this.layerCanvasArr.length; i++) {\r\n                if (i > 0) {\r\n                    tmp1Ctx.clearRect(0, 0, w, h);\r\n                }\r\n                let layerCanvas = this.layerCanvasArr[i];\r\n                tmp1Ctx.drawImage(layerCanvas, 0, 0, w, h);\r\n                layerCanvas.width = w;\r\n                layerCanvas.height = h;\r\n                let layerContext = layerCanvas.getContext('2d');\r\n                layerContext.drawImage(tmp1, 0, 0);\r\n            }\r\n\r\n        } else if (algorithm === 'smooth') {\r\n            tmp1 = BB.canvas();\r\n            tmp2 = BB.canvas();\r\n            for (let i = 0; i < this.layerCanvasArr.length; i++) {\r\n                BB.resizeCanvas(this.layerCanvasArr[i], w, h, tmp1, tmp2);\r\n            }\r\n        } else {\r\n            throw new Error('unknown resize algorithm');\r\n        }\r\n\r\n        this.width = w;\r\n        this.height = h;\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * crop / extend\r\n     * @param p\r\n     */\r\n    resizeCanvas (p: {\r\n        left: number;\r\n        top: number;\r\n        right: number;\r\n        bottom: number;\r\n        fillColor?: IRGB\r\n    }): void {\r\n\r\n        const newW = Math.round(p.left) + this.width + Math.round(p.right);\r\n        const newH = Math.round(p.top) + this.height + Math.round(p.bottom);\r\n        const offX = Math.round(p.left);\r\n        const offY = Math.round(p.top);\r\n\r\n        if (isNaN(newW) || isNaN(newH) || newW < 1 || newH < 1) {\r\n            throw new Error('KlCanvas.resizeCanvas - invalid canvas size');\r\n        }\r\n\r\n        for (let i = 0; i < this.layerCanvasArr.length; i++) {\r\n            const ctemp = BB.canvas(this.width, this.height);\r\n            let layerCanvas = this.layerCanvasArr[i];\r\n            let layerCtx = this.layerCanvasArr[i].getContext(\"2d\");\r\n            ctemp.getContext(\"2d\").drawImage(layerCanvas, 0, 0);\r\n\r\n            this.layerCanvasArr[i].width = newW;\r\n            this.layerCanvasArr[i].height = newH;\r\n\r\n            layerCtx.save();\r\n            if (i === 0 && p.fillColor) {\r\n                layerCtx.fillStyle = BB.ColorConverter.toRgbStr(p.fillColor);\r\n                layerCtx.fillRect(0, 0, newW, newH);\r\n                layerCtx.clearRect(offX, offY, this.width, this.height);\r\n            }\r\n            layerCtx.drawImage(ctemp, offX, offY);\r\n            layerCtx.restore();\r\n        }\r\n        this.width = newW;\r\n        this.height = newH;\r\n    }\r\n\r\n    /**\r\n     * will be inserted on top of selected\r\n     * @param selected\r\n     */\r\n    addLayer (selected?: number): false | number {\r\n        if (this.isLayerLimitReached()) {\r\n            return false;\r\n        }\r\n        let canvas = BB.canvas(this.width, this.height);\r\n        if (!canvas.getContext('2d')) {\r\n            throw new Error('kl-create-canvas-error');\r\n        }\r\n\r\n        (canvas as any).mixModeStr = 'source-over';\r\n\r\n        if (selected === undefined) {\r\n            this.layerCanvasArr[this.layerCanvasArr.length] = canvas as any;\r\n            selected = Math.max(0, this.layerCanvasArr.length - 1);\r\n        } else {\r\n            this.layerCanvasArr.splice(selected + 1, 0, canvas as any);\r\n            selected++;\r\n        }\r\n\r\n        (canvas as any).name = LANG('layers-layer') + \" \" + (this.layerCanvasArr.length + this.layerNrOffset);\r\n        this.history.pause(true);\r\n        this.layerOpacity(selected, 1);\r\n        this.history.pause(false);\r\n        this.updateIndices();\r\n        this.history.push({\r\n            tool: [\"canvas\"],\r\n            action: \"addLayer\",\r\n            params: [selected - 1]\r\n        });\r\n        return selected;\r\n    }\r\n\r\n    duplicateLayer (i: number): false | number {\r\n        if (!this.layerCanvasArr[i] || this.isLayerLimitReached()) {\r\n            return false;\r\n        }\r\n        let canvas = BB.canvas(this.width, this.height);\r\n        this.layerCanvasArr.splice(i + 1, 0, canvas as any);\r\n\r\n        (canvas as any).name = this.layerCanvasArr[i].name + \" \" + LANG('layers-copy');\r\n        (canvas as any).mixModeStr = this.layerCanvasArr[i].mixModeStr;\r\n        canvas.getContext(\"2d\").drawImage(this.layerCanvasArr[i], 0, 0);\r\n        this.history.pause(true);\r\n        this.layerOpacity(i + 1, this.layerCanvasArr[i].opacity);\r\n        this.history.pause(false);\r\n\r\n        this.updateIndices();\r\n\r\n        this.history.push({\r\n            tool: [\"canvas\"],\r\n            action: \"duplicateLayer\",\r\n            params: [i]\r\n        });\r\n        return i + 1;\r\n    }\r\n\r\n    getLayerContext (i: number, doReturnNull?: boolean): CanvasRenderingContext2D | null {\r\n        if (this.layerCanvasArr[i]) {\r\n            return this.layerCanvasArr[i].getContext(\"2d\");\r\n        }\r\n        if (doReturnNull) {\r\n            return null;\r\n        }\r\n        throw new Error(\"layer of index \" + i + \" not found (in \" + this.layerCanvasArr.length + \" layers)\");\r\n    }\r\n\r\n    removeLayer (i: number): false | number {\r\n        if (this.layerCanvasArr[i]) {\r\n            this.layerCanvasArr.splice(i, 1);\r\n            this.updateIndices();\r\n        } else {\r\n            return false;\r\n        }\r\n        this.history.push({\r\n            tool: [\"canvas\"],\r\n            action: \"removeLayer\",\r\n            params: [i]\r\n        });\r\n\r\n        return Math.max(0, i - 1);\r\n    }\r\n\r\n    renameLayer (i: number, name: string): boolean {\r\n        if (this.layerCanvasArr[i]) {\r\n            this.layerCanvasArr[i].name = name;\r\n        } else {\r\n            return false;\r\n        }\r\n\r\n        this.history.push({\r\n            tool: [\"canvas\"],\r\n            action: \"renameLayer\",\r\n            params: [i, name]\r\n        });\r\n\r\n        return true;\r\n    }\r\n\r\n    layerOpacity (i: number, o: number): void {\r\n        if (!this.layerCanvasArr[i]) {\r\n            return;\r\n        }\r\n        o = Math.max(0, Math.min(1, o));\r\n        this.layerCanvasArr[i].opacity = o;\r\n\r\n        this.history.push({\r\n            tool: [\"canvas\"],\r\n            action: \"layerOpacity\",\r\n            params: [i, o]\r\n        });\r\n\r\n        this.emitChange();\r\n    }\r\n\r\n    moveLayer (i: number, d: number): void | number {\r\n        if (d === 0) {\r\n            return;\r\n        }\r\n        if (this.layerCanvasArr[i]) {\r\n            const temp = this.layerCanvasArr[i];\r\n            this.layerCanvasArr.splice(i, 1);\r\n            const targetIndex = Math.max(0, Math.min(i + d, this.layerCanvasArr.length));\r\n            this.layerCanvasArr.splice(targetIndex, 0, temp);\r\n            this.updateIndices();\r\n            this.history.push({\r\n                tool: [\"canvas\"],\r\n                action: \"moveLayer\",\r\n                params: [i, d]\r\n            });\r\n            return targetIndex;\r\n        }\r\n    }\r\n\r\n    mergeLayers (layerBottomIndex: number, layerTopIndex: number, mixModeStr: IMixMode | 'as-alpha'): void | number {\r\n        if (\r\n            !this.layerCanvasArr[layerBottomIndex] ||\r\n            !this.layerCanvasArr[layerTopIndex] ||\r\n            layerBottomIndex === layerTopIndex\r\n        ) {\r\n            return;\r\n        }\r\n        //order messed up\r\n        if (layerBottomIndex > layerTopIndex) {\r\n            let temp = layerBottomIndex;\r\n            layerBottomIndex = layerTopIndex;\r\n            layerTopIndex = temp;\r\n        }\r\n\r\n        let topOpacity = this.layerCanvasArr[layerTopIndex].opacity;\r\n        if (topOpacity !== 0 && topOpacity) {\r\n            let ctx = this.layerCanvasArr[layerBottomIndex].getContext(\"2d\");\r\n            ctx.save();\r\n\r\n            if (mixModeStr === 'as-alpha') { // todo remove this?\r\n\r\n                BB.convertToAlphaChannelCanvas(this.layerCanvasArr[layerTopIndex]);\r\n                ctx.globalCompositeOperation = 'destination-in';\r\n                ctx.globalAlpha = topOpacity;\r\n                this.layerCanvasArr[layerBottomIndex].getContext(\"2d\").drawImage(this.layerCanvasArr[layerTopIndex], 0, 0);\r\n\r\n            } else {\r\n\r\n                if (mixModeStr) {\r\n                    ctx.globalCompositeOperation = mixModeStr;\r\n                }\r\n                ctx.globalAlpha = topOpacity;\r\n                this.layerCanvasArr[layerBottomIndex].getContext(\"2d\").drawImage(this.layerCanvasArr[layerTopIndex], 0, 0);\r\n\r\n            }\r\n\r\n            ctx.restore();\r\n\r\n            // workaround for chrome bug https://bugs.chromium.org/p/chromium/issues/detail?id=1281185\r\n            // TODO remove if chrome updated\r\n            if (mixModeStr) {\r\n                ctx.save();\r\n                ctx.fillStyle = \"rgba(0,0,0,0.01)\";\r\n                ctx.fillRect(-0.9999999, -0.9999999, 1, 1);\r\n                ctx.restore();\r\n            }\r\n        }\r\n        this.updateIndices();\r\n        this.history.pause(true);\r\n        this.removeLayer(layerTopIndex);\r\n        this.history.pause(false);\r\n        this.history.push({\r\n            tool: [\"canvas\"],\r\n            action: \"mergeLayers\",\r\n            params: [layerBottomIndex, layerTopIndex, mixModeStr]\r\n        });\r\n\r\n        return layerBottomIndex;\r\n    }\r\n\r\n    rotate (deg: number): void {\r\n        while (deg < 0) {\r\n            deg += 360;\r\n        }\r\n        deg %= 360;\r\n        if (deg % 90 != 0 || deg === 0)\r\n            return;\r\n        let temp = BB.canvas();\r\n        if (deg === 0 || deg === 180) {\r\n            temp.width = this.width;\r\n            temp.height = this.height;\r\n        } else if (deg === 90 || deg === 270) {\r\n            temp.width = this.height;\r\n            temp.height = this.width;\r\n        }\r\n        let ctx = temp.getContext(\"2d\");\r\n        for (let i = 0; i < this.layerCanvasArr.length; i++) {\r\n            ctx.clearRect(0, 0, temp.width, temp.height);\r\n            ctx.save();\r\n            ctx.translate(temp.width / 2, temp.height / 2);\r\n            ctx.rotate(deg * Math.PI / 180);\r\n            if (deg === 180) {\r\n                ctx.drawImage(this.layerCanvasArr[i], -temp.width / 2, -temp.height / 2);\r\n            } else if (deg === 90 || deg === 270) {\r\n                ctx.drawImage(this.layerCanvasArr[i], -temp.height / 2, -temp.width / 2);\r\n            }\r\n            this.layerCanvasArr[i].width = temp.width;\r\n            this.layerCanvasArr[i].height = temp.height;\r\n            this.layerCanvasArr[i].getContext(\"2d\").clearRect(0, 0, this.layerCanvasArr[i].width, this.layerCanvasArr[i].height);\r\n            this.layerCanvasArr[i].getContext(\"2d\").drawImage(temp, 0, 0);\r\n            ctx.restore();\r\n        }\r\n        this.width = temp.width;\r\n        this.height = temp.height;\r\n    }\r\n\r\n    flip (isHorizontal: boolean, isVertical: boolean, layerIndex: number): void {\r\n        if (!isHorizontal && !isVertical) {\r\n            return;\r\n        }\r\n\r\n        let temp = BB.canvas(this.width, this.height);\r\n        temp.width = this.width;\r\n        temp.height = this.height;\r\n        let tempCtx = temp.getContext(\"2d\");\r\n\r\n        for (let i = 0; i < this.layerCanvasArr.length; i++) {\r\n\r\n            if ( (layerIndex || layerIndex === 0) && i !== layerIndex) {\r\n                continue;\r\n            }\r\n\r\n            tempCtx.save();\r\n            tempCtx.clearRect(0, 0, temp.width, temp.height);\r\n            tempCtx.translate(temp.width / 2, temp.height / 2);\r\n            tempCtx.scale((isHorizontal ? -1 : 1), (isVertical ? -1 : 1));\r\n            tempCtx.drawImage(this.layerCanvasArr[i], -temp.width / 2, -temp.height / 2);\r\n            tempCtx.restore();\r\n\r\n            this.layerCanvasArr[i].getContext(\"2d\").clearRect(0, 0, this.layerCanvasArr[i].width, this.layerCanvasArr[i].height);\r\n            this.layerCanvasArr[i].getContext(\"2d\").drawImage(temp, 0, 0);\r\n        }\r\n    }\r\n\r\n    layerFill (layerIndex: number, colorObj: IRGB, compositeOperation?: string): void {\r\n        let ctx = this.layerCanvasArr[layerIndex].getContext(\"2d\");\r\n        ctx.save();\r\n        if (compositeOperation) {\r\n            ctx.globalCompositeOperation = compositeOperation;\r\n        }\r\n        ctx.fillStyle = \"rgba(\" + colorObj.r + \",\" + colorObj.g + \",\" + colorObj.b + \",1)\";\r\n        ctx.fillRect(0, 0, this.layerCanvasArr[layerIndex].width, this.layerCanvasArr[layerIndex].height);\r\n        ctx.restore();\r\n\r\n        // workaround for chrome bug https://bugs.chromium.org/p/chromium/issues/detail?id=1281185\r\n        // TODO remove if chrome updated\r\n        ctx.save();\r\n        ctx.fillStyle = \"rgba(0,0,0,0.01)\";\r\n        ctx.fillRect(-0.9999999, -0.9999999, 1, 1);\r\n        ctx.restore();\r\n\r\n        /*if (!document.getElementById('testocanvas')) {\r\n            layerCanvasArr[layerIndex].id = 'testocanvas';\r\n            document.body.appendChild(layerCanvasArr[layerIndex]);\r\n            BB.css(layerCanvasArr[layerIndex], {\r\n                position: 'fixed',\r\n                left: '0',\r\n                top: '0',\r\n                zIndex: '1111111',\r\n                transform: 'scale(0.2)',\r\n                border: '10px solid red',\r\n            });\r\n        }\r\n        if (!document.getElementById('testocanvas')) {\r\n            let c = document.createElement('canvas');\r\n            c.width = 1000;\r\n            c.height = 1000;\r\n            let ctx2 = c.getContext('2d');\r\n            ctx2.drawImage(layerCanvasArr[layerIndex], 0, 0);\r\n            c.id = 'testocanvas';\r\n            document.body.appendChild(c);\r\n            BB.css(c, {\r\n                position: 'fixed',\r\n                left: '0',\r\n                top: '0',\r\n                zIndex: '1111111',\r\n                transform: 'scale(0.2)',\r\n                border: '10px solid red',\r\n            });\r\n        }*/\r\n\r\n        this.history.push({\r\n            tool: [\"canvas\"],\r\n            action: \"layerFill\",\r\n            params: [layerIndex, colorObj, compositeOperation]\r\n        });\r\n    }\r\n\r\n    floodFill (\r\n        layerIndex: number, // index of layer to be filled\r\n        x: number, // starting point\r\n        y: number,\r\n        rgb: IRGB, // fill color\r\n        opacity: number,\r\n        tolerance: number,\r\n        sampleStr: 'current' | 'all' | 'above',\r\n        grow: number, // int >= 0 - radius around filled area that is to be filled too\r\n        isContiguous: boolean,\r\n    ): void {\r\n        if (x < 0 || y < 0 || x >= this.width || y >= this.height || opacity === 0) {\r\n            return;\r\n        }\r\n        tolerance = Math.round(tolerance);\r\n\r\n        if (!(['above', 'current', 'all'].includes(sampleStr))) {\r\n            throw new Error('invalid sampleStr');\r\n        }\r\n\r\n        let result;\r\n\r\n        let srcCtx;\r\n        let srcImageData;\r\n        let srcData;\r\n\r\n        let targetCtx;\r\n        let targetImageData;\r\n        let targetData;\r\n\r\n\r\n        if (sampleStr === 'all') {\r\n\r\n            let srcCanvas = this.layerCanvasArr.length === 1 ? this.layerCanvasArr[0] : this.getCompleteCanvas(1);\r\n            srcCtx = srcCanvas.getContext('2d');\r\n            srcImageData = srcCtx.getImageData(0, 0, this.width, this.height);\r\n            srcData = srcImageData.data;\r\n            result = floodFillBits(srcData, this.width, this.height, x, y, tolerance, Math.round(grow), isContiguous);\r\n\r\n            srcCanvas = null;\r\n            srcCtx = null;\r\n            srcImageData = null;\r\n            srcData = null;\r\n\r\n            targetCtx = this.layerCanvasArr[layerIndex].getContext('2d');\r\n            targetImageData = targetCtx.getImageData(0, 0, this.width, this.height);\r\n\r\n        } else {\r\n            let srcIndex = sampleStr === 'above' ? layerIndex + 1 : layerIndex;\r\n\r\n            if (srcIndex >= this.layerCanvasArr.length) {\r\n                return;\r\n            }\r\n\r\n            srcCtx = this.layerCanvasArr[srcIndex].getContext('2d');\r\n            srcImageData = srcCtx.getImageData(0, 0, this.width, this.height);\r\n            srcData = srcImageData.data;\r\n            result = floodFillBits(srcData, this.width, this.height, x, y, tolerance, Math.round(grow), isContiguous);\r\n\r\n            if (layerIndex !== srcIndex) {\r\n                srcCtx = null;\r\n                srcImageData = null;\r\n                srcData = null;\r\n            }\r\n\r\n            targetCtx = layerIndex === srcIndex ? srcCtx : this.layerCanvasArr[layerIndex].getContext('2d');\r\n            targetImageData = layerIndex === srcIndex ? srcImageData : targetCtx.getImageData(0, 0, this.width, this.height);\r\n\r\n        }\r\n\r\n        targetData = targetImageData.data;\r\n        if (opacity === 1) {\r\n            for (let i = 0; i < this.width * this.height; i++) {\r\n                if (result.data[i] === 255) {\r\n                    targetData[i * 4] = rgb.r;\r\n                    targetData[i * 4 + 1] = rgb.g;\r\n                    targetData[i * 4 + 2] = rgb.b;\r\n                    targetData[i * 4 + 3] = 255;\r\n                }\r\n            }\r\n        } else {\r\n            for (let i = 0; i < this.width * this.height; i++) {\r\n                if (result.data[i] === 255) {\r\n                    targetData[i * 4] = BB.mix(targetData[i * 4], rgb.r, opacity);\r\n                    targetData[i * 4 + 1] = BB.mix(targetData[i * 4 + 1], rgb.g, opacity);\r\n                    targetData[i * 4 + 2] = BB.mix(targetData[i * 4 + 2], rgb.b, opacity);\r\n                    targetData[i * 4 + 3] = BB.mix(targetData[i * 4 + 3], 255, opacity);\r\n                }\r\n            }\r\n        }\r\n        targetCtx.putImageData(targetImageData, 0, 0);\r\n\r\n\r\n        this.history.push({\r\n            tool: [\"canvas\"],\r\n            action: \"replaceLayer\",\r\n            params: [layerIndex, targetImageData]\r\n        });\r\n    }\r\n\r\n    /**\r\n     * draw shape via BB.drawShape\r\n     * @param layerIndex\r\n     * @param shapeObj\r\n     */\r\n    drawShape (layerIndex: number, shapeObj: IShapeToolObject): void {\r\n        drawShape(this.layerCanvasArr[layerIndex].getContext(\"2d\"), shapeObj);\r\n        this.history.push({\r\n            tool: [\"canvas\"],\r\n            action: \"drawShape\",\r\n            params: [layerIndex, BB.copyObj(shapeObj)],\r\n        });\r\n    }\r\n\r\n    text (layerIndex: number, p: IRenderTextParam): void {\r\n        renderText(this.layerCanvasArr[layerIndex], BB.copyObj(p));\r\n        this.history.push({\r\n            tool: [\"canvas\"],\r\n            action: \"text\",\r\n            params: [layerIndex, BB.copyObj(p)],\r\n        });\r\n    }\r\n\r\n    replaceLayer (layerIndex: number, imageData: ImageData): void {\r\n        let ctx = this.layerCanvasArr[layerIndex].getContext(\"2d\");\r\n        ctx.putImageData(imageData, 0, 0);\r\n        this.history.push({\r\n            tool: [\"canvas\"],\r\n            action: \"replaceLayer\",\r\n            params: [layerIndex, imageData],\r\n        });\r\n    }\r\n\r\n    clearLayer (layerIndex: number): void {\r\n        let ctx = this.layerCanvasArr[layerIndex].getContext(\"2d\");\r\n        ctx.save();\r\n        ctx.clearRect(0, 0, this.layerCanvasArr[layerIndex].width, this.layerCanvasArr[layerIndex].height);\r\n        ctx.restore();\r\n\r\n        this.history.push({\r\n            tool: [\"canvas\"],\r\n            action: \"clearLayer\",\r\n            params: [layerIndex]\r\n        });\r\n    }\r\n\r\n    getLayers (): {\r\n        context: CanvasRenderingContext2D;\r\n        opacity: number;\r\n        name: string;\r\n        mixModeStr: IMixMode;\r\n    }[] {\r\n        return this.layerCanvasArr.map(item => {\r\n            return {\r\n                context: item.getContext(\"2d\"),\r\n                opacity: item.opacity,\r\n                name: item.name,\r\n                mixModeStr: item.mixModeStr,\r\n            };\r\n        });\r\n    }\r\n\r\n    getLayersFast (): {\r\n        canvas: KlCanvasLayer;\r\n        opacity: number;\r\n        name: string;\r\n        mixModeStr: IMixMode;\r\n    }[] {\r\n        return this.layerCanvasArr.map(item => {\r\n            return {\r\n                canvas: item,\r\n                opacity: item.opacity,\r\n                name: item.name,\r\n                mixModeStr: item.mixModeStr,\r\n            };\r\n        });\r\n    }\r\n\r\n    getLayerIndex (canvasObj: HTMLCanvasElement, doReturnNull?: boolean): null | number {\r\n        for (let i = 0; i < this.layerCanvasArr.length; i++) {\r\n            if (this.layerCanvasArr[i] === canvasObj) {\r\n                return i;\r\n            }\r\n        }\r\n        if (!doReturnNull) {\r\n            throw new Error(\"layer not found (in \" + this.layerCanvasArr.length + \" layers)\");\r\n        }\r\n        return null;\r\n    }\r\n\r\n    getLayer (index: number, doReturnNull?: boolean): null | {\r\n        context: CanvasRenderingContext2D;\r\n        opacity: number;\r\n        name: string;\r\n        id: number;\r\n    } {\r\n        if (this.layerCanvasArr[index]) {\r\n            return {\r\n                context: this.layerCanvasArr[index].getContext(\"2d\"),\r\n                opacity: this.layerCanvasArr[index].opacity,\r\n                name: this.layerCanvasArr[index].name,\r\n                id: index,\r\n            };\r\n        }\r\n        if (!doReturnNull) {\r\n            throw new Error(\"layer of index \" + index + \" not found (in \" + this.layerCanvasArr.length + \" layers)\");\r\n        }\r\n        return null;\r\n    }\r\n\r\n    getColorAt (x: number, y: number): IRGB {\r\n        x = Math.floor(x);\r\n        y = Math.floor(y);\r\n        let ctx = this.pickCanvas.getContext(\"2d\");\r\n        ctx.save();\r\n        ctx.imageSmoothingEnabled = false;\r\n        ctx.clearRect(0, 0, 1, 1);\r\n        for (let i = 0; i < this.layerCanvasArr.length; i++) {\r\n            ctx.globalAlpha = this.layerCanvasArr[i].opacity;\r\n            ctx.globalCompositeOperation = this.layerCanvasArr[i].mixModeStr;\r\n            ctx.drawImage(this.layerCanvasArr[i], -x, -y);\r\n        }\r\n        ctx.restore();\r\n        let imData = ctx.getImageData(0, 0, 1, 1);\r\n        return new BB.RGB(imData.data[0], imData.data[1], imData.data[2]);\r\n    }\r\n\r\n    getCompleteCanvas (factor: number): HTMLCanvasElement {\r\n        return drawProject(this.getProject(), factor);\r\n    }\r\n\r\n    getProject (): IKlProject {\r\n        return {\r\n            width: this.width,\r\n            height: this.height,\r\n            layers: this.layerCanvasArr.map(layer => {\r\n                return {\r\n                    name: layer.name,\r\n                    opacity: layer.opacity,\r\n                    mixModeStr: layer.mixModeStr,\r\n                    image: layer,\r\n                };\r\n            }),\r\n        };\r\n    }\r\n\r\n    addChangeListener (func: () => void): void {\r\n        if (this.changeListenerArr.includes(func)) {\r\n            return;\r\n        }\r\n        this.changeListenerArr.push(func);\r\n    }\r\n\r\n    removeChangeListener (func: () => void): void {\r\n        for (let i = 0; i < this.changeListenerArr.length; i++) {\r\n            if (this.changeListenerArr[i] === func) {\r\n                this.changeListenerArr.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    setMixMode (layerIndex: number, mixModeStr: IMixMode): void {\r\n        if (!this.layerCanvasArr[layerIndex]) {\r\n            throw new Error('invalid layer');\r\n        }\r\n        this.layerCanvasArr[layerIndex].mixModeStr = mixModeStr;\r\n\r\n        this.history.push({\r\n            tool: [\"canvas\"],\r\n            action: \"setMixMode\",\r\n            params: [layerIndex, '' + mixModeStr],\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Set composite drawing step for KlCanvasWorkspace.\r\n     * To apply temporary manipulations to a layer.\r\n     *\r\n     * @param layerIndex\r\n     * @param compositeObj\r\n     */\r\n    setComposite (\r\n        layerIndex: number,\r\n        compositeObj: null | {\r\n            draw: (ctx: CanvasRenderingContext2D) => void;\r\n        }\r\n    ): void {\r\n        if (!this.layerCanvasArr[layerIndex]) {\r\n            throw new Error('invalid layer');\r\n        }\r\n        this.layerCanvasArr[layerIndex].compositeObj = compositeObj;\r\n    }\r\n\r\n    destroy (): void {\r\n        if (this.layerCanvasArr === null) {\r\n            return;\r\n        }\r\n        this.layerCanvasArr.forEach(canvas => {\r\n            BB.freeCanvas(canvas);\r\n        });\r\n        this.layerCanvasArr = null;\r\n    }\r\n\r\n}\r\n","\r\n/**\r\n * Flood fill. Tried https://github.com/binarymax/floodfill.js/ but it implemented tolerance wrong, and had bugs.\r\n * So, my own implementation. can handle tolerance, grow, opacity.\r\n * Needs to be optimized.\r\n */\r\n\r\n/**\r\n * Set values in data within rect to 254, unless they're 255\r\n *\r\n * @param data Uint8Array\r\n * @param width int\r\n * @param x0 int\r\n * @param y0 int\r\n * @param x1 int >x0\r\n * @param y1 int >y0\r\n */\r\nfunction fillRect(data, width, x0, y0, x1, y1) {\r\n    for (let x = x0; x <= x1; x++) {\r\n        for (let y = y0; y <= y1; y++) {\r\n            if (data[y * width + x] === 255) {\r\n                continue;\r\n            }\r\n            data[y * width + x] = 254;\r\n        }\r\n    }\r\n}\r\n\r\nlet mx, my;\r\n\r\n/**\r\n * Get index i moved by dX, dY. in array with dimensions width height.\r\n * Returns null if outside bounds.\r\n *\r\n * @param width int\r\n * @param height int\r\n * @param i int\r\n * @param dX int\r\n * @param dY int\r\n * @returns {null|*}\r\n */\r\nfunction moveIndex(width, height, i, dX, dY) {\r\n    mx = i % width + dX;\r\n    my = Math.floor(i / width) + dY;\r\n\r\n    if (mx < 0 || my < 0 || mx >= width || my >= height) {\r\n        return null;\r\n    }\r\n\r\n    return my * width + mx;\r\n}\r\n\r\n/**\r\n * If pixel can be filled (within tolerance) will be set 255 and returns true.\r\n * returns false if already filled, or i is null\r\n *\r\n * @param srcArr Uint8Array rgba\r\n * @param targetArr Uint8Array\r\n * @param width int\r\n * @param height int\r\n * @param initRgba rgba\r\n * @param tolerance int 0 - 255\r\n * @param i int - srcArr index\r\n * @returns {boolean}\r\n */\r\nfunction testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, i) {\r\n    if (i === null || targetArr[i] === 255) {\r\n        return false;\r\n    }\r\n\r\n    if (\r\n        srcArr[i * 4] === initRgba[0] &&\r\n        srcArr[i * 4 + 1] === initRgba[1] &&\r\n        srcArr[i * 4 + 2] === initRgba[2] &&\r\n        srcArr[i * 4 + 3] === initRgba[3]\r\n    ) {\r\n        targetArr[i] = 255;\r\n        return true;\r\n    }\r\n\r\n    if (\r\n        tolerance > 0 &&\r\n        Math.abs(srcArr[i * 4] - initRgba[0]) <= tolerance &&\r\n        Math.abs(srcArr[i * 4 + 1] - initRgba[1]) <= tolerance &&\r\n        Math.abs(srcArr[i * 4 + 2] - initRgba[2]) <= tolerance &&\r\n        Math.abs(srcArr[i * 4 + 3] - initRgba[3]) <= tolerance\r\n    ) {\r\n        targetArr[i] = 255;\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n\r\n/**\r\n *\r\n * @param srcArr Uint8Array rgba\r\n * @param targetArr Uint8Array\r\n * @param width int\r\n * @param height int\r\n * @param px int\r\n * @param py int\r\n * @param tolerance int 0 - 255\r\n * @param grow int >= 0\r\n * @param isContiguous boolean\r\n */\r\nfunction floodFill(srcArr, targetArr, width, height, px, py, tolerance, grow, isContiguous) {\r\n\r\n    let initRgba = [\r\n        srcArr[(py * width + px) * 4],\r\n        srcArr[(py * width + px) * 4 + 1],\r\n        srcArr[(py * width + px) * 4 + 2],\r\n        srcArr[(py * width + px) * 4 + 3]\r\n    ];\r\n\r\n    if (isContiguous) {\r\n        let q = [];\r\n        q.push(py * width + px);\r\n        targetArr[py * width + px] = 255;\r\n\r\n        let i, e;\r\n        while (q.length) {\r\n            i = q.pop();\r\n\r\n            // queue up unfilled neighbors\r\n            e = moveIndex(width, height, i, -1, 0); // left\r\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, e) && q.push(e);\r\n\r\n            e = moveIndex(width, height, i, 1, 0); // right\r\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, e) && q.push(e);\r\n\r\n            e = moveIndex(width, height, i, 0, -1); // up\r\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, e) && q.push(e);\r\n\r\n            e = moveIndex(width, height, i, 0, 1); // bottom\r\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, e) && q.push(e);\r\n        }\r\n    } else {\r\n        for (let i = 0; i < width * height; i++) {\r\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, i);\r\n        }\r\n    }\r\n\r\n\r\n    // grow\r\n    if (grow === 0) {\r\n        return;\r\n    }\r\n\r\n    // how does it grow? it finds all pixel at the edge.\r\n    // then depending on what kind of edge it is, it draws a rectangle into target\r\n    // the rectangle has the value 254, or else it mess it all up.\r\n    // after it's all done, replaces it with 255\r\n    let x0, x1, y0, y1;\r\n    let l, tl, t, tr, r, br, b, bl; // left, top left, top, top right, etc.\r\n    for (let x = 0; x < width; x++) {\r\n        for (let y = 0; y < height; y++) {\r\n            if (targetArr[y * width + x] !== 255) {\r\n                continue;\r\n            }\r\n\r\n            // bounds of rectangle\r\n            x0 = x;\r\n            x1 = x;\r\n            y0 = y;\r\n            y1 = y;\r\n\r\n            l = targetArr[(y) * width + x - 1] !== 255;\r\n            tl = targetArr[(y - 1) * width + x - 1] !== 255;\r\n            t = targetArr[(y - 1) * width + x] !== 255;\r\n            tr = targetArr[(y - 1) * width + x + 1] !== 255;\r\n            r = targetArr[(y) * width + x + 1] !== 255;\r\n            br = targetArr[(y + 1) * width + x + 1] !== 255;\r\n            b = targetArr[(y + 1) * width + x] !== 255;\r\n            bl = targetArr[(y + 1) * width + x - 1] !== 255;\r\n\r\n            if (l) { // left\r\n                x0 = x - grow;\r\n            }\r\n            if (l && tl && t) { // top left\r\n                x0 = x - grow;\r\n                y0 = y - grow;\r\n            }\r\n            if (t) { // top\r\n                y0 = Math.min(y0, y - grow);\r\n            }\r\n            if (t && tr && r) { // top right\r\n                y0 = Math.min(y0, y - grow);\r\n                x1 = x + grow;\r\n            }\r\n            if (r) { // right\r\n                x1 = Math.max(x1, x + 1 * grow);\r\n            }\r\n            if (r && br && b) { // bottom right\r\n                x1 = Math.max(x1, x + 1 * grow);\r\n                y1 = Math.max(y1, y + 1 * grow);\r\n            }\r\n            if (b) { // bottom\r\n                y1 = Math.max(y1, y + 1 * grow);\r\n            }\r\n            if (b && bl && l) { // bottom left\r\n                x0 = Math.min(x0, x - 1 * grow);\r\n                y1 = Math.max(y1, y + 1 * grow);\r\n            }\r\n\r\n            if (!l && !tl && !t && !tr && !r && !br && !b && !bl) {\r\n                continue;\r\n            }\r\n\r\n            fillRect(\r\n                targetArr,\r\n                width,\r\n                Math.max(0, x0),\r\n                Math.max(0, y0),\r\n                Math.min(width - 1, x1),\r\n                Math.min(height - 1, y1)\r\n            );\r\n        }\r\n    }\r\n    for (let i = 0; i < width * height; i++) {\r\n        if (targetArr[i] === 254) {\r\n            targetArr[i] = 255;\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n/**\r\n * Does flood fill, and returns that. an array - 0 not filled. 255 filled\r\n *\r\n * returns {\r\n *     data: Uint8Array\r\n * }\r\n *\r\n * @param rgbaArr Uint8Array rgba\r\n * @param width int\r\n * @param height int\r\n * @param x int\r\n * @param y int\r\n * @param tolerance int 0 - 255\r\n * @param grow int >= 0\r\n * @param isContiguous boolean\r\n * @returns {{data: Uint8Array}}\r\n */\r\nexport function floodFillBits(rgbaArr, width, height, x, y, tolerance, grow, isContiguous) {\r\n    x = Math.round(x);\r\n    y = Math.round(y);\r\n\r\n    let resultArr = new Uint8Array(new ArrayBuffer(width * height));\r\n\r\n    floodFill(rgbaArr, resultArr, width, height, x, y, tolerance, grow, isContiguous);\r\n\r\n    return {\r\n        data: resultArr\r\n    }\r\n}\r\n","import {BB} from '../../bb/bb';\r\nimport {IShapeToolObject} from '../kl.types';\r\n\r\n\r\n/**\r\n * Input processor for shape tool.\r\n * Coordinates are in canvas space.\r\n * angleRad is the angle of the canvas.\r\n *\r\n * @param p - {onShape: func(isDone, x1, y1, x2, y2, angleRad)}\r\n * @constructor\r\n */\r\nexport function ShapeTool(p) {\r\n\r\n    let downX, downY, downAngleRad;\r\n\r\n    this.onDown = function(x, y, angleRad) {\r\n        downX = x;\r\n        downY = y;\r\n        downAngleRad = angleRad;\r\n    };\r\n\r\n    this.onMove = function(x, y) {\r\n        p.onShape(false, downX, downY, x, y, downAngleRad);\r\n    };\r\n\r\n    this.onUp = function(x, y) {\r\n        p.onShape(true, downX, downY, x, y, downAngleRad);\r\n    };\r\n}\r\n\r\n/**\r\n * Draw a shape (rectangle, ellipse, line)\r\n *\r\n * @param ctx\r\n * @param shapeObj\r\n */\r\nexport function drawShape(\r\n    ctx: CanvasRenderingContext2D,\r\n    shapeObj: IShapeToolObject,\r\n) {\r\n\r\n    if (['rect', 'ellipse', 'line'].includes(shapeObj.type)) {\r\n        const lineWidth = Math.round(shapeObj.lineWidth);\r\n        const angleDeg = shapeObj.angleRad * 180 / Math.PI;\r\n\r\n        // --- prep canvas ---\r\n        ctx.save();\r\n        if (shapeObj.opacity) {\r\n            ctx.globalAlpha = shapeObj.opacity;\r\n        }\r\n        if (shapeObj.isEraser) {\r\n            ctx.globalCompositeOperation = 'destination-out';\r\n        }\r\n        ctx.rotate(-shapeObj.angleRad);\r\n        if (shapeObj.fillRgb) {\r\n            ctx.fillStyle = BB.ColorConverter.toRgbStr(shapeObj.fillRgb);\r\n        } else if (shapeObj.strokeRgb) {\r\n            ctx.strokeStyle = BB.ColorConverter.toRgbStr(shapeObj.strokeRgb);\r\n            ctx.lineWidth = lineWidth;\r\n        }\r\n\r\n        let x1 = shapeObj.x1;\r\n        let y1 = shapeObj.y1;\r\n        let x2 = shapeObj.x2;\r\n        let y2 = shapeObj.y2;\r\n\r\n        // --- angle snapping ---\r\n        if (shapeObj.isAngleSnap) {\r\n            let r1 = BB.rotate(x1, y1, shapeObj.angleRad / Math.PI * 180);\r\n            let r2 = BB.rotate(x2, y2, shapeObj.angleRad / Math.PI * 180);\r\n\r\n            let pAngleDeg = BB.pointsToAngleDeg(r1, r2) + 90;\r\n            let pAngleDegSnapped = Math.round(pAngleDeg / 45) * 45;\r\n            let rotated = BB.rotateAround({x: x1, y: y1}, {x: x2, y: y2}, pAngleDegSnapped - pAngleDeg);\r\n            x2 = rotated.x;\r\n            y2 = rotated.y;\r\n\r\n            // needs to be perfect if p1->p2 aligns with canvas x- or y-axis\r\n            if ((angleDeg + pAngleDegSnapped) % 90 === 0) {\r\n                if (Math.round((angleDeg - pAngleDegSnapped) / 90) % 2 === 0) { // up or down\r\n                    x2 = x1;\r\n                } else { // left or right\r\n                    y2 = y1;\r\n                }\r\n            }\r\n        }\r\n\r\n        let x = x1;\r\n        let y = y1;\r\n        let dX = x2 - x1;\r\n        let dY = y2 - y1;\r\n\r\n        // --- 1:1 ratio ---\r\n        if (shapeObj.type !== 'line' && shapeObj.isFixedRatio) {\r\n            let r1 = BB.rotate(shapeObj.x1, shapeObj.y1, shapeObj.angleRad / Math.PI * 180);\r\n            let r2 = BB.rotate(shapeObj.x2, shapeObj.y2, shapeObj.angleRad / Math.PI * 180);\r\n\r\n            let rx = r1.x;\r\n            let ry = r1.y;\r\n            let rdX = r2.x - r1.x;\r\n            let rdY = r2.y - r1.y;\r\n\r\n            if (Math.abs(rdX) < Math.abs(rdY)) {\r\n                rdY = Math.abs(rdX) * (rdY < 0 ? -1 : 1);\r\n            } else {\r\n                rdX = Math.abs(rdY) * (rdX < 0 ? -1 : 1);\r\n            }\r\n            r2.x = rx + rdX;\r\n            r2.y = ry + rdY;\r\n\r\n            r1 = BB.rotate(r1.x, r1.y, -shapeObj.angleRad / Math.PI * 180);\r\n            r2 = BB.rotate(r2.x, r2.y, -shapeObj.angleRad / Math.PI * 180);\r\n\r\n            x1 = r1.x;\r\n            y1 = r1.y;\r\n            x2 = r2.x;\r\n            y2 = r2.y;\r\n\r\n            x = x1;\r\n            y = y1;\r\n            dX = x2 - x1;\r\n            dY = y2 - y1;\r\n        }\r\n\r\n        // outwards modifier\r\n        if (shapeObj.isOutwards) {\r\n            x -= dX;\r\n            y -= dY;\r\n            dX *= 2;\r\n            dY *= 2;\r\n\r\n            x1 = x;\r\n            y1 = y;\r\n            x2 = x + dX;\r\n            y2 = y + dY;\r\n        }\r\n\r\n        let p1;\r\n        let p2;\r\n        if (shapeObj.type === 'line') { // --- line ---\r\n\r\n            // rounded\r\n            const x1r = Math.round(x1);\r\n            const y1r = Math.round(y1);\r\n            const x2r = Math.round(x2);\r\n            const y2r = Math.round(y2);\r\n\r\n            // floored\r\n            const x1f = Math.floor(x1);\r\n            const y1f = Math.floor(y1);\r\n            const x2f = Math.floor(x2);\r\n            const y2f = Math.floor(y2);\r\n\r\n            if (lineWidth % 2 === 0) {\r\n\r\n                if (y1r === y2r) {\r\n                    p1 = {\r\n                        x: x1f,\r\n                        y: y1r,\r\n                    };\r\n                    p2 = {\r\n                        x: x2f,\r\n                        y: y2r,\r\n                    };\r\n\r\n                    if (x1f < x2f) {\r\n                        p2.x += 1;\r\n                    } else {\r\n                        p1.x += 1;\r\n                    }\r\n                } else if (x1r === x2r) {\r\n                    p1 = {\r\n                        x: x1r,\r\n                        y: y1f,\r\n                    };\r\n                    p2 = {\r\n                        x: x2r,\r\n                        y: y2f,\r\n                    };\r\n\r\n                    if (y1f < y2f) {\r\n                        p2.y += 1;\r\n                    } else {\r\n                        p1.y += 1;\r\n                    }\r\n                } else {\r\n                    p1 = {\r\n                        x: x1,\r\n                        y: y1,\r\n                    };\r\n                    p2 = {\r\n                        x: x2,\r\n                        y: y2,\r\n                    };\r\n                }\r\n\r\n            } else {\r\n                p1 = {\r\n                    x: x1f,\r\n                    y: y1f,\r\n                };\r\n                p2 = {\r\n                    x: x2f,\r\n                    y: y2f,\r\n                };\r\n                if (y1f === y2f) {\r\n                    if (x1f < x2f) {\r\n                        p2.x += 1;\r\n                    } else {\r\n                        p1.x += 1;\r\n                    }\r\n                    p1.y += 0.5;\r\n                    p2.y += 0.5;\r\n                } else if (x1f === x2f) {\r\n                    if (y1f < y2f) {\r\n                        p2.y += 1;\r\n                    } else {\r\n                        p1.y += 1;\r\n                    }\r\n                    p1.x += 0.5;\r\n                    p2.x += 0.5;\r\n                } else {\r\n                    p1.x = x1;\r\n                    p1.y = y1;\r\n                    p2.x = x2;\r\n                    p2.y = y2;\r\n                }\r\n            }\r\n\r\n            p1 = BB.rotate(p1.x, p1.y, shapeObj.angleRad / Math.PI * 180);\r\n            p2 = BB.rotate(p2.x, p2.y, shapeObj.angleRad / Math.PI * 180);\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(p1.x, p1.y);\r\n            ctx.lineTo(p2.x, p2.y);\r\n            ctx.stroke();\r\n\r\n        } else if (shapeObj.type === 'rect') { // --- rect ---\r\n\r\n            // floored\r\n            const x1f = Math.floor(x1);\r\n            const y1f = Math.floor(y1);\r\n            const x2f = Math.floor(x2);\r\n            const y2f = Math.floor(y2);\r\n\r\n            if (angleDeg % 90 === 0) {\r\n                if (shapeObj.fillRgb) {\r\n                    if (x1 % 1 === 0) {\r\n                        x1 += 1;\r\n                    }\r\n                    if (y1 % 1 === 0) {\r\n                        y1 += 1;\r\n                    }\r\n                    if (x2 % 1 === 0) {\r\n                        x2 += 1;\r\n                    }\r\n                    if (y2 % 1 === 0) {\r\n                        y2 += 1;\r\n                    }\r\n\r\n                    p1 = {\r\n                        x: x1 < x2 ? x1f : x2f,\r\n                        y: y1 < y2 ? y1f : y2f,\r\n                    };\r\n                    p2 = {\r\n                        x: Math.ceil((x1 < x2 ? x2 : x1) - p1.x),\r\n                        y: Math.ceil((y1 < y2 ? y2 : y1) - p1.y),\r\n                    };\r\n                    p2.x = p1.x + p2.x;\r\n                    p2.y = p1.y + p2.y;\r\n\r\n                } else {\r\n                    if (lineWidth % 2 === 0) {\r\n                        p1 = {\r\n                            x: x1f,\r\n                            y: y1f,\r\n                        };\r\n                        p2 = {\r\n                            x: x2f,\r\n                            y: y2f,\r\n                        };\r\n                    } else {\r\n                        p1 = {\r\n                            x: x1f + 0.5,\r\n                            y: y1f + 0.5,\r\n                        };\r\n                        p2 = {\r\n                            x: x2f + 0.5,\r\n                            y: y2f + 0.5,\r\n                        };\r\n                    }\r\n                }\r\n            } else {\r\n                p1 = {\r\n                    x: x1,\r\n                    y: y1,\r\n                };\r\n                p2 = {\r\n                    x: x2,\r\n                    y: y2,\r\n                };\r\n            }\r\n\r\n            p1 = BB.rotate(p1.x, p1.y, shapeObj.angleRad / Math.PI * 180);\r\n            p2 = BB.rotate(p2.x, p2.y, shapeObj.angleRad / Math.PI * 180);\r\n            p2.x = p2.x - p1.x;\r\n            p2.y = p2.y - p1.y;\r\n\r\n            if (shapeObj.fillRgb) {\r\n                ctx.fillRect(p1.x, p1.y, p2.x, p2.y);\r\n            } else {\r\n                ctx.strokeRect(p1.x, p1.y, p2.x, p2.y);\r\n            }\r\n\r\n        } else {  // --- circle ---\r\n            p1 = BB.rotate(x1, y1, shapeObj.angleRad / Math.PI * 180);\r\n            p2 = BB.rotate(x2, y2, shapeObj.angleRad / Math.PI * 180);\r\n            x = p1.x;\r\n            y = p1.y;\r\n            dX = p2.x - p1.x;\r\n            dY = p2.y - p1.y;\r\n\r\n            ctx.beginPath();\r\n            ctx.ellipse(x + dX / 2, y + dY / 2, Math.abs(dX / 2), Math.abs(dY / 2), 0, 0, Math.PI * 2);\r\n            if (shapeObj.fillRgb) {\r\n                ctx.fill();\r\n            } else {\r\n                ctx.stroke();\r\n            }\r\n        }\r\n\r\n\r\n        ctx.restore();\r\n\r\n    } else {\r\n        throw new Error('unknown shape');\r\n    }\r\n}","import {BB} from '../../bb/bb';\r\nimport {IRect} from '../../bb/bb.types';\r\n\r\nexport interface IRenderTextParam {\r\n    textStr: string; // text to be drawn. can contain newlines\r\n    x: number;\r\n    y: number;\r\n    size: number;\r\n    font: 'serif' | 'monospace' | 'sans-serif' | 'cursive' | 'fantasy'; // default sans-serif\r\n    align: 'left' | 'center' | 'right'; // default 'left'\r\n    isBold: boolean; // default false\r\n    isItalic: boolean; // default false\r\n    angleRad: number; // default 0 - rotates around x y\r\n    lineHeight?: number; // pixels\r\n    color: string;\r\n    isDebug?: boolean;\r\n}\r\n\r\n\r\n/**\r\n * Draw text on a canvas.\r\n *\r\n * @param canvas\r\n * @param p\r\n * @returns - bounds. coords relative to p.x p.y\r\n */\r\nexport function renderText(canvas: HTMLCanvasElement, p: IRenderTextParam): IRect {\r\n\r\n    // always at least a space. so bounds aren't just a dot\r\n    let textStr = p.textStr === '' ? ' ' : p.textStr;\r\n\r\n    // --- create el ---\r\n    // create an actual dom element. figure out where exactly each letter is positioned.\r\n    // that way multiline is feasible. canvas can't do multiline or text-align\r\n    let outer = BB.el({\r\n        css: {\r\n            position: 'fixed',\r\n            left: '0',\r\n            top: '0',\r\n            width: '100000px',\r\n            fontSize: p.size + 'px',\r\n            lineHeight: p.lineHeight ? p.lineHeight + 'px' : 'default',\r\n        }\r\n    });\r\n    let div = BB.el({\r\n        parent: outer,\r\n        css: {\r\n            display: 'inline-block',\r\n            textAlign: p.align ? p.align : 'left',\r\n            fontFamily: p.font ? p.font : 'sans-serif',\r\n            fontSize: p.size + 'px',\r\n            fontWeight: p.isBold ? 'bold' : 'normal',\r\n            fontStyle: p.isItalic ? 'italic' : 'normal',\r\n            lineHeight: p.lineHeight ? p.lineHeight + 'px' : 'default',\r\n\r\n\r\n            opacity: '0',\r\n            pointerEvents: 'none'\r\n        }\r\n    });\r\n    let spanStr = '';\r\n    let replaceObj = {\r\n        \"\\n\": '<br>',\r\n        \" \": '&nbsp;',\r\n        \"\t\": '&nbsp;&nbsp;&nbsp;&nbsp;',\r\n    };\r\n    for (let i = 0; i < textStr.length; i++) {\r\n        if (textStr[i] === \"\\n\") {\r\n            div.appendChild(BB.el({\r\n                tagName: 'span',\r\n                textContent: spanStr,\r\n                css: {\r\n                    whiteSpace: 'pre'\r\n                }\r\n            }));\r\n            spanStr = '';\r\n            div.appendChild(BB.el({\r\n                tagName: 'br'\r\n            }));\r\n            continue;\r\n        }\r\n        spanStr += textStr[i].replace(\"\\t\", '    ');\r\n    }\r\n    div.appendChild(BB.el({\r\n        tagName: 'span',\r\n        textContent: spanStr,\r\n        css: {\r\n            whiteSpace: 'pre'\r\n        }\r\n    }));\r\n    document.body.appendChild(outer);\r\n\r\n\r\n    // --- determine bounds ---\r\n    let bounds = {\r\n        x0: 99999999,\r\n        y0: 99999999,\r\n        x1: 0,\r\n        y1: 0\r\n    }\r\n    for (let i = 0; i < div.children.length; i++) {\r\n        let el = div.children[i] as HTMLElement;\r\n        bounds.x0 = Math.min(bounds.x0, el.offsetLeft);\r\n        bounds.y0 = Math.min(bounds.y0, el.offsetTop);\r\n        bounds.x1 = Math.max(bounds.x1, el.offsetLeft + el.offsetWidth);\r\n        bounds.y1 = Math.max(bounds.y1, el.offsetTop + el.offsetHeight);\r\n    }\r\n\r\n    // --- draw ---\r\n    let ctx = canvas.getContext('2d');\r\n    ctx.save();\r\n\r\n    let font = [];\r\n    if (p.isItalic) {\r\n        font.push('italic');\r\n    }\r\n    if (p.isBold) {\r\n        font.push('bold');\r\n    }\r\n    font.push(p.size + 'px ' + (p.font ? p.font : 'sans-serif'));\r\n    ctx.font = font.join(' ');\r\n    ctx.fillStyle = p.color ? p.color : '#000';\r\n\r\n    let x = p.x;\r\n    let y = p.y;\r\n    if (p.align === 'right') {\r\n        x += -bounds.x1 + bounds.x0;\r\n    }\r\n    if (p.align === 'center') {\r\n        x += (-bounds.x1 + bounds.x0) / 2;\r\n    }\r\n    ctx.translate(p.x, p.y);\r\n    ctx.rotate(p.angleRad ? -p.angleRad : 0);\r\n    ctx.translate(-p.x, -p.y);\r\n    ctx.translate(x, y);\r\n\r\n    // fill\r\n    for (let i = 0; i < div.children.length; i++) {\r\n        let el = div.children[i] as HTMLElement;\r\n\r\n        //ctx.fillText(el.innerText, 0, 0);\r\n        ctx.fillText(el.innerText, el.offsetLeft, el.offsetTop);\r\n    }\r\n\r\n    if (p.isDebug) {\r\n        ctx.lineWidth = 1;\r\n        ctx.strokeRect(0, -p.size * 0.85, bounds.x1, bounds.y1);\r\n        ctx.restore();\r\n        ctx.fillRect(p.x - 1, p.y - 1, 2, 2);\r\n    } else {\r\n        ctx.restore();\r\n    }\r\n\r\n    document.body.removeChild(outer);\r\n\r\n    return {\r\n        x: x - p.x,\r\n        y: y - p.y -p.size * 0.85,\r\n        width: bounds.x1 - bounds.x0,\r\n        height: bounds.y1 - bounds.y0\r\n    };\r\n}","import {BB} from '../../bb/bb';\r\nimport {IKlProject} from '../kl.types';\r\n\r\nexport function drawProject(project: IKlProject, factor) {\r\n    let resultCanvas = BB.canvas(\r\n        Math.max(1, Math.round(project.width * factor)),\r\n        Math.max(1, Math.round(project.height * factor))\r\n    );\r\n    let ctx = resultCanvas.getContext(\"2d\");\r\n    ctx.save();\r\n    if (factor > 1) {\r\n        ctx.imageSmoothingEnabled = false;\r\n    }\r\n    for (let i = 0; i < project.layers.length; i++) {\r\n        if (project.layers[i].opacity === 0) {\r\n            continue;\r\n        }\r\n        ctx.globalAlpha = project.layers[i].opacity;\r\n        ctx.globalCompositeOperation = project.layers[i].mixModeStr ? project.layers[i].mixModeStr : 'source-over';\r\n        ctx.drawImage(project.layers[i].image, 0, 0, resultCanvas.width, resultCanvas.height);\r\n    }\r\n    ctx.restore();\r\n    return resultCanvas;\r\n}","import {IMixMode} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\nimport {TTranslationCode} from '../../../languages/languages';\r\n\r\nexport function translateBlending(blendMode?: IMixMode): string {\r\n    if (!blendMode) {\r\n        return LANG('layers-blend-normal');\r\n    }\r\n\r\n    const codes: {\r\n        [key: string]: TTranslationCode\r\n    } = {\r\n        'source-over': 'layers-blend-normal',\r\n        'darken': 'layers-blend-darken',\r\n        'multiply': 'layers-blend-multiply',\r\n        'color-burn': 'layers-blend-color-burn',\r\n        'lighten': 'layers-blend-lighten',\r\n        'screen': 'layers-blend-screen',\r\n        'color-dodge': 'layers-blend-color-dodge',\r\n        'overlay': 'layers-blend-overlay',\r\n        'soft-light': 'layers-blend-soft-light',\r\n        'hard-light': 'layers-blend-hard-light',\r\n        'difference': 'layers-blend-difference',\r\n        'exclusion': 'layers-blend-exclusion',\r\n        'hue': 'layers-blend-hue',\r\n        'saturation': 'layers-blend-saturation',\r\n        'color': 'layers-blend-color',\r\n        'luminosity': 'layers-blend-luminosity',\r\n    };\r\n\r\n    if (!(blendMode in codes)) {\r\n        throw new Error('unknown blend mode');\r\n    }\r\n    return LANG(codes[blendMode]);\r\n}","import {BB} from '../../bb/bb';\r\nimport {IRGB} from '../kl.types';\r\n\r\n/**\r\n * Overlay for KlCanvasWorkspace.\r\n * - brush circle\r\n * - eyedropper circle\r\n * - compass needle (rotation hud)\r\n */\r\nexport class WorkspaceSvgOverlay {\r\n    private rootElement: SVGElement;\r\n    private brushCircleOuter: SVGElement;\r\n    private brushCircleInner: SVGElement;\r\n    private pickerPreviewBorder: SVGElement;\r\n    private pickerPreviewCol: SVGElement;\r\n    private readonly compassSize: number;\r\n    private compass: SVGElement;\r\n    private compassInner: SVGElement;\r\n    private compassBaseCircle: SVGElement;\r\n    private compassLineCircle: SVGElement;\r\n    private compassUpperTriangle: SVGElement;\r\n    private compassLowerTriangle: SVGElement;\r\n\r\n    // ---- public ----\r\n\r\n    constructor (\r\n        p: {\r\n            width: number;\r\n            height: number;\r\n        }\r\n    ) {\r\n        this.rootElement = BB.createSvg({\r\n            elementType: 'svg',\r\n            width: '' + p.width,\r\n            height: '' + p.height,\r\n        });\r\n        BB.css(this.rootElement, {\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0',\r\n            pointerEvents: 'none',\r\n            userSelect: 'none'\r\n        });\r\n\r\n        //brush circles\r\n        this.brushCircleOuter = BB.createSvg({\r\n            elementType: 'circle',\r\n            r: '10',\r\n            stroke: 'rgba(0,0,0,0.7)',\r\n            'stroke-width': '1',\r\n            fill: 'none',\r\n        });\r\n        this.brushCircleInner = BB.createSvg({\r\n            elementType: 'circle',\r\n            r: '9',\r\n            stroke: 'rgba(255,255,255,0.7)',\r\n            'stroke-width': '1',\r\n            fill: 'none',\r\n        });\r\n        this.rootElement.append(this.brushCircleOuter, this.brushCircleInner);\r\n\r\n        //color picker preview circle\r\n        this.pickerPreviewBorder = BB.createSvg({\r\n            elementType: 'circle',\r\n            r: '47',\r\n            stroke: 'black',\r\n            'stroke-width': '22',\r\n            fill: 'none',\r\n        });\r\n        this.pickerPreviewBorder.style.opacity = '0';\r\n        this.pickerPreviewCol = BB.createSvg({\r\n            elementType: 'circle',\r\n            r: '47',\r\n            stroke: 'black',\r\n            'stroke-width': '20',\r\n            fill: 'none',\r\n        });\r\n        this.pickerPreviewCol.style.opacity = '0';\r\n        this.rootElement.append(this.pickerPreviewBorder, this.pickerPreviewCol);\r\n\r\n\r\n        //rotation compass\r\n        this.compassSize = 30;\r\n        this.compass = BB.createSvg({\r\n            elementType: 'g',\r\n            transform: 'translate(' + (p.width/2) + ', ' + (p.height/2) + ')',\r\n        });\r\n        BB.css(this.compass, {\r\n            transition: 'opacity 0.25s ease-in-out',\r\n            opacity: '0',\r\n        });\r\n        this.compassInner = BB.createSvg({\r\n            elementType: 'g',\r\n            transform: 'rotate(45)',\r\n        });\r\n        this.compassBaseCircle = BB.createSvg({\r\n            elementType: 'circle',\r\n            fill: 'rgba(0,0,0,0.9)',\r\n            stroke: 'none',\r\n            cx: '0',\r\n            cy: '0',\r\n            r: '' + this.compassSize,\r\n        });\r\n        this.compassLineCircle = BB.createSvg({\r\n            elementType: 'circle',\r\n            fill: 'none',\r\n            stroke: 'rgba(255,255,255,0.75)',\r\n            'stroke-width': '1',\r\n            cx: '0',\r\n            cy: '0',\r\n            r: '' + (this.compassSize * 0.9),\r\n        });\r\n        this.compassUpperTriangle = BB.createSvg({\r\n            elementType: 'path',\r\n            fill: '#f00',\r\n            stroke: 'none',\r\n            d: 'M -'+(this.compassSize * 0.25)+',0 '+(this.compassSize * 0.25)+',0 0,-'+(this.compassSize * 0.9)+' z',\r\n        });\r\n        this.compassLowerTriangle = BB.createSvg({\r\n            elementType: 'path',\r\n            fill: '#fff',\r\n            stroke: 'none',\r\n            d: 'M -'+(this.compassSize * 0.25)+',0 '+(this.compassSize * 0.25)+',0 0,'+(this.compassSize * 0.9)+' z',\r\n        });\r\n\r\n        this.compassInner.append(\r\n            this.compassBaseCircle,\r\n            this.compassLineCircle,\r\n            this.compassUpperTriangle,\r\n            this.compassLowerTriangle\r\n        );\r\n        this.compass.append(this.compassInner);\r\n        this.rootElement.append(this.compass);\r\n    }\r\n\r\n    getElement (): SVGElement {\r\n        return this.rootElement;\r\n    }\r\n\r\n    setSize (width: number, height: number): void {\r\n        this.rootElement.setAttribute('width', '' + width);\r\n        this.rootElement.setAttribute('height', '' + height);\r\n        this.compass.setAttribute('transform', 'translate(' + (width/2) + ', ' + (height/2) + ')');\r\n    }\r\n\r\n    updateCursor (p: {\r\n        x?: number;\r\n        y?: number;\r\n        radius?: number;\r\n        isVisible?: boolean;\r\n    }): void {\r\n        if ('x' in p) {\r\n            this.brushCircleOuter.setAttribute('cx', '' + p.x);\r\n            this.brushCircleInner.setAttribute('cx', '' + p.x);\r\n        }\r\n        if ('y' in p) {\r\n            this.brushCircleOuter.setAttribute('cy', '' + p.y);\r\n            this.brushCircleInner.setAttribute('cy', '' + p.y);\r\n        }\r\n        if ('radius' in p) {\r\n            this.brushCircleOuter.setAttribute('r', '' + Math.max(0, p.radius));\r\n            this.brushCircleInner.setAttribute('r', '' + Math.max(0, p.radius - 1));\r\n        }\r\n        if ('isVisible' in p) {\r\n            this.brushCircleOuter.style.opacity = p.isVisible ? '1' : '0';\r\n            this.brushCircleInner.style.opacity = p.isVisible ? '1' : '0';\r\n        }\r\n    }\r\n\r\n    updateColorPreview (p: {\r\n        x?: number;\r\n        y?: number;\r\n        color?: IRGB;\r\n        isVisible?: boolean;\r\n    }): void {\r\n        if ('x' in p) {\r\n            this.pickerPreviewCol.setAttribute('cx', '' + p.x);\r\n            this.pickerPreviewBorder.setAttribute('cx', '' + p.x);\r\n        }\r\n        if ('y' in p) {\r\n            this.pickerPreviewCol.setAttribute('cy', '' + p.y);\r\n            this.pickerPreviewBorder.setAttribute('cy', '' + p.y);\r\n        }\r\n        if ('color' in p) {\r\n            this.pickerPreviewCol.setAttribute('stroke', BB.ColorConverter.toRgbStr(p.color));\r\n            let borderColor = BB.testIsWhiteBestContrast(p.color) ? 'rgba(255,255,255,0.5)' : 'rgba(0,0,0,0.5)'\r\n            this.pickerPreviewBorder.setAttribute('stroke', borderColor);\r\n        }\r\n        if ('isVisible' in p) {\r\n            this.pickerPreviewCol.style.opacity = p.isVisible ? '1' : '0';\r\n            this.pickerPreviewBorder.style.opacity = p.isVisible ? '1' : '0';\r\n        }\r\n    }\r\n\r\n    updateCompass (p: {\r\n        angleDeg?: number;\r\n        isVisible?: boolean;\r\n    }): void {\r\n        if ('angleDeg' in p) {\r\n            this.compassInner.setAttribute('transform', 'rotate(' + p.angleDeg + ')');\r\n            this.compassLineCircle.style.opacity = p.angleDeg % 90 === 0 ? '1' : '0';\r\n        }\r\n        if ('isVisible' in p) {\r\n            this.compass.style.opacity = p.isVisible ? '1' : '0';\r\n        }\r\n    }\r\n\r\n}\r\n","import {BB} from '../../bb/bb';\r\nimport {IRGB, ITransform} from '../kl.types';\r\nimport {WorkspaceSvgOverlay} from './workspace-svg-overlay';\r\nimport {klHistory} from '../history/kl-history';\r\n// @ts-ignore\r\nimport pickerImg from 'url:~/src/app/img/ui/cursor-picker.png';\r\n// @ts-ignore\r\nimport zoomEwImg from 'url:~/src/app/img/ui/cursor-zoom-ew.png';\r\n// @ts-ignore\r\nimport fillImg from 'url:~/src/app/img/ui/cursor-fill.png';\r\n// @ts-ignore\r\nimport textImg from 'url:~/src/app/img/ui/cursor-text.png';\r\nimport {IPressureInput, IVector2D} from '../../bb/bb.types';\r\nimport {KlCanvas} from '../canvas/kl-canvas';\r\nimport {KeyListener} from '../../bb/input/key-listener';\r\n\r\nexport interface IViewChangeEvent {\r\n    changed: ('scale' | 'angle')[];\r\n    angle: number;\r\n    scale: number;\r\n}\r\n\r\ntype TModeStr = 'draw' | 'pick' | 'hand' | 'shape' | 'fill' | 'text'; // | 'transform' | 'select'\r\n\r\nconst MIN_SCALE = 1 / 16;\r\nconst MAX_SCALE = 64;\r\nenum TMode {\r\n    Draw,\r\n    Hand,\r\n    HandGrabbing,\r\n    Pick,\r\n    Zoom,\r\n    Rotate,\r\n    Rotating,\r\n    Fill,\r\n    Text,\r\n    Shape,\r\n}\r\nconst ANIMATION_SPEED = 0.3; // rate of transition towards targetTransform\r\n\r\n/**\r\n * Work area that displays the KlCanvas.\r\n * - pan, zoom, rotate (also via multi-touch)\r\n * - input modes: drawing, hand, pick, fill, text // transform, select\r\n * - drawing input events\r\n * - view change events\r\n * - eyedropper input events (pick)\r\n * - draws cursor, eyedropper overlay\r\n *\r\n * subscribes to klCanvas changes\r\n * listens to kl history for changes\r\n * and you can manually trigger redraw\r\n */\r\nexport class KlCanvasWorkspace {\r\n\r\n    private rootEl: HTMLElement;\r\n    private klCanvas: KlCanvas;\r\n    private renderTargetCanvas: HTMLCanvasElement;\r\n    private renderTargetCtx: CanvasRenderingContext2D;\r\n    private renderWidth: number;\r\n    private renderHeight: number;\r\n    private compositeCanvas: HTMLCanvasElement; // for drawing klcanvas layer composite\r\n    private compositeCtx: CanvasRenderingContext2D;\r\n    private doResizeCanvas: boolean;\r\n    private oldTransformObj: ITransform;\r\n    private targetTransformObj: ITransform; // animation target\r\n    private highResTransformObj: ITransform; // animated, internal high res\r\n    private renderedTransformObj: ITransform; // same as highRes, but rounded - what's actually displayed\r\n    private cursorPos: IVector2D;\r\n    private usesCssCursor: boolean;\r\n    private bgVisible: boolean;\r\n    private transformIsDirty: boolean;\r\n    private doAnimateTranslate: boolean;\r\n    private svgOverlay: WorkspaceSvgOverlay;\r\n    private emptyCanvas: HTMLCanvasElement;\r\n    private keyListener: KeyListener;\r\n    private currentMode: TMode;\r\n    private globalMode: TMode;\r\n    private renderTime: number; // for debugging - average ms per render()\r\n    private lastDrawEvent: IPressureInput | null; // previous drawing input\r\n    private linetoolProcessor: any; // todo type - BB.EventChain.LinetoolProcessor\r\n    private pointer: IVector2D | null; // position of cursor\r\n    private isDrawing: boolean;\r\n    private inputProcessorObj: any; // todo type\r\n    private currentInputProcessor: any; // todo type\r\n    private angleIsExtraSticky: boolean;\r\n    private pinchZoomer: any; // todo type - BB.EventChain.PinchZoomer\r\n    private mainDoubleTapper: any; // todo type - BB.EventChain.DoubleTapper - todo docs\r\n    private middleDoubleTapper: any; // todo type - BB.EventChain.DoubleTapper - todo docs\r\n    private twoFingerTap: any; // todo type - BB.EventChain.NFingerTapper\r\n    private threeFingerTap: any; // todo type - BB.EventChain.NFingerTapper\r\n    private pointerEventChain: any; // todo type - BB.EventChain.EventChain\r\n    private pointerListener: any; // todo type - BB.PointerListener\r\n    private brushRadius: number;\r\n    private animationFrameRequested: boolean;\r\n    private lastRenderedState: number; // KlHistory state - to detect if there are changes to draw\r\n    private lastRenderTime: number; // ms from performance.now()\r\n    private hideBrushCursorTimeout: number;\r\n    private onViewChange: (e:  IViewChangeEvent) => void;\r\n\r\n    private getRenderedTransform (): ITransform {\r\n        // rounded x & y so canvas is less blurry.\r\n        const result = this.renderedTransformObj;\r\n        result.x = this.highResTransformObj.x;\r\n        result.y = this.highResTransformObj.y;\r\n        result.scale = this.highResTransformObj.scale;\r\n        result.angle = this.highResTransformObj.angle;\r\n\r\n        if (result.angle % (Math.PI / 2) === 0 && result.scale % 1 === 0) {\r\n            result.x = Math.round(result.x);\r\n            result.y = Math.round(result.y);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    private updateChangeListener (): void {\r\n        this.klCanvas.addChangeListener(() => {\r\n            this.lastRenderedState = -1;\r\n            this.reqFrame();\r\n        });\r\n    }\r\n\r\n    private updateCursor (modeInt: TMode, doForce?: boolean): void {\r\n        if (modeInt === this.currentMode && !doForce) {\r\n            return;\r\n        }\r\n        const oldMode = this.currentMode;\r\n        this.currentMode = modeInt;\r\n        this.lastRenderedState = -1;\r\n        if (this.currentMode === TMode.Draw) {\r\n            this.rootEl.style.cursor = 'crosshair';\r\n        } else if (this.currentMode === TMode.Hand) {\r\n            this.rootEl.style.cursor = 'grab';\r\n        } else if (this.currentMode === TMode.HandGrabbing) {\r\n            this.rootEl.style.cursor = 'grabbing';\r\n        } else if (this.currentMode === TMode.Pick) {\r\n            this.rootEl.style.cursor = \"url('\" + pickerImg + \"') 0 15, crosshair\";\r\n        } else if (this.currentMode === TMode.Zoom) {\r\n            this.rootEl.style.cursor = \"url('\" + zoomEwImg + \"') 7 7, zoom-in\";\r\n        } else if (this.currentMode === TMode.Rotate) {\r\n            this.rootEl.style.cursor = \"grab\";\r\n        } else if (this.currentMode === TMode.Rotating) {\r\n            this.rootEl.style.cursor = \"grabbing\";\r\n        } else if (this.currentMode === TMode.Fill) {\r\n            this.rootEl.style.cursor = \"url('\" + fillImg + \"') 1 12, crosshair\";\r\n        } else if (this.currentMode === TMode.Text) {\r\n            this.rootEl.style.cursor = \"url('\" + textImg + \"') 1 12, crosshair\";\r\n        } else if (this.currentMode === TMode.Shape) {\r\n            this.rootEl.style.cursor = 'crosshair';\r\n        }\r\n\r\n        if ([TMode.Draw, TMode.Pick, TMode.Fill, TMode.Text, TMode.Shape].includes(this.globalMode)) {\r\n            const oldIsHand = [TMode.Hand, TMode.HandGrabbing].includes(oldMode);\r\n            const currentIsHand = [TMode.Hand, TMode.HandGrabbing].includes(this.currentMode);\r\n            if (!oldIsHand && currentIsHand) {\r\n                this.mainDoubleTapper.setAllowedPointerTypeArr(['mouse', 'pen', 'touch']);\r\n            }\r\n            if (oldIsHand && !currentIsHand) {\r\n                this.mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\r\n            }\r\n        }\r\n\r\n        if (this.currentMode !== TMode.Pick) {\r\n            this.svgOverlay.updateColorPreview({isVisible: false});\r\n        }\r\n    }\r\n\r\n    /**\r\n     * returns false if no change of zoom\r\n     * @param stepNum\r\n     * @param centerX\r\n     * @param centerY\r\n     * @private\r\n     */\r\n    private internalZoomByStep (stepNum: number, centerX: number, centerY: number): boolean {\r\n        const step = Math.log2(this.targetTransformObj.scale);\r\n\r\n        let newStep = step / Math.abs(stepNum);\r\n        newStep += stepNum > 0 ? 1 : -1;\r\n        newStep = Math.round(newStep);\r\n        newStep *= Math.abs(stepNum);\r\n        const newScale = Math.max(MIN_SCALE, Math.min(MAX_SCALE, Math.pow(2, newStep)));\r\n\r\n        //has zoomed?\r\n        if (newScale === this.targetTransformObj.scale) {\r\n            return false;\r\n        }\r\n\r\n\r\n        const effectiveFactor = newScale / this.targetTransformObj.scale;\r\n        this.targetTransformObj.scale = newScale;\r\n\r\n        let matrix = BB.Matrix.getIdentity();\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(centerX, centerY));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(effectiveFactor));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-centerX, -centerY));\r\n\r\n        let origin = [this.targetTransformObj.x, this.targetTransformObj.y, 0, 1];\r\n        origin = BB.Matrix.multiplyMatrixAndPoint(matrix, origin);\r\n        this.targetTransformObj.x = origin[0];\r\n        this.targetTransformObj.y = origin[1];\r\n\r\n        this.transformIsDirty = true;\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * mixes two transform objects. modifies A\r\n     * @param transformA\r\n     * @param transformB\r\n     * @param blendFactor 0 -> A, 1 -> B\r\n     * @private\r\n     */\r\n    private mixTransformObj (transformA: ITransform, transformB: ITransform, blendFactor: number): void {\r\n        if (transformA.angle === transformB.angle) {\r\n            transformA.scale = BB.mix(transformA.scale, transformB.scale, blendFactor);\r\n            transformA.x = BB.mix(transformA.x, transformB.x, blendFactor);\r\n            transformA.y = BB.mix(transformA.y, transformB.y, blendFactor);\r\n            transformA.angle = BB.mix(transformA.angle, transformB.angle, blendFactor);\r\n            return;\r\n        }\r\n\r\n        const w = this.klCanvas.getWidth();\r\n        const h = this.klCanvas.getHeight();\r\n\r\n        // --- determine centerPosA, centerPosB ---\r\n        const centerPosA = this.canvasToWorkspaceCoord({\r\n            x: w / 2,\r\n            y: h / 2\r\n        }, transformA);\r\n        const centerPosB = this.canvasToWorkspaceCoord({\r\n            x: w / 2,\r\n            y: h / 2\r\n        }, transformB);\r\n\r\n        // --- centerPosMixed ---\r\n        transformA.x = BB.mix(centerPosA.x , centerPosB.x, blendFactor);\r\n        transformA.y = BB.mix(centerPosA.y , centerPosB.y, blendFactor);\r\n\r\n        // --- scale and angle ---\r\n        transformA.scale = BB.mix(transformA.scale, transformB.scale, blendFactor);\r\n        transformA.angle = BB.mix(transformA.angle, transformB.angle, blendFactor);\r\n\r\n        // --- x and y ---\r\n        const mixedPos = this.canvasToWorkspaceCoord({\r\n            x: -w / 2,\r\n            y: -h / 2\r\n        }, transformA);\r\n        transformA.x = mixedPos.x;\r\n        transformA.y = mixedPos.y;\r\n    }\r\n\r\n    private render (): void {\r\n        if (this.doResizeCanvas) {\r\n            this.doResizeCanvas = false;\r\n            this.renderTargetCanvas.width = this.renderWidth;\r\n            this.renderTargetCanvas.height = this.renderHeight;\r\n        }\r\n        this.renderContext(this.renderTargetCtx);\r\n    }\r\n\r\n    /**\r\n     * is the gray background that surrounds canvas visible?\r\n     * @private\r\n     */\r\n    private testBgVisible (): boolean {\r\n        //bring workspace points (corners of workspace) into canvas coordinate system\r\n        //then check if any corner point is outside of the canvas -> that means the bg is visible\r\n\r\n        const workspacePointArr = [\r\n            [0, 0], // top left\r\n            [this.renderWidth, 0], // top right\r\n            [this.renderWidth, this.renderHeight], // bottom right\r\n            [0, this.renderHeight], // bottom left\r\n        ];\r\n\r\n        const art = this.getRenderedTransform();\r\n\r\n        //setup transformation matrix\r\n        let matrix = BB.Matrix.getIdentity();\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(1/art.scale));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(-art.angle));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-art.x, -art.y));\r\n\r\n        //transform points, then test if outside of canvas\r\n        for (let i = 0; i < workspacePointArr.length; i++) {\r\n            let coords = [workspacePointArr[i][0], workspacePointArr[i][1], 0, 1];\r\n            coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\r\n\r\n            if (\r\n                !(0 <= coords[0] && coords[0] <= this.klCanvas.getWidth() &&\r\n                    0 <= coords[1] && coords[1] <= this.klCanvas.getHeight())\r\n            ){\r\n                //if not inside -> bg visible\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    private renderContext (ctx: CanvasRenderingContext2D): void {\r\n        const w = this.klCanvas.getWidth();\r\n        const h = this.klCanvas.getHeight();\r\n\r\n        const art = this.getRenderedTransform();\r\n\r\n        if (art.scale >= 4 || (art.scale === 1 && art.angle === 0)) {\r\n            ctx.imageSmoothingEnabled = false;\r\n        } else {\r\n            ctx.imageSmoothingEnabled = true;\r\n            ctx.imageSmoothingQuality  = 'low'; // art.scale >= 1 ? 'low' : 'medium';\r\n        }\r\n        //ctx.imageSmoothingEnabled = false;\r\n        //renderTargetCtx.globalCompositeOperation  = 'multiply';\r\n\r\n\r\n\r\n        ctx.save();\r\n        {\r\n            if (this.bgVisible) {\r\n                ctx.fillStyle = 'rgb(158,158,158)'; // 'rgb(185,185,185)';\r\n                ctx.fillRect(0, 0, this.renderWidth, this.renderHeight);\r\n            } else {\r\n                ctx.clearRect(0, 0, this.renderWidth, this.renderHeight);\r\n            }\r\n\r\n\r\n\r\n            if (this.bgVisible) {\r\n                ctx.save();\r\n\r\n                ctx.translate(art.x, art.y);\r\n                ctx.scale(art.scale, art.scale);\r\n                ctx.rotate(art.angle);\r\n\r\n                ctx.imageSmoothingEnabled = false;\r\n\r\n                //outline\r\n                const borderSize = 1;\r\n                ctx.globalAlpha = 0.2;\r\n                ctx.drawImage(\r\n                    this.emptyCanvas,\r\n                    -borderSize / art.scale,\r\n                    -borderSize / art.scale,\r\n                    w + borderSize * 2 / art.scale,\r\n                    h + borderSize * 2 / art.scale\r\n                );\r\n                ctx.globalAlpha = 1;\r\n\r\n                //erase\r\n                ctx.globalCompositeOperation = 'destination-out';\r\n                ctx.drawImage(this.emptyCanvas, 0, 0, w, h);\r\n\r\n                ctx.restore();\r\n            }\r\n\r\n            /*const region = new Path2D();\r\n            region.rect(80, 10, 20, 130);\r\n            ctx.clip(region);*/\r\n\r\n            ctx.translate(art.x, art.y);\r\n            ctx.scale(art.scale, art.scale);\r\n            ctx.rotate(art.angle);\r\n\r\n            const layerArr = this.klCanvas.getLayersFast();\r\n            for (let i = 0; i < layerArr.length; i++) {\r\n                if (layerArr[i].opacity > 0) {\r\n                    ctx.globalAlpha = layerArr[i].opacity;\r\n                    ctx.globalCompositeOperation = layerArr[i].mixModeStr;\r\n\r\n                    if (layerArr[i].canvas.compositeObj) {\r\n                        if (this.compositeCanvas.width !== layerArr[i].canvas.width || this.compositeCanvas.height !== layerArr[i].canvas.height) {\r\n                            this.compositeCanvas.width = layerArr[i].canvas.width;\r\n                            this.compositeCanvas.height = layerArr[i].canvas.height;\r\n                        } else {\r\n                            this.compositeCtx.clearRect(0, 0, this.compositeCanvas.width, this.compositeCanvas.height);\r\n                        }\r\n                        this.compositeCtx.drawImage(layerArr[i].canvas, 0, 0);\r\n                        layerArr[i].canvas.compositeObj.draw(this.compositeCtx);\r\n                        ctx.drawImage(this.compositeCanvas, 0, 0, w, h);\r\n                    } else {\r\n                        ctx.drawImage(layerArr[i].canvas, 0, 0, w, h);\r\n                    }\r\n                }\r\n            }\r\n            ctx.globalAlpha = 1;\r\n\r\n\r\n\r\n        }\r\n        ctx.restore();\r\n\r\n        // rotation hud\r\n        if (TMode.Rotate === this.currentMode || TMode.Rotating === this.currentMode) {\r\n            this.svgOverlay.updateCompass({\r\n                isVisible: true,\r\n                angleDeg: art.angle / Math.PI * 180\r\n            });\r\n        } else {\r\n            this.svgOverlay.updateCompass({\r\n                isVisible: false\r\n            });\r\n        }\r\n    }\r\n\r\n    private workspaceToCanvasCoord (p: IVector2D): IVector2D {\r\n        const art = this.getRenderedTransform();\r\n        let matrix = BB.Matrix.getIdentity();\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(1/art.scale));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(-art.angle));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-art.x, -art.y));\r\n\r\n        let coords = [p.x, p.y, 0, 1];\r\n        coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\r\n\r\n        return {\r\n            x: coords[0],\r\n            y: coords[1],\r\n        };\r\n    }\r\n\r\n    private canvasToWorkspaceCoord (p: IVector2D, transformObj: ITransform): IVector2D {\r\n        let matrix = BB.Matrix.getIdentity();\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(transformObj.x, transformObj.y));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(transformObj.angle));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(transformObj.scale));\r\n\r\n        let coords = [p.x, p.y, 0, 1];\r\n        coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\r\n\r\n        return {\r\n            x: coords[0],\r\n            y: coords[1],\r\n        };\r\n    }\r\n\r\n    private snapAngleRad (angleRad: number, snapDegIncrement: number, maxDistDeg: number): number {\r\n        let angleDeg = angleRad * 180 / Math.PI;\r\n        const modDeg = Math.abs(angleDeg % snapDegIncrement);\r\n        const dist = Math.min(modDeg, snapDegIncrement - modDeg);\r\n\r\n        if (dist <= maxDistDeg) {\r\n            angleDeg = Math.round(angleDeg / snapDegIncrement) * snapDegIncrement;\r\n        }\r\n\r\n        return angleDeg / 180 * Math.PI;\r\n    }\r\n\r\n    /**\r\n     * angle always in range [-PI, PI]\r\n     * @param angleRad\r\n     * @private\r\n     */\r\n    private minimizeAngleRad (angleRad: number): number {\r\n        angleRad = angleRad % (2 * Math.PI);\r\n        if (angleRad > Math.PI) {\r\n            angleRad -= 2 * Math.PI;\r\n        } else if (angleRad < -Math.PI) {\r\n            angleRad += 2 * Math.PI;\r\n        }\r\n        return angleRad;\r\n    }\r\n\r\n    private resetInputProcessor (): void {\r\n        this.currentInputProcessor = null;\r\n        this.updateCursor(this.globalMode);\r\n        this.reqFrame(true);\r\n    }\r\n\r\n    private reqFrame (doRedrawCanvas?: boolean): void {\r\n        this.animationFrameRequested = true;\r\n        if (doRedrawCanvas) {\r\n            this.lastRenderedState = -1;\r\n        }\r\n    }\r\n\r\n    private updateLoop (): void {\r\n        window.requestAnimationFrame(() => this.updateLoop());\r\n        const newState = klHistory.getState();\r\n        const doRender = this.lastRenderedState < newState;\r\n\r\n        //handle variable framerate\r\n        const nowTime = performance.now();\r\n        const elapsedFrames = (nowTime - this.lastRenderTime) * 60 / 1000; //how many frames elapsed since last render if fps were 60fps\r\n        this.lastRenderTime = nowTime;\r\n\r\n        if (this.animationFrameRequested || doRender) {\r\n            this.animationFrameRequested = false;\r\n            this.checkChange(elapsedFrames);\r\n        }\r\n    }\r\n\r\n    private checkChange (elapsedFrames: number): void {\r\n\r\n        const newState = klHistory.getState();\r\n        const doRender = this.lastRenderedState < newState ||\r\n            this.highResTransformObj.scale !== this.targetTransformObj.scale ||\r\n            this.highResTransformObj.x !== this.targetTransformObj.x ||\r\n            this.highResTransformObj.y !== this.targetTransformObj.y;\r\n\r\n        //update transform\r\n        if (\r\n            !this.doAnimateTranslate &&\r\n            (\r\n                this.highResTransformObj.scale === this.targetTransformObj.scale ||\r\n                Math.abs(this.highResTransformObj.scale - this.targetTransformObj.scale) < 0.008 * this.targetTransformObj.scale\r\n            )\r\n        ) {\r\n            this.highResTransformObj.scale = this.targetTransformObj.scale;\r\n            this.highResTransformObj.x = this.targetTransformObj.x;\r\n            this.highResTransformObj.y = this.targetTransformObj.y;\r\n            this.highResTransformObj.angle = this.targetTransformObj.angle;\r\n            if (this.transformIsDirty) {\r\n                this.transformIsDirty = false;\r\n                this.bgVisible = this.testBgVisible();\r\n            }\r\n\r\n            this.svgOverlay.updateCursor({radius: this.brushRadius * this.highResTransformObj.scale});\r\n        } else if (\r\n            (this.highResTransformObj.x === this.targetTransformObj.x || Math.abs(this.highResTransformObj.x - this.targetTransformObj.x) < 0.5) &&\r\n            (this.highResTransformObj.y === this.targetTransformObj.y || Math.abs(this.highResTransformObj.y - this.targetTransformObj.y) < 0.5) &&\r\n            (\r\n                this.highResTransformObj.scale === this.targetTransformObj.scale ||\r\n                Math.abs(this.highResTransformObj.scale - this.targetTransformObj.scale) < 0.008 * this.targetTransformObj.scale\r\n            )\r\n        ) {\r\n            this.highResTransformObj.scale = this.targetTransformObj.scale;\r\n            this.highResTransformObj.x = this.targetTransformObj.x;\r\n            this.highResTransformObj.y = this.targetTransformObj.y;\r\n            this.highResTransformObj.angle = this.targetTransformObj.angle;\r\n            this. doAnimateTranslate = false;\r\n            if (this.transformIsDirty) {\r\n                this.transformIsDirty = false;\r\n                this.bgVisible = this.testBgVisible();\r\n            }\r\n\r\n            this.svgOverlay.updateCursor({radius: this.brushRadius * this.highResTransformObj.scale});\r\n        } else {\r\n            this.reqFrame(); //probably needs another frame\r\n            const blendFactor = Math.min(1, ANIMATION_SPEED * elapsedFrames);\r\n            this.mixTransformObj(this.highResTransformObj, this.targetTransformObj, blendFactor);\r\n            this.bgVisible = true; // spare yourself the calculation\r\n            this.svgOverlay.updateCursor({radius: this.brushRadius * this.highResTransformObj.scale});\r\n        }\r\n\r\n        if (this.pointer && this.currentMode == TMode.Draw && !this.usesCssCursor) {\r\n            this.svgOverlay.updateCursor({\r\n                x: this.pointer.x,\r\n                y: this.pointer.y,\r\n                isVisible: true\r\n            });\r\n        } else {\r\n            this.svgOverlay.updateCursor({isVisible: false});\r\n        }\r\n\r\n\r\n        if (doRender) {\r\n            //console.log('scale', this.renderedTransform.scale, 'x', this.renderedTransform.x, 'y', this.renderedTransform.y);\r\n            this.lastRenderedState = newState;\r\n            const start = performance.now();\r\n            this.render();\r\n            this.renderTime = BB.mix(this.renderTime, performance.now() - start, 0.05);\r\n        }\r\n        //setTimeout(this.checkChange, 100);\r\n\r\n\r\n\r\n        if (doRender) {\r\n\r\n            //console.log('rendertime ms: ', this.renderTime);\r\n        }\r\n\r\n    }\r\n\r\n    // ---- public ----\r\n\r\n    constructor (\r\n        p: {\r\n            klCanvas: any; // todo\r\n            width: number;\r\n            height: number;\r\n            onDraw: (val) => void; // todo\r\n            onPick: (rgb: IRGB, isPointerup: boolean) => void;\r\n            onFill: (canvasX: number, canvasY: number) => void;\r\n            onText: (canvasX: number, canvasY: number, angleRad: number) => void;\r\n            onShape: (type: 'down' | 'up' | 'move', canvasX: number, canvasY: number, angleRad: number) => void;\r\n            onViewChange: (e:  IViewChangeEvent) => void;\r\n            onUndo: () => void;\r\n            onRedo: () => void;\r\n        }\r\n    ) {\r\n        const _this = this;\r\n        this.rootEl = BB.el({\r\n            css: {\r\n                position: 'absolute',\r\n                left: '0',\r\n                right: '0',\r\n                top: '0',\r\n                bottom: '0',\r\n                cursor: 'crosshair',\r\n                userSelect: 'none',\r\n                colorScheme: 'only light',\r\n            }\r\n        });\r\n        this.klCanvas = p.klCanvas;\r\n        this.onViewChange = p.onViewChange;\r\n        this.renderTargetCanvas = BB.canvas(p.width, p.height);\r\n        this.renderTargetCtx = this.renderTargetCanvas.getContext('2d');\r\n        this.renderWidth = p.width;\r\n        this.renderHeight = p.height;\r\n        this.compositeCanvas = BB.canvas(1, 1); // for drawing klcanvas layer composite\r\n        this.compositeCtx = this.compositeCanvas.getContext('2d');\r\n        this.doResizeCanvas = false;\r\n        this.oldTransformObj = null;\r\n        this.targetTransformObj = {\r\n            x: 0,\r\n            y: 0,\r\n            scale: 1,\r\n            angle: 0\r\n        };\r\n        this.highResTransformObj = {\r\n            x: 0,\r\n            y: 0,\r\n            scale: 1,\r\n            angle: 0\r\n        };\r\n        this.renderedTransformObj = {\r\n            x: null,\r\n            y: null,\r\n            scale: null,\r\n            angle: null\r\n        };\r\n        this.cursorPos = {\r\n            x: 0,\r\n            y: 0\r\n        };\r\n        this.usesCssCursor = false;\r\n        this.bgVisible = true;\r\n        this.transformIsDirty = true;\r\n        this.doAnimateTranslate = true;\r\n\r\n        this.svgOverlay = new WorkspaceSvgOverlay({\r\n            width: p.width,\r\n            height: p.height\r\n        });\r\n\r\n        BB.css(this.renderTargetCanvas, {\r\n            userSelect: 'none',\r\n            pointerEvents: 'none',\r\n        });\r\n        BB.createCheckerDataUrl(8, (url) => {\r\n            this.renderTargetCanvas.style.background = \"url(\" + url + \")\";\r\n        });\r\n        this.rootEl.appendChild(this.renderTargetCanvas);\r\n        this.rootEl.appendChild(this.svgOverlay.getElement());\r\n        BB.addEventListener(this.rootEl, 'touchend', (e) => {\r\n            e.preventDefault();\r\n            return false;\r\n        });\r\n        BB.addEventListener(this.rootEl, 'contextmenu', (e) => {\r\n            e.preventDefault();\r\n            return false;\r\n        });\r\n        BB.addEventListener(this.rootEl, 'dragstart', (e) => {\r\n            e.preventDefault();\r\n            return false;\r\n        });\r\n\r\n        this.emptyCanvas = BB.canvas(1, 1);\r\n        {\r\n            const ctx = this.emptyCanvas.getContext('2d');\r\n            ctx.fillRect(0, 0, 1, 1);\r\n        }\r\n\r\n        this.keyListener = new BB.KeyListener({\r\n            onDown: (keyStr, event, comboStr, isRepeat) => {\r\n\r\n                if (keyStr === 'alt') {\r\n                    event.preventDefault();\r\n                }\r\n                if (isRepeat) {\r\n                    return;\r\n                }\r\n\r\n                if (this.currentInputProcessor) {\r\n                    this.currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\r\n\r\n                } else {\r\n\r\n                    if ([TMode.Draw, TMode.Pick, TMode.Fill, TMode.Text, TMode.Shape].includes(this.globalMode) && comboStr === 'space') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.spaceHand;\r\n                        this.currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\r\n                        return;\r\n                    }\r\n\r\n                    if ([TMode.Draw, TMode.Hand, TMode.Fill, TMode.Text, TMode.Shape].includes(this.globalMode) && comboStr === 'alt') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.altPicker;\r\n                        this.currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\r\n                        return;\r\n                    }\r\n\r\n                    if (['r', 'shift+r'].includes(comboStr)) {\r\n                        this.currentInputProcessor = this.inputProcessorObj.rotate;\r\n                        this.currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\r\n                        return;\r\n                    }\r\n\r\n                    if ('z' === comboStr) {\r\n                        this.currentInputProcessor = this.inputProcessorObj.zoom;\r\n                        this.currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\r\n                        return;\r\n                    }\r\n\r\n                }\r\n\r\n            },\r\n            onUp: (keyStr, event, oldComboStr) => {\r\n                if (this.currentInputProcessor) {\r\n                    this.currentInputProcessor.onKeyUp(keyStr, event, oldComboStr);\r\n                }\r\n            }\r\n        });\r\n\r\n        this.updateChangeListener();\r\n\r\n        this.currentMode = TMode.Draw;\r\n        this.globalMode = TMode.Draw;\r\n\r\n        this.renderTime = 0;\r\n\r\n        this.lastDrawEvent = null;\r\n\r\n        this.linetoolProcessor = new BB.EventChain.LinetoolProcessor({\r\n            onDraw: (event) => {\r\n                const getMatrix = () => {\r\n                    const art = this.getRenderedTransform();\r\n                    let matrix = BB.Matrix.getIdentity();\r\n                    matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(1/art.scale));\r\n                    matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(-art.angle));\r\n                    matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-art.x, -art.y));\r\n                    return matrix;\r\n                };\r\n\r\n                if (event.type === 'line' && !this.lastDrawEvent) {\r\n                    const matrix = getMatrix();\r\n                    let coords = [event.x1, event.y1, 0, 1];\r\n                    coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\r\n                    this.lastDrawEvent = {\r\n                        x: coords[0],\r\n                        y: coords[1],\r\n                        pressure: event.pressure1\r\n                    };\r\n                    return;\r\n                }\r\n\r\n                if ('x' in event || 'x0' in event) {\r\n\r\n                    const matrix = getMatrix();\r\n\r\n                    if ('x' in event) { //down or move\r\n                        let coords = [event.x, event.y, 0, 1];\r\n                        coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\r\n                        event.x = coords[0];\r\n                        event.y = coords[1];\r\n                    }\r\n                    if ('x0' in event) { //line\r\n                        event.x0 = this.lastDrawEvent.x;\r\n                        event.y0 = this.lastDrawEvent.y;\r\n                        event.pressure0 = this.lastDrawEvent.pressure;\r\n                        let coords = [event.x1, event.y1, 0, 1];\r\n                        coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\r\n                        event.x1 = coords[0];\r\n                        event.y1 = coords[1];\r\n\r\n                        this.lastDrawEvent = {\r\n                            x: event.x1,\r\n                            y: event.y1,\r\n                            pressure: event.pressure1,\r\n                        };\r\n                    }\r\n                }\r\n\r\n\r\n                if (['down', 'move'].includes(event.type)) {\r\n                    this.lastDrawEvent = event;\r\n                }\r\n                p.onDraw(event);\r\n            }\r\n        });\r\n\r\n        this.pointer = null;\r\n        this.isDrawing = false;\r\n\r\n\r\n        this.inputProcessorObj = {\r\n            draw: {\r\n                onPointer: (val) => {\r\n\r\n                    this.reqFrame();\r\n                    this.updateCursor(TMode.Draw);\r\n\r\n                    const comboStr = this.keyListener.getComboStr();\r\n\r\n                    const event: any = {\r\n                        scale: this.highResTransformObj.scale\r\n                    };\r\n                    event.shiftIsPressed = comboStr === 'shift';\r\n                    event.pressure = val.pressure;\r\n                    event.isCoalesced = !!val.isCoalesced;\r\n\r\n                    if (val.type === 'pointerdown') {\r\n\r\n                        this.isDrawing = true;\r\n                        event.type = 'down';\r\n\r\n                    } else if (val.button) {\r\n                        event.type = 'move';\r\n\r\n                    } else if (val.type === 'pointerup') {\r\n\r\n                        this.isDrawing = false;\r\n                        event.type = 'up';\r\n\r\n                        this.linetoolProcessor.process(event);\r\n                        this.resetInputProcessor();\r\n                        return;\r\n                    } else {\r\n                        return;\r\n                    }\r\n\r\n                    event.x = val.relX;\r\n                    event.y = val.relY;\r\n\r\n                    this.linetoolProcessor.process(event);\r\n                },\r\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\r\n\r\n                },\r\n                onKeyUp: (keyStr, event, oldComboStr) => {\r\n\r\n                }\r\n            },\r\n            fill: {\r\n                onPointer: (event) => {\r\n\r\n                    this.reqFrame();\r\n                    this.updateCursor(TMode.Fill);\r\n\r\n                    if (event.type === 'pointerdown') {\r\n                        const coord = this.workspaceToCanvasCoord({x: event.relX, y: event.relY});\r\n                        p.onFill(Math.floor(coord.x), Math.floor(coord.y));\r\n\r\n                    } else if (event.type === 'pointerup') {\r\n                        this.resetInputProcessor();\r\n                        return;\r\n\r\n                    }\r\n\r\n                },\r\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\r\n\r\n                },\r\n                onKeyUp: (keyStr, event, oldComboStr) => {\r\n\r\n                }\r\n            },\r\n            text: {\r\n                onPointer: (event) => {\r\n\r\n                    this.reqFrame();\r\n                    this.updateCursor(TMode.Text);\r\n\r\n                    if (event.type === 'pointerdown') {\r\n                        const coord = this.workspaceToCanvasCoord({x: event.relX, y: event.relY});\r\n                        p.onText(Math.floor(coord.x), Math.floor(coord.y), this.renderedTransformObj.angle);\r\n\r\n                    } else if (event.type === 'pointerup') {\r\n                        this.resetInputProcessor();\r\n                        return;\r\n\r\n                    }\r\n\r\n                },\r\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\r\n\r\n                },\r\n                onKeyUp: (keyStr, event, oldComboStr) => {\r\n\r\n                }\r\n            },\r\n            shape: {\r\n                onPointer: (event) => {\r\n\r\n                    this.reqFrame();\r\n                    this.updateCursor(TMode.Shape);\r\n                    const coord = this.workspaceToCanvasCoord({x: event.relX, y: event.relY});\r\n\r\n                    if (event.type === 'pointerdown') {\r\n                        this.isDrawing = true;\r\n                        p.onShape('down', coord.x, coord.y, this.renderedTransformObj.angle);\r\n\r\n                    } else if (event.type === 'pointermove') {\r\n                        p.onShape('move', coord.x, coord.y, this.renderedTransformObj.angle);\r\n\r\n                    } else if (event.type === 'pointerup') {\r\n                        this.isDrawing = false;\r\n                        p.onShape('up', coord.x, coord.y, this.renderedTransformObj.angle);\r\n                        this.resetInputProcessor();\r\n\r\n                    }\r\n                },\r\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\r\n\r\n                },\r\n                onKeyUp: (keyStr, event, oldComboStr) => {\r\n\r\n                }\r\n            },\r\n            hand: {\r\n                onPointer: (event) => {\r\n                    this.updateCursor(TMode.Hand);\r\n                    if (['left', 'middle'].includes(event.button)) {\r\n                        this.updateCursor(TMode.HandGrabbing);\r\n                        this.targetTransformObj.x += event.dX;\r\n                        this.targetTransformObj.y += event.dY;\r\n                        this.highResTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\r\n                        this.doAnimateTranslate = false;\r\n                        this.transformIsDirty = true;\r\n                        this.reqFrame(true);\r\n                    } else if (event.type === 'pointerup') {\r\n                        this.resetInputProcessor();\r\n                    }\r\n                },\r\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\r\n\r\n                },\r\n                onKeyUp: (keyStr, event, oldComboStr) => {\r\n\r\n                }\r\n            },\r\n            spaceHand: {\r\n                onPointer: (event) => {\r\n                    this.updateCursor(TMode.Hand);\r\n                    if (['left', 'middle'].includes(event.button)) {\r\n                        this.updateCursor(TMode.HandGrabbing);\r\n                        this.targetTransformObj.x += event.dX;\r\n                        this.targetTransformObj.y += event.dY;\r\n                        this.highResTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\r\n                        this.doAnimateTranslate = false;\r\n                        this.transformIsDirty = true;\r\n                        this.reqFrame(true);\r\n                    }\r\n                },\r\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\r\n                    if (comboStr !== 'space') {\r\n                        this.resetInputProcessor();\r\n                    } else {\r\n                        this.updateCursor(TMode.Hand);\r\n                    }\r\n                },\r\n                onKeyUp: (keyStr, event, oldComboStr) => {\r\n                    this.resetInputProcessor();\r\n                }\r\n            },\r\n            zoom: {\r\n                onPointer: (event) => {\r\n                    this.updateCursor(TMode.Zoom);\r\n\r\n                    if (event.button === 'left' && !event.isCoalesced && event.dX != 0) {\r\n\r\n                        const offsetX = event.pageX - event.relX;\r\n                        const offsetY = event.pageY - event.relY;\r\n\r\n                        this.internalZoomByStep(event.dX / 175, event.downPageX - offsetX, event.downPageY - offsetY);\r\n                        this.highResTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\r\n                        this.lastRenderedState = -1;\r\n                        this.reqFrame();\r\n\r\n                        this.onViewChange({\r\n                            changed: ['scale'],\r\n                            angle: this.targetTransformObj.angle,\r\n                            scale: this.targetTransformObj.scale\r\n                        });\r\n                    }\r\n                },\r\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\r\n                    if (comboStr !== 'z') {\r\n                        this.resetInputProcessor();\r\n                    } else {\r\n                        this.updateCursor(TMode.Zoom);\r\n                    }\r\n                },\r\n                onKeyUp: (keyStr, event, oldComboStr) => {\r\n                    this.resetInputProcessor();\r\n                }\r\n            },\r\n            picker: {\r\n                onPointer: (event) => {\r\n                    this.updateCursor(TMode.Pick);\r\n                    if (\r\n                        (['left', 'right'].includes(event.button) && !event.isCoalesced) ||\r\n                        event.type === 'pointerup'\r\n                    ) {\r\n                        const coord = this.workspaceToCanvasCoord({x: event.relX, y: event.relY});\r\n                        const pickedColor = this.klCanvas.getColorAt(coord.x, coord.y);\r\n                        p.onPick(pickedColor, event.type === 'pointerup');\r\n                        this.svgOverlay.updateColorPreview({\r\n                            x: event.relX,\r\n                            y: event.relY,\r\n                            color: pickedColor,\r\n                            isVisible: event.type !== 'pointerup'\r\n                        });\r\n\r\n                        if (event.type === 'pointerup') {\r\n                            this.resetInputProcessor();\r\n                        }\r\n                    }\r\n                },\r\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\r\n\r\n                },\r\n                onKeyUp: (keyStr, event, oldComboStr) => {\r\n\r\n                }\r\n            },\r\n            altPicker: {\r\n                onPointer: (event) => {\r\n                    this.updateCursor(TMode.Pick);\r\n                    if (\r\n                        (['left', 'right'].includes(event.button) && !event.isCoalesced) ||\r\n                        event.type === 'pointerup'\r\n                    ) {\r\n                        const coord = this.workspaceToCanvasCoord({x: event.relX, y: event.relY});\r\n                        const pickedColor = this.klCanvas.getColorAt(coord.x, coord.y);\r\n                        p.onPick(pickedColor, event.type === 'pointerup');\r\n                        this.svgOverlay.updateColorPreview({\r\n                            x: event.relX,\r\n                            y: event.relY,\r\n                            color: pickedColor,\r\n                            isVisible: event.type !== 'pointerup'\r\n                        });\r\n                    }\r\n                },\r\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\r\n                    if (comboStr !== 'alt') {\r\n                        this.resetInputProcessor();\r\n                    } else {\r\n                        this.updateCursor(TMode.Pick);\r\n                    }\r\n                },\r\n                onKeyUp: (keyStr, event, oldComboStr) => {\r\n                    this.resetInputProcessor();\r\n                }\r\n            },\r\n            rotate: {\r\n                onPointer: (event) => {\r\n                    this.updateCursor(event.button === 'left' ? TMode.Rotating : TMode.Rotate);\r\n\r\n                    if (event.type === 'pointerdown' && event.button === 'left') {\r\n                        this.oldTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\r\n                    } else if (event.button === 'left' && !event.isCoalesced && this.oldTransformObj) {\r\n\r\n\r\n                        const offsetX = event.pageX - event.relX;\r\n                        const offsetY = event.pageY - event.relY;\r\n                        //rotation done around center\r\n                        const centerObj = {\r\n                            x: this.renderWidth / 2,\r\n                            y: this.renderHeight / 2\r\n                        };\r\n\r\n                        const startAngleRad = BB.Vec2.angle(centerObj, {x: event.downPageX - offsetX, y: event.downPageY - offsetY});\r\n                        const angleRad = BB.Vec2.angle(centerObj, {x: event.pageX - offsetX, y: event.pageY - offsetY});\r\n                        let dAngleRad = angleRad - startAngleRad;\r\n\r\n                        //apply angle\r\n                        this.targetTransformObj = JSON.parse(JSON.stringify(this.oldTransformObj));\r\n                        this.targetTransformObj.angle += dAngleRad;\r\n\r\n                        if (this.keyListener.isPressed('shift')) {\r\n                            this.targetTransformObj.angle = Math.round(this.targetTransformObj.angle / Math.PI * 8) * Math.PI / 8; //snap the angle to 45/2 degs\r\n                            dAngleRad = this.targetTransformObj.angle - this.oldTransformObj.angle;\r\n                        }\r\n\r\n                        this.targetTransformObj.angle = this.minimizeAngleRad(this.targetTransformObj.angle);\r\n\r\n                        //rotate transform.xy\r\n                        let matrix = BB.Matrix.getIdentity();\r\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(centerObj.x, centerObj.y));\r\n                        //matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(effectiveFactor));\r\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(dAngleRad));\r\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-centerObj.x, -centerObj.y));\r\n                        //matrix = multiplyMatrices(matrix, createTranslationMatrix(val.x - val.startX, val.y - val.startY));\r\n\r\n                        let origin = [this.targetTransformObj.x, this.targetTransformObj.y, 0, 1];\r\n                        origin = BB.Matrix.multiplyMatrixAndPoint(matrix, origin);\r\n                        this.targetTransformObj.x = origin[0];\r\n                        this.targetTransformObj.y = origin[1];\r\n\r\n                        this.highResTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\r\n\r\n                        this.transformIsDirty = true;\r\n                        this.lastRenderedState = -1;\r\n                        this.reqFrame();\r\n\r\n                        this.onViewChange({\r\n                            changed: ['angle'],\r\n                            scale: this.targetTransformObj.scale,\r\n                            angle: this.targetTransformObj.angle\r\n                        });\r\n\r\n                    }\r\n                },\r\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\r\n                    if (['r', 'r+shift', 'shift+r', 'r+left', 'r+right', 'r+left+right', 'r+right+left', 'r+up'].includes(comboStr)) {\r\n                        this.updateCursor(TMode.Rotate);\r\n                    } else {\r\n                        this.resetInputProcessor();\r\n                    }\r\n                },\r\n                onKeyUp: (keyStr, event, oldComboStr) => {\r\n                    const comboStr = this.keyListener.getComboStr();\r\n                    if (['r', 'r+shift', 'shift+r', 'r+left', 'r+right', 'r+left+right', 'r+right+left', 'r+up'].includes(comboStr)) {\r\n                        this.updateCursor(TMode.Rotate);\r\n                    } else {\r\n                        this.resetInputProcessor();\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        this.currentInputProcessor = null;\r\n\r\n\r\n        this.angleIsExtraSticky = false;\r\n        this.pinchZoomer = new BB.EventChain.PinchZoomer({\r\n            onPinch: (event) => {\r\n\r\n                if (event.type === 'move') {\r\n\r\n                    if (!this.oldTransformObj) {\r\n                        this.oldTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\r\n                        this.angleIsExtraSticky = this.targetTransformObj.angle % (Math.PI / 2) === 0;\r\n                    }\r\n\r\n                    this.targetTransformObj = JSON.parse(JSON.stringify(this.oldTransformObj));\r\n\r\n                    event.scale = Math.max(MIN_SCALE, Math.min(MAX_SCALE, this.targetTransformObj.scale * event.scale)) / this.targetTransformObj.scale;\r\n\r\n                    this.targetTransformObj.scale *= event.scale;\r\n                    this.targetTransformObj.angle += event.angleRad;\r\n                    this.targetTransformObj.angle = this.minimizeAngleRad(\r\n                        this.snapAngleRad(\r\n                            this.targetTransformObj.angle,\r\n                            90,\r\n                            this.angleIsExtraSticky ? 12 : 4\r\n                        )\r\n                    );\r\n                    if (this.targetTransformObj.angle % (Math.PI / 2) !== 0) {\r\n                        this.angleIsExtraSticky = false;\r\n                    }\r\n                    //targetTransformObj.angle = minimizeAngleRad(snapAngleRad(targetTransformObj.angle, 90, 7));\r\n                    event.angleRad = this.targetTransformObj.angle - this.oldTransformObj.angle;\r\n\r\n                    //calc translation\r\n                    {\r\n                        let matrix = BB.Matrix.getIdentity();\r\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(event.relX, event.relY));\r\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(event.scale));\r\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(event.angleRad));\r\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-event.relX, -event.relY));\r\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(event.relX - event.downRelX, event.relY - event.downRelY));\r\n\r\n\r\n                        let origin = [this.targetTransformObj.x, this.targetTransformObj.y, 0, 1];\r\n                        origin = BB.Matrix.multiplyMatrixAndPoint(matrix, origin);\r\n\r\n                        this.targetTransformObj.x = origin[0];\r\n                        this.targetTransformObj.y = origin[1];\r\n\r\n                    }\r\n\r\n                    this.highResTransformObj = BB.copyObj(this.targetTransformObj);\r\n\r\n                    //if (event.scale !== 1) {\r\n                    this.onViewChange({\r\n                        changed: ['scale', 'angle'],\r\n                        scale: this.targetTransformObj.scale,\r\n                        angle: this.targetTransformObj.angle\r\n                    });\r\n                    //}\r\n                    this.reqFrame();\r\n                    this.transformIsDirty = true;\r\n                    this.lastRenderedState = -1;\r\n\r\n\r\n                } else if (event.type === 'end') {\r\n                    this.oldTransformObj = null;\r\n                }\r\n\r\n\r\n            }\r\n        });\r\n\r\n        const onDoubleTap = () => {\r\n            let oldTransform = JSON.parse(JSON.stringify(this.targetTransformObj));\r\n            _this.fitView();\r\n            //_this.resetView(true);\r\n            this.lastRenderedState = -1;\r\n            this.reqFrame();\r\n\r\n            if (\r\n                oldTransform.scale !== this.targetTransformObj.scale ||\r\n                oldTransform.angle !== this.targetTransformObj.angle\r\n            ) {\r\n                this.onViewChange({\r\n                    changed: ['scale', 'angle'],\r\n                    angle: this.targetTransformObj.angle,\r\n                    scale: this.targetTransformObj.scale\r\n                });\r\n            }\r\n        }\r\n\r\n        this.mainDoubleTapper = new BB.EventChain.DoubleTapper({ onDoubleTap });\r\n        this.middleDoubleTapper = new BB.EventChain.DoubleTapper({ onDoubleTap });\r\n        this.middleDoubleTapper.setAllowedButtonArr(['middle']);\r\n\r\n\r\n        this.twoFingerTap = new BB.EventChain.NFingerTapper({\r\n            fingers: 2,\r\n            onTap: () => {\r\n                p.onUndo();\r\n            }\r\n        });\r\n        this.threeFingerTap = new BB.EventChain.NFingerTapper({\r\n            fingers: 3,\r\n            onTap: () => {\r\n                p.onRedo();\r\n            }\r\n        });\r\n\r\n\r\n        this.pointerEventChain = new BB.EventChain.EventChain({\r\n            chainArr: [\r\n                this.twoFingerTap,\r\n                this.threeFingerTap,\r\n                this.mainDoubleTapper,\r\n                this.middleDoubleTapper,\r\n                this.pinchZoomer,\r\n                new BB.EventChain.OnePointerLimiter(),\r\n                new BB.EventChain.CoalescedExploder()\r\n            ]\r\n        });\r\n        this.pointerEventChain.setChainOut((event) => {\r\n\r\n            this.cursorPos.x = event.relX;\r\n            this.cursorPos.y = event.relY;\r\n            if (event.type === 'pointerup' && event.pointerType === 'touch') {\r\n                this.pointer = null;\r\n                this.lastRenderedState = -1;\r\n                this.reqFrame();\r\n            } else {\r\n                if (!this.pointer) {\r\n                    this.pointer = { x: 0, y: 0 };\r\n                }\r\n                this.pointer.x = event.relX;\r\n                this.pointer.y = event.relY;\r\n            }\r\n\r\n            if (this.currentInputProcessor) {\r\n                this.currentInputProcessor.onPointer(event);\r\n\r\n            } else {\r\n\r\n                let comboStr = this.keyListener.getComboStr();\r\n\r\n                if (this.globalMode === TMode.Draw) {\r\n\r\n                    if (['', 'shift', 'ctrl'].includes(comboStr) && event.type === 'pointerdown' && event.button === 'left') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.draw;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.picker;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.hand;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else {\r\n                        this.updateCursor(TMode.Draw);\r\n                        this.reqFrame();\r\n                    }\r\n\r\n                } else if (this.globalMode === TMode.Hand) {\r\n\r\n                    if (event.type === 'pointerdown' && ['left', 'middle'].includes(event.button)) {\r\n                        this.currentInputProcessor = this.inputProcessorObj.hand;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.picker;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else {\r\n                        this.updateCursor(TMode.Hand);\r\n                    }\r\n\r\n                } else if (this.globalMode === TMode.Pick) {\r\n\r\n                    if (event.type === 'pointerdown' && ['left', 'right'].includes(event.button)) {\r\n                        this.currentInputProcessor = this.inputProcessorObj.picker;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.hand;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else {\r\n                        this.updateCursor(TMode.Pick);\r\n                    }\r\n\r\n                } else if (this.globalMode === TMode.Fill) {\r\n\r\n                    if (event.type === 'pointerdown' && event.button === 'left') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.fill;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.picker;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.hand;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else {\r\n                        this.updateCursor(TMode.Fill);\r\n                        this.reqFrame();\r\n                    }\r\n\r\n                } else if (this.globalMode === TMode.Text) {\r\n\r\n                    if (event.type === 'pointerdown' && event.button === 'left') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.text;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.picker;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.hand;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else {\r\n                        this.updateCursor(TMode.Text);\r\n                        this.reqFrame();\r\n                    }\r\n\r\n                } else if (this.globalMode === TMode.Shape) {\r\n\r\n                    if (['', 'shift', 'ctrl'].includes(comboStr) && event.type === 'pointerdown' && event.button === 'left') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.shape;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.picker;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\r\n                        this.currentInputProcessor = this.inputProcessorObj.hand;\r\n                        this.currentInputProcessor.onPointer(event);\r\n                    } else {\r\n                        this.updateCursor(TMode.Shape);\r\n                        this.reqFrame();\r\n                    }\r\n\r\n                }\r\n\r\n\r\n            }\r\n\r\n        });\r\n\r\n        //prevent ctrl scroll -> zooming page\r\n        BB.addEventListener(this.rootEl, 'wheel', (event) => {\r\n            event.preventDefault();\r\n        });\r\n\r\n\r\n        setTimeout(() => {\r\n            this.pointerListener = new BB.PointerListener({\r\n                target: this.rootEl,\r\n                fixScribble: true,\r\n                onPointer: (e) => {\r\n                    if (e.type === 'pointerdown' && e.button === 'middle') {\r\n                        try {\r\n                            e.eventPreventDefault();\r\n                        } catch (e) {}\r\n                    }\r\n                    /*if (e.type === 'pointermove') {\r\n                        BB.throwOut(JSON.stringify(e));\r\n                    }*/\r\n\r\n                    this.pointerEventChain.chainIn(e)\r\n                },\r\n                onWheel: (wheelEvent) => {\r\n\r\n                    if (this.isDrawing) {\r\n                        return;\r\n                    }\r\n\r\n                    this.reqFrame();\r\n                    let didZoom = this.internalZoomByStep(\r\n                        -wheelEvent.deltaY / (this.keyListener.isPressed('shift') ? 8 : 2),\r\n                        wheelEvent.relX,\r\n                        wheelEvent.relY\r\n                    );\r\n                    if (didZoom) {\r\n                        this.onViewChange({\r\n                            changed: ['scale'],\r\n                            angle: this.targetTransformObj.angle,\r\n                            scale: this.targetTransformObj.scale\r\n                        });\r\n                    }\r\n\r\n                    //updateCursor(TMode.Draw, true);\r\n                    this.lastRenderedState = -1;\r\n\r\n\r\n                },\r\n                onEnterLeave: (isOver) => {\r\n                    if (!isOver) {\r\n                        if (!this.isDrawing) {\r\n                            this.pointer = null;\r\n                            this.lastRenderedState = -1;\r\n                        }\r\n                    }\r\n                },\r\n                maxPointers: 4\r\n            });\r\n        }, 1);\r\n\r\n        this.brushRadius = 1;\r\n\r\n        this.animationFrameRequested = false;\r\n\r\n\r\n\r\n\r\n        //setup rendering\r\n        this.lastRenderedState = -2;\r\n        this.lastRenderTime = performance.now();\r\n\r\n        window.requestAnimationFrame(() => this.updateLoop());\r\n\r\n        this.resetView();\r\n    }\r\n\r\n\r\n    getElement (): HTMLElement {\r\n        return this.rootEl;\r\n    }\r\n\r\n    setCanvas (klC: KlCanvas): void {\r\n        this.klCanvas = klC;\r\n        this.lastDrawEvent = null;\r\n        this.resetView();\r\n\r\n        this.updateChangeListener();\r\n\r\n        this.lastRenderedState = -1;\r\n        this.reqFrame();\r\n    }\r\n\r\n    /**\r\n     * set size of workspace area in pixels\r\n     * @param width\r\n     * @param height\r\n     */\r\n    setSize (width: number, height: number): void {\r\n        const oldWidth = this.renderWidth;\r\n        const oldHeight = this.renderHeight;\r\n\r\n        if (width === oldWidth && height === oldHeight) {\r\n            return;\r\n        }\r\n\r\n        this.doResizeCanvas = true;\r\n        this.renderWidth = width;\r\n        this.renderHeight = height;\r\n\r\n        this.svgOverlay.setSize(width, height);\r\n\r\n        this.targetTransformObj.x += (width - oldWidth) / 2;\r\n        this.targetTransformObj.y += (height - oldHeight) / 2;\r\n\r\n        this.highResTransformObj.x = this.targetTransformObj.x;\r\n        this.highResTransformObj.y = this.targetTransformObj.y;\r\n\r\n        this.bgVisible = this.testBgVisible();\r\n\r\n        this.lastRenderedState = -1;\r\n        this.reqFrame();\r\n    }\r\n\r\n    setMode (modeStr: TModeStr): void {\r\n        //only sets the base mode\r\n        if (modeStr === 'draw') {\r\n            this.globalMode = TMode.Draw;\r\n            this.mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\r\n        }\r\n        if (modeStr === 'fill') {\r\n            this.globalMode = TMode.Fill;\r\n            this.mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\r\n        }\r\n        if (modeStr === 'text') {\r\n            this.globalMode = TMode.Text;\r\n            this.mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\r\n        }\r\n        if (modeStr === 'shape') {\r\n            this.globalMode = TMode.Shape;\r\n            this.mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\r\n        }\r\n        if (modeStr === 'hand') {\r\n            this.globalMode = TMode.Hand;\r\n            this.mainDoubleTapper.setAllowedPointerTypeArr(['mouse', 'pen', 'touch']);\r\n        }\r\n        if (modeStr === 'pick') {\r\n            this.globalMode = TMode.Pick;\r\n            this.mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\r\n        }\r\n    }\r\n\r\n    setEnabled (b: boolean): void {\r\n        // todo\r\n    }\r\n\r\n    setCursorSize (diameter: number): void {\r\n        this.brushRadius = diameter / 2;\r\n\r\n        this.svgOverlay.updateCursor({radius: this.brushRadius * this.highResTransformObj.scale});\r\n\r\n        if (this.pointer === null) {\r\n            clearTimeout(this.hideBrushCursorTimeout);\r\n\r\n            this.svgOverlay.updateCursor({\r\n                x: this.renderWidth / 2,\r\n                y: this.renderHeight / 2,\r\n                isVisible: true\r\n            });\r\n\r\n            // @ts-ignore\r\n            this.hideBrushCursorTimeout = setTimeout(() => {\r\n                if (this.pointer !== null) {\r\n                    return;\r\n                }\r\n                this.svgOverlay.updateCursor({isVisible: false});\r\n            }, 500);\r\n        }\r\n    }\r\n\r\n    zoomByStep (stepNum: number): void {\r\n        if (!this.internalZoomByStep(stepNum, this.renderWidth / 2, this.renderHeight / 2)) {\r\n            return;\r\n        }\r\n\r\n        this.lastRenderedState = -1;\r\n        this.reqFrame();\r\n\r\n        this.onViewChange({\r\n            changed: ['scale'],\r\n            angle: this.targetTransformObj.angle,\r\n            scale: this.targetTransformObj.scale\r\n        });\r\n    }\r\n\r\n    resetView (doAnimate?: boolean): void {\r\n        this.targetTransformObj.scale = 1;\r\n        this.targetTransformObj.angle = 0;\r\n\r\n        this.targetTransformObj.x = (this.renderWidth - this.klCanvas.getWidth()) / 2;\r\n        this.targetTransformObj.y = (this.renderHeight - this.klCanvas.getHeight()) / 2;\r\n\r\n        if (!doAnimate) {\r\n            this.highResTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\r\n        } else {\r\n            this.doAnimateTranslate = true;\r\n            this.transformIsDirty = true;\r\n        }\r\n\r\n        this.bgVisible = this.testBgVisible();\r\n        this.reqFrame();\r\n\r\n        if (doAnimate) {\r\n            this.onViewChange({\r\n                changed: ['scale', 'angle'],\r\n                scale: this.targetTransformObj.scale,\r\n                angle: this.targetTransformObj.angle\r\n            });\r\n        }\r\n    }\r\n\r\n    fitView (): void {\r\n        //fit into view. center. keep angle. margin of 10px\r\n\r\n        //calc width and height of bounds\r\n        const canvasPointsArr = [\r\n            [0, 0], // top left\r\n            [this.klCanvas.getWidth(), 0], // top right\r\n            [this.klCanvas.getWidth(), this.klCanvas.getHeight()], // bottom right\r\n            [0, this.klCanvas.getHeight()], // bottom left\r\n            [this.klCanvas.getWidth() / 2, this.klCanvas.getHeight() / 2], // center\r\n        ];\r\n\r\n        //setup transformation matrix\r\n        let matrix = BB.Matrix.getIdentity();\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(this.targetTransformObj.angle));\r\n\r\n        //rotate points\r\n        for (let i = 0; i < canvasPointsArr.length; i++) {\r\n            let coords = [canvasPointsArr[i][0], canvasPointsArr[i][1], 0, 1];\r\n            coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\r\n            canvasPointsArr[i][0] = coords[0];\r\n            canvasPointsArr[i][1] = coords[1];\r\n        }\r\n\r\n        const boundsObj = {\r\n            x0: null,\r\n            y0: null,\r\n            x1: null,\r\n            y1: null\r\n        };\r\n        for (let i = 0; i < canvasPointsArr.length; i++) {\r\n            if (boundsObj.x0 === null || canvasPointsArr[i][0] < boundsObj.x0) {\r\n                boundsObj.x0 = canvasPointsArr[i][0];\r\n            }\r\n            if (boundsObj.y0 === null || canvasPointsArr[i][1] < boundsObj.y0) {\r\n                boundsObj.y0 = canvasPointsArr[i][1];\r\n            }\r\n            if (boundsObj.x1 === null || canvasPointsArr[i][0] > boundsObj.x1) {\r\n                boundsObj.x1 = canvasPointsArr[i][0];\r\n            }\r\n            if (boundsObj.y1 === null || canvasPointsArr[i][1] > boundsObj.y1) {\r\n                boundsObj.y1 = canvasPointsArr[i][1];\r\n            }\r\n        }\r\n        const boundsWidth = boundsObj.x1 - boundsObj.x0;\r\n        const boundsHeight = boundsObj.y1 - boundsObj.y0;\r\n\r\n        //fit bounds\r\n        const padding = 40;\r\n        const fit = BB.fitInto(\r\n            boundsWidth,\r\n            boundsHeight, \r\n            this.renderWidth - padding, \r\n            this.renderHeight - padding, \r\n            1\r\n        );\r\n\r\n        //determine scale\r\n        const factor = fit.width / boundsWidth;\r\n\r\n        //center\r\n        this.targetTransformObj.x = (this.renderWidth / 2) - (canvasPointsArr[4][0] - canvasPointsArr[0][0]) * factor;\r\n        this.targetTransformObj.y = (this.renderHeight / 2) - (canvasPointsArr[4][1] - canvasPointsArr[0][1]) * factor;\r\n\r\n        this.targetTransformObj.scale = factor;\r\n        this.doAnimateTranslate = true;\r\n        this.transformIsDirty = true;\r\n        this.reqFrame();\r\n\r\n        this.onViewChange({\r\n            changed: ['scale', 'angle'],\r\n            scale: this.targetTransformObj.scale,\r\n            angle: this.targetTransformObj.angle\r\n        });\r\n    }\r\n\r\n    setAngle (angleDeg: number, isRelative?: boolean): void {\r\n        //rotation done around center\r\n        const centerObj = {\r\n            x: this.renderWidth / 2,\r\n            y: this.renderHeight / 2\r\n        };\r\n\r\n        const oldAngleRad = this.targetTransformObj.angle;\r\n        const angleRad = angleDeg / 180 * Math.PI;\r\n\r\n        if (isRelative) {\r\n            this.targetTransformObj.angle += angleRad;\r\n        } else {\r\n            this.targetTransformObj.angle = angleRad;\r\n        }\r\n\r\n        this.targetTransformObj.angle = this.minimizeAngleRad(\r\n            this.snapAngleRad(\r\n                this.targetTransformObj.angle,\r\n                90,\r\n                4\r\n            )\r\n        );\r\n\r\n        //rotate transform.xy\r\n        let matrix = BB.Matrix.getIdentity();\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(centerObj.x, centerObj.y));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(this.targetTransformObj.angle - oldAngleRad));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-centerObj.x, -centerObj.y));\r\n\r\n        let origin = [this.targetTransformObj.x, this.targetTransformObj.y, 0, 1];\r\n        origin = BB.Matrix.multiplyMatrixAndPoint(matrix, origin);\r\n        this.targetTransformObj.x = origin[0];\r\n        this.targetTransformObj.y = origin[1];\r\n\r\n        this.highResTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\r\n        this.transformIsDirty = true;\r\n        this.reqFrame(true);\r\n    }\r\n\r\n    /**\r\n     * translate canvas by viewport pixels\r\n     * @param tx\r\n     * @param ty\r\n     */\r\n    translateView (tx: number, ty: number): void {\r\n        const scale = 40;\r\n\r\n        this.targetTransformObj.x += tx * scale;\r\n        this.targetTransformObj.y += ty * scale;\r\n\r\n        this.transformIsDirty = true;\r\n        this.doAnimateTranslate = true;\r\n        this.reqFrame(true);\r\n    }\r\n\r\n    getIsDrawing (): boolean {\r\n        return this.isDrawing;\r\n    }\r\n\r\n    getScale (): number {\r\n        return this.targetTransformObj.scale;\r\n    }\r\n\r\n    getAngleDeg (): number {\r\n        return this.targetTransformObj.angle * 180 / Math.PI;\r\n    }\r\n\r\n    getMaxScale (): number {\r\n        return MAX_SCALE;\r\n    }\r\n\r\n    getMinScale (): number {\r\n        return MIN_SCALE;\r\n    }\r\n\r\n    requestFrame (): void {\r\n        this.lastRenderedState = -1;\r\n        this.reqFrame();\r\n    }\r\n\r\n    setLastDrawEvent (x: number | null, y?: number, pressure?: number): void {\r\n        if (x === null) {\r\n            this.lastDrawEvent = null;\r\n            return;\r\n        }\r\n\r\n        if (!this.lastDrawEvent) {\r\n            this.lastDrawEvent = {x: 0, y: 0, pressure: 0};\r\n        }\r\n        this.lastDrawEvent.x = x;\r\n        this.lastDrawEvent.y = y;\r\n        this.lastDrawEvent.pressure = pressure;\r\n    }\r\n\r\n}\r\n","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"1dLwT\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"9wZxU\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"hQSEH\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"916ZI\");","import {BB} from '../../bb/bb';\r\nimport {IKlBasicLayer} from '../kl.types';\r\n\r\n/**\r\n * preview of image with layers. can do mix modes and opacity.\r\n * creates a canvas.\r\n *\r\n * p = {\r\n *     width: 123,\r\n *     height: 123,\r\n *     layers: [// can be changed after the fact\r\n *         {\r\n *             image: Canvas,\r\n *             opacity: 1,\r\n *             mixModeStr: 'source-over'\r\n *         }\r\n *     ]\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function KlCanvasPreview(\r\n    p: {\r\n        width: number;\r\n        height: number;\r\n        layers: IKlBasicLayer[];\r\n    }\r\n) {\r\n    const scale = p.width / p.layers[0].image.width;\r\n    const width = scale > 1 ? p.layers[0].image.width : p.width;\r\n    const height = scale > 1 ? p.layers[0].image.height : p.height;\r\n\r\n    let canvas = BB.canvas(width, height);\r\n    canvas.style.backgroundImage = 'url(' + BB.createCheckerDataUrl(8) + ')';\r\n    let ctx = canvas.getContext('2d');\r\n\r\n    BB.css(canvas, {\r\n        width: '100%',\r\n        height: '100%',\r\n        imageRendering: scale > 1 ? 'pixelated' : null,\r\n    });\r\n\r\n    function render() {\r\n        ctx.save();\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n        for (let i = 0; i < p.layers.length; i++) {\r\n            ctx.globalAlpha = p.layers[i].opacity;\r\n            ctx.globalCompositeOperation = p.layers[i].mixModeStr;\r\n            if (canvas.width > p.layers[i].image.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(p.layers[i].image, 0, 0, canvas.width, canvas.height);\r\n        }\r\n        ctx.restore();\r\n    }\r\n\r\n    setTimeout(render, 0);\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return canvas;\r\n    };\r\n\r\n    this.render = function() {\r\n        render();\r\n    };\r\n}","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport rotateImg from 'url:~/src/app/img/ui/cursor-rotate.png';\r\nimport {KeyListener} from '../../../bb/input/key-listener';\r\nimport {IVector2D} from '../../../bb/bb.types';\r\n\r\nexport interface ITransform {\r\n    x: number; // center of transform region. image space\r\n    y: number;\r\n    width: number; // size of transform region. image space\r\n    height: number;\r\n    angleDeg: number; // angle of transform region. degrees\r\n}\r\n\r\n\r\n/**\r\n * snap entire transform to pixel grid. changes transform\r\n *\r\n * for x y:\r\n * If a dimension has an even size, it be an integer.\r\n * If it's uneven, it's sits exactly half way between two pixels.\r\n *\r\n * @param transform\r\n */\r\nfunction snapToPixel(transform: ITransform): void {\r\n    if (Math.abs(transform.angleDeg) % 90 !== 0) {\r\n        return;\r\n    }\r\n\r\n    transform.width = Math.round(transform.width);\r\n    transform.height = Math.round(transform.height);\r\n    // 0° is original orientation.\r\n    // At 90° and 270° width and height become swapped due to different orientation.\r\n    const whSwapped = Math.abs(transform.angleDeg - 90) % 180 === 0;\r\n    transform.x = ((whSwapped ? transform.height : transform.width) % 2 === 0) ? Math.round(transform.x) : Math.round(transform.x - 0.5) + 0.5;\r\n    transform.y = ((whSwapped ? transform.width : transform.height) % 2 === 0)  ? Math.round(transform.y) : Math.round(transform.y - 0.5) + 0.5;\r\n}\r\n\r\nfunction copyTransform(transform: ITransform): ITransform {\r\n    return {\r\n        x: transform.x,\r\n        y: transform.y,\r\n        width: transform.width,\r\n        height: transform.height,\r\n        angleDeg: transform.angleDeg,\r\n    };\r\n}\r\n\r\n/**\r\n * image space to transform space\r\n * - origin of transform space is at center of transform bounds.\r\n * - same scale as image space. -> one unit is x: 1/width, y: 1/height\r\n * - up is where transform points up\r\n * - x goes right\r\n * - y goes down\r\n * @param x\r\n * @param y\r\n * @param transform\r\n */\r\nfunction toTransformSpace (x: number, y: number, transform: ITransform): IVector2D {\r\n    let px, py;\r\n    px = x - transform.x;\r\n    py = y - transform.y;\r\n\r\n    const rot = BB.rotateAround({x: 0, y: 0},\r\n        {x: px, y: py},\r\n        -transform.angleDeg);\r\n    px = rot.x;\r\n    py = rot.y;\r\n\r\n    return {\r\n        x: px,\r\n        y: py,\r\n    };\r\n}\r\n\r\n/**\r\n * transform space to image space\r\n * @param x\r\n * @param y\r\n * @param transform\r\n */\r\nfunction toImageSpace(x: number, y: number, transform: ITransform): IVector2D {\r\n    const rot = BB.rotateAround({x: 0, y: 0},\r\n        {x: x, y: y},\r\n        transform.angleDeg);\r\n    return {\r\n        x: rot.x + transform.x,\r\n        y: rot.y + transform.y,\r\n    };\r\n}\r\n\r\n\r\n\r\n/**\r\n * Free Transform UI\r\n * rotate, scale, translate\r\n *\r\n * - if rotation is multiple of 90° it will snap to pixels, to be more useful for pixel art\r\n * - when rotation goes from non-multiple of 90° to a multiple, it will snap position and width height to pixels\r\n * - transform.x, transform.y can sit between pixels (by 0.5) if width or height is odd number.\r\n *      - this is what complicates things\r\n * - if transform region small, corner grips move out of the way\r\n *\r\n * iX iY, iP.x, iP.y - i indicates image space\r\n * tX tY, tP.x, tP.y - t indicates transform space\r\n *\r\n * Not sure if can be used for navigable canvas. (especially if canvas rotates view)\r\n * Probably can't be extended for distort. Needs a different approach.\r\n *\r\n * --- DOM structure ---\r\n * rootEl {\r\n * \ttransEl [\r\n * \t\tboundsEl\r\n * \t\tedges[]\r\n * \t\tcorners[] - round grips in the corner of transform region\r\n * \t\tangleGrip\r\n * \t]\r\n * }\r\n *\r\n */\r\nexport class FreeTransform {\r\n\r\n    // --- private ---\r\n    private readonly transform: ITransform; // coordinates and dimensions of transformation\r\n    private isConstrained: boolean;\r\n    private ratio: number; // aspect ratio of transform\r\n    private readonly scale: number;\r\n    private readonly scaled = { // scaled coordinates and dimensions for screenspace\r\n        x: 0,\r\n        y: 0,\r\n        width: 0,\r\n        height: 0,\r\n        corners: [{x: 0, y: 0}], // in transform space\r\n    };\r\n    private readonly minSnapDist = 7; // minimal snapping distance in px screenspace\r\n    private snappingEnabled: boolean;\r\n    private readonly snapX: number[];\r\n    private readonly snapY: number[];\r\n    private readonly callback: (transform: ITransform) => void;\r\n\r\n\r\n    private readonly cornerCursors = ['nw', 'n', 'ne', 'e', 'se', 's', 'sw', 'w'];\r\n    private readonly gripSize = 14;\r\n    private readonly edgeSize = 10;\r\n\r\n    private readonly rootEl: HTMLElement; // sits at origin of image\r\n    private readonly transEl: HTMLElement; // at middle of transform. rotates\r\n    private readonly boundsEl: HTMLElement; // draggable bounds rectangle with outline\r\n    private readonly corners: {\r\n        i: number; // index in corners array\r\n        el: HTMLElement; // draggable corner circle in DOM\r\n        x: number; // unscaled position (transform space)\r\n        y: number;\r\n        virtualPos: IVector2D; // unscaled temporary position (image space)\r\n        updateDOM: () => void; // update styling in DOM\r\n        pointerListener: any;\r\n    }[] = [];\r\n    private keyListener: KeyListener;\r\n    private boundsPointerListener: any; // BB.PointerListener\r\n    private anglePointerListener: any; // BB.PointerListener\r\n    private readonly edges: { // derive position from corners\r\n        el: HTMLElement;\r\n        updateDOM: () => void;\r\n        pointerListener: any;\r\n    }[] = [];\r\n    private readonly angleGrip: {\r\n        el: HTMLElement,\r\n        x: number; // transform space\r\n        y: number;\r\n        snap: boolean,\r\n        updateDOM: () => void,\r\n    };\r\n\r\n    private updateScaled(): void {\r\n        this.scaled.x = this.transform.x * this.scale;\r\n        this.scaled.y = this.transform.y * this.scale;\r\n        this.scaled.width = this.transform.width * this.scale;\r\n        this.scaled.height = this.transform.height * this.scale;\r\n        this.scaled.corners = this.corners.map((item) => {\r\n            return {x: item.x * this.scale, y: item.y * this.scale};\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Returns snapped point, if ix, iy snaps. If no snapping, returns point unchanged.\r\n     * both in image space\r\n     *\r\n     * @param iX - image space\r\n     * @param iY - image space\r\n     * @private\r\n     */\r\n    private snapCorner (iX: number, iY: number): IVector2D {\r\n        if (!this.snappingEnabled) {\r\n            return {x: iX, y: iY};\r\n        }\r\n        let dist: number;\r\n        const snap: {\r\n            x: number;\r\n            y: number;\r\n            dist: {\r\n                x: number;\r\n                y: number;\r\n            }\r\n        } = {\r\n            x: null,\r\n            y: null,\r\n            dist: {\r\n                x: null,\r\n                y: null,\r\n            }\r\n        };\r\n        for (let e = 0; e < this.snapX.length; e++) {\r\n            dist = Math.abs(iX - this.snapX[e]);\r\n            if (dist < this.minSnapDist / this.scale) {\r\n                if (snap.x === null || dist < snap.dist.x) {\r\n                    snap.x = this.snapX[e];\r\n                    snap.dist.x = dist;\r\n                }\r\n            }\r\n        }\r\n        for (let e = 0; e < this.snapY.length; e++) {\r\n            dist = Math.abs(iY - this.snapY[e]);\r\n            if (dist < this.minSnapDist / this.scale) {\r\n                if (snap.y === null || dist < snap.dist.y) {\r\n                    snap.y = this.snapY[e];\r\n                    snap.dist.y = dist;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (snap.x === null && snap.y === null) {\r\n            return {\r\n                x: iX,\r\n                y: iY,\r\n            };\r\n        }\r\n        return {\r\n            x: snap.x === null ? iX : snap.x,\r\n            y: snap.y === null ? iY : snap.y,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * If constrained return nearest corner pos that fits aspect ratio\r\n     *\r\n     * @param cornerIndex\r\n     * @param iX\r\n     * @param iY\r\n     * @private\r\n     */\r\n    private constrainCorner (cornerIndex: number, iX: number, iY: number): IVector2D {\r\n        if (!this.isConstrained) {\r\n            return {\r\n                x: iX,\r\n                y: iY,\r\n            };\r\n        }\r\n        const flip = this.transform.width * this.transform.height < 0 ? -1 : 1;\r\n        return BB.projectPointOnLine(\r\n            {x: this.transform.x, y: this.transform.y},\r\n            toImageSpace(this.ratio, flip * ([0, 2].includes(cornerIndex) ? 1 : -1), this.transform),\r\n            {x: iX, y: iY}\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Update corners according to width height.\r\n     * Not their DOM.\r\n     */\r\n    private updateCornerPositions (): void {\r\n        this.corners[0].x = (-this.transform.width / 2); // top left\r\n        this.corners[0].y = (-this.transform.height / 2);\r\n\r\n        this.corners[1].x = (this.transform.width / 2); // top right\r\n        this.corners[1].y = (-this.transform.height / 2);\r\n\r\n        this.corners[2].x = (this.transform.width / 2); // bottom right\r\n        this.corners[2].y = (this.transform.height / 2);\r\n\r\n        this.corners[3].x = (-this.transform.width / 2); // bottom left\r\n        this.corners[3].y = (this.transform.height / 2);\r\n    }\r\n\r\n    /**\r\n     * If constrained and dragging an edge, restore aspect ratio\r\n     * Updates corner positions.\r\n     *\r\n     * @param widthChanged\r\n     * @param heightChanged\r\n     * @private\r\n     */\r\n    private restoreRatio (widthChanged: boolean, heightChanged: boolean): void {\r\n        if (!this.isConstrained) {\r\n            return;\r\n        }\r\n        const angle90 = Math.abs(this.transform.angleDeg) % 90 === 0;\r\n        const whSwapped = Math.abs(this.transform.angleDeg - 90) % 180 === 0;\r\n        if (heightChanged && !widthChanged) {\r\n            const newHeight = Math.abs(this.corners[3].y - this.corners[0].y);\r\n            let newWidth = this.ratio * newHeight;\r\n            if (angle90) {\r\n                newWidth = (whSwapped ? this.transform.y % 1 : this.transform.x % 1) === 0 ?\r\n                    BB.roundEven(newWidth) : BB.roundUneven(newWidth);\r\n            }\r\n            if (this.corners[1].x - this.corners[0].x < 0) {\r\n                newWidth *= -1;\r\n            }\r\n            this.corners[0].x = -newWidth / 2;\r\n            this.corners[3].x = -newWidth / 2;\r\n            this.corners[1].x = newWidth / 2;\r\n            this.corners[2].x = newWidth / 2;\r\n        }\r\n        if (!heightChanged && widthChanged) {\r\n            const newWidth = Math.abs(this.corners[0].x - this.corners[1].x);\r\n            let newHeight = newWidth / this.ratio;\r\n            if (angle90) {\r\n                newHeight = (whSwapped ? this.transform.x % 1 : this.transform.y % 1) === 0  ?\r\n                    BB.roundEven(newHeight) : BB.roundUneven(newHeight);\r\n            }\r\n            if (this.corners[3].y - this.corners[0].y < 0) {\r\n                newHeight *= -1;\r\n            }\r\n            this.corners[0].y = -newHeight / 2;\r\n            this.corners[1].y = -newHeight / 2;\r\n            this.corners[2].y = newHeight / 2;\r\n            this.corners[3].y = newHeight / 2;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * update transform based on corners\r\n     * @private\r\n     */\r\n    private updateTransformViaCorners (): void {\r\n\r\n        // calc transform center in image space\r\n        const rot = BB.rotateAround(\r\n            {x: 0, y: 0},\r\n            {\r\n                x: (this.corners[0].x + this.corners[1].x) / 2,\r\n                y: (this.corners[0].y + this.corners[3].y) / 2,\r\n            },\r\n            this.transform.angleDeg\r\n        );\r\n        this.transform.x = rot.x + this.transform.x;\r\n        this.transform.y = rot.y + this.transform.y;\r\n\r\n        // update size\r\n        this.transform.width = this.corners[1].x - this.corners[0].x;\r\n        this.transform.height = this.corners[3].y - this.corners[0].y;\r\n\r\n        // new center means corners changed their position\r\n        this.updateCornerPositions();\r\n\r\n        this.updateDOM();\r\n    }\r\n\r\n    /**\r\n     * updates DOM according to transform\r\n     * @param skipCallback\r\n     */\r\n    private updateDOM (skipCallback?: boolean) {\r\n        this.updateScaled();\r\n\r\n        BB.css(this.transEl, {\r\n            left: this.scaled.x + \"px\",\r\n            top: this.scaled.y + \"px\",\r\n            transformOrigin: \"0 0\",\r\n            transform: \"rotate(\" + this.transform.angleDeg + \"deg)\",\r\n        });\r\n\r\n        BB.css(this.boundsEl, {\r\n            width: Math.abs(this.scaled.width) + \"px\",\r\n            height: Math.abs(this.scaled.height) + \"px\",\r\n            left: Math.min(this.scaled.corners[0].x, this.scaled.corners[1].x) + \"px\",\r\n            top: Math.min(this.scaled.corners[0].y, this.scaled.corners[3].y) + \"px\"\r\n        });\r\n\r\n        this.corners[0].updateDOM();\r\n        this.corners[1].updateDOM();\r\n        this.corners[2].updateDOM();\r\n        this.corners[3].updateDOM();\r\n\r\n        this.edges[0].updateDOM();\r\n        this.edges[1].updateDOM();\r\n        this.edges[2].updateDOM();\r\n        this.edges[3].updateDOM();\r\n\r\n\r\n        this.angleGrip.x = 0;\r\n        this.angleGrip.y = (-Math.abs(this.transform.height * this.scale) / 2) - 20;\r\n        this.angleGrip.updateDOM();\r\n        if (!skipCallback) {\r\n            if (this.callback) { // why should updateDOM trigger the callback?\r\n                this.callback(copyTransform(this.transform));\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    // --- public ---\r\n    constructor (\r\n        params: {\r\n            x: number; // center of transform region. image space\r\n            y: number;\r\n            width: number; // size of transform region. image space\r\n            height: number;\r\n            angleDeg: number; // angle of transform region. degrees\r\n\r\n            isConstrained: boolean; // proportions constrained\r\n            snapX: number[]; // where snapping along X axis. image space\r\n            snapY: number[]; // where snapping along X axis. image space\r\n            scale: number; // ratio of screen-space / image-space\r\n            callback: (transform: ITransform) => void;\r\n        }\r\n    ) {\r\n        this.transform = { // coordinates and dimensions of transformation\r\n            x: params.x,\r\n            y: params.y,\r\n            width: params.width,\r\n            height: params.height,\r\n            angleDeg: params.angleDeg,\r\n        };\r\n\r\n        this.isConstrained = !!params.isConstrained;\r\n\r\n        this.snapX = params.snapX;\r\n        this.snapY = params.snapY;\r\n        this.callback = params.callback;\r\n        this.scale = params.scale;\r\n        this.snappingEnabled = true;\r\n        this.ratio = this.transform.width / this.transform.height;\r\n\r\n        this.rootEl = BB.el({\r\n            className: 'kl-free-transform',\r\n            css: {\r\n                userSelect: 'none',\r\n            }\r\n        });\r\n        this.transEl = BB.el({\r\n            parent: this.rootEl,\r\n            css: {\r\n                position: 'absolute',\r\n            }\r\n        });\r\n\r\n        this.boundsEl = BB.el({\r\n            css: {\r\n                position: 'absolute',\r\n                cursor: 'move',\r\n                boxShadow: 'rgba(255, 255, 255, 0.5) 0 0 0 1px inset, rgba(0, 0, 0, 0.5) 0 0 0 1px',\r\n            }\r\n        });\r\n\r\n        const pointerRemainder = {\r\n            x: 0,\r\n            y: 0,\r\n        };\r\n        function resetRemainder() {\r\n            pointerRemainder.x = 0;\r\n            pointerRemainder.y = 0;\r\n        }\r\n        this.keyListener = new BB.KeyListener({});\r\n\r\n        let boundsStartP = {\r\n            x: 0,\r\n            y: 0,\r\n        }\r\n        this.boundsPointerListener = new BB.PointerListener({\r\n            target: this.boundsEl,\r\n            fixScribble: true,\r\n            onPointer: (event) => {\r\n                event.eventPreventDefault();\r\n                if (event.type === 'pointerdown') {\r\n                    boundsStartP = {x: this.transform.x, y: this.transform.y};\r\n                }\r\n                if (event.type === 'pointermove' && event.button === 'left') {\r\n                    this.transform.x = boundsStartP.x + (event.pageX - event.downPageX) / this.scale;\r\n                    this.transform.y = boundsStartP.y + (event.pageY - event.downPageY) / this.scale;\r\n\r\n\r\n                    let dist;\r\n                    let snap: any = {};\r\n                    if (this.snappingEnabled) {\r\n                        let i;\r\n                        for (i = 0; i < this.snapX.length; i++) {\r\n                            dist = Math.abs(this.transform.x - this.snapX[i]);\r\n                            if (dist < this.minSnapDist / this.scale) {\r\n                                if (!snap.x || dist < snap.distX) {\r\n                                    snap.x = this.snapX[i];\r\n                                    snap.distX = dist;\r\n                                }\r\n                            }\r\n                        }\r\n                        for (i = 0; i < this.snapY.length; i++) {\r\n                            dist = Math.abs(this.transform.y - this.snapY[i]);\r\n                            if (dist < this.minSnapDist / this.scale) {\r\n                                if (!snap.y || dist < snap.distY) {\r\n                                    snap.y = this.snapY[i];\r\n                                    snap.distY = dist;\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        let iP;\r\n                        for (i = 0; i < 4; i++) {\r\n                            iP = toImageSpace(this.corners[i].x, this.corners[i].y, this.transform);\r\n                            let j;\r\n                            for (j = 0; j < this.snapX.length; j++) {\r\n                                dist = Math.abs(iP.x - this.snapX[j]);\r\n                                if (dist < this.minSnapDist / this.scale) {\r\n                                    if (!snap.x || dist < snap.distX) {\r\n                                        snap.x = this.snapX[j] - (iP.x - this.transform.x);\r\n                                        snap.distX = dist;\r\n                                    }\r\n                                }\r\n                            }\r\n                            for (j = 0; j < this.snapY.length; j++) {\r\n                                dist = Math.abs(iP.y - this.snapY[j]);\r\n                                if (dist < this.minSnapDist / this.scale) {\r\n                                    if (!snap.y || dist < snap.distY) {\r\n                                        snap.y = this.snapY[j] - (iP.y - this.transform.y);\r\n                                        snap.distY = dist;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    if (this.keyListener.getComboStr() === 'shift') {\r\n                        let projected = BB.projectPointOnLine(\r\n                            {x: 0, y: boundsStartP.y},\r\n                            {x: 10, y: boundsStartP.y},\r\n                            {x: this.transform.x, y: this.transform.y});\r\n                        let dist = BB.dist(projected.x, projected.y, this.transform.x, this.transform.y);\r\n                        snap = {};\r\n                        snap.x = projected.x;\r\n                        snap.y = projected.y;\r\n                        snap.distX = dist;\r\n                        snap.distY = dist;\r\n\r\n                        projected = BB.projectPointOnLine(\r\n                            {x: boundsStartP.x, y: 0},\r\n                            {x: boundsStartP.x, y: 10},\r\n                            {x: this.transform.x, y: this.transform.y});\r\n                        dist = BB.dist(projected.x, projected.y, this.transform.x, this.transform.y);\r\n                        if (dist < snap.distX) {\r\n                            snap.x = projected.x;\r\n                            snap.y = projected.y;\r\n                            snap.distX = dist;\r\n                            snap.distY = dist;\r\n                        }\r\n\r\n                        projected = BB.projectPointOnLine(\r\n                            {x: boundsStartP.x, y: boundsStartP.y},\r\n                            {x: boundsStartP.x + 1, y: boundsStartP.y + 1},\r\n                            {x: this.transform.x, y: this.transform.y});\r\n                        dist = BB.dist(projected.x, projected.y, this.transform.x, this.transform.y);\r\n                        if (dist < snap.distX) {\r\n                            snap.x = projected.x;\r\n                            snap.y = projected.y;\r\n                            snap.distX = dist;\r\n                            snap.distY = dist;\r\n                        }\r\n\r\n                        projected = BB.projectPointOnLine(\r\n                            {x: boundsStartP.x, y: boundsStartP.y},\r\n                            {x: boundsStartP.x + 1, y: boundsStartP.y - 1},\r\n                            {x: this.transform.x, y: this.transform.y});\r\n                        dist = BB.dist(projected.x, projected.y, this.transform.x, this.transform.y);\r\n                        if (dist < snap.distX) {\r\n                            snap.x = projected.x;\r\n                            snap.y = projected.y;\r\n                            snap.distX = dist;\r\n                            snap.distY = dist;\r\n                        }\r\n                    }\r\n                    if (snap.x != undefined) {\r\n                        this.transform.x = snap.x;\r\n                    }\r\n                    if (snap.y != undefined) {\r\n                        this.transform.y = snap.y;\r\n                    }\r\n\r\n                    // snap to pixels\r\n                    if (Math.abs(this.transform.angleDeg) % 90 === 0) {\r\n                        snapToPixel(this.transform);\r\n                        this.updateCornerPositions();\r\n                    }\r\n\r\n                    this.updateDOM();\r\n                }\r\n            }\r\n        })\r\n\r\n        for (let i = 0; i < 4; i++) {\r\n            ((i) => {\r\n                const g = this.corners[i] = {\r\n                    i: i,\r\n                    el: BB.el({\r\n                        css: {\r\n                            width: this.gripSize + 'px',\r\n                            height: this.gripSize + 'px',\r\n                            background: '#fff',\r\n                            /*background: [\r\n                                '#ff0000',\r\n                                '#00ff00',\r\n                                '#0000ff',\r\n                                '#ff00ff',\r\n                            ][i],*/\r\n                            borderRadius: this.gripSize + 'px',\r\n                            position: 'absolute',\r\n                            boxShadow: 'inset 0 0 0 2px #000'\r\n                        }\r\n                    }),\r\n                    x: 0,\r\n                    y: 0,\r\n                    virtualPos: {\r\n                        x: 0,\r\n                        y: 0,\r\n                    },\r\n                    updateDOM: null,\r\n                    pointerListener: null,\r\n                };\r\n                g.updateDOM = () => {\r\n\r\n                    // grip position\r\n                    // if gets small, offset grips, so easier to handle\r\n                    const offsetArr = [[-1, -1], [1, -1], [1, 1], [-1, 1]].map(item => {\r\n                        item[0] *= this.transform.width > 0 ? 1 : -1;\r\n                        item[1] *= this.transform.height > 0 ? 1 : -1;\r\n                        return item;\r\n                    });\r\n                    const tinyOffset = Math.abs(this.scaled.width) < 20 || Math.abs(this.scaled.height) < 20 ? 10 : 0;\r\n\r\n                    BB.css(g.el, {\r\n                        left: (this.scaled.corners[g.i].x - this.gripSize / 2 + offsetArr[i][0] * tinyOffset) + 'px',\r\n                        top: (this.scaled.corners[g.i].y - this.gripSize / 2 + offsetArr[i][1] * tinyOffset) + 'px'\r\n                    });\r\n\r\n\r\n                    // cursor\r\n                    let angle = BB.pointsToAngleDeg(\r\n                        {\r\n                            x: this.transform.x,\r\n                            y: this.transform.y,\r\n                        },\r\n                        toImageSpace(g.x, g.y, this.transform),\r\n                    ) + 135; // offset so nw is 0\r\n                    while (angle < 0) {\r\n                        angle += 360;\r\n                    }\r\n                    let index = Math.round(angle / 45) % this.cornerCursors.length;\r\n                    BB.css(g.el, {\r\n                        cursor: this.cornerCursors[index] + '-resize',\r\n                    });\r\n                };\r\n\r\n                g.pointerListener = new BB.PointerListener({\r\n                    target: this.corners[i].el,\r\n                    fixScribble: true,\r\n                    onPointer: (event) => {\r\n                        event.eventPreventDefault();\r\n                        if (event.type === 'pointerdown' && event.button === 'left') {\r\n                            this.corners[i].virtualPos = toImageSpace(this.corners[i].x, this.corners[i].y, this.transform);\r\n\r\n                        } else if (event.type === 'pointermove' && event.button === 'left') {\r\n                            this.corners[i].virtualPos.x += event.dX / this.scale;\r\n                            this.corners[i].virtualPos.y += event.dY / this.scale;\r\n\r\n                            let iP = {\r\n                                x: this.corners[i].virtualPos.x,\r\n                                y: this.corners[i].virtualPos.y,\r\n                            };\r\n                            iP = this.constrainCorner(i, iP.x, iP.y);\r\n                            if (!this.isConstrained) {\r\n                                iP = this.snapCorner(iP.x, iP.y);\r\n                            }\r\n\r\n                            if (Math.abs(this.transform.angleDeg) % 90 === 0) {\r\n                                iP.x = Math.round(iP.x);\r\n                                iP.y = Math.round(iP.y);\r\n                            }\r\n\r\n                            const tP = toTransformSpace(iP.x, iP.y, this.transform);\r\n\r\n                            const dX = tP.x - this.corners[i].x;\r\n                            const dY = tP.y - this.corners[i].y;\r\n                            this.corners[i].x = tP.x;\r\n                            this.corners[i].y = tP.y;\r\n\r\n                            let indexes = [];\r\n                            if (i === 0) { // top left\r\n                                indexes = [3, 1, 2];\r\n                            } else if (i === 1) { // top right\r\n                                indexes = [2, 0, 3];\r\n                            } else if (i === 2) { // bottom right\r\n                                indexes = [1, 3, 0];\r\n                            } else if (i === 3) { // bottom left\r\n                                indexes = [0, 2, 1];\r\n                            }\r\n\r\n                            this.corners[indexes[0]].x = this.corners[i].x;\r\n                            this.corners[indexes[1]].y = this.corners[i].y;\r\n                            if (this.keyListener.isPressed('shift')) {\r\n                                this.corners[indexes[2]].x -= dX;\r\n                                this.corners[indexes[2]].y -= dY;\r\n                                this.corners[indexes[1]].x = this.corners[indexes[2]].x;\r\n                                this.corners[indexes[0]].y = this.corners[indexes[2]].y;\r\n                            }\r\n\r\n                            this.updateTransformViaCorners();\r\n\r\n                        }\r\n                    }\r\n                });\r\n\r\n            })(i);\r\n        }\r\n\r\n        this.updateCornerPositions();\r\n        this.updateScaled();\r\n\r\n        let isInverted: boolean;\r\n        for (let i = 0; i < 4; i++) {\r\n            ((i) => {\r\n                this.edges[i] = {\r\n                    el: BB.el({\r\n                        css: {\r\n                            width: this.edgeSize + 'px',\r\n                            height: this.edgeSize + 'px',\r\n                            /*background: [\r\n                                '#ff000044',\r\n                                '#00ff0044',\r\n                                '#0000ff44',\r\n                                '#ff00ff44',\r\n                            ][i],*/\r\n                            position: 'absolute',\r\n                        },\r\n                    }),\r\n                    updateDOM: null,\r\n                    pointerListener: null,\r\n                };\r\n                const g = this.edges[i];\r\n                g.updateDOM = () => {\r\n                    if (i === 0) {\r\n                        BB.css(g.el, {\r\n                            left: Math.min(this.scaled.corners[0].x, this.scaled.corners[1].x) + 'px',\r\n                            top: (Math.min(this.scaled.corners[0].y, this.scaled.corners[3].y) - this.edgeSize) + 'px',\r\n                            width: Math.abs(this.scaled.width) + 'px',\r\n                            height: this.edgeSize + 'px',\r\n                        });\r\n                    } else if (i === 1) {\r\n                        BB.css(g.el, {\r\n                            left: Math.max(this.scaled.corners[0].x, this.scaled.corners[1].x) + 'px',\r\n                            top: Math.min(this.scaled.corners[1].y, this.scaled.corners[2].y) + 'px',\r\n                            width: this.edgeSize + 'px',\r\n                            height: Math.abs(this.scaled.height) + 'px',\r\n                        });\r\n                    } else if (i === 2) {\r\n                        BB.css(g.el, {\r\n                            left: Math.min(this.scaled.corners[3].x, this.scaled.corners[2].x) + 'px',\r\n                            top: Math.max(this.scaled.corners[0].y,this.scaled.corners[3].y) + 'px',\r\n                            width: Math.abs(this.scaled.width) + 'px',\r\n                            height: this.edgeSize + 'px',\r\n                        });\r\n                    } else if (i === 3) {\r\n                        BB.css(g.el, {\r\n                            left: (Math.min(this.scaled.corners[0].x, this.scaled.corners[1].x) - this.edgeSize) + 'px',\r\n                            top: Math.min(this.scaled.corners[0].y, this.scaled.corners[3].y) + 'px',\r\n                            width: this.edgeSize + 'px',\r\n                            height: Math.abs(this.scaled.height) + 'px',\r\n                        });\r\n                    }\r\n                    let angleOffset = Math.round(this.transform.angleDeg / 45);\r\n                    while (angleOffset < 0)\r\n                        angleOffset += 8;\r\n                    angleOffset = (i * 2 + 1 + angleOffset) % this.cornerCursors.length;\r\n                    g.el.style.cursor = this.cornerCursors[angleOffset] + '-resize';\r\n\r\n                };\r\n\r\n                const isVertical = [0, 2].includes(i);\r\n                g.pointerListener = new BB.PointerListener({\r\n                    target: this.edges[i].el,\r\n                    fixScribble: true,\r\n                    onPointer: (event) => {\r\n                        event.eventPreventDefault();\r\n                        if (event.type === 'pointerdown' && event.button === 'left') {\r\n                            if (isVertical) { // top bottom\r\n                                isInverted = this.corners[0].y >= this.corners[3].y;\r\n                            } else { // left right\r\n                                isInverted = this.corners[0].x >= this.corners[1].x;\r\n                            }\r\n                            resetRemainder();\r\n                        }\r\n                        if (event.type === 'pointermove' && event.button === 'left') {\r\n                            const tfD = BB.rotateAround({x: 0, y: 0},\r\n                                {x: event.dX / this.scale, y: event.dY / this.scale},\r\n                                -this.transform.angleDeg);\r\n                            let ti = {\r\n                                dX: tfD.x,\r\n                                dY: tfD.y,\r\n                            };\r\n                            if (Math.abs(this.transform.angleDeg) % 90 === 0) {\r\n                                ti = BB.intDxy(pointerRemainder, tfD.x, tfD.y);\r\n                            }\r\n\r\n                            let indexes = [];\r\n                            if (i === 0) { // top\r\n                                indexes = [2, 3, 0, 1];\r\n                            } else if (i === 1) { // right\r\n                                indexes = [0, 3, 1, 2];\r\n                            } else if (i === 2) { // bottom\r\n                                indexes = [0, 1, 2, 3];\r\n                            } else if (i === 3) { // left\r\n                                indexes = [1, 2, 0, 3];\r\n                            }\r\n\r\n                            let dimension = isVertical ? 'y' : 'x';\r\n                            let d = isVertical ? ti.dY : ti.dX;\r\n\r\n                            if (isInverted) {\r\n                                this.corners[indexes[0]][dimension] += d;\r\n                                this.corners[indexes[1]][dimension] += d;\r\n                            } else {\r\n                                this.corners[indexes[2]][dimension] += d;\r\n                                this.corners[indexes[3]][dimension] += d;\r\n                            }\r\n                            if (this.keyListener.isPressed('shift')) {\r\n                                if (isInverted) {\r\n                                    this.corners[indexes[2]][dimension] -= d;\r\n                                    this.corners[indexes[3]][dimension] -= d;\r\n                                } else {\r\n                                    this.corners[indexes[0]][dimension] -= d;\r\n                                    this.corners[indexes[1]][dimension] -= d;\r\n                                }\r\n                            }\r\n\r\n                            if (isVertical) { // top bottom\r\n                                this.restoreRatio(false, true);\r\n                            } else { // left right\r\n                                this.restoreRatio(true, false);\r\n                            }\r\n\r\n                            this.updateTransformViaCorners();\r\n\r\n                        }\r\n                    }\r\n                });\r\n\r\n            })(i);\r\n        }\r\n\r\n        this.angleGrip = {\r\n            el: BB.el({\r\n                css: {\r\n                    cursor: 'url(' + rotateImg + ') 10 10, move',\r\n                    width: this.gripSize + 'px',\r\n                    height: this.gripSize + 'px',\r\n                    background: '#0ff',\r\n                    borderRadius: this.gripSize + 'px',\r\n                    position: 'absolute',\r\n                    boxShadow: 'inset 0 0 0 2px #000',\r\n                },\r\n            }),\r\n            x: 0,\r\n            y: 0,\r\n            snap: false,\r\n            updateDOM: () => {\r\n                BB.css(this.angleGrip.el, {\r\n                    left: (this.angleGrip.x - this.gripSize / 2) + 'px',\r\n                    top: (this.angleGrip.y - this.gripSize / 2) + 'px',\r\n                });\r\n            },\r\n        };\r\n        BB.el({\r\n            parent: this.angleGrip.el,\r\n            css: {\r\n                width: '2px',\r\n                height: '13px',\r\n                left: (this.gripSize / 2 - 1) + 'px',\r\n                top: this.gripSize + 'px',\r\n                background: '#0ff',\r\n                position: 'absolute'\r\n            }\r\n        });\r\n\r\n        this.anglePointerListener = new BB.PointerListener({\r\n            target: this.angleGrip.el,\r\n            fixScribble: true,\r\n            onPointer: (event) => {\r\n                event.eventPreventDefault();\r\n                if (event.type === 'pointermove' && event.button === 'left') {\r\n\r\n                    const bounds = this.rootEl.getBoundingClientRect();\r\n                    const offset = {\r\n                        x: bounds.left - this.rootEl.scrollLeft,\r\n                        y: bounds.top - this.rootEl.scrollTop,\r\n                    };\r\n                    const iP = {x: (event.clientX - offset.x) / this.scale, y: (event.clientY - offset.y) / this.scale};\r\n\r\n                    const a = BB.pointsToAngleDeg({x: this.transform.x, y: this.transform.y}, iP) + 90;\r\n                    this.transform.angleDeg = a;\r\n                    const snapDeg = Math.round(a / 360 * 8) * 45;\r\n                    if (this.keyListener.getComboStr() === 'shift') {\r\n                        this.transform.angleDeg = snapDeg;\r\n                    } else if (this.snappingEnabled && Math.abs(snapDeg - a) < 8) {\r\n                        this.transform.angleDeg = snapDeg;\r\n                    }\r\n                    this.updateDOM();\r\n\r\n                }\r\n                if (event.type === 'pointerup') {\r\n                    if (Math.abs(this.transform.angleDeg) % 90 === 0) {\r\n                        snapToPixel(this.transform);\r\n                        this.updateCornerPositions();\r\n                        this.updateDOM();\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        snapToPixel(this.transform);\r\n        this.updateDOM(true);\r\n        BB.append(this.transEl, [\r\n            this.boundsEl,\r\n            this.edges[0].el,\r\n            this.edges[1].el,\r\n            this.edges[2].el,\r\n            this.edges[3].el,\r\n            this.corners[0].el,\r\n            this.corners[1].el,\r\n            this.corners[2].el,\r\n            this.corners[3].el,\r\n            this.angleGrip.el,\r\n        ]);\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    getTransform (): ITransform {\r\n        return copyTransform(this.transform);\r\n    }\r\n\r\n    setConstrained (b: boolean): void {\r\n        this.isConstrained = !!b;\r\n        if (b && this.transform.width !== 0 && this.transform.height !== 0) {\r\n            this.ratio = Math.abs(this.transform.width / this.transform.height);\r\n        }\r\n    }\r\n\r\n    setSnapping (s: boolean): void {\r\n        this.snappingEnabled = !!s;\r\n    }\r\n\r\n    setPos (p: IVector2D): void {\r\n        this.transform.x = p.x;\r\n        this.transform.y = p.y;\r\n        this.updateDOM(true);\r\n    }\r\n\r\n    move (dX: number, dY: number): void {\r\n        this.transform.x += dX;\r\n        this.transform.y += dY;\r\n        this.updateDOM(false);\r\n    }\r\n\r\n    setSize (w: number, h: number): void {\r\n        this.transform.width = w;\r\n        this.transform.height = h;\r\n        if (Math.abs(this.transform.angleDeg) % 90 === 0) {\r\n            snapToPixel(this.transform);\r\n        }\r\n        this.updateCornerPositions();\r\n        this.updateDOM(false);\r\n    }\r\n\r\n    setAngleDeg (a: number): void {\r\n        this.transform.angleDeg = a;\r\n        if (Math.abs(this.transform.angleDeg) % 90 === 0) {\r\n            snapToPixel(this.transform);\r\n            this.updateCornerPositions();\r\n        }\r\n        this.updateDOM(true);\r\n    }\r\n\r\n    getElement (): HTMLElement {\r\n        return this.rootEl;\r\n    }\r\n\r\n    getRatio (): number {\r\n        return this.ratio;\r\n    }\r\n\r\n    destroy (): void {\r\n        this.keyListener.destroy();\r\n        this.boundsPointerListener.destroy();\r\n        this.corners[0].pointerListener.destroy();\r\n        this.corners[1].pointerListener.destroy();\r\n        this.corners[2].pointerListener.destroy();\r\n        this.corners[3].pointerListener.destroy();\r\n        this.edges[0].pointerListener.destroy();\r\n        this.edges[1].pointerListener.destroy();\r\n        this.edges[2].pointerListener.destroy();\r\n        this.edges[3].pointerListener.destroy();\r\n        this.anglePointerListener.destroy();\r\n    }\r\n\r\n}\r\n","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"045N6\");","import {BB} from '../../../bb/bb';\r\nimport {KlCanvasPreview} from '../../canvas-ui/canvas-preview';\r\nimport {FreeTransform} from './free-transform';\r\nimport {IKlBasicLayer, IMixMode} from '../../kl.types';\r\n\r\n/**\r\n * a basic canvas where you can transform one layer(move around, rotate, scale)\r\n *\r\n * @param params\r\n * @returns {HTMLDivElement}\r\n * @constructor\r\n */\r\nexport function FreeTransformCanvas(params: {\r\n    elementWidth: number;\r\n    elementHeight: number;\r\n    imageWidth: number;\r\n    imageHeight: number;\r\n    layers: IKlBasicLayer[];\r\n    transformIndex: number;\r\n}) {\r\n    /*\r\n    div\r\n        innerWrapper\r\n            klCanvasPreview\r\n            transform.div\r\n    */\r\n\r\n    let previewFit = BB.fitInto(\r\n        params.imageWidth,\r\n        params.imageHeight,\r\n        params.elementWidth - 20,\r\n        params.elementHeight - 60,\r\n        1\r\n    );\r\n    let scale = previewFit.width / params.imageWidth;\r\n\r\n    let div = BB.el({\r\n        css: {\r\n            width: params.elementWidth + \"px\",\r\n            height: params.elementHeight + \"px\",\r\n            backgroundColor: \"#9e9e9e\",\r\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n            overflow: \"hidden\",\r\n            userSelect: \"none\",\r\n            position: \"relative\",\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n    div.oncontextmenu = function () {\r\n        return false;\r\n    };\r\n\r\n    let innerWrapper = BB.el({\r\n        css: {\r\n            position: 'relative',\r\n            boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n            width: previewFit.width + 'px',\r\n            height: previewFit.height + 'px'\r\n        }\r\n    });\r\n    div.appendChild(innerWrapper);\r\n\r\n    let previewLayerArr = params.layers.map(item => {\r\n        return {\r\n            image: item.image,\r\n            mixModeStr: item.mixModeStr,\r\n            opacity: item.opacity,\r\n        }\r\n    });\r\n    previewLayerArr[previewLayerArr.length - 1].image = BB.canvas(\r\n        scale > 1 ? params.imageWidth : previewFit.width,\r\n        scale > 1 ? params.imageHeight : previewFit.height,\r\n    );\r\n    let klCanvasPreview = new KlCanvasPreview({\r\n        width: previewFit.width,\r\n        height: previewFit.height,\r\n        layers: previewLayerArr\r\n    });\r\n    innerWrapper.appendChild(klCanvasPreview.getElement());\r\n\r\n    let freeTransform;\r\n    let initTransform;\r\n    function updatePreview() {\r\n        if (!freeTransform) {\r\n            return;\r\n        }\r\n\r\n        let transform = freeTransform.getTransform();\r\n        if (scale < 1) {\r\n            transform.x *= scale;\r\n            transform.y *= scale;\r\n            transform.width *= scale;\r\n            transform.height *= scale;\r\n        }\r\n\r\n        let destCanvas = previewLayerArr[params.transformIndex].image;\r\n        let ctx = (destCanvas as HTMLCanvasElement).getContext('2d');\r\n        ctx.save();\r\n        ctx.clearRect(0, 0, destCanvas.width, destCanvas.height);\r\n        BB.drawTransformedImageWithBounds(\r\n            ctx,\r\n            params.layers[params.transformIndex].image,\r\n            transform,\r\n            null,\r\n            BB.testShouldPixelate(transform, transform.width / initTransform.width, transform.height / initTransform.height),\r\n        );\r\n        ctx.restore();\r\n        klCanvasPreview.render();\r\n    }\r\n\r\n    {\r\n        let transformSize = {\r\n            width: params.layers[params.transformIndex].image.width * scale,\r\n            height: params.layers[params.transformIndex].image.height * scale\r\n        };\r\n        if (transformSize.width > previewFit.width || transformSize.height > previewFit.height) {\r\n            transformSize = BB.fitInto(\r\n                params.layers[params.transformIndex].image.width,\r\n                params.layers[params.transformIndex].image.height,\r\n                previewFit.width,\r\n                previewFit.height,\r\n                1\r\n            );\r\n        }\r\n        initTransform = {\r\n            x: params.imageWidth / 2,\r\n            y: params.imageHeight / 2,\r\n            width: params.layers[params.transformIndex].image.width,\r\n            height: params.layers[params.transformIndex].image.height,\r\n        };\r\n        freeTransform = new FreeTransform({\r\n            x: initTransform.x,\r\n            y: initTransform.y,\r\n            width: initTransform.width,\r\n            height: initTransform.height,\r\n            angleDeg: 0,\r\n            isConstrained: true,\r\n            snapX: [0, params.imageWidth],\r\n            snapY: [0, params.imageHeight],\r\n            scale: scale,\r\n            callback: (transform) => {\r\n                updatePreview();\r\n            },\r\n        });\r\n    }\r\n    BB.css(freeTransform.getElement(), {\r\n        position: 'absolute',\r\n        left: '0',\r\n        top: '0'\r\n    });\r\n    innerWrapper.appendChild(freeTransform.getElement());\r\n    setTimeout(updatePreview, 0);\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.move = function(dX, dY) {\r\n        freeTransform.move(dX, dY);\r\n    };\r\n    this.reset = function() {\r\n        let w = params.layers[params.transformIndex].image.width;\r\n        let h = params.layers[params.transformIndex].image.height;\r\n\r\n        freeTransform.setSize(w, h);\r\n        freeTransform.setPos({x: w / 2, y: h / 2});\r\n        freeTransform.setAngleDeg(0);\r\n        updatePreview();\r\n    };\r\n    this.setTransformFit = function() {\r\n\r\n        let fit = BB.fitInto(\r\n            params.layers[params.transformIndex].image.width,\r\n            params.layers[params.transformIndex].image.height,\r\n            params.imageWidth,\r\n            params.imageHeight,\r\n            1\r\n        );\r\n\r\n        freeTransform.setSize(fit.width, fit.height);\r\n        freeTransform.setPos({x: fit.width / 2, y: fit.height / 2});\r\n        freeTransform.setAngleDeg(0);\r\n        updatePreview();\r\n    };\r\n    this.setTransformCenter = function() {\r\n        freeTransform.setPos({x: params.imageWidth / 2, y: params.imageHeight / 2});\r\n        freeTransform.setAngleDeg(0);\r\n        updatePreview();\r\n    };\r\n    //gives you the transformation in the original scale\r\n    this.getTransformation = function () {\r\n        if (!freeTransform) {\r\n            return false;\r\n        }\r\n        return freeTransform.getTransform();\r\n    };\r\n    this.getIsPixelated = () => {\r\n        const transform = freeTransform.getTransform();\r\n        return BB.testShouldPixelate(transform, transform.width / initTransform.width, transform.height / initTransform.height);\r\n    };\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n    this.destroy = function() {\r\n        freeTransform.destroy();\r\n    };\r\n}","import {BB} from '../../../bb/bb';\r\n\r\n/*\r\n\tCropper params\r\n\t{\r\n\t\tx: int, //pos in relation zum bild\r\n\t\ty: int,\r\n\t\tw: int,\r\n\t\th: int,\r\n\t\tscale: float, //zoom\r\n\t\tcallback: function //wenn sich was ändert\r\n\t}\r\n\tthe div that you append this to must be relative\r\n*/\r\nexport function Cropper (params) {\r\n    let x = params.x,\r\n        y = params.y,\r\n        width = params.width,\r\n        height = params.height,\r\n        scale = params.scale,\r\n        callback = params.callback,\r\n        maxW = params.maxW,\r\n        maxH = params.maxH;\r\n    let div = document.createElement(\"div\");\r\n    let gripCursors = ['nw', 'n', 'ne', 'e', 'se', 's', 'sw', 'w'];\r\n\r\n    let keyListener = new BB.KeyListener({});\r\n\r\n    BB.css(div, {\r\n        position: \"absolute\",\r\n        left: (x * scale) + \"px\",\r\n        top: (y * scale) + \"px\"\r\n    });\r\n\r\n    let outline = document.createElement(\"div\");\r\n    BB.css(outline, {\r\n        position: \"absolute\",\r\n        border: \"1px dashed #fff\",\r\n        cursor: \"move\"\r\n    });\r\n    (outline as any).update = function () {\r\n        BB.css(outline, {\r\n            left: (grips[0].x * scale - 1) + \"px\",\r\n            top: (grips[0].y * scale - 1) + \"px\",\r\n            width: ((grips[2].x - grips[0].x) * scale) + \"px\",\r\n            height: ((grips[2].y - grips[0].y) * scale) + \"px\"\r\n        });\r\n    };\r\n    let pointerRemainder = { // needs to be reset after dragging complete\r\n        x: 0,\r\n        y: 0,\r\n    };\r\n    let outlinePointerListener = new BB.PointerListener({\r\n        target: outline,\r\n        onPointer: function(event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n\r\n                grips[0].x += dX;\r\n                grips[0].y += dY;\r\n                grips[1].x += dX;\r\n                grips[1].y += dY;\r\n                grips[2].x += dX;\r\n                grips[2].y += dY;\r\n                grips[3].x += dX;\r\n                grips[3].y += dY;\r\n\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n\r\n    let thirdsHorizontal = document.createElement(\"div\");\r\n    BB.css(thirdsHorizontal, {\r\n        position: \"absolute\",\r\n        borderTop: \"1px solid #0ff\",\r\n        borderBottom: \"1px solid #0ff\"\r\n    });\r\n    (thirdsHorizontal as any).update = function () {\r\n        BB.css(thirdsHorizontal, {\r\n            left: (grips[0].x * scale) + \"px\",\r\n            top: ((grips[0].y + (grips[2].y - grips[0].y) / 3) * scale) + \"px\",\r\n            width: ((grips[2].x - grips[0].x) * scale) + \"px\",\r\n            height: ((grips[2].y - grips[0].y) / 3 * scale) + \"px\"\r\n\r\n        });\r\n    };\r\n    let thirdsVertical = document.createElement(\"div\");\r\n    BB.css(thirdsVertical, {\r\n        position: \"absolute\",\r\n        borderLeft: \"1px solid #0ff\",\r\n        borderRight: \"1px solid #0ff\"\r\n    });\r\n    (thirdsVertical as any).update = function () {\r\n        BB.css(thirdsVertical, {\r\n            left: ((grips[0].x + (grips[2].x - grips[0].x) / 3) * scale) + \"px\",\r\n            top: (grips[0].y * scale) + \"px\",\r\n            width: ((grips[2].x - grips[0].x) / 3 * scale) + \"px\",\r\n            height: ((grips[2].y - grips[0].y) * scale) + \"px\"\r\n\r\n        });\r\n    };\r\n\r\n    const gripSize = 40;\r\n    const gripOverlay = 10;\r\n\r\n    let grips: {\r\n        x: number; // int\r\n        y: number;\r\n    }[] = [ // aka corner coordinates\r\n        {x: 0, y: 0}, // top left\r\n        {x: width, y: 0}, // top right\r\n        {x: width, y: height}, // bottom right\r\n        {x: 0, y: height}, //bottom left\r\n    ];\r\n\r\n    function transformTop(dY) {\r\n        grips[0].y += dY;\r\n        grips[0].y = Math.max(grips[3].y - maxH, Math.min(grips[3].y - 1, grips[0].y));\r\n        grips[1].y = grips[0].y;\r\n    }\r\n    function transformRight(dX) {\r\n        grips[1].x += dX;\r\n        grips[1].x = Math.min(grips[0].x + maxW, Math.max(grips[0].x + 1, grips[1].x));\r\n        grips[2].x = grips[1].x;\r\n    }\r\n    function transformBottom(dY) {\r\n        grips[2].y += dY;\r\n        grips[2].y = Math.min(grips[1].y + maxH, Math.max(grips[1].y + 1, grips[2].y));\r\n        grips[3].y = grips[2].y;\r\n    }\r\n    function transformLeft(dX) {\r\n        grips[0].x += dX;\r\n        grips[0].x = Math.max(grips[1].x - maxW, Math.min(grips[1].x - 1, grips[0].x));\r\n        grips[3].x = grips[0].x;\r\n    }\r\n\r\n    function commit() {\r\n        pointerRemainder.x = 0;\r\n        pointerRemainder.y = 0;\r\n        callback(getTransform());\r\n    }\r\n\r\n\r\n\r\n\r\n    let edges = [];\r\n    for (let i = 0; i < 4; i++) {\r\n        (function (i) {\r\n            edges[i] = document.createElement(\"div\");\r\n            let g = edges[i];\r\n            g.style.width = gripSize + \"px\";\r\n            g.style.height = gripSize + \"px\";\r\n            //g.style.background = \"#0f0\";\r\n            g.style.position = \"absolute\";\r\n            g.update = function () {\r\n                if (i === 0) { //top\r\n                    g.style.left = (grips[0].x * scale + gripOverlay) + \"px\";\r\n                    g.style.top = (grips[0].y * scale - gripSize * 2 + gripOverlay) + \"px\";\r\n                    g.style.width = ((grips[1].x - grips[0].x) * scale - gripOverlay * 2) + \"px\";\r\n                    g.style.height = (gripSize * 2) + \"px\";\r\n                } else if (i === 1) { //right\r\n                    g.style.left = (grips[1].x * scale - gripOverlay) + \"px\";\r\n                    g.style.top = (grips[1].y * scale + gripOverlay) + \"px\";\r\n                    g.style.width = (gripSize * 2) + \"px\";\r\n                    g.style.height = ((grips[2].y - grips[1].y) * scale - gripOverlay * 2) + \"px\";\r\n                } else if (i === 2) { //bottom\r\n                    g.style.left = (grips[3].x * scale + gripOverlay) + \"px\";\r\n                    g.style.top = (grips[3].y * scale - gripOverlay) + \"px\";\r\n                    g.style.width = ((grips[2].x - grips[3].x) * scale - gripOverlay * 2) + \"px\";\r\n                    g.style.height = (gripSize * 2) + \"px\";\r\n                } else if (i === 3) { //left\r\n                    g.style.left = (grips[0].x * scale - gripSize * 2 + gripOverlay) + \"px\";\r\n                    g.style.top = (grips[0].y * scale + gripOverlay) + \"px\";\r\n                    g.style.width = (gripSize * 2) + \"px\";\r\n                    g.style.height = ((grips[3].y - grips[0].y) * scale - gripOverlay * 2) + \"px\";\r\n                }\r\n                let angleOffset = i * 2 + 1;\r\n                g.style.cursor = gripCursors[angleOffset] + \"-resize\";\r\n\r\n            };\r\n        })(i);\r\n    }\r\n\r\n    let darken = [];\r\n    for (let i = 0; i < 4; i++) {\r\n        (function (i) {\r\n            darken[i] = document.createElement(\"div\");\r\n            let g = darken[i];\r\n            g.style.position = \"absolute\";\r\n            g.style.background = \"#000\";\r\n            g.style.opacity = \"0.5\";\r\n            g.update = function () {\r\n                if (i === 0) {\r\n                    g.style.left = (grips[0].x * scale) + \"px\";\r\n                    g.style.top = (grips[0].y * scale - 8000) + \"px\";\r\n                    g.style.width = ((grips[1].x - grips[0].x) * scale) + \"px\";\r\n                    g.style.height = \"8000px\";\r\n                } else if (i === 1) {\r\n                    g.style.left = (grips[1].x * scale) + \"px\";\r\n                    g.style.top = (grips[1].y * scale - 8000) + \"px\";\r\n                    g.style.width = \"8000px\";\r\n                    g.style.height = 16000 + \"px\";\r\n                } else if (i === 2) {\r\n                    g.style.left = (grips[3].x * scale) + \"px\";\r\n                    g.style.top = (grips[3].y * scale) + \"px\";\r\n                    g.style.width = ((grips[2].x - grips[3].x) * scale) + \"px\";\r\n                    g.style.height = \"8000px\";\r\n                } else if (i === 3) {\r\n                    g.style.left = (grips[0].x * scale - 8000) + \"px\";\r\n                    g.style.top = (grips[0].y * scale - 8000) + \"px\";\r\n                    g.style.width = \"8000px\";\r\n                    g.style.height = 16000 + \"px\";\r\n                }\r\n\r\n            };\r\n        })(i);\r\n    }\r\n\r\n    let edge0PointerListener = new BB.PointerListener({\r\n        target: edges[0],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformTop(dY);\r\n                if (keyListener.isPressed('shift')) {\r\n                    transformBottom(-dY);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n    let edge1PointerListener = new BB.PointerListener({\r\n        target: edges[1],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformRight(dX);\r\n                if (keyListener.isPressed('shift')) {\r\n                    transformLeft(-dX);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n    let edge2PointerListener = new BB.PointerListener({\r\n        target: edges[2],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformBottom(dY);\r\n                if (keyListener.isPressed('shift')) {\r\n                    transformTop(-dY);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n    let edge3PointerListener = new BB.PointerListener({\r\n        target: edges[3],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformLeft(dX);\r\n                if (keyListener.isPressed('shift')) {\r\n                    transformRight(-dX);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n\r\n\r\n    let cornerElArr = [];\r\n    (function() {\r\n        for (let i = 0; i < 4; i++) {\r\n            (function (i) {\r\n                cornerElArr[i] = document.createElement(\"div\");\r\n                let g = cornerElArr[i];\r\n                BB.css(g, {\r\n                    //background: '#f00',\r\n                    width: (gripSize * 2) + 'px',\r\n                    height: (gripSize * 2) + 'px',\r\n                    position: 'absolute'\r\n                });\r\n                g.style.cursor = ['nwse-resize', 'nesw-resize'][i % 2];\r\n                g.update = function () {\r\n                    if (i === 0) { //top left\r\n                        BB.css(g, {\r\n                            left: (grips[0].x * scale - gripSize * 2 + gripOverlay) + \"px\",\r\n                            top: (grips[0].y * scale - gripSize * 2 + gripOverlay) + \"px\"\r\n                        });\r\n                    } else if (i === 1) { //top right\r\n                        BB.css(g, {\r\n                            left: (grips[1].x * scale - gripOverlay) + \"px\",\r\n                            top: (grips[1].y * scale - gripSize * 2 + gripOverlay) + \"px\"\r\n                        });\r\n                    } else if (i === 2) { //bottom right\r\n                        BB.css(g, {\r\n                            left: (grips[1].x * scale - gripOverlay) + \"px\",\r\n                            top: (grips[2].y * scale - gripOverlay) + \"px\"\r\n                        });\r\n                    } else if (i === 3) { //bottom left\r\n                        BB.css(g, {\r\n                            left: (grips[0].x * scale - gripSize * 2 + gripOverlay) + \"px\",\r\n                            top: (grips[2].y * scale - gripOverlay) + \"px\"\r\n                        });\r\n                    }\r\n                };\r\n            })(i);\r\n        }\r\n    })();\r\n    //top left\r\n    let corner0PointerListener = new BB.PointerListener({\r\n        target: cornerElArr[0],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformLeft(dX);\r\n                transformTop(dY);\r\n                if (keyListener.isPressed('shift')) {\r\n                    transformRight(-dX);\r\n                    transformBottom(-dY);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n    //top right\r\n    let corner1PointerListener = new BB.PointerListener({\r\n        target: cornerElArr[1],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformRight(dX);\r\n                transformTop(dY);\r\n                if (keyListener.isPressed('shift')) {\r\n                    transformLeft(-dX);\r\n                    transformBottom(-dY);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n    //bottom right\r\n    let corner2PointerListener = new BB.PointerListener({\r\n        target: cornerElArr[2],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformRight(dX);\r\n                transformBottom(dY);\r\n                if (keyListener.isPressed('shift')) {\r\n                    transformLeft(-dX);\r\n                    transformTop(-dY);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n    //bottom left\r\n    let corner3PointerListener = new BB.PointerListener({\r\n        target: cornerElArr[3],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformLeft(dX);\r\n                transformBottom(dY);\r\n                if (keyListener.isPressed('shift')) {\r\n                    transformRight(-dX);\r\n                    transformTop(-dY);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n\r\n\r\n\r\n\r\n    function getTransform() {\r\n        grips[1].x -= grips[0].x;\r\n        grips[1].y -= grips[0].y;\r\n        grips[2].x -= grips[0].x;\r\n        grips[2].y -= grips[0].y;\r\n        grips[3].x -= grips[0].x;\r\n        grips[3].y -= grips[0].y;\r\n        x += grips[0].x;\r\n        y += grips[0].y;\r\n        grips[0].x = 0;\r\n        grips[0].y = 0;\r\n        return {\r\n            x: x,\r\n            y: y,\r\n            width: grips[1].x,\r\n            height: grips[2].y\r\n        };\r\n    }\r\n\r\n\r\n    div.append(\r\n        darken[1],\r\n        darken[0],\r\n        darken[2],\r\n        darken[3],\r\n        thirdsHorizontal,\r\n        thirdsVertical,\r\n        outline,\r\n\r\n        edges[1],\r\n        edges[0],\r\n        edges[2],\r\n        edges[3],\r\n\r\n        cornerElArr[0],\r\n        cornerElArr[1],\r\n        cornerElArr[2],\r\n        cornerElArr[3],\r\n    );\r\n\r\n\r\n    function update() {\r\n\r\n        edges[0].update();\r\n        edges[1].update();\r\n        edges[2].update();\r\n        edges[3].update();\r\n        cornerElArr[0].update();\r\n        cornerElArr[1].update();\r\n        cornerElArr[2].update();\r\n        cornerElArr[3].update();\r\n        darken[0].update();\r\n        darken[1].update();\r\n        darken[2].update();\r\n        darken[3].update();\r\n        (outline as any).update();\r\n        (thirdsHorizontal as any).update();\r\n        (thirdsVertical as any).update();\r\n    }\r\n\r\n    update();\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.getTransform = getTransform;\r\n\r\n    this.setTransform = function (p) {\r\n        x = p.x;\r\n        y = p.y;\r\n        width = p.width;\r\n        height = p.height;\r\n\r\n        BB.css(div, {\r\n            left: (x * scale) + \"px\",\r\n            top: (y * scale) + \"px\"\r\n        });\r\n\r\n        grips[0].x = 0;\r\n        grips[0].y = 0;\r\n        grips[1].x = width;\r\n        grips[1].y = 0;\r\n        grips[2].x = width;\r\n        grips[2].y = height;\r\n        grips[3].x = 0;\r\n        grips[3].y = height;\r\n\r\n        update();\r\n        commit();\r\n    };\r\n\r\n    this.setScale = function (s) {\r\n        scale = s;\r\n        BB.css(div, {\r\n            left: (x * scale) + \"px\",\r\n            top: (y * scale) + \"px\"\r\n        });\r\n        update();\r\n    };\r\n\r\n    this.showThirds = function (b) {\r\n        if (b) {\r\n            thirdsHorizontal.style.display = \"block\";\r\n            thirdsVertical.style.display = \"block\";\r\n        } else {\r\n            thirdsHorizontal.style.display = \"none\";\r\n            thirdsVertical.style.display = \"none\";\r\n        }\r\n    };\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.destroy = function() {\r\n        keyListener.destroy();\r\n        outlinePointerListener.destroy();\r\n        corner0PointerListener.destroy();\r\n        corner1PointerListener.destroy();\r\n        corner2PointerListener.destroy();\r\n        corner3PointerListener.destroy();\r\n        edge0PointerListener.destroy();\r\n        edge1PointerListener.destroy();\r\n        edge2PointerListener.destroy();\r\n        edge3PointerListener.destroy();\r\n    };\r\n\r\n}","import {BB} from '../../../bb/bb';\r\nimport {klHistory} from '../../history/kl-history';\r\nimport {LANG} from '../../../language/language';\r\n\r\n/**\r\n * Previews currently active layer\r\n * thumbnail (hover shows bigger preview), layername, opacity\r\n *\r\n * internally listens to kl history. updates when there's a change.\r\n * but you need to update it when the active layer changed. (different canvas object)\r\n *\r\n * update visibility for performance\r\n *\r\n * p = {\r\n *     onClick: function() // when clicking on layer name\r\n *     klRootEl: klRootEl,\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function LayerPreview(p) {\r\n\r\n    // internally redraws with in an interval. checks history is something changed\r\n    // this update will be animated\r\n    // it will not be animated if the resolution changed\r\n    // also redraws when you call updateLayer - not animated\r\n\r\n    // syncs via updateLayer, and internally updates layer opacity via a hack\r\n\r\n    let div = BB.el({});\r\n    let layerObj;\r\n    let isVisible = true;\r\n    const height = 40;\r\n    const canvasSize = height - 10;\r\n    const largeCanvasSize = 300;\r\n    let lastDrawnState = -2;\r\n    let lastDrawnSize = {\r\n        width: 0,\r\n        height: 0\r\n    };\r\n    let animationCanvas = BB.canvas(); // to help animate the transition\r\n    let animationCanvasCtx = animationCanvas.getContext('2d');\r\n    const animationLength = 30;\r\n    let animationCount = 0; // >0 means it's animating\r\n    let largeCanvasIsVisible = false;\r\n    let largeCanvasAnimationTimeout;\r\n    const largeCanvasAnimationDurationMs = 300;\r\n    let uiState = 'right'; // 'left' | 'right'\r\n\r\n\r\n    // --- setup dom ---\r\n    let contentWrapperEl = BB.el({\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            height: height + 'px',\r\n            color: '#666',\r\n        }\r\n    });\r\n    let canvasWrapperEl = BB.el({\r\n        css: {\r\n            //background: '#f00',\r\n            minWidth: height + 'px',\r\n            height: height + 'px',\r\n            display: 'flex',\r\n            justifyContent: 'center',\r\n            alignItems: 'center'\r\n        }\r\n    });\r\n    let canvas = BB.canvas(canvasSize, canvasSize);\r\n    let canvasCtx = canvas.getContext('2d');\r\n    canvas.title = LANG('layers-active-layer');\r\n    BB.css(canvas, {\r\n        boxShadow: '0 0 0 1px #9e9e9e',\r\n        colorScheme: 'only light',\r\n    });\r\n    let nameWrapper = BB.el({\r\n        css: {\r\n            //background: '#ff0',\r\n            flexGrow: '1',\r\n            paddingLeft: '10px',\r\n            fontSize: '13px',\r\n            overflow: 'hidden',\r\n            position: 'relative'\r\n        }\r\n    });\r\n    let nameLabelEl = BB.el({\r\n        content: '',\r\n        css: {\r\n            cssFloat: 'left',\r\n            whiteSpace: 'nowrap'\r\n        }\r\n    });\r\n    let nameFadeEl = BB.el({\r\n        css: {\r\n            backgroundImage: 'linear-gradient(to right, rgba(221,221,221,0) 0%, rgba(221,221,221,0.8) 100%)',\r\n            position: 'absolute',\r\n            right: \"0\",\r\n            top: \"0\",\r\n            width: \"50px\",\r\n            height: '100%'\r\n        }\r\n    });\r\n    let clickableEl = BB.el({\r\n        css: {\r\n            //background: 'rgba(0,255,0,0.6)',\r\n            position: 'absolute',\r\n            left: \"10px\",\r\n            top: \"0\",\r\n            width: \"90px\",\r\n            height: '100%'\r\n        }\r\n    });\r\n    if (p.onClick) {\r\n        BB.addEventListener(clickableEl,'click', function() {\r\n            p.onClick();\r\n        });\r\n        BB.addEventListener(canvas,'click', function() {\r\n            p.onClick();\r\n        });\r\n    }\r\n    let opacityEl = BB.el({\r\n        content: LANG('opacity') + '<br>100%',\r\n        css: {\r\n            minWidth: '60px',\r\n            fontSize: '12px',\r\n            textAlign: 'center',\r\n            background: '#dddddd',\r\n            color: '#555'\r\n        }\r\n    });\r\n\r\n    const largeCanvasWrapper = BB.el({\r\n        onClick: BB.handleClick,\r\n        css: {\r\n            pointerEvents: 'none',\r\n            background: '#fff',\r\n            position: 'absolute',\r\n            right: '280px',\r\n            top: '10px',\r\n            border: '1px solid #aaa',\r\n            boxShadow: '1px 1px 3px rgba(0,0,0,0.3)',\r\n            transition: 'opacity '+largeCanvasAnimationDurationMs+'ms ease-in-out',\r\n            userSelect: 'none',\r\n            display: 'block',\r\n            webkitTouchCallout: 'none',\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n    let largeCanvas = BB.canvas(largeCanvasSize, largeCanvasSize);\r\n    largeCanvasWrapper.append(largeCanvas);\r\n    let largeCanvasCtx = largeCanvas.getContext('2d');\r\n    BB.css(largeCanvas, {\r\n        display: 'block',\r\n    });\r\n\r\n    div.appendChild(contentWrapperEl);\r\n    contentWrapperEl.appendChild(canvasWrapperEl);\r\n    canvasWrapperEl.appendChild(canvas);\r\n    contentWrapperEl.appendChild(nameWrapper);\r\n    nameWrapper.appendChild(nameLabelEl);\r\n    nameWrapper.appendChild(nameFadeEl);\r\n    nameWrapper.appendChild(clickableEl);\r\n    contentWrapperEl.appendChild(opacityEl);\r\n\r\n\r\n    let animationCanvasCheckerPattern = animationCanvasCtx.createPattern(BB.createCheckerCanvas(4), 'repeat');\r\n    let largeCanvasCheckerPattern = canvasCtx.createPattern(BB.createCheckerCanvas(4), 'repeat');\r\n\r\n\r\n\r\n    // --- update logic ---\r\n\r\n    function animate() {\r\n        if (animationCount === 0) {\r\n            return;\r\n        }\r\n\r\n        animationCount--;\r\n\r\n        canvasCtx.save();\r\n        canvasCtx.globalAlpha = Math.pow((animationLength - animationCount) / animationLength, 2);\r\n        canvasCtx.drawImage(animationCanvas, 0, 0);\r\n        canvasCtx.restore();\r\n\r\n        if (animationCount > 0) {\r\n            requestAnimationFrame(animate);\r\n        }\r\n    }\r\n\r\n    function draw(isInstant) {\r\n\r\n        if (!isVisible) {\r\n            return;\r\n        }\r\n\r\n        nameLabelEl.textContent = layerObj.name;\r\n        opacityEl.innerHTML = LANG('opacity') + '<br>' + Math.round(layerObj.opacity * 100) + '%';\r\n\r\n        let layerCanvas = layerObj.context.canvas;\r\n\r\n        if (layerCanvas.width !== lastDrawnSize.width || layerCanvas.height !== lastDrawnSize.height) {\r\n            let canvasDimensions = BB.fitInto(layerCanvas.width, layerCanvas.height, canvasSize, canvasSize, 1);\r\n            canvas.width = Math.round(canvasDimensions.width);\r\n            canvas.height = Math.round(canvasDimensions.height);\r\n\r\n            isInstant = true;\r\n        }\r\n\r\n        animationCanvas.width = canvas.width;\r\n        animationCanvas.height = canvas.height;\r\n\r\n        animationCanvasCtx.save();\r\n        animationCanvasCtx.imageSmoothingEnabled = false;\r\n        animationCanvasCtx.fillStyle = animationCanvasCheckerPattern;\r\n        animationCanvasCtx.fillRect(0, 0, animationCanvas.width, animationCanvas.height);\r\n        animationCanvasCtx.drawImage(layerCanvas, 0, 0, animationCanvas.width, animationCanvas.height);\r\n        animationCanvasCtx.restore();\r\n\r\n        if (isInstant) {\r\n            animationCount = 0;\r\n            canvasCtx.save();\r\n            canvasCtx.drawImage(animationCanvas, 0, 0);\r\n            canvasCtx.restore();\r\n\r\n        } else {\r\n            animationCount = animationLength;\r\n            animate();\r\n\r\n        }\r\n\r\n        drawLargeCanvas();\r\n\r\n        lastDrawnState = klHistory.getState();\r\n        lastDrawnSize.width = layerCanvas.width;\r\n        lastDrawnSize.height = layerCanvas.height;\r\n    }\r\n\r\n    function update() {\r\n        draw(true);\r\n    }\r\n\r\n    setInterval(function() {\r\n\r\n        if (!layerObj) {\r\n            return;\r\n        }\r\n\r\n        let currentState = klHistory.getState();\r\n        if (currentState === lastDrawnState) {\r\n            return;\r\n        }\r\n\r\n        //update opacity w hack\r\n        layerObj.opacity = layerObj.context.canvas.opacity;\r\n\r\n        draw(false);\r\n\r\n    }, 2000);\r\n\r\n\r\n    //is always instant\r\n    function drawLargeCanvas() {\r\n\r\n        if (!largeCanvasIsVisible || !layerObj) {\r\n            return;\r\n        }\r\n\r\n        let layerCanvas = layerObj.context.canvas;\r\n\r\n        let canvasDimensions = BB.fitInto(layerCanvas.width, layerCanvas.height, largeCanvasSize, largeCanvasSize, 1);\r\n        largeCanvas.width = Math.round(canvasDimensions.width);\r\n        largeCanvas.height = Math.round(canvasDimensions.height);\r\n        largeCanvasCtx.save();\r\n        if (largeCanvas.width > layerCanvas.width) {\r\n            largeCanvasCtx.imageSmoothingEnabled = false;\r\n        } else {\r\n            largeCanvasCtx.imageSmoothingEnabled = true;\r\n            largeCanvasCtx.imageSmoothingQuality = 'high';\r\n        }\r\n        largeCanvasCtx.fillStyle = largeCanvasCheckerPattern;\r\n        largeCanvasCtx.fillRect(0, 0, largeCanvas.width, largeCanvas.height);\r\n        largeCanvasCtx.drawImage(layerCanvas, 0, 0, largeCanvas.width, largeCanvas.height);\r\n        largeCanvasCtx.restore();\r\n\r\n        const bounds = div.getBoundingClientRect();\r\n        BB.css(largeCanvasWrapper, {\r\n            top: Math.max(10, (bounds.top + height / 2 - largeCanvas.height / 2)) + \"px\"\r\n        });\r\n\r\n    }\r\n\r\n    function removeLargeCanvas() {\r\n        try {\r\n            p.klRootEl.removeChild(largeCanvasWrapper);\r\n        } catch(e) {\r\n\r\n        }\r\n    }\r\n\r\n    function showLargeCanvas(b) {\r\n        if (largeCanvasIsVisible === b) {\r\n            return;\r\n        }\r\n\r\n        clearTimeout(largeCanvasAnimationTimeout);\r\n        largeCanvasIsVisible = b;\r\n\r\n        if (b) {\r\n            largeCanvasAnimationTimeout = setTimeout(function() {\r\n                drawLargeCanvas();\r\n                largeCanvasWrapper.style.opacity = '0';\r\n                p.klRootEl.appendChild(largeCanvasWrapper);\r\n                setTimeout(function() {\r\n                    largeCanvasWrapper.style.opacity = '1';\r\n                }, 20);\r\n            }, 250);\r\n\r\n        } else {\r\n            largeCanvasWrapper.style.opacity = '0';\r\n            largeCanvasAnimationTimeout = setTimeout(removeLargeCanvas, largeCanvasAnimationDurationMs + 20);\r\n        }\r\n\r\n    }\r\n\r\n    let pointerListener = new BB.PointerListener({\r\n        target: canvas,\r\n        onEnterLeave: function(b) {\r\n            showLargeCanvas(b);\r\n        }\r\n    });\r\n\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.setIsVisible = function(b) {\r\n        if (isVisible === b) {\r\n            return;\r\n        }\r\n        isVisible = b;\r\n        contentWrapperEl.style.display = isVisible ? 'flex' : 'none';\r\n        div.style.marginBottom = isVisible ? '' : '10px';\r\n\r\n        let currentState = klHistory.getState();\r\n        if (b && lastDrawnState !== currentState) {\r\n            update();\r\n        }\r\n    };\r\n\r\n    //when the layer might have changed\r\n    this.setLayer = function(klCanvasLayerObj) {\r\n        layerObj = klCanvasLayerObj;\r\n        update();\r\n    };\r\n\r\n    this.setUiState = function(stateStr) {\r\n        uiState = '' + stateStr;\r\n\r\n        if (uiState === 'left') {\r\n            BB.css(largeCanvasWrapper, {\r\n                left: '280px',\r\n                right: ''\r\n            });\r\n        } else {\r\n            BB.css(largeCanvasWrapper, {\r\n                left: '',\r\n                right: '280px'\r\n            });\r\n        }\r\n    };\r\n\r\n}","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * fits image into a size\r\n * params: {\r\n *    image: image,\r\n *    width: int,\r\n *    height: int\r\n * }\r\n *\r\n * methods:\r\n * getDiv()\r\n *\r\n * @param params\r\n * @constructor\r\n */\r\nexport function FittedImage(params) {\r\n    let fit = BB.fitInto(params.image.width, params.image.height, params.width, params.height, 1);\r\n    let w = parseInt('' + fit.width);\r\n    let h = parseInt('' + fit.height);\r\n\r\n    let canvas = BB.canvas(w, h);\r\n\r\n    canvas.getContext(\"2d\").drawImage(params.image, 0, 0, w, h);\r\n    BB.css(canvas, {\r\n        display: \"block\",\r\n        boxShadow: \"0 0 0 1px #aaa\"\r\n    });\r\n\r\n    this.getElement = function() {\r\n        return canvas;\r\n    };\r\n}","import {BB} from '../../../bb/bb';\r\nimport {FreeTransformCanvas} from '../components/free-transform-canvas';\r\nimport {popup} from './popup';\r\nimport {KlCanvas} from '../../canvas/kl-canvas';\r\nimport {IKlBasicLayer} from '../../kl.types';\r\nimport {LANG} from '../../../language/language';\r\n\r\nexport function showImportAsLayerDialog(\r\n    params: {\r\n        target: HTMLElement;\r\n        klCanvas: KlCanvas;\r\n        importImage: HTMLImageElement | HTMLCanvasElement;\r\n        callback: (\r\n            p?: {x: number, y: number, width:number, height: number, angleDeg: number},\r\n            isPixelated?: boolean\r\n        ) => void;\r\n    }\r\n): void {\r\n\r\n    let div = document.createElement(\"div\");\r\n    BB.appendTextDiv(div, LANG('import-as-layer-description'));\r\n    if (params.klCanvas.isLayerLimitReached()) {\r\n        let noteEl = BB.el({\r\n            content: LANG('import-as-layer-limit-reached'),\r\n            css: {\r\n                background: '#ff0',\r\n                padding: '10px',\r\n                marginTop: '5px',\r\n                marginBottom: '5px',\r\n                border: '1px solid #e7d321',\r\n                borderRadius: '5px'\r\n            }\r\n        });\r\n        div.appendChild(noteEl);\r\n    }\r\n    let isSmall = window.innerWidth < 550;\r\n\r\n    let buttonRowEl = BB.el({\r\n        css: {\r\n            display: 'flex'\r\n        }\r\n    });\r\n    let originalSizeBtn = BB.el({\r\n        tagName: 'button',\r\n        content: '1:1',\r\n        css: {\r\n            marginRight: '10px'\r\n        },\r\n        onClick: function() {\r\n            freeTransformCanvas.reset();\r\n        }\r\n    });\r\n    let fitSizeBtn = BB.el({\r\n        tagName: 'button',\r\n        content: LANG('import-as-layer-fit'),\r\n        css: {\r\n            marginRight: '10px'\r\n        },\r\n        onClick: function() {\r\n            freeTransformCanvas.setTransformFit();\r\n        }\r\n    });\r\n    let centerBtn = BB.el({\r\n        tagName: 'button',\r\n        content: LANG('center'),\r\n        css: {\r\n            marginRight: '10px'\r\n        },\r\n        onClick: function() {\r\n            freeTransformCanvas.setTransformCenter();\r\n        }\r\n    });\r\n    buttonRowEl.appendChild(originalSizeBtn);\r\n    buttonRowEl.appendChild(fitSizeBtn);\r\n    buttonRowEl.appendChild(centerBtn);\r\n    div.appendChild(buttonRowEl);\r\n\r\n\r\n\r\n    let layers: IKlBasicLayer[] = [];\r\n    {\r\n        let klCanvasLayerArr = params.klCanvas.getLayers();\r\n        for (let i = 0; i < klCanvasLayerArr.length; i++) {\r\n            layers.push({\r\n                image: klCanvasLayerArr[i].context.canvas,\r\n                opacity: klCanvasLayerArr[i].opacity,\r\n                mixModeStr: klCanvasLayerArr[i].mixModeStr\r\n            });\r\n        }\r\n    }\r\n    layers.push({\r\n        image: params.importImage,\r\n        opacity: 1,\r\n        mixModeStr: 'source-over'\r\n    });\r\n\r\n\r\n    let freeTransformCanvas = new FreeTransformCanvas({\r\n        elementWidth: isSmall ? 340 : 540,\r\n        elementHeight: isSmall ? 280 : 350,\r\n        imageWidth: params.klCanvas.getLayerContext(0).canvas.width,\r\n        imageHeight: params.klCanvas.getLayerContext(0).canvas.height,\r\n        layers: layers,\r\n        transformIndex: layers.length - 1,\r\n    });\r\n    BB.css(freeTransformCanvas.getElement(), {\r\n        marginTop: '10px',\r\n        marginLeft: '-20px',\r\n    });\r\n    div.appendChild(freeTransformCanvas.getElement());\r\n\r\n    function move(x, y) {\r\n        freeTransformCanvas.move(x, y);\r\n    }\r\n\r\n    let keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr) {\r\n            if (keyStr === 'left') {\r\n                move(-1, 0);\r\n            }\r\n            if (keyStr === 'right') {\r\n                move(1, 0);\r\n            }\r\n            if (keyStr === 'up') {\r\n                move(0, -1);\r\n            }\r\n            if (keyStr === 'down') {\r\n                move(0, 1);\r\n            }\r\n        }\r\n    });\r\n\r\n    popup({\r\n        target: params.target,\r\n        message: `<b>${LANG('import-as-layer-title')}</b>`,\r\n        div: div,\r\n        style: isSmall ? null : {\r\n            width: '500px'\r\n        },\r\n        buttons: [\"Ok\", \"Cancel\"],\r\n        clickOnEnter: 'Ok',\r\n        callback: function(buttonStr) {\r\n            keyListener.destroy();\r\n            freeTransformCanvas.destroy();\r\n            BB.destroyEl(originalSizeBtn);\r\n            BB.destroyEl(fitSizeBtn);\r\n            BB.destroyEl(centerBtn);\r\n            if (buttonStr === 'Ok') {\r\n                params.callback(freeTransformCanvas.getTransformation(), freeTransformCanvas.getIsPixelated());\r\n            } else {\r\n                params.callback();\r\n            }\r\n        }\r\n    });\r\n\r\n}","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * Not really generalized. UI when you drag/drop an image into window.\r\n * The moment you create it, it will listen.\r\n *\r\n * @param p object {onDrop: func(files, optionStr), target: DOM Element, enabledTest: func -> bool} - optionStr: 'default'|'layer'|'image'\r\n * @constructor\r\n */\r\nexport function KlImageDropper(p) {\r\n\r\n    //set up DOM\r\n    let rootEl = BB.el({\r\n        content: 'Drop to import',\r\n        css: {\r\n            paddingTop: '100px',\r\n            position: 'fixed',\r\n            left: '0',\r\n            top: '0',\r\n            width: '100%',\r\n            height: '100%',\r\n            background: 'rgba(50, 50, 50, 0.7)',\r\n            color: '#fff',\r\n            textShadow: '2px 2px #000',\r\n            textAlign: 'center',\r\n            fontSize: '25px'\r\n        }\r\n    });\r\n    let wrapperEl = BB.el({\r\n        css: {\r\n            'marginTop': '50px',\r\n            'display': 'flex',\r\n            'justifyContent': 'center'\r\n        }\r\n    });\r\n    let optionStyle = {\r\n        width: '200px',\r\n        padding: '50px',\r\n        margin: '10px',\r\n        //opacity: 0.5,\r\n        borderRadius: '20px',\r\n        border: '1px dashed #fff',\r\n        background: '#00aefe',\r\n        fontWeight: 'bold'\r\n    };\r\n    let optionLayerEl = BB.el({\r\n        content: 'As Layer',\r\n        css: optionStyle\r\n    });\r\n    let optionImageEl = BB.el({\r\n        content: 'As New Image',\r\n        css: optionStyle\r\n    });\r\n\r\n    rootEl.appendChild(wrapperEl);\r\n    wrapperEl.appendChild(optionLayerEl);\r\n    wrapperEl.appendChild(optionImageEl);\r\n\r\n\r\n    let rootCounter = 0;\r\n    let optionLayerCounter = 0;\r\n    let optionImageCounter = 0;\r\n\r\n    function destroy() {\r\n        rootCounter = 0;\r\n        optionLayerCounter = 0;\r\n        optionImageCounter = 0;\r\n        try {\r\n            p.target.removeChild(rootEl);\r\n        } catch (e) { }\r\n    }\r\n\r\n    function testAcceptType(event) {\r\n        try {\r\n            return !event.dataTransfer.types.includes('text/plain');\r\n        } catch(e) {\r\n\r\n        }\r\n        return false;\r\n    }\r\n\r\n    function updateOptions() {\r\n        let boxShadow = '0 0 20px 4px #fff';\r\n        if (optionLayerCounter > 0) {\r\n            optionLayerEl.style.boxShadow = boxShadow;\r\n            optionImageEl.style.boxShadow = '';\r\n        } else if (optionImageCounter > 0) {\r\n            optionLayerEl.style.boxShadow = '';\r\n            optionImageEl.style.boxShadow = boxShadow;\r\n        } else {\r\n            optionLayerEl.style.boxShadow = '';\r\n            optionImageEl.style.boxShadow = '';\r\n        }\r\n    }\r\n\r\n    BB.addEventListener(optionLayerEl,'dragenter', function() {\r\n        optionLayerCounter++;\r\n        updateOptions();\r\n    });\r\n    BB.addEventListener(optionLayerEl,'dragleave', function() {\r\n        optionLayerCounter--;\r\n        updateOptions();\r\n    });\r\n    BB.addEventListener(optionImageEl,'dragenter', function() {\r\n        optionImageCounter++;\r\n        updateOptions();\r\n    });\r\n    BB.addEventListener(optionImageEl,'dragleave', function() {\r\n        optionImageCounter--;\r\n        updateOptions();\r\n    });\r\n\r\n\r\n    function rootDragOver(event) {\r\n        if (!testAcceptType(event)) {\r\n            return;\r\n        }\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n    }\r\n    function rootDragEnter(event) {\r\n        if (!p.enabledTest() || !testAcceptType(event)) {\r\n            return;\r\n        }\r\n        if (rootCounter === 0) {\r\n            p.target.appendChild(rootEl);\r\n        }\r\n        rootCounter++;\r\n\r\n    }\r\n    function rootDragLeave(event) {\r\n        if (!testAcceptType(event) || rootCounter === 0) {\r\n            return;\r\n        }\r\n        rootCounter = Math.max(0, rootCounter - 1);\r\n        if (rootCounter === 0) {\r\n            p.target.removeChild(rootEl);\r\n        }\r\n\r\n    }\r\n    function rootDrop(event) {\r\n        if (!testAcceptType(event) || event.dataTransfer.files.length === 0) {\r\n            destroy();\r\n            return;\r\n        }\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n\r\n        let optionStr = 'default';\r\n        if (optionLayerCounter > 0) {\r\n            optionStr = 'layer';\r\n        } else if (optionImageCounter > 0) {\r\n            optionStr = 'image';\r\n        }\r\n\r\n        p.onDrop(event.dataTransfer.files, optionStr);\r\n\r\n\r\n        if (rootCounter > 0) {\r\n            p.target.removeChild(rootEl);\r\n        }\r\n        rootCounter = 0;\r\n        optionLayerCounter = 0;\r\n        optionImageCounter = 0;\r\n        updateOptions();\r\n    }\r\n\r\n    BB.addEventListener(window,'dragover', rootDragOver, false);\r\n    BB.addEventListener(window,'dragenter', rootDragEnter, false);\r\n    BB.addEventListener(window,'dragleave', rootDragLeave, false);\r\n    BB.addEventListener(window,'drop', rootDrop, false);\r\n\r\n    // if something goes wrong and you're stuck with overlay\r\n    BB.addEventListener(rootEl, 'pointerdown', function() {\r\n        destroy();\r\n    });\r\n    let keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr) {\r\n            if (rootCounter > 0 && keyStr === 'esc') {\r\n                destroy();\r\n            }\r\n        }\r\n    });\r\n\r\n}","import {BB} from '../../../bb/bb';\r\nimport {KlSmallColorSlider} from '../base-components/kl-color-slider-small';\r\nimport {KlSlider} from '../base-components/kl-slider';\r\nimport {BrushSettingService} from '../../brushes-ui/brush-setting-service';\r\nimport {LANG} from '../../../language/language';\r\n\r\n/**\r\n * Compressed HUD toolspace. When you hold ctrl+alt.\r\n * small color picker, brush settings\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function OverlayToolspace(\r\n    p: {\r\n        brushSettingService: BrushSettingService; // to sync with outside\r\n        enabledTest: () => boolean; // calls to see if it's allowed to show\r\n    }\r\n) {\r\n\r\n    const sizeObj = {\r\n        width: 150,\r\n        svHeight: 90,\r\n        hHeight: 20,\r\n        sliderHeight: 25\r\n    };\r\n\r\n    let isVisible = false;\r\n    const div = BB.el({\r\n        css: {\r\n            position: 'absolute',\r\n            left: '500px',\r\n            top: '500px',\r\n            background: 'rgb(221, 221, 221)',\r\n            display: 'none',\r\n            border: '1px solid #fff',\r\n            boxShadow: '0 0 10px rgba(0,0,0,0.5)',\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n    const queuedObj = {\r\n        color: null,\r\n        size: null,\r\n        opacity: null\r\n    };\r\n\r\n\r\n    // --- inputs ---\r\n\r\n    //color selection\r\n    const colorSlider = new KlSmallColorSlider({\r\n        width: sizeObj.width,\r\n        heightSV: sizeObj.svHeight,\r\n        heightH: sizeObj.hHeight,\r\n        color: p.brushSettingService.getColor(),\r\n        callback: function (rgbObj) {\r\n            selectedColorEl.style.backgroundColor = \"rgb(\" + rgbObj.r + \",\" + rgbObj.g + \",\" + rgbObj.b + \")\";\r\n            p.brushSettingService.setColor(rgbObj, subscriptionFunc);\r\n        }\r\n    });\r\n    const selectedColorEl = BB.el({\r\n        css: {\r\n            width: sizeObj.width + 'px',\r\n            height: sizeObj.hHeight + 'px',\r\n            pointerEvents: 'none'\r\n        }\r\n    });\r\n    {\r\n        const initialColor = p.brushSettingService.getColor();\r\n        selectedColorEl.style.backgroundColor = \"rgb(\" + initialColor.r + \",\" + initialColor.g + \",\" + initialColor.b + \")\";\r\n    }\r\n\r\n    div.appendChild(selectedColorEl);\r\n    div.appendChild(colorSlider.getElement());\r\n\r\n\r\n    function updateColor(rgbObj) {\r\n        colorSlider.setColor(rgbObj);\r\n        selectedColorEl.style.backgroundColor = \"rgb(\" + rgbObj.r + \",\" + rgbObj.g + \",\" + rgbObj.b + \")\";\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    //brushsize slider\r\n\r\n    const sizeSlider = new KlSlider({\r\n        label: LANG('brush-size'),\r\n        width: sizeObj.width,\r\n        height: sizeObj.sliderHeight,\r\n        min: 0,\r\n        max: 500,\r\n        initValue: 50,\r\n        resolution: 225,\r\n        eventResMs: 1000 / 30,\r\n        onChange: function(v) {\r\n            p.brushSettingService.setSize(v);\r\n        },\r\n        formatFunc: function(v) {\r\n            if (v * 2 < 10) {\r\n                return Math.round(v * 2 * 10) / 10;\r\n            }\r\n            return Math.round(v * 2);\r\n        }\r\n    });\r\n    BB.css(sizeSlider.getElement(), {\r\n        marginTop: '2px'\r\n    });\r\n    div.appendChild(sizeSlider.getElement());\r\n\r\n    const opacitySlider = new KlSlider({\r\n        label: LANG('opacity'),\r\n        width: sizeObj.width,\r\n        height: sizeObj.sliderHeight,\r\n        min: 0,\r\n        max: 1,\r\n        initValue: 1,\r\n        resolution: 225,\r\n        eventResMs: 1000 / 30,\r\n        onChange: function(v) {\r\n            p.brushSettingService.setOpacity(v);\r\n        },\r\n        formatFunc: function(v) {\r\n            return Math.round(v * 100);\r\n        }\r\n    });\r\n    BB.css(opacitySlider.getElement(), {\r\n        margin: '2px 0'\r\n    });\r\n    div.appendChild(opacitySlider.getElement());\r\n\r\n\r\n\r\n    // --- general setup ---\r\n\r\n    const subscriptionFunc = function(event) {\r\n        if (event.type === 'color') {\r\n            if (!isVisible) {\r\n                queuedObj.color = event.value;\r\n            } else {\r\n                updateColor(event.value);\r\n            }\r\n        }\r\n        if (event.type === 'size') {\r\n            if (!isVisible) {\r\n                queuedObj.size = event.value;\r\n            } else {\r\n                sizeSlider.setValue(event.value);\r\n            }\r\n        }\r\n        if (event.type === 'opacity') {\r\n            if (!isVisible) {\r\n                queuedObj.opacity = event.value;\r\n            } else {\r\n                opacitySlider.setValue(event.value);\r\n            }\r\n        }\r\n        if (event.type === 'sliderConfig') {\r\n            sizeSlider.update(event.value.sizeSlider);\r\n            opacitySlider.update(event.value.opacitySlider);\r\n        }\r\n    };\r\n    p.brushSettingService.subscribe(subscriptionFunc);\r\n    {\r\n        const sliderConfig = p.brushSettingService.getSliderConfig();\r\n        sizeSlider.update(sliderConfig.sizeSlider);\r\n        opacitySlider.update(sliderConfig.opacitySlider);\r\n        sizeSlider.setValue(p.brushSettingService.getSize());\r\n        opacitySlider.setValue(p.brushSettingService.getOpacity());\r\n    }\r\n\r\n    function updateUI() {\r\n        div.style.display = isVisible ? 'block' : 'none';\r\n        if (isVisible && mousePos) {\r\n            div.style.left = (mousePos.x - Math.round(sizeObj.width / 2)) + 'px';\r\n            div.style.top = (mousePos.y - Math.round(sizeObj.svHeight + sizeObj.hHeight * 3 / 2)) + 'px';\r\n        }\r\n    }\r\n\r\n    let mousePos = null;\r\n    BB.addEventListener(document, 'pointermove', function(event) {\r\n        mousePos = {\r\n            x: event.pageX,\r\n            y: event.pageY,\r\n        };\r\n    });\r\n\r\n    const keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, event, comboStr, isRepeat) {\r\n            if (isRepeat) {\r\n                return;\r\n            }\r\n            if (isVisible) {\r\n                isVisible = false;\r\n                updateUI();\r\n                return;\r\n            }\r\n\r\n            if (!p.enabledTest() || !mousePos) {\r\n                return;\r\n            }\r\n\r\n            if (['ctrl+alt', 'cmd+alt', 'alt+ctrl', 'alt+cmd'].includes(comboStr)) {\r\n                event.preventDefault();\r\n                isVisible = true;\r\n\r\n                if (queuedObj.color !== null) {\r\n                    updateColor(queuedObj.color);\r\n                    queuedObj.color = null;\r\n                }\r\n                if (queuedObj.size !== null) {\r\n                    sizeSlider.setValue(queuedObj.size);\r\n                    queuedObj.size = null;\r\n                }\r\n                if (queuedObj.opacity !== null) {\r\n                    opacitySlider.setValue(queuedObj.opacity);\r\n                    queuedObj.opacity = null;\r\n                }\r\n\r\n                updateUI();\r\n            }\r\n\r\n        },\r\n        onUp: function(keyStr, event, oldComboStr) {\r\n            if (['ctrl+alt', 'cmd+alt', 'alt+ctrl', 'alt+cmd'].includes(oldComboStr) && isVisible) {\r\n                isVisible = false;\r\n                colorSlider.end();\r\n                updateUI();\r\n            }\r\n        },\r\n        onBlur: function() {\r\n            if (isVisible) {\r\n                isVisible = false;\r\n                colorSlider.end();\r\n                updateUI();\r\n            }\r\n        }\r\n    });\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n}","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport klecksLogoImg from 'url:~/src/app/img/klecks-logo.png';\r\n// @ts-ignore\r\nimport newImageImg from 'url:~/src/app/img/ui/new-image.svg';\r\n// @ts-ignore\r\nimport importImg from 'url:~/src/app/img/ui/import.svg';\r\n// @ts-ignore\r\nimport exportImg from 'url:~/src/app/img/ui/export.svg';\r\n// @ts-ignore\r\nimport shareImg from 'url:~/src/app/img/ui/share.svg';\r\n// @ts-ignore\r\nimport helpImg from 'url:~/src/app/img/ui/help.svg';\r\nimport {LANG} from '../../../language/language';\r\n\r\n\r\n/**\r\n * Topmost row of buttons in toolspace (with the app logo)\r\n *\r\n * p = { // button click callbacks\r\n *      logoImg: img,\r\n *     onLogo: function(),\r\n *     onNew: function(),\r\n *     onImport: function(),\r\n *     onSave: function(),\r\n *     onShare: function(),\r\n *     onHelp: function()\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function ToolspaceTopRow(p) {\r\n    let div = document.createElement('div');\r\n    BB.css(div, {\r\n        height: '36px',\r\n        //background: '#f00',\r\n        display: 'flex',\r\n        backgroundImage: 'linear-gradient(to top, rgba(255, 255, 255, 0) 20%, rgba(255, 255, 255, 0.6) 100%)'\r\n    });\r\n\r\n    function createButton(p) {\r\n        let padding = 6 + (p.extraPadding ? p.extraPadding : 0);\r\n        let result = BB.el({\r\n            className: 'toolspace-row-button nohighlight',\r\n            title: p.title,\r\n            onClick: p.onClick,\r\n            css: {\r\n                padding: p.contain ? padding + 'px 0' : ''\r\n            }\r\n        });\r\n        let im = BB.el({\r\n            css: {\r\n                backgroundImage: 'url(\\'' + p.image + '\\')',\r\n                backgroundRepeat: 'no-repeat',\r\n                backgroundPosition: 'center',\r\n                backgroundSize: p.contain ? 'contain' : '',\r\n                //filter: 'grayscale(1)',\r\n                height: '100%'\r\n            }\r\n        });\r\n        im.style.pointerEvents = 'none';\r\n        result.appendChild(im);\r\n        (result as any).pointerListener = new BB.PointerListener({ // because :hover causes problems w touch\r\n            target: result,\r\n            onEnterLeave: function(isOver) {\r\n                if (isOver) {\r\n                    BB.addClassName(result, 'toolspace-row-button-hover');\r\n                } else {\r\n                    BB.removeClassName(result, 'toolspace-row-button-hover');\r\n                }\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n\r\n    let logoButton = createButton({\r\n        onClick: p.onLogo,\r\n        title: LANG('home'),\r\n        image: p.logoImg ? p.logoImg : klecksLogoImg,\r\n        contain: true\r\n    });\r\n    logoButton.style.width = '45px';\r\n    logoButton.style.borderRight = '1px solid rgb(212, 212, 212)';\r\n    let newButton = createButton({\r\n        onClick: p.onNew,\r\n        title: LANG('file-new'),\r\n        image: newImageImg,\r\n        extraPadding: 1,\r\n        contain: true\r\n    });\r\n    let importButton = createButton({\r\n        onClick: p.onImport,\r\n        title: LANG('file-import'),\r\n        image: importImg,\r\n        extraPadding: 1,\r\n        contain: true\r\n    });\r\n    let saveButton = createButton({\r\n        onClick: p.onSave,\r\n        title: LANG('file-save'),\r\n        image: exportImg,\r\n        extraPadding: 1,\r\n        contain: true\r\n    });\r\n\r\n    let shareButton = null;\r\n    if (BB.canShareFiles()) {\r\n        shareButton = createButton({\r\n            onClick: p.onShare,\r\n            title: LANG('file-share'),\r\n            image: shareImg,\r\n            contain: true\r\n        });\r\n    }\r\n    let helpButton = createButton({\r\n        onClick: p.onHelp,\r\n        title: LANG('help'),\r\n        image: helpImg,\r\n        contain: true\r\n    });\r\n\r\n    div.appendChild(logoButton);\r\n    div.appendChild(newButton);\r\n    div.appendChild(importButton);\r\n    div.appendChild(saveButton);\r\n    if (shareButton) {\r\n        div.appendChild(shareButton);\r\n    }\r\n    div.appendChild(helpButton);\r\n\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    }\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"eHdqz\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"3x5dR\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"hbDTd\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"16iGk\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"2ME3z\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"hZnSk\");","import {BB} from '../../../bb/bb';\r\nimport {dialogCounter} from '../modals/modal-count';\r\n// @ts-ignore\r\nimport toolPaintImg from 'url:~/src/app/img/ui/tool-paint.svg';\r\n// @ts-ignore\r\nimport toolFillImg from 'url:~/src/app/img/ui/tool-fill.svg';\r\n// @ts-ignore\r\nimport toolTextImg from 'url:~/src/app/img/ui/tool-text.svg';\r\n// @ts-ignore\r\nimport toolShapeImg from 'url:~/src/app/img/ui/tool-shape.svg';\r\n// @ts-ignore\r\nimport caretDownImg from 'url:~/src/app/img/ui/caret-down.svg';\r\nimport {LANG} from '../../../language/language';\r\n\r\n/**\r\n * Toolrow Dropdown. The button where you select: brush, fill, select, transform, etc.\r\n *\r\n * p = {\r\n *     onChange: func(activeStr)\r\n * }\r\n *\r\n * activeStr = 'draw' | 'fill' | 'text'\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function ToolDropdown(p) {\r\n\r\n    let optionArr = ['draw', 'fill', 'text', 'shape'];\r\n    let imArr = [\r\n        toolPaintImg,\r\n        toolFillImg,\r\n        toolTextImg,\r\n        toolShapeImg\r\n    ];\r\n    let titleArr = [\r\n        `${LANG('tool-brush')} [B]`,\r\n        `${LANG('tool-paint-bucket')} [G]`,\r\n        `${LANG('tool-text')} [T]`,\r\n        `${LANG('tool-shape')} [U]`,\r\n    ];\r\n    let currentActiveIndex = 0;\r\n    let isActive = true;\r\n    let isOpen = false;\r\n\r\n    //preload images\r\n    setTimeout(function() {\r\n        for (let i = 1; i < imArr.length; i++) {\r\n            let im = new Image();\r\n            im.src = imArr[i];\r\n        }\r\n    }, 100);\r\n\r\n    let smallMargin = '6px 0';\r\n    let div = BB.el({\r\n        css: {\r\n            position: 'relative',\r\n            flexGrow: '1'\r\n        }\r\n    });\r\n\r\n    let openTimeout;\r\n    let isDragging = false;\r\n    let startX, startY;\r\n    let pointerListener;\r\n    if (BB.hasPointerEvents) {\r\n        pointerListener = new BB.PointerListener({\r\n            target: div,\r\n            maxPointers: 1,\r\n            onPointer: function(event) {\r\n                if (event.type === 'pointerdown') {\r\n                    if (isOpen) {\r\n                        return;\r\n                    }\r\n\r\n                    openTimeout = setTimeout(function() {\r\n                        showDropdown();\r\n                    }, 400);\r\n                    isDragging = true;\r\n                    startX = event.pageX;\r\n                    startY = event.pageY;\r\n\r\n                } else if (event.type === 'pointermove') {\r\n                    if (isDragging && !isOpen && BB.dist(startX, startY, event.pageX, event.pageY) > 5) {\r\n                        clearTimeout(openTimeout);\r\n                        showDropdown();\r\n                    }\r\n\r\n                } else if (event.type === 'pointerup') {\r\n                    clearTimeout(openTimeout);\r\n                    if (isOpen && isDragging) {\r\n                        let target = document.elementFromPoint(event.pageX, event.pageY);\r\n                        for (let i = 0; i < dropdownBtnArr.length; i++) {\r\n                            if (target === dropdownBtnArr[i].wrapper) {\r\n                                closeDropdown();\r\n                                isActive = true;\r\n                                currentActiveIndex = i;\r\n                                updateButton();\r\n                                p.onChange(optionArr[currentActiveIndex]);\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                    isDragging = false;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    let activeButton = BB.el({\r\n        parent: div,\r\n        className: 'toolspace-row-button nohighlight toolspace-row-button-activated',\r\n        title: titleArr[currentActiveIndex],\r\n        onClick: function(e) {\r\n            if (isActive && !isOpen) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                showDropdown();\r\n                return;\r\n            }\r\n\r\n            isActive = true;\r\n            p.onChange(optionArr[currentActiveIndex]);\r\n            if (isOpen) {\r\n                closeDropdown();\r\n            }\r\n        },\r\n        css: {\r\n            padding: '10px 0',\r\n            pointerEvents: 'auto',\r\n            height: '100%',\r\n            boxSizing: 'border-box'\r\n        }\r\n    });\r\n\r\n    let activeButtonIm = BB.el({\r\n        parent: activeButton,\r\n        css: {\r\n            backgroundRepeat: 'no-repeat',\r\n            backgroundPosition: 'center',\r\n            backgroundSize: 'contain',\r\n            width: 'calc(100% - 7px)',\r\n            height: '100%',\r\n            pointerEvents: 'none',\r\n            opacity: '0.75',\r\n        }\r\n    });\r\n\r\n    let arrowButton = BB.el({\r\n        parent: activeButton,\r\n        css: {\r\n            position: 'absolute',\r\n            right: '1px',\r\n            bottom: '1px',\r\n            width: '18px',\r\n            height: '18px',\r\n            //background: '#aaa',\r\n            //borderRadius: '2px',\r\n            cursor: 'pointer',\r\n\r\n            backgroundImage: 'url(\\'' + caretDownImg + '\\')',\r\n            backgroundRepeat: 'no-repeat',\r\n            backgroundPosition: 'center',\r\n            backgroundSize: '60%'\r\n        },\r\n        title: 'More Tools',\r\n        onClick: function(e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            showDropdown();\r\n        }\r\n    });\r\n\r\n\r\n    let overlay = BB.el({\r\n        css: {\r\n            position: 'absolute',\r\n            //background: 'rgba(255,0,0,0.5)',\r\n            left: '0',\r\n            top: '0',\r\n            right: '0',\r\n            bottom: '0'\r\n        }\r\n    });\r\n    let overlayPointerListener = new BB.PointerListener({\r\n        target: overlay,\r\n        pointers: 1,\r\n        onPointer: function(e) {\r\n            if (e.type === 'pointerdown') {\r\n                e.eventPreventDefault();\r\n                closeDropdown();\r\n            }\r\n        }\r\n    });\r\n\r\n    let dropdownWrapper = BB.el({\r\n        className: 'tool-dropdown-wrapper',\r\n        css: {\r\n            position: 'absolute',\r\n            width: '100%',\r\n            height: (100 * (optionArr.length - 1)) + '%',\r\n            top: '100%',\r\n            left: '0',\r\n            zIndex: '1',\r\n            boxSizing: 'border-box',\r\n            cursor: 'pointer',\r\n            transition: 'height 0.1s ease-in-out, opacity 0.1s ease-in-out',\r\n            borderBottomLeftRadius: '5px',\r\n            borderBottomRightRadius: '5px',\r\n            overflow: 'hidden',\r\n        }\r\n    });\r\n\r\n    let dropdownBtnArr = [];\r\n\r\n    function createDropdownButton(p) {\r\n        let result = {};\r\n\r\n        let wrapper = BB.el({\r\n            parent: dropdownWrapper,\r\n            className: 'tool-dropdown-button',\r\n            title: p.title,\r\n            css: {\r\n                padding: '10px 0',\r\n                height: (100 / (optionArr.length - 1)) + '%',\r\n                boxSizing: 'border-box'\r\n            },\r\n            onClick: function(e) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                p.onClick(p.index, p.id);\r\n            }\r\n        });\r\n        (result as any).wrapper = wrapper;\r\n        let im = BB.el({\r\n            parent: wrapper,\r\n            css: {\r\n                backgroundImage: 'url(\\'' + p.image + '\\')',\r\n                backgroundRepeat: 'no-repeat',\r\n                backgroundPosition: 'center',\r\n                backgroundSize: 'contain',\r\n                height: '100%',\r\n                pointerEvents: 'none',\r\n                opacity: '0.75'\r\n            }\r\n        });\r\n\r\n        // --- interface ---\r\n        (result as any).show = function(b) {\r\n            wrapper.style.display = b ? 'block' : 'none';\r\n        };\r\n\r\n        (result as any).setIsSmall = function(b) {\r\n            wrapper.style.padding = b ? smallMargin : '10px 0';\r\n        };\r\n\r\n        return result;\r\n    }\r\n\r\n    function onClickDropdownBtn(index, id) {\r\n        closeDropdown();\r\n\r\n        isActive = true;\r\n        currentActiveIndex = index;\r\n\r\n        updateButton();\r\n\r\n        p.onChange(optionArr[currentActiveIndex]);\r\n    }\r\n\r\n    for (let i = 0; i < optionArr.length; i++) {\r\n        dropdownBtnArr.push(createDropdownButton({\r\n            index: i,\r\n            id: optionArr[i],\r\n            image: imArr[i],\r\n            title: titleArr[i],\r\n            onClick: onClickDropdownBtn\r\n        }));\r\n    }\r\n\r\n    function showDropdown() {\r\n        dialogCounter.increase(0.5);\r\n        isOpen = true;\r\n\r\n        for (let i = 0; i < optionArr.length; i++) {\r\n            dropdownBtnArr[i].show(currentActiveIndex !== i);\r\n        }\r\n\r\n        arrowButton.style.display = 'none';\r\n        div.style.zIndex = '1';\r\n        document.body.appendChild(overlay);\r\n        div.appendChild(dropdownWrapper);\r\n    }\r\n\r\n    function closeDropdown() {\r\n        dialogCounter.decrease(0.5);\r\n        isOpen = false;\r\n        arrowButton.style.removeProperty('display');\r\n        div.style.removeProperty('z-index');\r\n        document.body.removeChild(overlay);\r\n\r\n        div.removeChild(dropdownWrapper);\r\n    }\r\n\r\n    function updateButton() {\r\n        activeButton.title = titleArr[currentActiveIndex];\r\n        activeButtonIm.style.backgroundImage = 'url(\\'' + imArr[currentActiveIndex] + '\\')';\r\n    }\r\n    updateButton();\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.setIsSmall = function(b) {\r\n        activeButton.style.padding = b ? smallMargin : '10px 0';\r\n        for (let i = 0; i < optionArr.length; i++) {\r\n            dropdownBtnArr[i].setIsSmall(b);\r\n        }\r\n        if (b) {\r\n            arrowButton.style.width = '14px';\r\n            arrowButton.style.height = '14px';\r\n        } else {\r\n            arrowButton.style.width = '18px';\r\n            arrowButton.style.height = '18px';\r\n        }\r\n    };\r\n\r\n    this.setActive = function(activeStr) {\r\n        if (optionArr.includes(activeStr)) {\r\n            isActive = true;\r\n            for (let i = 0; i < optionArr.length; i++) {\r\n                if (optionArr[i] === activeStr) {\r\n                    currentActiveIndex = i;\r\n                    break;\r\n                }\r\n            }\r\n            BB.addClassName(activeButton, 'toolspace-row-button-activated');\r\n            updateButton();\r\n        } else {\r\n            isActive = false;\r\n            BB.removeClassName(activeButton, 'toolspace-row-button-activated');\r\n        }\r\n    };\r\n\r\n    this.getActive = function() {\r\n        return optionArr[currentActiveIndex];\r\n    };\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"6mHrC\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"hS5Hj\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"doX4v\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"7NqHO\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"dz3mY\");","import {BB} from '../../../bb/bb';\r\nimport {ToolDropdown} from './tool-dropdown';\r\n// @ts-ignore\r\nimport toolHandImg from 'url:~/src/app/img/ui/tool-hand.svg';\r\n// @ts-ignore\r\nimport toolZoomInImg from 'url:~/src/app/img/ui/tool-zoom-in.svg';\r\n// @ts-ignore\r\nimport toolZoomOutImg from 'url:~/src/app/img/ui/tool-zoom-out.svg';\r\n// @ts-ignore\r\nimport toolUndoImg from 'url:~/src/app/img/ui/tool-undo.svg';\r\nimport {LANG} from '../../../language/language';\r\n\r\n\r\n/**\r\n * Row of buttons in toolspace. image-operations (draw, hand), zoom, undo/redo\r\n * Need to do syncing. So tool is correct, and zoom/undo/redo buttons are properly enabled/disabled\r\n * heights: 54px tall, 36px small -> via setIsSmall\r\n *\r\n * p = {\r\n *     onActivate: function(activeStr), // clicking on tool button - activating it\r\n *     onZoomIn: function(),\r\n *     onZoomOut: function(),\r\n *     onUndo: function(),\r\n *     onRedo: function(),\r\n * }\r\n *\r\n * activeStr = 'draw' | 'hand' | 'fill' | 'text'\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function ToolspaceToolRow(p) {\r\n    let div = document.createElement('div');\r\n    BB.css(div, {\r\n        height: '54px',\r\n        //height: '36px',\r\n        display: 'flex',\r\n        backgroundImage: 'linear-gradient(to top, rgba(255, 255, 255, 0) 20%, rgba(255, 255, 255, 0.6) 100%)'\r\n    });\r\n\r\n    let currentActiveStr = 'draw'; // 'draw' | 'hand' | 'fill'\r\n\r\n    function setActive(activeStr, doEmit?) {\r\n        if (currentActiveStr === activeStr) {\r\n            return;\r\n        }\r\n\r\n        currentActiveStr = activeStr;\r\n\r\n        toolDropdown.setActive(currentActiveStr);\r\n        if (currentActiveStr === 'hand') {\r\n            BB.addClassName(handButton, 'toolspace-row-button-activated');\r\n        } else {\r\n            BB.removeClassName(handButton, 'toolspace-row-button-activated');\r\n        }\r\n\r\n        if (doEmit) {\r\n            p.onActivate(currentActiveStr);\r\n        }\r\n    }\r\n\r\n    function createButton(p) {\r\n\r\n        let smallMargin = p.doLighten ? '6px 0' : '8px 0';\r\n\r\n        let result = BB.el({\r\n            className: 'toolspace-row-button nohighlight',\r\n            //title: p.title,\r\n            onClick: p.onClick,\r\n            css: {\r\n                padding: p.contain ? '10px 0' : ''\r\n            }\r\n        });\r\n        let im = BB.el({\r\n            css: {\r\n                backgroundImage: 'url(\\'' + p.image + '\\')',\r\n                backgroundRepeat: 'no-repeat',\r\n                backgroundPosition: 'center',\r\n                backgroundSize: p.contain ? 'contain' : '',\r\n                //filter: 'grayscale(1)',\r\n                height: '100%',\r\n                transform: p.doMirror ? 'scale(-1, 1)' : '',\r\n                pointerEvents: 'none',\r\n                opacity: p.doLighten ? '0.75' : '1'\r\n            }\r\n        });\r\n        result.appendChild(im);\r\n        (result as any).pointerListener = new BB.PointerListener({ // because :hover causes problems w touch\r\n            target: result,\r\n            onEnterLeave: function(isOver) {\r\n                if (isOver) {\r\n                    BB.addClassName(result, 'toolspace-row-button-hover');\r\n                } else {\r\n                    BB.removeClassName(result, 'toolspace-row-button-hover');\r\n                }\r\n            }\r\n        });\r\n        (result as any).setIsSmall = function(b) {\r\n            result.style.padding = p.contain ? (b ? smallMargin : '10px 0') : '';\r\n        }\r\n        return result;\r\n    }\r\n\r\n\r\n    function createTriangleButton(p) { // because IE and Edge don't support clip path\r\n\r\n        let result = document.createElement('div');\r\n        BB.css(result, {\r\n            flexGrow: '1',\r\n            position: 'relative'\r\n        });\r\n\r\n        let svg = BB.createSvg({\r\n            elementType: 'svg',\r\n            width: '67px', // can't think of a way doing with percentage\r\n            height: '54px',\r\n            viewBox: '0 0 100 100',\r\n            preserveAspectRatio: 'none'\r\n        });\r\n        BB.css(svg, {\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0'\r\n        });\r\n\r\n        let blurRadius = 10;\r\n        let blurOffsetX = 2;\r\n        let blurOffsetY = 2;\r\n\r\n        let defs = BB.createSvg( { // inset shadow via svg\r\n            elementType: 'defs',\r\n            childrenArr: [\r\n                {\r\n                    elementType: 'filter',\r\n                    id: 'innershadow',\r\n                    x0: '-50%',\r\n                    y0: '-50%',\r\n                    width: '200%',\r\n                    height: '200%',\r\n                    childrenArr: [\r\n                        {\r\n                            elementType: 'feGaussianBlur',\r\n                            in: 'SourceAlpha',\r\n                            stdDeviation: '' + blurRadius,\r\n                            result: 'blur'\r\n                        }, {\r\n                            elementType: 'feOffset',\r\n                            dx: '' + blurOffsetX,\r\n                            dy: '' + blurOffsetY\r\n                        }, {\r\n                            elementType: 'feComposite',\r\n                            in2: 'SourceAlpha',\r\n                            operator: 'arithmetic',\r\n                            k2: '-1',\r\n                            k3: '1',\r\n                            result: 'shadowDiff'\r\n                        },\r\n\r\n                        {\r\n                            elementType: 'feFlood',\r\n                            'flood-color': '#000',\r\n                            'flood-opacity': '0.2'\r\n                        }, {\r\n                            elementType: 'feComposite',\r\n                            in2: 'shadowDiff',\r\n                            operator: 'in'\r\n                        }, {\r\n                            elementType: 'feComposite',\r\n                            in2: 'SourceGraphic',\r\n                            operator: 'over',\r\n                            result: 'firstfilter'\r\n                        },\r\n\r\n                        {\r\n                            elementType: 'feGaussianBlur',\r\n                            in: 'firstfilter',\r\n                            stdDeviation: '' + blurRadius,\r\n                            result: 'blur2'\r\n                        }, {\r\n                            elementType: 'feOffset',\r\n                            dx: '' + blurOffsetX,\r\n                            dy: '' + blurOffsetY\r\n                        }, {\r\n                            elementType: 'feComposite',\r\n                            in2: 'firstfilter',\r\n                            operator: 'arithmetic',\r\n                            k2: '-1',\r\n                            k3: '1',\r\n                            result: 'shadowDiff'\r\n                        },\r\n\r\n                        {\r\n                            elementType: 'feFlood',\r\n                            'flood-color': '#000',\r\n                            'flood-opacity': '0.2'\r\n                        }, {\r\n                            elementType: 'feComposite',\r\n                            in2: 'shadowDiff',\r\n                            operator: 'in'\r\n                        }, {\r\n                            elementType: 'feComposite',\r\n                            in2: 'firstfilter',\r\n                            operator: 'over'\r\n                        }\r\n                    ]\r\n                }\r\n            ]\r\n        });\r\n\r\n\r\n        let svgTriangleLeft = BB.createSvg({\r\n            elementType: 'path',\r\n            'vector-effect': 'non-scaling-stroke',\r\n            d: 'M0,0 L 100,0 0,100 z',\r\n            fill: 'rgba(0,0,0,0)',\r\n            class: 'toolspace-svg-triangle-button'\r\n        });\r\n        svgTriangleLeft.onclick = function() {\r\n            p.onLeft();\r\n            BB.removeClassName(svgTriangleLeft, 'toolspace-svg-triangle-button-hover');\r\n        };\r\n\r\n        let svgTriangleRight = BB.createSvg({\r\n            elementType: 'path',\r\n            'vector-effect': 'non-scaling-stroke',\r\n            d: 'M100,100 L 100,0 0,100 z',\r\n            fill: 'rgba(0,0,0,0)',\r\n            class: 'toolspace-svg-triangle-button'\r\n        });\r\n        svgTriangleRight.onclick = function() {\r\n            p.onRight();\r\n            BB.removeClassName(svgTriangleRight, 'toolspace-svg-triangle-button-hover');\r\n        };\r\n\r\n        // because :hover causes problems w touch\r\n        (result as any).leftPointerListener = new BB.PointerListener({\r\n            target: svgTriangleLeft,\r\n            onEnterLeave: function(isOver) {\r\n                if (isOver) {\r\n                    BB.addClassName(svgTriangleLeft, 'toolspace-svg-triangle-button-hover');\r\n                } else {\r\n                    BB.removeClassName(svgTriangleLeft, 'toolspace-svg-triangle-button-hover');\r\n                }\r\n            }\r\n        });\r\n        (result as any).rightPointerListener = new BB.PointerListener({\r\n            target: svgTriangleRight,\r\n            onEnterLeave: function(isOver) {\r\n                if (isOver) {\r\n                    BB.addClassName(svgTriangleRight, 'toolspace-svg-triangle-button-hover');\r\n                } else {\r\n                    BB.removeClassName(svgTriangleRight, 'toolspace-svg-triangle-button-hover');\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n        svg.appendChild(defs);\r\n        svg.appendChild(svgTriangleLeft);\r\n        svg.appendChild(svgTriangleRight);\r\n        result.appendChild(svg);\r\n\r\n\r\n        let leftIm = BB.el({\r\n            css: {\r\n                backgroundImage: 'url(\\'' + p.leftImage + '\\')',\r\n                backgroundRepeat: 'no-repeat',\r\n                backgroundSize: 'contain',\r\n                width: '20px',\r\n                height: '20px',\r\n                position: 'absolute',\r\n                left: '10px',\r\n                top: '8px',\r\n                //transform: p.doMirror ? 'scale(-1, 1)' : '',\r\n                pointerEvents: 'none'\r\n            }\r\n        });\r\n        result.appendChild(leftIm);\r\n\r\n\r\n        let rightIm = BB.el({\r\n            css: {\r\n                backgroundImage: 'url(\\'' + (p.rightImage ? p.rightImage : p.leftImage) + '\\')',\r\n                backgroundRepeat: 'no-repeat',\r\n                backgroundSize: 'contain',\r\n                width: '20px',\r\n                height: '20px',\r\n                position: 'absolute',\r\n                right: '10px',\r\n                bottom: '8px',\r\n                transform: p.rightImage ? '' : 'scale(-1, 1)',\r\n                pointerEvents: 'none'\r\n            }\r\n        });\r\n        result.appendChild(rightIm);\r\n\r\n\r\n\r\n\r\n\r\n        (result as any).setIsEnabledLeft = function(b) {\r\n            if (b) {\r\n                BB.removeClassName(svgTriangleLeft, 'toolspace-row-button-disabled');\r\n                BB.removeClassName(leftIm, 'toolspace-row-button-disabled');\r\n            } else {\r\n                BB.addClassName(svgTriangleLeft, 'toolspace-row-button-disabled');\r\n                BB.addClassName(leftIm, 'toolspace-row-button-disabled');\r\n            }\r\n        };\r\n        (result as any).setIsEnabledRight = function(b) {\r\n            if (b) {\r\n                BB.removeClassName(svgTriangleRight, 'toolspace-row-button-disabled');\r\n                BB.removeClassName(rightIm, 'toolspace-row-button-disabled');\r\n            } else {\r\n                BB.addClassName(svgTriangleRight, 'toolspace-row-button-disabled');\r\n                BB.addClassName(rightIm, 'toolspace-row-button-disabled');\r\n            }\r\n        };\r\n\r\n        return result;\r\n    }\r\n\r\n    function createTriangleButtonViaClipPath(p) {\r\n        let result = document.createElement('div');\r\n        BB.css(result, {\r\n            flexGrow: '1',\r\n            position: 'relative'\r\n        });\r\n\r\n\r\n        let leftButton = BB.el({\r\n            className: 'toolspace-triangle-button',\r\n            onClick: p.onLeft,\r\n            css: {\r\n                clipPath: 'polygon(0% 0%, 100% 0%, 100% 0%, 0% 100%)'\r\n            }\r\n        });\r\n\r\n        let leftIm = BB.el({\r\n            css: {\r\n                backgroundImage: 'url(\\'' + p.leftImage + '\\')',\r\n                backgroundRepeat: 'no-repeat',\r\n                backgroundSize: 'contain',\r\n                width: '20px',\r\n                height: '20px',\r\n                position: 'absolute',\r\n                left: '10px',\r\n                top: '8px',\r\n                //transform: p.doMirror ? 'scale(-1, 1)' : '',\r\n                pointerEvents: 'none'\r\n            }\r\n        });\r\n        leftButton.appendChild(leftIm);\r\n\r\n\r\n\r\n        let rightButton = BB.el({\r\n            className: 'toolspace-triangle-button',\r\n            onClick: p.onRight,\r\n            css: {\r\n                clipPath: 'polygon(0% 100%, 100% 0%, 100% 100%, 0% 100%)'\r\n            }\r\n        });\r\n\r\n        let rightIm = BB.el({\r\n            css: {\r\n                backgroundImage: 'url(\\'' + (p.rightImage ? p.rightImage : p.leftImage) + '\\')',\r\n                backgroundRepeat: 'no-repeat',\r\n                backgroundSize: 'contain',\r\n                width: '20px',\r\n                height: '20px',\r\n                position: 'absolute',\r\n                right: '10px',\r\n                bottom: '8px',\r\n                transform: p.rightImage ? '' : 'scale(-1, 1)',\r\n                pointerEvents: 'none'\r\n            }\r\n        });\r\n        rightButton.appendChild(rightIm);\r\n\r\n\r\n\r\n        result.appendChild(leftButton);\r\n        result.appendChild(rightButton);\r\n\r\n\r\n        // because :hover causes problems w touch\r\n        (result as any).leftPointerListener = new BB.PointerListener({\r\n            target: leftButton,\r\n            onEnterLeave: function(isOver) {\r\n                if (isOver) {\r\n                    BB.addClassName(leftButton, 'toolspace-row-button-hover');\r\n                } else {\r\n                    BB.removeClassName(leftButton, 'toolspace-row-button-hover');\r\n                }\r\n            }\r\n        });\r\n        (result as any).rightPointerListener = new BB.PointerListener({\r\n            target: rightButton,\r\n            onEnterLeave: function(isOver) {\r\n                if (isOver) {\r\n                    BB.addClassName(rightButton, 'toolspace-row-button-hover');\r\n                } else {\r\n                    BB.removeClassName(rightButton, 'toolspace-row-button-hover');\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n\r\n        (result as any).setIsEnabledLeft = function(b) {\r\n            if (b) {\r\n                BB.removeClassName(leftButton, 'toolspace-row-button-disabled');\r\n            } else {\r\n                BB.addClassName(leftButton, 'toolspace-row-button-disabled');\r\n            }\r\n        };\r\n        (result as any).setIsEnabledRight = function(b) {\r\n            if (b) {\r\n                BB.removeClassName(rightButton, 'toolspace-row-button-disabled');\r\n            } else {\r\n                BB.addClassName(rightButton, 'toolspace-row-button-disabled');\r\n            }\r\n        };\r\n        return result;\r\n    }\r\n\r\n    /*let brushButton = createButton({\r\n        onClick: function() {\r\n            setActive('draw', true);\r\n        },\r\n        image: 'app/img/ui/paint.png',\r\n        contain: true,\r\n        doLighten: true\r\n    });\r\n    BB.addClassName(brushButton, 'toolspace-row-button-activated');\r\n    div.appendChild(brushButton);*/\r\n\r\n    let toolDropdown = new ToolDropdown({\r\n        onChange: function(activeStr) {\r\n            setActive(activeStr, true);\r\n        }\r\n    });\r\n    div.appendChild(toolDropdown.getElement());\r\n\r\n    let handButton = createButton({\r\n        onClick: function() {\r\n            setActive('hand', true);\r\n        },\r\n        image: toolHandImg,\r\n        contain: true,\r\n        doLighten: true\r\n    });\r\n    handButton.style.borderRight = '1px solid rgb(212, 212, 212)';\r\n    handButton.title = LANG('tool-hand');\r\n    div.appendChild(handButton);\r\n\r\n    let zoomInNOutButton = createTriangleButton({\r\n        onLeft: p.onZoomIn,\r\n        onRight: p.onZoomOut,\r\n        leftImage: toolZoomInImg,\r\n        rightImage: toolZoomOutImg,\r\n    });\r\n    zoomInNOutButton.title = LANG('tool-zoom');\r\n    div.appendChild(zoomInNOutButton);\r\n\r\n    let zoomInButton = createButton({\r\n        onClick: p.onZoomIn,\r\n        image: toolZoomInImg,\r\n        contain: true\r\n    });\r\n    zoomInButton.title = LANG('zoom-in');\r\n    div.appendChild(zoomInButton);\r\n\r\n    let zoomOutButton = createButton({\r\n        onClick: p.onZoomOut,\r\n        image: toolZoomOutImg,\r\n        contain: true\r\n    });\r\n    zoomOutButton.title = LANG('zoom-out');\r\n    div.appendChild(zoomOutButton);\r\n\r\n    let undoNRedoButton = createTriangleButton({\r\n        onLeft: p.onUndo,\r\n        onRight: p.onRedo,\r\n        leftImage: toolUndoImg,\r\n        rightImage: null,\r\n    });\r\n    undoNRedoButton.title = LANG('tool-undo-redo');\r\n    (undoNRedoButton as any).setIsEnabledLeft(false);\r\n    (undoNRedoButton as any).setIsEnabledRight(false);\r\n    div.appendChild(undoNRedoButton);\r\n\r\n    let undoButton = createButton({\r\n        onClick: p.onUndo,\r\n        image: toolUndoImg,\r\n        contain: true\r\n    });\r\n    undoButton.title = LANG('undo');\r\n    BB.addClassName(undoButton, 'toolspace-row-button-disabled');\r\n    div.appendChild(undoButton);\r\n\r\n    let redoButton = createButton({\r\n        onClick: p.onRedo,\r\n        image: toolUndoImg,\r\n        contain: true,\r\n        doMirror: true\r\n    });\r\n    redoButton.title = LANG('redo');\r\n    BB.addClassName(redoButton, 'toolspace-row-button-disabled');\r\n    div.appendChild(redoButton);\r\n\r\n    zoomInButton.style.display = 'none';\r\n    zoomOutButton.style.display = 'none';\r\n    undoButton.style.display = 'none';\r\n    redoButton.style.display = 'none';\r\n\r\n\r\n\r\n\r\n\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n    this.setIsSmall = function(b) {\r\n        BB.css(div, {\r\n            height: b ? '36px' : '54px'\r\n        });\r\n\r\n        toolDropdown.setIsSmall(b);\r\n        (handButton as any).setIsSmall(b);\r\n        (zoomInButton as any).setIsSmall(b);\r\n        (zoomOutButton as any).setIsSmall(b);\r\n        (undoButton as any).setIsSmall(b);\r\n        (redoButton as any).setIsSmall(b);\r\n\r\n        if (b) {\r\n            zoomInNOutButton.style.display = 'none';\r\n            undoNRedoButton.style.display = 'none';\r\n            zoomInButton.style.display = 'block';\r\n            zoomOutButton.style.display = 'block';\r\n            undoButton.style.display = 'block';\r\n            redoButton.style.display = 'block';\r\n        } else {\r\n            zoomInNOutButton.style.display = 'block';\r\n            undoNRedoButton.style.display = 'block';\r\n            zoomInButton.style.display = 'none';\r\n            zoomOutButton.style.display = 'none';\r\n            undoButton.style.display = 'none';\r\n            redoButton.style.display = 'none';\r\n        }\r\n\r\n    };\r\n\r\n    this.setEnableZoomIn = function(b) {\r\n        if (b) {\r\n            BB.removeClassName(zoomInButton, 'toolspace-row-button-disabled');\r\n        } else {\r\n            BB.addClassName(zoomInButton, 'toolspace-row-button-disabled');\r\n        }\r\n        (zoomInNOutButton as any).setIsEnabledLeft(b);\r\n    };\r\n    this.setEnableZoomOut = function(b) {\r\n        if (b) {\r\n            BB.removeClassName(zoomOutButton, 'toolspace-row-button-disabled');\r\n        } else {\r\n            BB.addClassName(zoomOutButton, 'toolspace-row-button-disabled');\r\n        }\r\n        (zoomInNOutButton as any).setIsEnabledRight(b);\r\n    };\r\n    this.setEnableUndo = function(b) {\r\n        if (b) {\r\n            BB.removeClassName(undoButton, 'toolspace-row-button-disabled');\r\n        } else {\r\n            BB.addClassName(undoButton, 'toolspace-row-button-disabled');\r\n        }\r\n        (undoNRedoButton as any).setIsEnabledLeft(b);\r\n    };\r\n    this.setEnableRedo = function(b) {\r\n        if (b) {\r\n            BB.removeClassName(redoButton, 'toolspace-row-button-disabled');\r\n        } else {\r\n            BB.addClassName(redoButton, 'toolspace-row-button-disabled');\r\n        }\r\n        (undoNRedoButton as any).setIsEnabledRight(b);\r\n    };\r\n    this.setActive = function(activeStr) {\r\n        setActive(activeStr);\r\n    };\r\n    this.getActive = function() {\r\n        return currentActiveStr;\r\n    };\r\n\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"2gZH2\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"04ZZm\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"j9xio\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"AnO0a\");","import {BB} from '../../../bb/bb';\r\nimport {Select} from '../base-components/select';\r\nimport {LANG} from '../../../language/language';\r\n\r\n/**\r\n * Ui to select stabilizer level. 4 options. returned as 0-3\r\n *\r\n * p = {\r\n *     smoothing: number, // initial level 0-3\r\n *     onSelect: function(level number) // 0-3, when level changes\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function ToolspaceStabilizerRow(p) {\r\n\r\n    let div = BB.el({\r\n        tagName: 'label',\r\n        content: LANG('stabilizer') + '&nbsp;',\r\n        title: LANG('stabilizer-title'),\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            fontSize: '13px',\r\n            color: 'rgba(0,0,0,0.6)'\r\n        }\r\n    });\r\n\r\n    let strengthSelect = new Select({\r\n        optionArr: [\r\n            ['0', '0'],\r\n            ['1', '1'],\r\n            ['2', '2'],\r\n            ['3', '3'],\r\n            ['4', '4'],\r\n            ['5', '5']\r\n        ],\r\n        initValue: p.smoothing,\r\n        onChange: function(val) {\r\n            p.onSelect(parseInt(val));\r\n        }\r\n    });\r\n    div.appendChild(strengthSelect.getElement());\r\n\r\n    let pointerListener = new BB.PointerListener({\r\n        target: div,\r\n        onWheel: function(e) {\r\n            strengthSelect.setDeltaValue(e.deltaY);\r\n        }\r\n    });\r\n\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n}","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport invertedBorderImg from 'url:~/src/app/img/ui/inverted-border.svg';\r\n\r\n/**\r\n * row of tabs. uses css class .tabrow-tab\r\n *\r\n * p = {\r\n *     initialId: string, // e.g. 'draw'\r\n *     useAccent: boolean,\r\n *     tabArr: [\r\n *         {\r\n *             id: string, // e.g. 'draw',\r\n *             label: string, // optional\r\n *             image: string, // optional background image\r\n *             title: string, // optional\r\n *             isVisible: boolean, // optional - default is true\r\n *             onOpen: function(),\r\n *             onClose: function(),\r\n *             css: {...},\r\n *         }\r\n *     ]\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function TabRow(p) {\r\n    let _this = this;\r\n    let height = 35;\r\n    let div = BB.el({\r\n        className: 'tabrow',\r\n        css: {\r\n            height: height + 'px'\r\n        }\r\n    });\r\n\r\n    let tabArr = []; //creates its own internal arr\r\n    let openedTabObj = null;\r\n\r\n    const roundSize = 10;\r\n    const roundRight = BB.el({\r\n        css: {\r\n            width: roundSize + 'px',\r\n            height: roundSize + 'px',\r\n            backgroundImage: `url('${invertedBorderImg}')`,\r\n            backgroundSize: 'cover',\r\n            position: 'absolute',\r\n            right: -roundSize + 'px',\r\n            bottom: '0',\r\n            pointerEvents: 'none',\r\n        }\r\n    });\r\n    const roundLeft = BB.el({\r\n        css: {\r\n            width: roundSize + 'px',\r\n            height: roundSize + 'px',\r\n            backgroundImage: `url('${invertedBorderImg}')`,\r\n            backgroundSize: 'cover',\r\n            position: 'absolute',\r\n            left: -roundSize + 'px',\r\n            bottom: '0',\r\n            transform: 'scale(-1,1)',\r\n            pointerEvents: 'none',\r\n        }\r\n    });\r\n\r\n    function createTab(pTabObj, initialId, useAccent) {\r\n        let result: any = {\r\n            id: pTabObj.id,\r\n            isVisible: 'isVisible' in pTabObj ? pTabObj.isVisible : true,\r\n            onOpen: pTabObj.onOpen,\r\n            onClose: pTabObj.onClose,\r\n            update: function(openedTabObj) {\r\n                tabDiv.className = openedTabObj === result ? (useAccent ? 'tabrow-tab tabrow-tab-opened-accented' : 'tabrow-tab tabrow-tab-opened') : 'tabrow-tab';\r\n                tabDiv.style.display = result.isVisible ? 'block' : 'none';\r\n            }\r\n        };\r\n        let tabDiv = BB.el({\r\n            content: 'label' in pTabObj ? pTabObj.label : '',\r\n            title: 'title' in pTabObj ? pTabObj.title : undefined,\r\n            className: initialId === result.id ? (useAccent ? 'tabrow-tab tabrow-tab-opened-accented' : 'tabrow-tab tabrow-tab-opened') : 'tabrow-tab',\r\n            css: {\r\n                lineHeight: height + 'px',\r\n                display: result.isVisible ? 'block' : 'none',\r\n                zIndex: '0',\r\n            },\r\n            onClick: function() {\r\n                if (openedTabObj === result) {\r\n                    return;\r\n                }\r\n                _this.open(result.id);\r\n            }\r\n        });\r\n        result.div = tabDiv;\r\n        if ('image' in pTabObj) {\r\n            BB.css(tabDiv, {\r\n                backgroundImage: 'url(\\'' + pTabObj.image + '\\')',\r\n                backgroundSize: (height - 7) + 'px'\r\n            });\r\n        }\r\n        if ('css' in pTabObj) {\r\n            BB.css(tabDiv, pTabObj.css);\r\n        }\r\n        div.appendChild(tabDiv);\r\n\r\n        let pointerListener = new BB.PointerListener({ // because :hover causes problems w touch\r\n            target: tabDiv,\r\n            onEnterLeave: function(isOver) {\r\n                if (isOver) {\r\n                    BB.addClassName(tabDiv, 'tabrow-tab-hover');\r\n                } else {\r\n                    BB.removeClassName(tabDiv, 'tabrow-tab-hover');\r\n                }\r\n            }\r\n        });\r\n\r\n        if (initialId === result.id) {\r\n            result.onOpen();\r\n            result.div.appendChild(roundRight);\r\n            result.div.appendChild(roundLeft);\r\n        } else {\r\n            result.onClose();\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    for (let i = 0; i < p.tabArr.length; i++) {\r\n        tabArr.push(createTab(p.tabArr[i], p.initialId, p.useAccent));\r\n    }\r\n\r\n    for (let i = 0; i < tabArr.length; i++) {\r\n        if (tabArr[i].id === p.initialId) {\r\n            openedTabObj = tabArr[i];\r\n        }\r\n    }\r\n    if (openedTabObj === null) {\r\n        throw 'invalid initialId';\r\n    }\r\n\r\n    function update() {\r\n        for (let i = 0; i < tabArr.length; i++) {\r\n            tabArr[i].update(openedTabObj);\r\n        }\r\n    }\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.open = function(tabId) {\r\n        for (let i = 0; i < tabArr.length; i++) {\r\n            if (tabArr[i].id === tabId) {\r\n                if (openedTabObj === tabArr[i]) { // already open\r\n                    return;\r\n                }\r\n                openedTabObj.onClose();\r\n                openedTabObj = tabArr[i];\r\n                openedTabObj.onOpen();\r\n                openedTabObj.div.appendChild(roundRight);\r\n                openedTabObj.div.appendChild(roundLeft);\r\n                update();\r\n                return;\r\n            }\r\n        }\r\n        throw 'TabRow.open - invalid tabId';\r\n    };\r\n\r\n    this.getOpenedTabId = function() {\r\n        return '' + openedTabObj.id;\r\n    };\r\n\r\n    this.setIsVisible = function(tabId, isVisible) {\r\n        for (let i = 0; i < tabArr.length; i++) {\r\n            if (tabArr[i].id === tabId) {\r\n                tabArr[i].isVisible = !!isVisible;\r\n                update();\r\n                return;\r\n            }\r\n        }\r\n        throw 'TabRow.setIsVisible - invalid tabId';\r\n    };\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"nTvP2\");","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport angleImg from 'url:~/src/app/img/ui/angle.svg';\r\n// @ts-ignore\r\nimport rotateImg from 'url:~/src/app/img/ui/edit-rotate.svg';\r\nimport {LANG} from '../../../language/language';\r\n\r\n/**\r\n * Ui, when hand tool tab is open.\r\n *\r\n * p = {\r\n *     scale: number, // initial value\r\n *     angleDeg: number, // initial value\r\n *     onReset: function(),\r\n *     onFit: function(),\r\n *     onAngleChange: function(angleDeg number, isRelative number)\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function HandUi(p) {\r\n    let div = BB.el({\r\n        css: {\r\n            margin: '10px'\r\n        }\r\n    });\r\n    let isVisible = true;\r\n    let scale = p.scale;\r\n    let angleDeg = p.angleDeg;\r\n\r\n    let row1 = BB.el({\r\n        css: {\r\n            marginBottom: '10px',\r\n            display: 'flex'\r\n        }\r\n    });\r\n    let row2 = BB.el({\r\n        css: {\r\n            display: 'flex',\r\n            marginBottom: '10px',\r\n        }\r\n    });\r\n    let row3 = BB.el({\r\n        css: {\r\n            display: 'flex'\r\n        }\r\n    });\r\n    div.append(row1, row2, row3);\r\n\r\n\r\n    let scaleEl = BB.el({\r\n        css: {\r\n            width: '55px',\r\n            userSelect: 'none'\r\n        }\r\n    });\r\n    row1.appendChild(scaleEl);\r\n\r\n    let angleIm = new Image();\r\n    angleIm.src = angleImg;\r\n    BB.css(angleIm, {\r\n        verticalAlign: 'bottom',\r\n        width: '20px',\r\n        height: '20px',\r\n        marginRight: '5px',\r\n        borderRadius: '10px',\r\n        background: 'rgba(0,0,0,0.2)',\r\n        userSelect: 'none'\r\n    });\r\n    row1.appendChild(angleIm);\r\n\r\n    let angleEl = BB.el({\r\n        css: {\r\n            userSelect: 'none'\r\n        }\r\n    });\r\n    row1.appendChild(angleEl);\r\n\r\n\r\n    function update() {\r\n        scaleEl.innerHTML = Math.round(scale * 100) + '%';\r\n        angleEl.innerHTML =  Math.round(angleDeg) + '°';\r\n\r\n\r\n        angleIm.style.transform = 'rotate(' + angleDeg + 'deg)';\r\n        if (angleDeg % 90 === 0) {\r\n            angleIm.style.boxShadow = 'inset 0 0 0 1px rgba(255,255,255, 1), 0 0 0 1px rgba(0, 0, 0, 0.3)';\r\n        } else {\r\n            angleIm.style.boxShadow = '';\r\n        }\r\n    }\r\n    update();\r\n\r\n\r\n    let resetButton = BB.el({\r\n        tagName: 'button',\r\n        content: LANG('hand-reset'),\r\n        onClick: p.onReset\r\n    });\r\n    BB.makeUnfocusable(resetButton);\r\n\r\n    let fitButton = BB.el({\r\n        tagName: 'button',\r\n        content: LANG('hand-fit'),\r\n        css: {\r\n            marginLeft: '10px'\r\n        },\r\n        onClick: p.onFit\r\n    });\r\n    BB.makeUnfocusable(fitButton);\r\n    row2.append(resetButton, fitButton);\r\n\r\n    let leftRotateButton = BB.el({\r\n        tagName: 'button',\r\n        content: '<img height=\"20\" src=\"' + rotateImg + '\" alt=\"Rotate\" style=\"transform: scale(-1, 1)\"/>',\r\n        onClick: function() {\r\n            p.onAngleChange(-15, true);\r\n        }\r\n    });\r\n    BB.makeUnfocusable(leftRotateButton);\r\n\r\n    let resetAngleButton = BB.el({\r\n        tagName: 'button',\r\n        content: '0°',\r\n        css: {\r\n            marginLeft: '10px'\r\n        },\r\n        onClick: function() {\r\n            p.onAngleChange(0);\r\n        }\r\n    });\r\n    BB.makeUnfocusable(resetAngleButton);\r\n\r\n    let rightRotateButton = BB.el({\r\n        tagName: 'button',\r\n        content: '<img height=\"20\" src=\"' + rotateImg + '\" alt=\"Rotate\"/>',\r\n        css: {\r\n            marginLeft: '10px'\r\n        },\r\n        onClick: function() {\r\n            p.onAngleChange(15, true);\r\n        }\r\n    });\r\n    BB.makeUnfocusable(rightRotateButton);\r\n    row3.append(leftRotateButton, resetAngleButton, rightRotateButton);\r\n\r\n\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n    this.setIsVisible = function(pIsVisible) {\r\n        isVisible = !!pIsVisible;\r\n        div.style.display = isVisible ? 'block' : 'none';\r\n        if (isVisible) {\r\n            update();\r\n        }\r\n    };\r\n    this.update = function(pScale, pAngleDeg) {\r\n        scale = pScale;\r\n        angleDeg = pAngleDeg;\r\n        if (isVisible) {\r\n            update();\r\n        }\r\n    };\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"6toXQ\");","import {BB} from '../../../bb/bb';\r\nimport {KlSlider} from '../base-components/kl-slider';\r\nimport {Select} from '../base-components/select';\r\nimport {Checkbox} from '../base-components/checkbox';\r\nimport {LANG} from '../../../language/language';\r\n\r\n/**\r\n * Paint Bucket tab contents (color slider, opacity slider, etc)\r\n *\r\n * p = {\r\n *     colorSlider: KlColorSlider// when opening tab, inserts it (snatches it from where else it was)\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function FillUi(p) {\r\n    let div = BB.el({\r\n        css: {\r\n            margin: '10px'\r\n        }\r\n    });\r\n    let isVisible = true;\r\n\r\n    let colorDiv = BB.el({\r\n        parent: div,\r\n        css: {\r\n            marginBottom: '10px'\r\n        }\r\n    });\r\n\r\n    let opacitySlider = new KlSlider({\r\n        label: LANG('opacity'),\r\n        width: 250,\r\n        height: 30,\r\n        min: 0,\r\n        max: 1,\r\n        initValue: 1,\r\n        onChange: function (val) {\r\n        },\r\n        formatFunc: function(v) {\r\n            return Math.round(v * 100);\r\n        }\r\n    });\r\n    div.appendChild(opacitySlider.getElement());\r\n\r\n    let toleranceSlider = new KlSlider({\r\n        label: LANG('bucket-tolerance'),\r\n        width: 250,\r\n        height: 30,\r\n        min: 0,\r\n        max: 255,\r\n        initValue: 255 / 100 * 20,\r\n        onChange: function (val) {\r\n        },\r\n        formatFunc: function(v) {\r\n            return Math.round(v / 255 * 100);\r\n        }\r\n    });\r\n    BB.css(toleranceSlider.getElement(), {\r\n        marginTop: '10px'\r\n    });\r\n    div.appendChild(toleranceSlider.getElement());\r\n\r\n    let selectRow = BB.el({\r\n        parent: div,\r\n        css: {\r\n            display: 'flex',\r\n            marginTop: '10px'\r\n        }\r\n    });\r\n\r\n    let modeWrapper;\r\n    let modeSelect;\r\n    modeWrapper = BB.el({\r\n        content: LANG('bucket-sample') + '&nbsp;',\r\n        title: LANG('bucket-sample-title'),\r\n        css: {\r\n            fontSize: '15px'\r\n        }\r\n    });\r\n    modeSelect = new Select({\r\n        optionArr: [\r\n            ['all', LANG('bucket-sample-all')],\r\n            ['current', LANG('bucket-sample-active')],\r\n            ['above', LANG('bucket-sample-above')]\r\n        ],\r\n        initValue: 'all',\r\n        onChange: function(val) {}\r\n    });\r\n    let modePointerListener = new BB.PointerListener({\r\n        target: modeSelect.getElement(),\r\n        onWheel: function(e) {\r\n            modeSelect.setDeltaValue(e.deltaY);\r\n        }\r\n    });\r\n    modeWrapper.appendChild(modeSelect.getElement());\r\n    selectRow.appendChild(modeWrapper);\r\n\r\n    let growWrapper;\r\n    let growSelect;\r\n    growWrapper = BB.el({\r\n        content: LANG('bucket-grow') + '&nbsp;',\r\n        title: LANG('bucket-grow-title'),\r\n        css: {\r\n            fontSize: '15px',\r\n            marginLeft: '10px'\r\n        }\r\n    });\r\n    growSelect = new Select({\r\n        optionArr: [\r\n            ['0', '0'],\r\n            ['1', '1'],\r\n            ['2', '2'],\r\n            ['3', '3'],\r\n            ['4', '4'],\r\n            ['5', '5'],\r\n            ['6', '6'],\r\n            ['7', '7'],\r\n        ],\r\n        initValue: '0',\r\n        onChange: function(val) {}\r\n    });\r\n    let growPointerListener = new BB.PointerListener({\r\n        target: growSelect.getElement(),\r\n        onWheel: function(e) {\r\n            growSelect.setDeltaValue(e.deltaY);\r\n        }\r\n    });\r\n    growWrapper.appendChild(growSelect.getElement());\r\n    selectRow.appendChild(growWrapper);\r\n\r\n\r\n    let isContiguous = true;\r\n    let contiguousToggle = new Checkbox({\r\n        init: true,\r\n        label: LANG('bucket-contiguous'),\r\n        title: LANG('bucket-contiguous-title'),\r\n        callback: function (b) {\r\n            isContiguous = b;\r\n        },\r\n        css: {\r\n            marginTop: '10px',\r\n            paddingRight: '5px',\r\n            display: 'inline-block',\r\n        }\r\n    });\r\n    div.appendChild(contiguousToggle.getElement());\r\n\r\n\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.setIsVisible = function(pIsVisible) {\r\n        isVisible = !!pIsVisible;\r\n        div.style.display = isVisible ? 'block' : 'none';\r\n        if (isVisible) {\r\n            colorDiv.appendChild(p.colorSlider.getElement());\r\n            colorDiv.appendChild(p.colorSlider.getOutputElement());\r\n        }\r\n    };\r\n\r\n    this.getTolerance = function() {\r\n        return toleranceSlider.getValue();\r\n    };\r\n\r\n    this.getOpacity = function() {\r\n        return opacitySlider.getValue();\r\n    };\r\n\r\n    /**\r\n     * returns string 'current' | 'all' | 'above'\r\n     */\r\n    this.getSample = function() {\r\n        return modeSelect.getValue();\r\n    };\r\n\r\n    this.getGrow = function() {\r\n        return parseInt(growSelect.getValue(), 10);\r\n    }\r\n\r\n    this.getContiguous = function() {\r\n        return isContiguous;\r\n    };\r\n\r\n}","import {BB} from '../../../bb/bb';\r\nimport {LANG} from '../../../language/language';\r\n\r\n/**\r\n * Text Tool tab contents (color slider)\r\n *\r\n * p = {\r\n *     colorSlider: KlColorSlider// when opening tab, inserts it (snatches it from where else it was)\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function TextUi(p) {\r\n    let div = BB.el({\r\n        css: {\r\n            margin: '10px'\r\n        }\r\n    });\r\n    let isVisible = true;\r\n\r\n    let colorDiv = BB.el({\r\n        parent: div,\r\n        css: {\r\n            marginBottom: '10px'\r\n        }\r\n    });\r\n\r\n    let hint = BB.el({\r\n        parent: div,\r\n        content: LANG('text-instruction'),\r\n    });\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.setIsVisible = function(pIsVisible) {\r\n        isVisible = !!pIsVisible;\r\n        div.style.display = isVisible ? 'block' : 'none';\r\n        if (isVisible) {\r\n            colorDiv.appendChild(p.colorSlider.getElement());\r\n            colorDiv.appendChild(p.colorSlider.getOutputElement());\r\n            //update();\r\n        }\r\n    };\r\n\r\n}","import {BB} from '../../../bb/bb';\r\nimport {Options} from '../base-components/options';\r\nimport {Checkbox} from '../base-components/checkbox';\r\nimport {KlSlider} from '../base-components/kl-slider';\r\nimport {LANG} from '../../../language/language';\r\n\r\n/**\r\n * Shape Tool tab contents\r\n *\r\n * p = {\r\n *     colorSlider: KlColorSlider// when opening tab, inserts it (snatches it from where else it was)\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function ShapeUi(p) {\r\n    let div = BB.el({\r\n        css: {\r\n            margin: '10px'\r\n        }\r\n    });\r\n    let isVisible = true;\r\n\r\n    let colorDiv = BB.el({\r\n        parent: div,\r\n        css: {\r\n            marginBottom: '10px'\r\n        }\r\n    });\r\n\r\n    let previewSize = 35;\r\n    let previewPadding = 8;\r\n    let shape; // 'rect'|'ellipse'|'line'\r\n    let mode; // 'stroke'|'fill'\r\n\r\n\r\n    let rectStrokeSvgRect = BB.createSvg({\r\n        elementType: 'rect',\r\n        x: '' + previewPadding,\r\n        width: '' + (previewSize - previewPadding * 2)\r\n    });\r\n    let rectStrokeSvg = BB.createSvg({\r\n        elementType: 'svg',\r\n        width: '' + previewSize,\r\n        height: '' + previewSize\r\n    });\r\n    rectStrokeSvg.appendChild(rectStrokeSvgRect);\r\n    BB.css(rectStrokeSvg, {\r\n        display: 'block'\r\n    });\r\n\r\n    let rectFilledSvgRect = BB.createSvg({\r\n        elementType: 'rect',\r\n        x: '' + previewPadding,\r\n        width: '' + (previewSize - previewPadding * 2)\r\n    });\r\n    let rectFilledSvg = BB.createSvg({\r\n        elementType: 'svg',\r\n        width: '' + previewSize,\r\n        height: '' + previewSize\r\n    });\r\n    rectFilledSvg.appendChild(rectFilledSvgRect);\r\n    BB.css(rectFilledSvg, {\r\n        display: 'block'\r\n    });\r\n\r\n\r\n    let ellipseStrokeSvgEllipse = BB.createSvg({\r\n        elementType: 'ellipse',\r\n        cx: '' + (previewSize / 2),\r\n        cy: '' + (previewSize / 2),\r\n        rx: '' + (previewSize / 2 - previewPadding)\r\n    });\r\n    let ellipseStrokeSvg = BB.createSvg({\r\n        elementType: 'svg',\r\n        width: '' + previewSize,\r\n        height: '' + previewSize,\r\n    });\r\n    ellipseStrokeSvg.appendChild(ellipseStrokeSvgEllipse);\r\n    BB.css(ellipseStrokeSvg, {\r\n        display: 'block'\r\n    });\r\n\r\n    let ellipseFilledSvgEllipse = BB.createSvg({\r\n        elementType: 'ellipse',\r\n        cx: '' + (previewSize / 2),\r\n        cy: '' + (previewSize / 2),\r\n        rx: '' + (previewSize / 2 - previewPadding)\r\n    });\r\n    let ellipseFilledSvg = BB.createSvg({\r\n        elementType: 'svg',\r\n        width: '' + previewSize,\r\n        height: '' + previewSize,\r\n    });\r\n    ellipseFilledSvg.appendChild(ellipseFilledSvgEllipse);\r\n    BB.css(ellipseFilledSvg, {\r\n        display: 'block'\r\n    });\r\n\r\n\r\n    let lineSvgLine = BB.createSvg({\r\n        elementType: 'line',\r\n        x1: '' + previewPadding,\r\n        x2: '' + (previewSize - previewPadding)\r\n    });\r\n    let lineSvg = BB.createSvg({\r\n        elementType: 'svg',\r\n        width: '' + previewSize,\r\n        height: '' + previewSize\r\n    });\r\n    lineSvg.appendChild(lineSvgLine);\r\n    BB.css(lineSvg, {\r\n        display: 'block'\r\n    });\r\n\r\n    function updatePreviews() {\r\n        let strokeWidth = BB.clamp(Math.round(lineWidthSlider.getValue() / 10), 1, 10) + 'px';\r\n\r\n        let squish = 1.35;\r\n\r\n        BB.css(rectStrokeSvgRect, { fill: 'none', stroke: 'black', strokeWidth: strokeWidth });\r\n        BB.css(rectFilledSvgRect, { fill: 'black', stroke: 'none' });\r\n\r\n        BB.css(ellipseStrokeSvgEllipse, { fill: 'none', stroke: 'black', strokeWidth: strokeWidth });\r\n        BB.css(ellipseFilledSvgEllipse, { fill: 'black', stroke: 'none' });\r\n\r\n        BB.css(\r\n            lineSvgLine,\r\n            { fill: 'none', stroke: 'black', strokeWidth: strokeWidth }\r\n        );\r\n\r\n        if ((fixedToggle as any).getValue()) {\r\n            rectStrokeSvgRect.setAttribute('y', '' + previewPadding);\r\n            rectStrokeSvgRect.setAttribute('height', '' + (previewSize - previewPadding * 2));\r\n            rectFilledSvgRect.setAttribute('y', '' + previewPadding);\r\n            rectFilledSvgRect.setAttribute('height', '' + (previewSize - previewPadding * 2));\r\n\r\n            ellipseStrokeSvgEllipse.setAttribute('ry', '' + (previewSize / 2 - previewPadding));\r\n            ellipseFilledSvgEllipse.setAttribute('ry', '' + (previewSize / 2 - previewPadding));\r\n        } else {\r\n            rectStrokeSvgRect.setAttribute('y', '' + (previewPadding * squish));\r\n            rectStrokeSvgRect.setAttribute('height', '' + (previewSize - previewPadding * squish * 2));\r\n            rectFilledSvgRect.setAttribute('y', '' + (previewPadding * squish));\r\n            rectFilledSvgRect.setAttribute('height', '' + (previewSize - previewPadding * squish * 2));\r\n\r\n            ellipseStrokeSvgEllipse.setAttribute('ry', '' + (previewSize / 2 - previewPadding * squish));\r\n            ellipseFilledSvgEllipse.setAttribute('ry', '' + (previewSize / 2 - previewPadding * squish));\r\n        }\r\n\r\n        if ((snapToggle as any).getValue()) {\r\n            lineSvgLine.setAttribute('y1', '' + (previewSize - previewPadding));\r\n            lineSvgLine.setAttribute('y2', '' + previewPadding);\r\n        } else {\r\n            lineSvgLine.setAttribute('y1', '' + (previewSize - previewPadding * squish));\r\n            lineSvgLine.setAttribute('y2', '' + (previewPadding * squish));\r\n        }\r\n    }\r\n\r\n    let row1 = BB.el({\r\n        parent: div,\r\n        css: {\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'start'\r\n        }\r\n    });\r\n\r\n    let shapeOptions = new Options({\r\n        optionArr: [\r\n            {\r\n                id: 'rect-stroke',\r\n                label: rectStrokeSvg,\r\n                title: LANG('shape-rect') + ' ' + LANG('shape-stroke'),\r\n            },\r\n            {\r\n                id: 'ellipse-stroke',\r\n                label: ellipseStrokeSvg,\r\n                title: LANG('shape-ellipse') + ' ' + LANG('shape-stroke'),\r\n            },\r\n            {\r\n                id: 'line',\r\n                label: lineSvg,\r\n                title: LANG('shape-line'),\r\n            },\r\n            {\r\n                id: 'rect-fill',\r\n                label: rectFilledSvg,\r\n                title: LANG('shape-rect') + ' ' + LANG('shape-fill'),\r\n            },\r\n            {\r\n                id: 'ellipse-fill',\r\n                label: ellipseFilledSvg,\r\n                title: LANG('shape-ellipse') + ' ' + LANG('shape-fill'),\r\n            },\r\n        ],\r\n        initId: 'rect',\r\n        onChange: function(id) {\r\n            let split = id.split('-');\r\n            shape = split[0];\r\n            mode = split[1];\r\n\r\n            BB.css(fixedToggle.getElement(), {\r\n                display: shape === 'line' ? 'none' : null\r\n            });\r\n            BB.css(snapToggle.getElement(), {\r\n                display: shape === 'line' ? null : 'none'\r\n            });\r\n            BB.css(lineWidthSlider.getElement(), {\r\n                display: (shape !== 'line' && mode === 'fill') ? 'none' : null\r\n            });\r\n        },\r\n        changeOnInit: true\r\n    });\r\n    shapeOptions.getElement().style.width = '120px';\r\n    row1.appendChild(shapeOptions.getElement());\r\n\r\n    let eraserToggle = new Checkbox({\r\n        init: false,\r\n        label: LANG('eraser'),\r\n        callback: function(b) {\r\n            updatePreviews();\r\n        }\r\n    });\r\n    row1.appendChild(eraserToggle.getElement());\r\n\r\n    let lineWidthSlider = new KlSlider({\r\n        label: LANG('shape-line-width'),\r\n        width: 250,\r\n        height: 30,\r\n        min: 1,\r\n        max: 200,\r\n        initValue: 4,\r\n        curve: 'quadratic',\r\n        onChange: function (val) {\r\n            updatePreviews();\r\n        },\r\n        formatFunc: function (v) {\r\n            return Math.round(v);\r\n        }\r\n    });\r\n    BB.css(lineWidthSlider.getElement(), {\r\n        marginTop: '10px'\r\n    });\r\n    div.appendChild(lineWidthSlider.getElement());\r\n\r\n    let opacitySlider = new KlSlider({\r\n        label: LANG('opacity'),\r\n        width: 250,\r\n        height: 30,\r\n        min: 0,\r\n        max: 1,\r\n        initValue: 1,\r\n        onChange: function (val) {\r\n        },\r\n        formatFunc: function (v) {\r\n            return Math.round(v * 100);\r\n        }\r\n    });\r\n    BB.css(opacitySlider.getElement(), {\r\n        marginTop: '10px'\r\n    });\r\n    div.appendChild(opacitySlider.getElement());\r\n\r\n    let row2 = BB.el({\r\n        parent: div,\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            marginTop: '10px'\r\n        }\r\n    });\r\n\r\n    let outwardsToggle = new Checkbox({\r\n        init: false,\r\n        label: LANG('shape-outwards'),\r\n        callback: function(b) {},\r\n        css: {\r\n            width: '50%',\r\n            marginRight: '10px',\r\n        }\r\n    });\r\n    row2.appendChild(outwardsToggle.getElement());\r\n\r\n    let fixedToggle = new Checkbox({\r\n        init: false,\r\n        label: LANG('shape-fixed'),\r\n        callback: function(b) {\r\n            updatePreviews();\r\n        },\r\n        css: {\r\n            flexGrow: '1',\r\n        }\r\n    });\r\n    row2.appendChild(fixedToggle.getElement());\r\n\r\n    let snapToggle = new Checkbox({\r\n        init: false,\r\n        label: LANG('shape-snap'),\r\n        title: LANG('shape-snap-title'),\r\n        callback: function(b) {\r\n            updatePreviews();\r\n        },\r\n        css: {\r\n            flexGrow: '1',\r\n        }\r\n    });\r\n    row2.appendChild(snapToggle.getElement());\r\n\r\n\r\n\r\n    updatePreviews();\r\n\r\n    // --- interface ---\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.setIsVisible = function(pIsVisible) {\r\n        isVisible = !!pIsVisible;\r\n        div.style.display = isVisible ? 'block' : 'none';\r\n        if (isVisible) {\r\n            colorDiv.appendChild(p.colorSlider.getElement());\r\n            colorDiv.appendChild(p.colorSlider.getOutputElement());\r\n            //update();\r\n        }\r\n    };\r\n\r\n    this.getShape = function() {\r\n        return shape;\r\n    };\r\n\r\n    this.getMode = function() {\r\n        return mode;\r\n    };\r\n\r\n    this.getIsEraser = function() {\r\n        return (eraserToggle as any).getValue();\r\n    };\r\n\r\n    this.getOpacity = function() {\r\n        return opacitySlider.getValue();\r\n    };\r\n\r\n    this.getLineWidth = function() {\r\n        return lineWidthSlider.getValue();\r\n    };\r\n\r\n    this.getIsOutwards = function() {\r\n        return (outwardsToggle as any).getValue();\r\n    };\r\n\r\n    this.getIsFixed = function() {\r\n        return (fixedToggle as any).getValue();\r\n    };\r\n\r\n    this.getIsSnap = function() {\r\n        return (snapToggle as any).getValue();\r\n    };\r\n\r\n}","import {BB} from '../../../bb/bb';\r\nimport {Select} from '../base-components/select';\r\nimport {ColorOptions} from '../base-components/color-options';\r\nimport {popup} from './popup';\r\nimport {LANG} from '../../../language/language';\r\n\r\n/**\r\n * P = {\r\n *     currentColor: RGB, // current color\r\n *     secondaryColor: RGB,\r\n *     maxCanvasSize: number,\r\n *     canvasWidth: number, // current canvas size\r\n *     canvasHeight: number, // current canvas size\r\n *     workspaceWidth: number,\r\n *     workspaceHeight: number,\r\n *     onConfirm: function(width number, height number, color RGBA),\r\n *     onCancel: function()\r\n * }\r\n *\r\n * @param p\r\n */\r\nexport function newImageDialog(p) {\r\n\r\n    let currentColor = p.currentColor;\r\n    let secondaryColor = p.secondaryColor;\r\n    let maxCanvasSize = p.maxCanvasSize;\r\n    let canvasWidth = p.canvasWidth;\r\n    let canvasHeight = p.canvasHeight;\r\n    let workspaceWidth = p.workspaceWidth;\r\n    let workspaceHeight = p.workspaceHeight;\r\n    let onConfirm = p.onConfirm;\r\n    let onCancel = p.onCancel;\r\n\r\n\r\n    function createRatioSize(ratioX, ratioY, width, height, padding) {\r\n        return BB.fitInto(ratioX, ratioY, Math.min(maxCanvasSize, width - padding), Math.min(maxCanvasSize, height - padding), 1);\r\n    }\r\n\r\n    let newImDiv = document.createElement(\"div\");\r\n    let widthWrapper = document.createElement(\"div\");\r\n    let heightWrapper = document.createElement(\"div\");\r\n    let widthInput = document.createElement(\"input\");\r\n    let widthUnit = document.createElement(\"div\");\r\n    let heightInput = document.createElement(\"input\");\r\n    let heightUnit = document.createElement(\"div\");\r\n    widthWrapper.style.position = \"relative\";\r\n    widthWrapper.style.width = \"145px\";\r\n    widthWrapper.style.height = \"35px\";\r\n    widthWrapper.style.lineHeight = \"30px\";\r\n    heightWrapper.style.width = \"145px\";\r\n    heightWrapper.style.height = \"35px\";\r\n    heightWrapper.style.lineHeight = \"30px\";\r\n\r\n    widthUnit.innerText = LANG('new-px');\r\n    widthUnit.style.color = '#888';\r\n    widthUnit.style.fontSize = \"12px\";\r\n    widthUnit.style.marginLeft = \"5px\";\r\n    widthUnit.style.cssFloat = \"right\";\r\n\r\n    heightUnit.innerText = LANG('new-px');\r\n    heightUnit.style.color = '#888';\r\n    heightUnit.style.fontSize = \"12px\";\r\n    heightUnit.style.marginLeft = \"5px\";\r\n    heightUnit.style.cssFloat = \"right\";\r\n\r\n    widthInput.setAttribute('data-ignore-focus', 'true');\r\n    heightInput.setAttribute('data-ignore-focus', 'true');\r\n\r\n    widthInput.type = 'number';\r\n    widthInput.min = '1';\r\n    widthInput.max = maxCanvasSize;\r\n    widthInput.style.cssFloat = \"right\";\r\n    widthInput.style.width = \"70px\";\r\n\r\n    heightInput.type = 'number';\r\n    heightInput.min = '1';\r\n    heightInput.max = maxCanvasSize;\r\n    heightInput.style.cssFloat = \"right\";\r\n    heightInput.style.width = \"70px\";\r\n    widthInput.value = canvasWidth;\r\n    heightInput.value = canvasHeight;\r\n    widthInput.onclick = function () {\r\n        (this as any).focus();\r\n        updateRatio();\r\n    };\r\n    heightInput.onclick = function () {\r\n        (this as any).focus();\r\n        updateRatio();\r\n    };\r\n    widthWrapper.appendChild(widthUnit);\r\n    widthWrapper.appendChild(widthInput);\r\n    BB.appendTextDiv(widthWrapper, LANG('width') + \": \");\r\n    heightWrapper.appendChild(heightUnit);\r\n    heightWrapper.appendChild(heightInput);\r\n    BB.appendTextDiv(heightWrapper, LANG('height') + \": \");\r\n    let ratioWrapper = document.createElement(\"div\");\r\n    ratioWrapper.style.marginTop = '5px';\r\n    ratioWrapper.style.color = '#888';\r\n\r\n    let templateWrapper = document.createElement(\"div\");\r\n    //BB.appendTextDiv(templateWrapper, \"Preset Resolutions: <br />\");\r\n    let presetFitBtn = document.createElement(\"button\");\r\n    templateWrapper.style.marginBottom = \"10px\";\r\n    let presetCurrentBtn = document.createElement(\"button\");\r\n    let presetSquareBtn = document.createElement(\"button\");\r\n    let presetLandscapeBtn = document.createElement(\"button\");\r\n    let presetPortraitBtn = document.createElement(\"button\");\r\n    let presetOversizeBtn = document.createElement(\"button\");\r\n\r\n    presetCurrentBtn.textContent = LANG('new-current');\r\n    presetFitBtn.textContent = LANG('new-fit');\r\n    presetOversizeBtn.textContent = LANG('new-oversize');\r\n    presetLandscapeBtn.textContent = LANG('new-landscape');\r\n    presetPortraitBtn.textContent = LANG('new-portrait');\r\n    presetSquareBtn.textContent = LANG('new-square');\r\n\r\n    presetCurrentBtn.style.marginRight = \"5px\";\r\n    presetFitBtn.style.marginRight = \"5px\";\r\n    presetOversizeBtn.style.marginRight = \"5px\";\r\n    presetLandscapeBtn.style.marginTop = \"5px\";\r\n    presetLandscapeBtn.style.marginRight = \"5px\";\r\n    presetPortraitBtn.style.marginTop = \"5px\";\r\n    presetPortraitBtn.style.marginRight = \"5px\";\r\n\r\n    templateWrapper.appendChild(presetCurrentBtn);\r\n    templateWrapper.appendChild(presetFitBtn);\r\n    templateWrapper.appendChild(presetOversizeBtn);\r\n    templateWrapper.appendChild(presetSquareBtn);\r\n    templateWrapper.appendChild(presetLandscapeBtn);\r\n    templateWrapper.appendChild(presetPortraitBtn);\r\n\r\n    let templatePadding = 50;\r\n\r\n    presetCurrentBtn.onclick = function () {\r\n        widthInput.value = canvasWidth;\r\n        heightInput.value = canvasHeight;\r\n        updateRatio();\r\n    };\r\n    presetFitBtn.onclick = function () {\r\n        widthInput.value = workspaceWidth;\r\n        heightInput.value = workspaceHeight;\r\n        updateRatio();\r\n    };\r\n    presetOversizeBtn.onclick = function () {\r\n        widthInput.value = workspaceWidth + 500;\r\n        heightInput.value = workspaceHeight + 500;\r\n        updateRatio();\r\n    };\r\n    presetSquareBtn.onclick = function () {\r\n        let sizeObj = createRatioSize(1, 1, workspaceWidth, workspaceHeight, templatePadding);\r\n        widthInput.value = '' + Math.round(sizeObj.width);\r\n        heightInput.value = '' + Math.round(sizeObj.height);\r\n        updateRatio();\r\n    };\r\n    presetLandscapeBtn.onclick = function () {\r\n        let sizeObj = createRatioSize(4, 3, workspaceWidth, workspaceHeight, templatePadding);\r\n        widthInput.value = '' + Math.round(sizeObj.width);\r\n        heightInput.value = '' + Math.round(sizeObj.height);\r\n        updateRatio();\r\n    };\r\n    presetPortraitBtn.onclick = function () {\r\n        let sizeObj = createRatioSize(3, 4, workspaceWidth, workspaceHeight, templatePadding);\r\n        widthInput.value = '' + Math.round(sizeObj.width);\r\n        heightInput.value = '' + Math.round(sizeObj.height);\r\n        updateRatio();\r\n    };\r\n\r\n    let select = new Select({\r\n        isFocusable: true,\r\n        optionArr: [\r\n            ['screen', LANG('new-screen')],\r\n            ['16 9', LANG('new-video') + ' 16:9'],\r\n            ['3 2', '3:2'],\r\n            ['5 3', '5:3'],\r\n            ['2 1', '2:1'],\r\n            ['paper', LANG('new-din-paper') + ' √2:1'],\r\n            ['9 16', '9:16'],\r\n            ['2 3', '2:3'],\r\n            ['3 5', '3:5'],\r\n            ['1 2', '1:2'],\r\n            ['1 1.4142135623730951', '1:√2']\r\n        ],\r\n        onChange: function(val) {\r\n            if (val === 'screen') {\r\n                widthInput.value = '' + window.screen.width;\r\n                heightInput.value = '' + window.screen.height;\r\n            } else if (val === 'paper') {\r\n                let sizeObj = createRatioSize(Math.sqrt(2), 1, workspaceWidth, workspaceHeight, templatePadding);\r\n                widthInput.value = '' + Math.round(sizeObj.width);\r\n                heightInput.value = '' + Math.round(sizeObj.height);\r\n            } else {\r\n                let split = val.split(' ');\r\n                let sizeObj = createRatioSize(parseFloat(split[0]), parseFloat(split[1]), workspaceWidth, workspaceHeight, templatePadding);\r\n                widthInput.value = '' + Math.round(sizeObj.width);\r\n                heightInput.value = '' + Math.round(sizeObj.height);\r\n            }\r\n            updateRatio();\r\n            select.setValue(null);\r\n        }\r\n    });\r\n    setTimeout(() => {\r\n        // safari: not empty without also setting it to null via timeout\r\n        select.setValue(null);\r\n    }, 0);\r\n    BB.css(select.getElement(), {\r\n        width: '80px',\r\n    });\r\n    templateWrapper.appendChild(select.getElement());\r\n\r\n\r\n\r\n    let backgroundRGBA = {r: 255, g: 255, b: 255, a: 1};\r\n\r\n    let colorOptionsArr = [\r\n        {r: 255, g: 255, b: 255, a: 1},\r\n        {r: 0, g: 0, b: 0, a: 1},\r\n        {r: 0, g: 0, b: 0, a: 0}\r\n    ];\r\n    colorOptionsArr.push({\r\n        r: currentColor.r,\r\n        g: currentColor.g,\r\n        b: currentColor.b,\r\n        a: 1\r\n    });\r\n    colorOptionsArr.push({\r\n        r: secondaryColor.r,\r\n        g: secondaryColor.g,\r\n        b: secondaryColor.b,\r\n        a: 1\r\n    });\r\n\r\n    let colorOptions = new ColorOptions({\r\n        colorArr: colorOptionsArr,\r\n        onChange: function(rgbaObj) {\r\n            backgroundRGBA = rgbaObj;\r\n            preview.style.backgroundColor = \"rgba(\" + rgbaObj.r + \",\" + rgbaObj.g + \",\" + rgbaObj.b + \", \" + rgbaObj.a + \")\";\r\n        }\r\n    });\r\n\r\n    let previewWrapper = document.createElement(\"div\");\r\n    BB.css(previewWrapper, {\r\n        boxSizing: 'border-box',\r\n        width: '340px',\r\n        height: '140px',\r\n        display: 'table',\r\n        backgroundColor: '#9e9e9e',\r\n        padding: '10px',\r\n        marginTop: '10px',\r\n        boxShadow: 'rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset',\r\n        marginLeft: '-20px',\r\n        colorScheme: 'only light',\r\n    });\r\n    let preview = document.createElement(\"div\");\r\n    BB.css(preview, {\r\n        width: 200 + \"px\",\r\n        height: 100 + \"px\",\r\n        backgroundColor: \"#fff\",\r\n        marginLeft: \"auto\",\r\n        marginRight: \"auto\",\r\n        color: \"#aaa\",\r\n        fontSize: \"16px\",\r\n        fontWeight: \"bold\",\r\n        textAlign: \"center\",\r\n        verticalAlign: \"center\",\r\n        display: \"table\",\r\n        overflow: \"hidden\",\r\n        boxShadow: \"0px 0px 3px rgba(0,0,0,0.5)\"\r\n    });\r\n    let previewcell = document.createElement(\"div\");\r\n    previewcell.style.display = \"table-cell\";\r\n    previewcell.style.verticalAlign = \"middle\";\r\n    previewcell.appendChild(preview);\r\n    previewWrapper.appendChild(previewcell);\r\n    let cell = BB.appendTextDiv(preview, \"\");\r\n    //let ratio = BB.appendTextDiv(cell, \"1:2\");\r\n    cell.style.display = \"table-cell\";\r\n    cell.style.verticalAlign = \"middle\";\r\n    let prevW = parseInt(widthInput.value);\r\n    let prevH = parseInt(heightInput.value);\r\n\r\n    function updateRatio() {\r\n        widthInput.value = '' + Math.min(maxCanvasSize, parseInt(widthInput.value));\r\n        heightInput.value = '' + Math.min(maxCanvasSize, parseInt(heightInput.value));\r\n\r\n        function HCF(u, v) {\r\n            let U = u, V = v;\r\n            while (true) {\r\n                if (!(U %= V))\r\n                    return V;\r\n                if (!(V %= U))\r\n                    return U;\r\n            }\r\n        }\r\n\r\n        let w = parseInt(widthInput.value);\r\n        let h = parseInt(heightInput.value);\r\n        if (w < 1 || w > maxCanvasSize || h < 1 || h > maxCanvasSize) {\r\n            if (w > maxCanvasSize)\r\n                w = maxCanvasSize;\r\n            else if (h > maxCanvasSize)\r\n                h = maxCanvasSize;\r\n\r\n            widthInput.value = '' + w;\r\n            heightInput.value = '' + h;\r\n        }\r\n\r\n        //generated canvas size doesn't always match ratio. so check if a common ratio is very close\r\n        let commonRatios = [\r\n            [1, 2], [2, 1],\r\n            [2, 3], [3, 2],\r\n            [3, 4], [4, 3],\r\n            [4, 5], [5, 4],\r\n            [16, 9], [9, 16],\r\n            [3, 2], [2, 3],\r\n            [5, 3], [3, 5],\r\n            [2, 1], [1, 2],\r\n            [1.414, 1], [1, 1.414],\r\n        ];\r\n        let reducedArr = BB.reduce(w, h);\r\n        let closestRatio = null;\r\n        let closestDistance = null;\r\n        for (let i = 0; i < commonRatios.length; i++) {\r\n            if (i === 0 || Math.abs(commonRatios[i][0] / commonRatios[i][1] - reducedArr[0] / reducedArr[1]) < closestDistance) {\r\n                closestRatio = commonRatios[i];\r\n                closestDistance = Math.abs(commonRatios[i][0] / commonRatios[i][1] - reducedArr[0] / reducedArr[1]);\r\n            }\r\n        }\r\n        //display ratio\r\n        if (closestDistance > 0 && closestDistance < 0.005) {\r\n            ratioWrapper.innerText = LANG('new-ratio') + ': ~' + closestRatio[0] + ':' + closestRatio[1];\r\n        } else {\r\n            ratioWrapper.innerText = LANG('new-ratio') + ': ' + reducedArr[0] + ':' + reducedArr[1];\r\n        }\r\n\r\n        prevW = w;\r\n        prevH = h;\r\n        let realw = w;\r\n        let T = HCF(w, h);\r\n        w /= T;\r\n        h /= T;\r\n        w *= 260;\r\n        h *= 260;\r\n        if (w > 260) {\r\n            h = 260 / w * h;\r\n            w = 260;\r\n        }\r\n        if (h > 100) {\r\n            w = 100 / h * w;\r\n            h = 100;\r\n\r\n        }\r\n\r\n        preview.style.width = w + \"px\";\r\n        preview.style.height = h + \"px\";\r\n        BB.createCheckerDataUrl(parseInt('' + (30 * (w / realw))), function (url) {\r\n            previewWrapper.style.background = \"url(\" + url + \")\";\r\n        });\r\n    }\r\n\r\n    widthInput.onchange = function () {\r\n        if (widthInput.value === '' || parseInt(widthInput.value) < 0) {\r\n            widthInput.value = '1';\r\n        }\r\n        updateRatio();\r\n    };\r\n    widthInput.onkeyup = function () {\r\n        updateRatio();\r\n    };\r\n    heightInput.onchange = function () {\r\n        if (heightInput.value === '' || parseFloat(heightInput.value) < 0) {\r\n            heightInput.value = '1';\r\n        }\r\n        updateRatio();\r\n    };\r\n    heightInput.onkeyup = function () {\r\n        updateRatio();\r\n    };\r\n    updateRatio();\r\n\r\n    newImDiv.appendChild(templateWrapper);\r\n    let secondRow = BB.el({\r\n        parent: newImDiv,\r\n        css: {\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'flex-end'\r\n        }\r\n    });\r\n    let secondRowLeft = BB.el({\r\n        parent: secondRow\r\n    });\r\n    secondRowLeft.appendChild(widthWrapper);\r\n    secondRowLeft.appendChild(heightWrapper);\r\n    secondRowLeft.appendChild(ratioWrapper);\r\n    secondRow.appendChild(colorOptions.getElement());\r\n\r\n    newImDiv.appendChild(previewWrapper);\r\n\r\n    popup({\r\n        target: document.body,\r\n        message: `<b>${LANG('new-title')}</b>`,\r\n        div: newImDiv,\r\n        buttons: ['Ok', 'Cancel'],\r\n        callback: function (result) {\r\n            widthInput.onclick = null;\r\n            heightInput.onclick = null;\r\n            presetCurrentBtn.onclick = null;\r\n            presetFitBtn.onclick = null;\r\n            presetOversizeBtn.onclick = null;\r\n            presetSquareBtn.onclick = null;\r\n            presetLandscapeBtn.onclick = null;\r\n            presetPortraitBtn.onclick = null;\r\n            widthInput.onchange = null;\r\n            widthInput.onkeyup = null;\r\n            heightInput.onchange = null;\r\n            heightInput.onkeyup = null;\r\n            select.destroy();\r\n            colorOptions.destroy();\r\n\r\n            if (result === \"Cancel\" || parseInt(widthInput.value) <= 0 || parseInt(heightInput.value) <= 0 || isNaN(parseInt(widthInput.value)) || isNaN(parseInt(heightInput.value))) {\r\n                onCancel();\r\n                return;\r\n            }\r\n            onConfirm(parseInt(widthInput.value), parseInt(heightInput.value), backgroundRGBA);\r\n        },\r\n        clickOnEnter: 'Ok'\r\n    });\r\n\r\n}","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport collapseImg from 'url:~/src/app/img/ui/ui-collapse.svg';\r\nimport {LANG} from \"../../../language/language\";\r\n\r\n/**\r\n * button that allows to collapse toolspace (for mobile)\r\n *\r\n * p = {\r\n *     onChange: function()\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function ToolspaceCollapser(p) {\r\n    let isOpen = true;\r\n    let directionStr = 'right'; // 'left' | 'right'\r\n\r\n    function update() {\r\n        if (directionStr === 'left') {\r\n            icon.style.transform = isOpen ? 'rotate(180deg)' : '';\r\n        } else {\r\n            icon.style.transform = isOpen ? '' : 'rotate(180deg)';\r\n        }\r\n    }\r\n\r\n    let div = BB.el({\r\n        css: {\r\n            width: '36px',\r\n            height: '36px',\r\n            background: 'rgba(100, 100, 100, 0.9)',\r\n            color: '#fff',\r\n            position: 'absolute',\r\n            top: '0',\r\n            textAlign: 'center',\r\n            lineHeight: '36px',\r\n            cursor: 'pointer',\r\n            userSelect: 'none',\r\n            padding: '6px',\r\n            boxSizing: 'border-box'\r\n        },\r\n        title: LANG('toggle-show-tools'),\r\n        onClick: function(e) {\r\n            e.preventDefault();\r\n            isOpen = !isOpen;\r\n            update();\r\n            p.onChange();\r\n        }\r\n    });\r\n\r\n    let icon = BB.el({\r\n        parent: div,\r\n        css: {\r\n            backgroundImage: `url(${collapseImg})`,\r\n            width: '100%',\r\n            height: '100%',\r\n            backgroundSize: 'contain',\r\n            backgroundRepeat: 'no-repeat',\r\n            backgroundPosition: 'center',\r\n            userSelect: 'none'\r\n        }\r\n    });\r\n    div.oncontextmenu = function () {\r\n        return false;\r\n    };\r\n\r\n    // --- interface ---\r\n    this.isOpen = function() {\r\n        return isOpen;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param dirStr\r\n     */\r\n    this.setDirection = function(dirStr) {\r\n        directionStr = dirStr;\r\n        update();\r\n    };\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"b1UMP\");","import {BB} from '../../../bb/bb';\r\nimport {renderText} from '../../image-operations/render-text';\r\nimport {ColorOptions} from '../base-components/color-options';\r\nimport {Select} from '../base-components/select';\r\nimport {ImageRadioList} from '../base-components/image-radio-list';\r\nimport {ImageToggle} from '../base-components/image-toggle';\r\nimport {KlSlider} from '../base-components/kl-slider';\r\nimport {popup} from './popup';\r\n// @ts-ignore\r\nimport alignLeftImg from 'url:~/src/app/img/ui/align-left.svg';\r\n// @ts-ignore\r\nimport alignCenterImg from 'url:~/src/app/img/ui/align-center.svg';\r\n// @ts-ignore\r\nimport alignRightImg from 'url:~/src/app/img/ui/align-right.svg';\r\n// @ts-ignore\r\nimport typoItalicImg from 'url:~/src/app/img/ui/typo-italic.svg';\r\n// @ts-ignore\r\nimport typoBoldImg from 'url:~/src/app/img/ui/typo-bold.svg';\r\n// @ts-ignore\r\nimport toolZoomInImg from 'url:~/src/app/img/ui/tool-zoom-in.svg';\r\n// @ts-ignore\r\nimport toolZoomOutImg from 'url:~/src/app/img/ui/tool-zoom-out.svg';\r\nimport {IRGB} from '../../kl.types';\r\nimport {KlCanvas} from '../../canvas/kl-canvas';\r\nimport {LANG} from '../../../language/language';\r\n\r\n/**\r\n * Text Tool dialog\r\n *\r\n * confirmP = {\r\n *     x: number,\r\n *     y: number,\r\n *     textStr: string,\r\n *     align: 'left' | 'center' | 'right',\r\n *     isItalic: boolean,\r\n *     isBold: boolean,\r\n *     color: rgb,\r\n *     size: number, // px\r\n *     font: 'serif' | 'monospace' | 'sans-serif' | 'cursive' | 'fantasy',\r\n *     opacity: number, // 0 - 1\r\n * }\r\n *\r\n * @param p\r\n */\r\nexport function textToolDialog(\r\n    p: {\r\n        klCanvas: KlCanvas;\r\n        layerIndex: number;\r\n        x: number;\r\n        y: number;\r\n        angleRad: number;\r\n        color: IRGB;\r\n        secondaryColor: IRGB;\r\n        size: number; // px\r\n        align: 'left' | 'center' | 'right'; // default 'left'\r\n        isBold: boolean; // default false\r\n        isItalic: boolean; // default false\r\n        font: 'serif' | 'monospace' | 'sans-serif' | 'cursive' | 'fantasy'; // default sans-serif\r\n        opacity: number; // 0 - 1; default 1\r\n        onConfirm: (confirmP) => void;\r\n    }\r\n) {\r\n\r\n    let div = BB.el({});\r\n\r\n    let isSmallWidth = window.innerWidth < 550;\r\n    let isSmallHeight = window.innerHeight < 630;\r\n\r\n    // --- preview ---\r\n    // Text drawn on klCanvas-sized canvas: textCanvas\r\n    // LayerArr[target].canvas & textCanvas then drawn on targetCanvas\r\n    //      they are transformed. canvas size of final preview\r\n    // All layers and targetCanvas drawn on layersCanvas. transformed and size of final preview\r\n    // Checkerboard, layersCanvas, and outline then drawn on previewCanvas\r\n\r\n    let width = isSmallWidth ? 340 : 540;\r\n    let height = isSmallWidth ? (isSmallHeight ? 210 : 260) : (isSmallHeight ? 230 : 350);\r\n    let scale = 1;\r\n\r\n    let layerArr = p.klCanvas.getLayersFast();\r\n    let textCanvas = BB.canvas(p.klCanvas.getWidth(), p.klCanvas.getHeight());\r\n    let textCtx = textCanvas.getContext('2d');\r\n    let targetCanvas = BB.canvas(width, height);\r\n    let targetCtx = targetCanvas.getContext('2d');\r\n    let layersCanvas = BB.canvas(width, height);\r\n    let layersCtx = layersCanvas.getContext('2d');\r\n    let previewCanvas = BB.canvas(width, height); // the one that is visible\r\n    let previewCtx = previewCanvas.getContext('2d');\r\n    BB.css(previewCanvas, {\r\n        display: 'block'\r\n    });\r\n    let previewWrapper = BB.el({\r\n        parent: div,\r\n        css: {\r\n            position: 'relative',\r\n            width: width + 'px',\r\n            marginLeft: '-20px',\r\n            cursor: 'move',\r\n            colorScheme: 'only light',\r\n            touchAction: 'none',\r\n        },\r\n        onClick: function() {\r\n            textInput.focus();\r\n        }\r\n    });\r\n    BB.el({ // inset shadow on preview\r\n        parent: previewWrapper,\r\n        css: {\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0',\r\n            right: '0',\r\n            bottom: '0',\r\n            boxShadow: 'rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset',\r\n            pointerEvents: 'none',\r\n        }\r\n    });\r\n    previewWrapper.appendChild(previewCanvas);\r\n    let checkerPattern = previewCtx.createPattern(BB.createCheckerCanvas(8), 'repeat');\r\n    let emptyCanvas = BB.canvas(1, 1);\r\n    {\r\n        let ctx = emptyCanvas.getContext('2d');\r\n        ctx.fillRect(0, 0, 1, 1);\r\n    }\r\n\r\n    function updatePreview() {\r\n\r\n        // try to draw very much like klCanvasWorkspace\r\n\r\n        // --- draw text ---\r\n        textCtx.clearRect(0, 0, textCanvas.width, textCanvas.height);\r\n        let colorRGBA = {\r\n            ...p.color,\r\n            a: opacitySlider.getValue(),\r\n        };\r\n        let bounds = renderText(textCanvas, {\r\n            x: p.x,\r\n            y: p.y,\r\n            textStr: textInput.value,\r\n            align: alignRadioList.getValue(),\r\n            isItalic: italicToggle.getValue(),\r\n            isBold: boldToggle.getValue(),\r\n            size: parseFloat(sizeInput.value),\r\n            font: fontSelect.getValue(),\r\n            color: BB.ColorConverter.toRgbaStr(colorRGBA),\r\n            angleRad: p.angleRad\r\n        });\r\n\r\n\r\n        // --- determine transformation of viewport ---\r\n        // text should always be visible\r\n        bounds.width = Math.max(bounds.width, 1);\r\n        bounds.height = Math.max(bounds.height, 1);\r\n        let rotatedXY = BB.rotate(bounds.x, bounds.y, -p.angleRad / Math.PI * 180);\r\n        let rotatedWH = BB.rotate(bounds.width, bounds.height, -p.angleRad / Math.PI * 180);\r\n        let centerX = p.x + rotatedXY.x + rotatedWH.x / 2;\r\n        let centerY = p.y + rotatedXY.y + rotatedWH.y / 2;\r\n\r\n        let padding = 100;\r\n        let fitBounds = BB.fitInto(bounds.width, bounds.height, width - padding, height - padding);\r\n        scale = Math.min(1, fitBounds.width / bounds.width);\r\n        scale = Math.min(4, scale * Math.pow(2, zoomFac));\r\n\r\n\r\n        // --- compose text and target layer ---\r\n        targetCtx.save();\r\n\r\n        if (scale >= 4) {\r\n            targetCtx.imageSmoothingEnabled = false;\r\n        } else {\r\n            targetCtx.imageSmoothingEnabled = true;\r\n            targetCtx.imageSmoothingQuality  = scale >= 1 ? 'low' : 'medium';\r\n        }\r\n\r\n        targetCtx.clearRect(0, 0, previewCanvas.width, previewCanvas.height);\r\n        targetCtx.translate(width / 2, height / 2);\r\n        targetCtx.scale(scale, scale);\r\n        targetCtx.rotate(p.angleRad);\r\n        targetCtx.drawImage(layerArr[p.layerIndex].canvas, -centerX, -centerY);\r\n        targetCtx.drawImage(textCanvas, -centerX, -centerY);\r\n        targetCtx.restore();\r\n\r\n\r\n        // --- layers ---\r\n        layersCtx.save();\r\n\r\n        layersCtx.fillStyle = 'rgb(158,158,158)';\r\n        layersCtx.fillRect(0, 0, width, height);\r\n\r\n        { // bg\r\n            layersCtx.save();\r\n\r\n            layersCtx.translate(width / 2, height / 2);\r\n            layersCtx.scale(scale, scale);\r\n            layersCtx.rotate(p.angleRad);\r\n\r\n            layersCtx.imageSmoothingEnabled = false;\r\n\r\n            //outline\r\n            let borderSize = 1 / scale;\r\n            layersCtx.globalAlpha = 0.2;\r\n            layersCtx.drawImage(emptyCanvas, -centerX - borderSize, -centerY - borderSize, textCanvas.width + borderSize * 2, textCanvas.height + borderSize * 2);\r\n            layersCtx.globalAlpha = 1;\r\n\r\n            //erase\r\n            layersCtx.globalCompositeOperation = 'destination-out';\r\n            layersCtx.drawImage(emptyCanvas, -centerX, -centerY, textCanvas.width, textCanvas.height);\r\n\r\n            layersCtx.restore();\r\n        }\r\n\r\n        { // individual layers\r\n\r\n            if (scale >= 4) {\r\n                layersCtx.imageSmoothingEnabled = false;\r\n            } else {\r\n                layersCtx.imageSmoothingEnabled = true;\r\n                layersCtx.imageSmoothingQuality  = scale >= 1 ? 'low' : 'medium';\r\n            }\r\n\r\n            // layers below\r\n            layersCtx.save();\r\n            layersCtx.translate(width / 2, height / 2);\r\n            layersCtx.scale(scale, scale);\r\n            layersCtx.rotate(p.angleRad);\r\n            for (var i = 0; i < p.layerIndex; i++) {\r\n                if (layerArr[i].opacity > 0) {\r\n                    layersCtx.globalAlpha = layerArr[i].opacity;\r\n                    layersCtx.globalCompositeOperation = layerArr[i].mixModeStr;\r\n                    layersCtx.drawImage(layerArr[i].canvas, -centerX, -centerY);\r\n                }\r\n            }\r\n            layersCtx.restore();\r\n\r\n            // target layer\r\n            layersCtx.globalAlpha = layerArr[p.layerIndex].opacity;\r\n            layersCtx.globalCompositeOperation = layerArr[p.layerIndex].mixModeStr;\r\n            layersCtx.drawImage(targetCanvas, 0, 0);\r\n\r\n            // layers above\r\n            layersCtx.save();\r\n            layersCtx.translate(width / 2, height / 2);\r\n            layersCtx.scale(scale, scale);\r\n            layersCtx.rotate(p.angleRad);\r\n            for (let i = p.layerIndex + 1; i < layerArr.length; i++) {\r\n                if (layerArr[i].opacity > 0) {\r\n                    layersCtx.globalAlpha = layerArr[i].opacity;\r\n                    layersCtx.globalCompositeOperation = layerArr[i].mixModeStr;\r\n                    layersCtx.drawImage(layerArr[i].canvas, -centerX, -centerY);\r\n                }\r\n            }\r\n            layersCtx.restore();\r\n\r\n        }\r\n\r\n        layersCtx.restore();\r\n\r\n\r\n\r\n        // --- final composite ---\r\n        previewCtx.save();\r\n        previewCtx.fillStyle = checkerPattern;\r\n        previewCtx.fillRect(0, 0, previewCanvas.width, previewCanvas.height);\r\n        previewCtx.drawImage(layersCanvas, 0, 0);\r\n        previewCtx.restore();\r\n\r\n        // bounds\r\n        previewCtx.save();\r\n        previewCtx.globalCompositeOperation = 'difference';\r\n        previewCtx.strokeStyle = '#fff';\r\n        previewCtx.lineWidth = 1;\r\n        // centerX = p.x + bounds.x + bounds.width / 2;\r\n        // centerY = p.y + bounds.y + bounds.height / 2;\r\n        previewCtx.strokeRect(\r\n            Math.round(width / 2 - (bounds.width / 2) * scale),\r\n            Math.round(height / 2 - (bounds.height / 2) * scale),\r\n            Math.round(bounds.width * scale),\r\n            Math.round(bounds.height * scale)\r\n        );\r\n        previewCtx.restore();\r\n\r\n    }\r\n\r\n    function move(x, y) {\r\n        let rotated = BB.rotate(x, y, -p.angleRad / Math.PI * 180);\r\n        p.x += rotated.x / scale;\r\n        p.y += rotated.y / scale;\r\n        updatePreview();\r\n    }\r\n\r\n    let previewPointerListener = new BB.PointerListener({\r\n        target: previewCanvas,\r\n        pointers: 1,\r\n        onPointer: function(e) {\r\n            if (e.type === 'pointermove' && e.button) {\r\n                e.eventPreventDefault();\r\n                move(-e.dX, -e.dY);\r\n            }\r\n        },\r\n        onWheel: function(e) {\r\n            changeZoomFac(-e.deltaY);\r\n        }\r\n    });\r\n\r\n    const wheelPrevent = (event) => {\r\n        event.preventDefault();\r\n    }\r\n    BB.addEventListener(previewCanvas, 'wheel', wheelPrevent);\r\n\r\n\r\n\r\n    let row1 = BB.el({\r\n        parent: div,\r\n        css: {\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            marginTop: '10px'\r\n        }\r\n    });\r\n    let row2n3Wrapper = BB.el({\r\n        parent: div,\r\n        css: isSmallWidth ? {} : {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'space-between'\r\n        }\r\n    });\r\n    let row2 = BB.el({\r\n        parent: row2n3Wrapper,\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            marginTop: '5px'\r\n        }\r\n    });\r\n    let row3 = BB.el({\r\n        parent: row2n3Wrapper,\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'space-between',\r\n            marginTop: '5px',\r\n            width: isSmallWidth ? '' : '300px'\r\n        }\r\n    });\r\n\r\n    // --- row 1 ---\r\n\r\n    // color\r\n    let selectedRgbaObj = {r: 0, g: 0, b: 0, a: 1};\r\n    let colorOptionsArr = [\r\n        {r: 0, g: 0, b: 0, a: 1},\r\n        {r: 255, g: 255, b: 255, a: 1}\r\n    ];\r\n    colorOptionsArr.unshift({\r\n        r: p.secondaryColor.r,\r\n        g: p.secondaryColor.g,\r\n        b: p.secondaryColor.b,\r\n        a: 1,\r\n    });\r\n    colorOptionsArr.unshift({\r\n        r: p.color.r,\r\n        g: p.color.g,\r\n        b: p.color.b,\r\n        a: 1,\r\n    });\r\n\r\n    let colorOptions = new ColorOptions({\r\n        colorArr: colorOptionsArr,\r\n        initialIndex: 0,\r\n        onChange: function(rgbaObj) {\r\n            p.color = rgbaObj;\r\n            updatePreview();\r\n        }\r\n    });\r\n    colorOptions.getElement().title = LANG('text-color');\r\n    colorOptions.getElement().style.marginLeft = '-5px';\r\n    row1.appendChild(colorOptions.getElement());\r\n\r\n\r\n    let zoomFac = 0;\r\n    function changeZoomFac(d) {\r\n        zoomFac = Math.min(2, Math.max(-2, zoomFac + d));\r\n        updatePreview();\r\n        zoomInBtn.disabled = !canZoom(1);\r\n        zoomOutBtn.disabled = !canZoom(-1);\r\n    }\r\n    function canZoom(d) {\r\n        return zoomFac !== Math.min(2, Math.max(-2, zoomFac + d));\r\n    }\r\n\r\n    let zoomWrapper = BB.el({\r\n        parent: row1,\r\n        css: {\r\n\r\n        }\r\n    })\r\n\r\n    let zoomInBtn = BB.el({\r\n        parent: zoomWrapper,\r\n        content: `<img height=\"20\" src=\"${toolZoomInImg}\">`,\r\n        title: LANG('zoom-in'),\r\n        tagName: 'button',\r\n        onClick: function() {\r\n            changeZoomFac(1);\r\n        },\r\n        css: {\r\n            fontWeight: 'bold'\r\n        }\r\n    }) as HTMLButtonElement;\r\n    let zoomOutBtn = BB.el({\r\n        parent: zoomWrapper,\r\n        content: `<img height=\"20\" src=\"${toolZoomOutImg}\">`,\r\n        title: LANG('zoom-out'),\r\n        tagName: 'button',\r\n        onClick: function() {\r\n            changeZoomFac(-1);\r\n        },\r\n        css: {\r\n            fontWeight: 'bold',\r\n            marginLeft: '5px'\r\n        }\r\n    }) as HTMLButtonElement;\r\n\r\n\r\n\r\n    // --- row 2 ---\r\n    let sizeInput = BB.el({\r\n        parent: row2,\r\n        tagName: 'input',\r\n        title: LANG('text-size'),\r\n        custom: {\r\n            type: 'number',\r\n            min: 1,\r\n            max: 10000,\r\n            value: p.size\r\n        },\r\n        css: {\r\n            width: '60px'\r\n        },\r\n        onChange: function() {\r\n            sizeInput.value = '' + Math.max(1, Math.min(10000, parseInt(sizeInput.value)));\r\n            updatePreview();\r\n        }\r\n    }) as HTMLInputElement;\r\n    let sizePointerListener = new BB.PointerListener({\r\n        target: sizeInput,\r\n        onWheel: function(e) {\r\n            sizeInput.value = '' + Math.max(1, Math.min(1000, parseInt(sizeInput.value) - e.deltaY));\r\n            updatePreview();\r\n        }\r\n    });\r\n\r\n    let modeWrapper;\r\n    let fontSelect;\r\n    let fontPointerListener;\r\n    {\r\n        modeWrapper = BB.el({\r\n            css: {\r\n                fontSize: '15px',\r\n                marginLeft: '10px'\r\n            }\r\n        });\r\n        fontSelect = new Select({\r\n            isFocusable: true,\r\n            optionArr: [\r\n                ['sans-serif', 'Sans-serif'],\r\n                ['serif', 'Serif'],\r\n                ['monospace', 'Monospace'],\r\n                ['cursive', 'Cursive'],\r\n                ['fantasy', 'Fantasy'],\r\n            ],\r\n            initValue: p.font,\r\n            onChange: function(val) {\r\n                updatePreview();\r\n            },\r\n        });\r\n\r\n        modeWrapper.appendChild(fontSelect.getElement());\r\n        row2.appendChild(modeWrapper);\r\n\r\n        fontPointerListener = new BB.PointerListener({\r\n            target: fontSelect.getElement(),\r\n            onWheel: function(e) {\r\n                fontSelect.setDeltaValue(e.deltaY);\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n\r\n    // --- row 3 ---\r\n\r\n    let alignRadioList = new ImageRadioList({\r\n        optionArr: [\r\n            {\r\n                id: 'left',\r\n                title: LANG('text-left'),\r\n                image: alignLeftImg,\r\n            },\r\n            {\r\n                id: 'center',\r\n                title: LANG('text-center'),\r\n                image: alignCenterImg,\r\n            },\r\n            {\r\n                id: 'right',\r\n                title: LANG('text-right'),\r\n                image: alignRightImg,\r\n            }\r\n        ],\r\n        initId: p.align,\r\n        onChange: function(id) {\r\n            updatePreview();\r\n        }\r\n    });\r\n    row3.appendChild(alignRadioList.getElement());\r\n\r\n    let italicToggle = new ImageToggle({\r\n        image: typoItalicImg,\r\n        title: LANG('text-italic'),\r\n        initValue: p.isItalic,\r\n        onChange: function(b) {\r\n            updatePreview();\r\n        }\r\n    });\r\n    row3.appendChild(italicToggle.getElement());\r\n\r\n    let boldToggle = new ImageToggle({\r\n        image: typoBoldImg,\r\n        title: LANG('text-bold'),\r\n        initValue: p.isBold,\r\n        onChange: function(b) {\r\n            updatePreview();\r\n        }\r\n    });\r\n    row3.appendChild(boldToggle.getElement());\r\n\r\n\r\n\r\n    let opacitySlider = new KlSlider({\r\n        label: LANG('opacity'),\r\n        width: 150,\r\n        height: 30,\r\n        min: 0,\r\n        max: 1,\r\n        initValue: p.opacity,\r\n        resolution: 225,\r\n        eventResMs: 1000 / 30,\r\n        onChange: function(v) {\r\n            updatePreview();\r\n        },\r\n        formatFunc: function(v) {\r\n            return Math.round(v * 100);\r\n        }\r\n    });\r\n    row3.appendChild(opacitySlider.getElement());\r\n\r\n\r\n\r\n    let textInput = BB.el({\r\n        parent: div,\r\n        tagName: 'textarea',\r\n        custom: {\r\n            placeholder: LANG('text-placeholder'),\r\n            'data-ignore-focus': 'true',\r\n        },\r\n        css: {\r\n            whiteSpace: 'nowrap',\r\n            overflow: 'auto',\r\n            width: '100%',\r\n            height: '70px',\r\n            resize: 'vertical',\r\n            marginTop: '10px'\r\n        },\r\n        onChange: function() {\r\n            updatePreview();\r\n        }\r\n    }) as HTMLTextAreaElement;\r\n    textInput.addEventListener('input', updatePreview);\r\n    setTimeout(function() {\r\n        textInput.focus();\r\n        textInput.select();\r\n    });\r\n    let closefunc;\r\n    let keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, e, comboStr) {\r\n            if (BB.isInputFocused(true)) {\r\n                return;\r\n            }\r\n            if (keyStr === 'left') {\r\n                move(-1, 0);\r\n            }\r\n            if (keyStr === 'right') {\r\n                move(1, 0);\r\n            }\r\n            if (keyStr === 'up') {\r\n                move(0, -1);\r\n            }\r\n            if (keyStr === 'down') {\r\n                move(0, 1);\r\n            }\r\n        }\r\n    });\r\n\r\n    // prevent mobile keyboards scrolling page\r\n    function onScroll() {\r\n        window.scrollTo(0, 0);\r\n    }\r\n    window.addEventListener('scroll', onScroll);\r\n\r\n\r\n    popup({\r\n        target: document.body,\r\n        message: `<b>${LANG('text-title')}</b>`,\r\n        div: div,\r\n        buttons: [\"Ok\", \"Cancel\"],\r\n        style: isSmallWidth ? {} : {\r\n            width: '500px'\r\n        },\r\n        callback: function(val) {\r\n            let result = {\r\n                x: p.x,\r\n                y: p.y,\r\n                textStr: textInput.value,\r\n                align: alignRadioList.getValue(),\r\n                isItalic: italicToggle.getValue(),\r\n                isBold: boldToggle.getValue(),\r\n                color: p.color,\r\n                size: sizeInput.value,\r\n                font: fontSelect.getValue(),\r\n                opacity: opacitySlider.getValue()\r\n            };\r\n\r\n            window.removeEventListener('scroll', onScroll);\r\n            textInput.removeEventListener('input', updatePreview);\r\n            BB.destroyEl(textInput);\r\n            previewPointerListener.destroy();\r\n            sizePointerListener.destroy();\r\n            fontPointerListener.destroy();\r\n            BB.removeEventListener(previewCanvas, 'wheel', wheelPrevent);\r\n            BB.destroyEl(previewWrapper);\r\n            BB.destroyEl(zoomInBtn);\r\n            BB.destroyEl(zoomOutBtn);\r\n            BB.destroyEl(sizeInput);\r\n            colorOptions.destroy();\r\n            fontSelect.destroy();\r\n            keyListener.destroy();\r\n            alignRadioList.destroy();\r\n            italicToggle.destroy();\r\n            boldToggle.destroy();\r\n            opacitySlider.destroy();\r\n            if (val === 'Ok') {\r\n                p.onConfirm(result);\r\n            }\r\n        },\r\n        autoFocus: false,\r\n        clickOnEnter: 'Ok',\r\n        ignoreBackground: true,\r\n        closefunc: function (func) {\r\n            closefunc = func;\r\n        },\r\n    });\r\n\r\n    updatePreview();\r\n\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"lvwQ5\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"imAvm\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"dC0sF\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"h3hPo\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"1pAeY\");","import {BB} from '../../../bb/bb';\r\nimport {CropCopy} from '../components/crop-copy';\r\nimport {Checkbox} from '../base-components/checkbox';\r\nimport {popup} from './popup';\r\nimport {LANG} from '../../../language/language';\r\n\r\n/**\r\n *\r\n * p = {\r\n *     image: convertedPsd | {type: 'image', width: number, height: number, canvas: image | canvas},\r\n *     maxSize: number,\r\n *     target: htmlElement,\r\n *     callback: func(\r\n *         {\r\n *             type: 'as-image',\r\n *             image: image | canvas,\r\n *         } | {\r\n *             type: 'as-image-psd',\r\n *             image: convertedPsd,\r\n *             cropObj: {x: number, y: number, width: number, height: number}\r\n *         } | {\r\n *             type: 'as-layer',\r\n *             image: image | canvas,\r\n *         } | {\r\n *             type: 'cancel',\r\n *         }\r\n *     )\r\n * }\r\n *\r\n * @param p {}\r\n */\r\nexport function showImportImageDialog(p) {\r\n    const div = BB.el({});\r\n\r\n    const isSmall = window.innerWidth < 550 || window.innerHeight < 550;\r\n    const style = isSmall ? {} : { width: '500px' };\r\n    let resolutionEl;\r\n    const cropCopy = new CropCopy({\r\n        width: isSmall ? 340 : 540,\r\n        height: isSmall ? 300 : 400,\r\n        canvas: p.image.canvas,\r\n        isNotCopy: true,\r\n        onChange: function(width, height) {\r\n            if (!resolutionEl) {\r\n                return;\r\n            }\r\n            updateResolution(width, height);\r\n        }\r\n    });\r\n    BB.css(cropCopy.getEl(), {\r\n        marginLeft: '-20px',\r\n        borderTop: '1px solid #bbb',\r\n        borderBottom: '1px solid #bbb'\r\n    });\r\n    cropCopy.getEl().title = LANG('crop-drag-to-crop');\r\n    div.appendChild(cropCopy.getEl());\r\n\r\n\r\n    resolutionEl = BB.el({\r\n        parent: div,\r\n        css: {\r\n            marginTop: '10px',\r\n            textAlign: 'center',\r\n            color: '#888',\r\n            lineHeight: '20px',\r\n        }\r\n    });\r\n    function updateResolution(w: number, h: number) {\r\n        const fit = BB.fitInto(w, h, p.maxSize, p.maxSize);\r\n\r\n        if (fit.width < w) {\r\n            resolutionEl.innerHTML = `<span style=\"color:#f00\">${w} X ${h}</span> ⟶ ${Math.round(fit.width)} X ${Math.round(fit.height)}`;\r\n            resolutionEl.title = LANG('import-too-large');\r\n        } else {\r\n            resolutionEl.innerHTML = `${w} X ${h}`;\r\n            resolutionEl.title = '';\r\n        }\r\n    }\r\n    updateResolution(p.image.width, p.image.height);\r\n\r\n\r\n    let doFlatten = false;\r\n    function showWarnings(psdWarningArr) {\r\n        let contentArr = [];\r\n        let warningMap = {\r\n            'mask': 'Masks not supported. Mask was applied.',\r\n            'clipping': 'Clipping not supported. Clipping layers were merged.',\r\n            'group': 'Groups not supported. Layers were ungrouped.',\r\n            'adjustment': 'Adjustment layers not supported.',\r\n            'layer-effect': 'Layer effects not supported.',\r\n            'smart-object': 'Smart objects not supported.',\r\n            'blend-mode': 'Unsupported layer blend mode.',\r\n            'bits-per-channel': 'Unsupported color depth. Only 8bit per channel supported.',\r\n        };\r\n        for (let i = 0; i < psdWarningArr.length; i++) {\r\n            contentArr.push('- ' + warningMap[psdWarningArr[i]]);\r\n        }\r\n        alert(contentArr.join(\"\\n\"));\r\n    }\r\n\r\n    let flattenCheckbox;\r\n    if (p.image.type === 'psd') {\r\n        const noteStyle = {\r\n            background: 'rgba(255,255,0,0.5)',\r\n            padding: '10px',\r\n            marginTop: '5px',\r\n            marginBottom: '5px',\r\n            border: '1px solid #e7d321',\r\n            borderRadius: '5px'\r\n        };\r\n        if (p.image.layers) {\r\n            flattenCheckbox = new Checkbox({\r\n                init: doFlatten,\r\n                label: LANG('import-flatten'),\r\n                callback: function(b) {\r\n                    doFlatten = b;\r\n                }\r\n            });\r\n            div.appendChild(flattenCheckbox.getElement());\r\n\r\n            if (p.image.warningArr) {\r\n                const noteEl = BB.el({\r\n                    content: LANG('import-psd-limited-support'),\r\n                    css: noteStyle\r\n                });\r\n                noteEl.appendChild(BB.el({\r\n                    tagName: 'a',\r\n                    content: 'Details',\r\n                    onClick: function() {\r\n                        showWarnings(p.image.warningArr);\r\n                    }\r\n                }));\r\n                div.appendChild(noteEl);\r\n            }\r\n        } else {\r\n            const noteEl = BB.el({\r\n                content: LANG('import-psd-unsupported'),\r\n                css: noteStyle\r\n            });\r\n            div.appendChild(noteEl);\r\n        }\r\n    }\r\n\r\n    function callback(result) {\r\n        const croppedImage = cropCopy.getCroppedImage();\r\n        const cropRect = cropCopy.getRect();\r\n        cropCopy.destroy();\r\n        if (flattenCheckbox) {\r\n            flattenCheckbox.destroy();\r\n        }\r\n\r\n        if (result === LANG('import-btn-as-layer')) {\r\n            p.callback({\r\n                type: 'as-layer',\r\n                image: croppedImage\r\n            });\r\n\r\n        } else if (result === LANG('import-btn-as-image')) {\r\n            if (p.image.type === 'psd') {\r\n                if (doFlatten) {\r\n                    p.image.layers = null;\r\n                }\r\n                p.callback({\r\n                    type: 'as-image-psd',\r\n                    image: p.image,\r\n                    cropObj: cropRect\r\n                });\r\n            } else if (p.image.type === 'image') {\r\n                p.callback({\r\n                    type: 'as-image',\r\n                    image: croppedImage\r\n                });\r\n            }\r\n        } else {\r\n            p.callback({\r\n                type: 'cancel'\r\n            });\r\n        }\r\n    }\r\n    popup({\r\n        target: p.target,\r\n        message: `<b>${LANG('import-title')}</b>`,\r\n        div: div,\r\n        style,\r\n        buttons: [LANG('import-btn-as-layer'), LANG('import-btn-as-image'), \"Cancel\"],\r\n        callback: callback,\r\n        autoFocus: 'As Image'\r\n    });\r\n}","import {createCanvas} from '../../bb/base/create-canvas';\r\nimport {Psd} from 'ag-psd/dist/psd';\r\nimport {IKlProject, IKlPsd, IMixMode} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\nimport {MAX_LAYERS} from '../canvas/kl-canvas';\r\n\r\nlet kl2PsdMap;\r\nlet psd2KlMap;\r\n\r\nfunction init() {\r\n    if (kl2PsdMap) {\r\n        return;\r\n    }\r\n\r\n    kl2PsdMap = {\r\n        'source-over': 'normal',\r\n\r\n        'darken': 'darken',\r\n        'multiply': 'multiply',\r\n        'color-burn': 'color burn',\r\n\r\n        'lighten': 'lighten',\r\n        'screen': 'screen',\r\n        'color-dodge': 'color dodge',\r\n\r\n        'overlay': 'overlay',\r\n        'soft-light': 'soft light',\r\n        'hard-light': 'hard light',\r\n\r\n        'difference': 'difference',\r\n        'exclusion': 'exclusion',\r\n\r\n        'hue': 'hue',\r\n        'saturation': 'saturation',\r\n        'color': 'color',\r\n        'luminosity': 'luminosity',\r\n    };\r\n\r\n    psd2KlMap = {};\r\n    let keys = Object.keys(kl2PsdMap);\r\n    for (let i = 0; i < keys.length; i++) {\r\n        psd2KlMap[kl2PsdMap[keys[i]]] = keys[i];\r\n    }\r\n}\r\n\r\nexport function blendPsdToKl(str: string): IMixMode {\r\n    init();\r\n    return psd2KlMap[str];\r\n}\r\n\r\nexport function blendKlToPsd(str: string): string {\r\n    init();\r\n    return kl2PsdMap[str];\r\n}\r\n\r\n\r\n/**\r\n * Converts ag-psd object into something that KlCanvas can represent\r\n * @param psdObj\r\n */\r\nexport function readPsd(psdObj: Psd): IKlPsd {\r\n    let result: IKlPsd = {\r\n        type: 'psd',\r\n        canvas: psdObj.canvas,\r\n        width: psdObj.width,\r\n        height: psdObj.height\r\n    };\r\n\r\n    function addWarning(warningStr) {\r\n        if (!result.warningArr) {\r\n            result.warningArr = [];\r\n        }\r\n        if (result.warningArr.includes(warningStr)) {\r\n            return;\r\n        }\r\n        result.warningArr.push(warningStr);\r\n    }\r\n\r\n    function getMixModeStr(blendMode): IMixMode {\r\n        let mixModeStr: IMixMode = blendPsdToKl(blendMode);\r\n        if (!mixModeStr) {\r\n            addWarning('blend-mode');\r\n            mixModeStr = 'source-over';\r\n        }\r\n        return mixModeStr;\r\n    }\r\n\r\n    if (psdObj.bitsPerChannel !== 8) {\r\n        addWarning('bits-per-channel');\r\n    }\r\n\r\n    if (!psdObj.children) {\r\n        result.error = true;\r\n        return result;\r\n    }\r\n\r\n    // count resulting layers\r\n    let maxLayers = MAX_LAYERS;\r\n    let layerCount = 0;\r\n    function countWithinGroup(groupObj) {\r\n        let result = 0;\r\n        if (groupObj.blendMode) {\r\n            let mixModeStr = blendPsdToKl(groupObj.blendMode);\r\n            if (mixModeStr && mixModeStr !== 'source-over') {\r\n                return 1;\r\n            }\r\n        }\r\n        for (let i = 0; i < groupObj.children.length; i++) {\r\n            let item = groupObj.children[i];\r\n            if (item.clipping || item.adjustment) {\r\n                continue;\r\n            }\r\n\r\n            if (item.children) {\r\n                addWarning('group');\r\n                result += countWithinGroup(item);\r\n            } else {\r\n                result++;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    layerCount += countWithinGroup(psdObj);\r\n    if (layerCount > maxLayers) {\r\n        result.error = true;\r\n        return result;\r\n    }\r\n\r\n    result.layers = [];\r\n\r\n    function prepareMask(maskCanvas, defaultColor) {\r\n        const groupMaskCtx = maskCanvas.getContext('2d');\r\n        let imData = groupMaskCtx.getImageData(0, 0, maskCanvas.width, maskCanvas.height);\r\n        if (defaultColor === 0) {\r\n            for (let i = 0; i < imData.data.length; i += 4) {\r\n                imData.data[i + 3] = imData.data[i];\r\n            }\r\n        } else {\r\n            for (let i = 0; i < imData.data.length; i += 4) {\r\n                imData.data[i + 3] = 255 - imData.data[i];\r\n            }\r\n        }\r\n        groupMaskCtx.putImageData(imData, 0, 0);\r\n    }\r\n\r\n    function convertGroup(psdGroupObj): {\r\n        name: string;\r\n        mixModeStr: IMixMode;\r\n        opacity: number;\r\n        image: HTMLCanvasElement;\r\n    }[] {\r\n\r\n        let resultArr: {\r\n            name: string;\r\n            mixModeStr: IMixMode;\r\n            opacity: number;\r\n            image: HTMLCanvasElement;\r\n        }[] = [];\r\n        let groupOpacity = psdGroupObj.hidden ? 0 : psdGroupObj.opacity;\r\n        let groupMixModeStr = getMixModeStr(psdGroupObj.blendMode);\r\n        let groupCanvas;\r\n        let groupCtx;\r\n        if (groupMixModeStr !== 'source-over') {\r\n            groupCanvas = createCanvas(result.width, result.height);\r\n            groupCtx = groupCanvas.getContext('2d');\r\n        }\r\n\r\n\r\n        // prepare group mask\r\n        if (psdGroupObj.mask) {\r\n            addWarning('mask');\r\n            prepareMask(psdGroupObj.mask.canvas, psdGroupObj.mask.defaultColor);\r\n        }\r\n\r\n\r\n        for (let i = 0; i < psdGroupObj.children.length; i++) {\r\n            let item = psdGroupObj.children[i];\r\n            if (item.clipping) {\r\n                continue;\r\n            }\r\n            if (item.adjustment) {\r\n                addWarning('adjustment');\r\n                continue;\r\n            }\r\n\r\n            let hasClipping = (item.children || item.canvas) && psdGroupObj.children[i + 1] && psdGroupObj.children[i + 1].clipping;\r\n            if (hasClipping) {\r\n                addWarning('clipping');\r\n            }\r\n\r\n            if (item.children) {\r\n                let innerArr = convertGroup(item);\r\n\r\n                for (let e = 0; e < innerArr.length; e++) {\r\n                    let innerItem = innerArr[e];\r\n                    let innerCtx = innerItem.image.getContext('2d');\r\n\r\n                    // clipping\r\n                    if (hasClipping) {\r\n                        let clippingCanvas = createCanvas(result.width, result.height);\r\n                        let clippingCtx = clippingCanvas.getContext('2d');\r\n                        clippingCtx.drawImage(innerItem.image, 0, 0);\r\n\r\n                        for (let f = i + 1; f < psdGroupObj.children.length && psdGroupObj.children[f].clipping; f++) {\r\n                            let clippingItem = psdGroupObj.children[f];\r\n                            if (clippingItem.opacity === 0 || clippingItem.hidden) {\r\n                                continue;\r\n                            }\r\n                            clippingCtx.globalCompositeOperation = getMixModeStr(clippingItem.blendMode);\r\n                            clippingCtx.globalAlpha = clippingItem.opacity;\r\n                            clippingCtx.drawImage(clippingItem.canvas, clippingItem.left, clippingItem.top);\r\n                        }\r\n\r\n                        innerCtx.globalCompositeOperation = 'source-atop';\r\n                        innerCtx.drawImage(clippingCanvas, 0, 0);\r\n                    }\r\n\r\n\r\n\r\n                    // group mask\r\n                    if (psdGroupObj.mask) {\r\n                        innerCtx.globalCompositeOperation = psdGroupObj.mask.defaultColor === 0 ? 'destination-in' : 'destination-out';\r\n                        innerCtx.drawImage(psdGroupObj.mask.canvas, psdGroupObj.mask.left, psdGroupObj.mask.top);\r\n                    }\r\n\r\n                    if (groupCanvas) {\r\n                        groupCtx.globalCompositeOperation = innerItem.mixModeStr;\r\n                        groupCtx.globalAlpha = innerItem.opacity;\r\n                        groupCtx.drawImage(innerItem.image, 0, 0);\r\n\r\n                    } else {\r\n                        innerItem.opacity = innerItem.opacity * groupOpacity;\r\n                        resultArr.push(innerItem);\r\n                    }\r\n                }\r\n\r\n                continue;\r\n            }\r\n\r\n            let canvas = createCanvas(result.width, result.height);\r\n            let ctx = canvas.getContext('2d');\r\n            if (item.canvas) { // if a layer is empty it has no canvas\r\n                ctx.drawImage(item.canvas, item.left, item.top);\r\n            }\r\n\r\n            // effects\r\n            if (item.effects) {\r\n                addWarning('layer-effect');\r\n            }\r\n\r\n            // mask\r\n            if (item.mask) {\r\n                addWarning('mask');\r\n                prepareMask(item.mask.canvas, item.mask.defaultColor);\r\n\r\n                ctx.globalCompositeOperation = item.mask.defaultColor === 0 ? 'destination-in' : 'destination-out';\r\n                ctx.drawImage(item.mask.canvas, item.mask.left, item.mask.top);\r\n            }\r\n\r\n            // clipping\r\n            if (hasClipping) {\r\n                let clippingCanvas = createCanvas(item.right - item.left, item.bottom - item.top);\r\n                let clippingCtx = clippingCanvas.getContext('2d');\r\n                clippingCtx.drawImage(item.canvas, 0, 0);\r\n\r\n                for (let e = i + 1; e < psdGroupObj.children.length && psdGroupObj.children[e].clipping; e++) {\r\n                    let clippingItem = psdGroupObj.children[e];\r\n                    if (clippingItem.opacity === 0 || clippingItem.hidden) {\r\n                        continue;\r\n                    }\r\n                    clippingCtx.globalCompositeOperation = getMixModeStr(clippingItem.blendMode);\r\n                    clippingCtx.globalAlpha = clippingItem.opacity;\r\n                    clippingCtx.drawImage(clippingItem.canvas, clippingItem.left - item.left, clippingItem.top - item.top);\r\n                }\r\n\r\n                ctx.globalCompositeOperation = 'source-atop';\r\n                ctx.drawImage(clippingCanvas, item.left, item.top);\r\n            }\r\n\r\n            // group mask\r\n            if (psdGroupObj.mask) {\r\n                ctx.globalCompositeOperation = psdGroupObj.mask.defaultColor === 0 ? 'destination-in' : 'destination-out';\r\n                ctx.drawImage(psdGroupObj.mask.canvas, psdGroupObj.mask.left, psdGroupObj.mask.top);\r\n            }\r\n\r\n            if (groupCanvas) {\r\n                if (groupOpacity > 0) {\r\n                    groupCtx.globalCompositeOperation = getMixModeStr(item.blendMode);\r\n                    groupCtx.globalAlpha = item.hidden ? 0 : item.opacity;\r\n                    groupCtx.drawImage(canvas, 0, 0);\r\n                }\r\n\r\n            } else {\r\n                resultArr.push({\r\n                    name: item.name,\r\n                    opacity: (item.hidden ? 0 : item.opacity) * groupOpacity,\r\n                    mixModeStr: getMixModeStr(item.blendMode),\r\n                    image: canvas,\r\n                });\r\n            }\r\n        }\r\n\r\n        if (groupCanvas) {\r\n            resultArr = [\r\n                {\r\n                    name: psdGroupObj.name,\r\n                    opacity: groupOpacity,\r\n                    mixModeStr: groupMixModeStr,\r\n                    image: groupCanvas,\r\n                }\r\n            ];\r\n        }\r\n\r\n        return resultArr;\r\n    }\r\n\r\n    result.layers = convertGroup({\r\n        name: 'root',\r\n        opacity: 1,\r\n        blendMode: 'normal',\r\n        children: psdObj.children\r\n    });\r\n\r\n    return result;\r\n}\r\n\r\nexport function klPsdToKlProject(klPsd: IKlPsd): IKlProject {\r\n    // only share references to Canvas elements\r\n    const result: IKlProject = {\r\n        width: klPsd.width,\r\n        height: klPsd.height,\r\n        layers: [],\r\n    };\r\n    if (klPsd.layers) {\r\n        result.layers = result.layers.concat(klPsd.layers.map(item => {\r\n            return {\r\n                name: item.name,\r\n                opacity: item.opacity,\r\n                mixModeStr: item.mixModeStr,\r\n                image: item.image,\r\n            };\r\n        }));\r\n    } else {\r\n        // flattened\r\n        result.layers.push({\r\n            name: LANG('background'),\r\n            opacity: 1,\r\n            mixModeStr: 'source-over',\r\n            image: klPsd.canvas,\r\n        });\r\n    }\r\n    return result;\r\n}","//browser storage indexedDB\r\n\r\n\r\nimport {IKlStorageProject} from '../kl.types';\r\n\r\nconst indexedDbIsSupported = !!window.indexedDB;\r\nlet dbNameStr = 'Klecks';\r\nconst storageNameStr = 'ProjectStore';\r\n\r\nexport function setDbName(name: string) {\r\n    dbNameStr = '' + name;\r\n}\r\n\r\n/**\r\n * connects to db dbNameStr, then executes transaction on storageNameStr storage\r\n * with index 'id'\r\n *\r\n * @param actionFunction function(storeObj) - what you want to execute during transaction\r\n * @param successCallback function() - on succesful transaction\r\n * @param errorCallback function(errorStr) - on error\r\n */\r\nfunction execIndexedDBTransaction(actionFunction, successCallback, errorCallback) {\r\n\r\n    let hasFinished = false;\r\n\r\n    function onSuccess() {\r\n        if (hasFinished) {\r\n            return;\r\n        }\r\n        hasFinished = true;\r\n        successCallback();\r\n    }\r\n\r\n    function onError(errorStr) {\r\n        if (hasFinished) {\r\n            return;\r\n        }\r\n        hasFinished = true;\r\n        errorCallback(errorStr);\r\n    }\r\n\r\n    if (!indexedDbIsSupported) {\r\n        setTimeout(function () {\r\n            onError('no indexed db available');\r\n        }, 0);\r\n        return;\r\n    }\r\n    let requestObj;\r\n\r\n    try {\r\n        requestObj = window.indexedDB.open(dbNameStr, 1);\r\n    } catch (e) {\r\n        onError(e.message);\r\n        return;\r\n    }\r\n\r\n    requestObj.onupgradeneeded = function (e) {\r\n        try {\r\n            let db = requestObj.result;\r\n            let store = db.createObjectStore(storageNameStr, {keyPath: 'id'});\r\n            store.createIndex('id', 'id', {unique: true});\r\n        } catch (e) {\r\n            onError(e.message);\r\n        }\r\n    };\r\n    requestObj.onerror = function (e) {\r\n        onError('indexedDB.open failed, ' + requestObj.error);\r\n    };\r\n    requestObj.onsuccess = function (e) {\r\n        let databaseObj;\r\n        let transactionObj;\r\n        let storeObj;\r\n\r\n        try {\r\n            databaseObj = requestObj.result;\r\n            if (!databaseObj.objectStoreNames.contains(storageNameStr)) {\r\n                //someone maybe messed with the db, or creation failed earlier\r\n                //it's broken -> destroy\r\n                window.indexedDB.deleteDatabase(dbNameStr);\r\n                onError('object store ' + storageNameStr + ' missing. destroying db');\r\n                return;\r\n            }\r\n            transactionObj = databaseObj.transaction(storageNameStr, 'readwrite');\r\n            storeObj = transactionObj.objectStore(storageNameStr);\r\n            storeObj.index('id');\r\n        } catch (e) {\r\n            onError(e.message);\r\n            return;\r\n        }\r\n\r\n        databaseObj.onerror = function (e) {\r\n            onError('database error, ' + databaseObj.error);\r\n        };\r\n\r\n        try {\r\n            actionFunction(storeObj);\r\n        } catch (e) {\r\n            onError(e.message);\r\n            return;\r\n        }\r\n\r\n        transactionObj.oncomplete = function () {\r\n            onSuccess();\r\n            databaseObj.close();\r\n        };\r\n        transactionObj.onerror = function () {\r\n            onError('transaction error, ' + transactionObj.error);\r\n        };\r\n    };\r\n}\r\n\r\n/**\r\n * getKlProjectObj {\r\n *     width: int,\r\n *     height: int,\r\n *     layers: {\r\n *        name: string,\r\n *        opacity: float (0 - 1),\r\n *        mixModeStr: string,\r\n *        image: image object                <--------- image already loaded!\r\n *     }[]\r\n * }\r\n *\r\n * @param successCallback function - called when succesfully queried. passes KlProjectObj\r\n * @param errorCallback - function(errorStr) - called when error during query\r\n */\r\nexport function getKlProjectObj(successCallback, errorCallback) {\r\n    if (indexedDbIsSupported) {\r\n        let query;\r\n        execIndexedDBTransaction(function (storeObj) {\r\n            query = storeObj.get(1);\r\n        }, function () {\r\n            successCallback(query.result);\r\n        }, function (errorStr) {\r\n            errorCallback('execIndexedDBTransaction error, ' + errorStr);\r\n        });\r\n    } else {\r\n        successCallback(null);\r\n    }\r\n}\r\n\r\n/**\r\n * stores a klProjectObj into id = 1 in database:dbNameStr > storage: storageNameStr\r\n *\r\n * KlProjectObj {\r\n *     width: int,\r\n *     height: int,\r\n *     layers: {\r\n *        name: string,\r\n *        opacity: float (0 - 1),\r\n *        mixModeStr: string,\r\n *        blob: blob object                 <--------- blob!\r\n *     }[]\r\n * }\r\n *\r\n * @param storageProject IKlStorageProject - project to be stored\r\n * @param successCallback function() - on successful transaction\r\n * @param errorCallback function(errorStr) - on error\r\n */\r\nexport function storeKlProjectObj(storageProject: IKlStorageProject, successCallback, errorCallback) {\r\n    execIndexedDBTransaction(function (storeObj) {\r\n        storeObj.put(storageProject);\r\n    }, function () {\r\n        successCallback();\r\n    }, function (errorStr) {\r\n        errorCallback(errorStr);\r\n    });\r\n\r\n}\r\n\r\n/**\r\n * removes id = 1 from database:dbNameStr > storage: storageNameStr\r\n *\r\n * @param successCallback function() - on successful transaction\r\n * @param errorCallback function(error) - on error\r\n */\r\nexport function clear(successCallback, errorCallback) {\r\n    execIndexedDBTransaction(function (storeObj) {\r\n        storeObj.delete(1);\r\n    }, function () {\r\n        successCallback();\r\n    }, function (error) {\r\n        errorCallback(error);\r\n    });\r\n\r\n}\r\n","import {IFilter} from '../kl.types';\r\n// @ts-ignore\r\nimport glBrightnessContrastImg from 'url:~/src/app/img/ui/edit-brightness-contrast.svg';\r\n// @ts-ignore\r\nimport cropExtendImg from 'url:~/src/app/img/ui/edit-crop.svg';\r\n// @ts-ignore\r\nimport glCurvesImg from 'url:~/src/app/img/ui/edit-curves.svg';\r\n// @ts-ignore\r\nimport flipImg from 'url:~/src/app/img/ui/edit-flip.svg';\r\n// @ts-ignore\r\nimport glHueSaturationImg from 'url:~/src/app/img/ui/edit-hue-saturation.svg';\r\n// @ts-ignore\r\nimport invertImg from 'url:~/src/app/img/ui/edit-invert.png';\r\n// @ts-ignore\r\nimport glPerspectiveImg from 'url:~/src/app/img/ui/edit-perspective.svg';\r\n// @ts-ignore\r\nimport resizeImg from 'url:~/src/app/img/ui/edit-resize.svg';\r\n// @ts-ignore\r\nimport rotateImg from 'url:~/src/app/img/ui/edit-rotate.svg';\r\n// @ts-ignore\r\nimport glTiltShiftImg from 'url:~/src/app/img/ui/edit-tilt-shift.png';\r\n// @ts-ignore\r\nimport toAlphaImg from 'url:~/src/app/img/ui/edit-to-alpha.svg';\r\n// @ts-ignore\r\nimport transformImg from 'url:~/src/app/img/ui/edit-transform.svg';\r\n// @ts-ignore\r\nimport glBlurImg from 'url:~/src/app/img/ui/edit-triangle-blur.png';\r\n// @ts-ignore\r\nimport glUnsharpMaskImg from 'url:~/src/app/img/ui/edit-unsharp-mask.png';\r\n// @ts-ignore\r\nimport aImg from 'url:~/src/app/img/ui/';\r\nimport {LANG, languageStrings} from '../../language/language';\r\n\r\n\r\nexport const filterLibStatus = {\r\n    isLoaded: false,\r\n};\r\nexport const filterLib: {\r\n    [key:string]: IFilter;\r\n} = {\r\n    glBrightnessContrast: {\r\n        lang: {name: 'filter-bright-contrast-title', button: 'filter-bright-contrast'},\r\n        name: '',\r\n        buttonLabel: '',\r\n        webgl: true,\r\n        updateContext: true,\r\n        icon: glBrightnessContrastImg,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    cropExtend: {\r\n        lang: {name: 'filter-crop-title', button: 'filter-crop-extend'},\r\n        name: '',\r\n        buttonLabel: '',\r\n        icon: cropExtendImg,\r\n        webgl: false,\r\n        neededWithWebGL: true,\r\n        updateContext: true,\r\n        updatePos: true,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: false,\r\n    },\r\n    glCurves: {\r\n        lang: {name: 'filter-curves-title', button: 'filter-curves'},\r\n        name: '',\r\n        buttonLabel: '',\r\n        icon: glCurvesImg,\r\n        webgl: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    flip: {\r\n        lang: {name: 'filter-flip-title', button: 'filter-flip'},\r\n        name: '',\r\n        buttonLabel: '',\r\n        icon: flipImg,\r\n        webgl: false,\r\n        neededWithWebGL: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    glHueSaturation: {\r\n        lang: {name: 'filter-hue-sat-title', button: 'filter-hue-sat'},\r\n        name: '',\r\n        buttonLabel: '',\r\n        icon: glHueSaturationImg,\r\n        webgl: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    invert: {\r\n        lang: {name: 'filter-invert', button: 'filter-invert'},\r\n        name: '',\r\n        icon: invertImg,\r\n        webgl: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        isInstant: true,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    glPerspective: {\r\n        lang: {name: 'filter-perspective-title', button: 'filter-perspective'},\r\n        name: '',\r\n        buttonLabel: '',\r\n        icon: glPerspectiveImg,\r\n        webgl: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    resize: {\r\n        lang: {name: 'filter-resize-title', button: 'filter-resize'},\r\n        name: '',\r\n        buttonLabel: '',\r\n        icon: resizeImg,\r\n        webgl: false,\r\n        neededWithWebGL: true,\r\n        updateContext: true,\r\n        updatePos: true,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: false,\r\n    },\r\n    rotate: {\r\n        lang: {name: 'filter-rotate-title', button: 'filter-rotate'},\r\n        name: '',\r\n        buttonLabel: '',\r\n        icon: rotateImg,\r\n        webgl: false,\r\n        neededWithWebGL: true,\r\n        updateContext: true,\r\n        updatePos: true,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: false,\r\n    },\r\n    glTiltShift: {\r\n        lang: {name: 'filter-tilt-shift-title', button: 'filter-tilt-shift'},\r\n        name: '',\r\n        buttonLabel: '',\r\n        icon: glTiltShiftImg,\r\n        webgl: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    toAlpha: {\r\n        lang: {name: 'filter-to-alpha-title', button: 'filter-to-alpha'},\r\n        name: '',\r\n        buttonLabel: '',\r\n        icon: toAlphaImg,\r\n        webgl: true,\r\n        updateContext: false,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    transform: {\r\n        lang: {name: 'filter-transform-title', button: 'filter-transform'},\r\n        name: '',\r\n        buttonLabel: '',\r\n        icon: transformImg,\r\n        webgl: false,\r\n        neededWithWebGL: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        ieFails: true,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    glBlur: {\r\n        lang: {name: 'filter-triangle-blur-title', button: 'filter-triangle-blur'},\r\n        name: '',\r\n        buttonLabel: '',\r\n        icon: glBlurImg,\r\n        webgl: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    glUnsharpMask: {\r\n        lang: {name: 'filter-unsharp-mask-title', button: 'filter-unsharp-mask'},\r\n        name: '',\r\n        buttonLabel: '',\r\n        icon: glUnsharpMaskImg,\r\n        webgl: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    }\r\n};\r\n\r\nfunction updateNames() {\r\n    const keys = Object.keys(filterLib);\r\n    keys.forEach(item => {\r\n        filterLib[item].name = LANG(filterLib[item].lang.name);\r\n        filterLib[item].buttonLabel = LANG(filterLib[item].lang.button);\r\n    });\r\n}\r\nupdateNames();\r\n\r\nlanguageStrings.subscribe(() => {\r\n    updateNames();\r\n});","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"5tPq3\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"cazOx\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"245NA\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"1hkCG\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"k2eFf\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"krKGd\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"ehfxY\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"beOjS\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"Gk9bV\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"csed7\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"equSE\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"h1dN3\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"LfAXI\");","import {PenBrush} from './pen-brush';\r\nimport {BlendBrush} from './blend-brush';\r\nimport {SketchyBrush} from './sketchy-brush';\r\nimport {PixelBrush} from './pixel-brush';\r\nimport {EraserBrush} from './eraser-brush';\r\nimport {SmudgeBrush} from './smudge-brush';\r\nimport {ChemyBrush} from './chemy-brush';\r\n\r\nexport const brushes = {\r\n    PenBrush,\r\n    BlendBrush,\r\n    SketchyBrush,\r\n    PixelBrush,\r\n    ChemyBrush,\r\n    SmudgeBrush,\r\n    EraserBrush,\r\n}","import {BB} from '../../bb/bb';\r\nimport {alphaImArr} from './brushes-common';\r\nimport {IHistoryEntry, KlHistoryInterface} from '../history/kl-history';\r\nimport {KL} from '../kl';\r\n\r\n\r\nexport function PenBrush() {\r\n\r\n    let context;\r\n    let history: KlHistoryInterface = new KL.DecoyKlHistory();\r\n    let historyEntry: IHistoryEntry;\r\n\r\n    let settingColor, settingSize = 2, settingSpacing = 0.8489, settingOpacity = 1;\r\n    let settingColorStr;\r\n    let settingHasSizePressure = true, settingHasOpacityPressure = false;\r\n    let settingLockLayerAlpha = false;\r\n    let ALPHA_CIRCLE = 0, ALPHA_CHALK = 1, ALPHA_CAL = 2, ALPHA_SQUARE = 3;\r\n    let settingAlphaId = ALPHA_CIRCLE;\r\n\r\n    let lineToolLastDot;\r\n    let lastInput = {x: 0, y: 0, pressure: 0};\r\n    let lastInput2 = {x: 0, y: 0, pressure: 0};\r\n\r\n    let isDrawing = false;\r\n    let alphaOpacityArr = [1, 0.9, 1, 1];\r\n\r\n    //mipmapping\r\n    let alphaCanvas128 = BB.canvas(128, 128);\r\n    let alphaCanvas64 = BB.canvas(64, 64);\r\n    let alphaCanvas32 = BB.canvas(32, 32);\r\n\r\n    let bezierLine = null;\r\n\r\n    let twoPI = Math.PI * 2;\r\n\r\n    function updateAlphaCanvas() {\r\n        if (settingAlphaId === ALPHA_CIRCLE || settingAlphaId === ALPHA_SQUARE) {\r\n            return;\r\n        }\r\n\r\n        let instructionArr = [\r\n            [alphaCanvas128, 128],\r\n            [alphaCanvas64, 64],\r\n            [alphaCanvas32, 32]\r\n        ];\r\n\r\n        let ctx;\r\n\r\n        for (let i = 0; i < instructionArr.length; i++) {\r\n            ctx = (instructionArr[i][0] as any).getContext(\"2d\");\r\n\r\n            ctx.save();\r\n            ctx.clearRect(0, 0, instructionArr[i][1], instructionArr[i][1]);\r\n\r\n            ctx.fillStyle = \"rgba(\" + settingColor.r + \", \" + settingColor.g + \", \" + settingColor.b + \", \" + alphaOpacityArr[settingAlphaId] + \")\";\r\n            ctx.fillRect(0, 0, instructionArr[i][1], instructionArr[i][1]);\r\n\r\n            ctx.globalCompositeOperation = \"destination-in\";\r\n            ctx.imageSmoothingQuality = 'high';\r\n            ctx.drawImage(alphaImArr[settingAlphaId], 0, 0, instructionArr[i][1], instructionArr[i][1]);\r\n\r\n            ctx.restore();\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     *\r\n     * @param x\r\n     * @param y\r\n     * @param size\r\n     * @param opacity\r\n     * @param angle\r\n     * @param before - [x, y, size, opacity, angle] the drawDot call before\r\n     */\r\n    function drawDot(x, y, size, opacity, angle?, before?) {\r\n        if (size <= 0) {\r\n            return;\r\n        }\r\n\r\n        if (settingLockLayerAlpha) {\r\n            context.globalCompositeOperation = \"source-atop\";\r\n        }\r\n\r\n        if (!before || before[3] !== opacity) {\r\n            context.globalAlpha = opacity;\r\n        }\r\n\r\n        if (!before && (settingAlphaId === ALPHA_CIRCLE || settingAlphaId === ALPHA_SQUARE)) {\r\n            context.fillStyle = settingColorStr;\r\n        }\r\n\r\n        if (settingAlphaId === ALPHA_CIRCLE) {\r\n            context.beginPath();\r\n            context.arc(x, y, size, 0, twoPI);\r\n            context.closePath();\r\n            context.fill();\r\n\r\n        } else if (settingAlphaId === ALPHA_SQUARE) {\r\n            if (angle !== undefined) {\r\n                context.save();\r\n                context.translate(x, y);\r\n                context.rotate(angle / 180 * Math.PI);\r\n                context.fillRect(-size, -size, size * 2, size * 2);\r\n                context.restore();\r\n            }\r\n\r\n        } else { // other brush alphas\r\n            context.save();\r\n            context.translate(x, y);\r\n            let targetMipmap = alphaCanvas128;\r\n            if (size <= 32 && size > 16) {\r\n                targetMipmap = alphaCanvas64;\r\n            } else if (size <= 16) {\r\n                targetMipmap = alphaCanvas32;\r\n            }\r\n            context.scale(size, size);\r\n            if (settingAlphaId === ALPHA_CHALK) {\r\n                context.rotate(((x + y) * 53123) % twoPI); // without mod it sometimes looks different\r\n            }\r\n            context.drawImage(targetMipmap, -1, -1, 2, 2);\r\n\r\n            context.restore();\r\n        }\r\n    }\r\n\r\n    function continueLine(x, y, size, pressure) {\r\n        if (bezierLine === null) {\r\n            bezierLine = new BB.BezierLine();\r\n            bezierLine.add(lastInput.x, lastInput.y, 0, function(){});\r\n        }\r\n\r\n        let drawArr = []; //draw instructions. will be all drawn at once\r\n\r\n        function dotCallback(val) {\r\n            let localPressure = BB.mix(lastInput2.pressure, pressure, val.t);\r\n            let localOpacity = settingOpacity * (settingHasOpacityPressure ? (localPressure * localPressure) : 1);\r\n            let localSize = Math.max(0.1, settingSize * (settingHasSizePressure ? localPressure : 1));\r\n            drawArr.push([val.x, val.y, localSize, localOpacity, val.angle]);\r\n        }\r\n\r\n        let localSpacing = size * settingSpacing;\r\n        if (x === null) {\r\n            bezierLine.addFinal(localSpacing, dotCallback);\r\n        } else {\r\n            bezierLine.add(x, y, localSpacing, dotCallback);\r\n        }\r\n\r\n        // execute draw instructions\r\n        context.save();\r\n        let before;\r\n        for (let i = 0; i < drawArr.length; i++) {\r\n            let item = drawArr[i];\r\n            drawDot(item[0], item[1], item[2], item[3], item[4], before);\r\n            before = item;\r\n        }\r\n        context.restore();\r\n    }\r\n\r\n    //------------------ interface ---------------------------------------------------\r\n\r\n\r\n    this.startLine = function (x, y, p) {\r\n        historyEntry = {\r\n            tool: [\"brush\", \"PenBrush\"],\r\n            actions: []\r\n        };\r\n        historyEntry.actions.push({\r\n            action: \"opacityPressure\",\r\n            params: [settingHasOpacityPressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"sizePressure\",\r\n            params: [settingHasSizePressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSize\",\r\n            params: [settingSize]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSpacing\",\r\n            params: [settingSpacing]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setOpacity\",\r\n            params: [settingOpacity]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setColor\",\r\n            params: [settingColor]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setAlpha\",\r\n            params: [settingAlphaId]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setLockAlpha\",\r\n            params: [settingLockLayerAlpha]\r\n        });\r\n\r\n        p = BB.clamp(p, 0, 1);\r\n        let localOpacity = settingHasOpacityPressure ? (settingOpacity * p * p) : settingOpacity;\r\n        let localSize = settingHasSizePressure ? Math.max(0.1, p * settingSize) : Math.max(0.1, settingSize);\r\n\r\n        isDrawing = true;\r\n        context.save();\r\n        drawDot(x, y, localSize, localOpacity);\r\n        context.restore();\r\n\r\n        lineToolLastDot = localSize * settingSpacing;\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        lastInput.pressure = p;\r\n        lastInput2.pressure = p;\r\n\r\n        historyEntry.actions.push({\r\n            action: \"startLine\",\r\n            params: [x, y, p]\r\n        });\r\n    };\r\n\r\n    this.goLine = function (x, y, p) {\r\n        if (!isDrawing) {\r\n            return;\r\n        }\r\n        historyEntry.actions.push({\r\n            action: \"goLine\",\r\n            params: [x, y, p]\r\n        });\r\n\r\n        let pressure = BB.clamp(p, 0, 1);\r\n        let localSize = settingHasSizePressure ? Math.max(0.1, lastInput.pressure * settingSize) : Math.max(0.1, settingSize);\r\n\r\n        context.save();\r\n        continueLine(x, y, localSize, lastInput.pressure);\r\n\r\n        /*context.fillStyle = 'red';\r\n        context.fillRect(Math.floor(x), Math.floor(y - 10), 1, 20);\r\n        context.fillRect(Math.floor(x - 10), Math.floor(y), 20, 1);*/\r\n\r\n        context.restore();\r\n\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        lastInput2.pressure = lastInput.pressure;\r\n        lastInput.pressure = pressure;\r\n    };\r\n\r\n    this.endLine = function (x, y) {\r\n\r\n        let localSize = settingHasSizePressure ? Math.max(0.1, lastInput.pressure * settingSize) : Math.max(0.1, settingSize);\r\n        context.save();\r\n        continueLine(null, null, localSize, lastInput.pressure);\r\n        context.restore();\r\n\r\n        isDrawing = false;\r\n\r\n        bezierLine = null;\r\n\r\n        if (historyEntry) {\r\n            historyEntry.actions.push({\r\n                action: \"endLine\",\r\n                params: [x, y]\r\n            });\r\n            history.push(historyEntry);\r\n            historyEntry = undefined;\r\n        }\r\n    };\r\n    //cheap n' ugly\r\n    this.drawLineSegment = function (x1, y1, x2, y2) {\r\n        lastInput.x = x2;\r\n        lastInput.y = y2;\r\n        lastInput.pressure = 1;\r\n\r\n        if (isDrawing || x1 === undefined) {\r\n            return;\r\n        }\r\n\r\n        let angle = BB.pointsToAngleDeg({x:x1, y:y1}, {x:x2, y:y2});\r\n        let mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\r\n        let eX = (x2 - x1) / mouseDist;\r\n        let eY = (y2 - y1) / mouseDist;\r\n        let loopDist;\r\n        let bdist = settingSize * settingSpacing;\r\n        lineToolLastDot = settingSize * settingSpacing;\r\n        for (loopDist = lineToolLastDot; loopDist <= mouseDist; loopDist += bdist) {\r\n            drawDot(x1 + eX * loopDist, y1 + eY * loopDist, settingSize, settingOpacity, angle);\r\n        }\r\n\r\n\r\n        let historyEntry = {\r\n            tool: [\"brush\", \"PenBrush\"],\r\n            actions: []\r\n        };\r\n        historyEntry.actions.push({\r\n            action: \"opacityPressure\",\r\n            params: [settingHasOpacityPressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"sizePressure\",\r\n            params: [settingHasSizePressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSize\",\r\n            params: [settingSize]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSpacing\",\r\n            params: [settingSpacing]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setOpacity\",\r\n            params: [settingOpacity]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setColor\",\r\n            params: [settingColor]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setAlpha\",\r\n            params: [settingAlphaId]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setLockAlpha\",\r\n            params: [settingLockLayerAlpha]\r\n        });\r\n\r\n        historyEntry.actions.push({\r\n            action: \"drawLineSegment\",\r\n            params: [x1, y1, x2, y2]\r\n        });\r\n        history.push(historyEntry);\r\n    };\r\n\r\n    //IS\r\n    this.isDrawing = function () {\r\n        return isDrawing;\r\n    };\r\n    //SET\r\n    this.setAlpha = function (a) {\r\n        if (settingAlphaId === a) {\r\n            return;\r\n        }\r\n        settingAlphaId = a;\r\n        updateAlphaCanvas();\r\n    };\r\n    this.setColor = function (c) {\r\n        if (settingColor === c) {\r\n            return;\r\n        }\r\n        settingColor = {r: c.r, g: c.g, b: c.b};\r\n        settingColorStr = \"rgb(\" + settingColor.r + \",\" + settingColor.g + \",\" + settingColor.b + \")\";\r\n        updateAlphaCanvas();\r\n    };\r\n    this.setContext = function (c) {\r\n        context = c;\r\n    };\r\n    this.setHistory = function (l: KlHistoryInterface) {\r\n        history = l;\r\n    };\r\n    this.setSize = function (s) {\r\n        settingSize = s;\r\n    };\r\n    this.setOpacity = function (o) {\r\n        settingOpacity = o;\r\n    };\r\n    this.setSpacing = function (s) {\r\n        settingSpacing = s;\r\n    };\r\n    this.sizePressure = function (b) {\r\n        settingHasSizePressure = b;\r\n    };\r\n    this.opacityPressure = function (b) {\r\n        settingHasOpacityPressure = b;\r\n    };\r\n    this.setLockAlpha = function (b) {\r\n        settingLockLayerAlpha = b;\r\n    };\r\n    //GET\r\n    this.getSpacing = function () {\r\n        return settingSpacing;\r\n    };\r\n    this.getSize = function () {\r\n        return settingSize;\r\n    };\r\n    this.getOpacity = function () {\r\n        return settingOpacity;\r\n    };\r\n    this.getLockAlpha = function (b) {\r\n        return settingLockLayerAlpha;\r\n    };\r\n}","import {genBrushAlpha01, genBrushAlpha02} from './alphas/brush-alphas';\r\n\r\nexport const alphaImArr = []; //used by default brush\r\nalphaImArr[1] = genBrushAlpha01(128);\r\nalphaImArr[2] = genBrushAlpha02(128);","import {BB} from '../../../bb/bb';\r\nimport {noise} from '../../../bb/math/perlin';\r\nimport {IVector2D} from '../../../bb/bb.types';\r\n\r\n// chalk\r\nexport function genBrushAlpha01(w: number): HTMLCanvasElement {\r\n\r\n    const scaleFac = w / 500;\r\n    const h = w;\r\n    const canvas = BB.canvas(w, h);\r\n    const ctx = canvas.getContext('2d');\r\n    const imData = ctx.createImageData(w, h);\r\n    for (let x = 0; x < w; x++) {\r\n        for (let y = 0; y < h; y++) {\r\n            let i = (y * w + x) * 4;\r\n\r\n            // base noise\r\n            const sFac2 = scaleFac + noise.simplex2(x / 50 / scaleFac, y / 50 / scaleFac) * 0.04;\r\n            let noisePattern = 100 + (noise.simplex2(x / 50 / sFac2, y / 50 / sFac2) + 1) / 2 * 100;\r\n            noisePattern -= (noise.simplex2(x / 10 / scaleFac, y / 10 / scaleFac) + 1) / 2 * 100;\r\n\r\n            // fade out in circular shape\r\n            const centerDist = BB.dist(w / 2, h / 2, x, y);\r\n            let falloff = BB.clamp(\r\n                1 - ((centerDist - (w / 2.5)) / (w / 14) + noise.simplex2(x / 22 / sFac2, y / 22 / sFac2)),\r\n                0,\r\n                1);\r\n            noisePattern = noisePattern * falloff;\r\n\r\n            // make the middle darker\r\n            const falloff2 = BB.clamp(1 - centerDist / w, 0, 1) * 2;\r\n            noisePattern = noisePattern * falloff2;\r\n\r\n            imData.data[i] = 0;\r\n            imData.data[i + 1] = 0;\r\n            imData.data[i + 2] = 0;\r\n            imData.data[i + 3] = BB.clamp(noisePattern, 0, 255);\r\n        }\r\n    }\r\n\r\n    ctx.putImageData(imData, 0, 0);\r\n    return canvas;\r\n}\r\n\r\n// https://www.shadertoy.com/view/3tdSDj\r\nfunction udSegment( p: IVector2D, a: IVector2D, b: IVector2D ) {\r\n    let ba = BB.Vec2.sub(b, a);\r\n    let pa = BB.Vec2.sub(p, a);\r\n    let h = BB.clamp( BB.Vec2.dot(pa,ba) / BB.Vec2.dot(ba,ba), 0.0, 1.0 );\r\n    return BB.Vec2.len(BB.Vec2.sub(pa, BB.Vec2.mul(ba, h)));\r\n}\r\n\r\n// calligraphy\r\nexport function genBrushAlpha02(w: number): HTMLCanvasElement {\r\n\r\n    const pDist = 1 / 4;\r\n    let centerSize = 2 / 3;\r\n    let transitionSize = 1 / 3;\r\n    centerSize *= pDist;\r\n    transitionSize *= pDist;\r\n    const p1 = {x: pDist * w, y: w - (w * pDist)};\r\n    const p2 = {x: w - (w * pDist), y: pDist * w};\r\n\r\n    const h = w;\r\n    const canvas = BB.canvas(w, h);\r\n    let ctx = canvas.getContext('2d');\r\n    const imData = ctx.createImageData(w, h);\r\n    for (let x = 0; x < w; x++) {\r\n        for (let y = 0; y < h; y++) {\r\n            const i = (y * w + x) * 4;\r\n\r\n            let col = udSegment({x: x, y: y}, p1, p2);\r\n\r\n            col = BB.clamp(\r\n                255 - ((col - (w * centerSize)) / (w * transitionSize) * 255),\r\n                0,\r\n                255\r\n            );\r\n\r\n            imData.data[i] = 0;\r\n            imData.data[i + 1] = 0;\r\n            imData.data[i + 2] = 0;\r\n            imData.data[i + 3] = col;\r\n        }\r\n    }\r\n\r\n    ctx.putImageData(imData, 0, 0);\r\n    return canvas;\r\n}","/*\r\n * A speed-improved perlin and simplex noise algorithms for 2D.\r\n *\r\n * Based on example code by Stefan Gustavson (stegu@itn.liu.se).\r\n * Optimisations by Peter Eastman (peastman@drizzle.stanford.edu).\r\n * Better rank ordering method by Stefan Gustavson in 2012.\r\n * Converted to Javascript by Joseph Gentle.\r\n *\r\n * Version 2012-03-09\r\n *\r\n * This code was placed in the public domain by its original author,\r\n * Stefan Gustavson. You may use it as you see fit, but\r\n * attribution is appreciated.\r\n *\r\n */\r\n\r\nconst myModule = {} as any;\r\n\r\n\r\nfunction Grad(x, y, z) {\r\n    this.x = x; this.y = y; this.z = z;\r\n}\r\n\r\nGrad.prototype.dot2 = function(x, y) {\r\n    return this.x*x + this.y*y;\r\n};\r\n/*\r\nGrad.prototype.dot3 = function(x, y, z) {\r\n    return this.x*x + this.y*y + this.z*z;\r\n};*/\r\n\r\nlet grad3 = [new Grad(1,1,0),new Grad(-1,1,0),new Grad(1,-1,0),new Grad(-1,-1,0),\r\n    new Grad(1,0,1),new Grad(-1,0,1),new Grad(1,0,-1),new Grad(-1,0,-1),\r\n    new Grad(0,1,1),new Grad(0,-1,1),new Grad(0,1,-1),new Grad(0,-1,-1)];\r\n\r\nlet p = [151,160,137,91,90,15,\r\n    131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,\r\n    190, 6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,\r\n    88,237,149,56,87,174,20,125,136,171,168, 68,175,74,165,71,134,139,48,27,166,\r\n    77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,\r\n    102,143,54, 65,25,63,161, 1,216,80,73,209,76,132,187,208, 89,18,169,200,196,\r\n    135,130,116,188,159,86,164,100,109,198,173,186, 3,64,52,217,226,250,124,123,\r\n    5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,\r\n    223,183,170,213,119,248,152, 2,44,154,163, 70,221,153,101,155,167, 43,172,9,\r\n    129,22,39,253, 19,98,108,110,79,113,224,232,178,185, 112,104,218,246,97,228,\r\n    251,34,242,193,238,210,144,12,191,179,162,241, 81,51,145,235,249,14,239,107,\r\n    49,192,214, 31,181,199,106,157,184, 84,204,176,115,121,50,45,127, 4,150,254,\r\n    138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];\r\n// To remove the need for index wrapping, double the permutation table length\r\nlet perm = new Array(512);\r\nlet gradP = new Array(512);\r\n\r\n// This isn't a very good seeding function, but it works ok. It supports 2^16\r\n// different seed values. Write something better if you need more seeds.\r\nmyModule.seed = function(seed) {\r\n    if (seed > 0 && seed < 1) {\r\n        // Scale the seed out\r\n        seed *= 65536;\r\n    }\r\n\r\n    seed = Math.floor(seed);\r\n    if (seed < 256) {\r\n        seed |= seed << 8;\r\n    }\r\n\r\n    for (let i = 0; i < 256; i++) {\r\n        let v;\r\n        if (i & 1) {\r\n            v = p[i] ^ (seed & 255);\r\n        } else {\r\n            v = p[i] ^ ((seed>>8) & 255);\r\n        }\r\n\r\n        perm[i] = perm[i + 256] = v;\r\n        gradP[i] = gradP[i + 256] = grad3[v % 12];\r\n    }\r\n};\r\n\r\nmyModule.seed(0);\r\n\r\n/*\r\nfor (let i=0; i<256; i++) {\r\n  perm[i] = perm[i + 256] = p[i];\r\n  gradP[i] = gradP[i + 256] = grad3[perm[i] % 12];\r\n}*/\r\n\r\n// Skewing and unskewing factors for 2, 3, and 4 dimensions\r\nlet F2 = 0.5*(Math.sqrt(3)-1);\r\nlet G2 = (3-Math.sqrt(3))/6;\r\n\r\n/*let F3 = 1/3;\r\nlet G3 = 1/6;*/\r\n\r\n// 2D simplex noise\r\nmyModule.simplex2 = function(xin, yin) {\r\n    let n0, n1, n2; // Noise contributions from the three corners\r\n    // Skew the input space to determine which simplex cell we're in\r\n    let s = (xin+yin)*F2; // Hairy factor for 2D\r\n    let i = Math.floor(xin+s);\r\n    let j = Math.floor(yin+s);\r\n    let t = (i+j)*G2;\r\n    let x0 = xin-i+t; // The x,y distances from the cell origin, unskewed.\r\n    let y0 = yin-j+t;\r\n    // For the 2D case, the simplex shape is an equilateral triangle.\r\n    // Determine which simplex we are in.\r\n    let i1, j1; // Offsets for second (middle) corner of simplex in (i,j) coords\r\n    if (x0>y0) { // lower triangle, XY order: (0,0)->(1,0)->(1,1)\r\n        i1=1; j1=0;\r\n    } else {    // upper triangle, YX order: (0,0)->(0,1)->(1,1)\r\n        i1=0; j1=1;\r\n    }\r\n    // A step of (1,0) in (i,j) means a step of (1-c,-c) in (x,y), and\r\n    // a step of (0,1) in (i,j) means a step of (-c,1-c) in (x,y), where\r\n    // c = (3-sqrt(3))/6\r\n    let x1 = x0 - i1 + G2; // Offsets for middle corner in (x,y) unskewed coords\r\n    let y1 = y0 - j1 + G2;\r\n    let x2 = x0 - 1 + 2 * G2; // Offsets for last corner in (x,y) unskewed coords\r\n    let y2 = y0 - 1 + 2 * G2;\r\n    // Work out the hashed gradient indices of the three simplex corners\r\n    i &= 255;\r\n    j &= 255;\r\n    let gi0 = gradP[i+perm[j]];\r\n    let gi1 = gradP[i+i1+perm[j+j1]];\r\n    let gi2 = gradP[i+1+perm[j+1]];\r\n    // Calculate the contribution from the three corners\r\n    let t0 = 0.5 - x0*x0-y0*y0;\r\n    if (t0<0) {\r\n        n0 = 0;\r\n    } else {\r\n        t0 *= t0;\r\n        n0 = t0 * t0 * gi0.dot2(x0, y0);  // (x,y) of grad3 used for 2D gradient\r\n    }\r\n    let t1 = 0.5 - x1*x1-y1*y1;\r\n    if (t1<0) {\r\n        n1 = 0;\r\n    } else {\r\n        t1 *= t1;\r\n        n1 = t1 * t1 * gi1.dot2(x1, y1);\r\n    }\r\n    let t2 = 0.5 - x2*x2-y2*y2;\r\n    if (t2<0) {\r\n        n2 = 0;\r\n    } else {\r\n        t2 *= t2;\r\n        n2 = t2 * t2 * gi2.dot2(x2, y2);\r\n    }\r\n    // Add contributions from each corner to get the final noise value.\r\n    // The result is scaled to return values in the interval [-1,1].\r\n    return 70 * (n0 + n1 + n2);\r\n};\r\n/*\r\n// 3D simplex noise\r\nmyModule.simplex3 = function(xin, yin, zin) {\r\n    let n0, n1, n2, n3; // Noise contributions from the four corners\r\n\r\n    // Skew the input space to determine which simplex cell we're in\r\n    let s = (xin+yin+zin)*F3; // Hairy factor for 2D\r\n    let i = Math.floor(xin+s);\r\n    let j = Math.floor(yin+s);\r\n    let k = Math.floor(zin+s);\r\n\r\n    let t = (i+j+k)*G3;\r\n    let x0 = xin-i+t; // The x,y distances from the cell origin, unskewed.\r\n    let y0 = yin-j+t;\r\n    let z0 = zin-k+t;\r\n\r\n    // For the 3D case, the simplex shape is a slightly irregular tetrahedron.\r\n    // Determine which simplex we are in.\r\n    let i1, j1, k1; // Offsets for second corner of simplex in (i,j,k) coords\r\n    let i2, j2, k2; // Offsets for third corner of simplex in (i,j,k) coords\r\n    if (x0 >= y0) {\r\n        if (y0 >= z0)      { i1=1; j1=0; k1=0; i2=1; j2=1; k2=0; }\r\n        else if (x0 >= z0) { i1=1; j1=0; k1=0; i2=1; j2=0; k2=1; }\r\n        else              { i1=0; j1=0; k1=1; i2=1; j2=0; k2=1; }\r\n    } else {\r\n        if (y0 < z0)      { i1=0; j1=0; k1=1; i2=0; j2=1; k2=1; }\r\n        else if (x0 < z0) { i1=0; j1=1; k1=0; i2=0; j2=1; k2=1; }\r\n        else             { i1=0; j1=1; k1=0; i2=1; j2=1; k2=0; }\r\n    }\r\n    // A step of (1,0,0) in (i,j,k) means a step of (1-c,-c,-c) in (x,y,z),\r\n    // a step of (0,1,0) in (i,j,k) means a step of (-c,1-c,-c) in (x,y,z), and\r\n    // a step of (0,0,1) in (i,j,k) means a step of (-c,-c,1-c) in (x,y,z), where\r\n    // c = 1/6.\r\n    let x1 = x0 - i1 + G3; // Offsets for second corner\r\n    let y1 = y0 - j1 + G3;\r\n    let z1 = z0 - k1 + G3;\r\n\r\n    let x2 = x0 - i2 + 2 * G3; // Offsets for third corner\r\n    let y2 = y0 - j2 + 2 * G3;\r\n    let z2 = z0 - k2 + 2 * G3;\r\n\r\n    let x3 = x0 - 1 + 3 * G3; // Offsets for fourth corner\r\n    let y3 = y0 - 1 + 3 * G3;\r\n    let z3 = z0 - 1 + 3 * G3;\r\n\r\n    // Work out the hashed gradient indices of the four simplex corners\r\n    i &= 255;\r\n    j &= 255;\r\n    k &= 255;\r\n    let gi0 = gradP[i+   perm[j+   perm[k   ]]];\r\n    let gi1 = gradP[i+i1+perm[j+j1+perm[k+k1]]];\r\n    let gi2 = gradP[i+i2+perm[j+j2+perm[k+k2]]];\r\n    let gi3 = gradP[i+ 1+perm[j+ 1+perm[k+ 1]]];\r\n\r\n    // Calculate the contribution from the four corners\r\n    let t0 = 0.6 - x0*x0 - y0*y0 - z0*z0;\r\n    if (t0<0) {\r\n        n0 = 0;\r\n    } else {\r\n        t0 *= t0;\r\n        n0 = t0 * t0 * gi0.dot3(x0, y0, z0);  // (x,y) of grad3 used for 2D gradient\r\n    }\r\n    let t1 = 0.6 - x1*x1 - y1*y1 - z1*z1;\r\n    if (t1<0) {\r\n        n1 = 0;\r\n    } else {\r\n        t1 *= t1;\r\n        n1 = t1 * t1 * gi1.dot3(x1, y1, z1);\r\n    }\r\n    let t2 = 0.6 - x2*x2 - y2*y2 - z2*z2;\r\n    if (t2<0) {\r\n        n2 = 0;\r\n    } else {\r\n        t2 *= t2;\r\n        n2 = t2 * t2 * gi2.dot3(x2, y2, z2);\r\n    }\r\n    let t3 = 0.6 - x3*x3 - y3*y3 - z3*z3;\r\n    if (t3<0) {\r\n        n3 = 0;\r\n    } else {\r\n        t3 *= t3;\r\n        n3 = t3 * t3 * gi3.dot3(x3, y3, z3);\r\n    }\r\n    // Add contributions from each corner to get the final noise value.\r\n    // The result is scaled to return values in the interval [-1,1].\r\n    return 32 * (n0 + n1 + n2 + n3);\r\n\r\n};\r\n*/\r\n// ##### Perlin noise stuff\r\n/*\r\nfunction fade(t) {\r\n    return t*t*t*(t*(t*6-15)+10);\r\n}\r\n\r\nfunction lerp(a, b, t) {\r\n    return (1-t)*a + t*b;\r\n}\r\n\r\n// 2D Perlin Noise\r\nmyModule.perlin2 = function(x, y) {\r\n    // Find unit grid cell containing point\r\n    let X = Math.floor(x), Y = Math.floor(y);\r\n    // Get relative xy coordinates of point within that cell\r\n    x = x - X; y = y - Y;\r\n    // Wrap the integer cells at 255 (smaller integer period can be introduced here)\r\n    X = X & 255; Y = Y & 255;\r\n\r\n    // Calculate noise contributions from each of the four corners\r\n    let n00 = gradP[X+perm[Y]].dot2(x, y);\r\n    let n01 = gradP[X+perm[Y+1]].dot2(x, y-1);\r\n    let n10 = gradP[X+1+perm[Y]].dot2(x-1, y);\r\n    let n11 = gradP[X+1+perm[Y+1]].dot2(x-1, y-1);\r\n\r\n    // Compute the fade curve value for x\r\n    let u = fade(x);\r\n\r\n    // Interpolate the four results\r\n    return lerp(\r\n        lerp(n00, n10, u),\r\n        lerp(n01, n11, u),\r\n        fade(y));\r\n};*/\r\n/*\r\n// 3D Perlin Noise\r\nmyModule.perlin3 = function(x, y, z) {\r\n    // Find unit grid cell containing point\r\n    let X = Math.floor(x), Y = Math.floor(y), Z = Math.floor(z);\r\n    // Get relative xyz coordinates of point within that cell\r\n    x = x - X; y = y - Y; z = z - Z;\r\n    // Wrap the integer cells at 255 (smaller integer period can be introduced here)\r\n    X = X & 255; Y = Y & 255; Z = Z & 255;\r\n\r\n    // Calculate noise contributions from each of the eight corners\r\n    let n000 = gradP[X+  perm[Y+  perm[Z  ]]].dot3(x,   y,     z);\r\n    let n001 = gradP[X+  perm[Y+  perm[Z+1]]].dot3(x,   y,   z-1);\r\n    let n010 = gradP[X+  perm[Y+1+perm[Z  ]]].dot3(x,   y-1,   z);\r\n    let n011 = gradP[X+  perm[Y+1+perm[Z+1]]].dot3(x,   y-1, z-1);\r\n    let n100 = gradP[X+1+perm[Y+  perm[Z  ]]].dot3(x-1,   y,   z);\r\n    let n101 = gradP[X+1+perm[Y+  perm[Z+1]]].dot3(x-1,   y, z-1);\r\n    let n110 = gradP[X+1+perm[Y+1+perm[Z  ]]].dot3(x-1, y-1,   z);\r\n    let n111 = gradP[X+1+perm[Y+1+perm[Z+1]]].dot3(x-1, y-1, z-1);\r\n\r\n    // Compute the fade curve value for x, y, z\r\n    let u = fade(x);\r\n    let v = fade(y);\r\n    let w = fade(z);\r\n\r\n    // Interpolate\r\n    return lerp(\r\n        lerp(\r\n            lerp(n000, n100, u),\r\n            lerp(n001, n101, u), w),\r\n        lerp(\r\n            lerp(n010, n110, u),\r\n            lerp(n011, n111, u), w),\r\n        v);\r\n};*/\r\n\r\nexport const noise = myModule;","import {BB} from '../../bb/bb';\r\nimport {IRGB, IRGBA} from '../kl.types';\r\nimport {IBounds, IPressureInput} from '../../bb/bb.types';\r\nimport {IHistoryEntry, KlHistoryInterface} from '../history/kl-history';\r\n\r\nconst cellSize = 256;\r\n\r\ninterface IDrawBufferItem {\r\n    x: number;\r\n    y: number;\r\n    size: number;\r\n    opacity: number;\r\n    x1: number;\r\n    y1: number;\r\n    x2: number;\r\n    y2: number;\r\n    r: number;\r\n    g: number;\r\n    b: number;\r\n}\r\n\r\n// faster than using BB.clamp somehow (in chrome)\r\nfunction clamp(num, min, max) {\r\n    return num <= min\r\n        ? min\r\n        : num >= max\r\n            ? max\r\n            : num\r\n}\r\n\r\nexport class BlendBrush {\r\n\r\n    private isTesting: boolean = false; // testing mode - context only gets updated when line is finished\r\n\r\n    private context: CanvasRenderingContext2D;\r\n    private color: IRGB;\r\n    private size: number = 29; // radius - 0.5 - 99999\r\n    private opacity: number = 0.6; // 0-1\r\n    private blending: number = 0.65; // 0-1\r\n\r\n    private settingLockLayerAlpha: boolean = false;\r\n    private settingSizePressure: boolean = true;\r\n    private settingOpacityPressure: boolean = false;\r\n\r\n    private blendCol: IRGBA = {r: 0, g: 0, b: 0, a: 1}; // todo docs\r\n    private blendMix: number = 0.45; // todo docs\r\n    private mixr: number; // todo docs\r\n    private mixg: number; // todo docs\r\n    private mixb: number; // todo docs\r\n    private localColOld: IRGBA; // todo docs\r\n\r\n    private isDrawing: boolean = false;\r\n    private lastInput: IPressureInput = {x: 0, y: 0, pressure: 0}; // todo docs\r\n    private lastInput2: IPressureInput = {x: 0, y: 0, pressure: 0}; // todo docs\r\n    private bezierLine: any; // todo type\r\n\r\n    private history: KlHistoryInterface | null;\r\n    private historyEntry: IHistoryEntry;\r\n    private redrawBounds: IBounds;\r\n    private cells: (ImageData | null)[];\r\n    private drawBuffer: IDrawBufferItem[];\r\n\r\n    private updateRedrawBounds (bounds: IBounds): void {\r\n        this.redrawBounds = BB.updateBounds(this.redrawBounds, bounds);\r\n    }\r\n\r\n    private getCellsWidth(): number {\r\n        return Math.ceil(this.context.canvas.width / cellSize);\r\n    }\r\n\r\n    /**\r\n     * draw changed cells (changed by brushstroke) onto context\r\n     * @private\r\n     */\r\n    private drawChangedCells(): void {\r\n        const cells = this.cells.map(item => null);\r\n        const touchedCells = this.getTouchedCells(this.redrawBounds);\r\n        touchedCells.forEach((isTouched, index) => {\r\n            if (isTouched) {\r\n                cells[index] = this.cells[index];\r\n            }\r\n        });\r\n        this.drawCells(cells);\r\n        this.redrawBounds = null;\r\n    }\r\n\r\n    private getTouchedCells(bounds: IBounds): boolean[] {\r\n        const touchedCells = this.cells.map(item => false);\r\n        const cellsW = this.getCellsWidth();\r\n        bounds = {\r\n            x1: Math.floor(bounds.x1 / cellSize),\r\n            y1: Math.floor(bounds.y1 / cellSize),\r\n            x2: Math.floor(bounds.x2 / cellSize),\r\n            y2: Math.floor(bounds.y2 / cellSize),\r\n        };\r\n        for (let i = bounds.x1; i <= bounds.x2; i++) {\r\n            for (let e = bounds.y1; e <= bounds.y2; e++) {\r\n                touchedCells[e * cellsW + i] = true;\r\n            }\r\n        }\r\n        return touchedCells;\r\n    }\r\n\r\n    /**\r\n     * Slice up bounds accordings to cells\r\n     * @param bounds\r\n     * @private\r\n     */\r\n    private sliceBounds(bounds: IBounds): {index: number; bounds: IBounds}[] {\r\n        const cellsW = this.getCellsWidth();\r\n        const result: {index: number; bounds: IBounds}[] = [];\r\n        const touchedCells = this.getTouchedCells(bounds);\r\n\r\n        touchedCells.forEach((cell, i) => {\r\n            if (!cell) {\r\n                return;\r\n            }\r\n\r\n            const cellOffsetX = (i % cellsW) * cellSize;\r\n            const cellOffsetY = Math.floor(i / cellsW) * cellSize;\r\n            const cellWidth = this.cells[i].width;\r\n            const cellHeight = this.cells[i].height;\r\n\r\n            const inCellBounds = {\r\n                x1: Math.max(0, bounds.x1 - cellOffsetX),\r\n                y1: Math.max(0, bounds.y1 - cellOffsetY),\r\n                x2: Math.min(cellWidth - 1, bounds.x2 - cellOffsetX),\r\n                y2: Math.min(cellHeight - 1, bounds.y2 - cellOffsetY),\r\n            }\r\n            if (inCellBounds.x1 > inCellBounds.x2 || inCellBounds.y1 > inCellBounds.y2) {\r\n                return;\r\n            }\r\n            result.push({\r\n                index: i,\r\n                bounds: inCellBounds,\r\n            });\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * update copyImageData. copy over new regions if needed\r\n     */\r\n    private copyFromCanvas(bounds: IBounds) {\r\n        if (!bounds) {\r\n            return;\r\n        }\r\n\r\n        const touchedCells = this.getTouchedCells(bounds);\r\n        const cellsW = this.getCellsWidth();\r\n\r\n        touchedCells.forEach((item, i) => {\r\n            if (!item || this.cells[i]) {\r\n                // not touched, or already copied\r\n                return;\r\n            }\r\n            const x = i % cellsW;\r\n            const y = Math.floor(i / cellsW);\r\n            const w = (Math.min(x * cellSize + cellSize, this.context.canvas.width) - 1) % cellSize + 1;\r\n            const h = (Math.min(y * cellSize + cellSize, this.context.canvas.height) - 1) % cellSize + 1;\r\n\r\n            // temp canvas to prevent main canvas from getting slowed down in chrome\r\n            const tmpCanvas = BB.canvas(w, h);\r\n            const tmpCtx = tmpCanvas.getContext('2d');\r\n            tmpCtx.drawImage(this.context.canvas, -x * cellSize, -y * cellSize);\r\n\r\n            this.cells[i] = tmpCtx.getImageData(0, 0, w, h);\r\n        });\r\n    }\r\n\r\n    private getAverage (x, y, size): IRGBA {\r\n\r\n        size = Math.max(0.5, size * 0.75);\r\n        const x1 = Math.max(0, Math.floor(x - size));\r\n        const y1 = Math.max(0, Math.floor(y - size));\r\n        const x2 = Math.min(this.context.canvas.width - 1, Math.ceil(x + size));\r\n        const y2 = Math.min(this.context.canvas.height - 1, Math.ceil(y + size));\r\n        if (x1 > x2 || y1 > y2) {\r\n            return {\r\n                r: 0,\r\n                g: 0,\r\n                b: 0,\r\n                a: 0,\r\n            };\r\n        }\r\n\r\n        let ar = 0, ag = 0, ab = 0, aa = 0, alpha;\r\n\r\n        const slicedBounds = this.sliceBounds({ x1, y1, x2, y2 });\r\n        slicedBounds.forEach(slice => {\r\n            const width = this.cells[slice.index].width;\r\n            const data = this.cells[slice.index].data;\r\n            const bounds = slice.bounds;\r\n\r\n            for (let i = bounds.y1; i <= bounds.y2; i += 4) {\r\n                for (let e = bounds.x1, e2 = i * width * 4 + bounds.x1 * 4; e <= bounds.x2; e += 4, e2 += 4 * 4) {\r\n                    alpha = data[e2 + 3];\r\n                    ar += data[e2] * alpha;\r\n                    ag += data[e2 + 1] * alpha;\r\n                    ab += data[e2 + 2] * alpha;\r\n                    aa += alpha;\r\n                }\r\n            }\r\n        });\r\n\r\n        if (aa !== 0) {\r\n            ar /= aa;\r\n            ag /= aa;\r\n            ab /= aa;\r\n            aa = Math.min(1, aa);\r\n        }\r\n        return {\r\n            r: ar,\r\n            g: ag,\r\n            b: ab,\r\n            a: aa\r\n        };\r\n    }\r\n\r\n    private prepDot (x: number, y: number, size: number): IBounds {\r\n        size = Math.max(0.5, size);\r\n        let x1 = Math.max(0, Math.floor(x - size));\r\n        let y1 = Math.max(0, Math.floor(y - size));\r\n        let x2 = Math.min(this.context.canvas.width - 1, Math.ceil(x + size));\r\n        let y2 = Math.min(this.context.canvas.height - 1, Math.ceil(y + size));\r\n        if (x1 > x2 || y1 > y2) {\r\n            return null;\r\n        }\r\n        return { x1, y1, x2, y2 };\r\n    }\r\n\r\n    private drawDot (params: IDrawBufferItem): void {\r\n        // array with random numbers. faster than Math.random()\r\n        let randI = 0;\r\n        const randLen = params.size > 30 ? 1024 : 512; // lower lengths lead to noticeable patterns\r\n        const randArr = [];\r\n        for (let i = 0; i < randLen; i++) {\r\n            randArr[i] = (Math.random() - 0.5) / 1.001 + 0.5;\r\n        }\r\n\r\n        // thin lines take more than just 1 sample\r\n        const sampleArr = [8,4,4,4,2,2,2,2,2,2]; // <0.5, 0.5, 1, 1.5, etc.\r\n        const samples = sampleArr[Math.floor(params.size * 2)];\r\n        const samplesSquared: number = samples ? samples * samples : 0;\r\n        const sampleOffsets = [];\r\n        if (samples) {\r\n            let i = 0;\r\n            for (let n = 0; n < samples; n++) {\r\n                for (let m = 0; m < samples; m++, i += 2) {\r\n                    sampleOffsets[i] = (n + 1) / samples; // x offset\r\n                    sampleOffsets[i + 1] = (m + 1) / samples; // y offset\r\n                }\r\n            }\r\n        }\r\n\r\n        const sharpness = Math.pow(params.opacity, 2) * 0.8;\r\n        // to optimize calculations\r\n        const invSharpness = 1 - sharpness;\r\n        const sharpnessSubtrahend = sharpness / invSharpness;\r\n        const sizeSquared = params.size * params.size;\r\n        const distDivisor = sizeSquared * invSharpness / params.opacity;\r\n        const alphaMinuend = (1 + sharpnessSubtrahend) * params.opacity;\r\n\r\n\r\n        const slicedBounds = this.sliceBounds({\r\n            x1: params.x1,\r\n            y1: params.y1,\r\n            x2: params.x2,\r\n            y2: params.y2,\r\n        });\r\n\r\n        const cellsW = this.getCellsWidth();\r\n        slicedBounds.forEach(slice => {\r\n            const cellOffsetX = (slice.index % cellsW) * cellSize;\r\n            const cellOffsetY = Math.floor(slice.index / cellsW) * cellSize;\r\n            const cellWidth = this.cells[slice.index].width;\r\n            const data = this.cells[slice.index].data;\r\n\r\n            // i - y index within cell\r\n            // e - x index within cell\r\n\r\n            // e2 - index in image data\r\n\r\n            // ri - y index within image relative to dot-center\r\n            // re - x index within image relative to dot-center\r\n\r\n            for (let i = slice.bounds.y1, ri = i + cellOffsetY - params.y; i <= slice.bounds.y2; i++, ri++) {\r\n                for (\r\n                    let e = slice.bounds.x1,\r\n                        e2 = i * cellWidth * 4 + slice.bounds.x1 * 4,\r\n                        re = e + cellOffsetX - params.x;\r\n                    e <= slice.bounds.x2;\r\n                    e++,\r\n                        e2 += 4,\r\n                        re++\r\n                ) {\r\n                    // O = over -> brush-dot\r\n                    // U = under -> image\r\n\r\n                    let alphaO = 0;\r\n                    if (samplesSquared) {\r\n                        for (let f = 0; f < sampleOffsets.length; f += 2) {\r\n                            const dist = BB.lenSquared(re + sampleOffsets[f], ri + sampleOffsets[f + 1]);\r\n                            if (dist >= sizeSquared) {\r\n                                continue;\r\n                            }\r\n                            alphaO += clamp(alphaMinuend - dist / distDivisor, 0, params.opacity);\r\n                        }\r\n                        if (!alphaO) {\r\n                            continue;\r\n                        }\r\n                        alphaO /= samplesSquared;\r\n                    } else {\r\n                        // technically needs + 0.5 offset, but not noticeable with large brush\r\n                        const dist = Math.pow(re, 2) + Math.pow(ri, 2);\r\n                        if (dist >= sizeSquared) {\r\n                            continue;\r\n                        }\r\n                        alphaO = clamp(alphaMinuend - dist / distDivisor, 0, params.opacity);\r\n                    }\r\n\r\n                    const invAlphaO = 1 - alphaO;\r\n                    const alphaU =data[e2 + 3] / 255;\r\n\r\n                    if (this.settingLockLayerAlpha) {\r\n                        const underR = (params.r * alphaO) + ((data[e2]) * invAlphaO);\r\n                        const underG = (params.g * alphaO) + ((data[e2 + 1]) * invAlphaO);\r\n                        const underB = (params.b * alphaO) + ((data[e2 + 2]) * invAlphaO);\r\n                        if (alphaU) {\r\n                            data[e2] = Math.floor(underR + randArr[randI]);\r\n                            data[e2 + 1] = Math.floor(underG + randArr[randI]);\r\n                            data[e2 + 2] = Math.floor(underB + randArr[randI]);\r\n                        }\r\n                    } else {\r\n                        const underR = (params.r * alphaO) + ((data[e2] * alphaU) * invAlphaO);\r\n                        const underG = (params.g * alphaO) + ((data[e2 + 1] * alphaU) * invAlphaO);\r\n                        const underB = (params.b * alphaO) + ((data[e2 + 2] * alphaU) * invAlphaO);\r\n\r\n                        let newAlpha = 1 - invAlphaO * (1 - alphaU);\r\n                        data[e2 + 3] = Math.floor(Math.min(255, newAlpha * 255) + 0.5);\r\n                        if (newAlpha) {\r\n                            data[e2] = Math.floor(underR / (newAlpha) + randArr[randI]);\r\n                            data[e2 + 1] = Math.floor(underG / (newAlpha) + randArr[randI]);\r\n                            data[e2 + 2] = Math.floor(underB / (newAlpha) + randArr[randI]);\r\n                        }\r\n                    }\r\n                    randI = (randI + 1) % randLen;\r\n\r\n                }\r\n            }\r\n\r\n        });\r\n    }\r\n\r\n    private calcSpacing (size: number): number {\r\n        return BB.mix(\r\n            (size * 2) / 2, // until size 5.3\r\n            (size * 2) / 9, // at size 24\r\n            BB.clamp((size - 2.7) / (12 - 2.7), 0, 1)\r\n        );\r\n    }\r\n\r\n    private continueLine (x: number, y: number, p: number, isCoalesced: boolean): void {\r\n\r\n        this.drawBuffer = [];\r\n\r\n        let localPressure;\r\n        let localOpacity;\r\n        let localSize = (this.settingSizePressure) ? Math.max(1, p * this.size) : Math.max(1, this.size);\r\n\r\n        let bdist = this.calcSpacing(localSize);\r\n\r\n        let avgX = x;\r\n        let avgY = y;\r\n        if (x === null) {\r\n            avgX = this.lastInput.x;\r\n            avgY = this.lastInput.y;\r\n        }\r\n\r\n        let localColNew;\r\n\r\n        if (this.blending === 0) {\r\n            this.mixr = this.color.r;\r\n            this.mixg = this.color.g;\r\n            this.mixb = this.color.b;\r\n        } else {\r\n            let average;\r\n            if (isCoalesced) {\r\n                average = {r: this.localColOld.r, g: this.localColOld.g, b: this.localColOld.b, a: 0};\r\n            } else {\r\n                const avgParams = [avgX, avgY, ((this.settingSizePressure) ? Math.max(0.5, p * this.size) : Math.max(0.5, this.size))];\r\n                const bounds = this.prepDot(avgParams[0], avgParams[1], avgParams[2]);\r\n                this.copyFromCanvas(bounds);\r\n                average = this.getAverage(avgParams[0], avgParams[1], avgParams[2]);\r\n            }\r\n            localColNew = {r: 0, g: 0, b: 0, a: 0};\r\n\r\n            if (average.a > 0 && this.blendCol.a === 0) {\r\n                this.blendCol.r = average.r;\r\n                this.blendCol.g = average.g;\r\n                this.blendCol.b = average.b;\r\n                this.blendCol.a = average.a;\r\n                localColNew.r = this.blendCol.r;\r\n                localColNew.g = this.blendCol.g;\r\n                localColNew.b = this.blendCol.b;\r\n                localColNew.a = this.blendCol.a;\r\n\r\n            } else {\r\n                if (average.a === 0) {\r\n                    average.r = this.color.r;\r\n                    average.g = this.color.g;\r\n                    average.b = this.color.b;\r\n                    average.a = 1 - this.blending;\r\n                }\r\n\r\n                this.blendCol.r = BB.mix(this.blendCol.r, BB.mix(this.blendCol.r, average.r, this.blendMix), average.a);\r\n                this.blendCol.g = BB.mix(this.blendCol.g, BB.mix(this.blendCol.g, average.g, this.blendMix), average.a);\r\n                this.blendCol.b = BB.mix(this.blendCol.b, BB.mix(this.blendCol.b, average.b, this.blendMix), average.a);\r\n                this.blendCol.a = Math.min(1, this.blendCol.a + average.a);\r\n                localColNew.r = this.blendCol.r;\r\n                localColNew.g = this.blendCol.g;\r\n                localColNew.b = this.blendCol.b;\r\n                localColNew.a = this.blendCol.a;\r\n            }\r\n\r\n        }\r\n\r\n\r\n        const bezierCallback = (val) => {\r\n            if (this.blending >= 1 && this.blendCol.a <= 0) {\r\n                return;\r\n            }\r\n            let factor = val.t;\r\n            localPressure = this.lastInput2.pressure * (1 - factor) + p * factor;\r\n            localOpacity = (this.settingOpacityPressure) ? (this.opacity * localPressure * localPressure) : this.opacity;\r\n            localSize = (this.settingSizePressure) ? Math.max(0.1, localPressure * this.size) : Math.max(0.1, this.size);\r\n            if (this.blending != 0) {\r\n                this.mixr = BB.mix(this.localColOld.r, localColNew.r, factor);\r\n                this.mixg = BB.mix(this.localColOld.g, localColNew.g, factor);\r\n                this.mixb = BB.mix(this.localColOld.b, localColNew.b, factor);\r\n            }\r\n            if (this.blending === 1 && this.localColOld.a === 0) {\r\n                this.mixr = localColNew.r;\r\n                this.mixg = localColNew.g;\r\n                this.mixb = localColNew.b;\r\n            }\r\n            const bounds = this.prepDot(val.x, val.y, localSize);\r\n            if (bounds) {\r\n                this.updateRedrawBounds(bounds);\r\n                this.drawBuffer.push({\r\n                    x: val.x,\r\n                    y: val.y,\r\n                    size: localSize,\r\n                    opacity: localOpacity,\r\n                    x1: bounds.x1,\r\n                    y1: bounds.y1,\r\n                    x2: bounds.x2,\r\n                    y2: bounds.y2,\r\n                    r: BB.mix(this.color.r, this.mixr, this.blending),\r\n                    g: BB.mix(this.color.g, this.mixg, this.blending),\r\n                    b: BB.mix(this.color.b, this.mixb, this.blending),\r\n                })\r\n            }\r\n        };\r\n\r\n        if (x === null) {\r\n            this.bezierLine.addFinal(bdist, bezierCallback);\r\n        } else {\r\n            this.bezierLine.add(x, y, bdist, bezierCallback);\r\n        }\r\n\r\n        this.copyFromCanvas(this.redrawBounds);\r\n        this.drawBuffer.forEach(item => {\r\n            this.drawDot(item);\r\n        });\r\n        this.drawBuffer = [];\r\n\r\n        this.localColOld = localColNew;\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    // --- public ----\r\n    constructor () {\r\n    }\r\n\r\n    setHistory (h: KlHistoryInterface): void {\r\n        this.history = h;\r\n    }\r\n\r\n    getSize (): number {\r\n        return this.size;\r\n    }\r\n\r\n    setSize (s: number): void {\r\n        this.size = s;\r\n    }\r\n\r\n    getOpacity (): number {\r\n        return this.opacity;\r\n    }\r\n\r\n    setOpacity (o: number): void {\r\n        this.opacity = o;\r\n    }\r\n\r\n    getBlending (): number {\r\n        return this.blending;\r\n    }\r\n\r\n    setBlending (b: number) {\r\n        this.blending = b;\r\n    }\r\n\r\n    setColor (c: IRGB): void {\r\n        this.color = BB.copyObj(c);\r\n    }\r\n\r\n    setContext (c: CanvasRenderingContext2D) {\r\n        this.context = c;\r\n    }\r\n\r\n    setSizePressure (b: boolean): void {\r\n        this.settingSizePressure = !!b;\r\n    }\r\n\r\n    setOpacityPressure (b: boolean): void {\r\n        this.settingOpacityPressure = !!b;\r\n    }\r\n\r\n    getLockAlpha (): boolean {\r\n        return this.settingLockLayerAlpha;\r\n    }\r\n\r\n    setLockAlpha (b: boolean): void {\r\n        this.settingLockLayerAlpha = !!b;\r\n    }\r\n\r\n    getIsDrawing (): boolean {\r\n        return this.isDrawing;\r\n    }\r\n\r\n    setIsTesting (b: boolean): void {\r\n        this.isTesting = !!b;\r\n    }\r\n\r\n    startLine (x: number, y: number, p: number): void {\r\n        this.historyEntry = {\r\n            tool: [\"brush\", \"BlendBrush\"],\r\n            actions: []\r\n        };\r\n\r\n\r\n        const totalCells = Math.ceil(this.context.canvas.width / cellSize) * Math.ceil(this.context.canvas.height / cellSize);\r\n        this.cells = '0'.repeat(totalCells).split('').map(item => null);\r\n\r\n        this.isDrawing = true;\r\n\r\n        p = Math.max(0, Math.min(1, p));\r\n        let localOpacity = (this.settingOpacityPressure) ? (this.opacity * p * p) : this.opacity;\r\n        let localSize = (this.settingSizePressure) ? Math.max(0.1, p * this.size) : Math.max(0.1, this.size);\r\n        if (this.blending === 0) {\r\n            this.mixr = this.color.r;\r\n            this.mixg = this.color.g;\r\n            this.mixb = this.color.b;\r\n        } else {\r\n            this.copyFromCanvas(this.prepDot(x, y, localSize));\r\n\r\n            let average = this.getAverage(\r\n                x,\r\n                y,\r\n                ((this.settingSizePressure) ? Math.max(0.1, p * this.size) : Math.max(0.1, this.size))\r\n            );\r\n            if (average.a === 0) {\r\n                this.blendCol = {\r\n                    r: this.color.r,\r\n                    g: this.color.g,\r\n                    b: this.color.b,\r\n                    a: 1 - this.blending,\r\n                };\r\n            } else {\r\n                this.blendCol = {\r\n                    r: average.r,\r\n                    g: average.g,\r\n                    b: average.b,\r\n                    a: average.a,\r\n                };\r\n            }\r\n\r\n            this.mixr = this.blendCol.r;\r\n            this.mixg = this.blendCol.g;\r\n            this.mixb = this.blendCol.b;\r\n        }\r\n\r\n        this.localColOld = {r: this.mixr, g: this.mixg, b: this.mixb, a: this.blendCol.a};\r\n\r\n        this.redrawBounds = null;\r\n        this.drawBuffer = [];\r\n\r\n        if (this.blending < 1 || this.blendCol.a > 0) {\r\n            const bounds = this.prepDot(x, y, localSize);\r\n            if (bounds) {\r\n                this.updateRedrawBounds(bounds);\r\n                this.drawBuffer.push({\r\n                    x: x,\r\n                    y: y,\r\n                    size: localSize,\r\n                    opacity: localOpacity,\r\n                    x1: bounds.x1,\r\n                    y1: bounds.y1,\r\n                    x2: bounds.x2,\r\n                    y2: bounds.y2,\r\n                    r: BB.mix(this.color.r, this.mixr, this.blending),\r\n                    g: BB.mix(this.color.g, this.mixg, this.blending),\r\n                    b: BB.mix(this.color.b, this.mixb, this.blending),\r\n                })\r\n            }\r\n        }\r\n\r\n        this.copyFromCanvas(this.redrawBounds);\r\n        this.drawBuffer.forEach(item => {\r\n            this.drawDot(item);\r\n        });\r\n        this.drawBuffer = [];\r\n\r\n        this.bezierLine = new BB.BezierLine();\r\n        this.bezierLine.add(x, y, 0, function () {\r\n        });\r\n\r\n        this.lastInput.x = x;\r\n        this.lastInput.y = y;\r\n        this.lastInput.pressure = p;\r\n        this.lastInput2 = BB.copyObj(this.lastInput);\r\n\r\n        if (this.redrawBounds && !this.isTesting) {\r\n            this.drawChangedCells();\r\n        }\r\n    }\r\n\r\n    goLine (x: number, y: number, p: number, isCoalesced: boolean): void {\r\n        if (!this.isDrawing) {\r\n            return;\r\n        }\r\n        this.continueLine(x, y, this.lastInput.pressure, isCoalesced);\r\n\r\n        this.lastInput2 = BB.copyObj(this.lastInput);\r\n        this.lastInput.x = x;\r\n        this.lastInput.y = y;\r\n        this.lastInput.pressure = p;\r\n\r\n        if (this.redrawBounds && !this.isTesting) {\r\n            this.drawChangedCells();\r\n        }\r\n    }\r\n\r\n    endLine (): void {\r\n        if (this.bezierLine) {\r\n            this.continueLine(null, null, this.lastInput.pressure, false);\r\n        }\r\n\r\n        this.isDrawing = false;\r\n        this.bezierLine = null;\r\n\r\n        if (this.redrawBounds) {\r\n            this.drawChangedCells();\r\n        }\r\n\r\n        if (this.historyEntry && this.history && this.cells.find(item => !!item)) {\r\n            this.historyEntry.actions.push({\r\n                action: \"drawCells\",\r\n                params: [this.cells],\r\n            });\r\n            this.history.push(this.historyEntry);\r\n            this.historyEntry = null;\r\n        }\r\n        this.cells = null;\r\n    }\r\n\r\n    /**\r\n     * draw cells onto context\r\n     * @param cells\r\n     */\r\n    drawCells (cells: (ImageData | null)[]): void {\r\n        const cellsW = this.getCellsWidth();\r\n        cells.forEach((imageData, index) => {\r\n            if (!imageData) {\r\n                return;\r\n            }\r\n            const cellOffsetX = (index % cellsW) * cellSize;\r\n            const cellOffsetY = Math.floor(index / cellsW) * cellSize;\r\n            this.context.putImageData(imageData, cellOffsetX, cellOffsetY);\r\n        });\r\n    }\r\n\r\n    drawLineSegment (x1: number, y1: number, x2: number, y2: number): void {\r\n        this.lastInput.x = x2;\r\n        this.lastInput.y = y2;\r\n\r\n        if (this.isDrawing || x1 === undefined) {\r\n            return;\r\n        }\r\n\r\n        const totalCells = Math.ceil(this.context.canvas.width / cellSize) * Math.ceil(this.context.canvas.height / cellSize);\r\n        this.cells = '0'.repeat(totalCells).split('').map(item => null);\r\n        this.redrawBounds = null;\r\n        this.drawBuffer = [];\r\n\r\n        this.copyFromCanvas(this.prepDot(x1, y1, Math.max(0.1, this.size)));\r\n        let average = this.getAverage(x1, y1, Math.max(0.1, this.size));\r\n\r\n        if (average.a === 0) {\r\n            this.blendCol = {\r\n                r: this.color.r,\r\n                g: this.color.g,\r\n                b: this.color.b,\r\n                a: 1 - this.blending,\r\n            };\r\n        } else {\r\n            this.blendCol = {\r\n                r: average.r,\r\n                g: average.g,\r\n                b: average.b,\r\n                a: average.a,\r\n            };\r\n        }\r\n\r\n        this.mixr = this.color.r * (1 - this.blendCol.a) + (this.blending * this.blendCol.r + this.color.r * (1 - this.blending)) * this.blendCol.a;\r\n        this.mixg = this.color.g * (1 - this.blendCol.a) + (this.blending * this.blendCol.g + this.color.g * (1 - this.blending)) * this.blendCol.a;\r\n        this.mixb = this.color.b * (1 - this.blendCol.a) + (this.blending * this.blendCol.b + this.color.b * (1 - this.blending)) * this.blendCol.a;\r\n\r\n\r\n        const p = 1;\r\n        const localOpacity = (this.settingOpacityPressure) ? (this.opacity * p * p) : this.opacity;\r\n        const localSize = (this.settingSizePressure) ? Math.max(0.1, p * this.size) : Math.max(0.1, this.size);\r\n\r\n\r\n        const mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\r\n        const eX = (x2 - x1) / mouseDist;\r\n        const eY = (y2 - y1) / mouseDist;\r\n        const bdist = this.calcSpacing(localSize);\r\n        for (let loopDist = 0; loopDist <= mouseDist; loopDist += bdist) {\r\n            const bounds = this.prepDot(x1 + eX * loopDist, y1 + eY * loopDist, localSize);\r\n            if (bounds) {\r\n                this.copyFromCanvas(bounds);\r\n                this.drawBuffer.push({\r\n                    x: x1 + eX * loopDist,\r\n                    y: y1 + eY * loopDist,\r\n                    size: localSize,\r\n                    opacity: localOpacity,\r\n                    x1: bounds.x1,\r\n                    y1: bounds.y1,\r\n                    x2: bounds.x2,\r\n                    y2: bounds.y2,\r\n                    r: BB.mix(this.color.r, this.mixr, this.blending),\r\n                    g: BB.mix(this.color.g, this.mixg, this.blending),\r\n                    b: BB.mix(this.color.b, this.mixb, this.blending),\r\n                })\r\n            }\r\n        }\r\n        this.drawBuffer.forEach(item => {\r\n            this.drawDot(item);\r\n        });\r\n        this.drawBuffer = [];\r\n\r\n        if (this.history && this.cells.find(item => !!item)) {\r\n            this.drawCells(this.cells);\r\n            this.historyEntry = {\r\n                tool: [\"brush\", \"BlendBrush\"],\r\n                actions: [{\r\n                    action: \"drawCells\",\r\n                    params: [this.cells],\r\n                }],\r\n            };\r\n            this.history.push(this.historyEntry);\r\n            this.historyEntry = null;\r\n        }\r\n        this.cells = null;\r\n    }\r\n}\r\n","import {BB} from '../../bb/bb';\r\nimport {IHistoryEntry, KlHistoryInterface} from '../history/kl-history';\r\nimport {KL} from '../kl';\r\n\r\nconst sampleCanvas = BB.canvas(32, 32);\r\nconst sampleCtx = sampleCanvas.getContext('2d');\r\n\r\nexport function SketchyBrush() {\r\n    let context;\r\n    let settingColor;\r\n\r\n    let settingSize = 1, settingOpacity = 0.2;\r\n    let settingBlending = 0.5;\r\n    let settingScale = 1;\r\n\r\n    let lastX, lastY;\r\n    let isDrawing = false;\r\n    let lastInput = {x: 0, y: 0, pressure: 0};\r\n    let history: KlHistoryInterface = new KL.DecoyKlHistory();\r\n    let historyEntry: IHistoryEntry;\r\n    let sketchySeed = 0;\r\n    this.setHistory = function (l: KlHistoryInterface) {\r\n        history = l;\r\n    };\r\n    this.setSeed = function (s) {\r\n        sketchySeed = parseInt(s);\r\n    };\r\n    this.getSeed = function () {\r\n        return parseInt('' + sketchySeed);\r\n    };\r\n\r\n    function rand() {\r\n        sketchySeed++;\r\n        return Math.sin(6324634.2345 * Math.cos(sketchySeed * 5342.3423)) * 0.5 + 0.5;\r\n    }\r\n\r\n    let points = [];\r\n    let count = 0;\r\n    let mixmode = [\r\n        function (c1, c2) {\r\n            return c1;\r\n        },\r\n        function (c1, c2) {\r\n            let result = new BB.RGB(c1.r, c1.g, c1.b);\r\n            result.r *= c2.r / 255;\r\n            result.g *= c2.g / 255;\r\n            result.b *= c2.b / 255;\r\n            return result;\r\n        },\r\n        function (c1, c2) {\r\n            let result = new BB.RGB(c1.r, c1.g, c1.b);\r\n            result.r *= c2.r / 255;\r\n            result.g *= c2.g / 255;\r\n            result.b *= c2.b / 255;\r\n            return result;\r\n        }\r\n    ];\r\n\r\n    this.getSize = function () {\r\n        return settingSize / 2;\r\n    };\r\n    this.setColor = function (c) {\r\n        settingColor = c;\r\n    };\r\n    this.getOpacity = function () {\r\n        return settingOpacity;\r\n    };\r\n    this.setOpacity = function (o) {\r\n        settingOpacity = o;\r\n    };\r\n    this.getBlending = function () {\r\n        return settingBlending;\r\n    };\r\n    this.setBlending = function (b) {\r\n        settingBlending = b;\r\n    };\r\n    this.setSize = function (s) {\r\n        settingSize = s * 2;\r\n    };\r\n    this.getScale = function () {\r\n        return settingScale;\r\n    };\r\n    this.setScale = function (s) {\r\n        settingScale = s;\r\n    };\r\n    this.setContext = function (c) {\r\n        context = c;\r\n    };\r\n    this.startLine = function (x, y, pressure, shift) {\r\n        if (shift && lastInput.x) {\r\n            let lx = lastInput.x, ly = lastInput.y;\r\n            isDrawing = true;\r\n            //this.goLine(x,y,pressure);\r\n            this.endLine();\r\n        } else {\r\n            isDrawing = true;\r\n            lastX = x;\r\n            lastY = y;\r\n            lastInput.x = x;\r\n            lastInput.y = y;\r\n            historyEntry = {\r\n                tool: [\"brush\", \"SketchyBrush\"],\r\n                actions: []\r\n            };\r\n            historyEntry.actions.push({\r\n                action: \"setScale\",\r\n                params: [settingScale]\r\n            });\r\n            historyEntry.actions.push({\r\n                action: \"setSize\",\r\n                params: [settingSize / 2]\r\n            });\r\n            historyEntry.actions.push({\r\n                action: \"setOpacity\",\r\n                params: [settingOpacity]\r\n            });\r\n            historyEntry.actions.push({\r\n                action: \"setColor\",\r\n                params: [settingColor]\r\n            });\r\n            historyEntry.actions.push({\r\n                action: \"setBlending\",\r\n                params: [settingBlending]\r\n            });\r\n            historyEntry.actions.push({\r\n                action: \"startLine\",\r\n                params: [x, y, pressure]\r\n            });\r\n        }\r\n\r\n    };\r\n    this.goLine = function (p_x, p_y, pressure, preMixedColor) {\r\n        if (!isDrawing || (p_x === lastInput.x && p_y === lastInput.y)) {\r\n            return;\r\n        }\r\n\r\n        let e, b, a, g;\r\n        let x = parseInt(p_x);\r\n        let y = parseInt(p_y);\r\n        points.push([x, y]);\r\n\r\n        let mixr = settingColor.r;\r\n        let mixg = settingColor.g;\r\n        let mixb = settingColor.b;\r\n\r\n        if (preMixedColor !== null) {\r\n            mixr = preMixedColor.r;\r\n            mixg = preMixedColor.g;\r\n            mixb = preMixedColor.b;\r\n        } else {\r\n            if (settingBlending !== 0) {\r\n                if (x + 5 >= 0 && y + 5 >= 0 && x - 5 < context.canvas.width - 1 && y - 5 < context.canvas.height - 1) {\r\n                    mixr = 0;\r\n                    mixg = 0;\r\n                    mixb = 0;\r\n                    let mixx = Math.min(context.canvas.width - 1, Math.max(0, x - 5));\r\n                    let mixy = Math.min(context.canvas.height - 1, Math.max(0, y - 5));\r\n                    let mixw = Math.min(context.canvas.width - 1, Math.max(0, x + 5));\r\n                    let mixh = Math.min(context.canvas.height - 1, Math.max(0, y + 5));\r\n                    mixw -= mixx;\r\n                    mixh -= mixy;\r\n\r\n                    if (mixw > 0 && mixh > 0) {\r\n                        let imdat = context.getImageData(mixx, mixy, mixw, mixh);\r\n                        let countmix = 0;\r\n                        for (let i = 0; i < imdat.data.length; i += 4) {\r\n                            mixr += imdat.data[i + 0];\r\n                            mixg += imdat.data[i + 1];\r\n                            mixb += imdat.data[i + 2];\r\n                            countmix++;\r\n                        }\r\n                        mixr /= countmix;\r\n                        mixg /= countmix;\r\n                        mixb /= countmix;\r\n                    }\r\n\r\n                    let mixed = mixmode[0](new BB.RGB(mixr, mixg, mixb), settingColor);\r\n                    mixr = parseInt('' + BB.mix(settingColor.r, mixed.r, settingBlending));\r\n                    mixg = parseInt('' + BB.mix(settingColor.g, mixed.g, settingBlending));\r\n                    mixb = parseInt('' + BB.mix(settingColor.b, mixed.b, settingBlending));\r\n                }\r\n            }\r\n        }\r\n\r\n        context.save();\r\n        context.strokeStyle = \"rgba(\" + mixr + \", \" + mixg + \", \" + mixb + \", \" + settingOpacity + \")\";\r\n        context.lineWidth = settingSize;\r\n\r\n        context.beginPath();\r\n        context.moveTo(lastX, lastY);\r\n        context.lineTo(x, y);\r\n\r\n        for (e = 0; e < points.length; e++) {\r\n            b = points[e][0] - points[count][0];\r\n            a = points[e][1] - points[count][1];\r\n            g = b * b + a * a;\r\n            if (g < 4000 * settingScale * settingScale && rand() > g / 2000 / settingScale / settingScale) {\r\n                context.moveTo(points[count][0] + (b * 0.3), points[count][1] + (a * 0.3));\r\n                context.lineTo(points[e][0] - (b * 0.3), points[e][1] - (a * 0.3));\r\n            }\r\n        }\r\n\r\n        context.stroke();\r\n        context.restore();\r\n\r\n\r\n        count++;\r\n        lastX = x;\r\n        lastY = y;\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        historyEntry.actions.push({\r\n            action: \"goLine\",\r\n            params: [p_x, p_y, pressure, {r: mixr, g: mixg, b: mixb}]\r\n        });\r\n    };\r\n    this.endLine = function () {\r\n        isDrawing = false;\r\n        count = 0;\r\n        points = [];\r\n        if (historyEntry) {\r\n            historyEntry.actions.push({\r\n                action: \"endLine\",\r\n                params: []\r\n            });\r\n            history.push(historyEntry);\r\n            historyEntry = undefined;\r\n        }\r\n    };\r\n    //cheap n' ugly\r\n    this.drawLineSegment = function (x1, y1, x2, y2) {\r\n        lastInput.x = x2;\r\n        lastInput.y = y2;\r\n\r\n        if (isDrawing || x1 === undefined) {\r\n            return;\r\n        }\r\n\r\n\r\n        context.save();\r\n        context.lineWidth = settingSize;\r\n\r\n        let mixr = settingColor.r, mixg = settingColor.g, mixb = settingColor.b;\r\n        if (x1 + 5 >= 0 && y1 + 5 >= 0 && x1 - 5 < context.canvas.width - 1 && y1 - 5 < context.canvas.height - 1) {\r\n            mixr = 0;\r\n            mixg = 0;\r\n            mixb = 0;\r\n            let mixx = Math.min(context.canvas.width - 1, Math.max(0, x1 - 5));\r\n            let mixy = Math.min(context.canvas.height - 1, Math.max(0, y1 - 5));\r\n            let mixw = Math.min(context.canvas.width - 1, Math.max(0, x1 + 5));\r\n            let mixh = Math.min(context.canvas.height - 1, Math.max(0, y1 + 5));\r\n            mixw -= mixx;\r\n            mixh -= mixy;\r\n            if (mixw > 0 && mixh > 0) {\r\n                let w = Math.min(sampleCanvas.width, mixw);\r\n                let h = Math.min(sampleCanvas.height, mixh);\r\n                sampleCtx.save();\r\n                sampleCtx.globalCompositeOperation = 'copy';\r\n                sampleCtx.drawImage(context.canvas, mixx, mixy, mixw, mixh, 0, 0, w, h);\r\n                sampleCtx.restore();\r\n\r\n                let imdat = sampleCtx.getImageData(mixx, mixy, mixw, mixh);\r\n                let countmix = 0;\r\n                for (let i = 0; i < imdat.data.length; i += 4) {\r\n                    mixr += imdat.data[i + 0];\r\n                    mixg += imdat.data[i + 1];\r\n                    mixb += imdat.data[i + 2];\r\n                    countmix++;\r\n                }\r\n                mixr /= countmix;\r\n                mixg /= countmix;\r\n                mixb /= countmix;\r\n            }\r\n        }\r\n        let mixed = mixmode[0](new BB.RGB(mixr, mixg, mixb), settingColor);\r\n        mixr = parseInt('' + (settingBlending * mixed.r + settingColor.r * (1 - settingBlending)));\r\n        mixg = parseInt('' + (settingBlending * mixed.g + settingColor.g * (1 - settingBlending)));\r\n        mixb = parseInt('' + (settingBlending * mixed.b + settingColor.b * (1 - settingBlending)));\r\n        context.strokeStyle = \"rgba(\" + mixr + \", \" + mixg + \", \" + mixb + \", \" + settingOpacity + \")\";\r\n        context.beginPath();\r\n        context.moveTo(x1, y1);\r\n        context.lineTo(x2, y2);\r\n        context.stroke();\r\n        context.strokeStyle = \"rgba(\" + mixr + \", \" + mixg + \", \" + mixb + \", \" + settingOpacity + \")\";\r\n        context.restore();\r\n\r\n\r\n        let historyEntry = {\r\n            tool: [\"brush\", \"SketchyBrush\"],\r\n            actions: []\r\n        };\r\n        historyEntry.actions.push({\r\n            action: \"setScale\",\r\n            params: [settingScale]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSize\",\r\n            params: [settingSize / 2]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setOpacity\",\r\n            params: [settingOpacity]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setColor\",\r\n            params: [settingColor]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setBlending\",\r\n            params: [settingBlending]\r\n        });\r\n\r\n        historyEntry.actions.push({\r\n            action: \"drawLineSegment\",\r\n            params: [x1, y1, x2, y2]\r\n        });\r\n        history.push(historyEntry);\r\n    };\r\n\r\n    this.isDrawing = function () {\r\n        return isDrawing;\r\n    };\r\n}","import {BB} from '../../bb/bb';\r\nimport {IHistoryEntry, KlHistoryInterface} from '../history/kl-history';\r\nimport {KL} from '../kl';\r\n\r\nexport function PixelBrush() {\r\n\r\n    let context;\r\n    let history: KlHistoryInterface = new KL.DecoyKlHistory();\r\n    let historyEntry: IHistoryEntry;\r\n\r\n    let settingColor, settingSize = 0.5, settingSpacing = 0.9, settingOpacity = 1;\r\n    let settingColorStr;\r\n    let settingHasSizePressure = true, settingHasOpacityPressure = false;\r\n    let settingLockLayerAlpha = false;\r\n    let settingIsEraser = false;\r\n    let settingUseDither = true;\r\n\r\n    let lineToolLastDot;\r\n    let lastInput = {x: 0, y: 0, pressure: 0};\r\n    let lastInput2 = {x: 0, y: 0, pressure: 0};\r\n\r\n    let isDrawing = false;\r\n    let bezierLine = null;\r\n    let twoPI = Math.PI * 2;\r\n\r\n\r\n    let ditherCanvas = BB.canvas(4, 4);\r\n    let ditherCtx = ditherCanvas.getContext('2d');\r\n    let ditherPattern;\r\n    let ditherArr = [\r\n        [3, 2],\r\n        [1, 0],\r\n        [3, 0],\r\n        [1, 2],\r\n        [2, 1],\r\n        [0, 3],\r\n        [0, 1],\r\n        [2, 3],\r\n\r\n        [2, 0],\r\n        [0, 2],\r\n        [0, 0],\r\n        [2, 2],\r\n        [1, 1],\r\n        [3, 3],\r\n        [3, 1],\r\n        [1, 3]\r\n    ];\r\n\r\n    function updateDither() {\r\n        ditherCtx.clearRect(0, 0, 4, 4);\r\n        ditherCtx.fillStyle = settingIsEraser ? '#fff' : settingColorStr;\r\n        for (let i = 0; i < Math.max(1, Math.round(settingOpacity * ditherArr.length)); i++) {\r\n            ditherCtx.fillRect(ditherArr[i][0], ditherArr[i][1], 1, 1);\r\n        }\r\n        ditherPattern = context.createPattern(ditherCanvas, 'repeat');\r\n    }\r\n\r\n\r\n    /**\r\n     * Tests p1->p2 or p3->p4 deviate in their direction more than max, compared to p1->p4\r\n     * @param p1\r\n     * @param p2\r\n     * @param p3\r\n     * @param p4\r\n     * @param maxAngleRad\r\n     */\r\n    function cubicCurveOverThreshold(p1, p2, p3, p4, max) {\r\n        let d = BB.Vec2.nor({\r\n            x: p4.x - p1.x,\r\n            y: p4.y - p1.y\r\n        });\r\n        let d2 = BB.Vec2.nor({\r\n            x: p2.x - p1.x,\r\n            y: p2.y - p1.y\r\n        });\r\n        let d3 = BB.Vec2.nor({\r\n            x: p4.x - p3.x,\r\n            y: p4.y - p3.y\r\n        });\r\n        let a2 = Math.abs(BB.Vec2.angle(d, d2) % Math.PI) / Math.PI * 180;\r\n        let a3 = Math.abs(BB.Vec2.angle(d, d3) % Math.PI) / Math.PI * 180;\r\n\r\n        return Math.max(BB.Vec2.dist(d, d2), BB.Vec2.dist(d, d3)) > max;\r\n    }\r\n\r\n    //bresenheim line drawing\r\n    function plotLine(x0, y0, x1, y1, skipFirst) {\r\n        context.save();\r\n\r\n        if (settingIsEraser) {\r\n            context.fillStyle = settingUseDither ? ditherPattern : '#fff';\r\n            if (settingLockLayerAlpha) {\r\n                context.globalCompositeOperation = \"source-atop\";\r\n            } else {\r\n                context.globalCompositeOperation = \"destination-out\";\r\n            }\r\n        } else {\r\n            context.fillStyle = settingUseDither ? ditherPattern : settingColorStr;\r\n            if (settingLockLayerAlpha) {\r\n                context.globalCompositeOperation = \"source-atop\";\r\n            }\r\n        }\r\n        context.globalAlpha = settingUseDither ? 1 : settingOpacity;\r\n\r\n        x0 = Math.floor(x0);\r\n        y0 = Math.floor(y0);\r\n        x1 = Math.floor(x1);\r\n        y1 = Math.floor(y1);\r\n\r\n        let dX = Math.abs(x1 - x0);\r\n        let sX = x0 < x1 ? 1 : -1;\r\n        let dY = -Math.abs(y1 - y0);\r\n        let sY = y0 < y1 ? 1 : -1;\r\n        let err = dX + dY;\r\n        while (true) {\r\n            if (skipFirst) {\r\n                skipFirst = false;\r\n            } else {\r\n                context.fillRect(x0, y0, 1, 1);\r\n            }\r\n            if (x0 === x1 && y0 === y1) {\r\n                break;\r\n            }\r\n            let e2 = 2 * err;\r\n            if (e2 >= dY) {\r\n                err += dY;\r\n                x0 += sX;\r\n            }\r\n            if (e2 <= dX) {\r\n                err += dX;\r\n                y0 += sY;\r\n            }\r\n        }\r\n\r\n        context.restore();\r\n    }\r\n\r\n    function plotCubicBezierLine(p1, p2, p3, p4) {\r\n\r\n        let isOverThreshold = cubicCurveOverThreshold(p1, p2, p3, p4, 0.1);\r\n\r\n        p1.x = Math.floor(p1.x);\r\n        p1.y = Math.floor(p1.y);\r\n        p4.x = Math.floor(p4.x);\r\n        p4.y = Math.floor(p4.y);\r\n\r\n        let dist = BB.dist(p1.x, p1.y, p4.x, p4.y);\r\n        if (!isOverThreshold || dist < 7) {\r\n            plotLine(p1.x, p1.y, p4.x, p4.y, true);\r\n            return;\r\n        }\r\n\r\n        let n = Math.max(2, Math.round(dist / 4));\r\n        let pointArr = [];\r\n        for (let i = 0; i <= n; i++) {\r\n            let t = i / n;\r\n            let a = Math.pow(1 - t, 3);\r\n            let b = 3 * t * Math.pow(1 - t, 2);\r\n            let c = 3 * Math.pow(t, 2) * (1 - t);\r\n            let d = Math.pow(t, 3);\r\n            pointArr.push({\r\n                x: a * p1.x + b * p2.x + c * p3.x + d * p4.x,\r\n                y: a * p1.y + b * p2.y + c * p3.y + d * p4.y\r\n            });\r\n        }\r\n\r\n        for (let i = 0; i < n; i++) {\r\n            plotLine(\r\n                Math.round(pointArr[i].x),\r\n                Math.round(pointArr[i].y),\r\n                Math.round(pointArr[i + 1].x),\r\n                Math.round(pointArr[i + 1].y),\r\n                true\r\n            );\r\n        }\r\n    }\r\n\r\n    function drawDot(x, y, size, opacity, angle?) {\r\n        context.save();\r\n        if (settingIsEraser) {\r\n            context.fillStyle = settingUseDither ? ditherPattern : '#fff';\r\n            if (settingLockLayerAlpha) {\r\n                context.globalCompositeOperation = \"source-atop\";\r\n            } else {\r\n                context.globalCompositeOperation = \"destination-out\";\r\n            }\r\n        } else {\r\n            context.fillStyle = settingUseDither ? ditherPattern : settingColorStr;\r\n            if (settingLockLayerAlpha) {\r\n                context.globalCompositeOperation = \"source-atop\";\r\n            }\r\n        }\r\n        context.globalAlpha = settingUseDither ? 1 : opacity;\r\n        context.fillRect(\r\n            Math.round(x + -size),\r\n            Math.round(y + -size),\r\n            Math.round(size * 2),\r\n            Math.round(size * 2)\r\n        );\r\n        context.restore();\r\n    }\r\n\r\n\r\n    function continueLine(x, y, size, pressure) {\r\n        if (bezierLine === null) {\r\n            bezierLine = new BB.BezierLine();\r\n            bezierLine.add(lastInput.x, lastInput.y, 0, function () {\r\n            });\r\n        }\r\n\r\n        context.save();\r\n\r\n        function dotCallback(val) {\r\n            let localPressure = BB.mix(lastInput2.pressure, pressure, val.t);\r\n            let localOpacity = settingOpacity * (settingHasOpacityPressure ? (localPressure * localPressure) : 1);\r\n            let localSize = Math.max(0.5, settingSize * (settingHasSizePressure ? localPressure : 1));\r\n            drawDot(val.x, val.y, localSize, localOpacity, val.angle);\r\n        }\r\n\r\n        function controlCallback(controlObj) {\r\n            plotCubicBezierLine(controlObj.p1, controlObj.p2, controlObj.p3, controlObj.p4);\r\n        }\r\n\r\n        if (Math.round(settingSize * 2) === 1) {\r\n            if (x === null) {\r\n                bezierLine.addFinal(4, null, controlCallback);\r\n            } else {\r\n                bezierLine.add(x, y, 4, null, controlCallback);\r\n            }\r\n\r\n        } else {\r\n            let localSpacing = size * settingSpacing;\r\n\r\n            if (x === null) {\r\n                bezierLine.addFinal(localSpacing, dotCallback);\r\n            } else {\r\n                bezierLine.add(x, y, localSpacing, dotCallback);\r\n            }\r\n        }\r\n\r\n        context.restore();\r\n    }\r\n\r\n    //------------------ interface ---------------------------------------------------\r\n\r\n\r\n    this.startLine = function (x, y, p) {\r\n        historyEntry = {\r\n            tool: [\"brush\", \"PixelBrush\"],\r\n            actions: []\r\n        };\r\n        historyEntry.actions.push({\r\n            action: \"sizePressure\",\r\n            params: [settingHasSizePressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSize\",\r\n            params: [settingSize]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSpacing\",\r\n            params: [settingSpacing]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setOpacity\",\r\n            params: [settingOpacity]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setColor\",\r\n            params: [settingColor]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setLockAlpha\",\r\n            params: [settingLockLayerAlpha]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setIsEraser\",\r\n            params: [settingIsEraser]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setUseDither\",\r\n            params: [settingUseDither]\r\n        });\r\n\r\n        if (settingUseDither) {\r\n            updateDither();\r\n        }\r\n\r\n        p = Math.max(0, Math.min(1, p));\r\n        let localOpacity = settingHasOpacityPressure ? (settingOpacity * p * p) : settingOpacity;\r\n        let localSize = settingHasSizePressure ? Math.max(0.5, p * settingSize) : Math.max(0.5, settingSize);\r\n\r\n        isDrawing = true;\r\n        drawDot(x, y, localSize, localOpacity);\r\n        lineToolLastDot = localSize * settingSpacing;\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        lastInput.pressure = p;\r\n        lastInput2 = BB.copyObj(lastInput);\r\n\r\n        historyEntry.actions.push({\r\n            action: \"startLine\",\r\n            params: [x, y, p]\r\n        });\r\n    };\r\n\r\n    this.goLine = function (x, y, p) {\r\n        if (!isDrawing) {\r\n            return;\r\n        }\r\n        historyEntry.actions.push({\r\n            action: \"goLine\",\r\n            params: [x, y, p]\r\n        });\r\n\r\n        //debug\r\n        //drawDot(x, y, 1, 0.5);\r\n\r\n        let pressure = BB.clamp(p, 0, 1);\r\n        let localSize = settingHasSizePressure ? Math.max(0.1, lastInput.pressure * settingSize) : Math.max(0.1, settingSize);\r\n\r\n        continueLine(x, y, localSize, lastInput.pressure);\r\n\r\n        lastInput2 = BB.copyObj(lastInput);\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        lastInput.pressure = pressure;\r\n    };\r\n\r\n    this.endLine = function (x, y) {\r\n\r\n        let localSize = settingHasSizePressure ? Math.max(0.1, lastInput.pressure * settingSize) : Math.max(0.1, settingSize);\r\n        continueLine(null, null, localSize, lastInput.pressure);\r\n\r\n        //debug\r\n        //drawDot(lastInput.x, lastInput.y, 3, 1);\r\n        //drawDot(x, y, 10, 0.1);\r\n\r\n        isDrawing = false;\r\n\r\n        bezierLine = null;\r\n\r\n        if (historyEntry) {\r\n            historyEntry.actions.push({\r\n                action: \"endLine\",\r\n                params: [x, y]\r\n            });\r\n            history.push(historyEntry);\r\n            historyEntry = undefined;\r\n        }\r\n    };\r\n    //cheap n' ugly\r\n    this.drawLineSegment = function (x1, y1, x2, y2) {\r\n        lastInput.x = x2;\r\n        lastInput.y = y2;\r\n        lastInput.pressure = 1;\r\n\r\n        if (isDrawing || x1 === undefined) {\r\n            return;\r\n        }\r\n\r\n        if (settingUseDither) {\r\n            updateDither();\r\n        }\r\n\r\n        if (Math.round(settingSize * 2) === 1) {\r\n            plotLine(x1, y1, x2, y2, true);\r\n        } else {\r\n            let angle = BB.pointsToAngleDeg({x: x1, y: y1}, {x: x2, y: y2});\r\n            let mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\r\n            let eX = (x2 - x1) / mouseDist;\r\n            let eY = (y2 - y1) / mouseDist;\r\n            let loopDist;\r\n            let bdist = settingSize * settingSpacing;\r\n            lineToolLastDot = settingSize * settingSpacing;\r\n            for (loopDist = lineToolLastDot; loopDist <= mouseDist; loopDist += bdist) {\r\n                drawDot(x1 + eX * loopDist, y1 + eY * loopDist, settingSize, settingOpacity, angle);\r\n            }\r\n        }\r\n\r\n        let historyEntry = {\r\n            tool: [\"brush\", \"PixelBrush\"],\r\n            actions: []\r\n        };\r\n        historyEntry.actions.push({\r\n            action: \"sizePressure\",\r\n            params: [settingHasSizePressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSize\",\r\n            params: [settingSize]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSpacing\",\r\n            params: [settingSpacing]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setOpacity\",\r\n            params: [settingOpacity]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setColor\",\r\n            params: [settingColor]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setLockAlpha\",\r\n            params: [settingLockLayerAlpha]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setIsEraser\",\r\n            params: [settingIsEraser]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setUseDither\",\r\n            params: [settingUseDither]\r\n        });\r\n\r\n        historyEntry.actions.push({\r\n            action: \"drawLineSegment\",\r\n            params: [x1, y1, x2, y2]\r\n        });\r\n        history.push(historyEntry);\r\n    };\r\n\r\n    //IS\r\n    this.isDrawing = function () {\r\n        return isDrawing;\r\n    };\r\n    //SET\r\n    this.setColor = function (c) {\r\n        if (settingColor === c) {\r\n            return;\r\n        }\r\n        settingColor = c;\r\n        settingColorStr = \"rgb(\" + settingColor.r + \",\" + settingColor.g + \",\" + settingColor.b + \")\";\r\n    };\r\n    this.setContext = function (c) {\r\n        context = c;\r\n    };\r\n    this.setHistory = function (l: KlHistoryInterface) {\r\n        history = l;\r\n    };\r\n    this.setSize = function (s) {\r\n        settingSize = s;\r\n    };\r\n    this.setOpacity = function (o) {\r\n        settingOpacity = o;\r\n    };\r\n    this.setSpacing = function (s) {\r\n        settingSpacing = s;\r\n    };\r\n    this.sizePressure = function (b) {\r\n        settingHasSizePressure = b;\r\n    };\r\n    this.opacityPressure = function (b) {\r\n        settingHasOpacityPressure = b;\r\n    };\r\n    this.setLockAlpha = function (b) {\r\n        settingLockLayerAlpha = b;\r\n    };\r\n    this.setIsEraser = function (b) {\r\n        settingIsEraser = !!b;\r\n    };\r\n    this.setUseDither = function (b) {\r\n        settingUseDither = !!b;\r\n    };\r\n    //GET\r\n    this.getSpacing = function () {\r\n        return settingSpacing;\r\n    };\r\n    this.getSize = function () {\r\n        return settingSize;\r\n    };\r\n    this.getOpacity = function () {\r\n        return settingOpacity;\r\n    };\r\n    this.getLockAlpha = function () {\r\n        return settingLockLayerAlpha;\r\n    };\r\n    this.getIsEraser = function () {\r\n        return settingIsEraser;\r\n    };\r\n    this.getUseDither = function () {\r\n        return settingUseDither;\r\n    };\r\n}","import {BB} from '../../bb/bb';\r\nimport {IHistoryEntry, KlHistoryInterface} from '../history/kl-history';\r\nimport {KL} from '../kl';\r\n\r\nexport function EraserBrush() {\r\n    let context;\r\n    let history: KlHistoryInterface = new KL.DecoyKlHistory();\r\n    let historyEntry: IHistoryEntry;\r\n\r\n    let size = 30, spacing = 0.4, opacity = 1;\r\n    let sizePressure = true, opacityPressure = false;\r\n    let lastDot, lastInput = {x: 0, y: 0, pressure: 0};\r\n    let lastInput2 = {x: 0, y: 0, pressure: 0};\r\n    let started = false;\r\n\r\n    let bezierLine;\r\n    let isBaseLayer = false;\r\n    let isTransparentBG = false;\r\n\r\n    function drawDot(x, y, size, opacity) {\r\n\r\n        context.save();\r\n        if (isBaseLayer) {\r\n            if (isTransparentBG) {\r\n                context.globalCompositeOperation = \"destination-out\";\r\n            } else {\r\n                context.globalCompositeOperation = \"source-atop\";\r\n            }\r\n        } else {\r\n            context.globalCompositeOperation = \"destination-out\";\r\n        }\r\n        let radgrad = context.createRadialGradient(size, size, 0, size, size, size);\r\n        let sharpness = Math.pow(opacity, 2);\r\n        sharpness = Math.max(0, Math.min((size - 1) / size, sharpness));\r\n        let oFac = Math.max(0, Math.min(1, opacity));\r\n        let localOpacity = 2 * oFac - oFac * oFac;\r\n        radgrad.addColorStop(sharpness, \"rgba(255, 255, 255, \" + localOpacity + \")\");\r\n        radgrad.addColorStop(1, \"rgba(255, 255, 255, 0)\");\r\n        context.fillStyle = radgrad;\r\n        context.translate(x - size, y - size);\r\n        context.fillRect(0, 0, size * 2, size * 2);\r\n        context.restore();\r\n    }\r\n\r\n    function continueLine(x, y, p) {\r\n        p = Math.max(0, Math.min(1, p));\r\n        let localPressure;\r\n        let localOpacity;\r\n        let localSize = (sizePressure) ? Math.max(0.1, p * size) : Math.max(0.1, size);\r\n\r\n        let bdist = Math.max(1, Math.max(0.5, 1 - opacity) * localSize * spacing);\r\n\r\n        function bezierCallback(val) {\r\n            let factor = val.t;\r\n            localPressure = lastInput2.pressure * (1 - factor) + p * factor;\r\n            localOpacity = (opacityPressure) ? (opacity * localPressure * localPressure) : opacity;\r\n            localSize = (sizePressure) ? Math.max(0.1, localPressure * size) : Math.max(0.1, size);\r\n\r\n            drawDot(val.x, val.y, localSize, localOpacity);\r\n        }\r\n\r\n        if (x === null) {\r\n            bezierLine.addFinal(bdist, bezierCallback);\r\n        } else {\r\n            bezierLine.add(x, y, bdist, bezierCallback);\r\n        }\r\n    }\r\n\r\n\r\n    this.startLine = function (x, y, p) {\r\n        historyEntry = {\r\n            tool: [\"brush\", \"EraserBrush\"],\r\n            actions: []\r\n        };\r\n        historyEntry.actions.push({\r\n            action: \"opacityPressure\",\r\n            params: [opacityPressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"sizePressure\",\r\n            params: [sizePressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSize\",\r\n            params: [size]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setOpacity\",\r\n            params: [opacity]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setTransparentBG\",\r\n            params: [isTransparentBG]\r\n        });\r\n\r\n        isBaseLayer = 0 === context.canvas.index;\r\n\r\n        p = Math.max(0, Math.min(1, p));\r\n        let localOpacity = (opacityPressure) ? (opacity * p * p) : opacity;\r\n        let localSize = (sizePressure) ? Math.max(0.1, p * size) : Math.max(0.1, size);\r\n\r\n        started = true;\r\n        if (localSize > 1) {\r\n            drawDot(x, y, localSize, localOpacity);\r\n        }\r\n        lastDot = localSize * spacing;\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        lastInput.pressure = p;\r\n        lastInput2 = BB.copyObj(lastInput);\r\n\r\n        bezierLine = new BB.BezierLine();\r\n        bezierLine.add(x, y, 0, function () {\r\n        });\r\n\r\n        historyEntry.actions.push({\r\n            action: \"startLine\",\r\n            params: [x, y, p]\r\n        });\r\n    };\r\n    this.goLine = function (x, y, p) {\r\n        if (!started) {\r\n            return;\r\n        }\r\n        historyEntry.actions.push({\r\n            action: \"goLine\",\r\n            params: [x, y, p]\r\n        });\r\n\r\n        continueLine(x, y, lastInput.pressure);\r\n\r\n        lastInput2 = BB.copyObj(lastInput);\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        lastInput.pressure = p;\r\n    };\r\n    this.endLine = function () {\r\n\r\n        if (bezierLine) {\r\n            continueLine(null, null, lastInput.pressure);\r\n        }\r\n\r\n        started = false;\r\n        bezierLine = undefined;\r\n\r\n        if (historyEntry) {\r\n            historyEntry.actions.push({\r\n                action: \"endLine\",\r\n                params: []\r\n            });\r\n            history.push(historyEntry);\r\n            historyEntry = undefined;\r\n        }\r\n    };\r\n    //cheap n' ugly\r\n    this.drawLineSegment = function (x1, y1, x2, y2) {\r\n\r\n        isBaseLayer = 0 === context.canvas.index;\r\n\r\n        lastInput.x = x2;\r\n        lastInput.y = y2;\r\n\r\n        if (started || x1 === undefined) {\r\n            return;\r\n        }\r\n\r\n        let mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\r\n        let eX = (x2 - x1) / mouseDist;\r\n        let eY = (y2 - y1) / mouseDist;\r\n        let loopDist;\r\n        let bdist = Math.max(1, Math.max(0.5, 1 - opacity) * size * spacing);\r\n        lastDot = 0;\r\n        for (loopDist = lastDot; loopDist <= mouseDist; loopDist += bdist) {\r\n            drawDot(x1 + eX * loopDist, y1 + eY * loopDist, size, opacity);\r\n        }\r\n\r\n\r\n        let historyEntry = {\r\n            tool: [\"brush\", \"EraserBrush\"],\r\n            actions: []\r\n        };\r\n        historyEntry.actions.push({\r\n            action: \"opacityPressure\",\r\n            params: [opacityPressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"sizePressure\",\r\n            params: [sizePressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSize\",\r\n            params: [size]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setOpacity\",\r\n            params: [opacity]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setTransparentBG\",\r\n            params: [isTransparentBG]\r\n        });\r\n\r\n        historyEntry.actions.push({\r\n            action: \"drawLineSegment\",\r\n            params: [x1, y1, x2, y2]\r\n        });\r\n        history.push(historyEntry);\r\n    };\r\n\r\n    //IS\r\n    this.isDrawing = function () {\r\n        return started;\r\n    };\r\n    //SET\r\n    /*this.setAlpha = function(a) {\r\n        lastInput = {};\r\n        alpha = a;\r\n        updateAlphaCanvas();\r\n    };*/\r\n    this.setContext = function (c) {\r\n        context = c;\r\n    };\r\n    this.setHistory = function (l: KlHistoryInterface) {\r\n        history = l;\r\n    };\r\n    this.setSize = function (s) {\r\n        size = s;\r\n    };\r\n    this.setOpacity = function (o) {\r\n        opacity = o;\r\n    };\r\n    this.sizePressure = function (b) {\r\n        sizePressure = b;\r\n    };\r\n    this.opacityPressure = function (b) {\r\n        opacityPressure = b;\r\n    };\r\n    this.setTransparentBG = function (b) {\r\n        isTransparentBG = b == true;\r\n    };\r\n    //GET\r\n    this.getSize = function () {\r\n        return size;\r\n    };\r\n    this.getOpacity = function () {\r\n        return opacity;\r\n    };\r\n}","import {BB} from '../../bb/bb';\r\nimport {IBounds, IPressureInput, IVector2D} from '../../bb/bb.types';\r\nimport {IHistoryEntry, KlHistoryInterface} from '../history/kl-history';\r\nimport {KL} from '../kl';\r\nimport {IRGB} from '../kl.types';\r\n\r\n// let statCount = 1;\r\n// let statAcc = 0;\r\n// stats on win10, chrome, size 100, opacity 80, smudge()\r\n// unoptimized: 1 ms\r\n// minimal: 0.09 ms\r\n// minimal + circle: 0.5ms\r\n// minimal + circle + ix, iy: 0.23ms\r\n// unoptimized + ix, iy: 0.64 ms\r\n// unoptimized + ix, iy + sans rounding: 0.61 ms\r\n// ix, iy + sans rounding + sans random: 0.32ms\r\n// ix, iy + sans rounding + fast random: 0.46 ms\r\n// ix, iy + sans rounding + fast random + offset const: 0.48 ms\r\n\r\nconst CELL_SIZE = 256;\r\n\r\ninterface ISmudgeParams {\r\n    aP: IVector2D;\r\n    bP: IVector2D;\r\n    size: {\r\n        w: number;\r\n        h: number;\r\n    };\r\n    brush: {\r\n        center: IVector2D,\r\n        size: number;\r\n        opacity: number;\r\n        alphaLock: boolean;\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * determine bounds of smudge\r\n * @param imWidth\r\n * @param imHeight\r\n * @param aP\r\n * @param bP\r\n * @param size\r\n */\r\nfunction prepSmudge(\r\n    imWidth: number,\r\n    imHeight: number,\r\n    aP: IVector2D, // top left of source, integers\r\n    bP: IVector2D, // top left of dest, integers\r\n    size: {w: number; h: number}, // size of both rectangles, integers\r\n): {\r\n    aP: IVector2D,\r\n    bP: IVector2D,\r\n    size: {w: number; h: number},\r\n} {\r\n\r\n    if (aP.x === bP.x && aP.y === bP.y) {\r\n        return null;\r\n    }\r\n\r\n    aP = BB.copyObj(aP);\r\n    bP = BB.copyObj(bP);\r\n    size = BB.copyObj(size);\r\n\r\n    // corner behavior\r\n    // cut down rectangles, if a or b go outside\r\n    // i.e. if user drags partially or fully outside the canvas\r\n    {\r\n        let top = 0;\r\n        let right = 0;\r\n        let bottom = 0;\r\n        let left = 0;\r\n\r\n        if (aP.x < 0) {\r\n            left = -aP.x;\r\n        }\r\n        if (aP.y < 0) {\r\n            top = -aP.y;\r\n        }\r\n        if (bP.x < 0) {\r\n            left = Math.max(left, -bP.x);\r\n        }\r\n        if (bP.y < 0) {\r\n            top = Math.max(top, -bP.y);\r\n        }\r\n        if (aP.x + size.w > imWidth) {\r\n            right = aP.x + size.w - imWidth;\r\n        }\r\n        if (aP.y + size.h > imHeight) {\r\n            bottom = aP.y + size.h - imHeight;\r\n        }\r\n        if (bP.x + size.w > imWidth) {\r\n            right = Math.max(right, bP.x + size.w - imWidth);\r\n        }\r\n        if (bP.y + size.h > imHeight) {\r\n            bottom = Math.max(bottom, bP.y + size.h - imHeight);\r\n        }\r\n\r\n        aP.x += left;\r\n        bP.x += left;\r\n        aP.y += top;\r\n        bP.y += top;\r\n\r\n        size.w = size.w - left - right;\r\n        size.h = size.h - top - bottom;\r\n        if (size.w <= 0 || size.h <= 0) {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    return {\r\n        aP: {\r\n            x: aP.x,\r\n            y: aP.y,\r\n        },\r\n        bP: {\r\n            x: bP.x,\r\n            y: bP.y,\r\n        },\r\n        size: {\r\n            w: size.w,\r\n            h: size.h,\r\n        }\r\n    };\r\n}\r\n\r\n// faster than using BB.clamp somehow (in chrome)\r\nfunction clamp(num, min, max) {\r\n    return num <= min\r\n        ? min\r\n        : num >= max\r\n            ? max\r\n            : num\r\n}\r\n\r\n/**\r\n * Pixel operations that do the smudging via ImageData\r\n * @param imageData\r\n * @param p\r\n */\r\nfunction smudge(imageData: ImageData, p : ISmudgeParams): void {\r\n\r\n    p = BB.copyObj(p);\r\n\r\n    const cSize = p.brush.size;\r\n    const cX = p.brush.center.x;\r\n    const cY = p.brush.center.y;\r\n\r\n    /*if (statCount % 1000 === 0) {\r\n        console.log(statAcc / 1000);\r\n        statAcc = 0;\r\n    }\r\n    let start = performance.now();*/\r\n\r\n\r\n    // determine offset\r\n    let aIndex = p.aP.y * imageData.width + p.aP.x;\r\n    let bIndex = p.bP.y * imageData.width + p.bP.x;\r\n    const offset = (bIndex - aIndex) * 4;\r\n\r\n    // array with random numbers. faster than Math.random()\r\n    let randI = 0;\r\n    const randLen = cSize > 30 ? 1024 : 512; // lower lengths lead to noticeable patterns\r\n    const randArr = [];\r\n    for (let i = 0; i < randLen; i++) {\r\n        randArr[i] = (Math.random() - 0.5) / 1.001 + 0.5;\r\n    }\r\n\r\n    const softnessPx = Math.max(3, Math.min(8, p.brush.size - 8));\r\n\r\n    const pixel = (ai, bi, ix, iy) => {\r\n\r\n        const dist = BB.dist(cX, cY, ix, iy);\r\n        const fac = 1 - p.brush.opacity * (1 - clamp((dist - (cSize - softnessPx)) / softnessPx, 0, 1));\r\n\r\n        if (fac === 1) {\r\n            return;\r\n        }\r\n\r\n        if (!imageData.data[ai + 3]) {\r\n\r\n        } else if (!imageData.data[bi + 3]) { // don't mix if target fully transparent. pixel might have a strange color.\r\n            imageData.data[bi] = imageData.data[ai + 0];\r\n            imageData.data[bi + 1] = imageData.data[ai + 1];\r\n            imageData.data[bi + 2] = imageData.data[ai + 2];\r\n        } else {\r\n\r\n            // consider alpha ratio. If a has lower alpha than b, then b should be stronger, and vice versa\r\n            // not totally accurate. TODO same compositing as blend brush\r\n            let fac2;\r\n            if (imageData.data[ai + 3] < imageData.data[bi + 3]) {\r\n                fac2 = 1 - imageData.data[ai + 3] / imageData.data[bi + 3] * (1 - fac);\r\n            } else {\r\n                fac2 = imageData.data[bi + 3] / imageData.data[ai + 3] * fac;\r\n            }\r\n\r\n            // ImageData's Uint8ClampedArray rounds -> 0.5 becomes 1. But not in Safari, so needs to be done manually\r\n            // Offset mixed color by random number noise (-0.5, 0.5), so it doesn't get stuck while mixing.\r\n            // No +0.5, because it cancels out with rand.\r\n            imageData.data[bi] = Math.floor(BB.mix(imageData.data[ai], imageData.data[bi + 0], fac2) + randArr[randI]);\r\n            imageData.data[bi + 1] = Math.floor(BB.mix(imageData.data[ai + 1], imageData.data[bi + 1], fac2) + randArr[randI]);\r\n            imageData.data[bi + 2] = Math.floor(BB.mix(imageData.data[ai + 2], imageData.data[bi + 2], fac2) + randArr[randI]);\r\n\r\n            randI = (randI + 1) % randLen;\r\n        }\r\n        // Always mix alpha. unless alpha lock\r\n        if (!p.brush.alphaLock) {\r\n            imageData.data[bi + 3] = Math.floor(BB.mix(imageData.data[ai + 3], imageData.data[bi + 3], fac) + 0.5);\r\n        }\r\n\r\n    };\r\n\r\n    const bx1 = p.bP.x * 4;\r\n    const bx2 = bx1 + (p.size.w - 1) * 4;\r\n\r\n    // transfer of pixels depends on direction of smudging if there is overlap\r\n    if (p.aP.y < p.bP.y) {\r\n        for (let y = p.size.h - 1, iy = p.bP.y + p.size.h - 1; y >= 0; y--, iy--) {\r\n            const yStart = (y + p.bP.y) * imageData.width * 4;\r\n            for (let x = bx2 + yStart, x2 = bx2 + yStart - offset, ix = p.bP.x + p.size.w - 1; x >= bx1 + yStart; x -= 4, x2 -= 4, ix--) {\r\n                pixel(x2, x, ix, iy);\r\n            }\r\n        }\r\n    } else if (p.aP.y > p.bP.y) {\r\n        for (let y = 0, iy = p.bP.y; y < p.size.h; y++, iy++) {\r\n            const yStart = (y + p.bP.y) * imageData.width * 4;\r\n            for (let x = bx2 + yStart, x2 = bx2 + yStart - offset, ix = p.bP.x + p.size.w - 1; x >= bx1 + yStart; x -= 4, x2 -= 4, ix--) {\r\n                pixel(x2, x, ix, iy);\r\n            }\r\n        }\r\n    } else {\r\n        if (p.aP.x < p.bP.x) {\r\n            for (let y = p.size.h - 1, iy = p.bP.y + p.size.h - 1; y >= 0; y--, iy--) {\r\n                const yStart = (y + p.bP.y) * imageData.width * 4;\r\n                for (let x = bx2 + yStart, x2 = bx2 + yStart - offset, ix = p.bP.x + p.size.w - 1; x >= bx1 + yStart; x -= 4, x2 -= 4, ix--) {\r\n                    pixel(x2, x, ix, iy);\r\n                }\r\n            }\r\n        } else {\r\n            for (let y = 0, iy = p.bP.y; y < p.size.h; y++, iy++) {\r\n                const yStart = (y + p.bP.y) * imageData.width * 4;\r\n                for (let x = bx1 + yStart, x2 = bx1 + yStart - offset, ix = p.bP.x; x < bx2 + yStart; x += 4, x2 += 4, ix++) {\r\n                    pixel(x2, x, ix, iy);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    //statCount++;\r\n    //statAcc += performance.now() - start;\r\n}\r\n\r\nexport class SmudgeBrush {\r\n\r\n    private context: CanvasRenderingContext2D;\r\n    private history: KlHistoryInterface = new KL.DecoyKlHistory();\r\n    private historyEntry: IHistoryEntry;\r\n\r\n    private settingColor: IRGB = {r: 0, g: 0, b: 0};\r\n    private settingSize: number = 35;\r\n    private settingSpacing: number = 0.20446882736951905;\r\n    private settingOpacity: number = 0.8;\r\n    private settingColorStr: string;\r\n    private settingHasSizePressure: boolean = false;\r\n    private settingHasOpacityPressure: boolean = false;\r\n    private settingLockLayerAlpha: boolean = false;\r\n\r\n    private lineToolLastDot: number;\r\n    private lastInput: IPressureInput = {x: 0, y: 0, pressure: 0};\r\n    private lastInput2: IPressureInput = {x: 0, y: 0, pressure: 0};\r\n    private lastDot: IVector2D;\r\n\r\n    private isDrawing: boolean = false;\r\n\r\n    private bezierLine: any = null; // todo type BezierLine\r\n\r\n    private redrawBounds: IBounds;\r\n    private completeRedrawBounds: IBounds;\r\n\r\n    private copyImageData: ImageData;\r\n\r\n    private drawBuffer: ISmudgeParams[] = [];\r\n\r\n    private copiedCells: boolean[];\r\n\r\n    updateRedrawBounds(bounds: IBounds): void {\r\n        this.redrawBounds = BB.updateBounds(this.redrawBounds, bounds);\r\n    }\r\n\r\n    updateCompleteRedrawBounds (x1, y1, x2, y2): void {\r\n        this.completeRedrawBounds = BB.updateBounds(\r\n            this.completeRedrawBounds,\r\n            { x1, y1, x2, y2 }\r\n        );\r\n    }\r\n\r\n    /**\r\n     * update copyImageData. copy over new regions if needed\r\n     */\r\n    copyFromCanvas(): void {\r\n\r\n        const touchedCells = this.copiedCells.map(item => false);\r\n\r\n        const bounds: IBounds[] = [];\r\n        const cellsW = Math.ceil(this.copyImageData.width / CELL_SIZE);\r\n\r\n        if (!this.redrawBounds) {\r\n            return;\r\n        }\r\n        bounds.push({\r\n            x1: Math.floor(this.redrawBounds.x1 / CELL_SIZE),\r\n            y1: Math.floor(this.redrawBounds.y1 / CELL_SIZE),\r\n            x2: Math.floor(this.redrawBounds.x2 / CELL_SIZE),\r\n            y2: Math.floor(this.redrawBounds.y2 / CELL_SIZE),\r\n        });\r\n        bounds.forEach(item => {\r\n            for (let i = item.x1; i <= item.x2; i++) {\r\n                for (let e = item.y1; e <= item.y2; e++) {\r\n                    touchedCells[e * cellsW + i] = true;\r\n                }\r\n            }\r\n        });\r\n\r\n        touchedCells.forEach((item, i) => {\r\n            if (!item || this.copiedCells[i]) {\r\n                // not touched, or already copied\r\n                return;\r\n            }\r\n            this.copiedCells[i] = true;\r\n            const x = i % cellsW;\r\n            const y = Math.floor(i / cellsW);\r\n            const w = (Math.min(x * CELL_SIZE + CELL_SIZE, this.copyImageData.width) - 1) % CELL_SIZE + 1;\r\n            const h = (Math.min(y * CELL_SIZE + CELL_SIZE, this.copyImageData.height) - 1) % CELL_SIZE + 1;\r\n\r\n            // temp canvas to prevent main canvas from getting slowed down in chrome\r\n            const tmpCanvas = BB.canvas(w, h);\r\n            const tmpCtx = tmpCanvas.getContext('2d');\r\n            tmpCtx.drawImage(this.context.canvas, -x * CELL_SIZE, -y * CELL_SIZE);\r\n\r\n            const data = tmpCtx.getImageData(0, 0, w, h);\r\n\r\n            for (let i = 0; i < h; i++) {\r\n                for (let e = 0, e2 = i * w * 4, e3 = ((y * CELL_SIZE + i) * this.copyImageData.width + x * CELL_SIZE) * 4; e < w; e++, e2 += 4, e3 += 4) {\r\n                    this.copyImageData.data[e3] = data.data[e2];\r\n                    this.copyImageData.data[e3 + 1] = data.data[e2 + 1];\r\n                    this.copyImageData.data[e3 + 2] = data.data[e2 + 2];\r\n                    this.copyImageData.data[e3 + 3] = data.data[e2 + 3];\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * fill drawBuffer with params about to be drawn\r\n     * @param x\r\n     * @param y\r\n     * @param size\r\n     * @param opacity\r\n     */\r\n    prepDot (x: number, y: number, size: number, opacity: number): void {\r\n        if (!this.lastDot) {\r\n            this.lastDot = {\r\n                x: x,\r\n                y: y,\r\n            };\r\n            return;\r\n        }\r\n\r\n        size = Math.round(size);\r\n\r\n\r\n        const w = Math.round(size * 2);\r\n        const h = Math.round(size * 2);\r\n\r\n        const bounds = prepSmudge(\r\n            this.copyImageData.width,\r\n            this.copyImageData.height,\r\n            {\r\n                x: Math.round(this.lastDot.x - size),\r\n                y: Math.round(this.lastDot.y - size),\r\n            },\r\n            {\r\n                x: Math.round(x - size),\r\n                y: Math.round(y - size),\r\n            },\r\n            {\r\n                w,\r\n                h,\r\n            },\r\n        );\r\n\r\n        if (bounds) {\r\n            const params: ISmudgeParams = {\r\n                aP: bounds.aP,\r\n                bP: bounds.bP,\r\n                size: bounds.size,\r\n                brush: {\r\n                    center: { x, y },\r\n                    size,\r\n                    opacity,\r\n                    alphaLock: this.settingLockLayerAlpha,\r\n                }\r\n            };\r\n            this.updateRedrawBounds({\r\n                x1: params.bP.x,\r\n                y1: params.bP.y,\r\n                x2: params.bP.x + params.brush.size * 2,\r\n                y2: params.bP.y + params.brush.size * 2,\r\n            });\r\n            this.drawBuffer.push(params);\r\n        }\r\n\r\n        this.lastDot = {\r\n            x: x,\r\n            y: y,\r\n        };\r\n    }\r\n\r\n    continueLine (x: number, y: number, size: number, pressure: number): void {\r\n        this.drawBuffer = [];\r\n\r\n        if (this.bezierLine === null) {\r\n            this.bezierLine = new BB.BezierLine();\r\n            this.bezierLine.add(this.lastInput.x, this.lastInput.y, 0, function(){});\r\n        }\r\n\r\n        const drawArr = []; //draw instructions. will be all drawn at once\r\n\r\n        const dotCallback = (val): void => {\r\n            const localPressure = BB.mix(this.lastInput2.pressure, pressure, val.t);\r\n            const localOpacity = this.settingOpacity * (this.settingHasOpacityPressure ? (localPressure * localPressure) : 1);\r\n            const localSize = Math.max(0.1, this.settingSize * (this.settingHasSizePressure ? localPressure : 1));\r\n            drawArr.push([val.x, val.y, localSize, localOpacity, val.angle]);\r\n        };\r\n\r\n        const localSpacing = size * this.settingSpacing / 3;\r\n        if (x === null) {\r\n            this.bezierLine.addFinal(localSpacing, dotCallback);\r\n        } else {\r\n            this.bezierLine.add(x, y, localSpacing, dotCallback);\r\n        }\r\n\r\n        // execute draw instructions\r\n        let before;\r\n        for (let i = 0; i < drawArr.length; i++) {\r\n            const item = drawArr[i];\r\n            this.prepDot(item[0], item[1], item[2], item[3]);\r\n            before = item;\r\n        }\r\n\r\n        this.copyFromCanvas();\r\n\r\n        for (let i = 0; i < this.drawBuffer.length; i++) {\r\n            smudge(this.copyImageData, this.drawBuffer[i]);\r\n        }\r\n    }\r\n\r\n\r\n\r\n    // ---- public ----\r\n\r\n    constructor () { }\r\n\r\n    startLine (x: number, y: number, p: number): void {\r\n        this.historyEntry = {\r\n            tool: [\"brush\", \"SmudgeBrush\"],\r\n            actions: []\r\n        };\r\n\r\n        p = BB.clamp(p, 0, 1);\r\n        const localOpacity = this.settingHasOpacityPressure ? (this.settingOpacity * p * p) : this.settingOpacity;\r\n        const localSize = this.settingHasSizePressure ? Math.max(0.1, p * this.settingSize) : Math.max(0.1, this.settingSize);\r\n\r\n        this.lastDot = null;\r\n        this.isDrawing = true;\r\n\r\n        this.copyImageData = new ImageData(this.context.canvas.width, this.context.canvas.height);\r\n        const totalCells = Math.ceil(this.context.canvas.width / CELL_SIZE) * Math.ceil(this.context.canvas.height / CELL_SIZE);\r\n        this.copiedCells = '0'.repeat(totalCells).split('').map(item => false);\r\n\r\n        this.prepDot(x, y, localSize, localOpacity);\r\n\r\n        this.lineToolLastDot = localSize * this.settingSpacing;\r\n        this.lastInput.x = x;\r\n        this.lastInput.y = y;\r\n        this.lastInput.pressure = p;\r\n        this.lastInput2.pressure = p;\r\n\r\n        this.completeRedrawBounds = null;\r\n    }\r\n\r\n    goLine (x: number, y: number, p: number): void {\r\n        if (!this.isDrawing) {\r\n            return;\r\n        }\r\n\r\n        this.redrawBounds = null;\r\n        const pressure = BB.clamp(p, 0, 1);\r\n        const localSize = this.settingHasSizePressure ?\r\n            Math.max(0.1, this.lastInput.pressure * this.settingSize) : Math.max(0.1, this.settingSize);\r\n\r\n        this.continueLine(x, y, localSize, this.lastInput.pressure);\r\n\r\n\r\n        if (this.redrawBounds) {\r\n            this.context.putImageData(\r\n                this.copyImageData,\r\n                0,\r\n                0,\r\n                this.redrawBounds.x1,\r\n                this.redrawBounds.y1,\r\n                this.redrawBounds.x2 - this.redrawBounds.x1 - 1,\r\n                this.redrawBounds.y2 - this.redrawBounds.y1 - 1\r\n            );\r\n            this.updateCompleteRedrawBounds(\r\n                this.redrawBounds.x1,\r\n                this.redrawBounds.y1,\r\n                this.redrawBounds.x2,\r\n                this.redrawBounds.y2\r\n            );\r\n        }\r\n\r\n        this.lastInput.x = x;\r\n        this.lastInput.y = y;\r\n        this.lastInput2.pressure = this.lastInput.pressure;\r\n        this.lastInput.pressure = pressure;\r\n    }\r\n\r\n    endLine (): void {\r\n        this.redrawBounds = null;\r\n        const localSize = this.settingHasSizePressure ?\r\n            Math.max(0.1, this.lastInput.pressure * this.settingSize) : Math.max(0.1, this.settingSize);\r\n        this.context.save();\r\n        this.continueLine(null, null, localSize, this.lastInput.pressure);\r\n        this.context.restore();\r\n\r\n        this.isDrawing = false;\r\n        this.bezierLine = null;\r\n\r\n        if (this.redrawBounds) {\r\n            this.context.putImageData(\r\n                this.copyImageData,\r\n                0,\r\n                0,\r\n                this.redrawBounds.x1,\r\n                this.redrawBounds.y1,\r\n                this.redrawBounds.x2 - this.redrawBounds.x1 - 1,\r\n                this.redrawBounds.y2 - this.redrawBounds.y1 - 1\r\n            );\r\n            this.updateCompleteRedrawBounds(\r\n                this.redrawBounds.x1,\r\n                this.redrawBounds.y1,\r\n                this.redrawBounds.x2,\r\n                this.redrawBounds.y2\r\n            );\r\n        }\r\n\r\n        if (this.historyEntry && this.completeRedrawBounds) {\r\n            let historyIm: ImageData | HTMLCanvasElement = this.copyImageData;\r\n            if (!(\r\n                this.completeRedrawBounds.x1 === 0 &&\r\n                this.completeRedrawBounds.y1 === 0 &&\r\n                this.completeRedrawBounds.x2 >= this.context.canvas.width - 1 &&\r\n                this.completeRedrawBounds.y2 >= this.context.canvas.height - 1\r\n            )) {\r\n\r\n                // temp canvas to prevent main canvas from getting slowed down in chrome\r\n                const tmpCanvas = BB.canvas(\r\n                    this.completeRedrawBounds.x2 - this.completeRedrawBounds.x1 + 1,\r\n                    this.completeRedrawBounds.y2 - this.completeRedrawBounds.y1 + 1\r\n                );\r\n                const tmpCtx = tmpCanvas.getContext('2d');\r\n                tmpCtx.drawImage(this.context.canvas, -this.completeRedrawBounds.x1, -this.completeRedrawBounds.y1);\r\n\r\n                historyIm = tmpCanvas; // faster than getting image data (measured on 2018 lenovo chromebook)\r\n            }\r\n            this.historyEntry.actions.push({\r\n                action: \"drawImage\",\r\n                params: [\r\n                    historyIm,\r\n                    this.completeRedrawBounds.x1,\r\n                    this.completeRedrawBounds.y1,\r\n                ],\r\n            });\r\n            this.history.push(this.historyEntry);\r\n            this.historyEntry = undefined;\r\n        }\r\n        this.copyImageData = null;\r\n    }\r\n\r\n    drawImage (im: ImageData | HTMLCanvasElement, x: number, y: number): void {\r\n        if (im instanceof ImageData) {\r\n            this.context.putImageData(im, x, y);\r\n        } else {\r\n            this.context.clearRect(x, y, im.width, im.height);\r\n            this.context.drawImage(im, x, y);\r\n        }\r\n    }\r\n\r\n    drawLineSegment (x1: number, y1: number, x2: number, y2: number): void {\r\n        return;\r\n        /*\r\n        // todo\r\n        lastInput.x = x2;\r\n        lastInput.y = y2;\r\n        lastInput.pressure = 1;\r\n\r\n        if (isDrawing || x1 === undefined) {\r\n            return;\r\n        }\r\n\r\n        let angle = BB.pointsToAngleDeg({x:x1, y:y1}, {x:x2, y:y2});\r\n        let mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\r\n        let eX = (x2 - x1) / mouseDist;\r\n        let eY = (y2 - y1) / mouseDist;\r\n        let loopDist;\r\n        let bdist = settingSize * settingSpacing;\r\n        lineToolLastDot = settingSize * settingSpacing;\r\n        for (loopDist = lineToolLastDot; loopDist <= mouseDist; loopDist += bdist) {\r\n            drawDot(x1 + eX * loopDist, y1 + eY * loopDist, settingSize, settingOpacity);\r\n        }\r\n\r\n\r\n        let historyEntry = {\r\n            tool: [\"brush\", \"SmudgeBrush\"],\r\n            actions: []\r\n        };\r\n        // todo\r\n        history.add(historyEntry);*/\r\n    }\r\n\r\n    getIsDrawing (): boolean {\r\n        return this.isDrawing;\r\n    }\r\n\r\n    setColor (c: IRGB): void {\r\n        if (this.settingColor.r === c.r && this.settingColor.g === c.g && this.settingColor.b === c.b) {\r\n            return;\r\n        }\r\n        this.settingColor = {r: c.r, g: c.g, b: c.b};\r\n        this.settingColorStr = BB.ColorConverter.toRgbStr(this.settingColor);\r\n    }\r\n\r\n    setContext (c: CanvasRenderingContext2D): void {\r\n        this.context = c;\r\n    }\r\n\r\n    setHistory (h: KlHistoryInterface): void {\r\n        this.history = h;\r\n    }\r\n\r\n    setSize (s: number): void {\r\n        this.settingSize = s;\r\n    }\r\n\r\n    setOpacity (o: number): void {\r\n        this.settingOpacity = o;\r\n    }\r\n\r\n    setSpacing (s: number): void {\r\n        this.settingSpacing = s;\r\n    }\r\n\r\n    sizePressure (b: boolean): void {\r\n        this.settingHasSizePressure = !!b;\r\n    }\r\n\r\n    opacityPressure (b: boolean): void {\r\n        this.settingHasOpacityPressure = !!b;\r\n    }\r\n\r\n    setLockAlpha (b: boolean): void {\r\n        this.settingLockLayerAlpha = !!b;\r\n    }\r\n\r\n    getSpacing (): number {\r\n        return this.settingSpacing;\r\n    }\r\n\r\n    getSize (): number {\r\n        return this.settingSize;\r\n    }\r\n\r\n    getOpacity (): number {\r\n        return this.settingOpacity;\r\n    }\r\n\r\n    getLockAlpha (): boolean {\r\n        return this.settingLockLayerAlpha;\r\n    }\r\n\r\n}\r\n","import {BB} from '../../bb/bb';\r\nimport {IRGB} from '../kl.types';\r\nimport {IBounds} from '../../bb/bb.types';\r\nimport {KlHistoryInterface} from '../history/kl-history';\r\n\r\ntype TChemyMode = 'fill' | 'stroke';\r\n\r\nexport class ChemyBrush {\r\n\r\n    private context: CanvasRenderingContext2D;\r\n    private settingColor: IRGB;\r\n    private settingSize: number = 0.25; // radius - 0.5 - 99999\r\n    private settingOpacity: number = 1; // 0-1\r\n    private settingLockLayerAlpha: boolean = false;\r\n    private settingIsEraser: boolean = false;\r\n    private settingMode: TChemyMode = 'fill';\r\n    private settingDistort: number = 0; // 0 - 1\r\n    private settingXSymmetry: boolean = false;\r\n    private settingYSymmetry: boolean = false;\r\n    private settingGradient: boolean = false;\r\n\r\n    private isDrawing: boolean = false;\r\n\r\n    private history: KlHistoryInterface;\r\n\r\n    private copyCanvas: HTMLCanvasElement;\r\n    private path: {x: number, y: number}[];\r\n    private minY: number;\r\n    private maxY: number;\r\n    private completeRedrawBounds: IBounds;\r\n\r\n    updateCompleteRedrawBounds (x, y): void {\r\n        let bounds = { x1: x, y1: y, x2: x, y2: y};\r\n        if (this.settingXSymmetry) {\r\n            bounds = BB.updateBounds(\r\n                bounds,\r\n                {\r\n                    x1: -x + this.copyCanvas.width,\r\n                    y1: y,\r\n                    x2: -x + this.copyCanvas.width,\r\n                    y2: y,\r\n                }\r\n                );\r\n        }\r\n        if (this.settingYSymmetry) {\r\n            bounds = BB.updateBounds(\r\n                bounds,\r\n                {\r\n                    x1: x,\r\n                    y1: -y + this.copyCanvas.height,\r\n                    x2: x,\r\n                    y2: -y + this.copyCanvas.height,\r\n                }\r\n            );\r\n        }\r\n        const buffer = this.settingMode === 'stroke' ? this.settingSize + 1 : 1;\r\n        bounds.x1 = Math.floor(bounds.x1 - buffer);\r\n        bounds.y1 = Math.floor(bounds.y1 - buffer);\r\n        bounds.x2 = Math.ceil(bounds.x2 + buffer);\r\n        bounds.y2 = Math.ceil(bounds.y2 + buffer);\r\n\r\n        this.completeRedrawBounds = BB.updateBounds(this.completeRedrawBounds, bounds);\r\n    }\r\n\r\n    private drawShape (): void {\r\n        this.context.save();\r\n        this.context.clearRect(0, 0, this.context.canvas.width, this.context.canvas.height);\r\n        this.context.drawImage(this.copyCanvas, 0, 0);\r\n\r\n        let color = {...this.settingColor};\r\n        if (this.settingIsEraser) {\r\n            color.r = 255;\r\n            color.g = 255;\r\n            color.b = 255;\r\n            if (this.settingLockLayerAlpha) {\r\n                this.context.globalCompositeOperation = \"source-atop\";\r\n            } else {\r\n                this.context.globalCompositeOperation = \"destination-out\";\r\n            }\r\n        } else {\r\n            if (this.settingLockLayerAlpha) {\r\n                this.context.globalCompositeOperation = \"source-atop\";\r\n            }\r\n        }\r\n\r\n        if (this.path) {\r\n\r\n            // path\r\n            const path = new Path2D();\r\n            this.path.forEach((item, index) => {\r\n                if (index === 0) {\r\n                    path.moveTo(item.x, item.y);\r\n                } else {\r\n                    path.lineTo(item.x, item.y);\r\n                }\r\n            });\r\n\r\n            let style: string | CanvasGradient = BB.ColorConverter.toRgbaStr({\r\n                r: color.r,\r\n                g: color.g,\r\n                b: color.b,\r\n                a: this.settingOpacity,\r\n            });\r\n            if (this.settingGradient) {\r\n                const startAtTop = this.path[0].x > this.path[this.path.length - 1].x;\r\n                const gradient = this.context.createLinearGradient(\r\n                    0, startAtTop ? this.minY : this.maxY,\r\n                    0, startAtTop ? this.maxY : this.minY,\r\n                );\r\n                gradient.addColorStop(\r\n                    0,\r\n                    BB.ColorConverter.toRgbaStr({\r\n                        r: color.r,\r\n                        g: color.g,\r\n                        b: color.b,\r\n                        a: this.settingOpacity,\r\n                    })\r\n                );\r\n                gradient.addColorStop(\r\n                    1,\r\n                    BB.ColorConverter.toRgbaStr({\r\n                        r: color.r,\r\n                        g: color.g,\r\n                        b: color.b,\r\n                        a: 0,\r\n                    })\r\n                );\r\n                style = gradient;\r\n            }\r\n\r\n            // setup params\r\n            if (this.settingMode === 'fill') {\r\n                this.context.fillStyle = style;\r\n\r\n            } else {\r\n                this.context.lineWidth = this.settingSize * 2;\r\n                this.context.lineJoin = 'bevel';\r\n                this.context.strokeStyle = style;\r\n            }\r\n\r\n            // draw\r\n            const draw = () => {\r\n                if (this.settingMode === 'fill') {\r\n                    this.context.fill(path);\r\n                } else {\r\n                    this.context.stroke(path);\r\n                }\r\n            };\r\n\r\n            draw();\r\n            if (this.settingXSymmetry) {\r\n                this.context.save();\r\n                this.context.translate(this.context.canvas.width / 2, 0);\r\n                this.context.scale(-1, 1);\r\n                this.context.translate(-this.context.canvas.width / 2, 0);\r\n                draw();\r\n                this.context.restore();\r\n            }\r\n            if (this.settingYSymmetry) {\r\n                this.context.save();\r\n                this.context.translate(0, this.context.canvas.height / 2);\r\n                this.context.scale(1, -1);\r\n                this.context.translate(0, -this.context.canvas.height / 2);\r\n                draw();\r\n                this.context.restore();\r\n                if (this.settingXSymmetry) {\r\n                    this.context.save();\r\n                    this.context.translate(this.context.canvas.width / 2, this.context.canvas.height / 2);\r\n                    this.context.scale(-1, -1);\r\n                    this.context.translate(-this.context.canvas.width / 2, -this.context.canvas.height / 2);\r\n                    draw();\r\n                    this.context.restore();\r\n                }\r\n            }\r\n        }\r\n\r\n        this.context.restore();\r\n    }\r\n\r\n    // --- public ----\r\n    constructor () {\r\n    }\r\n\r\n    setHistory (h: KlHistoryInterface): void {\r\n        this.history = h;\r\n    }\r\n\r\n    getSize (): number {\r\n        return this.settingMode === 'stroke' ? this.settingSize : 0;\r\n    }\r\n\r\n    setSize (s: number): void {\r\n        this.settingSize = s;\r\n    }\r\n\r\n    getOpacity (): number {\r\n        return this.settingOpacity;\r\n    }\r\n\r\n    setOpacity (o: number): void {\r\n        this.settingOpacity = o;\r\n    }\r\n\r\n    setColor (c: IRGB): void {\r\n        this.settingColor = BB.copyObj(c);\r\n    }\r\n\r\n    setContext (c: CanvasRenderingContext2D) {\r\n        this.context = c;\r\n    }\r\n\r\n    setMode (mode: TChemyMode): void {\r\n        this.settingMode = mode;\r\n    }\r\n\r\n    getMode (): TChemyMode {\r\n        return this.settingMode;\r\n    }\r\n\r\n    setDistort (distort: number): void {\r\n        this.settingDistort = BB.clamp(distort, 0, 1);\r\n    }\r\n\r\n    getDistort (): number {\r\n        return this.settingDistort;\r\n    }\r\n\r\n    setXSymmetry (b: boolean): void {\r\n        this.settingXSymmetry = !!b;\r\n    }\r\n\r\n    getXSymmetry (): boolean {\r\n        return this.settingXSymmetry;\r\n    }\r\n\r\n    setYSymmetry (b: boolean): void {\r\n        this.settingYSymmetry = !!b;\r\n    }\r\n\r\n    getYSymmetry (): boolean {\r\n        return this.settingYSymmetry;\r\n    }\r\n\r\n    setGradient (b: boolean): void {\r\n        this.settingGradient = !!b;\r\n    }\r\n\r\n    getGradient (): boolean {\r\n        return this.settingGradient;\r\n    }\r\n\r\n    getLockAlpha (): boolean {\r\n        return this.settingLockLayerAlpha;\r\n    }\r\n\r\n    setLockAlpha (b: boolean): void {\r\n        this.settingLockLayerAlpha = !!b;\r\n    }\r\n\r\n    getIsEraser (): boolean {\r\n        return this.settingIsEraser;\r\n    }\r\n\r\n    setIsEraser (b: boolean): void {\r\n        this.settingIsEraser = !!b;\r\n    }\r\n\r\n    getIsDrawing (): boolean {\r\n        return this.isDrawing;\r\n    }\r\n\r\n    startLine (x: number, y: number): void {\r\n        this.isDrawing = true;\r\n        this.path = [{x, y}];\r\n        this.minY = y;\r\n        this.maxY = y;\r\n        this.copyCanvas = BB.canvas(this.context.canvas.width, this.context.canvas.height);\r\n        this.copyCanvas.getContext('2d').drawImage(this.context.canvas, 0, 0);\r\n        this.completeRedrawBounds = null;\r\n        this.updateCompleteRedrawBounds(x, y);\r\n    }\r\n\r\n    goLine (x: number, y: number): void {\r\n        if (!this.isDrawing) {\r\n            return;\r\n        }\r\n\r\n        let pos = { x, y };\r\n        if (this.settingDistort > 0) {\r\n            pos.x += (Math.random() - 0.5) * this.settingDistort * 80;\r\n            pos.y += (Math.random() - 0.5) * this.settingDistort * 80;\r\n        }\r\n\r\n        this.minY = Math.min(this.minY, pos.y);\r\n        this.maxY = Math.max(this.maxY, pos.y);\r\n        this.path.push(pos);\r\n        this.updateCompleteRedrawBounds(x, y);\r\n        this.drawShape();\r\n    }\r\n\r\n    endLine (): void {\r\n        this.isDrawing = false;\r\n        this.completeRedrawBounds = BB.boundsInArea(this.completeRedrawBounds, this.copyCanvas.width, this.copyCanvas.height);\r\n        if (this.path.length > 1 && this.completeRedrawBounds) {\r\n            const historyCanvas = BB.canvas(\r\n                this.completeRedrawBounds.x2 - this.completeRedrawBounds.x1 + 1,\r\n                this.completeRedrawBounds.y2 - this.completeRedrawBounds.y1 + 1\r\n            );\r\n            const historyCtx = historyCanvas.getContext('2d');\r\n            historyCtx.drawImage(this.context.canvas, -this.completeRedrawBounds.x1, -this.completeRedrawBounds.y1);\r\n\r\n            this.history.push({\r\n                tool: [\"brush\", \"ChemyBrush\"],\r\n                actions: [\r\n                    {\r\n                        action: \"drawImage\",\r\n                        params: [\r\n                            historyCanvas, // faster than getting image data (measured on 2018 lenovo chromebook)\r\n                            this.completeRedrawBounds.x1,\r\n                            this.completeRedrawBounds.y1,\r\n                        ],\r\n                    }\r\n                ]\r\n            });\r\n        }\r\n        this.path = null;\r\n        this.copyCanvas = null;\r\n    }\r\n\r\n    drawImage (im: HTMLCanvasElement, x: number, y: number): void {\r\n        this.context.save();\r\n        this.context.clearRect(x, y, im.width, im.height);\r\n        this.context.drawImage(im, x, y);\r\n        this.context.restore();\r\n    }\r\n\r\n    drawLineSegment (x1, y1, x2, y2): void {\r\n        // might make sense for stroke\r\n    }\r\n}\r\n","import {penBrushUi} from './pen-brush-ui';\r\nimport {blendBrushUi} from './blend-brush-ui';\r\nimport {sketchyBrushUi} from './sketchy-brush-ui';\r\nimport {pixelBrushUi} from './pixel-brush-ui';\r\nimport {eraserBrushUi} from './eraser-brush-ui';\r\nimport {smudgeBrushUi} from './smudge-brush-ui';\r\nimport {chemyBrushUi} from './chemy-brush-ui';\r\nimport {IBrushUi} from '../kl.types';\r\n\r\n/**\r\n * UI for brushes.\r\n * Each brush ui carries the brush with it.\r\n * So if you want to draw, you do it through the UI. should be changed sometime.\r\n */\r\n\r\nexport const brushesUI: {\r\n    [key: string]: IBrushUi;\r\n} = {\r\n    penBrush: penBrushUi,\r\n    blendBrush: blendBrushUi,\r\n    sketchyBrush: sketchyBrushUi,\r\n    pixelBrush: pixelBrushUi,\r\n    chemyBrush: chemyBrushUi,\r\n    smudgeBrush: smudgeBrushUi,\r\n    eraserBrush: eraserBrushUi,\r\n};\r\n","import {BB} from '../../bb/bb';\r\nimport {brushes} from '../brushes/brushes';\r\nimport {eventResMs} from './brushes-consts';\r\nimport {klHistory} from '../history/kl-history';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {KlSlider} from '../ui/base-components/kl-slider';\r\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\r\n// @ts-ignore\r\nimport brushIconImg from 'url:~/src/app/img/ui/brush-pen.svg';\r\nimport {genBrushAlpha01, genBrushAlpha02} from '../brushes/alphas/brush-alphas';\r\nimport {IBrushUi} from '../kl.types';\r\nimport {LANG, languageStrings} from '../../language/language';\r\n\r\nexport const penBrushUi = (function () {\r\n    let brushInterface: IBrushUi = {\r\n        image: brushIconImg,\r\n        tooltip: LANG('brush-pen'),\r\n        sizeSlider: {\r\n            min: 0.5,\r\n            max: 100,\r\n            curve: BB.quadraticSplineInput(0.5, 100, 0.1)\r\n        },\r\n        opacitySlider: {\r\n            min: 0,\r\n            max: 1,\r\n            curve: [[0, 1 / 100], [0.5, 0.3], [1, 1]]\r\n        },\r\n        Ui: null,\r\n    };\r\n\r\n    let alphaNames = [\r\n        LANG('brush-pen-circle'),\r\n        LANG('brush-pen-chalk'),\r\n        LANG('brush-pen-calligraphy'),\r\n        LANG('brush-pen-square'),\r\n    ];\r\n    languageStrings.subscribe(() => {\r\n        brushInterface.tooltip = LANG('brush-pen');\r\n        alphaNames = [\r\n            LANG('brush-pen-circle'),\r\n            LANG('brush-pen-chalk'),\r\n            LANG('brush-pen-calligraphy'),\r\n            LANG('brush-pen-square'),\r\n        ];\r\n    });\r\n\r\n    brushInterface.Ui = function (p) {\r\n        let div = document.createElement(\"div\"); // the gui\r\n        let brush = new brushes.PenBrush();\r\n        brush.setHistory(klHistory);\r\n        p.onSizeChange(brush.getSize());\r\n        let sizeSlider;\r\n        let opacitySlider;\r\n\r\n        let alphas = [];\r\n        let currentAlpha = 0;\r\n        for (let i = 0; i < 4; i++) {\r\n            (function (i) {\r\n                let alpha = BB.el({\r\n                    title: alphaNames[i],\r\n                    onClick: () => {\r\n                        alphaClick(i);\r\n                    }\r\n                });\r\n                let canvas = BB.canvas(70, 70);\r\n                let ctx = canvas.getContext('2d');\r\n                if (i === 0 || i === 3) {\r\n                    if (i === 0) {\r\n                        ctx.beginPath();\r\n                        ctx.arc(35, 35, 30, 0, 2 * Math.PI);\r\n                        ctx.closePath();\r\n                        ctx.fill();\r\n                    } else {\r\n                        ctx.fillRect(5, 5, 60, 60);\r\n                    }\r\n                } else if (i === 1) {\r\n                    ctx.drawImage(genBrushAlpha01(60), 5, 5);\r\n                } else if (i === 2) {\r\n                    ctx.drawImage(genBrushAlpha02(60), 5, 5);\r\n                }\r\n                alpha.style.backgroundImage = 'url(' + canvas.toDataURL('image/png') + ')';\r\n\r\n                alphas.push(alpha);\r\n            }(i));\r\n        }\r\n\r\n        function updateAlphas() {\r\n            for (let i = 0; i < alphas.length; i++) {\r\n                if (i === currentAlpha) {\r\n                    alphas[i].className = 'brush-alpha-selected';\r\n                } else {\r\n                    alphas[i].className = 'brush-alpha';\r\n                }\r\n            }\r\n        }\r\n\r\n        updateAlphas();\r\n\r\n        function alphaClick(id) {\r\n            currentAlpha = id;\r\n            brush.setAlpha(id);\r\n            updateAlphas();\r\n        }\r\n\r\n        let lockAlphaToggle = new Checkbox({\r\n            init: brush.getLockAlpha(),\r\n            label: LANG('brush-lock-alpha'),\r\n            callback: function (b) {\r\n                brush.setLockAlpha(b);\r\n            },\r\n            doHighlight: true,\r\n            title: LANG('brush-lock-alpha-title'),\r\n            css: {\r\n                cssFloat: 'right',\r\n                textAlign: 'right',\r\n            }\r\n        });\r\n\r\n        let spacingSpline = new BB.SplineInterpolator([[0, 15], [8, 7], [14, 4], [30, 3], [50, 2.7], [100, 2]]);\r\n\r\n        function setSize(size) {\r\n            brush.setSize(size);\r\n            brush.setSpacing(Math.max(2, spacingSpline.interpolate(size)) / 15);\r\n        }\r\n\r\n        function init() {\r\n            sizeSlider = new KlSlider({\r\n                label: LANG('brush-size'),\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.sizeSlider.min,\r\n                max: brushInterface.sizeSlider.max,\r\n                initValue: brush.getSize(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    setSize(val);\r\n                    p.onSizeChange(val);\r\n                },\r\n                curve: brushInterface.sizeSlider.curve,\r\n                formatFunc: function (v) {\r\n                    v *= 2;\r\n                    if (v < 10) {\r\n                        return Math.round(v * 10) / 10;\r\n                    } else {\r\n                        return Math.round(v);\r\n                    }\r\n                }\r\n            });\r\n            opacitySlider = new KlSlider({\r\n                label: LANG('opacity'),\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.opacitySlider.min,\r\n                max: brushInterface.opacitySlider.max,\r\n                initValue: brushInterface.opacitySlider.max,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setOpacity(val);\r\n                    p.onOpacityChange(val);\r\n                },\r\n                curve: brushInterface.opacitySlider.curve,\r\n                formatFunc: function(v) {\r\n                    return Math.round(v * 100);\r\n                }\r\n            });\r\n\r\n            let pressureSizeToggle = penPressureToggle(true, function (b) {\r\n                brush.sizePressure(b);\r\n            });\r\n            let pressureOpacityToggle = penPressureToggle(false, function (b) {\r\n                brush.opacityPressure(b);\r\n            });\r\n\r\n            div.append(\r\n                BB.el({\r\n                    content: [\r\n                        sizeSlider.getElement(),\r\n                        pressureSizeToggle\r\n                    ],\r\n                    css: {\r\n                        display: 'flex',\r\n                        justifyContent: 'space-between',\r\n                        alignItems: 'center',\r\n                        marginBottom: '10px',\r\n                    }\r\n                }),\r\n                BB.el({\r\n                    content: [\r\n                        opacitySlider.getElement(),\r\n                        pressureOpacityToggle\r\n                    ],\r\n                    css: {\r\n                        display: 'flex',\r\n                        justifyContent: 'space-between',\r\n                        alignItems: 'center',\r\n                    }\r\n                })\r\n            );\r\n\r\n            let alphaWrapper = document.createElement(\"div\");\r\n            for (let i = 0; i < alphas.length; i++) {\r\n                alphaWrapper.appendChild(alphas[i]);\r\n            }\r\n            alphaWrapper.style.marginTop = \"10px\";\r\n            div.appendChild(alphaWrapper);\r\n            alphaWrapper.appendChild(lockAlphaToggle.getElement());\r\n\r\n        }\r\n\r\n        init();\r\n\r\n        this.increaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.increaseValue(f);\r\n            }\r\n        };\r\n        this.decreaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.decreaseValue(f);\r\n            }\r\n        };\r\n\r\n        this.getSize = function () {\r\n            return brush.getSize();\r\n        };\r\n        this.setSize = function(size) {\r\n            setSize(size);\r\n            sizeSlider.setValue(size);\r\n        };\r\n        this.getOpacity = function () {\r\n            return brush.getOpacity();\r\n        };\r\n        this.setOpacity = function(opacity) {\r\n            brush.setOpacity(opacity);\r\n            opacitySlider.setValue(opacity);\r\n        };\r\n\r\n        this.setColor = function (c) {\r\n            brush.setColor(c);\r\n        };\r\n        this.setContext = function (c) {\r\n            brush.setContext(c);\r\n        };\r\n        this.startLine = function (x, y, p) {\r\n            brush.startLine(x, y, p);\r\n        };\r\n        this.goLine = function (x, y, p) {\r\n            brush.goLine(x, y, p);\r\n        };\r\n        this.endLine = function (x, y) {\r\n            brush.endLine(x, y);\r\n        };\r\n        this.getBrush = function () {\r\n            return brush;\r\n        };\r\n        this.isDrawing = function () {\r\n            return brush.isDrawing();\r\n        };\r\n        this.getElement = function () {\r\n            return div;\r\n        };\r\n    };\r\n    return brushInterface;\r\n})();","\r\nexport const eventResMs = 20;","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"iiCd6\");","import {BB} from '../../bb/bb';\r\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\r\nimport {eventResMs} from './brushes-consts';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {brushes} from '../brushes/brushes';\r\nimport {klHistory} from '../history/kl-history';\r\nimport {KlSlider} from '../ui/base-components/kl-slider';\r\n// @ts-ignore\r\nimport brushIconImg from 'url:~/src/app/img/ui/brush-blend.svg';\r\nimport {IBrushUi} from '../kl.types';\r\nimport {LANG, languageStrings} from '../../language/language';\r\n\r\nexport const blendBrushUi = (function () {\r\n    let brushInterface: IBrushUi = {\r\n        image: brushIconImg,\r\n        tooltip: LANG('brush-blend'),\r\n        sizeSlider: {\r\n            min: 0.5,\r\n            max: 100,\r\n            curve: BB.quadraticSplineInput(0.5, 100, 0.1)\r\n        },\r\n        opacitySlider: {\r\n            min: 1 / 100,\r\n            max: 1\r\n        },\r\n        Ui: null,\r\n    };\r\n\r\n    languageStrings.subscribe(() => {\r\n        brushInterface.tooltip = LANG('brush-blend');\r\n    });\r\n\r\n    brushInterface.Ui = function (p) {\r\n        let div = document.createElement(\"div\"); // the gui\r\n        let brush = new brushes.BlendBrush();\r\n        brush.setHistory(klHistory);\r\n        p.onSizeChange(brush.getSize());\r\n\r\n        let sizeSlider;\r\n        let opacitySlider;\r\n\r\n        function setSize(size) {\r\n            brush.setSize(size);\r\n        }\r\n\r\n        function init() {\r\n            sizeSlider = new KlSlider({\r\n                label: LANG('brush-size'),\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.sizeSlider.min,\r\n                max: brushInterface.sizeSlider.max,\r\n                initValue: 58 / 2,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    setSize(val);\r\n                    p.onSizeChange(val);\r\n                },\r\n                curve: brushInterface.sizeSlider.curve,\r\n                formatFunc: function (v) {\r\n                    v *= 2;\r\n                    return Math.round(v);\r\n                }\r\n            });\r\n            opacitySlider = new KlSlider({\r\n                label: LANG('opacity'),\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.opacitySlider.min,\r\n                max: brushInterface.opacitySlider.max,\r\n                initValue: brush.getOpacity(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setOpacity(val);\r\n                    p.onOpacityChange(val);\r\n                },\r\n                formatFunc: function(v) {\r\n                    return Math.round(v * 100);\r\n                }\r\n            });\r\n            let blendingSlider = new KlSlider({\r\n                label: LANG('brush-blending'),\r\n                width: 225,\r\n                height: 30,\r\n                min: 0,\r\n                max: 100,\r\n                initValue: brush.getBlending() * 100,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setBlending(val / 100);\r\n                }\r\n            });\r\n            blendingSlider.getElement().style.marginTop = \"10px\";\r\n\r\n            let pressureSizeToggle = penPressureToggle(true, function (b) {\r\n                brush.setSizePressure(b);\r\n            });\r\n            let pressureOpacityToggle = penPressureToggle(false, function (b) {\r\n                brush.setOpacityPressure(b);\r\n            });\r\n\r\n            let lockAlphaToggle = new Checkbox({\r\n                init: brush.getLockAlpha(),\r\n                label: LANG('brush-lock-alpha'),\r\n                callback: function (b) {\r\n                    brush.setLockAlpha(b);\r\n                },\r\n                doHighlight: true,\r\n                title: LANG('brush-lock-alpha-title'),\r\n                css: {\r\n                    marginTop: '10px',\r\n                    display: 'inline-block',\r\n                }\r\n            });\r\n\r\n\r\n            div.append(\r\n                BB.el({\r\n                    content: [\r\n                        sizeSlider.getElement(),\r\n                        pressureSizeToggle\r\n                    ],\r\n                    css: {\r\n                        display: 'flex',\r\n                        justifyContent: 'space-between',\r\n                        alignItems: 'center',\r\n                        marginBottom: '10px',\r\n                    }\r\n                }),\r\n                BB.el({\r\n                    content: [\r\n                        opacitySlider.getElement(),\r\n                        pressureOpacityToggle\r\n                    ],\r\n                    css: {\r\n                        display: 'flex',\r\n                        justifyContent: 'space-between',\r\n                        alignItems: 'center',\r\n                    }\r\n                }),\r\n                blendingSlider.getElement(),\r\n                lockAlphaToggle.getElement()\r\n            );\r\n        }\r\n\r\n        init();\r\n\r\n        this.increaseSize = function (f) {\r\n            if (!brush.getIsDrawing()) {\r\n                sizeSlider.increaseValue(f);\r\n            }\r\n        };\r\n        this.decreaseSize = function (f) {\r\n            if (!brush.getIsDrawing()) {\r\n                sizeSlider.decreaseValue(f);\r\n            }\r\n        };\r\n\r\n        this.getSize = function () {\r\n            return brush.getSize();\r\n        };\r\n        this.setSize = function(size) {\r\n            setSize(size);\r\n            sizeSlider.setValue(size);\r\n        };\r\n        this.getOpacity = function () {\r\n            return brush.getOpacity();\r\n        };\r\n        this.setOpacity = function(opacity) {\r\n            brush.setOpacity(opacity);\r\n            opacitySlider.setValue(opacity);\r\n        };\r\n\r\n        this.setColor = function (c) {\r\n            brush.setColor(c);\r\n        };\r\n        this.setContext = function (c) {\r\n            brush.setContext(c);\r\n        };\r\n        this.startLine = function (x, y, p) {\r\n            brush.startLine(x, y, p);\r\n        };\r\n        this.goLine = function (x, y, p, isCoalesced) {\r\n            brush.goLine(x, y, p, isCoalesced);\r\n        };\r\n        this.endLine = function () {\r\n            brush.endLine();\r\n        };\r\n        this.getBrush = function () {\r\n            return brush;\r\n        };\r\n        this.isDrawing = function () {\r\n            return brush.getIsDrawing();\r\n        };\r\n        this.getElement = function () {\r\n            return div;\r\n        };\r\n    };\r\n\r\n    return brushInterface;\r\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"6fRlX\");","import {brushes} from '../brushes/brushes';\r\nimport {eventResMs} from './brushes-consts';\r\nimport {klHistory} from '../history/kl-history';\r\nimport {KlSlider} from '../ui/base-components/kl-slider';\r\n// @ts-ignore\r\nimport brushIconImg from 'url:~/src/app/img/ui/brush-sketchy.png';\r\nimport {IBrushUi} from '../kl.types';\r\nimport {LANG, languageStrings} from '../../language/language';\r\n\r\nexport const sketchyBrushUi = (function () {\r\n    let brushInterface: IBrushUi = {\r\n        image: brushIconImg,\r\n        tooltip: LANG('brush-sketchy'),\r\n        sizeSlider: {\r\n            min: 0.5,\r\n            max: 10\r\n        },\r\n        opacitySlider: {\r\n            min: 1 / 100,\r\n            max: 1\r\n        },\r\n        Ui: null,\r\n    };\r\n\r\n    languageStrings.subscribe(() => {\r\n        brushInterface.tooltip = LANG('brush-sketchy');\r\n    });\r\n\r\n    brushInterface.Ui = function (p) {\r\n        let div = document.createElement(\"div\"); // the gui\r\n        let brush = new brushes.SketchyBrush();\r\n        brush.setHistory(klHistory);\r\n        p.onSizeChange(brush.getSize());\r\n        let sizeSlider;\r\n        let opacitySlider;\r\n\r\n        function setSize(size) {\r\n            brush.setSize(size);\r\n        }\r\n\r\n        function init() {\r\n            sizeSlider = new KlSlider({\r\n                label: LANG('brush-size'),\r\n                width: 250,\r\n                height: 30,\r\n                min: brushInterface.sizeSlider.min,\r\n                max: brushInterface.sizeSlider.max,\r\n                initValue: brush.getSize(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setSize(val);\r\n                    p.onSizeChange(brush.getSize());\r\n                },\r\n                formatFunc: function (v) {\r\n                    v *= 2;\r\n                    if (v < 10) {\r\n                        return Math.round(v * 10) / 10;\r\n                    } else {\r\n                        return Math.round(v);\r\n                    }\r\n                }\r\n            });\r\n            opacitySlider = new KlSlider({\r\n                label: LANG('opacity'),\r\n                width: 250,\r\n                height: 30,\r\n                min: brushInterface.opacitySlider.min,\r\n                max: brushInterface.opacitySlider.max,\r\n                initValue: brush.getOpacity(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setOpacity(val);\r\n                    p.onOpacityChange(val);\r\n                },\r\n                formatFunc: function(v) {\r\n                    return Math.round(v * 100);\r\n                }\r\n            });\r\n            let blendSlider = new KlSlider({\r\n                label: LANG('brush-blending'),\r\n                width: 250,\r\n                height: 30,\r\n                min: 0,\r\n                max: 100,\r\n                initValue: brush.getBlending() * 100,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setBlending(val / 100);\r\n                }\r\n            });\r\n            let scaleSlider = new KlSlider({\r\n                label: LANG('brush-sketchy-scale'),\r\n                width: 250,\r\n                height: 30,\r\n                min: 1,\r\n                max: 20,\r\n                initValue: brush.getScale(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setScale(val);\r\n                }\r\n            });\r\n            opacitySlider.getElement().style.marginTop = \"10px\";\r\n            blendSlider.getElement().style.marginTop = \"10px\";\r\n            scaleSlider.getElement().style.marginTop = \"10px\";\r\n            div.appendChild(sizeSlider.getElement());\r\n            div.appendChild(opacitySlider.getElement());\r\n            div.appendChild(blendSlider.getElement());\r\n            div.appendChild(scaleSlider.getElement());\r\n        }\r\n\r\n        init();\r\n\r\n        this.increaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.increaseValue(f);\r\n            }\r\n        };\r\n        this.decreaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.decreaseValue(f);\r\n            }\r\n        };\r\n        this.getSize = function () {\r\n            return brush.getSize();\r\n        };\r\n        this.setSize = function(size) {\r\n            setSize(size);\r\n            sizeSlider.setValue(size);\r\n        };\r\n        this.getOpacity = function () {\r\n            return brush.getOpacity();\r\n        };\r\n        this.setOpacity = function(opacity) {\r\n            brush.setOpacity(opacity);\r\n            opacitySlider.setValue(opacity);\r\n        };\r\n        this.setColor = function (c) {\r\n            brush.setColor(c);\r\n        };\r\n        this.setContext = function (c) {\r\n            brush.setContext(c);\r\n        };\r\n        this.startLine = function (x, y, pressure) {\r\n            brush.startLine(x, y, pressure);\r\n        };\r\n        this.goLine = function (x, y, pressure) {\r\n            brush.goLine(x, y, pressure, null);\r\n        };\r\n        this.endLine = function () {\r\n            brush.endLine();\r\n        };\r\n        this.getSeed = function () {\r\n            return parseInt(brush.getSeed());\r\n        };\r\n        this.setSeed = function (s) {\r\n            brush.setSeed(parseInt(s));\r\n        };\r\n        this.getBrush = function () {\r\n            return brush;\r\n        };\r\n        this.isDrawing = function () {\r\n            return brush.isDrawing();\r\n        };\r\n        this.getElement = function () {\r\n            return div;\r\n        };\r\n    };\r\n\r\n    return brushInterface;\r\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"hC7PC\");","import {BB} from '../../bb/bb';\r\nimport {brushes} from '../brushes/brushes';\r\nimport {eventResMs} from './brushes-consts';\r\nimport {klHistory} from '../history/kl-history';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {KlSlider} from '../ui/base-components/kl-slider';\r\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\r\n// @ts-ignore\r\nimport brushIconImg from 'url:~/src/app/img/ui/brush-pixel.svg';\r\nimport {IBrushUi} from '../kl.types';\r\nimport {LANG, languageStrings} from '../../language/language';\r\n\r\nexport const pixelBrushUi = (function () {\r\n    let brushInterface: IBrushUi = {\r\n        image: brushIconImg,\r\n        tooltip: LANG('brush-pixel'),\r\n        sizeSlider: {\r\n            min: 0.5,\r\n            max: 100,\r\n            curve: BB.quadraticSplineInput(0.5, 100, 0.1)\r\n        },\r\n        opacitySlider: {\r\n            min: 0,\r\n            max: 1,\r\n            curve: [[0, 1 / 100], [0.5, 0.3], [1, 1]]\r\n        },\r\n        Ui: null,\r\n    };\r\n\r\n    languageStrings.subscribe(() => {\r\n        brushInterface.tooltip = LANG('brush-pixel');\r\n    });\r\n\r\n    brushInterface.Ui = function (p) {\r\n        let div = document.createElement(\"div\"); // the gui\r\n        let brush = new brushes.PixelBrush();\r\n        brush.setHistory(klHistory);\r\n        p.onSizeChange(brush.getSize());\r\n        let sizeSlider;\r\n        let opacitySlider;\r\n\r\n        let lockAlphaToggle = new Checkbox({\r\n            init: brush.getLockAlpha(),\r\n            label: LANG('brush-lock-alpha'),\r\n            callback: function (b) {\r\n                brush.setLockAlpha(b);\r\n            },\r\n            doHighlight: true,\r\n            title: LANG('brush-lock-alpha-title'),\r\n            css: {\r\n                marginRight: '10px',\r\n            }\r\n        });\r\n\r\n        let eraserToggle = new Checkbox({\r\n            init: brush.getIsEraser(),\r\n            label: LANG('eraser'),\r\n            callback: function (b) {\r\n                brush.setIsEraser(b);\r\n            },\r\n            css: {\r\n                marginRight: '10px',\r\n            }\r\n        });\r\n\r\n        let ditherToggle = new Checkbox({\r\n            init: brush.getUseDither(),\r\n            label: LANG('brush-pixel-dither'),\r\n            callback: function (b) {\r\n                brush.setUseDither(b);\r\n            }\r\n        });\r\n\r\n        let spacingSpline = new BB.SplineInterpolator([[0.5, 0.45], [100, 4]]);\r\n\r\n        function setSize(size) {\r\n            brush.setSize(size);\r\n            brush.setSpacing(spacingSpline.interpolate(size) / size);\r\n        }\r\n\r\n        function init() {\r\n            sizeSlider = new KlSlider({\r\n                label: LANG('brush-size'),\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.sizeSlider.min,\r\n                max: brushInterface.sizeSlider.max,\r\n                initValue: brush.getSize(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    val = Math.round(val * 2) / 2;\r\n                    setSize(val);\r\n                    p.onSizeChange(val);\r\n                },\r\n                curve: brushInterface.sizeSlider.curve,\r\n                formatFunc: function (v) {\r\n                    v *= 2;\r\n                    return Math.round(v);\r\n                }\r\n            });\r\n            opacitySlider = new KlSlider({\r\n                label: LANG('opacity'),\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.opacitySlider.min,\r\n                max: brushInterface.opacitySlider.max,\r\n                initValue: brushInterface.opacitySlider.max,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setOpacity(val);\r\n                    p.onOpacityChange(val);\r\n                },\r\n                curve: brushInterface.opacitySlider.curve,\r\n                formatFunc: function(v) {\r\n                    return Math.round(v * 100);\r\n                }\r\n            });\r\n\r\n            let pressureSizeToggle = penPressureToggle(true, function (b) {\r\n                brush.sizePressure(b);\r\n            });\r\n\r\n            div.append(\r\n                BB.el({\r\n                    content: [\r\n                        sizeSlider.getElement(),\r\n                        pressureSizeToggle\r\n                    ],\r\n                    css: {\r\n                        display: 'flex',\r\n                        justifyContent: 'space-between',\r\n                        alignItems: 'center',\r\n                        marginBottom: '10px',\r\n                    }\r\n                }),\r\n                opacitySlider.getElement()\r\n            );\r\n\r\n            let toggleRow = BB.el({\r\n                parent: div,\r\n                css: {\r\n                    display: 'flex',\r\n                    marginTop: '10px'\r\n                }\r\n            });\r\n\r\n            toggleRow.appendChild(lockAlphaToggle.getElement());\r\n            toggleRow.appendChild(eraserToggle.getElement());\r\n            toggleRow.appendChild(ditherToggle.getElement());\r\n        }\r\n\r\n        init();\r\n\r\n        this.increaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.increaseValue(f);\r\n            }\r\n        };\r\n        this.decreaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.decreaseValue(f);\r\n            }\r\n        };\r\n\r\n        this.getSize = function () {\r\n            return brush.getSize();\r\n        };\r\n        this.setSize = function(size) {\r\n            setSize(size);\r\n            sizeSlider.setValue(size);\r\n        };\r\n        this.getOpacity = function () {\r\n            return brush.getOpacity();\r\n        };\r\n        this.setOpacity = function(opacity) {\r\n            brush.setOpacity(opacity);\r\n            opacitySlider.setValue(opacity);\r\n        };\r\n\r\n        this.setColor = function (c) {\r\n            brush.setColor(c);\r\n        };\r\n        this.setContext = function (c) {\r\n            brush.setContext(c);\r\n        };\r\n        this.startLine = function (x, y, p) {\r\n            brush.startLine(x, y, p);\r\n        };\r\n        this.goLine = function (x, y, p) {\r\n            brush.goLine(x, y, p);\r\n        };\r\n        this.endLine = function (x, y) {\r\n            brush.endLine(x, y);\r\n        };\r\n        this.getBrush = function () {\r\n            return brush;\r\n        };\r\n        this.isDrawing = function () {\r\n            return brush.isDrawing();\r\n        };\r\n        this.getElement = function () {\r\n            return div;\r\n        };\r\n    };\r\n    return brushInterface;\r\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"eZgVv\");","import {BB} from '../../bb/bb';\r\nimport {brushes} from '../brushes/brushes';\r\nimport {eventResMs} from './brushes-consts';\r\nimport {klHistory} from '../history/kl-history';\r\nimport {KlSlider} from '../ui/base-components/kl-slider';\r\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\n// @ts-ignore\r\nimport brushIconImg from 'url:~/src/app/img/ui/brush-eraser.svg';\r\nimport {IBrushUi} from '../kl.types';\r\nimport {LANG, languageStrings} from '../../language/language';\r\n\r\nexport const eraserBrushUi = (function () {\r\n    let brushInterface: IBrushUi = {\r\n        image: brushIconImg,\r\n        tooltip: LANG('eraser') + ' [E]',\r\n        sizeSlider: {\r\n            min: 0.5,\r\n            max: 200,\r\n            curve: BB.quadraticSplineInput(0.5, 200, 0.1)\r\n        },\r\n        opacitySlider: {\r\n            min: 1 / 100,\r\n            max: 1\r\n        },\r\n        Ui: null,\r\n    };\r\n\r\n    languageStrings.subscribe(() => {\r\n        brushInterface.tooltip = LANG('eraser') + ' [E]';\r\n    });\r\n\r\n    brushInterface.Ui = function (p) {\r\n        let div = document.createElement(\"div\"); // the gui\r\n        let brush = new brushes.EraserBrush();\r\n        brush.setHistory(klHistory);\r\n        p.onSizeChange(brush.getSize());\r\n\r\n        let sizeSlider;\r\n        let opacitySlider;\r\n        let isTransparentBg = false;\r\n\r\n        function setSize(size) {\r\n            brush.setSize(size);\r\n        }\r\n\r\n        function init() {\r\n            sizeSlider = new KlSlider({\r\n                label: LANG('brush-size'),\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.sizeSlider.min,\r\n                max: brushInterface.sizeSlider.max,\r\n                initValue: 30,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    setSize(val);\r\n                    p.onSizeChange(val);\r\n                },\r\n                curve: brushInterface.sizeSlider.curve,\r\n                formatFunc: function (v) {\r\n                    v *= 2;\r\n                    if (v < 10) {\r\n                        return Math.round(v * 10) / 10;\r\n                    } else {\r\n                        return Math.round(v);\r\n                    }\r\n                }\r\n            });\r\n            opacitySlider = new KlSlider({\r\n                label: LANG('opacity'),\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.opacitySlider.min,\r\n                max: brushInterface.opacitySlider.max,\r\n                initValue: 1,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setOpacity(val);\r\n                    p.onOpacityChange(val);\r\n                },\r\n                formatFunc: function(v) {\r\n                    return Math.round(v * 100);\r\n                }\r\n            });\r\n\r\n            let pressureSizeToggle = penPressureToggle(true, function (b) {\r\n                brush.sizePressure(b);\r\n            });\r\n            let pressureOpacityToggle = penPressureToggle(false, function (b) {\r\n                brush.opacityPressure(b);\r\n            });\r\n\r\n            div.append(\r\n                BB.el({\r\n                    content: [\r\n                        sizeSlider.getElement(),\r\n                        pressureSizeToggle\r\n                    ],\r\n                    css: {\r\n                        display: 'flex',\r\n                        justifyContent: 'space-between',\r\n                        alignItems: 'center',\r\n                        marginBottom: '10px',\r\n                    }\r\n                }),\r\n                BB.el({\r\n                    content: [\r\n                        opacitySlider.getElement(),\r\n                        pressureOpacityToggle\r\n                    ],\r\n                    css: {\r\n                        display: 'flex',\r\n                        justifyContent: 'space-between',\r\n                        alignItems: 'center',\r\n                    }\r\n                })\r\n            );\r\n\r\n            let transparencyToggle = new Checkbox({\r\n                init: false,\r\n                label: LANG('brush-eraser-transparent-bg'),\r\n                callback: function (b) {\r\n                    isTransparentBg = b;\r\n                    brush.setTransparentBG(b);\r\n                },\r\n                css: {\r\n                    marginTop: \"10px\",\r\n                }\r\n            });\r\n            div.appendChild(transparencyToggle.getElement());\r\n        }\r\n\r\n        init();\r\n\r\n        function drawDot(x, y) {\r\n            brush.drawDot(x, y);\r\n        }\r\n\r\n        this.increaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.increaseValue(f);\r\n            }\r\n        };\r\n        this.decreaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.decreaseValue(f);\r\n            }\r\n        };\r\n        this.getSize = function () {\r\n            return brush.getSize();\r\n        };\r\n        this.setSize = function(size) {\r\n            setSize(size);\r\n            sizeSlider.setValue(size);\r\n        };\r\n        this.getOpacity = function () {\r\n            return brush.getOpacity();\r\n        };\r\n        this.setOpacity = function(opacity) {\r\n            brush.setOpacity(opacity);\r\n            opacitySlider.setValue(opacity);\r\n        };\r\n        this.setColor = function (c) {\r\n            //brush.setColor(c);\r\n        };\r\n        this.setContext = function (c) {\r\n            brush.setContext(c);\r\n        };\r\n        this.startLine = function (x, y, p) {\r\n            brush.startLine(x, y, p);\r\n        };\r\n        this.goLine = function (x, y, p) {\r\n            brush.goLine(x, y, p);\r\n        };\r\n        this.endLine = function () {\r\n            brush.endLine();\r\n        };\r\n        this.getBrush = function () {\r\n            return brush;\r\n        };\r\n        this.getIsTransparentBg = function () {\r\n            return isTransparentBg;\r\n        };\r\n        this.isDrawing = function () {\r\n            return brush.isDrawing();\r\n        };\r\n        this.getElement = function () {\r\n            return div;\r\n        }\r\n    };\r\n\r\n    return brushInterface;\r\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"fPZin\");","import {BB} from '../../bb/bb';\r\nimport {brushes} from '../brushes/brushes';\r\nimport {eventResMs} from './brushes-consts';\r\nimport {klHistory} from '../history/kl-history';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {KlSlider} from '../ui/base-components/kl-slider';\r\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\r\n// @ts-ignore\r\nimport brushIconImg from 'url:~/src/app/img/ui/brush-smudge.svg';\r\nimport {IBrushUi} from '../kl.types';\r\nimport {LANG, languageStrings} from '../../language/language';\r\n\r\nexport const smudgeBrushUi = (function () {\r\n    let brushInterface: IBrushUi = {\r\n        image: brushIconImg,\r\n        tooltip: LANG('brush-smudge'),\r\n        sizeSlider: {\r\n            min: 0.5,\r\n            max: 100,\r\n            curve: BB.quadraticSplineInput(0.5, 100, 0.1)\r\n        },\r\n        opacitySlider: {\r\n            min: 0,\r\n            max: 1,\r\n            curve: [[0, 1 / 100], [0.5, 0.3], [1, 1]]\r\n        },\r\n        Ui: null,\r\n    };\r\n\r\n    languageStrings.subscribe(() => {\r\n        brushInterface.tooltip = LANG('brush-smudge');\r\n    });\r\n\r\n    brushInterface.Ui = function (p) {\r\n        let div = document.createElement(\"div\"); // the gui\r\n        let brush = new brushes.SmudgeBrush();\r\n        brush.setHistory(klHistory);\r\n        p.onSizeChange(brush.getSize());\r\n        let sizeSlider;\r\n        let opacitySlider;\r\n\r\n        let lockAlphaToggle = new Checkbox({\r\n            init: brush.getLockAlpha(),\r\n            label: LANG('brush-lock-alpha'),\r\n            callback: function (b) {\r\n                brush.setLockAlpha(b);\r\n            },\r\n            doHighlight: true,\r\n            title: LANG('brush-lock-alpha-title'),\r\n        });\r\n\r\n        let spacingSpline = new BB.SplineInterpolator([[0, 15], [8, 7], [14, 4], [30, 3], [50, 2.7], [100, 2]]);\r\n\r\n        function setSize(size) {\r\n            brush.setSize(size);\r\n            brush.setSpacing(Math.max(2, spacingSpline.interpolate(size)) / 15);\r\n        }\r\n\r\n        function init() {\r\n            sizeSlider = new KlSlider({\r\n                label: LANG('brush-size'),\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.sizeSlider.min,\r\n                max: brushInterface.sizeSlider.max,\r\n                initValue: brush.getSize(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    setSize(val);\r\n                    p.onSizeChange(val);\r\n                },\r\n                curve: brushInterface.sizeSlider.curve,\r\n                formatFunc: function (v) {\r\n                    v *= 2;\r\n                    if (v < 10) {\r\n                        return Math.round(v * 10) / 10;\r\n                    } else {\r\n                        return Math.round(v);\r\n                    }\r\n                }\r\n            });\r\n            opacitySlider = new KlSlider({\r\n                label: LANG('opacity'),\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.opacitySlider.min,\r\n                max: brushInterface.opacitySlider.max,\r\n                initValue: brush.getOpacity(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setOpacity(val);\r\n                    p.onOpacityChange(val);\r\n                },\r\n                curve: brushInterface.opacitySlider.curve,\r\n                formatFunc: function(v) {\r\n                    return Math.round(v * 100);\r\n                }\r\n            });\r\n\r\n            let pressureSizeToggle = penPressureToggle(false, function (b) {\r\n                brush.sizePressure(b);\r\n            });\r\n            let pressureOpacityToggle = penPressureToggle(false, function (b) {\r\n                brush.opacityPressure(b);\r\n            });\r\n\r\n            div.append(\r\n                BB.el({\r\n                    content: [\r\n                        sizeSlider.getElement(),\r\n                        pressureSizeToggle\r\n                    ],\r\n                    css: {\r\n                        display: 'flex',\r\n                        justifyContent: 'space-between',\r\n                        alignItems: 'center',\r\n                        marginBottom: '10px',\r\n                    }\r\n                }),\r\n                BB.el({\r\n                    content: [\r\n                        opacitySlider.getElement(),\r\n                        pressureOpacityToggle\r\n                    ],\r\n                    css: {\r\n                        display: 'flex',\r\n                        justifyContent: 'space-between',\r\n                        alignItems: 'center',\r\n                    }\r\n                })\r\n            );\r\n\r\n            let bottomRow = BB.el({\r\n                parent: div,\r\n                css: {\r\n                    marginTop: '10px',\r\n                }\r\n            });\r\n            bottomRow.append(lockAlphaToggle.getElement());\r\n\r\n        }\r\n\r\n        init();\r\n\r\n        this.increaseSize = function (f) {\r\n            if (!brush.getIsDrawing()) {\r\n                sizeSlider.increaseValue(f);\r\n            }\r\n        };\r\n        this.decreaseSize = function (f) {\r\n            if (!brush.getIsDrawing()) {\r\n                sizeSlider.decreaseValue(f);\r\n            }\r\n        };\r\n\r\n        this.getSize = function () {\r\n            return brush.getSize();\r\n        };\r\n        this.setSize = function(size) {\r\n            setSize(size);\r\n            sizeSlider.setValue(size);\r\n        };\r\n        this.getOpacity = function () {\r\n            return brush.getOpacity();\r\n        };\r\n        this.setOpacity = function(opacity) {\r\n            brush.setOpacity(opacity);\r\n            opacitySlider.setValue(opacity);\r\n        };\r\n\r\n        this.setColor = function (c) {\r\n            brush.setColor(c);\r\n        };\r\n        this.setContext = function (c) {\r\n            brush.setContext(c);\r\n        };\r\n        this.startLine = function (x, y, p) {\r\n            brush.startLine(x, y, p);\r\n        };\r\n        this.goLine = function (x, y, p) {\r\n            brush.goLine(x, y, p);\r\n        };\r\n        this.endLine = function (x, y) {\r\n            brush.endLine();\r\n        };\r\n        this.getBrush = function () {\r\n            return brush;\r\n        };\r\n        this.isDrawing = function () {\r\n            return brush.getIsDrawing();\r\n        };\r\n        this.getElement = function () {\r\n            return div;\r\n        };\r\n    };\r\n    return brushInterface;\r\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"fp7H1\");","import {BB} from '../../bb/bb';\r\nimport {eventResMs} from './brushes-consts';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {brushes} from '../brushes/brushes';\r\nimport {klHistory} from '../history/kl-history';\r\nimport {KlSlider} from '../ui/base-components/kl-slider';\r\n// @ts-ignore\r\nimport brushIconImg from 'url:~/src/app/img/ui/brush-chemy.svg';\r\nimport {IBrushUi} from '../kl.types';\r\nimport {Options} from '../ui/base-components/options';\r\nimport {BoxToggle} from '../ui/base-components/box-toggle';\r\nimport {LANG, languageStrings} from '../../language/language';\r\n\r\nexport const chemyBrushUi = (function () {\r\n    const brushInterface: IBrushUi = {\r\n        image: brushIconImg,\r\n        tooltip: LANG('brush-chemy'),\r\n        sizeSlider: {\r\n            min: 0.25,\r\n            max: 25,\r\n            curve: BB.quadraticSplineInput(0.25, 25, 0.1),\r\n            isDisabled: true,\r\n        },\r\n        opacitySlider: {\r\n            min: 1 / 100,\r\n            max: 1\r\n        },\r\n        Ui: null,\r\n    };\r\n\r\n    languageStrings.subscribe(() => {\r\n        brushInterface.tooltip = LANG('brush-chemy');\r\n    });\r\n\r\n    brushInterface.Ui = function (p) {\r\n        const div = document.createElement(\"div\"); // the gui\r\n        const brush = new brushes.ChemyBrush();\r\n        brush.setHistory(klHistory);\r\n        p.onSizeChange(brush.getSize());\r\n\r\n        let sizeSlider;\r\n        let opacitySlider;\r\n\r\n        function setSize(size) {\r\n            brush.setSize(size);\r\n        }\r\n\r\n        function init() {\r\n            sizeSlider = new KlSlider({\r\n                label: LANG('brush-size'),\r\n                width: 250,\r\n                height: 30,\r\n                min: brushInterface.sizeSlider.min,\r\n                max: brushInterface.sizeSlider.max,\r\n                initValue: brush.getSize(),\r\n                eventResMs: eventResMs,\r\n                isEnabled: brush.getMode() === 'stroke',\r\n                onChange: function (val) {\r\n                    setSize(val);\r\n                    p.onSizeChange(brush.getSize());\r\n                },\r\n                curve: brushInterface.sizeSlider.curve,\r\n                formatFunc: function (v) {\r\n                    v *= 2;\r\n                    return v < 5 ? (Math.round(v * 10) / 10) : Math.round(v);\r\n                }\r\n            });\r\n            opacitySlider = new KlSlider({\r\n                label: LANG('opacity'),\r\n                width: 250,\r\n                height: 30,\r\n                min: brushInterface.opacitySlider.min,\r\n                max: brushInterface.opacitySlider.max,\r\n                initValue: brush.getOpacity(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setOpacity(val);\r\n                    p.onOpacityChange(val);\r\n                },\r\n                formatFunc: function(v) {\r\n                    return Math.round(v * 100);\r\n                }\r\n            });\r\n\r\n            BB.css(opacitySlider.getElement(), {\r\n                marginTop: '10px',\r\n            });\r\n\r\n            let eraserToggle = new Checkbox({\r\n                init: brush.getIsEraser(),\r\n                label: LANG('eraser'),\r\n                callback: function (b) {\r\n                    brush.setIsEraser(b);\r\n                },\r\n                css: {\r\n                    marginTop: '10px',\r\n                    marginLeft: '10px',\r\n                }\r\n            });\r\n\r\n            const lockAlphaToggle = new Checkbox({\r\n                init: brush.getLockAlpha(),\r\n                label: LANG('brush-lock-alpha'),\r\n                callback: function (b) {\r\n                    brush.setLockAlpha(b);\r\n                },\r\n                doHighlight: true,\r\n                title: LANG('brush-lock-alpha-title'),\r\n                css: {\r\n                    marginTop: '10px',\r\n                }\r\n            });\r\n\r\n            const toggleRow = BB.el({\r\n                css: {\r\n                    display: 'flex',\r\n                    marginTop: '10px',\r\n                }\r\n            });\r\n\r\n            const iconSize = 35;\r\n            const padding = 8;\r\n            const actualIconSize = iconSize - padding * 2;\r\n            const halfSize = actualIconSize / 2;\r\n\r\n            const modeOptions = new Options({\r\n                optionArr: [\r\n                    {\r\n                        id: 'fill',\r\n                        label: BB.createSvg({\r\n                            elementType: 'svg',\r\n                            width: iconSize + '',\r\n                            height: iconSize + '',\r\n                            childrenArr: [\r\n                                {\r\n                                    elementType: 'path',\r\n                                    fill: '#000',\r\n                                    style: `transform-origin: 0 0; transform: translate(-0.5px, -0.5px) scale(${actualIconSize}, ${actualIconSize}) translate(0.5px, 0.5px)`,\r\n                                    d: 'M 0,0 C 1.5,0 -0.5,1 1,1',\r\n                                },\r\n                            ],\r\n                        }),\r\n                        title: LANG('brush-chemy-fill'),\r\n                    },\r\n                    {\r\n                        id: 'stroke',\r\n                        label: BB.createSvg({\r\n                            elementType: 'svg',\r\n                            width: iconSize + '',\r\n                            height: iconSize + '',\r\n                            childrenArr: [\r\n                                {\r\n                                    elementType: 'path',\r\n                                    fill: 'none',\r\n                                    stroke: '#000',\r\n                                    style: `stroke-width: 0.12px; transform-origin: 0 0; transform: translate(-0.5px, -0.5px) scale(${actualIconSize}, ${actualIconSize}) translate(0.5px, 0.5px)`,\r\n                                    d: 'M 0,0 C 1.5,0 -0.5,1 1,1',\r\n                                },\r\n                            ],\r\n                        }),\r\n                        title: LANG('brush-chemy-stroke'),\r\n                    }\r\n                ],\r\n                initId: brush.getMode(),\r\n                onChange: (id: string): void => {\r\n                    brush.setMode(id as 'stroke' | 'fill');\r\n                    brushInterface.sizeSlider.isDisabled = brush.getMode() === 'fill';\r\n                    sizeSlider.setIsEnabled(!brushInterface.sizeSlider.isDisabled);\r\n                    sizeSlider.setValue(brush.getSize());\r\n                    p.onSizeChange(brush.getSize());\r\n                    p.onConfigChange();\r\n                }\r\n            });\r\n\r\n            const mirrorXToggle = new BoxToggle({\r\n                label: BB.createSvg({\r\n                    elementType: 'svg',\r\n                    width: iconSize + '',\r\n                    height: iconSize + '',\r\n                    childrenArr: [\r\n                        {\r\n                            elementType: 'path',\r\n                            fill: 'none',\r\n                            stroke: '#000',\r\n                            style: 'stroke-width: 1px',\r\n                            d: `M ${halfSize + padding},${padding} ${halfSize + padding},${actualIconSize + padding}`,\r\n                        },\r\n                    ]\r\n                }),\r\n                title: LANG('brush-chemy-mirror-x'),\r\n                init: brush.getXSymmetry(),\r\n                onChange: (b) => {\r\n                    brush.setXSymmetry(b);\r\n                },\r\n            });\r\n\r\n            const mirrorYToggle = new BoxToggle({\r\n                label: BB.createSvg({\r\n                    elementType: 'svg',\r\n                    width: iconSize + '',\r\n                    height: iconSize + '',\r\n                    childrenArr: [\r\n                        {\r\n                            elementType: 'path',\r\n                            fill: 'none',\r\n                            stroke: '#000',\r\n                            style: 'stroke-width: 1px',\r\n                            d: `M ${padding},${halfSize + padding} ${actualIconSize + padding},${halfSize + padding}`,\r\n                        },\r\n                    ]\r\n                }),\r\n                title: LANG('brush-chemy-mirror-y'),\r\n                init: brush.getYSymmetry(),\r\n                onChange: (b) => {\r\n                    brush.setYSymmetry(b);\r\n                },\r\n            });\r\n\r\n            const gradientToggle = new BoxToggle({\r\n                label: BB.createSvg({\r\n                    elementType: 'svg',\r\n                    width: iconSize + '',\r\n                    height: iconSize + '',\r\n                    childrenArr: [\r\n                        {\r\n                            elementType: 'defs',\r\n                            childrenArr: [\r\n                                {\r\n                                    elementType: 'linearGradient',\r\n                                    id: 'gradient',\r\n                                    x1: '0',\r\n                                    y1: '0',\r\n                                    x2: '0',\r\n                                    y2: '1',\r\n                                    childrenArr: [\r\n                                        {\r\n                                            elementType: 'stop',\r\n                                            offset: '0%',\r\n                                            'stop-color': 'rgba(0,0,0,0)',\r\n                                        },\r\n                                        {\r\n                                            elementType: 'stop',\r\n                                            offset: '100%',\r\n                                            'stop-color': 'rgba(0,0,0,1)',\r\n                                        }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            elementType: 'rect',\r\n                            fill: \"url('#gradient')\",\r\n                            x: '' + padding,\r\n                            y: '' + padding,\r\n                            width: '' + actualIconSize,\r\n                            height: '' + actualIconSize,\r\n                        },\r\n                    ]\r\n                }),\r\n                title: LANG('brush-chemy-gradient'),\r\n                init: brush.getGradient(),\r\n                onChange: (b) => {\r\n                    brush.setGradient(b);\r\n                },\r\n            });\r\n\r\n            BB.css(mirrorXToggle.getElement(), {\r\n                marginLeft: '10px',\r\n            });\r\n            {\r\n                const margin = {\r\n                    marginLeft: '4px',\r\n                };\r\n                BB.css(mirrorYToggle.getElement(), margin);\r\n                BB.css(gradientToggle.getElement(), margin);\r\n            }\r\n\r\n            toggleRow.append(\r\n                modeOptions.getElement(),\r\n                mirrorXToggle.getElement(),\r\n                mirrorYToggle.getElement(),\r\n                gradientToggle.getElement(),\r\n            );\r\n\r\n            div.append(\r\n                sizeSlider.getElement(),\r\n                opacitySlider.getElement(),\r\n                toggleRow,\r\n                BB.el({\r\n                    content: [\r\n                        lockAlphaToggle.getElement(),\r\n                        eraserToggle.getElement(),\r\n                    ],\r\n                    css: {\r\n                        display: 'flex',\r\n                    }\r\n                })\r\n            );\r\n        }\r\n\r\n        init();\r\n\r\n        this.increaseSize = function (f) {\r\n            if (!brush.getIsDrawing() && brush.getMode() === 'stroke') {\r\n                sizeSlider.increaseValue(f);\r\n            }\r\n        };\r\n        this.decreaseSize = function (f) {\r\n            if (!brush.getIsDrawing() && brush.getMode() === 'stroke') {\r\n                sizeSlider.decreaseValue(f);\r\n            }\r\n        };\r\n\r\n        this.getSize = function () {\r\n            return brush.getSize();\r\n        };\r\n        this.setSize = function(size) {\r\n            setSize(size);\r\n            sizeSlider.setValue(size);\r\n        };\r\n        this.getOpacity = function () {\r\n            return brush.getOpacity();\r\n        };\r\n        this.setOpacity = function(opacity) {\r\n            brush.setOpacity(opacity);\r\n            opacitySlider.setValue(opacity);\r\n        };\r\n\r\n        this.setColor = function (c) {\r\n            brush.setColor(c);\r\n        };\r\n        this.setContext = function (c) {\r\n            brush.setContext(c);\r\n        };\r\n        this.startLine = function (x, y, p) {\r\n            brush.startLine(x, y);\r\n        };\r\n        this.goLine = function (x, y, p, isCoalesced) {\r\n            brush.goLine(x, y);\r\n        };\r\n        this.endLine = function () {\r\n            brush.endLine();\r\n        };\r\n        this.getBrush = function () {\r\n            return brush;\r\n        };\r\n        this.isDrawing = function () {\r\n            return brush.getIsDrawing();\r\n        };\r\n        this.getElement = function () {\r\n            return div;\r\n        };\r\n    };\r\n\r\n    return brushInterface;\r\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"eX098\");","import {BB} from '../../../bb/bb';\r\n\r\nexport class BoxToggle {\r\n    el: HTMLElement;\r\n    value: boolean;\r\n\r\n    update (): void {\r\n        if (this.value) {\r\n            BB.addClassName(this.el, 'kl-box-toggle--active');\r\n        } else {\r\n            BB.removeClassName(this.el, 'kl-box-toggle--active');\r\n        }\r\n    }\r\n\r\n    // --- public ---\r\n    constructor (\r\n        p: {\r\n            label: string | HTMLElement | SVGElement;\r\n            title?: string;\r\n            init?: boolean;\r\n            onChange: (b: boolean) => void;\r\n        }\r\n    ) {\r\n        this.value = !!p.init;\r\n        this.el = BB.el({\r\n            content: p.label,\r\n            title: p.title,\r\n            className: (typeof p.label === 'string') ? 'kl-box-toggle' : 'kl-box-toggle kl-box-toggle--custom-el',\r\n            onClick: () => {\r\n                this.value = !this.value;\r\n                this.update();\r\n                p.onChange(this.value);\r\n            },\r\n            css: {\r\n                cursor: 'pointer',\r\n            }\r\n        });\r\n        if (typeof p.label !== 'string') {\r\n            BB.css(p.label, {\r\n                display: 'block',\r\n                pointerEvents: 'none',\r\n            });\r\n        }\r\n        this.update();\r\n    }\r\n\r\n    getValue (): boolean {\r\n        return this.value;\r\n    }\r\n\r\n    setValue (b: boolean): void {\r\n        this.value = !!b;\r\n        this.update();\r\n    }\r\n\r\n    getElement (): HTMLElement {\r\n        return this.el;\r\n    }\r\n\r\n    destroy (): void {\r\n        BB.destroyEl(this.el);\r\n    }\r\n}","import {BB} from '../../../bb/bb';\r\nimport {Popup} from './popup';\r\nimport {LANG} from '../../../language/language';\r\n\r\nexport function showIframePopup(url, isEmbed) {\r\n    if (!isEmbed && (window.innerHeight < 500 || window.innerWidth < 700)) {\r\n        window.open(url);\r\n        return;\r\n    }\r\n\r\n    let iframe = BB.el({\r\n        tagName: 'iframe',\r\n        custom: {\r\n            src: url,\r\n        },\r\n        css: {\r\n            width: '100%',\r\n            height: '100%'\r\n        }\r\n    }) as HTMLIFrameElement;\r\n    let titleEl = BB.el({});\r\n\r\n    let linkEl;\r\n    if (!isEmbed) {\r\n        linkEl = BB.el({\r\n            tagName: 'a',\r\n            parent: titleEl,\r\n            content: LANG('modal-new-tab'),\r\n            custom: {\r\n                href: 'help',\r\n                target: '_blank',\r\n            },\r\n            onClick: function() {\r\n                popup.close();\r\n            }\r\n        }) as HTMLAnchorElement;\r\n        iframe.onload = function() {\r\n            BB.setAttributes(linkEl, {\r\n                href: '' + iframe.contentWindow.location,\r\n            });\r\n        };\r\n    }\r\n\r\n\r\n    let popup = new Popup({\r\n        title: titleEl,\r\n        content: iframe,\r\n        width: 880,\r\n        isMaxHeight: true,\r\n        onClose: () => {\r\n            if (linkEl) {\r\n                BB.destroyEl(linkEl);\r\n            }\r\n        }\r\n    });\r\n\r\n}","import {BB} from '../../../bb/bb';\r\n\r\nexport class RadioList {\r\n\r\n    el: HTMLDivElement;\r\n    inputs: HTMLInputElement[] = [];\r\n\r\n    constructor(p: {\r\n        name: string;\r\n        init?: string;\r\n        items: {\r\n            label: string;\r\n            value: string;\r\n        }[],\r\n        ignoreFocus?: boolean; // default false\r\n    }) {\r\n        this.el = BB.el({\r\n            className: 'kl-radio'\r\n        }) as HTMLDivElement;\r\n\r\n        p.items.forEach(item => {\r\n            let label = BB.el({\r\n                tagName: 'label'\r\n            });\r\n            let input = BB.el({\r\n                tagName: 'input',\r\n                parent: label,\r\n                custom: {\r\n                    name: p.name,\r\n                    value: item.value,\r\n                    type: 'radio',\r\n                }\r\n            }) as HTMLInputElement;\r\n            if (p.ignoreFocus) {\r\n                input.setAttribute('data-ignore-focus', 'true');\r\n            }\r\n            if (p.init === item.value) {\r\n                input.checked = true;\r\n            }\r\n            label.append(item.label);\r\n            this.el.append(label);\r\n            this.inputs.push(input);\r\n        });\r\n    }\r\n\r\n\r\n    getValue(): string {\r\n        for (let i = 0; i < this.inputs.length; i++) {\r\n            if (this.inputs[i].checked) {\r\n                return this.inputs[i].value;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    getElement() {\r\n        return this.el;\r\n    }\r\n\r\n}","import {BB} from '../../../bb/bb';\r\n\r\n// @ts-ignore\r\nimport removeLayerImg from 'url:~/src/app/img/ui/remove-layer.svg';\r\nimport {IKlProject} from '../../kl.types';\r\nimport {showIframePopup} from '../modals/show-iframe-popup';\r\nimport {SaveReminder} from './save-reminder';\r\nimport {ProjectStore} from '../../storage/project-store';\r\nimport {KL} from '../../kl';\r\nimport {LANG} from '../../../language/language';\r\n\r\nexport class BrowserStorageUi {\r\n\r\n    private previewEl: HTMLDivElement;\r\n    private ageEl: HTMLDivElement;\r\n    private storeEl: HTMLButtonElement;\r\n    private clearEl: HTMLButtonElement;\r\n\r\n    private timestamp: number;\r\n\r\n    private updateAge() {\r\n        if (!this.timestamp) {\r\n            return;\r\n        }\r\n        let age = new Date().getTime() - this.timestamp;\r\n        let ageStr;\r\n        age = Math.floor(age / 1000 / 60);\r\n        ageStr = LANG('file-storage-min-ago').replace('{x}', '' + age);\r\n        if (age > 60) {\r\n            age = Math.floor(age / 60);\r\n            ageStr = LANG('file-storage-hours-ago').replace('{x}', '' + age);\r\n            if (age > 24) {\r\n                age = Math.floor(age / 24);\r\n                ageStr = LANG('file-storage-days-ago').replace('{x}', '' + age);\r\n                if (age > 31) {\r\n                    ageStr = LANG('file-storage-month-ago');\r\n                }\r\n            }\r\n        }\r\n        this.ageEl.textContent = ageStr;\r\n    }\r\n\r\n    private resetButtons() {\r\n        if (this.timestamp) {\r\n            this.storeEl.textContent = LANG('file-storage-overwrite');\r\n            this.storeEl.disabled = false;\r\n            this.clearEl.disabled = false;\r\n        } else {\r\n            this.storeEl.textContent = LANG('file-storage-store');\r\n            this.storeEl.disabled = false;\r\n            this.clearEl.disabled = true;\r\n        }\r\n    }\r\n\r\n    private updateThumb(timestamp?: number, thumbnail?: HTMLImageElement | HTMLCanvasElement) {\r\n        this.timestamp = timestamp;\r\n        if (this.timestamp) {\r\n            BB.css(thumbnail, {\r\n                display: 'block',\r\n                maxWidth: 'calc(100% - 2px)',\r\n                maxHeight: 'calc(100% - 2px)',\r\n                margin: '0 auto',\r\n                background: \"url('\" + BB.createCheckerCanvas(4).toDataURL('image/png') + \"')\",\r\n                boxShadow: '0 0 0 1px #aaa',\r\n                pointerEvents: 'none',\r\n            });\r\n            this.previewEl.innerHTML = '';\r\n            this.updateAge();\r\n            this.previewEl.append(thumbnail, this.ageEl);\r\n        } else {\r\n            this.previewEl.innerHTML = LANG('file-storage-empty');\r\n        }\r\n        this.resetButtons();\r\n    }\r\n\r\n    private async store() {\r\n        this.storeEl.textContent = LANG('file-storage-storing');\r\n        this.storeEl.disabled = true;\r\n        this.clearEl.disabled = true;\r\n        await new Promise((resolve) => {\r\n            setTimeout(() => resolve(null), 20);\r\n        });\r\n        try {\r\n            await this.projectStore.store(this.getProject());\r\n            this.saveReminder.reset();\r\n        } catch (e) {\r\n            this.resetButtons();\r\n            KL.popup({\r\n                target: this.klRootEl,\r\n                type: 'error',\r\n                message: [\r\n                    `${LANG('file-storage-failed-1')}<ul>`,\r\n                    `<li>${LANG('file-storage-failed-2')}</li>`,\r\n                    `<li>${LANG('file-storage-failed-3')}</li>`,\r\n                    `<li>${LANG('file-storage-failed-4')}</li>`,\r\n                    `</ul>`,\r\n                ].join(''),\r\n                buttons: ['Ok'],\r\n            });\r\n            setTimeout(() => {\r\n                throw new Error('storage-ui: failed to store browser storage, ' + e);\r\n            }, 0);\r\n        }\r\n    }\r\n\r\n    private async clear() {\r\n        this.storeEl.disabled = true;\r\n        this.clearEl.disabled = true;\r\n        try {\r\n            await this.projectStore.clear();\r\n        } catch (e) {\r\n            this.resetButtons();\r\n            KL.popup({\r\n                target: this.klRootEl,\r\n                type: 'error',\r\n                message: LANG('file-storage-failed-clear'),\r\n                buttons: ['Ok'],\r\n            });\r\n            setTimeout(() => {\r\n                throw new Error('storage-ui: failed to clear browser storage, ' + e);\r\n            }, 0);\r\n        }\r\n    }\r\n\r\n    element: HTMLDivElement;\r\n\r\n    constructor (\r\n        private projectStore: ProjectStore,\r\n        private getProject: () => IKlProject,\r\n        private saveReminder: SaveReminder,\r\n        private klRootEl: HTMLDivElement,\r\n    ) {\r\n        this.element = BB.el({\r\n            css: {\r\n                display: 'grid',\r\n                gridTemplateColumns: '1fr 0fr',\r\n                gridTemplateRows: '0fr 0fr 0fr',\r\n                gap: '0 0',\r\n                gridTemplateAreas: '\"title title\" \"preview store\" \"preview clear\"',\r\n            }\r\n        }) as HTMLDivElement;\r\n\r\n\r\n        const title = BB.el({\r\n            parent: this.element,\r\n            content: LANG('file-storage'),\r\n            css: {\r\n                gridArea: 'title',\r\n                display: 'flex',\r\n                margin: '-5px 0',\r\n                //background: '#f00',\r\n            }\r\n        });\r\n\r\n        const infoEl = BB.el({\r\n            parent: title,\r\n            content: '?',\r\n            title: LANG('file-storage-about'),\r\n            css: {\r\n                cursor: 'pointer',\r\n                marginLeft: '5px',\r\n                width: '19px',\r\n                height: '19px',\r\n                borderRadius: '100%',\r\n                textAlign: 'center',\r\n                lineHeight: '19px',\r\n                fontWeight: 'bold',\r\n                boxShadow: 'inset 0 0 0 1px #000',\r\n            },\r\n            onClick: () => {\r\n                showIframePopup('./help/#help-browser-storage', false);\r\n            }\r\n        });\r\n\r\n        if (this.projectStore.isBroken()) {\r\n            BB.el({\r\n                parent: this.element,\r\n                content: \"🔴 \" + LANG('file-storage-cant-access'),\r\n                css: {\r\n                    marginTop: '10px',\r\n                }\r\n            });\r\n            return;\r\n        }\r\n\r\n        this.previewEl = BB.el({\r\n            parent: this.element,\r\n            title: LANG('file-storage-thumb-title'),\r\n            css: {\r\n                gridArea: 'preview',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                marginTop: '10px',\r\n                position: 'relative',\r\n                boxShadow: 'inset 0 0 0 1px #aaa',\r\n                background: '#cdcdcd',\r\n                color: '#545454',\r\n                colorScheme: 'only light',\r\n            }\r\n        }) as HTMLDivElement;\r\n        this.ageEl = BB.el({\r\n            css: {\r\n                position: 'absolute',\r\n                right: '0',\r\n                bottom: '0',\r\n                width: '100%',\r\n                textAlign: 'center',\r\n                background: 'rgba(0,0,0,0.7)',\r\n                color: '#fff',\r\n                textSize: '13px',\r\n            }\r\n        }) as HTMLDivElement;\r\n        this.storeEl = BB.el({\r\n            parent: this.element,\r\n            tagName: 'button',\r\n            className: 'gridButton',\r\n            content: LANG('file-storage-store'),\r\n            css: {\r\n                gridArea: 'store',\r\n                //background: '#00f',\r\n            },\r\n            custom: {\r\n                tabIndex: -1,\r\n            },\r\n            onClick: () => this.store(),\r\n        }) as HTMLButtonElement;\r\n        this.storeEl.tabIndex = -1;\r\n        this.clearEl = BB.el({\r\n            parent: this.element,\r\n            tagName: 'button',\r\n            className: 'gridButton',\r\n            content: '<img src=\"' + removeLayerImg + '\" height=\"20\"/> ' + LANG('file-storage-clear'),\r\n            css: {\r\n                gridArea: 'clear',\r\n                //background: '#ff0',\r\n            },\r\n            custom: {\r\n                tabIndex: -1,\r\n            },\r\n            onClick: () => this.clear(),\r\n        }) as HTMLButtonElement;\r\n\r\n        this.projectStore.subscribe({\r\n            onUpdate: (timestamp, thumbnail) => {\r\n                this.updateThumb(timestamp, thumbnail);\r\n            },\r\n        });\r\n\r\n        setInterval(() => this.updateAge(), 1000 * 60);\r\n\r\n        (async () => {\r\n            try {\r\n                const readResult = await this.projectStore.read();\r\n                if (readResult) {\r\n                    this.updateThumb(readResult.timestamp, readResult.thumbnail);\r\n                } else {\r\n                    this.updateThumb();\r\n                }\r\n            } catch (e) {\r\n                setTimeout(() => {\r\n                    throw new Error('storage-ui: failed initial read browser storage, ' + e);\r\n                }, 0);\r\n            }\r\n        })();\r\n    }\r\n\r\n\r\n    getElement() {\r\n        return this.element;\r\n    }\r\n\r\n    show () {\r\n        // todo\r\n    }\r\n\r\n    hide () {\r\n        // todo\r\n    }\r\n}","import {IKlProject, IKlStorageProject} from '../kl.types';\r\nimport {ProjectConverter} from './project-converter';\r\nimport {clear, getKlProjectObj, storeKlProjectObj} from './indexed-db';\r\nimport {LocalStorage} from '../../bb/base/local-storage';\r\n\r\n\r\nexport interface IProjectStoreListener {\r\n    onUpdate: (timestamp?: number, thumbnail?: HTMLImageElement | HTMLCanvasElement) => void,\r\n}\r\n\r\nfunction makeAsync(func): Promise<any> {\r\n    return new Promise((resolve, reject) => {\r\n        func(resolve, reject);\r\n    });\r\n}\r\n\r\n/**\r\n * simplified interface for storing projects into browser storage\r\n */\r\nexport class ProjectStore {\r\n\r\n    private listeners: IProjectStoreListener[] = [];\r\n    private accessHasFailed: boolean = false;\r\n\r\n    async lowLevelStore (project: IKlStorageProject): Promise<any> {\r\n        await new Promise((resolve, reject) => {\r\n            storeKlProjectObj(project, resolve, reject);\r\n        });\r\n    }\r\n\r\n    async lowLevelRead (): Promise<IKlStorageProject> {\r\n        return await makeAsync(getKlProjectObj) as IKlStorageProject;\r\n    }\r\n\r\n    async lowLevelClear (): Promise<any> {\r\n        await makeAsync(clear);\r\n    }\r\n\r\n\r\n\r\n    private emit(timestamp?: number, thumbnail?: HTMLImageElement | HTMLCanvasElement) {\r\n        this.listeners.forEach(item => {\r\n            item.onUpdate(timestamp, thumbnail);\r\n        });\r\n    }\r\n\r\n    private updateTimestamp() {\r\n        LocalStorage.setItem('indexedDbUpdatedAt', '' + new Date().getTime());\r\n    }\r\n\r\n    // --- public ---\r\n\r\n    constructor () {\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key !== 'indexedDbUpdatedAt' || this.listeners.length === 0) {\r\n                return;\r\n            }\r\n            try {\r\n                ( async () => {\r\n                    const readResult = await this.read();\r\n                    if (readResult) {\r\n                        this.emit(readResult.timestamp, readResult.thumbnail);\r\n                    } else {\r\n                        this.emit();\r\n                    }\r\n                })();\r\n            } catch (e) {\r\n                if (e.message === 'db-error') {\r\n                    this.accessHasFailed = true;\r\n                }\r\n            }\r\n\r\n        });\r\n    }\r\n\r\n    async read(): Promise<{\r\n        project: IKlProject,\r\n        timestamp: number,\r\n        thumbnail: HTMLImageElement | HTMLCanvasElement\r\n    } | null> {\r\n        let storageProject;\r\n        try {\r\n            storageProject = await this.lowLevelRead();\r\n        } catch (e) {\r\n            this.accessHasFailed = true;\r\n            throw new Error('db-error');\r\n        }\r\n        if (!storageProject) {\r\n            return null;\r\n        }\r\n        let result;\r\n        try {\r\n            result = await ProjectConverter.readStorageProject(storageProject);\r\n        } catch (e) {\r\n            throw new Error('format-error');\r\n        }\r\n        return result;\r\n    }\r\n\r\n    async store(project: IKlProject): Promise<void> {\r\n        try {\r\n            const storageProject = ProjectConverter.createStorageProject(project);\r\n            await this.lowLevelStore(storageProject);\r\n        } catch (e) {\r\n            this.accessHasFailed = true;\r\n            throw new Error('db-error');\r\n        }\r\n        {\r\n            // immediately test if it can be read\r\n            const storageProject = await this.lowLevelRead();\r\n            let readResult = null;\r\n            try {\r\n                readResult = await ProjectConverter.readStorageProject(storageProject);\r\n            } catch (e) {\r\n                await this.lowLevelClear();\r\n                this.updateTimestamp();\r\n                setTimeout(() => this.emit(), 0);\r\n                throw new Error('format-error');\r\n            }\r\n            this.updateTimestamp();\r\n            setTimeout(() => this.emit(readResult.timestamp, readResult.thumbnail), 0);\r\n        }\r\n    }\r\n\r\n    async clear(): Promise<void> {\r\n        await this.lowLevelClear();\r\n        this.updateTimestamp();\r\n        setTimeout(() => this.emit(), 0);\r\n    }\r\n\r\n    subscribe(listener: IProjectStoreListener) {\r\n        if (this.listeners.includes(listener)) {\r\n            return;\r\n        }\r\n        this.listeners.push(listener);\r\n    }\r\n\r\n    unsubscribe(listener: IProjectStoreListener) {\r\n        for (let i = 0; i < this.listeners.length; i++) {\r\n            if (listener === this.listeners[i]) {\r\n                this.listeners.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    isBroken() {\r\n        return this.accessHasFailed;\r\n    }\r\n\r\n}","import {IKlProject, IKlStorageProject} from '../kl.types';\r\nimport {BB} from '../../bb/bb';\r\nimport {drawProject} from '../canvas/draw-project';\r\nimport {base64ToBlob} from './base-64-to-blob';\r\n\r\n\r\nconst thumbSize = 240;\r\n\r\nfunction loadImage(blob: Blob): Promise<HTMLImageElement> {\r\n    return new Promise<HTMLImageElement>((resolve, reject) => {\r\n        const im = new Image();\r\n        try {\r\n            im.src = BB.imageBlobToUrl(blob);\r\n        } catch (e) {\r\n            reject('imageBlobToUrl, ' + e.message);\r\n            return;\r\n        }\r\n        im.onload = () => {\r\n            URL.revokeObjectURL(im.src);\r\n            resolve(im);\r\n        }\r\n        im.onabort = function () {\r\n            reject('layer image failed loading');\r\n        };\r\n        im.onerror = function () {\r\n            reject('layer image failed loading');\r\n        };\r\n    });\r\n}\r\n\r\n/**\r\n * for:\r\n * - preparing project to be stored in ProjectStore\r\n * - reading a project that came out of the ProjectStore\r\n */\r\nexport class ProjectConverter {\r\n\r\n    private static createThumbnail(project): HTMLCanvasElement {\r\n        const size = BB.fitInto(project.width, project.height, thumbSize, thumbSize);\r\n        const factor = size.width / project.width;\r\n        return drawProject(project, factor);\r\n    }\r\n\r\n    static createStorageProject(project: IKlProject): IKlStorageProject {\r\n        return {\r\n            id: 1,\r\n            timestamp: new Date().getTime(),\r\n            thumbnail: base64ToBlob(ProjectConverter.createThumbnail(project).toDataURL('image/png')),\r\n            width: project.width,\r\n            height: project.height,\r\n            layers: project.layers.map(item => {\r\n                let blob;\r\n                if (item.image instanceof HTMLCanvasElement) {\r\n                    blob = base64ToBlob((item.image as HTMLCanvasElement).toDataURL('image/png'));\r\n                } else {\r\n                    // todo image\r\n                    throw new Error('Not implemented');\r\n                }\r\n                return {\r\n                    name: item.name,\r\n                    opacity: item.opacity,\r\n                    mixModeStr: item.mixModeStr,\r\n                    blob,\r\n                }\r\n            }),\r\n        };\r\n    }\r\n\r\n    static async readStorageProject(storageProject: IKlStorageProject): Promise<{\r\n        project: IKlProject,\r\n        timestamp: number,\r\n        thumbnail: HTMLImageElement | HTMLCanvasElement\r\n    }> {\r\n        const project: IKlProject = {\r\n            width: storageProject.width,\r\n            height: storageProject.height,\r\n            layers: (await Promise.all(storageProject.layers.map(layer => loadImage(layer.blob))))\r\n                .map((image, i) => {\r\n                    return {\r\n                        name: storageProject.layers[i].name,\r\n                        opacity: storageProject.layers[i].opacity,\r\n                        mixModeStr: storageProject.layers[i].mixModeStr,\r\n                        image,\r\n                    };\r\n                }),\r\n        };\r\n\r\n        let thumbnail;\r\n        if (storageProject.thumbnail) {\r\n            thumbnail = await loadImage(storageProject.thumbnail);\r\n        } else {\r\n            thumbnail = ProjectConverter.createThumbnail(project);\r\n        }\r\n\r\n        return {\r\n            project: project,\r\n            timestamp: storageProject.timestamp,\r\n            thumbnail: thumbnail,\r\n        };\r\n    }\r\n\r\n}","\r\nexport function base64ToBlob(base64Str: string): Blob {\r\n    let parts = base64Str.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);\r\n    let binStr = atob(parts[3]);\r\n    let buf = new ArrayBuffer(binStr.length);\r\n    let view = new Uint8Array(buf);\r\n    for (let i = 0; i < view.length; i++) {\r\n        view[i] = binStr.charCodeAt(i);\r\n    }\r\n    return new Blob([view], {'type': parts[1]});\r\n}","import {BB} from '../../../bb/bb';\r\nimport {KL} from '../../kl';\r\n// @ts-ignore\r\nimport newImageImg from 'url:~/src/app/img/ui/new-image.svg';\r\n// @ts-ignore\r\nimport exportImg from 'url:~/src/app/img/ui/export.svg';\r\n// @ts-ignore\r\nimport shareImg from 'url:~/src/app/img/ui/share.svg';\r\n// @ts-ignore\r\nimport uploadImg from 'url:~/src/app/img/ui/upload.svg';\r\n// @ts-ignore\r\nimport importImg from 'url:~/src/app/img/ui/import.svg';\r\n// @ts-ignore\r\nimport copyImg from 'url:~/src/app/img/ui/copy.svg';\r\nimport {BrowserStorageUi} from '../components/browser-storage-ui';\r\nimport {IKlProject} from '../../kl.types';\r\nimport {SaveReminder} from '../components/save-reminder';\r\nimport {ProjectStore} from '../../storage/project-store';\r\nimport {LANG} from '../../../language/language';\r\n\r\nexport type exportType = 'png' | 'layers' | 'psd';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport class FileTab {\r\n\r\n    private readonly div: HTMLDivElement;\r\n    private importButton: HTMLInputElement;\r\n    private fileBrowserStorage: BrowserStorageUi;\r\n\r\n    constructor(\r\n        klRootEl,\r\n        projectStore: ProjectStore,\r\n        getProject: () => IKlProject,\r\n        private exportType,\r\n        onExportTypeChange,\r\n        onFileSelect,\r\n        onSaveImageToComputer,\r\n        onNewImage,\r\n        onShareImage,\r\n        onUpload,\r\n        onCopyToClipboard,\r\n        saveReminder: SaveReminder,\r\n    ) {\r\n        const _this = this;\r\n        this.div = document.createElement(\"div\");\r\n\r\n        const asyncCreation = () => {\r\n            let filemenu = document.createElement(\"div\");\r\n            let newButton = document.createElement(\"button\");\r\n            let saveButton = document.createElement(\"button\");\r\n            let shareButton = document.createElement(\"button\");\r\n            let uploadImgurButton = document.createElement(\"button\");\r\n            let clipboardButton = document.createElement(\"button\");\r\n\r\n            newButton.style.cssFloat = 'left';\r\n            BB.css(saveButton, {\r\n                cssFloat: 'left',\r\n                clear: 'both',\r\n            });\r\n            BB.css(clipboardButton, {\r\n                cssFloat: 'left',\r\n                clear: 'both',\r\n            });\r\n\r\n            newButton.tabIndex = -1;\r\n            saveButton.tabIndex = -1;\r\n            shareButton.tabIndex = -1;\r\n            uploadImgurButton.tabIndex = -1;\r\n            clipboardButton.tabIndex = -1;\r\n\r\n            newButton.innerHTML = `<img src='${newImageImg}' alt='icon' height='20'/>${LANG('file-new')}`;\r\n            saveButton.innerHTML = `<img src='${exportImg}' alt='icon' height='20'/>${LANG('file-save')}`;\r\n            shareButton.innerHTML = `<img src='${shareImg}' alt='icon' height='20'/>${LANG('file-share')}`;\r\n            uploadImgurButton.innerHTML = `<img style='float:left' src='${uploadImg}' height='20' alt='icon'/>${LANG('file-upload')}`;\r\n            clipboardButton.innerHTML = `<img src='${copyImg}' alt='icon' height='20'/>${LANG('file-copy')}`;\r\n            clipboardButton.title = LANG('file-copy-title');\r\n            newButton.className = \"gridButton\";\r\n            saveButton.className = \"gridButton\";\r\n            shareButton.className = \"gridButton\";\r\n            uploadImgurButton.className = \"gridButton\";\r\n            clipboardButton.className = \"gridButton\";\r\n\r\n\r\n            this.importButton = document.createElement(\"input\");\r\n            this.importButton.tabIndex = -1;\r\n            this.importButton.type = \"file\";\r\n            this.importButton.multiple = true;\r\n            this.importButton.accept = \"image\";\r\n            (this.importButton as any).size = \"71\";\r\n            this.importButton.textContent = \"Import\";\r\n            let importWrapper: any = this.importButton;\r\n\r\n            function createImportButton() {\r\n                importWrapper = document.createElement(\"div\");\r\n                importWrapper.className = \"gridButton\";\r\n                importWrapper.style.position = \"relative\";\r\n                importWrapper.style.cursor = \"pointer\";\r\n                importWrapper.style.cssFloat = \"left\";\r\n\r\n                let innerMask = document.createElement(\"div\");\r\n                innerMask.style.width = \"120px\";\r\n                innerMask.style.height = \"28px\";\r\n                innerMask.style.overflow = \"hidden\";\r\n                innerMask.style.cursor = \"pointer\";\r\n                innerMask.style.position = \"relative\";\r\n\r\n                importWrapper.appendChild(innerMask);\r\n                innerMask.appendChild(_this.importButton);\r\n\r\n                let importFakeButton = document.createElement(\"button\");\r\n                importFakeButton.innerHTML = \"<img style='float:left' height='20' src='\" + importImg + \"' alt='icon'/>\" + LANG('file-import');\r\n                importFakeButton.tabIndex = -1;\r\n\r\n                BB.css(importFakeButton, {\r\n                    width: \"120px\",\r\n                    display: \"box\",\r\n                    position: \"absolute\",\r\n                    left: '0',\r\n                    top: '0',\r\n                    cursor: \"pointer\"\r\n                });\r\n                BB.css(_this.importButton, {\r\n                    display: 'none'\r\n                });\r\n                importWrapper.appendChild(importFakeButton);\r\n\r\n                importFakeButton.onclick = function() {\r\n                    _this.importButton.click();\r\n                }\r\n            }\r\n\r\n            createImportButton();\r\n\r\n            this.importButton.onchange = function (e) {\r\n                onFileSelect(_this.importButton.files, 'default');\r\n                _this.importButton.value = \"\";\r\n\r\n            };\r\n\r\n\r\n            // --- export filetype dropdown ---\r\n            let exportTypeWrapper;\r\n            let exportTypeSelect;\r\n            {\r\n                exportTypeWrapper = BB.el({\r\n                    css: {\r\n                        fontSize: '15px',\r\n                        marginLeft: '10px',\r\n                        marginTop: '10px',\r\n                        cssFloat: 'left',\r\n                        width: 'calc(50% - 15px)',\r\n                        height: '30px'\r\n                    }\r\n                });\r\n                exportTypeSelect = new KL.Select({\r\n                    optionArr: [\r\n                        ['png', LANG('file-save-png')],\r\n                        ['psd', LANG('file-save-psd')],\r\n                        ['layers', LANG('file-save-layers')],\r\n                    ],\r\n                    initValue: exportType,\r\n                    onChange: function(val) {\r\n                        exportType = val;\r\n                        onExportTypeChange(exportType);\r\n                        onSaveImageToComputer();\r\n                    }\r\n                });\r\n                BB.css(exportTypeSelect.getElement(), {\r\n                    width: '120px',\r\n                    height: '30px'\r\n                });\r\n                exportTypeWrapper.appendChild(exportTypeSelect.getElement());\r\n\r\n            }\r\n\r\n\r\n\r\n            newButton.onclick = onNewImage;\r\n            saveButton.onclick = function () {\r\n                onSaveImageToComputer();\r\n            };\r\n            shareButton.onclick = function() {\r\n                shareButton.disabled = true;\r\n                onShareImage(() => {\r\n                    shareButton.disabled = false;\r\n                });\r\n            };\r\n            uploadImgurButton.onclick = function () {\r\n                onUpload();\r\n            };\r\n\r\n            clipboardButton.onclick = function() {\r\n                clipboardButton.blur();\r\n                onCopyToClipboard();\r\n            };\r\n\r\n            let saveNote = document.createElement(\"div\");\r\n            saveNote.textContent = \"⚠️ \" + LANG('file-no-autosave');\r\n            BB.css(saveNote, {\r\n                textAlign: \"center\",\r\n                marginTop: \"10px\",\r\n                background: \"rgb(243, 243, 161)\",\r\n                padding: \"5px 0px\",\r\n                color: 'rgba(0,0,0,0.65)',\r\n                fontSize: '15px',\r\n            });\r\n\r\n            function createSpacer() {\r\n                let el = document.createElement(\"div\");\r\n                let clearer = document.createElement(\"div\");\r\n                let line = document.createElement(\"div\");\r\n                el.appendChild(clearer);\r\n                el.appendChild(line);\r\n                BB.css(clearer, {\r\n                    clear: 'both'\r\n                });\r\n                BB.css(line, {\r\n                    marginLeft: \"10px\",\r\n                    marginRight: \"10px\",\r\n                    marginTop: \"10px\",\r\n                    borderBottom: \"1px solid rgba(0,0,0,0.2)\",\r\n                    clear: 'both'\r\n                });\r\n                return el;\r\n            }\r\n\r\n            _this.fileBrowserStorage = new BrowserStorageUi(projectStore, getProject, saveReminder, klRootEl);\r\n            BB.css(_this.fileBrowserStorage.getElement(), {\r\n                //background: 'red',\r\n                margin: '10px',\r\n            });\r\n\r\n\r\n            //actual structure\r\n            BB.append(filemenu, [\r\n                saveNote,\r\n                newButton,\r\n                importWrapper,\r\n                BB.el({css: {clear: 'both'}}),\r\n\r\n                saveButton,\r\n                exportTypeWrapper,\r\n                BB.el({css: {clear: 'both'}}),\r\n\r\n                clipboardButton,\r\n                BB.canShareFiles() ? shareButton : null,\r\n                BB.el({css: {clear: 'both'}}),\r\n\r\n                createSpacer(),\r\n                _this.fileBrowserStorage.getElement(),\r\n                createSpacer(),\r\n                uploadImgurButton,\r\n            ]);\r\n\r\n            this.div.appendChild(filemenu);\r\n        };\r\n\r\n        setTimeout(asyncCreation, 1);\r\n    }\r\n\r\n    refresh() {\r\n    }\r\n\r\n    getElement() {\r\n        return this.div;\r\n    }\r\n\r\n    setIsVisible(isVisible: boolean) {\r\n        if (isVisible) {\r\n            this.refresh();\r\n        }\r\n    }\r\n\r\n    triggerImport() {\r\n        this.importButton.click();\r\n    }\r\n}\r\n","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"2oHM2\");","import {BB} from '../../../bb/bb';\r\nimport {KL} from '../../kl';\r\nimport {klHistory} from '../../history/kl-history';\r\nimport {IKeyString} from '../../../bb/bb.types';\r\nimport {StatusOverlay} from '../components/status-overlay';\r\nimport {KlCanvasWorkspace} from '../../canvas-ui/kl-canvas-workspace';\r\nimport {KlCanvas} from '../../canvas/kl-canvas';\r\nimport {LANG} from '../../../language/language';\r\n\r\n\r\nexport class FilterTab {\r\n\r\n    private readonly div: HTMLDivElement;\r\n    private isInit = false;\r\n\r\n    constructor (\r\n        private klRootEl,\r\n        private klColorSlider,\r\n        private layerManager,\r\n        private setCurrentLayer,\r\n        private klCanvasWorkspace: KlCanvasWorkspace,\r\n        private handUi,\r\n        private getCurrentColor,\r\n        private getKlMaxCanvasSize,\r\n        private getKlCanvas: () => KlCanvas,\r\n        private getCurrentLayerCtx,\r\n        private isEmbed: boolean,\r\n        private statusOverlay: StatusOverlay,\r\n    ) {\r\n        this.div = document.createElement(\"div\");\r\n    }\r\n\r\n    private init() {\r\n        const _this = this;\r\n        let hasWebGl = BB.hasWebGl();\r\n        let filters = KL.filterLib;\r\n        let buttons = [];\r\n\r\n        BB.BbLog.emit({\r\n            type: 'init-filters',\r\n        });\r\n\r\n        if (!KL.filterLibStatus.isLoaded) {\r\n            throw new Error('filters not loaded');\r\n        }\r\n\r\n        function createButton(filterKey, filterArr) {\r\n            let button = document.createElement(\"button\");\r\n            let buttonLabel = filterArr[filterKey].buttonLabel ? filterArr[filterKey].buttonLabel : filterArr[filterKey].name;\r\n            let im = '<img height=\"20\" width=\"18\" src=\"' + filterArr[filterKey].icon + '\" alt=\"icon\" />';\r\n            button.innerHTML = im + buttonLabel;\r\n            button.className = \"gridButton\";\r\n            BB.css(button, {\r\n                lineHeight: '20px',\r\n                fontSize: '12px',\r\n            });\r\n            button.tabIndex = -1;\r\n            button.onclick = function () {\r\n\r\n                function finishedDialog(result, filterDialog) {\r\n                    if (result == \"Cancel\") {\r\n                        if (filterDialog.destroy) {\r\n                            filterDialog.destroy();\r\n                        }\r\n                        return;\r\n                    }\r\n                    let input;\r\n                    try {\r\n                        input = filterDialog.getInput(); // also destroys\r\n                    } catch (e) {\r\n                        if (e.message.indexOf('.getInput is not a function') !== -1) {\r\n                            throw 'filterDialog.getInput is not a function, filter: ' + filterArr[filterKey].name;\r\n                        } else {\r\n                            throw e;\r\n                        }\r\n                    }\r\n                    applyFilter(input);\r\n                }\r\n\r\n                if (!('apply' in filterArr[filterKey])) {\r\n                    alert('Application not fully loaded');\r\n                    return;\r\n                }\r\n\r\n                function applyFilter(input) {\r\n                    let filterResult = filterArr[filterKey].apply({\r\n                        context: _this.getCurrentLayerCtx(),\r\n                        canvas: _this.getKlCanvas(),\r\n                        history: klHistory,\r\n                        input: input\r\n                    });\r\n                    if (filterResult === false) {\r\n                        alert(\"Couldn't apply the edit action\");\r\n                    }\r\n                    if (filterArr[filterKey].updateContext === true) {\r\n                        _this.setCurrentLayer(_this.getKlCanvas().getLayer(_this.layerManager.getSelected()));\r\n                    }\r\n                    if (filterArr[filterKey].updatePos === true) {\r\n                        _this.klCanvasWorkspace.resetView();\r\n                        _this.handUi.update(_this.klCanvasWorkspace.getScale(), _this.klCanvasWorkspace.getAngleDeg());\r\n                    }\r\n                    _this.layerManager.update();\r\n                }\r\n\r\n                if (filterArr[filterKey].isInstant){\r\n                    button.blur();\r\n                    applyFilter(null);\r\n                    _this.statusOverlay.out('\"' + filterArr[filterKey].name + '\" ' + LANG('filter-applied'), true);\r\n                } else {\r\n                    let secondaryColorRGB = _this.klColorSlider.getSecondaryRGB();\r\n                    let filterDialog = filterArr[filterKey].getDialog({\r\n                        context: _this.getCurrentLayerCtx(),\r\n                        canvas: _this.getKlCanvas(),\r\n                        maxWidth: _this.getKlMaxCanvasSize(),\r\n                        maxHeight: _this.getKlMaxCanvasSize(),\r\n                        currentColorRgb: {r: _this.getCurrentColor().r, g: _this.getCurrentColor().g, b: _this.getCurrentColor().b},\r\n                        secondaryColorRgb: {r: secondaryColorRGB.r, g: secondaryColorRGB.g, b: secondaryColorRGB.b}\r\n                    });\r\n\r\n                    if (!filterDialog) {\r\n                        return;\r\n                        //alert('Error: could not perform action');\r\n                        //throw('filter['+filterKey+'].getDialog returned '+filterDialog+'. ctx:' + currentLayerCtx + ' klCanvas:' + klCanvas);\r\n                    }\r\n\r\n                    let closefunc;\r\n                    filterDialog.errorCallback = function(e) {\r\n                        setTimeout(function() {\r\n                            alert('Error: could not perform action');\r\n                            throw e;\r\n                        }, 0);\r\n                        closefunc();\r\n                    };\r\n\r\n\r\n                    let style: IKeyString = {};\r\n                    if ('width' in filterDialog) {\r\n                        style.width = filterDialog.width + 'px'\r\n                    }\r\n\r\n                    KL.popup({\r\n                        target: _this.klRootEl,\r\n                        message: \"<b>\" + filterArr[filterKey].name + \"</b>\",\r\n                        div: filterDialog.element,\r\n                        style: style,\r\n                        buttons: [\"Ok\", \"Cancel\"],\r\n                        clickOnEnter: 'Ok',\r\n                        callback: function(result) {\r\n                            finishedDialog(result, filterDialog);\r\n                        },\r\n                        closefunc: function (func) {\r\n                            closefunc = func;\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n            buttons[buttons.length] = button;\r\n            return button;\r\n        }\r\n\r\n        function createDisabledButton(filterKey, filterArr) {\r\n            if (!filterArr[filterKey].webgl && !filterArr[filterKey].ieFails) {\r\n                return;\r\n            }\r\n            if (filterArr[filterKey].ieFails && navigator.appName !== 'Microsoft Internet Explorer') {\r\n                return;\r\n            }\r\n            let buttonLabel = filterArr[filterKey].buttonLabel ? filterArr[filterKey].buttonLabel : filterArr[filterKey].name;\r\n            let button = document.createElement(\"button\");\r\n            let im = '<img style=\"opacity: 0.5\" src=\"img/' + filterArr[filterKey].icon + '\" />';\r\n            let name = filterArr[filterKey].name;\r\n            if (name.length > 11) {\r\n                name = \"<span style='font-size: 12px'>\" + buttonLabel + \"</span>\";\r\n            }\r\n            button.innerHTML = im + name;\r\n            button.className = \"gridButton\";\r\n            button.disabled = true;\r\n            return button;\r\n        }\r\n\r\n        function addGroup(groupArr, filterArr, targetEl) {\r\n            for (let filterKey in filterArr) {\r\n                if (filterArr.hasOwnProperty[filterKey] || !groupArr.includes(filterKey)) {\r\n                    continue;\r\n                }\r\n                if (_this.isEmbed && !filterArr[filterKey].inEmbed) {\r\n                    continue;\r\n                }\r\n                if ((filterArr[filterKey].webgl && hasWebGl)\r\n                    || (filterArr[filterKey].neededWithWebGL)\r\n                    || (!filterArr[filterKey].webgl && !hasWebGl)\r\n                    && !(filterArr[filterKey].ieFails && navigator.appName == 'Microsoft Internet Explorer')) {\r\n\r\n                    targetEl.appendChild(createButton(filterKey, filterArr));\r\n\r\n                } else {\r\n                    targetEl.appendChild(createDisabledButton(filterKey, filterArr));\r\n                    filterArr[filterKey] = undefined;\r\n                }\r\n            }\r\n        }\r\n\r\n        let groupA = [\r\n            'cropExtend',\r\n            'flip',\r\n            'glPerspective',\r\n            'resize',\r\n            'rotate',\r\n            'transform'\r\n        ];\r\n        let groupB = [];\r\n        for (let filterKey in filters) {\r\n            if (filters.hasOwnProperty[filterKey] || groupA.includes(filterKey)) {\r\n                continue;\r\n            }\r\n            groupB.push(filterKey);\r\n        }\r\n\r\n        addGroup(groupA, filters, _this.div);\r\n        let hrEl = document.createElement(\"div\");\r\n        hrEl.className = \"gridHr\";\r\n        _this.div.appendChild(hrEl);\r\n        addGroup(groupB, filters, _this.div);\r\n\r\n\r\n        if (!hasWebGl) {\r\n            let webglnote = BB.appendTextDiv(_this.div, \"Some actions are disabled because WebGL isn't working.\");\r\n            webglnote.style.margin = \"10px\";\r\n            BB.css(webglnote, {\r\n                fontSize: \"11px\",\r\n                color: \"#555\",\r\n                background: \"#ffe\",\r\n                padding: \"10px\",\r\n                borderRadius: \"10px\",\r\n                textAlign: \"center\"\r\n            });\r\n        }\r\n\r\n        this.isInit = true;\r\n    }\r\n\r\n    getElement() {\r\n        return this.div;\r\n    }\r\n\r\n    show() {\r\n        if (!this.isInit) {\r\n            this.init();\r\n        }\r\n        this.div.style.display = 'block';\r\n    }\r\n\r\n    hide() {\r\n        this.div.style.display = 'none';\r\n    }\r\n\r\n}","import {BB} from '../../../bb/bb';\r\nimport {KL} from '../../kl';\r\n// @ts-ignore\r\nimport loadingImg from 'url:~/src/app/img/ui/loading.gif';\r\nimport {SaveReminder} from '../components/save-reminder';\r\nimport {base64ToBlob} from '../../storage/base-64-to-blob';\r\nimport {KlCanvas} from '../../canvas/kl-canvas';\r\nimport {LANG} from '../../../language/language';\r\n\r\n\r\nasync function upload(canvas, title, description, type: 'png' | 'jpeg', imgurKey: string): Promise<{deletehash: string}> {\r\n    let img = base64ToBlob(canvas.toDataURL(\"image/\" + type));\r\n\r\n    let w = window.open();\r\n    let label = w.document.createElement(\"div\");\r\n    let gif = w.document.createElement(\"img\");\r\n    gif.src = loadingImg;\r\n    label.appendChild(gif);\r\n    BB.css(gif, {\r\n        filter: \"invert(1)\"\r\n    });\r\n    w.document.body.style.backgroundColor = \"#121211\";\r\n    w.document.body.style.backgroundImage = \"linear-gradient(#2b2b2b 0%, #121211 50%)\";\r\n    w.document.body.style.backgroundRepeat = \"no-repeat\";\r\n    let labelText = w.document.createElement(\"div\");\r\n    labelText.style.marginTop = \"10px\";\r\n    label.appendChild(labelText);\r\n    labelText.textContent = LANG('upload-uploading');\r\n\r\n    w.document.body.appendChild(label);\r\n    BB.css(label, {\r\n        marginLeft: \"auto\",\r\n        marginRight: \"auto\",\r\n        marginTop: \"100px\",\r\n        fontFamily: \"Arial, sans-serif\",\r\n        fontSize: \"20px\",\r\n        textAlign: \"center\",\r\n        transition: \"opacity 0.3s ease-in-out\",\r\n        opacity: '0',\r\n        color: \"#ccc\"\r\n    });\r\n    setTimeout(function () {\r\n        label.style.opacity = '1';\r\n    }, 20);\r\n\r\n    let response;\r\n    try {\r\n        const formData = new FormData();\r\n        formData.append('title', title);\r\n        formData.append('description', description);\r\n        formData.append('image', img);\r\n        response = await fetch('https://api.imgur.com/3/image',  {\r\n            method: 'POST',\r\n            headers: {\r\n                Authorization: 'Client-ID ' + imgurKey,\r\n            },\r\n            body: formData\r\n        });\r\n\r\n    } catch (e) {\r\n        w.close();\r\n        throw new Error(e);\r\n    }\r\n    if (!response.ok) {\r\n        w.close();\r\n        throw new Error();\r\n    }\r\n    let data = (await response.json()).data;\r\n\r\n    w.location.href = (data as any).link.replace(/\\.(jpg|png)/, '');\r\n\r\n    return data;\r\n}\r\n\r\n\r\nexport function imgurUpload(klCanvas: KlCanvas, klRootEl, saveReminder: SaveReminder, imgurKey: string) {\r\n    if (!imgurKey) {\r\n        throw new Error('imgur key missing');\r\n    }\r\n\r\n    let inputTitle = document.createElement(\"input\");\r\n    inputTitle.type = \"text\";\r\n    inputTitle.value = LANG('upload-title-untitled');\r\n    let inputDescription = BB.el({\r\n        tagName: 'textarea',\r\n        custom: {\r\n            rows: 2,\r\n        },\r\n        css: {\r\n            width: '100%',\r\n            maxWidth: '100%',\r\n        },\r\n    }) as HTMLTextAreaElement;\r\n\r\n    let labelTitle = document.createElement(\"div\");\r\n    labelTitle.textContent = LANG('upload-name') + \":\";\r\n    let labelDescription = BB.el({\r\n        content: LANG('upload-caption') + ':',\r\n        css: {\r\n            marginTop: '10px',\r\n        }\r\n    });\r\n\r\n    let tos = document.createElement(\"div\");\r\n    tos.innerHTML = `<br/><a href=\"https://imgur.com/tos\" target=\"_blank\" rel=\"noopener noreferrer\">${LANG('upload-tos')}</a> ${LANG('upload-tos-2')}`;\r\n\r\n    const typeRadio = new KL.RadioList({\r\n        name: 'filetype',\r\n        init: 'jpeg',\r\n        items: [\r\n            { label: 'JPG', value: 'jpeg' },\r\n            { label: 'PNG', value: 'png' },\r\n        ],\r\n        ignoreFocus: true,\r\n    });\r\n    BB.css(typeRadio.getElement(), {\r\n        marginBottom: '10px',\r\n    });\r\n\r\n\r\n    let outDiv = document.createElement(\"div\");\r\n    let infoHint = document.createElement(\"div\");\r\n    infoHint.className = \"info-hint\";\r\n    infoHint.textContent = LANG('upload-link-notice');\r\n    outDiv.append(\r\n        infoHint,\r\n        typeRadio.getElement(),\r\n        labelTitle,\r\n        inputTitle,\r\n        labelDescription,\r\n        inputDescription,\r\n        tos\r\n    );\r\n    KL.popup({\r\n        target: klRootEl,\r\n        message: `<b>${LANG('upload-title')}</b>`,\r\n        type: \"upload\",\r\n        div: outDiv,\r\n        buttons: [LANG('upload-submit'), \"Cancel\"],\r\n        clickOnEnter: LANG('upload-submit'),\r\n        primaries: [LANG('upload-submit')],\r\n        autoFocus: LANG('upload-submit'),\r\n        callback: async function (val) {\r\n            if (val === LANG('upload-submit') || val === \"Yes\" || val === \"Ok\") {\r\n                try {\r\n                    const result = await upload(\r\n                        klCanvas.getCompleteCanvas(1),\r\n                        inputTitle.value,\r\n                        inputDescription.value,\r\n                        typeRadio.getValue() as 'png' | 'jpeg',\r\n                        imgurKey,\r\n                    );\r\n\r\n                    KL.popup({\r\n                        target: klRootEl,\r\n                        type: \"ok\",\r\n                        message: `<h3>${LANG('upload-success')}</h3><br>${LANG('upload-delete')}<br><a target='_blank' rel=\"noopener noreferrer\" href='https://imgur.com/delete/${result.deletehash}'>imgur.com/<b>delete</b>/${result.deletehash}</a><br><br>`,\r\n                        buttons: [\"Ok\"]\r\n                    });\r\n                    saveReminder.reset();\r\n\r\n                } catch(e) {\r\n                    KL.popup({\r\n                        target: klRootEl,\r\n                        type: \"error\",\r\n                        message: LANG('upload-failed'),\r\n                        buttons: [\"Ok\"]\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    });\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"iGeXe\");","import {BB} from '../../bb/bb';\r\n\r\nlet agPsdLazy;\r\nexport async function loadAgPsd() {\r\n    if (!agPsdLazy) {\r\n        agPsdLazy = await import('ag-psd');\r\n        BB.BbLog.emit({\r\n            type: 'loaded-agpsd',\r\n        });\r\n    }\r\n    return agPsdLazy;\r\n}","module.exports = (require(\"./helpers/browser/js-loader\")(require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"kNYzr\"))).then(() => parcelRequire('2m2jt'));","import {KL} from '../../kl';\r\nimport {BB} from '../../../bb/bb';\r\nimport {KlHistoryInterface} from '../../history/kl-history';\r\nimport {LANG} from '../../../language/language';\r\n\r\n\r\nconst reminderTimelimitMs = 1000 * 60 * 20; // 20 minutes\r\nconst unsavedActionsLimit = 100; // number of actions user did since last save\r\n\r\n\r\n/**\r\n * remind user of saving, keep user aware of save state\r\n */\r\nexport class SaveReminder {\r\n    private lastSavedActionNumber: number = null;\r\n    private lastSavedAt: number;\r\n\r\n    private lastReminderShownAt: number;\r\n    private unsavedInterval;\r\n    private closeFunc: () => void;\r\n\r\n    showPopup (): void {\r\n        const min = Math.round((performance.now() - this.lastSavedAt) / 1000 / 60);\r\n\r\n        const saveBtn = BB.el({\r\n            tagName: 'button',\r\n            className: 'kl-button-primary',\r\n            content: LANG('save-reminder-save-psd'),\r\n            onClick: () => this.onSaveAsPsd(),\r\n        });\r\n        KL.popup({\r\n            target: document.body,\r\n            message: `<b>${LANG('save-reminder-title')}</b>`,\r\n            div: BB.el({\r\n                content: [\r\n                    BB.el({\r\n                        content: LANG(\r\n                            'save-reminder-text',\r\n                            {\r\n                                a: '<strong>' + min,\r\n                                b: '</strong>',\r\n                            }\r\n                        ) + '<br><br>',\r\n                    }),\r\n                    saveBtn,\r\n                    BB.el({content:'<br>' + LANG('save-reminder-psd-layers')}),\r\n                ]\r\n            }),\r\n            ignoreBackground: true,\r\n            callback: () => {\r\n                BB.destroyEl(saveBtn);\r\n                this.closeFunc = null;\r\n                this.lastReminderShownAt = performance.now();\r\n            },\r\n            closefunc: (f) => {\r\n                this.closeFunc = f;\r\n            }\r\n        });\r\n        setTimeout(() => {\r\n            saveBtn.focus();\r\n        }, 40);\r\n    }\r\n\r\n    constructor (\r\n        private history: KlHistoryInterface,\r\n        private showReminder: boolean,\r\n        private changeTitle: boolean,\r\n        private onSaveAsPsd: () => void,\r\n        private isDrawing: () => boolean,\r\n        private title: string = 'Klecks',\r\n    ) { }\r\n\r\n    init (): void {\r\n        if (this.lastSavedActionNumber !== null) { // already initialized\r\n            return;\r\n        }\r\n        this.lastSavedActionNumber = this.history.getActionNumber();\r\n        this.lastReminderShownAt = performance.now();\r\n        this.lastSavedAt = performance.now();\r\n\r\n        if (this.showReminder) {\r\n            setInterval(() => {\r\n                if (document.visibilityState !== 'visible') {\r\n                    return;\r\n                }\r\n\r\n                let unsavedActions = Math.abs(this.history.getActionNumber() - this.lastSavedActionNumber);\r\n\r\n                if (\r\n                    KL.dialogCounter.get() === 0 &&\r\n                    !this.isDrawing() &&\r\n                    this.lastReminderShownAt + reminderTimelimitMs < performance.now() &&\r\n                    unsavedActions >= unsavedActionsLimit\r\n                ) {\r\n                    this.showPopup();\r\n                }\r\n            }, 1000 * 5);\r\n        }\r\n\r\n        // confirmation dialog when closing tab\r\n        function onBeforeUnload(e) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n        }\r\n\r\n        this.history.addListener(() => {\r\n            let actionNumber = this.history.getActionNumber();\r\n            if (this.lastSavedActionNumber !== actionNumber) {\r\n                BB.setEventListener(window, 'onbeforeunload', onBeforeUnload);\r\n            } else {\r\n                BB.setEventListener(window, 'onbeforeunload', null);\r\n            }\r\n        });\r\n\r\n        if (this.changeTitle) {\r\n            document.addEventListener(\"visibilitychange\", () => {\r\n                if (document.visibilityState === 'visible') {\r\n                    document.title = this.title;\r\n                    clearInterval(this.unsavedInterval);\r\n                } else {\r\n                    let actionNumber = this.history.getActionNumber();\r\n                    if (this.lastSavedActionNumber !== actionNumber) {\r\n                        document.title = LANG('unsaved') + ' - ' + this.title;\r\n                        let state = 0;\r\n                        this.unsavedInterval = setInterval(() => {\r\n                            state = (state + 1) % 2;\r\n                            if (state === 1) {\r\n                                document.title = LANG('unsaved') + ' · ' + this.title;\r\n                            } else {\r\n                                document.title = LANG('unsaved') + ' - ' + this.title;\r\n                            }\r\n                        }, 1000 * 60 * 3);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    reset (): void {\r\n        if (this.lastSavedActionNumber === null) { // not initialized\r\n            return;\r\n        }\r\n\r\n        this.lastSavedActionNumber = this.history.getActionNumber();\r\n        this.lastReminderShownAt = performance.now();\r\n        this.lastSavedAt = performance.now();\r\n        BB.setEventListener(window, 'onbeforeunload', null);\r\n\r\n        if (this.closeFunc) {\r\n            this.closeFunc();\r\n        }\r\n    }\r\n}\r\n","import {BB} from '../../bb/bb';\r\nimport {KL} from '../kl';\r\nimport {saveAs} from 'file-saver';\r\nimport {KlCanvas} from '../canvas/kl-canvas';\r\n\r\nexport class SaveToComputer {\r\n\r\n    constructor(\r\n        private saveReminder,\r\n        private klRootEl,\r\n        private getExportType,\r\n        private getKlCanvas: () => KlCanvas,\r\n        private filenameBase: string,\r\n    ) {}\r\n\r\n    save(format?: 'psd' | 'layers' | 'png') {\r\n        const _this = this;\r\n\r\n        _this.saveReminder.reset();\r\n\r\n\r\n        function saveImage(canvas, filename, mimeType) {\r\n            let parts = canvas.toDataURL(mimeType).match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);\r\n            //assume base64 encoding\r\n            let binStr = atob(parts[3]);\r\n            //convert to binary in ArrayBuffer\r\n            let buf = new ArrayBuffer(binStr.length);\r\n            let view = new Uint8Array(buf);\r\n            for (let i = 0; i < view.length; i++) {\r\n                view[i] = binStr.charCodeAt(i);\r\n            }\r\n            let blob = new Blob([view], {'type': parts[1]});\r\n            saveAs(blob, filename);\r\n        }\r\n\r\n        if (!format) {\r\n            format = _this.getExportType();\r\n        }\r\n\r\n        if (format === 'png') {\r\n            let extension = 'png';\r\n            let mimeType = 'image/png';\r\n            let filename = BB.getDate() + this.filenameBase + \".\" + extension;\r\n            let fullCanvas = _this.getKlCanvas().getCompleteCanvas(1);\r\n\r\n            /*fullCanvas.toBlob(function(blob) {\r\n                if (blob === null) {\r\n                    throw 'save image error, blob is null';\r\n                }\r\n                saveAs(blob, filename);\r\n            }, mimetype);*/\r\n\r\n            //using old code, because saving somehow doesn't work for ipad before ios 13\r\n            //and it doesn't even throw an exception\r\n            try {\r\n                saveImage(fullCanvas, filename, mimeType);\r\n            } catch (error) { //fallback for old browsers\r\n                let im = new Image();\r\n                im.width = _this.getKlCanvas().getWidth();\r\n                im.height = _this.getKlCanvas().getHeight();\r\n                im.src = fullCanvas.toDataURL(mimeType);\r\n                KL.exportDialog(_this.klRootEl, im);\r\n            }\r\n        } else if (format === 'layers') {\r\n            let extension = 'png';\r\n            let mimeType = 'image/png';\r\n            let fileBase = BB.getDate() + this.filenameBase;\r\n            let layerArr = _this.getKlCanvas().getLayersFast();\r\n            for (let i = 0; i < layerArr.length; i++) {\r\n                let item = layerArr[i];\r\n                let fnameArr = [\r\n                    fileBase,\r\n                    '_',\r\n                    ('' + (i + 1)).padStart(2, '0'),\r\n                    '_',\r\n                    item.name,\r\n                    '.',\r\n                    extension\r\n                ];\r\n                saveImage(item.canvas, fnameArr.join(''), mimeType);\r\n            }\r\n        } else if (format === 'psd') {\r\n\r\n            let layerArr = _this.getKlCanvas().getLayersFast();\r\n\r\n            let psdConfig = {\r\n                width: _this.getKlCanvas().getWidth(),\r\n                height: _this.getKlCanvas().getHeight(),\r\n                children: [],\r\n                canvas: _this.getKlCanvas().getCompleteCanvas(1)\r\n            };\r\n            for (let i = 0; i < layerArr.length; i++) {\r\n                let item = layerArr[i];\r\n                psdConfig.children.push({\r\n                    name: item.name,\r\n                    opacity: item.opacity,\r\n                    canvas: item.canvas,\r\n                    blendMode: KL.PSD.blendKlToPsd(item.mixModeStr),\r\n                    left: 0,\r\n                    top: 0\r\n                });\r\n            }\r\n\r\n            KL.loadAgPsd().then((agPsdLazy) => {\r\n                let buffer = agPsdLazy.writePsdBuffer(psdConfig);\r\n                let blob = new Blob([buffer], { type: 'application/octet-stream' });\r\n                saveAs(blob, BB.getDate() + this.filenameBase + '.psd');\r\n            }).catch(() => {\r\n                alert('Error: failed to load PSD library');\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n}","/*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n*\n* By Eli Grey, http://eligrey.com\n*\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\n* source  : http://purl.eligrey.com/github/FileSaver.js\n*/\n\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nvar _global = typeof window === 'object' && window.window === window\n  ? window : typeof self === 'object' && self.self === self\n  ? self : typeof global === 'object' && global.global === global\n  ? global\n  : this\n\nfunction bom (blob, opts) {\n  if (typeof opts === 'undefined') opts = { autoBom: false }\n  else if (typeof opts !== 'object') {\n    console.warn('Deprecated: Expected third argument to be a object')\n    opts = { autoBom: !opts }\n  }\n\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\n  }\n  return blob\n}\n\nfunction download (url, name, opts) {\n  var xhr = new XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.onload = function () {\n    saveAs(xhr.response, name, opts)\n  }\n  xhr.onerror = function () {\n    console.error('could not download file')\n  }\n  xhr.send()\n}\n\nfunction corsEnabled (url) {\n  var xhr = new XMLHttpRequest()\n  // use sync to avoid popup blocker\n  xhr.open('HEAD', url, false)\n  try {\n    xhr.send()\n  } catch (e) {}\n  return xhr.status >= 200 && xhr.status <= 299\n}\n\n// `a.click()` doesn't work for all browsers (#465)\nfunction click (node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'))\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents')\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\n                          20, false, false, false, false, 0, null)\n    node.dispatchEvent(evt)\n  }\n}\n\n// Detect WebView inside a native macOS app by ruling out all browsers\n// We just need to check for 'Safari' because all other browsers (besides Firefox) include that too\n// https://www.whatismybrowser.com/guides/the-latest-user-agent/macos\nvar isMacOSWebView = _global.navigator && /Macintosh/.test(navigator.userAgent) && /AppleWebKit/.test(navigator.userAgent) && !/Safari/.test(navigator.userAgent)\n\nvar saveAs = _global.saveAs || (\n  // probably in some web worker\n  (typeof window !== 'object' || window !== _global)\n    ? function saveAs () { /* noop */ }\n\n  // Use download attribute first if possible (#193 Lumia mobile) unless this is a macOS WebView\n  : ('download' in HTMLAnchorElement.prototype && !isMacOSWebView)\n  ? function saveAs (blob, name, opts) {\n    var URL = _global.URL || _global.webkitURL\n    var a = document.createElement('a')\n    name = name || blob.name || 'download'\n\n    a.download = name\n    a.rel = 'noopener' // tabnabbing\n\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n\n    if (typeof blob === 'string') {\n      // Support regular links\n      a.href = blob\n      if (a.origin !== location.origin) {\n        corsEnabled(a.href)\n          ? download(blob, name, opts)\n          : click(a, a.target = '_blank')\n      } else {\n        click(a)\n      }\n    } else {\n      // Support blobs\n      a.href = URL.createObjectURL(blob)\n      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\n      setTimeout(function () { click(a) }, 0)\n    }\n  }\n\n  // Use msSaveOrOpenBlob as a second approach\n  : 'msSaveOrOpenBlob' in navigator\n  ? function saveAs (blob, name, opts) {\n    name = name || blob.name || 'download'\n\n    if (typeof blob === 'string') {\n      if (corsEnabled(blob)) {\n        download(blob, name, opts)\n      } else {\n        var a = document.createElement('a')\n        a.href = blob\n        a.target = '_blank'\n        setTimeout(function () { click(a) })\n      }\n    } else {\n      navigator.msSaveOrOpenBlob(bom(blob, opts), name)\n    }\n  }\n\n  // Fallback to using FileReader and a popup\n  : function saveAs (blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank')\n    if (popup) {\n      popup.document.title =\n      popup.document.body.innerText = 'downloading...'\n    }\n\n    if (typeof blob === 'string') return download(blob, name, opts)\n\n    var force = blob.type === 'application/octet-stream'\n    var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\n    var isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\n\n    if ((isChromeIOS || (force && isSafari) || isMacOSWebView) && typeof FileReader !== 'undefined') {\n      // Safari doesn't allow downloading of blob URLs\n      var reader = new FileReader()\n      reader.onloadend = function () {\n        var url = reader.result\n        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\n        if (popup) popup.location.href = url\n        else location = url\n        popup = null // reverse-tabnabbing #460\n      }\n      reader.readAsDataURL(blob)\n    } else {\n      var URL = _global.URL || _global.webkitURL\n      var url = URL.createObjectURL(blob)\n      if (popup) popup.location = url\n      else location.href = url\n      popup = null // reverse-tabnabbing #460\n      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\n    }\n  }\n)\n\n_global.saveAs = saveAs.saveAs = saveAs\n\nif (typeof module !== 'undefined') {\n  module.exports = saveAs;\n}\n","import {KL} from '../kl';\r\nimport {IHistoryBroadcast, IHistoryEntry, klHistory} from './kl-history';\r\nimport {KlCanvasWorkspace} from '../canvas-ui/kl-canvas-workspace';\r\nimport {IFilterApply, IInitState} from '../kl.types';\r\nimport {KlCanvas} from '../canvas/kl-canvas';\r\n\r\nexport class UndoRedoCatchup {\r\n\r\n    private doIgnore = false;\r\n\r\n    /**\r\n     * Prevent multiple undo / redo getting triggered at once.\r\n     * Might be confusing if main thread is choking.\r\n     */\r\n    private ignoreTest (): boolean {\r\n        if (this.doIgnore) {\r\n            return false;\r\n        }\r\n        this.doIgnore = true;\r\n        setTimeout(() => {\r\n            this.doIgnore = false;\r\n        }, 0);\r\n        return true;\r\n    }\r\n\r\n    // ---- public ----\r\n\r\n    constructor (\r\n        private brushUiObj,\r\n        private layerPreview,\r\n        private layerManager,\r\n        private handUi,\r\n        private klCanvasWorkspace: KlCanvasWorkspace,\r\n        private getInitState: () => IInitState,\r\n        private getKlCanvas: () => KlCanvas,\r\n        private getCurrentLayerCtx,\r\n        private setCurrentLayerCtx,\r\n        private getCurrentBrush,\r\n    ) { }\r\n\r\n    undo (): boolean {\r\n        if (!this.ignoreTest()) {\r\n            return false;\r\n        }\r\n\r\n        if (!klHistory.canUndo()) { // || workspace.isPainting()) {\r\n            return false;\r\n        }\r\n        const actions: IHistoryEntry[] = klHistory.undo();\r\n        klHistory.pause(true);\r\n        const initState: IInitState = this.getInitState();\r\n        const oldSize = {w: this.getKlCanvas().getWidth(), h: this.getKlCanvas().getHeight()};\r\n        this.getKlCanvas().copy(initState.canvas);\r\n        let layerIndex = initState.focus;\r\n        this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(layerIndex));\r\n        const brushes: any = {};\r\n        for (let b in KL.brushes) {\r\n            if (KL.brushes.hasOwnProperty(b)) {\r\n                brushes[b] = new KL.brushes[b]();\r\n                brushes[b].setContext(this.getCurrentLayerCtx());\r\n            }\r\n        }\r\n        brushes.SketchyBrush.setSeed(initState.brushes.SketchyBrush.getSeed());\r\n        for (let i = 0; i < actions.length; i++) {\r\n            ((i) => {\r\n                if (actions[i].tool[0] === \"brush\") {\r\n                    const b = brushes[actions[i].tool[1]];\r\n                    if (actions[i].actions) {\r\n                        for (let e = 0; e < actions[i].actions.length; e++) {\r\n                            const p = actions[i].actions[e].params;\r\n                            b[actions[i].actions[e].action].apply(b, p);\r\n                        }\r\n                    } else {\r\n                        const p = actions[i].params;\r\n                        b[actions[i].action].apply(b, p);\r\n                    }\r\n                } else if (actions[i].tool[0] === \"canvas\") {\r\n                    const p = actions[i].params;\r\n                    const id = this.getKlCanvas()[actions[i].action].apply(this.getKlCanvas(), p);\r\n                    if (typeof id === 'number') {\r\n                        layerIndex = id;\r\n                        this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(layerIndex));\r\n                        for (let b in brushes) {\r\n                            if (brushes.hasOwnProperty(b)) {\r\n                                brushes[b].setContext(this.getCurrentLayerCtx());\r\n                            }\r\n                        }\r\n                    }\r\n                } else if (actions[i].tool[0] === \"filter\") {\r\n                    const p = [{\r\n                        context: this.getCurrentLayerCtx(),\r\n                        canvas: this.getKlCanvas(),\r\n                        input: actions[i].params[0].input,\r\n                        history: new KL.DecoyKlHistory(),\r\n                    } as IFilterApply];\r\n                    KL.filterLib[actions[i].tool[1]][actions[i].action].apply(null, p);\r\n\r\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"focusLayer\") {\r\n                    layerIndex = actions[i].params[0];\r\n                    this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(actions[i].params[0]));\r\n                    for (let b in brushes) {\r\n                        if (brushes.hasOwnProperty(b)) {\r\n                            brushes[b].setContext(this.getCurrentLayerCtx());\r\n                        }\r\n                    }\r\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"importImage\") {\r\n                    const id = this.getKlCanvas().addLayer();\r\n                    if (typeof id === 'number') {\r\n                        layerIndex = id;\r\n                        if (actions[i].params[1]) {\r\n                            this.getKlCanvas().renameLayer(layerIndex, actions[i].params[1]);\r\n                        }\r\n                        this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(layerIndex));\r\n                        for (let b in brushes) {\r\n                            if (brushes.hasOwnProperty(b)) {\r\n                                brushes[b].setContext(this.getCurrentLayerCtx());\r\n                            }\r\n                        }\r\n                    }\r\n                    this.getCurrentLayerCtx().drawImage(actions[i].params[0], 0, 0);\r\n                }\r\n            })(i);\r\n        }\r\n        if (oldSize.w !== this.getKlCanvas().getWidth() || oldSize.h !== this.getKlCanvas().getHeight()) {\r\n            this.klCanvasWorkspace.resetView();\r\n            this.handUi.update(this.klCanvasWorkspace.getScale(), this.klCanvasWorkspace.getAngleDeg());\r\n        }\r\n        this.layerManager.update(layerIndex);\r\n        this.layerPreview.setLayer(this.getKlCanvas().getLayer(layerIndex));\r\n        this.brushUiObj.sketchyBrush.setSeed(brushes.SketchyBrush.getSeed());\r\n        this.getCurrentBrush().setContext(this.getCurrentLayerCtx());\r\n        this.klCanvasWorkspace.setLastDrawEvent(null);\r\n\r\n        klHistory.pause(false);\r\n        return true;\r\n    }\r\n\r\n    redo (): boolean {\r\n        if (!this.ignoreTest()) {\r\n            return false;\r\n        }\r\n\r\n        if (!klHistory.canRedo()) {\r\n            return false;\r\n        }\r\n        const actions = klHistory.redo();\r\n        klHistory.pause(true);\r\n        const oldSize = {w: this.getKlCanvas().getWidth(), h: this.getKlCanvas().getHeight()};\r\n        let layerIndex;\r\n        const brushes: any = {};\r\n        for (let b in KL.brushes) {\r\n            if (KL.brushes.hasOwnProperty(b)) {\r\n                brushes[b] = new KL.brushes[b]();\r\n                brushes[b].setContext(this.getCurrentLayerCtx());\r\n            }\r\n        }\r\n        brushes.SketchyBrush.setSeed(this.brushUiObj.sketchyBrush.getSeed());\r\n        for (let i = 0; i < actions.length; i++) {\r\n            ((i) => {\r\n                if (actions[i].tool[0] === \"brush\") {\r\n                    const b = brushes[actions[i].tool[1]];\r\n                    if (actions[i].actions) {\r\n                        for (let e = 0; e < actions[i].actions.length; e++) {\r\n                            const p = actions[i].actions[e].params;\r\n                            b[actions[i].actions[e].action].apply(b, p);\r\n                        }\r\n                    } else {\r\n                        const p = actions[i].params;\r\n                        b[actions[i].action].apply(b, p);\r\n                    }\r\n                } else if (actions[i].tool[0] === \"canvas\") {\r\n                    const p = actions[i].params;\r\n                    const id = this.getKlCanvas()[actions[i].action].apply(this.getKlCanvas(), p);\r\n                    if (typeof id === 'number') {\r\n                        layerIndex = id;\r\n                        this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(layerIndex));\r\n                        for (let b in brushes) {\r\n                            if (brushes.hasOwnProperty(b)) {\r\n                                brushes[b].setContext(this.getCurrentLayerCtx());\r\n                            }\r\n                        }\r\n                    }\r\n                } else if (actions[i].tool[0] === \"filter\") {\r\n                    const p = [{\r\n                        context: this.getCurrentLayerCtx(),\r\n                        canvas: this.getKlCanvas(),\r\n                        input: actions[i].params[0].input,\r\n                        history: new KL.DecoyKlHistory(),\r\n                    } as IFilterApply];\r\n                    KL.filterLib[actions[i].tool[1]][actions[i].action].apply(null, p);\r\n\r\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"focusLayer\") {\r\n                    layerIndex = actions[i].params[0];\r\n                    this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(actions[i].params[0]));\r\n                    for (let b in brushes) {\r\n                        if (brushes.hasOwnProperty(b)) {\r\n                            brushes[b].setContext(this.getCurrentLayerCtx());\r\n                        }\r\n                    }\r\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"importImage\") {\r\n                    const id = this.getKlCanvas().addLayer();\r\n                    if (typeof id === 'number') {\r\n                        layerIndex = id;\r\n                        if (actions[i].params[1]) {\r\n                            this.getKlCanvas().renameLayer(layerIndex, actions[i].params[1]);\r\n                        }\r\n                        this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(layerIndex));\r\n                        for (let b in brushes) {\r\n                            if (brushes.hasOwnProperty(b)) {\r\n                                brushes[b].setContext(this.getCurrentLayerCtx());\r\n                            }\r\n                        }\r\n                    }\r\n                    this.getCurrentLayerCtx().drawImage(actions[i].params[0], 0, 0);\r\n                }\r\n            })(i);\r\n        }\r\n\r\n        if (oldSize.w !== this.getKlCanvas().getWidth() || oldSize.h !== this.getKlCanvas().getHeight()) {\r\n            this.klCanvasWorkspace.resetView();\r\n            this.handUi.update(this.klCanvasWorkspace.getScale(), this.klCanvasWorkspace.getAngleDeg());\r\n        }\r\n        const currentLayerIndex = this.getKlCanvas().getLayerIndex(this.getCurrentLayerCtx().canvas);\r\n        this.layerManager.update(currentLayerIndex);\r\n        this.layerPreview.setLayer(this.getKlCanvas().getLayer(currentLayerIndex));\r\n        this.brushUiObj.sketchyBrush.setSeed(brushes.SketchyBrush.getSeed());\r\n        this.getCurrentBrush().setContext(this.getCurrentLayerCtx());\r\n        this.klCanvasWorkspace.setLastDrawEvent(null);\r\n        klHistory.pause(false);\r\n\r\n        return true;\r\n    }\r\n\r\n    catchup (logParam: IHistoryBroadcast | null): void {\r\n        // const start = performance.now();\r\n        //play catch up (the version that is a few steps behind)\r\n        if (logParam && logParam.bufferUpdate) {\r\n            const initState: IInitState = this.getInitState();\r\n\r\n            const brushes = initState.brushes;\r\n            const actions = [logParam.bufferUpdate];\r\n            let localCurrentLayerCtx = initState.canvas.getLayerContext(initState.focus);\r\n            const canvas = initState.canvas;\r\n            let layerIndex = initState.focus;\r\n            ((i) => {\r\n                if (actions[i].tool[0] === \"brush\") {\r\n                    let b = brushes[actions[i].tool[1]];\r\n                    if (actions[i].actions) {\r\n                        for (let e = 0; e < actions[i].actions.length; e++) {\r\n                            const p = actions[i].actions[e].params;\r\n                            b[actions[i].actions[e].action].apply(b, p);\r\n                        }\r\n                    } else {\r\n                        const p = actions[i].params;\r\n                        b[actions[i].action].apply(b, p);\r\n                    }\r\n                } else if (actions[i].tool[0] === \"canvas\") {\r\n                    const p = actions[i].params;\r\n                    const id = canvas[actions[i].action].apply(canvas, p);\r\n                    if (typeof id === 'number') {\r\n                        layerIndex = id;\r\n                        localCurrentLayerCtx = canvas.getLayerContext(layerIndex);\r\n                        for (let b in brushes) {\r\n                            if (brushes.hasOwnProperty(b)) {\r\n                                brushes[b].setContext(localCurrentLayerCtx);\r\n                            }\r\n                        }\r\n                    }\r\n                } else if (actions[i].tool[0] === \"filter\") {\r\n                    const p = [{\r\n                        context: localCurrentLayerCtx,\r\n                        canvas: canvas,\r\n                        input: actions[i].params[0].input,\r\n                        history: new KL.DecoyKlHistory(),\r\n                    } as IFilterApply];\r\n                    KL.filterLib[actions[i].tool[1]][actions[i].action].apply(null, p);\r\n\r\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"focusLayer\") {\r\n                    layerIndex = actions[i].params[0];\r\n                    localCurrentLayerCtx = canvas.getLayerContext(actions[i].params[0]);\r\n                    for (let b in brushes) {\r\n                        if (brushes.hasOwnProperty(b)) {\r\n                            brushes[b].setContext(localCurrentLayerCtx);\r\n                        }\r\n                    }\r\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"importImage\") {\r\n                    const id = canvas.addLayer();\r\n                    if (typeof id === 'number') {\r\n                        layerIndex = id;\r\n                        if (actions[i].params[1]) {\r\n                            this.getKlCanvas().renameLayer(layerIndex, actions[i].params[1]);\r\n                        }\r\n                        localCurrentLayerCtx = canvas.getLayerContext(layerIndex);\r\n                        for (let b in brushes) {\r\n                            if (brushes.hasOwnProperty(b)) {\r\n                                brushes[b].setContext(localCurrentLayerCtx);\r\n                            }\r\n                        }\r\n                    }\r\n                    localCurrentLayerCtx.drawImage(actions[i].params[0], 0, 0);\r\n                }\r\n            })(0);\r\n            initState.focus = layerIndex;\r\n        }\r\n        // console.log('catchup', performance.now() - start);\r\n    }\r\n\r\n\r\n}","import {IRGB, ISliderConfig} from '../kl.types';\r\n\r\nexport type TBrushSettingEmit = { type: 'color'; value: IRGB } |\r\n    { type: 'opacity'; value: number } |\r\n    { type: 'size'; value: number } |\r\n    { type: 'sliderConfig'; value: ISliderConfig };\r\n\r\nexport type TBrushSettingSubscriber = (p : TBrushSettingEmit) => void;\r\n\r\n/**\r\n * Central place to update brush settings, and to subscribe to changes.\r\n */\r\nexport class BrushSettingService {\r\n\r\n    private static instance: BrushSettingService;\r\n    subscriberArr: TBrushSettingSubscriber[] = [];\r\n\r\n    private emit (obj: TBrushSettingEmit, skipSubscriber?: TBrushSettingSubscriber): void {\r\n        for (let i = 0; i < this.subscriberArr.length; i++) {\r\n            if (this.subscriberArr[i] === skipSubscriber) {\r\n                continue;\r\n            }\r\n            this.subscriberArr[i](obj);\r\n        }\r\n    }\r\n\r\n    // --- public ---\r\n\r\n    constructor (\r\n        private onSetColor: (rgb: IRGB) => void,\r\n        private onSetSize: (size: number) => void,\r\n        private onSetOpacity: (opacity: number) => void,\r\n        private onGetColor: () => IRGB,\r\n        private onGetSize: () => number,\r\n        private onGetOpacity: () => number,\r\n        private onGetSliderConfig: () => ISliderConfig,\r\n    ) {\r\n        if (BrushSettingService.instance) {\r\n            throw new Error('BrushSettingService already instantiated');\r\n        }\r\n        BrushSettingService.instance = this;\r\n    }\r\n\r\n    emitColor (color: IRGB, skipSubscriber?: TBrushSettingSubscriber): void {\r\n        this.emit(\r\n            {\r\n                type: 'color',\r\n                value: color\r\n            },\r\n            skipSubscriber\r\n        );\r\n    }\r\n\r\n    emitSize (size: number, skipSubscriber?: TBrushSettingSubscriber): void {\r\n        this.emit(\r\n            {\r\n                type: 'size',\r\n                value: size\r\n            },\r\n            skipSubscriber\r\n        );\r\n    }\r\n\r\n    emitOpacity (opacity: number, skipSubscriber?: TBrushSettingSubscriber): void {\r\n        this.emit(\r\n            {\r\n                type: 'opacity',\r\n                value: opacity\r\n            },\r\n            skipSubscriber\r\n        );\r\n    }\r\n\r\n    emitSliderConfig (sliderConfig: ISliderConfig, skipSubscriber?: TBrushSettingSubscriber) {\r\n        this.emit(\r\n            {\r\n                type: 'sliderConfig',\r\n                value: sliderConfig\r\n            },\r\n            skipSubscriber\r\n        );\r\n    }\r\n\r\n    /**\r\n     * set current brush color\r\n     * @param color\r\n     * @param skipSubscriber\r\n     */\r\n    setColor (color: IRGB, skipSubscriber?: TBrushSettingSubscriber) {\r\n        this.onSetColor(color);\r\n        this.emitColor(color, skipSubscriber);\r\n    }\r\n\r\n    /**\r\n     * set current brush size\r\n     * @param size\r\n     * @param skipSubscriber\r\n     */\r\n    setSize (size: number, skipSubscriber?: TBrushSettingSubscriber) {\r\n        this.onSetSize(size);\r\n        // why not emitting?\r\n    }\r\n\r\n    /**\r\n     * set current opacity\r\n     * @param opacity\r\n     * @param skipSubscriber\r\n     */\r\n    setOpacity (opacity: number, skipSubscriber?: TBrushSettingSubscriber) {\r\n        this.onSetOpacity(opacity);\r\n        // why not emitting?\r\n    }\r\n\r\n    /**\r\n     * get current brush color\r\n     */\r\n    getColor (): IRGB {\r\n        return this.onGetColor();\r\n    }\r\n\r\n    getSize (): number {\r\n        return this.onGetSize();\r\n    }\r\n\r\n    getOpacity (): number {\r\n        return this.onGetOpacity();\r\n    }\r\n\r\n    getSliderConfig (): ISliderConfig {\r\n        return this.onGetSliderConfig();\r\n    }\r\n\r\n    /**\r\n     * subscribe to changes\r\n     * @param func\r\n     */\r\n    subscribe (func: TBrushSettingSubscriber): void {\r\n        if (this.subscriberArr.includes(func)) {\r\n            return;\r\n        }\r\n        this.subscriberArr.push(func);\r\n    }\r\n\r\n    unsubscribe (func: TBrushSettingSubscriber): void {\r\n        for (let i = 0; i < this.subscriberArr.length; i++) {\r\n            if (func === this.subscriberArr[i]) {\r\n                this.subscriberArr.splice(i, 1);\r\n                i--;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n","import {BB} from '../../../bb/bb';\r\nimport {LANG, languageStrings, LS_LANGUAGE_KEY} from '../../../language/language';\r\nimport {KL} from '../../kl';\r\nimport {languages} from '../../../../languages/languages';\r\nimport {Popup} from '../modals/popup';\r\n// @ts-ignore\r\nimport bitbofLogoImg from 'url:~/src/app/img/bitbof-logo.svg';\r\n// @ts-ignore\r\nimport klecksLogoImg from 'url:~/src/app/img/klecks-logo.png';\r\n// @ts-ignore\r\nimport uiSwapImg from 'url:~/src/app/img/ui/ui-swap-lr.svg';\r\nimport {LocalStorage} from '../../../bb/base/local-storage';\r\n\r\nexport class SettingsTab {\r\n\r\n    private el: HTMLElement;\r\n\r\n    // --- public ---\r\n    constructor (\r\n        onLeftRight: () => void,\r\n        customAbout?: HTMLElement,\r\n    ) {\r\n\r\n\r\n\r\n\r\n        // ---- language ----\r\n        const language = languageStrings.getLanguage();\r\n\r\n        this.el = BB.el({\r\n            content: `\r\n${LANG('settings-language')}: ${language.name} (${language.code})\r\n            `,\r\n            css: {\r\n                margin: '10px',\r\n            }\r\n        });\r\n\r\n        const preferredLanguageRow = BB.el({\r\n            content: LANG('settings-preferred-language') + ':<br>',\r\n            css: {\r\n                marginTop: '10px',\r\n            }\r\n        });\r\n        const options: [string, string][] = [\r\n            ['auto', LANG('auto')] as [string, string]\r\n        ].concat(\r\n            languages.map(item => {\r\n                return [item.code, item.name + ` (${item.code})`];\r\n            })\r\n        );\r\n        const languageSelect = new KL.Select({\r\n            initValue: LocalStorage.getItem(LS_LANGUAGE_KEY) ? LocalStorage.getItem(LS_LANGUAGE_KEY) : 'auto',\r\n            optionArr: options,\r\n            onChange: (val) => {\r\n                if (val === 'auto') {\r\n                    LocalStorage.removeItem(LS_LANGUAGE_KEY);\r\n                } else {\r\n                    LocalStorage.setItem(LS_LANGUAGE_KEY, val);\r\n                }\r\n                languageHint.style.display = 'block';\r\n            },\r\n        });\r\n        const languageHint = BB.el({\r\n            content: LANG('settings-language-reload'),\r\n            css: {\r\n                display: 'none',\r\n                marginTop: '5px',\r\n            }\r\n        });\r\n\r\n        preferredLanguageRow.append(\r\n            languageSelect.getElement(),\r\n            languageHint,\r\n        );\r\n\r\n        this.el.append(preferredLanguageRow);\r\n\r\n        // ---- flip ui ----\r\n        BB.el({\r\n            tagName: 'button',\r\n            parent: this.el,\r\n            content: '<img height=\"20\" width=\"18\" src=\"' + uiSwapImg + '\" alt=\"icon\" style=\"margin-right: 5px\"/>' + LANG('switch-ui-left-right'),\r\n            onClick: () => onLeftRight(),\r\n            css: {\r\n                marginTop: '20px',\r\n            },\r\n            custom: {\r\n                tabIndex: '-1',\r\n            }\r\n        });\r\n\r\n\r\n        // ---- about ----\r\n        this.el.append(BB.el({className: 'gridHr', css: {margin: '10px 0'}}));\r\n\r\n        function makeLicenses() {\r\n            return BB.el({\r\n                tagName: 'a',\r\n                content: LANG('licenses'),\r\n                onClick: () => {\r\n                    import('./licenses').then(result => {\r\n                        new Popup({\r\n                            title: BB.el({\r\n                                content: LANG('licenses'),\r\n                            }),\r\n                            content: BB.el({\r\n                                content: BB.el({\r\n                                    content: result.licenses.replace(/\\n/g, '<br>'),\r\n                                    css: {\r\n                                        padding: '20px',\r\n                                    }\r\n                                }),\r\n                                css: {\r\n                                    height: '100%',\r\n                                    overflowY: 'scroll',\r\n                                }\r\n                            }),\r\n                            width: 800,\r\n                            isMaxHeight: true,\r\n                        });\r\n                    });\r\n                },\r\n            });\r\n        }\r\n\r\n        if (customAbout) {\r\n            this.el.append(customAbout);\r\n            if (!customAbout.innerHTML) {\r\n                const minimalAbout = BB.el({\r\n                    parent: customAbout,\r\n                    css: {\r\n                       textAlign: 'center',\r\n                   }\r\n                });\r\n                minimalAbout.append(\r\n                    BB.el({\r\n                        content: `<img alt=\"icon\" height=\"20\" style=\"vertical-align:middle\" src=\"${bitbofLogoImg}\"> <a href=\"https://bitbof.com\" target=\"_blank\" tabIndex=\"-1\">bitbof</a> © 2022<br>`,\r\n                    }),\r\n                    makeLicenses(),\r\n                );\r\n            }\r\n        } else {\r\n            const versionEl = BB.el({\r\n                parent: this.el,\r\n                css: {\r\n                    textAlign: 'center',\r\n                },\r\n                content: `\r\n<img alt=\"Klecks\" height=\"25\" src=\"${klecksLogoImg}\"><br>\r\n<img alt=\"icon\" height=\"20\" style=\"vertical-align:middle\" src=\"${bitbofLogoImg}\"> <a href=\"https://bitbof.com\" target=\"_blank\" tabIndex=\"-1\">bitbof</a> © 2022<br>`\r\n            });\r\n\r\n            versionEl.append(\r\n                makeLicenses(),\r\n                document.createTextNode(' | '),\r\n                BB.el({\r\n                    tagName: 'a',\r\n                    content: LANG('donate'),\r\n                    custom: {\r\n                        href: 'https://kleki.com/donate/',\r\n                        target: '_blank',\r\n                    }\r\n                }),\r\n                document.createTextNode(' | '),\r\n                BB.el({\r\n                    tagName: 'a',\r\n                    content: LANG('source-code'),\r\n                    custom: {\r\n                        href: 'https://klecks.org',\r\n                        target: '_blank',\r\n                    }\r\n                }),\r\n            );\r\n\r\n\r\n        }\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key !== LS_LANGUAGE_KEY) {\r\n                return;\r\n            }\r\n            languageSelect.setValue(\r\n                LocalStorage.getItem(LS_LANGUAGE_KEY) ? LocalStorage.getItem(LS_LANGUAGE_KEY) : 'auto'\r\n            );\r\n        });\r\n\r\n    }\r\n\r\n    getElement (): HTMLElement {\r\n        return this.el;\r\n    }\r\n\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"kSWIa\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"4FMUg\");","module.exports = (require(\"./helpers/browser/js-loader\")(require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"79hnx\"))).then(() => parcelRequire('jNQF2'));","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport caretImg from 'url:~/src/app/img/ui/caret-down.svg';\r\nimport {IKeyString} from '../../../bb/bb.types';\r\nimport {LANG} from '../../../language/language';\r\nimport {dialogCounter} from '../modals/modal-count';\r\n\r\n/**\r\n * Scroll buttons at the top and bottom of toolspace\r\n * Show up when window is very small.\r\n * Allow user to scroll up and down toolspace.\r\n */\r\nexport class ToolspaceScroller {\r\n\r\n    private toolspace: HTMLElement;\r\n    private upBtn: HTMLElement;\r\n    private downBtn: HTMLElement;\r\n    private downInterval: any;\r\n    private upInterval: any;\r\n\r\n    private update(): void {\r\n        if (this.toolspace.scrollHeight > this.toolspace.offsetHeight + 3) { // small buffer where it's not worth it\r\n            if (!this.upInterval) {\r\n                this.upBtn.style.display = this.toolspace.scrollTop === 0 ? 'none' : 'block';\r\n            }\r\n            if (!this.downInterval) {\r\n                this.downBtn.style.display = (\r\n                    this.toolspace.scrollTop + this.toolspace.offsetHeight + 1 >= this.toolspace.scrollHeight ?\r\n                        'none' : 'block'\r\n                );\r\n            }\r\n        } else {\r\n            this.upBtn.style.display = 'none';\r\n            this.downBtn.style.display = 'none';\r\n        }\r\n    }\r\n\r\n    // --- public ---\r\n    constructor(p: {toolspace: HTMLElement, uiState: 'left' | 'right'}) {\r\n        this.toolspace = p.toolspace;\r\n        this.upBtn = BB.el({\r\n            parent: this.toolspace,\r\n            title: LANG('scroll'),\r\n            className: 'kl-scroller',\r\n            css: {\r\n                top: '0',\r\n                transform: 'rotate(180deg)',\r\n            }\r\n        });\r\n        this.downBtn = BB.el({\r\n            parent: this.toolspace,\r\n            title: LANG('scroll'),\r\n            className: 'kl-scroller',\r\n            css: {\r\n                bottom: '0',\r\n            }\r\n        });\r\n        this.updateUiState(p.uiState);\r\n\r\n        const upListener = new BB.PointerListener({\r\n            target: this.upBtn,\r\n            onPointer: (e) => {\r\n                if (e.type === 'pointerdown') {\r\n                    this.upInterval = setInterval(() => {\r\n                        this.toolspace.scrollBy(0, -13);\r\n                        this.update();\r\n                    }, 20);\r\n                }\r\n                if (e.type === 'pointerup') {\r\n                    clearInterval(this.upInterval);\r\n                    setTimeout(() => { // prevent ff pressing anything underneath\r\n                        this.upInterval = null;\r\n                        this.update()\r\n                    }, 50);\r\n                }\r\n            },\r\n        });\r\n        const downListener = new BB.PointerListener({\r\n            target: this.downBtn,\r\n            onPointer: (e) => {\r\n                if (e.type === 'pointerdown') {\r\n                    this.downInterval = setInterval(() => {\r\n                        this.toolspace.scrollBy(0, 13);\r\n                        this.update();\r\n                    }, 20);\r\n                }\r\n                if (e.type === 'pointerup') {\r\n                    clearInterval(this.downInterval);\r\n                    setTimeout(() => { // prevent ff pressing anything underneath\r\n                        this.downInterval = null;\r\n                        this.update()\r\n                    }, 50);\r\n                }\r\n            }\r\n        });\r\n\r\n        const wheelListener = (e: WheelEvent) => {\r\n            this.toolspace.scrollBy(0, Math.round(0.7 * e.deltaY));\r\n            this.update();\r\n        };\r\n        this.upBtn.addEventListener('wheel', wheelListener);\r\n        this.downBtn.addEventListener('wheel', wheelListener);\r\n\r\n        this.update();\r\n\r\n        const observer = new MutationObserver(() => this.update());\r\n        observer.observe(\r\n            this.toolspace,\r\n            {\r\n                attributes: true,\r\n                childList: true,\r\n                subtree: true,\r\n            }\r\n        );\r\n        window.addEventListener('resize', () => this.update());\r\n\r\n        // hide if in dialog because that can have its own scrollbar\r\n        dialogCounter.subscribe((v) => {\r\n            // ignores the 0.5 by tool dropdown\r\n            this.upBtn.style.opacity = v >= 1 ? '0' : '';\r\n            this.downBtn.style.opacity = v >= 1 ? '0' : '';\r\n        });\r\n    }\r\n\r\n    updateUiState (uiState: 'left' | 'right'): void {\r\n        BB.css(this.upBtn, {\r\n            left: uiState === 'left' ? '0' : null,\r\n            right: uiState === 'right' ? '0' : null,\r\n        });\r\n        BB.css(this.downBtn, {\r\n            left: uiState === 'left' ? '0' : null,\r\n            right: uiState === 'right' ? '0' : null,\r\n        });\r\n    }\r\n}","/**\r\n * Topmost row of buttons in toolspace\r\n *\r\n * p = { // button click callbacks\r\n *     onSubmit: function(),\r\n *     onLeftRight: function(),\r\n *     onHelp: function()\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nimport {BB} from \"../bb/bb\";\r\n// @ts-ignore\r\nimport uiSwapImg from 'url:~/src/app/img/ui/ui-swap-lr.svg';\r\n// @ts-ignore\r\nimport helpImg from 'url:~/src/app/img/ui/help.svg';\r\nimport {LANG} from '../language/language';\r\n\r\nexport class ToolspaceTopRow {\r\n    el: HTMLDivElement;\r\n\r\n    constructor(p: {onSubmit: () => void, onLeftRight: () => void, onHelp: () => void}) {\r\n        let div = document.createElement('div');\r\n        this.el = div;\r\n        BB.css(div, {\r\n            height: '36px',\r\n            //background: '#f00',\r\n            display: 'flex',\r\n            backgroundImage: 'linear-gradient(to top, rgba(255, 255, 255, 0) 20%, rgba(255, 255, 255, 0.6) 100%)'\r\n        });\r\n\r\n        function createButton(p) {\r\n            let padding = 6 + (p.extraPadding ? p.extraPadding : 0);\r\n            let result = BB.el({\r\n                className: 'toolspace-row-button nohighlight',\r\n                title: p.title,\r\n                onClick: p.onClick,\r\n                css: {\r\n                    padding: p.content ? '' : (p.contain ? padding + 'px 0' : ''),\r\n                }\r\n            });\r\n            if (p.content) {\r\n                result.appendChild(p.content);\r\n            } else {\r\n                let im = BB.el({\r\n                    css: {\r\n                        backgroundImage: 'url(\\'' + p.image + '\\')',\r\n                        backgroundRepeat: 'no-repeat',\r\n                        backgroundPosition: 'center',\r\n                        backgroundSize: p.contain ? 'contain' : '',\r\n                        //filter: 'grayscale(1)',\r\n                        height: '100%'\r\n                    }\r\n                });\r\n                im.style.pointerEvents = 'none';\r\n                result.appendChild(im);\r\n            }\r\n            (result as any).pointerListener = new BB.PointerListener({ // because :hover causes problems w touch\r\n                target: result,\r\n                onEnterLeave: function(isOver) {\r\n                    if (isOver) {\r\n                        BB.addClassName(result, 'toolspace-row-button-hover');\r\n                    } else {\r\n                        BB.removeClassName(result, 'toolspace-row-button-hover');\r\n                    }\r\n                }\r\n            });\r\n            return result;\r\n        }\r\n\r\n        let submitButton = createButton({\r\n            onClick: p.onSubmit,\r\n            title: LANG('submit-title'),\r\n            content: BB.el({\r\n                content: LANG('submit'),\r\n                className: 'toolspace-row-button__submit',\r\n                css: {\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    width: '100%',\r\n                    height: '100%'\r\n                }\r\n            }),\r\n            contain: true\r\n        });\r\n        submitButton.style.width = '45px';\r\n\r\n        let helpButton = createButton({\r\n            onClick: p.onHelp,\r\n            title: LANG('help'),\r\n            image: helpImg,\r\n            contain: true\r\n        });\r\n\r\n        let leftRightButton = createButton({\r\n            onClick: p.onLeftRight,\r\n            title: LANG('switch-ui-left-right'),\r\n            image: uiSwapImg,\r\n            contain: true\r\n        });\r\n\r\n        div.appendChild(submitButton);\r\n        div.appendChild(leftRightButton);\r\n        div.appendChild(helpButton);\r\n    }\r\n\r\n    getElement() {\r\n        return this.el;\r\n    }\r\n}\r\n","import {filterLib, filterLibStatus} from './filters';\r\nimport {glBrightnessContrast} from './gl-brightness-contrast';\r\nimport {cropExtend} from './crop-extend';\r\nimport {glCurves} from './gl-curves';\r\nimport {flip} from './flip';\r\nimport {glHueSaturation} from './gl-hue-saturation';\r\nimport {invert} from './invert';\r\nimport {glPerspective} from './gl-perspective';\r\nimport {resize} from './resize';\r\nimport {rotate} from './rotate';\r\nimport {glTiltShift} from './gl-tilt-shift';\r\nimport {transform} from './transform';\r\nimport {glBlur} from './gl-blur';\r\nimport {glUnsharpMask} from './gl-unsharp-mask';\r\nimport {toAlpha} from './to-alpha';\r\n\r\nlet embed: boolean;\r\nfunction importFilter(libObj, moduleObj): void {\r\n    if (moduleObj.getDialog) {\r\n        libObj.getDialog = moduleObj.getDialog;\r\n    }\r\n    libObj.apply = moduleObj.apply;\r\n}\r\n\r\n\r\nexport function importFilters(isEmbed?: boolean) {\r\n    if (filterLibStatus.isLoaded) {\r\n        return;\r\n    }\r\n    embed = isEmbed\r\n\r\n    importFilter(filterLib.glBrightnessContrast, glBrightnessContrast);\r\n    importFilter(filterLib.cropExtend, cropExtend);\r\n    importFilter(filterLib.glCurves, glCurves);\r\n    importFilter(filterLib.flip, flip);\r\n    importFilter(filterLib.glHueSaturation, glHueSaturation);\r\n    importFilter(filterLib.invert, invert);\r\n    importFilter(filterLib.glPerspective, glPerspective);\r\n    importFilter(filterLib.resize, resize);\r\n    importFilter(filterLib.rotate, rotate);\r\n    importFilter(filterLib.glTiltShift, glTiltShift);\r\n    importFilter(filterLib.transform, transform);\r\n    importFilter(filterLib.glBlur, glBlur);\r\n    importFilter(filterLib.glUnsharpMask, glUnsharpMask);\r\n    importFilter(filterLib.toAlpha, toAlpha);\r\n\r\n    filterLibStatus.isLoaded = true;\r\n}","import {BB} from '../../bb/bb';\r\nimport {KlSlider} from '../ui/base-components/kl-slider';\r\nimport {eventResMs} from './filters-consts';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {getSharedFx} from './shared-gl-fx';\r\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\n\r\nexport const glBrightnessContrast = {\r\n    getDialog(params: IFilterGetDialogParam) {\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n\r\n\r\n        let context = params.context; //2d context of canvas\r\n        let canvas = params.canvas; //the klCanvas and dom element\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\r\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (tempCanvas.width > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n\r\n\r\n        function finishInit() {\r\n\r\n            let brightness = 0, contrast = 0;\r\n            div.innerHTML = LANG('filter-bright-contrast-description') + \"<br/><br/>\";\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n\r\n            let brightnessSlider = new KlSlider({\r\n                label: LANG('filter-bright-contrast-brightness'),\r\n                width: 300,\r\n                height: 30,\r\n                min: 0,\r\n                max: 100,\r\n                initValue: (brightness + 1) * 50,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brightness = val / 50 - 1;\r\n                    glCanvas.draw(texture).brightnessContrast(brightness, contrast).update();\r\n                    klCanvasPreview.render();\r\n                }\r\n            });\r\n            let contrastSlider = new KlSlider({\r\n                label: LANG('filter-bright-contrast-contrast'),\r\n                width: 300,\r\n                height: 30,\r\n                min: 0,\r\n                max: 100,\r\n                initValue: (contrast + 1) * 50,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    contrast = val / 50 - 1;\r\n                    glCanvas.draw(texture).brightnessContrast(brightness, contrast).update();\r\n                    klCanvasPreview.render();\r\n                }\r\n            });\r\n            brightnessSlider.getElement().style.marginBottom = \"10px\";\r\n            div.appendChild(brightnessSlider.getElement());\r\n            div.appendChild(contrastSlider.getElement());\r\n\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            BB.css(previewWrapper, {\r\n                width: \"340px\",\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr: IKlBasicLayer[] = [];\r\n            {\r\n                for (let i = 0; i < layers.length; i++) {\r\n                    previewLayerArr.push({\r\n                        image: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            let klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + w),\r\n                height: parseInt('' + h),\r\n                layers: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + w) + 'px',\r\n                    height: parseInt('' + h) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n            div.appendChild(previewWrapper);\r\n\r\n            try {\r\n                glCanvas.draw(texture).brightnessContrast(brightness, contrast).update();\r\n                klCanvasPreview.render();\r\n            } catch(e) {\r\n                (div as any).errorCallback(e);\r\n            }\r\n\r\n            result.destroy = () => {\r\n                brightnessSlider.destroy();\r\n                contrastSlider.destroy();\r\n                texture.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    brightness: brightness,\r\n                    contrast: contrast\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1); // the canvas isn't ready for some reason\r\n\r\n        return result;\r\n    },\r\n\r\n    apply(params: IFilterApply) {\r\n        let context = params.context;\r\n        let brightness = params.input.brightness;\r\n        let contrast = params.input.contrast;\r\n        let history = params.history;\r\n        if (!context || brightness === null || contrast === null || !history)\r\n            return false;\r\n        history.pause(true);\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).brightnessContrast(brightness, contrast).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.push({\r\n            tool: [\"filter\", \"glBrightnessContrast\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n\r\n        return true;\r\n    }\r\n}","\r\nexport const eventResMs = 60;","import {fx} from '../../../script-vendor/glfx';\r\n\r\nlet fxCanvas = null\r\ntry {\r\n    fxCanvas = fx.canvas();\r\n} catch (e) {\r\n}\r\n\r\nexport function getSharedFx() {\r\n    if (!fxCanvas || fxCanvas._.gl.isContextLost()) {\r\n        try {\r\n            fxCanvas = fx.canvas();\r\n        } catch (e) {\r\n        }\r\n    }\r\n    return fxCanvas;\r\n}","/*\r\n * glfx.script\r\n * http://evanw.github.com/glfx.js/\r\n *\r\n * Copyright 2011 Evan Wallace\r\n * Released under the MIT license\r\n *\r\n * modifications by bitbof\r\n */\r\nexport const fx = (function() {\r\nlet exports: any = {};\r\n\r\n// src/OES_texture_float_linear-polyfill.script\r\n// From: https://github.com/evanw/OES_texture_float_linear-polyfill\r\n(function() {\r\n  // Uploads a 2x2 floating-point texture where one pixel is 2 and the other\r\n  // three pixels are 0. Linear filtering is only supported if a sample taken\r\n  // from the center of that texture is (2 + 0 + 0 + 0) / 4 = 0.5.\r\n  function supportsOESTextureFloatLinear(gl) {\r\n    // Need floating point textures in the first place\r\n    if (!gl.getExtension('OES_texture_float')) {\r\n      return false;\r\n    }\r\n\r\n    // Create a render target\r\n    let framebuffer = gl.createFramebuffer();\r\n    let byteTexture = gl.createTexture();\r\n    gl.bindTexture(gl.TEXTURE_2D, byteTexture);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n    gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\r\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, byteTexture, 0);\r\n\r\n    // Create a simple floating-point texture with value of 0.5 in the center\r\n    let rgba = [\r\n      2, 0, 0, 0,\r\n      0, 0, 0, 0,\r\n      0, 0, 0, 0,\r\n      0, 0, 0, 0\r\n    ];\r\n    let floatTexture = gl.createTexture();\r\n    gl.bindTexture(gl.TEXTURE_2D, floatTexture);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 2, 2, 0, gl.RGBA, gl.FLOAT, new Float32Array(rgba));\r\n\r\n    // Create the test shader\r\n    let program = gl.createProgram();\r\n    let vertexShader = gl.createShader(gl.VERTEX_SHADER);\r\n    let fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n    gl.shaderSource(vertexShader, '\\\r\n      attribute vec2 vertex;\\\r\n      void main() {\\\r\n        gl_Position = vec4(vertex, 0.0, 1.0);\\\r\n      }\\\r\n    ');\r\n    gl.shaderSource(fragmentShader, '\\\r\n      uniform sampler2D texture;\\\r\n      void main() {\\\r\n        gl_FragColor = texture2D(texture, vec2(0.5));\\\r\n      }\\\r\n    ');\r\n    gl.compileShader(vertexShader);\r\n    gl.compileShader(fragmentShader);\r\n    gl.attachShader(program, vertexShader);\r\n    gl.attachShader(program, fragmentShader);\r\n    gl.linkProgram(program);\r\n\r\n    // Create a buffer containing a single point\r\n    let buffer = gl.createBuffer();\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\r\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([0, 0]), gl.STREAM_DRAW);\r\n    gl.enableVertexAttribArray(0);\r\n    gl.vertexAttribPointer(0, 2, gl.FLOAT, false, 0, 0);\r\n\r\n    // Render the point and read back the rendered pixel\r\n    let pixel = new Uint8Array(4);\r\n    gl.useProgram(program);\r\n    gl.viewport(0, 0, 1, 1);\r\n    gl.bindTexture(gl.TEXTURE_2D, floatTexture);\r\n    gl.drawArrays(gl.POINTS, 0, 1);\r\n    gl.readPixels(0, 0, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, pixel);\r\n\r\n    // The center sample will only have a value of 0.5 if linear filtering works\r\n    return pixel[0] === 127 || pixel[0] === 128;\r\n  }\r\n\r\n  // The constructor for the returned extension object\r\n  function OESTextureFloatLinear() {\r\n  }\r\n\r\n  // Cache the extension so it's specific to each context like extensions should be\r\n  function getOESTextureFloatLinear(gl) {\r\n    if (gl.$OES_texture_float_linear$ === void 0) {\r\n      Object.defineProperty(gl, '$OES_texture_float_linear$', {\r\n        enumerable: false,\r\n        configurable: false,\r\n        writable: false,\r\n        value: new OESTextureFloatLinear()\r\n      });\r\n    }\r\n    return gl.$OES_texture_float_linear$;\r\n  }\r\n\r\n  // This replaces the real getExtension()\r\n  function getExtension(name) {\r\n    return name === 'OES_texture_float_linear'\r\n      ? getOESTextureFloatLinear(this)\r\n      : oldGetExtension.call(this, name);\r\n  }\r\n\r\n  // This replaces the real getSupportedExtensions()\r\n  function getSupportedExtensions() {\r\n    let extensions = oldGetSupportedExtensions.call(this);\r\n    if (extensions.indexOf('OES_texture_float_linear') === -1) {\r\n      extensions.push('OES_texture_float_linear');\r\n    }\r\n    return extensions;\r\n  }\r\n\r\n  // Get a WebGL context\r\n  try {\r\n    let gl = document.createElement('canvas').getContext('experimental-webgl');\r\n  } catch (e) {\r\n  }\r\n\r\n  // Don't install the polyfill if the browser already supports it or doesn't have WebGL\r\n  if (!gl || (gl as any).getSupportedExtensions().indexOf('OES_texture_float_linear') !== -1) {\r\n    return;\r\n  }\r\n\r\n  // Install the polyfill if linear filtering works with floating-point textures\r\n  let oldGetExtension;\r\n  let oldGetSupportedExtensions;\r\n  if (supportsOESTextureFloatLinear(gl)) {\r\n    oldGetExtension = WebGLRenderingContext.prototype.getExtension;\r\n    oldGetSupportedExtensions = WebGLRenderingContext.prototype.getSupportedExtensions;\r\n    WebGLRenderingContext.prototype.getExtension = getExtension;\r\n    WebGLRenderingContext.prototype.getSupportedExtensions = getSupportedExtensions;\r\n  }\r\n}());\r\n\r\n// src/core\\canvas.script\r\nvar gl;\r\n\r\nfunction clamp(lo, value, hi) {\r\n    return Math.max(lo, Math.min(value, hi));\r\n}\r\n\r\nfunction wrapTexture(texture) {\r\n    return {\r\n        _: texture,\r\n        loadContentsOf: function(element) {\r\n            // Make sure that we're using the correct global WebGL context\r\n            gl = this._.gl;\r\n            this._.loadContentsOf(element);\r\n        },\r\n        destroy: function() {\r\n            // Make sure that we're using the correct global WebGL context\r\n            gl = this._.gl;\r\n            this._.destroy();\r\n        }\r\n    };\r\n}\r\n\r\nfunction texture(element) {\r\n    return wrapTexture(Texture.fromElement(element));\r\n}\r\n\r\nfunction initialize(width, height) {\r\n    let type = gl.UNSIGNED_BYTE;\r\n\r\n    // Go for floating point buffer textures if we can, it'll make the bokeh\r\n    // filter look a lot better. Note that on Windows, ANGLE does not let you\r\n    // render to a floating-point texture when linear filtering is enabled.\r\n    // See http://crbug.com/172278 for more information.\r\n    if (gl.getExtension('OES_texture_float') && gl.getExtension('OES_texture_float_linear')) {\r\n        let testTexture = new Texture(100, 100, gl.RGBA, gl.FLOAT);\r\n        try {\r\n            // Only use gl.FLOAT if we can render to it\r\n            testTexture.drawTo(function() { type = gl.FLOAT; });\r\n        } catch (e) {\r\n        }\r\n        testTexture.destroy();\r\n    }\r\n\r\n    if (this._.texture) this._.texture.destroy();\r\n    if (this._.spareTexture) this._.spareTexture.destroy();\r\n    this.width = width;\r\n    this.height = height;\r\n    this._.texture = new Texture(width, height, gl.RGBA, type);\r\n    this._.spareTexture = new Texture(width, height, gl.RGBA, type);\r\n    this._.extraTexture = this._.extraTexture || new Texture(0, 0, gl.RGBA, type);\r\n    this._.flippedShader = this._.flippedShader || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            gl_FragColor = texture2D(texture, vec2(texCoord.x, 1.0 - texCoord.y));\\\r\n        }\\\r\n    ', 'flippedShader');\r\n    this._.isInitialized = true;\r\n}\r\n\r\n/*\r\n   Draw a texture to the canvas, with an optional width and height to scale to.\r\n   If no width and height are given then the original texture width and height\r\n   are used.\r\n*/\r\nfunction draw(texture, width, height) {\r\n    if (!this._.isInitialized || texture._.width != this.width || texture._.height != this.height) {\r\n        initialize.call(this, width ? width : texture._.width, height ? height : texture._.height);\r\n    }\r\n\r\n    texture._.use();\r\n    this._.texture.drawTo(function() {\r\n        Shader.getDefaultShader().drawRect();\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\nfunction update() {\r\n    this._.texture.use();\r\n    this._.flippedShader.drawRect();\r\n    return this;\r\n}\r\n\r\nfunction simpleShader(shader, uniforms, textureIn, textureOut) {\r\n    (textureIn || this._.texture).use();\r\n    this._.spareTexture.drawTo(function() {\r\n        shader.uniforms(uniforms).drawRect();\r\n    });\r\n    this._.spareTexture.swapWith(textureOut || this._.texture);\r\n}\r\n\r\nfunction replace(node) {\r\n    node.parentNode.insertBefore(this, node);\r\n    node.parentNode.removeChild(node);\r\n    return this;\r\n}\r\n\r\nfunction contents() {\r\n    let texture = new Texture(this._.texture.width, this._.texture.height, gl.RGBA, gl.UNSIGNED_BYTE);\r\n    this._.texture.use();\r\n    texture.drawTo(function() {\r\n        Shader.getDefaultShader().drawRect();\r\n    });\r\n    return wrapTexture(texture);\r\n}\r\n\r\n/*\r\n   Get a Uint8 array of pixel values: [r, g, b, a, r, g, b, a, ...]\r\n   Length of the array will be width * height * 4.\r\n*/\r\nfunction getPixelArray() {\r\n    let w = this._.texture.width;\r\n    let h = this._.texture.height;\r\n    let array = new Uint8Array(w * h * 4);\r\n    this._.texture.drawTo(function() {\r\n        gl.readPixels(0, 0, w, h, gl.RGBA, gl.UNSIGNED_BYTE, array);\r\n    });\r\n    return array;\r\n}\r\n\r\nfunction wrap(func) {\r\n    return function() {\r\n        // Make sure that we're using the correct global WebGL context\r\n        gl = this._.gl;\r\n\r\n        // Now that the context has been switched, we can call the wrapped function\r\n        return func.apply(this, arguments);\r\n    };\r\n}\r\n\r\nexports.canvas = function() {\r\n    let canvas: any = document.createElement('canvas');\r\n    try {\r\n        gl = canvas.getContext('experimental-webgl', { premultipliedAlpha: false });\r\n    } catch (e) {\r\n        gl = null;\r\n    }\r\n    if (!gl) {\r\n        throw 'This browser does not support WebGL';\r\n    }\r\n    canvas._ = {\r\n        gl: gl,\r\n        isInitialized: false,\r\n        texture: null,\r\n        spareTexture: null,\r\n        flippedShader: null\r\n    };\r\n\r\n    // Core methods\r\n    canvas.texture = wrap(texture);\r\n    canvas.draw = wrap(draw);\r\n    canvas.update = wrap(update);\r\n    canvas.replace = wrap(replace);\r\n    canvas.contents = wrap(contents);\r\n    canvas.getPixelArray = wrap(getPixelArray);\r\n\r\n    // Filter methods\r\n    canvas.brightnessContrast = wrap(brightnessContrast);\r\n    canvas.hexagonalPixelate = wrap(hexagonalPixelate);\r\n    canvas.hueSaturation = wrap(hueSaturation);\r\n    canvas.colorHalftone = wrap(colorHalftone);\r\n    canvas.triangleBlur = wrap(triangleBlur);\r\n    canvas.unsharpMask = wrap(unsharpMask);\r\n    canvas.perspective = wrap(perspective);\r\n    canvas.matrixWarp = wrap(matrixWarp);\r\n    canvas.bulgePinch = wrap(bulgePinch);\r\n    canvas.tiltShift = wrap(tiltShift);\r\n    canvas.dotScreen = wrap(dotScreen);\r\n    canvas.edgeWork = wrap(edgeWork);\r\n    canvas.lensBlur = wrap(lensBlur);\r\n    canvas.zoomBlur = wrap(zoomBlur);\r\n    canvas.noise = wrap(noise);\r\n    canvas.denoise = wrap(denoise);\r\n    canvas.curves = wrap(curves);\r\n    canvas.swirl = wrap(swirl);\r\n    canvas.ink = wrap(ink);\r\n    canvas.vignette = wrap(vignette);\r\n    canvas.vibrance = wrap(vibrance);\r\n    canvas.sepia = wrap(sepia);\r\n    canvas.invert = wrap(invert);\r\n    canvas.toAlpha = wrap(toAlpha);\r\n\r\n    return canvas;\r\n};\r\nexports.splineInterpolate = splineInterpolate;\r\n\r\n// src/core\\matrix.script\r\n// from javax.media.jai.PerspectiveTransform\r\n\r\nfunction getSquareToQuad(x0, y0, x1, y1, x2, y2, x3, y3) {\r\n    let dx1 = x1 - x2;\r\n    let dy1 = y1 - y2;\r\n    let dx2 = x3 - x2;\r\n    let dy2 = y3 - y2;\r\n    let dx3 = x0 - x1 + x2 - x3;\r\n    let dy3 = y0 - y1 + y2 - y3;\r\n    let det = dx1*dy2 - dx2*dy1;\r\n    let a = (dx3*dy2 - dx2*dy3) / det;\r\n    let b = (dx1*dy3 - dx3*dy1) / det;\r\n    return [\r\n        x1 - x0 + a*x1, y1 - y0 + a*y1, a,\r\n        x3 - x0 + b*x3, y3 - y0 + b*y3, b,\r\n        x0, y0, 1\r\n    ];\r\n}\r\n\r\nfunction getInverse(m) {\r\n    let a = m[0], b = m[1], c = m[2];\r\n    let d = m[3], e = m[4], f = m[5];\r\n    let g = m[6], h = m[7], i = m[8];\r\n    let det = a*e*i - a*f*h - b*d*i + b*f*g + c*d*h - c*e*g;\r\n    return [\r\n        (e*i - f*h) / det, (c*h - b*i) / det, (b*f - c*e) / det,\r\n        (f*g - d*i) / det, (a*i - c*g) / det, (c*d - a*f) / det,\r\n        (d*h - e*g) / det, (b*g - a*h) / det, (a*e - b*d) / det\r\n    ];\r\n}\r\n\r\nfunction multiply(a, b) {\r\n    return [\r\n        a[0]*b[0] + a[1]*b[3] + a[2]*b[6],\r\n        a[0]*b[1] + a[1]*b[4] + a[2]*b[7],\r\n        a[0]*b[2] + a[1]*b[5] + a[2]*b[8],\r\n        a[3]*b[0] + a[4]*b[3] + a[5]*b[6],\r\n        a[3]*b[1] + a[4]*b[4] + a[5]*b[7],\r\n        a[3]*b[2] + a[4]*b[5] + a[5]*b[8],\r\n        a[6]*b[0] + a[7]*b[3] + a[8]*b[6],\r\n        a[6]*b[1] + a[7]*b[4] + a[8]*b[7],\r\n        a[6]*b[2] + a[7]*b[5] + a[8]*b[8]\r\n    ];\r\n}\r\n\r\n// src/core\\shader.script\r\nvar Shader = (function() {\r\n    function isArray(obj) {\r\n        return Object.prototype.toString.call(obj) == '[object Array]';\r\n    }\r\n\r\n    function isNumber(obj) {\r\n        return Object.prototype.toString.call(obj) == '[object Number]';\r\n    }\r\n\r\n    function compileSource(type, source, nameStr) {\r\n        let shader = gl.createShader(type);\r\n        gl.shaderSource(shader, source);\r\n        gl.compileShader(shader);\r\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n            throw 'compile error: ' + nameStr + ' - ' + gl.getShaderInfoLog(shader);\r\n        }\r\n        return shader;\r\n    }\r\n\r\n    let defaultVertexSource = '\\\r\n    attribute vec2 vertex;\\\r\n    attribute vec2 _texCoord;\\\r\n    varying vec2 texCoord;\\\r\n    void main() {\\\r\n        texCoord = _texCoord;\\\r\n        gl_Position = vec4(vertex * 2.0 - 1.0, 0.0, 1.0);\\\r\n    }';\r\n\r\n    let defaultFragmentSource = '\\\r\n    uniform sampler2D texture;\\\r\n    varying vec2 texCoord;\\\r\n    void main() {\\\r\n        gl_FragColor = texture2D(texture, texCoord);\\\r\n    }';\r\n\r\n    // added test 2020-04-27 bitbof\r\n    let floatPrecision = null;\r\n    function testPrecisionSupport(precisionType) {\r\n        let format = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, precisionType);\r\n        return format !== null && format.precision !== 0;\r\n    }\r\n\r\n    function Shader(vertexSource?, fragmentSource?, nameStr?) {\r\n        this.vertexAttribute = null;\r\n        this.texCoordAttribute = null;\r\n        this.program = gl.createProgram();\r\n        vertexSource = vertexSource || defaultVertexSource;\r\n        fragmentSource = fragmentSource || defaultFragmentSource;\r\n        if (floatPrecision === null) {\r\n            floatPrecision = testPrecisionSupport(gl.HIGH_FLOAT) ? 'highp' : (testPrecisionSupport(gl.MEDIUM_FLOAT) ? 'mediump' : 'lowp');\r\n        }\r\n        fragmentSource = 'precision ' + floatPrecision + ' float;' + fragmentSource; // annoying requirement is annoying\r\n        gl.attachShader(this.program, compileSource(gl.VERTEX_SHADER, vertexSource, nameStr + '(vertex)'));\r\n        gl.attachShader(this.program, compileSource(gl.FRAGMENT_SHADER, fragmentSource, nameStr + '(fragment)'));\r\n        gl.linkProgram(this.program);\r\n        if (!gl.getProgramParameter(this.program, gl.LINK_STATUS)) {\r\n            throw 'link error: ' + gl.getProgramInfoLog(this.program);\r\n        }\r\n    }\r\n\r\n    Shader.prototype.destroy = function() {\r\n        gl.deleteProgram(this.program);\r\n        this.program = null;\r\n    };\r\n\r\n    Shader.prototype.uniforms = function(uniforms) {\r\n        gl.useProgram(this.program);\r\n        for (var name in uniforms) {\r\n            if (!uniforms.hasOwnProperty(name)) continue;\r\n            let location = gl.getUniformLocation(this.program, name);\r\n            if (location === null) continue; // will be null if the uniform isn't used in the shader\r\n            let value = uniforms[name];\r\n            if (isArray(value)) {\r\n                switch (value.length) {\r\n                    case 1: gl.uniform1fv(location, new Float32Array(value)); break;\r\n                    case 2: gl.uniform2fv(location, new Float32Array(value)); break;\r\n                    case 3: gl.uniform3fv(location, new Float32Array(value)); break;\r\n                    case 4: gl.uniform4fv(location, new Float32Array(value)); break;\r\n                    case 9: gl.uniformMatrix3fv(location, false, new Float32Array(value)); break;\r\n                    case 16: gl.uniformMatrix4fv(location, false, new Float32Array(value)); break;\r\n                    default: throw 'dont\\'t know how to load uniform \"' + name + '\" of length ' + value.length;\r\n                }\r\n            } else if (isNumber(value)) {\r\n                gl.uniform1f(location, value);\r\n            } else {\r\n                throw 'attempted to set uniform \"' + name + '\" to invalid value ' + (value || 'undefined').toString();\r\n            }\r\n        }\r\n        // allow chaining\r\n        return this;\r\n    };\r\n\r\n    // textures are uniforms too but for some reason can't be specified by gl.uniform1f,\r\n    // even though floating point numbers represent the integers 0 through 7 exactly\r\n    Shader.prototype.textures = function(textures) {\r\n        gl.useProgram(this.program);\r\n        for (var name in textures) {\r\n            if (!textures.hasOwnProperty(name)) continue;\r\n            gl.uniform1i(gl.getUniformLocation(this.program, name), textures[name]);\r\n        }\r\n        // allow chaining\r\n        return this;\r\n    };\r\n\r\n    Shader.prototype.drawRect = function(left, top, right, bottom) {\r\n        let undefined;\r\n        let viewport = gl.getParameter(gl.VIEWPORT);\r\n        top = top !== undefined ? (top - viewport[1]) / viewport[3] : 0;\r\n        left = left !== undefined ? (left - viewport[0]) / viewport[2] : 0;\r\n        right = right !== undefined ? (right - viewport[0]) / viewport[2] : 1;\r\n        bottom = bottom !== undefined ? (bottom - viewport[1]) / viewport[3] : 1;\r\n        if (gl.vertexBuffer == null) {\r\n            gl.vertexBuffer = gl.createBuffer();\r\n        }\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, gl.vertexBuffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([ left, top, left, bottom, right, top, right, bottom ]), gl.STATIC_DRAW);\r\n        if (gl.texCoordBuffer == null) {\r\n            gl.texCoordBuffer = gl.createBuffer();\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, gl.texCoordBuffer);\r\n            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([ 0, 0, 0, 1, 1, 0, 1, 1 ]), gl.STATIC_DRAW);\r\n        }\r\n        if (this.vertexAttribute == null) {\r\n            this.vertexAttribute = gl.getAttribLocation(this.program, 'vertex');\r\n            gl.enableVertexAttribArray(this.vertexAttribute);\r\n        }\r\n        if (this.texCoordAttribute == null) {\r\n            this.texCoordAttribute = gl.getAttribLocation(this.program, '_texCoord');\r\n            gl.enableVertexAttribArray(this.texCoordAttribute);\r\n        }\r\n        gl.useProgram(this.program);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, gl.vertexBuffer);\r\n        gl.vertexAttribPointer(this.vertexAttribute, 2, gl.FLOAT, false, 0, 0);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, gl.texCoordBuffer);\r\n        gl.vertexAttribPointer(this.texCoordAttribute, 2, gl.FLOAT, false, 0, 0);\r\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\r\n    };\r\n\r\n    Shader.getDefaultShader = function() {\r\n        gl.defaultShader = gl.defaultShader || new Shader();\r\n        return gl.defaultShader;\r\n    };\r\n\r\n    return Shader;\r\n})();\r\n\r\n// src/core\\spline.script\r\n// from SplineInterpolator.cs in the Paint.NET source code\r\n\r\nfunction SplineInterpolator(points) {\r\n    let n = points.length;\r\n    this.xa = [];\r\n    this.ya = [];\r\n    this.u = [];\r\n    this.y2 = [];\r\n\r\n    points.sort(function(a, b) {\r\n        return a[0] - b[0];\r\n    });\r\n    for (var i = 0; i < n; i++) {\r\n        this.xa.push(points[i][0]);\r\n        this.ya.push(points[i][1]);\r\n    }\r\n\r\n    this.u[0] = 0;\r\n    this.y2[0] = 0;\r\n\r\n    for (var i = 1; i < n - 1; ++i) {\r\n        // This is the decomposition loop of the tridiagonal algorithm. \r\n        // y2 and u are used for temporary storage of the decomposed factors.\r\n        let wx = this.xa[i + 1] - this.xa[i - 1];\r\n        let sig = (this.xa[i] - this.xa[i - 1]) / wx;\r\n        let p = sig * this.y2[i - 1] + 2.0;\r\n\r\n        this.y2[i] = (sig - 1.0) / p;\r\n\r\n        let ddydx = \r\n            (this.ya[i + 1] - this.ya[i]) / (this.xa[i + 1] - this.xa[i]) - \r\n            (this.ya[i] - this.ya[i - 1]) / (this.xa[i] - this.xa[i - 1]);\r\n\r\n        this.u[i] = (6.0 * ddydx / wx - sig * this.u[i - 1]) / p;\r\n    }\r\n\r\n    this.y2[n - 1] = 0;\r\n\r\n    // This is the backsubstitution loop of the tridiagonal algorithm\r\n    for (var i = n - 2; i >= 0; --i) {\r\n        this.y2[i] = this.y2[i] * this.y2[i + 1] + this.u[i];\r\n    }\r\n}\r\n\r\nSplineInterpolator.prototype.interpolate = function(x) {\r\n    let n = this.ya.length;\r\n    let klo = 0;\r\n    let khi = n - 1;\r\n\r\n    // We will find the right place in the table by means of\r\n    // bisection. This is optimal if sequential calls to this\r\n    // routine are at random values of x. If sequential calls\r\n    // are in order, and closely spaced, one would do better\r\n    // to store previous values of klo and khi.\r\n    while (khi - klo > 1) {\r\n        let k = (khi + klo) >> 1;\r\n\r\n        if (this.xa[k] > x) {\r\n            khi = k; \r\n        } else {\r\n            klo = k;\r\n        }\r\n    }\r\n\r\n    let h = this.xa[khi] - this.xa[klo];\r\n    let a = (this.xa[khi] - x) / h;\r\n    let b = (x - this.xa[klo]) / h;\r\n\r\n    // Cubic spline polynomial is now evaluated.\r\n    return a * this.ya[klo] + b * this.ya[khi] + \r\n        ((a * a * a - a) * this.y2[klo] + (b * b * b - b) * this.y2[khi]) * (h * h) / 6.0;\r\n};\r\n\r\n// src/core\\texture.script\r\nvar Texture = (function() {\r\n    Texture.fromElement = function(element) {\r\n        let texture = new Texture(0, 0, gl.RGBA, gl.UNSIGNED_BYTE);\r\n        texture.loadContentsOf(element);\r\n        return texture;\r\n    };\r\n\r\n    function Texture(width, height, format, type) {\r\n        this.gl = gl;\r\n        this.id = gl.createTexture();\r\n        this.width = width;\r\n        this.height = height;\r\n        this.format = format;\r\n        this.type = type;\r\n\r\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        if (width && height) gl.texImage2D(gl.TEXTURE_2D, 0, this.format, width, height, 0, this.format, this.type, null);\r\n    }\r\n\r\n    Texture.prototype.loadContentsOf = function(element) {\r\n        this.width = element.width || element.videoWidth;\r\n        this.height = element.height || element.videoHeight;\r\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, this.format, this.format, this.type, element);\r\n    };\r\n\r\n    Texture.prototype.initFromBytes = function(width, height, data) {\r\n        this.width = width;\r\n        this.height = height;\r\n        this.format = gl.RGBA;\r\n        this.type = gl.UNSIGNED_BYTE;\r\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, this.type, new Uint8Array(data));\r\n    };\r\n\r\n    Texture.prototype.destroy = function() {\r\n        gl.deleteTexture(this.id);\r\n        this.id = null;\r\n    };\r\n\r\n    Texture.prototype.use = function(unit) {\r\n        gl.activeTexture(gl.TEXTURE0 + (unit || 0));\r\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n    };\r\n\r\n    Texture.prototype.unuse = function(unit) {\r\n        gl.activeTexture(gl.TEXTURE0 + (unit || 0));\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n    };\r\n\r\n    Texture.prototype.ensureFormat = function(width, height, format, type) {\r\n        // allow passing an existing texture instead of individual arguments\r\n        if (arguments.length == 1) {\r\n            let texture = arguments[0];\r\n            width = texture.width;\r\n            height = texture.height;\r\n            format = texture.format;\r\n            type = texture.type;\r\n        }\r\n\r\n        // change the format only if required\r\n        if (width != this.width || height != this.height || format != this.format || type != this.type) {\r\n            this.width = width;\r\n            this.height = height;\r\n            this.format = format;\r\n            this.type = type;\r\n            gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n            gl.texImage2D(gl.TEXTURE_2D, 0, this.format, width, height, 0, this.format, this.type, null);\r\n        }\r\n    };\r\n\r\n    Texture.prototype.drawTo = function(callback) {\r\n        // start rendering to this texture\r\n        gl.framebuffer = gl.framebuffer || gl.createFramebuffer();\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, gl.framebuffer);\r\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.id, 0);\r\n        if (gl.checkFramebufferStatus(gl.FRAMEBUFFER) !== gl.FRAMEBUFFER_COMPLETE) {\r\n            throw new Error('incomplete framebuffer');\r\n        }\r\n        gl.viewport(0, 0, this.width, this.height);\r\n\r\n        // do the drawing\r\n        callback();\r\n\r\n        // stop rendering to this texture\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n    };\r\n\r\n    let canvas = null;\r\n\r\n    function getCanvas(texture) {\r\n        if (canvas == null) canvas = document.createElement('canvas');\r\n        canvas.width = texture.width;\r\n        canvas.height = texture.height;\r\n        let c = canvas.getContext('2d');\r\n        c.clearRect(0, 0, canvas.width, canvas.height);\r\n        return c;\r\n    }\r\n\r\n    Texture.prototype.fillUsingCanvas = function(callback) {\r\n        callback(getCanvas(this));\r\n        this.format = gl.RGBA;\r\n        this.type = gl.UNSIGNED_BYTE;\r\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, canvas);\r\n        return this;\r\n    };\r\n\r\n    Texture.prototype.toImage = function(image) {\r\n        this.use();\r\n        Shader.getDefaultShader().drawRect();\r\n        let size = this.width * this.height * 4;\r\n        let pixels = new Uint8Array(size);\r\n        let c = getCanvas(this);\r\n        let data = c.createImageData(this.width, this.height);\r\n        gl.readPixels(0, 0, this.width, this.height, gl.RGBA, gl.UNSIGNED_BYTE, pixels);\r\n        for (var i = 0; i < size; i++) {\r\n            data.data[i] = pixels[i];\r\n        }\r\n        c.putImageData(data, 0, 0);\r\n        image.src = canvas.toDataURL();\r\n    };\r\n\r\n    Texture.prototype.swapWith = function(other) {\r\n        let temp;\r\n        temp = other.id; other.id = this.id; this.id = temp;\r\n        temp = other.width; other.width = this.width; this.width = temp;\r\n        temp = other.height; other.height = this.height; this.height = temp;\r\n        temp = other.format; other.format = this.format; this.format = temp;\r\n    };\r\n\r\n    return Texture;\r\n})();\r\n\r\n// src/filters\\common.script\r\nfunction warpShader(uniforms, warp) {\r\n    return new Shader(null, uniforms + '\\\r\n    uniform sampler2D texture;\\\r\n    uniform vec2 texSize;\\\r\n    varying vec2 texCoord;\\\r\n    void main() {\\\r\n        vec2 coord = texCoord * texSize;\\\r\n        ' + warp + '\\\r\n        gl_FragColor = texture2D(texture, coord / texSize);\\\r\n        vec2 clampedCoord = clamp(coord, vec2(0.0), texSize);\\\r\n        if (coord != clampedCoord) {\\\r\n            /* fade to transparent if we are outside the image */\\\r\n            gl_FragColor.a *= max(0.0, 1.0 - length(coord - clampedCoord));\\\r\n        }\\\r\n    }', 'warp');\r\n}\r\n\r\n// returns a random number between 0 and 1\r\nvar randomShaderFunc = '\\\r\n    float random(vec3 scale, float seed) {\\\r\n        /* use the fragment position for a different seed per-pixel */\\\r\n        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\\\r\n    }\\\r\n';\r\n\r\n// src/filters\\adjust\\brightnesscontrast.script\r\n/**\r\n * @filter           Brightness / Contrast\r\n * @description      Provides additive brightness and multiplicative contrast control.\r\n * @param brightness -1 to 1 (-1 is solid black, 0 is no change, and 1 is solid white)\r\n * @param contrast   -1 to 1 (-1 is solid gray, 0 is no change, and 1 is maximum contrast)\r\n */\r\nfunction brightnessContrast(brightness, contrast) {\r\n    gl.brightnessContrast = gl.brightnessContrast || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float brightness;\\\r\n        uniform float contrast;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            color.rgb += brightness;\\\r\n            if (contrast > 0.0) {\\\r\n                color.rgb = (color.rgb - 0.5) / (1.0 - contrast) + 0.5;\\\r\n            } else {\\\r\n                color.rgb = (color.rgb - 0.5) * (1.0 + contrast) + 0.5;\\\r\n            }\\\r\n            gl_FragColor = color;\\\r\n        }\\\r\n    ', 'brightnessContrast');\r\n\r\n    simpleShader.call(this, gl.brightnessContrast, {\r\n        brightness: clamp(-1, brightness, 1),\r\n        contrast: clamp(-1, contrast, 1)\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\curves.script\r\nfunction splineInterpolate(points) {\r\n    let interpolator = new SplineInterpolator(points);\r\n    let array = [];\r\n    for (var i = 0; i < 256; i++) {\r\n        array.push(clamp(0, Math.floor(interpolator.interpolate(i / 255) * 256), 255));\r\n    }\r\n    return array;\r\n}\r\n\r\n/**\r\n * @filter      Curves\r\n * @description A powerful mapping tool that transforms the colors in the image\r\n *              by an arbitrary function. The function is interpolated between\r\n *              a set of 2D points using splines. The curves filter can take\r\n *              either one or three arguments which will apply the mapping to\r\n *              either luminance or RGB values, respectively.\r\n * @param red   A list of points that define the function for the red channel.\r\n *              Each point is a list of two values: the value before the mapping\r\n *              and the value after the mapping, both in the range 0 to 1. For\r\n *              example, [[0,1], [1,0]] would invert the red channel while\r\n *              [[0,0], [1,1]] would leave the red channel unchanged. If green\r\n *              and blue are omitted then this argument also applies to the\r\n *              green and blue channels.\r\n * @param green (optional) A list of points that define the function for the green\r\n *              channel (just like for red).\r\n * @param blue  (optional) A list of points that define the function for the blue\r\n *              channel (just like for red).\r\n */\r\nfunction curves(red, green, blue) {\r\n    // Create the ramp texture\r\n    red = splineInterpolate(red);\r\n    if (arguments.length == 1) {\r\n        green = blue = red;\r\n    } else {\r\n        green = splineInterpolate(green);\r\n        blue = splineInterpolate(blue);\r\n    }\r\n    let array = [];\r\n    for (var i = 0; i < 256; i++) {\r\n        array.splice(array.length, 0, red[i], green[i], blue[i], 255);\r\n    }\r\n    this._.extraTexture.initFromBytes(256, 1, array);\r\n    this._.extraTexture.use(1);\r\n\r\n    gl.curves = gl.curves || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform sampler2D map;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            color.r = texture2D(map, vec2(color.r)).r;\\\r\n            color.g = texture2D(map, vec2(color.g)).g;\\\r\n            color.b = texture2D(map, vec2(color.b)).b;\\\r\n            gl_FragColor = color;\\\r\n        }\\\r\n    ', 'curves');\r\n\r\n    gl.curves.textures({\r\n        map: 1\r\n    });\r\n    simpleShader.call(this, gl.curves, {});\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\denoise.script\r\n/**\r\n * @filter         Denoise\r\n * @description    Smooths over grainy noise in dark images using an 9x9 box filter\r\n *                 weighted by color intensity, similar to a bilateral filter.\r\n * @param exponent The exponent of the color intensity difference, should be greater\r\n *                 than zero. A value of zero just gives an 9x9 box blur and high values\r\n *                 give the original image, but ideal values are usually around 10-20.\r\n */\r\nfunction denoise(exponent) {\r\n    // Do a 9x9 bilateral box filter\r\n    gl.denoise = gl.denoise || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float exponent;\\\r\n        uniform float strength;\\\r\n        uniform vec2 texSize;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 center = texture2D(texture, texCoord);\\\r\n            vec4 color = vec4(0.0);\\\r\n            float total = 0.0;\\\r\n            for (float x = -4.0; x <= 4.0; x += 1.0) {\\\r\n                for (float y = -4.0; y <= 4.0; y += 1.0) {\\\r\n                    vec4 sample = texture2D(texture, texCoord + vec2(x, y) / texSize);\\\r\n                    float weight = 1.0 - abs(dot(sample.rgb - center.rgb, vec3(0.25)));\\\r\n                    weight = pow(weight, exponent);\\\r\n                    color += sample * weight;\\\r\n                    total += weight;\\\r\n                }\\\r\n            }\\\r\n            gl_FragColor = color / total;\\\r\n        }\\\r\n    ', 'denoise');\r\n\r\n    // Perform two iterations for stronger results\r\n    for (var i = 0; i < 2; i++) {\r\n        simpleShader.call(this, gl.denoise, {\r\n            exponent: Math.max(0, exponent),\r\n            texSize: [this.width, this.height]\r\n        });\r\n    }\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\huesaturation.script\r\n/**\r\n * @filter           Hue / Saturation\r\n * @description      Provides rotational hue and multiplicative saturation control. RGB color space\r\n *                   can be imagined as a cube where the axes are the red, green, and blue color\r\n *                   values. Hue changing works by rotating the color vector around the grayscale\r\n *                   line, which is the straight line from black (0, 0, 0) to white (1, 1, 1).\r\n *                   Saturation is implemented by scaling all color channel values either toward\r\n *                   or away from the average color channel value.\r\n * @param hue        -1 to 1 (-1 is 180 degree rotation in the negative direction, 0 is no change,\r\n *                   and 1 is 180 degree rotation in the positive direction)\r\n * @param saturation -1 to 1 (-1 is solid gray, 0 is no change, and 1 is maximum contrast)\r\n */\r\nfunction hueSaturation(hue, saturation) {\r\n    gl.hueSaturation = gl.hueSaturation || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float hue;\\\r\n        uniform float saturation;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            \\\r\n            /* hue adjustment, wolfram alpha: RotationTransform[angle, {1, 1, 1}][{x, y, z}] */\\\r\n            float angle = hue * 3.14159265;\\\r\n            float s = sin(angle), c = cos(angle);\\\r\n            vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;\\\r\n            float len = length(color.rgb);\\\r\n            color.rgb = vec3(\\\r\n                dot(color.rgb, weights.xyz),\\\r\n                dot(color.rgb, weights.zxy),\\\r\n                dot(color.rgb, weights.yzx)\\\r\n            );\\\r\n            \\\r\n            /* saturation adjustment */\\\r\n            float average = (color.r + color.g + color.b) / 3.0;\\\r\n            if (saturation > 0.0) {\\\r\n                color.rgb += (average - color.rgb) * (1.0 - 1.0 / (1.001 - saturation));\\\r\n            } else {\\\r\n                color.rgb += (average - color.rgb) * (-saturation);\\\r\n            }\\\r\n            \\\r\n            gl_FragColor = color;\\\r\n        }\\\r\n    ', 'hueSaturation');\r\n\r\n    simpleShader.call(this, gl.hueSaturation, {\r\n        hue: clamp(-1, hue, 1),\r\n        saturation: clamp(-1, saturation, 1)\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\noise.script\r\n/**\r\n * @filter         Noise\r\n * @description    Adds black and white noise to the image.\r\n * @param amount   0 to 1 (0 for no effect, 1 for maximum noise)\r\n */\r\nfunction noise(amount) {\r\n    gl.noise = gl.noise || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float amount;\\\r\n        varying vec2 texCoord;\\\r\n        float rand(vec2 co) {\\\r\n            return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\\r\n        }\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            \\\r\n            float diff = (rand(texCoord) - 0.5) * amount;\\\r\n            color.r += diff;\\\r\n            color.g += diff;\\\r\n            color.b += diff;\\\r\n            \\\r\n            gl_FragColor = color;\\\r\n        }\\\r\n    ', 'noise');\r\n\r\n    simpleShader.call(this, gl.noise, {\r\n        amount: clamp(0, amount, 1)\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\sepia.script\r\n/**\r\n * @filter         Sepia\r\n * @description    Gives the image a reddish-brown monochrome tint that imitates an old photograph.\r\n * @param amount   0 to 1 (0 for no effect, 1 for full sepia coloring)\r\n */\r\nfunction sepia(amount) {\r\n    gl.sepia = gl.sepia || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float amount;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            float r = color.r;\\\r\n            float g = color.g;\\\r\n            float b = color.b;\\\r\n            \\\r\n            color.r = min(1.0, (r * (1.0 - (0.607 * amount))) + (g * (0.769 * amount)) + (b * (0.189 * amount)));\\\r\n            color.g = min(1.0, (r * 0.349 * amount) + (g * (1.0 - (0.314 * amount))) + (b * 0.168 * amount));\\\r\n            color.b = min(1.0, (r * 0.272 * amount) + (g * 0.534 * amount) + (b * (1.0 - (0.869 * amount))));\\\r\n            \\\r\n            gl_FragColor = color;\\\r\n        }\\\r\n    ', 'sepia');\r\n\r\n    simpleShader.call(this, gl.sepia, {\r\n        amount: clamp(0, amount, 1)\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\unsharpmask.script\r\n/**\r\n * @filter         Unsharp Mask\r\n * @description    A form of image sharpening that amplifies high-frequencies in the image. It\r\n *                 is implemented by scaling pixels away from the average of their neighbors.\r\n * @param radius   The blur radius that calculates the average of the neighboring pixels.\r\n * @param strength A scale factor where 0 is no effect and higher values cause a stronger effect.\r\n */\r\nfunction unsharpMask(radius, strength) {\r\n    gl.unsharpMask = gl.unsharpMask || new Shader(null, '\\\r\n        uniform sampler2D blurredTexture;\\\r\n        uniform sampler2D originalTexture;\\\r\n        uniform float strength;\\\r\n        uniform float threshold;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 blurred = texture2D(blurredTexture, texCoord);\\\r\n            vec4 original = texture2D(originalTexture, texCoord);\\\r\n            gl_FragColor = mix(blurred, original, 1.0 + strength);\\\r\n        }\\\r\n    ', 'unsharpMask');\r\n\r\n    // Store a copy of the current texture in the second texture unit\r\n    this._.extraTexture.ensureFormat(this._.texture);\r\n    this._.texture.use();\r\n    this._.extraTexture.drawTo(function() {\r\n        Shader.getDefaultShader().drawRect();\r\n    });\r\n\r\n    // Blur the current texture, then use the stored texture to detect edges\r\n    this._.extraTexture.use(1);\r\n    this.triangleBlur(radius);\r\n    gl.unsharpMask.textures({\r\n        originalTexture: 1\r\n    });\r\n    simpleShader.call(this, gl.unsharpMask, {\r\n        strength: strength\r\n    });\r\n    this._.extraTexture.unuse(1);\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\vibrance.script\r\n/**\r\n * @filter       Vibrance\r\n * @description  Modifies the saturation of desaturated colors, leaving saturated colors unmodified.\r\n * @param amount -1 to 1 (-1 is minimum vibrance, 0 is no change, and 1 is maximum vibrance)\r\n */\r\nfunction vibrance(amount) {\r\n    gl.vibrance = gl.vibrance || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float amount;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            float average = (color.r + color.g + color.b) / 3.0;\\\r\n            float mx = max(color.r, max(color.g, color.b));\\\r\n            float amt = (mx - average) * (-amount * 3.0);\\\r\n            color.rgb = mix(color.rgb, vec3(mx), amt);\\\r\n            gl_FragColor = color;\\\r\n        }\\\r\n    ', 'vibrance');\r\n\r\n    simpleShader.call(this, gl.vibrance, {\r\n        amount: clamp(-1, amount, 1)\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\vignette.script\r\n/**\r\n * @filter         Vignette\r\n * @description    Adds a simulated lens edge darkening effect.\r\n * @param size     0 to 1 (0 for center of frame, 1 for edge of frame)\r\n * @param amount   0 to 1 (0 for no effect, 1 for maximum lens darkening)\r\n */\r\nfunction vignette(size, amount) {\r\n    gl.vignette = gl.vignette || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float size;\\\r\n        uniform float amount;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            \\\r\n            float dist = distance(texCoord, vec2(0.5, 0.5));\\\r\n            color.rgb *= smoothstep(0.8, size * 0.799, dist * (amount + size));\\\r\n            \\\r\n            gl_FragColor = color;\\\r\n        }\\\r\n    ', 'vignette');\r\n\r\n    simpleShader.call(this, gl.vignette, {\r\n        size: clamp(0, size, 1),\r\n        amount: clamp(0, amount, 1)\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\blur\\lensblur.script\r\n/**\r\n * @filter           Lens Blur\r\n * @description      Imitates a camera capturing the image out of focus by using a blur that generates\r\n *                   the large shapes known as bokeh. The polygonal shape of real bokeh is due to the\r\n *                   blades of the aperture diaphragm when it isn't fully open. This blur renders\r\n *                   bokeh from a 6-bladed diaphragm because the computation is more efficient. It\r\n *                   can be separated into three rhombi, each of which is just a skewed box blur.\r\n *                   This filter makes use of the floating point texture WebGL extension to implement\r\n *                   the brightness parameter, so there will be severe visual artifacts if brightness\r\n *                   is non-zero and the floating point texture extension is not available. The\r\n *                   idea was from John White's SIGGRAPH 2011 talk but this effect has an additional\r\n *                   brightness parameter that fakes what would otherwise come from a HDR source.\r\n * @param radius     the radius of the hexagonal disk convolved with the image\r\n * @param brightness -1 to 1 (the brightness of the bokeh, negative values will create dark bokeh)\r\n * @param angle      the rotation of the bokeh in radians\r\n */\r\nfunction lensBlur(radius, brightness, angle) {\r\n    // All averaging is done on values raised to a power to make more obvious bokeh\r\n    // (we will raise the average to the inverse power at the end to compensate).\r\n    // Without this the image looks almost like a normal blurred image. This hack is\r\n    // obviously not realistic, but to accurately simulate this we would need a high\r\n    // dynamic range source photograph which we don't have.\r\n    gl.lensBlurPrePass = gl.lensBlurPrePass || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float power;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            color = pow(color, vec4(power));\\\r\n            gl_FragColor = vec4(color);\\\r\n        }\\\r\n    ', 'lensBlurPrePass');\r\n\r\n    let common = '\\\r\n        uniform sampler2D texture0;\\\r\n        uniform sampler2D texture1;\\\r\n        uniform vec2 delta0;\\\r\n        uniform vec2 delta1;\\\r\n        uniform float power;\\\r\n        varying vec2 texCoord;\\\r\n        ' + randomShaderFunc + '\\\r\n        vec4 sample(vec2 delta) {\\\r\n            /* randomize the lookup values to hide the fixed number of samples */\\\r\n            float offset = random(vec3(delta, 151.7182), 0.0);\\\r\n            \\\r\n            vec4 color = vec4(0.0);\\\r\n            float total = 0.0;\\\r\n            for (float t = 0.0; t <= 30.0; t++) {\\\r\n                float percent = (t + offset) / 30.0;\\\r\n                color += texture2D(texture0, texCoord + delta * percent);\\\r\n                total += 1.0;\\\r\n            }\\\r\n            return color / total;\\\r\n        }\\\r\n    ';\r\n\r\n    gl.lensBlur0 = gl.lensBlur0 || new Shader(null, common + '\\\r\n        void main() {\\\r\n            gl_FragColor = sample(delta0);\\\r\n        }\\\r\n    ', 'lensBlur0');\r\n    gl.lensBlur1 = gl.lensBlur1 || new Shader(null, common + '\\\r\n        void main() {\\\r\n            gl_FragColor = (sample(delta0) + sample(delta1)) * 0.5;\\\r\n        }\\\r\n    ', 'lensBlur1');\r\n    gl.lensBlur2 = gl.lensBlur2 || new Shader(null, common + '\\\r\n        void main() {\\\r\n            vec4 color = (sample(delta0) + 2.0 * texture2D(texture1, texCoord)) / 3.0;\\\r\n            gl_FragColor = pow(color, vec4(power));\\\r\n        }\\\r\n    ', 'lensBlur2').textures({ texture1: 1 });\r\n\r\n    // Generate\r\n    let dir = [];\r\n    for (var i = 0; i < 3; i++) {\r\n        let a = angle + i * Math.PI * 2 / 3;\r\n        dir.push([radius * Math.sin(a) / this.width, radius * Math.cos(a) / this.height]);\r\n    }\r\n    let power = Math.pow(10, clamp(-1, brightness, 1));\r\n\r\n    // Remap the texture values, which will help make the bokeh effect\r\n    simpleShader.call(this, gl.lensBlurPrePass, {\r\n        power: power\r\n    });\r\n\r\n    // Blur two rhombi in parallel into extraTexture\r\n    this._.extraTexture.ensureFormat(this._.texture);\r\n    simpleShader.call(this, gl.lensBlur0, {\r\n        delta0: dir[0]\r\n    }, this._.texture, this._.extraTexture);\r\n    simpleShader.call(this, gl.lensBlur1, {\r\n        delta0: dir[1],\r\n        delta1: dir[2]\r\n    }, this._.extraTexture, this._.extraTexture);\r\n\r\n    // Blur the last rhombus and combine with extraTexture\r\n    simpleShader.call(this, gl.lensBlur0, {\r\n        delta0: dir[1]\r\n    });\r\n    this._.extraTexture.use(1);\r\n    simpleShader.call(this, gl.lensBlur2, {\r\n        power: 1 / power,\r\n        delta0: dir[2]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\blur\\tiltshift.script\r\n/**\r\n * @filter               Tilt Shift\r\n * @description          Simulates the shallow depth of field normally encountered in close-up\r\n *                       photography, which makes the scene seem much smaller than it actually\r\n *                       is. This filter assumes the scene is relatively planar, in which case\r\n *                       the part of the scene that is completely in focus can be described by\r\n *                       a line (the intersection of the focal plane and the scene). An example\r\n *                       of a planar scene might be looking at a road from above at a downward\r\n *                       angle. The image is then blurred with a blur radius that starts at zero\r\n *                       on the line and increases further from the line.\r\n * @param startX         The x coordinate of the start of the line segment.\r\n * @param startY         The y coordinate of the start of the line segment.\r\n * @param endX           The x coordinate of the end of the line segment.\r\n * @param endY           The y coordinate of the end of the line segment.\r\n * @param blurRadius     The maximum radius of the pyramid blur.\r\n * @param gradientRadius The distance from the line at which the maximum blur radius is reached.\r\n */\r\nfunction tiltShift(startX, startY, endX, endY, blurRadius, gradientRadius) {\r\n    gl.tiltShift = gl.tiltShift || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float blurRadius;\\\r\n        uniform float gradientRadius;\\\r\n        uniform vec2 start;\\\r\n        uniform vec2 end;\\\r\n        uniform vec2 delta;\\\r\n        uniform vec2 texSize;\\\r\n        varying vec2 texCoord;\\\r\n        ' + randomShaderFunc + '\\\r\n        void main() {\\\r\n            vec4 color = vec4(0.0);\\\r\n            float total = 0.0;\\\r\n            \\\r\n            /* randomize the lookup values to hide the fixed number of samples */\\\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\r\n            \\\r\n            vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\\\r\n            float radius = smoothstep(0.0, 1.0, abs(dot(texCoord * texSize - start, normal)) / gradientRadius) * blurRadius;\\\r\n            for (float t = -30.0; t <= 30.0; t++) {\\\r\n                float percent = (t + offset - 0.5) / 30.0;\\\r\n                float weight = 1.0 - abs(percent);\\\r\n                vec4 sample = texture2D(texture, texCoord + delta / texSize * percent * radius);\\\r\n                \\\r\n                /* switch to pre-multiplied alpha to correctly blur transparent images */\\\r\n                sample.rgb *= sample.a;\\\r\n                \\\r\n                color += sample * weight;\\\r\n                total += weight;\\\r\n            }\\\r\n            \\\r\n            gl_FragColor = color / total;\\\r\n            \\\r\n            /* switch back from pre-multiplied alpha */\\\r\n            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\\\r\n        }\\\r\n    ', 'tiltShift');\r\n\r\n    let dx = endX - startX;\r\n    let dy = endY - startY;\r\n    let d = Math.sqrt(dx * dx + dy * dy);\r\n    simpleShader.call(this, gl.tiltShift, {\r\n        blurRadius: blurRadius,\r\n        gradientRadius: gradientRadius,\r\n        start: [startX, startY],\r\n        end: [endX, endY],\r\n        delta: [dx / d, dy / d],\r\n        texSize: [this.width, this.height]\r\n    });\r\n    simpleShader.call(this, gl.tiltShift, {\r\n        blurRadius: blurRadius,\r\n        gradientRadius: gradientRadius,\r\n        start: [startX, startY],\r\n        end: [endX, endY],\r\n        delta: [-dy / d, dx / d],\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\blur\\triangleblur.script\r\n/**\r\n * @filter       Triangle Blur\r\n * @description  This is the most basic blur filter, which convolves the image with a\r\n *               pyramid filter. The pyramid filter is separable and is applied as two\r\n *               perpendicular triangle filters.\r\n * @param radius The radius of the pyramid convolved with the image.\r\n */\r\nfunction triangleBlur(radius) {\r\n    gl.triangleBlur = gl.triangleBlur || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform vec2 delta;\\\r\n        varying vec2 texCoord;\\\r\n        ' + randomShaderFunc + '\\\r\n        void main() {\\\r\n            vec4 color = vec4(0.0);\\\r\n            float total = 0.0;\\\r\n            \\\r\n            /* randomize the lookup values to hide the fixed number of samples */\\\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\r\n            \\\r\n            for (float t = -30.0; t <= 30.0; t++) {\\\r\n                float percent = (t + offset - 0.5) / 30.0;\\\r\n                float weight = 1.0 - abs(percent);\\\r\n                vec4 sample = texture2D(texture, texCoord + delta * percent);\\\r\n                \\\r\n                /* switch to pre-multiplied alpha to correctly blur transparent images */\\\r\n                sample.rgb *= sample.a;\\\r\n                \\\r\n                color += sample * weight;\\\r\n                total += weight;\\\r\n            }\\\r\n            \\\r\n            gl_FragColor = color / total;\\\r\n            \\\r\n            /* switch back from pre-multiplied alpha */\\\r\n            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\\\r\n        }\\\r\n    ', 'triangleBlur');\r\n\r\n    simpleShader.call(this, gl.triangleBlur, {\r\n        delta: [radius / this.width, 0]\r\n    });\r\n    simpleShader.call(this, gl.triangleBlur, {\r\n        delta: [0, radius / this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\blur\\zoomblur.script\r\n/**\r\n * @filter         Zoom Blur\r\n * @description    Blurs the image away from a certain point, which looks like radial motion blur.\r\n * @param centerX  The x coordinate of the blur origin.\r\n * @param centerY  The y coordinate of the blur origin.\r\n * @param strength The strength of the blur. Values in the range 0 to 1 are usually sufficient,\r\n *                 where 0 doesn't change the image and 1 creates a highly blurred image.\r\n */\r\nfunction zoomBlur(centerX, centerY, strength) {\r\n    gl.zoomBlur = gl.zoomBlur || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform vec2 center;\\\r\n        uniform float strength;\\\r\n        uniform vec2 texSize;\\\r\n        varying vec2 texCoord;\\\r\n        ' + randomShaderFunc + '\\\r\n        void main() {\\\r\n            vec4 color = vec4(0.0);\\\r\n            float total = 0.0;\\\r\n            vec2 toCenter = center - texCoord * texSize;\\\r\n            \\\r\n            /* randomize the lookup values to hide the fixed number of samples */\\\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\r\n            \\\r\n            for (float t = 0.0; t <= 40.0; t++) {\\\r\n                float percent = (t + offset) / 40.0;\\\r\n                float weight = 4.0 * (percent - percent * percent);\\\r\n                vec4 sample = texture2D(texture, texCoord + toCenter * percent * strength / texSize);\\\r\n                \\\r\n                /* switch to pre-multiplied alpha to correctly blur transparent images */\\\r\n                sample.rgb *= sample.a;\\\r\n                \\\r\n                color += sample * weight;\\\r\n                total += weight;\\\r\n            }\\\r\n            \\\r\n            gl_FragColor = color / total;\\\r\n            \\\r\n            /* switch back from pre-multiplied alpha */\\\r\n            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\\\r\n        }\\\r\n    ', 'zoomBlur');\r\n\r\n    simpleShader.call(this, gl.zoomBlur, {\r\n        center: [centerX, centerY],\r\n        strength: strength,\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\fun\\colorhalftone.script\r\n/**\r\n * @filter        Color Halftone\r\n * @description   Simulates a CMYK halftone rendering of the image by multiplying pixel values\r\n *                with a four rotated 2D sine wave patterns, one each for cyan, magenta, yellow,\r\n *                and black.\r\n * @param centerX The x coordinate of the pattern origin.\r\n * @param centerY The y coordinate of the pattern origin.\r\n * @param angle   The rotation of the pattern in radians.\r\n * @param size    The diameter of a dot in pixels.\r\n */\r\nfunction colorHalftone(centerX, centerY, angle, size) {\r\n    gl.colorHalftone = gl.colorHalftone || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform vec2 center;\\\r\n        uniform float angle;\\\r\n        uniform float scale;\\\r\n        uniform vec2 texSize;\\\r\n        varying vec2 texCoord;\\\r\n        \\\r\n        float pattern(float angle) {\\\r\n            float s = sin(angle), c = cos(angle);\\\r\n            vec2 tex = texCoord * texSize - center;\\\r\n            vec2 point = vec2(\\\r\n                c * tex.x - s * tex.y,\\\r\n                s * tex.x + c * tex.y\\\r\n            ) * scale;\\\r\n            return (sin(point.x) * sin(point.y)) * 4.0;\\\r\n        }\\\r\n        \\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            vec3 cmy = 1.0 - color.rgb;\\\r\n            float k = min(cmy.x, min(cmy.y, cmy.z));\\\r\n            cmy = (cmy - k) / (1.0 - k);\\\r\n            cmy = clamp(cmy * 10.0 - 3.0 + vec3(pattern(angle + 0.26179), pattern(angle + 1.30899), pattern(angle)), 0.0, 1.0);\\\r\n            k = clamp(k * 10.0 - 5.0 + pattern(angle + 0.78539), 0.0, 1.0);\\\r\n            gl_FragColor = vec4(1.0 - cmy - k, color.a);\\\r\n        }\\\r\n    ', 'colorHalftone');\r\n\r\n    simpleShader.call(this, gl.colorHalftone, {\r\n        center: [centerX, centerY],\r\n        angle: angle,\r\n        scale: Math.PI / size,\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\fun\\dotscreen.script\r\n/**\r\n * @filter        Dot Screen\r\n * @description   Simulates a black and white halftone rendering of the image by multiplying\r\n *                pixel values with a rotated 2D sine wave pattern.\r\n * @param centerX The x coordinate of the pattern origin.\r\n * @param centerY The y coordinate of the pattern origin.\r\n * @param angle   The rotation of the pattern in radians.\r\n * @param size    The diameter of a dot in pixels.\r\n */\r\nfunction dotScreen(centerX, centerY, angle, size) {\r\n    gl.dotScreen = gl.dotScreen || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform vec2 center;\\\r\n        uniform float angle;\\\r\n        uniform float scale;\\\r\n        uniform vec2 texSize;\\\r\n        varying vec2 texCoord;\\\r\n        \\\r\n        float pattern() {\\\r\n            float s = sin(angle), c = cos(angle);\\\r\n            vec2 tex = texCoord * texSize - center;\\\r\n            vec2 point = vec2(\\\r\n                c * tex.x - s * tex.y,\\\r\n                s * tex.x + c * tex.y\\\r\n            ) * scale;\\\r\n            return (sin(point.x) * sin(point.y)) * 4.0;\\\r\n        }\\\r\n        \\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            float average = (color.r + color.g + color.b) / 3.0;\\\r\n            gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\\\r\n        }\\\r\n    ', 'dotScreen');\r\n\r\n    simpleShader.call(this, gl.dotScreen, {\r\n        center: [centerX, centerY],\r\n        angle: angle,\r\n        scale: Math.PI / size,\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\fun\\edgework.script\r\n/**\r\n * @filter       Edge Work\r\n * @description  Picks out different frequencies in the image by subtracting two\r\n *               copies of the image blurred with different radii.\r\n * @param radius The radius of the effect in pixels.\r\n */\r\nfunction edgeWork(radius) {\r\n    gl.edgeWork1 = gl.edgeWork1 || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform vec2 delta;\\\r\n        varying vec2 texCoord;\\\r\n        ' + randomShaderFunc + '\\\r\n        void main() {\\\r\n            vec2 color = vec2(0.0);\\\r\n            vec2 total = vec2(0.0);\\\r\n            \\\r\n            /* randomize the lookup values to hide the fixed number of samples */\\\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\r\n            \\\r\n            for (float t = -30.0; t <= 30.0; t++) {\\\r\n                float percent = (t + offset - 0.5) / 30.0;\\\r\n                float weight = 1.0 - abs(percent);\\\r\n                vec3 sample = texture2D(texture, texCoord + delta * percent).rgb;\\\r\n                float average = (sample.r + sample.g + sample.b) / 3.0;\\\r\n                color.x += average * weight;\\\r\n                total.x += weight;\\\r\n                if (abs(t) < 15.0) {\\\r\n                    weight = weight * 2.0 - 1.0;\\\r\n                    color.y += average * weight;\\\r\n                    total.y += weight;\\\r\n                }\\\r\n            }\\\r\n            gl_FragColor = vec4(color / total, 0.0, 1.0);\\\r\n        }\\\r\n    ', 'edgeWork1');\r\n    gl.edgeWork2 = gl.edgeWork2 || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform vec2 delta;\\\r\n        varying vec2 texCoord;\\\r\n        ' + randomShaderFunc + '\\\r\n        void main() {\\\r\n            vec2 color = vec2(0.0);\\\r\n            vec2 total = vec2(0.0);\\\r\n            \\\r\n            /* randomize the lookup values to hide the fixed number of samples */\\\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\r\n            \\\r\n            for (float t = -30.0; t <= 30.0; t++) {\\\r\n                float percent = (t + offset - 0.5) / 30.0;\\\r\n                float weight = 1.0 - abs(percent);\\\r\n                vec2 sample = texture2D(texture, texCoord + delta * percent).xy;\\\r\n                color.x += sample.x * weight;\\\r\n                total.x += weight;\\\r\n                if (abs(t) < 15.0) {\\\r\n                    weight = weight * 2.0 - 1.0;\\\r\n                    color.y += sample.y * weight;\\\r\n                    total.y += weight;\\\r\n                }\\\r\n            }\\\r\n            float c = clamp(10000.0 * (color.y / total.y - color.x / total.x) + 0.5, 0.0, 1.0);\\\r\n            gl_FragColor = vec4(c, c, c, 1.0);\\\r\n        }\\\r\n    ', 'edgeWork2');\r\n\r\n    simpleShader.call(this, gl.edgeWork1, {\r\n        delta: [radius / this.width, 0]\r\n    });\r\n    simpleShader.call(this, gl.edgeWork2, {\r\n        delta: [0, radius / this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\fun\\hexagonalpixelate.script\r\n/**\r\n * @filter        Hexagonal Pixelate\r\n * @description   Renders the image using a pattern of hexagonal tiles. Tile colors\r\n *                are nearest-neighbor sampled from the centers of the tiles.\r\n * @param centerX The x coordinate of the pattern center.\r\n * @param centerY The y coordinate of the pattern center.\r\n * @param scale   The width of an individual tile, in pixels.\r\n */\r\nfunction hexagonalPixelate(centerX, centerY, scale) {\r\n    gl.hexagonalPixelate = gl.hexagonalPixelate || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform vec2 center;\\\r\n        uniform float scale;\\\r\n        uniform vec2 texSize;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec2 tex = (texCoord * texSize - center) / scale;\\\r\n            tex.y /= 0.866025404;\\\r\n            tex.x -= tex.y * 0.5;\\\r\n            \\\r\n            vec2 a;\\\r\n            if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) a = vec2(floor(tex.x), floor(tex.y));\\\r\n            else a = vec2(ceil(tex.x), ceil(tex.y));\\\r\n            vec2 b = vec2(ceil(tex.x), floor(tex.y));\\\r\n            vec2 c = vec2(floor(tex.x), ceil(tex.y));\\\r\n            \\\r\n            vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\\\r\n            vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\\\r\n            vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\\\r\n            vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\\\r\n            \\\r\n            float alen = length(TEX - A);\\\r\n            float blen = length(TEX - B);\\\r\n            float clen = length(TEX - C);\\\r\n            \\\r\n            vec2 choice;\\\r\n            if (alen < blen) {\\\r\n                if (alen < clen) choice = a;\\\r\n                else choice = c;\\\r\n            } else {\\\r\n                if (blen < clen) choice = b;\\\r\n                else choice = c;\\\r\n            }\\\r\n            \\\r\n            choice.x += choice.y * 0.5;\\\r\n            choice.y *= 0.866025404;\\\r\n            choice *= scale / texSize;\\\r\n            gl_FragColor = texture2D(texture, choice + center / texSize);\\\r\n        }\\\r\n    ', 'hexagonalPixelate');\r\n\r\n    simpleShader.call(this, gl.hexagonalPixelate, {\r\n        center: [centerX, centerY],\r\n        scale: scale,\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\fun\\ink.script\r\n/**\r\n * @filter         Ink\r\n * @description    Simulates outlining the image in ink by darkening edges stronger than a\r\n *                 certain threshold. The edge detection value is the difference of two\r\n *                 copies of the image, each blurred using a blur of a different radius.\r\n * @param strength The multiplicative scale of the ink edges. Values in the range 0 to 1\r\n *                 are usually sufficient, where 0 doesn't change the image and 1 adds lots\r\n *                 of black edges. Negative strength values will create white ink edges\r\n *                 instead of black ones.\r\n */\r\nfunction ink(strength) {\r\n    gl.ink = gl.ink || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float strength;\\\r\n        uniform vec2 texSize;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec2 dx = vec2(1.0 / texSize.x, 0.0);\\\r\n            vec2 dy = vec2(0.0, 1.0 / texSize.y);\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            float bigTotal = 0.0;\\\r\n            float smallTotal = 0.0;\\\r\n            vec3 bigAverage = vec3(0.0);\\\r\n            vec3 smallAverage = vec3(0.0);\\\r\n            for (float x = -2.0; x <= 2.0; x += 1.0) {\\\r\n                for (float y = -2.0; y <= 2.0; y += 1.0) {\\\r\n                    vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\\\r\n                    bigAverage += sample;\\\r\n                    bigTotal += 1.0;\\\r\n                    if (abs(x) + abs(y) < 2.0) {\\\r\n                        smallAverage += sample;\\\r\n                        smallTotal += 1.0;\\\r\n                    }\\\r\n                }\\\r\n            }\\\r\n            vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\\\r\n            gl_FragColor = vec4(color.rgb - dot(edge, edge) * strength * 100000.0, color.a);\\\r\n        }\\\r\n    ', 'ink');\r\n\r\n    simpleShader.call(this, gl.ink, {\r\n        strength: strength * strength * strength * strength * strength,\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\warp\\bulgepinch.script\r\n/**\r\n * @filter         Bulge / Pinch\r\n * @description    Bulges or pinches the image in a circle.\r\n * @param centerX  The x coordinate of the center of the circle of effect.\r\n * @param centerY  The y coordinate of the center of the circle of effect.\r\n * @param radius   The radius of the circle of effect.\r\n * @param strength -1 to 1 (-1 is strong pinch, 0 is no effect, 1 is strong bulge)\r\n */\r\nfunction bulgePinch(centerX, centerY, radius, strength) {\r\n    gl.bulgePinch = gl.bulgePinch || warpShader('\\\r\n        uniform float radius;\\\r\n        uniform float strength;\\\r\n        uniform vec2 center;\\\r\n    ', '\\\r\n        coord -= center;\\\r\n        float distance = length(coord);\\\r\n        if (distance < radius) {\\\r\n            float percent = distance / radius;\\\r\n            if (strength > 0.0) {\\\r\n                coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\\\r\n            } else {\\\r\n                coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\\\r\n            }\\\r\n        }\\\r\n        coord += center;\\\r\n    ');\r\n\r\n    simpleShader.call(this, gl.bulgePinch, {\r\n        radius: radius,\r\n        strength: clamp(-1, strength, 1),\r\n        center: [centerX, centerY],\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\warp\\matrixwarp.script\r\n/**\r\n * @filter                Matrix Warp\r\n * @description           Transforms an image by a 2x2 or 3x3 matrix. The coordinates used in\r\n *                        the transformation are (x, y) for a 2x2 matrix or (x, y, 1) for a\r\n *                        3x3 matrix, where x and y are in units of pixels.\r\n * @param matrix          A 2x2 or 3x3 matrix represented as either a list or a list of lists.\r\n *                        For example, the 3x3 matrix [[2,0,0],[0,3,0],[0,0,1]] can also be\r\n *                        represented as [2,0,0,0,3,0,0,0,1] or just [2,0,0,3].\r\n * @param inverse         A boolean value that, when true, applies the inverse transformation\r\n *                        instead. (optional, defaults to false)\r\n * @param useTextureSpace A boolean value that, when true, uses texture-space coordinates\r\n *                        instead of screen-space coordinates. Texture-space coordinates range\r\n *                        from -1 to 1 instead of 0 to width - 1 or height - 1, and are easier\r\n *                        to use for simple operations like flipping and rotating.\r\n */\r\nfunction matrixWarp(matrix, inverse, useTextureSpace) {\r\n    gl.matrixWarp = gl.matrixWarp || warpShader('\\\r\n        uniform mat3 matrix;\\\r\n        uniform bool useTextureSpace;\\\r\n    ', '\\\r\n        if (useTextureSpace) coord = coord / texSize * 2.0 - 1.0;\\\r\n        vec3 warp = matrix * vec3(coord, 1.0);\\\r\n        coord = warp.xy / warp.z;\\\r\n        if (useTextureSpace) coord = (coord * 0.5 + 0.5) * texSize;\\\r\n    ');\r\n\r\n    // Flatten all members of matrix into one big list\r\n    matrix = Array.prototype.concat.apply([], matrix);\r\n\r\n    // Extract a 3x3 matrix out of the arguments\r\n    if (matrix.length == 4) {\r\n        matrix = [\r\n            matrix[0], matrix[1], 0,\r\n            matrix[2], matrix[3], 0,\r\n            0, 0, 1\r\n        ];\r\n    } else if (matrix.length != 9) {\r\n        throw 'can only warp with 2x2 or 3x3 matrix';\r\n    }\r\n\r\n    simpleShader.call(this, gl.matrixWarp, {\r\n        matrix: inverse ? getInverse(matrix) : matrix,\r\n        texSize: [this.width, this.height],\r\n        useTextureSpace: useTextureSpace | 0\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\warp\\perspective.script\r\n/**\r\n * @filter       Perspective\r\n * @description  Warps one quadrangle to another with a perspective transform. This can be used to\r\n *               make a 2D image look 3D or to recover a 2D image captured in a 3D environment.\r\n * @param before The x and y coordinates of four points before the transform in a flat list. This\r\n *               would look like [ax, ay, bx, by, cx, cy, dx, dy] for four points (ax, ay), (bx, by),\r\n *               (cx, cy), and (dx, dy).\r\n * @param after  The x and y coordinates of four points after the transform in a flat list, just\r\n *               like the other argument.\r\n */\r\nfunction perspective(before, after) {\r\n    let a = getSquareToQuad.apply(null, after);\r\n    let b = getSquareToQuad.apply(null, before);\r\n    let c = multiply(getInverse(a), b);\r\n    return this.matrixWarp(c);\r\n}\r\n\r\n// src/filters\\warp\\swirl.script\r\n/**\r\n * @filter        Swirl\r\n * @description   Warps a circular region of the image in a swirl.\r\n * @param centerX The x coordinate of the center of the circular region.\r\n * @param centerY The y coordinate of the center of the circular region.\r\n * @param radius  The radius of the circular region.\r\n * @param angle   The angle in radians that the pixels in the center of\r\n *                the circular region will be rotated by.\r\n */\r\nfunction swirl(centerX, centerY, radius, angle) {\r\n    gl.swirl = gl.swirl || warpShader('\\\r\n        uniform float radius;\\\r\n        uniform float angle;\\\r\n        uniform vec2 center;\\\r\n    ', '\\\r\n        coord -= center;\\\r\n        float distance = length(coord);\\\r\n        if (distance < radius) {\\\r\n            float percent = (radius - distance) / radius;\\\r\n            float theta = percent * percent * angle;\\\r\n            float s = sin(theta);\\\r\n            float c = cos(theta);\\\r\n            coord = vec2(\\\r\n                coord.x * c - coord.y * s,\\\r\n                coord.x * s + coord.y * c\\\r\n            );\\\r\n        }\\\r\n        coord += center;\\\r\n    ');\r\n\r\n    simpleShader.call(this, gl.swirl, {\r\n        radius: radius,\r\n        center: [centerX, centerY],\r\n        angle: angle,\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n/**\r\n * @filter        Invert\r\n * @description   Inverts color of each pixel\r\n */\r\nfunction invert() {\r\n    gl.invert = gl.invert || new Shader(null, '\\\r\n    uniform sampler2D texture;\\\r\n    uniform vec2 texSize;\\\r\n    varying vec2 texCoord;\\\r\n    \\\r\n    void main() {\\\r\n        vec4 color = texture2D(texture, texCoord);\\\r\n        gl_FragColor = vec4(1.0 - color.r, 1.0 - color.g, 1.0 - color.b, color.a);\\\r\n    }\\\r\n', 'invert');\r\n\r\n    simpleShader.call(this, gl.invert, {\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n/**\r\n * @filter        To Alpha\r\n * @description   Generates alpha channel from luminance (r+g+b)\r\n * @param isInverted    boolean - invert luminance\r\n * @param replaceRGBA    rgba - color to replace rgb with. if a = 0 -> keep orig color\r\n */\r\nfunction toAlpha(isInverted, replaceRGBA) {\r\n    gl.toAlpha = gl.toAlpha || new Shader(null, '\\\r\n    uniform bool isInverted;\\\r\n    uniform vec4 replace;\\\r\n    uniform sampler2D texture;\\\r\n    uniform vec2 texSize;\\\r\n    varying vec2 texCoord;\\\r\n    \\\r\n    void main() {\\\r\n        vec4 color = texture2D(texture, texCoord);\\\r\n        float alpha = (color.r + color.g + color.b) / 3.0;\\\r\n        if (isInverted) alpha = 1.0 - alpha;\\\r\n        alpha = min(color.a, alpha);\\\r\n        if (replace.a > 0.0) color = replace;\\\r\n        gl_FragColor = vec4(color.r, color.g, color.b, alpha);\\\r\n    }\\\r\n', 'toAlpha');\r\n\r\n    simpleShader.call(this, gl.toAlpha, {\r\n        isInverted: isInverted ? 1 : 0,\r\n        replace: replaceRGBA ? [replaceRGBA.r / 255, replaceRGBA.g / 255, replaceRGBA.b / 255, replaceRGBA.a] : [0,0,0,0],\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n\r\nreturn exports;\r\n})();\r\n","import {BB} from '../../bb/bb';\r\nimport {input} from '../ui/base-components/input';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {ColorOptions} from '../ui/base-components/color-options';\r\nimport {Cropper} from '../ui/components/cropper';\r\nimport {IFilterApply, IFilterGetDialogParam} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\n\r\nexport const cropExtend = {\r\n\r\n    getDialog(params: IFilterGetDialogParam) {\r\n        const canvas = params.canvas;\r\n        if (!canvas)\r\n            return false;\r\n        const tempCanvas = BB.canvas();\r\n        {\r\n            let fit = BB.fitInto(canvas.getWidth(), canvas.getHeight(), 560, 400, 1);\r\n            let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n            let previewFactor = w / canvas.getWidth();\r\n            tempCanvas.width = w;\r\n            tempCanvas.height = h;\r\n            tempCanvas.style.display = 'block';\r\n            tempCanvas.getContext(\"2d\").drawImage(canvas.getCompleteCanvas(previewFactor), 0, 0, w, h);\r\n        }\r\n\r\n        const div = document.createElement(\"div\");\r\n        const result: any = {\r\n            element: div\r\n        };\r\n        div.innerHTML = LANG('filter-crop-description') + \"<br/><br/>\";\r\n        let left = 0, right = 0, top = 0, bottom = 0;\r\n        let leftChanged = false, rightChanged = false, topChanged = false, bottomChanged = false;\r\n        const maxWidth = params.maxWidth, maxHeight = params.maxHeight;\r\n        let scale;\r\n\r\n\r\n\r\n        // --- input elements ---\r\n\r\n        const lrWrapper = BB.el({\r\n            css: {lineHeight: '30px', height: '35px'}\r\n        });\r\n        const tbWrapper = BB.el({\r\n            css: {lineHeight: '30px', height: '35px'}\r\n        });\r\n        div.appendChild(lrWrapper);\r\n        div.appendChild(tbWrapper);\r\n\r\n        const leftInput = input({\r\n            init: 0,\r\n            type: 'number',\r\n            min: -canvas.getWidth(),\r\n            max: maxWidth,\r\n            css: {width: '75px', marginRight: '20px'},\r\n            callback: function(v) {\r\n                leftChanged = true;\r\n                updateInput();\r\n            }\r\n        });\r\n        const rightInput = input({\r\n            init: 0,\r\n            type: 'number',\r\n            min: -canvas.getWidth(),\r\n            max: maxWidth,\r\n            css: {width: '75px'},\r\n            callback: function(v) {\r\n                rightChanged = true;\r\n                updateInput();\r\n            }\r\n        });\r\n        const topInput = input({\r\n            init: 0,\r\n            type: 'number',\r\n            min: -canvas.getHeight(),\r\n            max: maxHeight,\r\n            css: {width: '75px', marginRight: '20px'},\r\n            callback: function(v) {\r\n                topChanged = true;\r\n                updateInput();\r\n            }\r\n        });\r\n        const bottomInput = input({\r\n            init: 0,\r\n            type: 'number',\r\n            min: -canvas.getHeight(),\r\n            max: maxHeight,\r\n            css: {width: '75px'},\r\n            callback: function(v) {\r\n                bottomChanged = true;\r\n                updateInput();\r\n            }\r\n        });\r\n\r\n        const labelStyle = {\r\n            display: 'inline-block',\r\n            width: '60px'\r\n        };\r\n        lrWrapper.append(\r\n            BB.el({content: LANG('filter-crop-left') + ':', css: labelStyle}),\r\n            leftInput,\r\n            BB.el({content: LANG('filter-crop-right') + ':', css: labelStyle}),\r\n            rightInput\r\n        );\r\n        tbWrapper.append(\r\n            BB.el({content: LANG('filter-crop-top') + ':', css: labelStyle}),\r\n            topInput,\r\n            BB.el({content: LANG('filter-crop-bottom') + ':', css: labelStyle}),\r\n            bottomInput\r\n        );\r\n\r\n        function updateInput() {\r\n            left = parseInt(leftInput.value);\r\n            right = parseInt(rightInput.value);\r\n            top = parseInt(topInput.value);\r\n            bottom = parseInt(bottomInput.value);\r\n            let newWidth = canvas.getWidth() + left + right;\r\n            let newHeight = canvas.getHeight() + top + bottom;\r\n\r\n            if (newWidth <= 0) {\r\n                if (leftChanged) {\r\n                    left = -canvas.getWidth() - right + 1;\r\n                    leftInput.value = '' + left;\r\n                }\r\n                if (rightChanged) {\r\n                    right = -canvas.getWidth() - left + 1;\r\n                    rightInput.value = '' + right;\r\n                }\r\n                newWidth = 1;\r\n            }\r\n            if (newWidth > maxWidth) {\r\n                if (leftChanged) {\r\n                    left = -canvas.getWidth() - right + maxWidth;\r\n                    leftInput.value = '' + left;\r\n                }\r\n                if (rightChanged) {\r\n                    right = -canvas.getWidth() - left + maxWidth;\r\n                    rightInput.value = '' + right;\r\n                }\r\n                newWidth = maxWidth;\r\n            }\r\n            if (newHeight <= 0) {\r\n                if (topChanged) {\r\n                    top = -canvas.getHeight() - bottom + 1;\r\n                    topInput.value = '' + top;\r\n                }\r\n                if (bottomChanged) {\r\n                    bottom = -canvas.getHeight() - top + 1;\r\n                    bottomInput.value = '' + bottom;\r\n                }\r\n                newHeight = 1;\r\n            }\r\n            if (newHeight > maxHeight) {\r\n                if (topChanged) {\r\n                    top = -canvas.getHeight() - bottom + maxHeight;\r\n                    topInput.value = '' + top;\r\n                }\r\n                if (bottomChanged) {\r\n                    bottom = -canvas.getHeight() - top + maxHeight;\r\n                    bottomInput.value = '' + bottom;\r\n                }\r\n                newHeight = maxHeight;\r\n            }\r\n            cropper.setTransform({\r\n                x: -left,\r\n                y: -top,\r\n                width: newWidth,\r\n                height: newHeight\r\n            });\r\n\r\n\r\n            leftChanged = false;\r\n            rightChanged = false;\r\n            topChanged = false;\r\n            bottomChanged = false;\r\n        }\r\n\r\n        let useRuleOfThirds = true;\r\n        let ruleOThirdsCheckbox = new Checkbox({\r\n            init: true,\r\n            label: LANG('filter-crop-rule-thirds'),\r\n            allowTab: true,\r\n            callback: function(b) {\r\n                useRuleOfThirds = b;\r\n                cropper.showThirds(useRuleOfThirds);\r\n            }\r\n        });\r\n        div.appendChild(BB.el({\r\n            css: {\r\n                clear: 'both'\r\n            }\r\n        }));\r\n\r\n        let selectedRgbaObj = {r: 0, g: 0, b: 0, a: 0};\r\n        const colorOptionsArr = [\r\n            {r: 0, g: 0, b: 0, a: 0},\r\n            {r: 255, g: 255, b: 255, a: 1},\r\n            {r: 0, g: 0, b: 0, a: 1}\r\n        ];\r\n        colorOptionsArr.push({\r\n            r: params.currentColorRgb.r,\r\n            g: params.currentColorRgb.g,\r\n            b: params.currentColorRgb.b,\r\n            a: 1,\r\n        });\r\n        colorOptionsArr.push({\r\n            r: params.secondaryColorRgb.r,\r\n            g: params.secondaryColorRgb.g,\r\n            b: params.secondaryColorRgb.b,\r\n            a: 1,\r\n        });\r\n\r\n        const colorOptions = new ColorOptions({\r\n            label: LANG('filter-crop-fill'),\r\n            colorArr: colorOptionsArr,\r\n            onChange: function(rgbaObj) {\r\n                selectedRgbaObj = rgbaObj;\r\n                updateBg(rgbaObj);\r\n            }\r\n        });\r\n\r\n\r\n        const flexRow = BB.el({\r\n            css: {\r\n                display: 'flex',\r\n                justifyContent: 'space-between'\r\n            }\r\n        });\r\n        div.appendChild(flexRow);\r\n        flexRow.appendChild(ruleOThirdsCheckbox.getElement());\r\n        flexRow.appendChild(colorOptions.getElement());\r\n\r\n\r\n        // when input field changed, or dragging in preview finished\r\n        // adjusts the zoom\r\n        function update(transform) {\r\n            const fit = BB.fitInto(transform.width, transform.height, 260, 180, 1);\r\n            scale = fit.width / transform.width;\r\n\r\n            const offset = BB.centerWithin(340, 220, fit.width, fit.height);\r\n\r\n            tempCanvas.style.width = canvas.getWidth() * scale + \"px\";\r\n            tempCanvas.style.height = canvas.getHeight() * scale + \"px\";\r\n\r\n            offsetWrapper.style.left = (offset.x - transform.x * scale) + \"px\";\r\n            offsetWrapper.style.top = (offset.y - transform.y * scale) + \"px\";\r\n\r\n            left = parseInt('' + -transform.x);\r\n            top = parseInt('' + -transform.y);\r\n            right = parseInt('' + (transform.x + transform.width - canvas.getWidth()));\r\n            bottom = parseInt('' + (transform.y + transform.height - canvas.getHeight()));\r\n            leftInput.value = '' + left;\r\n            topInput.value = '' + top;\r\n            rightInput.value = '' + right;\r\n            bottomInput.value = '' + bottom;\r\n\r\n            BB.createCheckerDataUrl(parseInt('' + (50 * scale)), function (url) {\r\n                previewWrapper.style.background = \"url(\" + url + \")\";\r\n                if (selectedRgbaObj.a !== 0) {\r\n                    tempCanvas.style.background = \"url(\" + url + \")\";\r\n                }\r\n            });\r\n            previewWrapper.style.backgroundPosition = (offset.x) + \"px \" + (offset.y) + \"px\";\r\n\r\n            cropper.setScale(scale);\r\n        }\r\n\r\n        const previewWrapper = BB.el({\r\n            css: {\r\n                width: \"340px\",\r\n                marginTop: '10px',\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                position: \"relative\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                userSelect: 'none',\r\n                colorScheme: 'only light',\r\n                touchAction: 'none',\r\n            }\r\n        });\r\n        previewWrapper.oncontextmenu = function () {\r\n            return false;\r\n        };\r\n        const bgColorOverlay = BB.el({\r\n            css: {\r\n                position: 'absolute',\r\n                left: '0',\r\n                top: '0',\r\n                bottom: '0',\r\n                right: '0'\r\n            }\r\n        });\r\n        previewWrapper.appendChild(bgColorOverlay);\r\n\r\n        const offsetWrapper = document.createElement(\"div\");\r\n        offsetWrapper.style.position = \"absolute\";\r\n        offsetWrapper.style.left = \"0px\";\r\n        offsetWrapper.style.top = \"0px\";\r\n        previewWrapper.appendChild(offsetWrapper);\r\n\r\n\r\n        const canvasWrapper = BB.appendTextDiv(offsetWrapper, \"\");\r\n        canvasWrapper.appendChild(tempCanvas);\r\n        //tempCanvas.style.width = w + \"px\";\r\n        //tempCanvas.style.height = h + \"px\";\r\n        tempCanvas.style.boxShadow = \"0 0 3px 1px rgba(0,0,0,0.5)\";\r\n        tempCanvas.style.position = \"absolute\";\r\n        tempCanvas.style.left = \"0px\";\r\n        tempCanvas.style.top = \"0px\";\r\n\r\n        div.appendChild(previewWrapper);\r\n        const cropper = new Cropper({\r\n            x: 0,\r\n            y: 0,\r\n            width: canvas.getWidth(),\r\n            height: canvas.getHeight(),\r\n            scale: scale,\r\n            callback: update,\r\n            maxW: maxWidth,\r\n            maxH: maxHeight\r\n        });\r\n        update(cropper.getTransform());\r\n        offsetWrapper.appendChild(cropper.getElement());\r\n\r\n        function updateBg(rgbaObj) {\r\n\r\n            let borderColor;\r\n            if (rgbaObj.a === 0) {\r\n                borderColor = 'rgba(0,0,0,0.5)';\r\n                bgColorOverlay.style.background = '';\r\n                tempCanvas.style.background = '';\r\n            } else {\r\n                borderColor = (rgbaObj.r + rgbaObj.g + rgbaObj.b < 255 * 3 / 2) ? 'rgba(255,255,255,0.5)' : 'rgba(0,0,0,0.5)'\r\n                bgColorOverlay.style.background = BB.ColorConverter.toRgbStr(rgbaObj);\r\n\r\n                BB.createCheckerDataUrl(parseInt('' + (50 * scale)), function (url) {\r\n                    tempCanvas.style.background = \"url(\" + url + \")\";\r\n                });\r\n            }\r\n            tempCanvas.style.boxShadow = \"0 0 3px 1px \" + borderColor;\r\n        }\r\n\r\n        result.destroy = () => {\r\n            cropper.destroy();\r\n            ruleOThirdsCheckbox.destroy();\r\n        };\r\n        result.getInput = function () {\r\n            result.destroy();\r\n            return {\r\n                left: left,\r\n                right: right,\r\n                top: top,\r\n                bottom: bottom,\r\n                fillColor: selectedRgbaObj.a === 0 ? null : selectedRgbaObj\r\n            };\r\n        };\r\n        return result;\r\n    },\r\n\r\n    apply(params: IFilterApply) {\r\n        const canvas = params.canvas;\r\n        const history = params.history;\r\n        if (!canvas || !history || isNaN(params.input.left) || isNaN(params.input.right) || isNaN(params.input.top) || isNaN(params.input.bottom)) {\r\n            return false;\r\n        }\r\n        history.pause(true);\r\n        canvas.resizeCanvas(params.input);\r\n        history.pause(false);\r\n        history.push({\r\n            tool: [\"filter\", \"cropExtend\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: JSON.parse(JSON.stringify(params.input))\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {Options} from '../ui/base-components/options';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {getSharedFx} from './shared-gl-fx';\r\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\n\r\nexport const glCurves = {\r\n\r\n    getDialog(params: IFilterGetDialogParam) {\r\n\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\r\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (tempCanvas.width > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div,\r\n        };\r\n        let klCanvasPreview;\r\n\r\n        function finishInit() {\r\n\r\n            let previewFactor = w / context.canvas.width;\r\n            let brightness = 0, contrast = 0;\r\n\r\n            div.innerHTML = LANG('filter-curves-description') + \"<br/><br/>\";\r\n\r\n            let curves = {\r\n                r: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\r\n                g: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\r\n                b: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\r\n            };\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n\r\n            function update() {\r\n                try {\r\n                    glCanvas.draw(texture).curves(curves.r, curves.g, curves.b).update();\r\n                    if (klCanvasPreview) {\r\n                        klCanvasPreview.render();\r\n                    }\r\n                } catch(e) {\r\n                    (div as any).errorCallback(e);\r\n                }\r\n            }\r\n\r\n            let modeButtons;\r\n\r\n            function CurvesInput(p) {\r\n                let div = document.createElement(\"div\");\r\n                div.oncontextmenu = function () {\r\n                    return false;\r\n                };\r\n                div.style.position = \"relative\";\r\n                div.style.marginBottom = \"10px\";\r\n                let mode = \"All\";\r\n                let curves = p.curves;\r\n                modeButtons = new Options( {\r\n                    optionArr: [\r\n                        {\r\n                            id: 'All',\r\n                            label: LANG('filter-curves-all')\r\n                        },\r\n                        {\r\n                            id: 'Red',\r\n                            label: LANG('red')\r\n                        },\r\n                        {\r\n                            id: 'Green',\r\n                            label: LANG('green')\r\n                        },\r\n                        {\r\n                            id: 'Blue',\r\n                            label: LANG('blue')\r\n                        },\r\n                    ],\r\n                    initialId: 'All',\r\n                    onChange: function(id) {\r\n                        mode = id;\r\n                        if (mode === \"All\") {\r\n                            curves = {\r\n                                r: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\r\n                                g: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\r\n                                b: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\r\n                            };\r\n                        }\r\n                        let curve = curves.r;\r\n                        if (mode === \"Green\") {\r\n                            curve = curves.g;\r\n                        }\r\n                        if (mode === \"Blue\") {\r\n                            curve = curves.b;\r\n                        }\r\n                        (p0 as any).setPos(0, areah - curve[0][1] * areah);\r\n                        (p1 as any).setPos(curve[1][0] * areaw, areah - curve[1][1] * areah);\r\n                        (p2 as any).setPos(curve[2][0] * areaw, areah - curve[2][1] * areah);\r\n                        (p3 as any).setPos(areaw, areah - curve[3][1] * areah);\r\n\r\n                        update();\r\n                    }\r\n                });\r\n                div.appendChild(modeButtons.getElement());\r\n\r\n                let curveArea = document.createElement(\"div\");\r\n                BB.css(curveArea, {\r\n                    position: 'relative',\r\n                    marginTop: '10px',\r\n                    colorScheme: 'only light',\r\n                })\r\n                div.appendChild(curveArea);\r\n\r\n                let areaw = 300, areah = 100;\r\n                let canvas = BB.canvas(areaw, areah);\r\n                BB.css(canvas, {\r\n                    background: \"#c6c6c6\",\r\n                    boxShadow: \"0 0 0 1px rgba(0,0,0,0.3)\"\r\n                });\r\n                let ctx = canvas.getContext(\"2d\");\r\n                curveArea.appendChild(canvas);\r\n\r\n                let points = {\r\n                    r: [],\r\n                    g: [],\r\n                    b: []\r\n                };\r\n\r\n                function fit(v) {\r\n                    return Math.max(0, Math.min(1, v));\r\n                }\r\n\r\n                function createPoint(x, y, callback, lock?) {\r\n                    let gripSize = 14;\r\n                    let internalY = y, internalX = x;\r\n                    let point = document.createElement(\"div\");\r\n                    BB.css(point, {\r\n                        position: \"absolute\",\r\n                        left: (x - gripSize / 2) + \"px\",\r\n                        top: (y - gripSize / 2) + \"px\",\r\n                        width: gripSize + \"px\",\r\n                        height: gripSize + \"px\",\r\n                        background: \"#fff\",\r\n                        cursor: \"move\",\r\n                        borderRadius: gripSize + \"px\",\r\n                        boxShadow: \"inset 0 0 0 2px #000\",\r\n                        userSelect: 'none',\r\n                        touchAction: 'none',\r\n                    });\r\n\r\n                    function update() {\r\n                        BB.css(point, {\r\n                            left: (x - gripSize / 2) + \"px\",\r\n                            top: (y - gripSize / 2) + \"px\"\r\n                        });\r\n                    }\r\n\r\n                    (point as any).pointerListener = new BB.PointerListener({\r\n                        target: point,\r\n                        maxPointers: 1,\r\n                        onPointer: function(event) {\r\n                            event.eventPreventDefault();\r\n                            if (event.type === 'pointerdown') {\r\n                                internalX = x;\r\n                                internalY = y;\r\n                            }\r\n                            if (event.button === 'left' && event.type === 'pointermove') {\r\n                                if (!lock) {\r\n                                    internalX += event.dX;\r\n                                }\r\n                                x = Math.max(0, Math.min(areaw, internalX));\r\n                                internalY += event.dY;\r\n                                y = Math.max(0, Math.min(areah, internalY));\r\n                                update();\r\n                                callback({\r\n                                    x: x,\r\n                                    y: y\r\n                                });\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    curveArea.appendChild(point);\r\n\r\n                    (point as any).setPos = function (newX, newY) {\r\n                        x = newX;\r\n                        y = newY;\r\n                        internalY = y;\r\n                        internalX = x;\r\n                        BB.css(point, {\r\n                            left: (x - gripSize / 2) + \"px\",\r\n                            top: (y - gripSize / 2) + \"px\"\r\n                        });\r\n                    };\r\n\r\n                    return point;\r\n                }\r\n\r\n                function updateControl(i, x, y) {\r\n                    if (mode === \"All\") {\r\n                        curves.r[i] = [fit(x / areaw), fit(1 - y / areah)];\r\n                        curves.g[i] = [fit(x / areaw), fit(1 - y / areah)];\r\n                        curves.b[i] = [fit(x / areaw), fit(1 - y / areah)];\r\n                    }\r\n                    if (mode === \"Red\") {\r\n                        curves.r[i] = [fit(x / areaw), fit(1 - y / areah)];\r\n                    }\r\n                    if (mode === \"Green\") {\r\n                        curves.g[i] = [fit(x / areaw), fit(1 - y / areah)];\r\n                    }\r\n                    if (mode === \"Blue\") {\r\n                        curves.b[i] = [fit(x / areaw), fit(1 - y / areah)];\r\n                    }\r\n                }\r\n\r\n                let p0 = createPoint(0, areah, function (val) {\r\n                    updateControl(0, val.x, val.y);\r\n                    update();\r\n                }, true);\r\n                let p1 = createPoint(areaw / 3, areah / 3 * 2, function (val) {\r\n                    updateControl(1, val.x, val.y);\r\n                    update();\r\n                });\r\n                let p2 = createPoint(areaw / 3 * 2, areah / 3, function (val) {\r\n                    updateControl(2, val.x, val.y);\r\n                    update();\r\n                });\r\n                let p3 = createPoint(areaw, 0, function (val) {\r\n                    updateControl(3, val.x, val.y);\r\n                    update();\r\n                }, true);\r\n\r\n\r\n                function update() {\r\n                    canvas.width = canvas.width;\r\n                    ctx = canvas.getContext(\"2d\");\r\n\r\n                    let outCurves = {\r\n                        r: [],\r\n                        g: [],\r\n                        b: []\r\n                    };\r\n                    for (let i = 0; i < curves.r.length; i++) {\r\n                        outCurves.r.push(curves.r[i]);\r\n                        outCurves.g.push(curves.g[i]);\r\n                        outCurves.b.push(curves.b[i]);\r\n                    }\r\n\r\n                    function drawCurve(curve) {\r\n                        ctx.beginPath();\r\n                        let spline = new BB.SplineInterpolator(curve);\r\n                        for (let i = 0; i < 100; i++) {\r\n                            let y = spline.interpolate(i / 100);\r\n                            y = Math.max(0, Math.min(1, y));\r\n\r\n                            if (i === 0) {\r\n                                ctx.moveTo(i / 100 * areaw, areah - y * areah);\r\n                            } else {\r\n                                ctx.lineTo(i / 100 * areaw, areah - y * areah);\r\n                            }\r\n                        }\r\n                        ctx.stroke();\r\n                    }\r\n\r\n                    ctx.save();\r\n                    if (mode === \"All\") {\r\n                        ctx.strokeStyle = \"black\";\r\n                        drawCurve(outCurves.r);\r\n                    } else {\r\n                        ctx.globalAlpha = 0.5;\r\n                        ctx.strokeStyle = \"red\";\r\n                        drawCurve(outCurves.r);\r\n                        ctx.strokeStyle = \"green\";\r\n                        drawCurve(outCurves.g);\r\n                        ctx.strokeStyle = \"blue\";\r\n                        drawCurve(outCurves.b);\r\n                    }\r\n                    ctx.restore();\r\n                    p.callback(outCurves);\r\n                }\r\n\r\n                update();\r\n\r\n\r\n                this.getDiv = function () {\r\n                    return div;\r\n                };\r\n                this.destroy = function() {\r\n                    (p0 as any).pointerListener.destroy();\r\n                    (p1 as any).pointerListener.destroy();\r\n                    (p2 as any).pointerListener.destroy();\r\n                    (p3 as any).pointerListener.destroy();\r\n                };\r\n            }\r\n\r\n            let input = new CurvesInput({\r\n                curves: curves,\r\n                callback: function (val) {\r\n                    curves = val;\r\n                    update();\r\n                }\r\n            });\r\n\r\n\r\n            div.appendChild(input.getDiv());\r\n\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            BB.css(previewWrapper, {\r\n                width: \"340px\",\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr: IKlBasicLayer[] = [];\r\n            {\r\n                for (let i = 0; i < layers.length; i++) {\r\n                    previewLayerArr.push({\r\n                        image: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + w),\r\n                height: parseInt('' + h),\r\n                layers: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + w) + 'px',\r\n                    height: parseInt('' + h) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n\r\n            div.appendChild(previewWrapper);\r\n\r\n            result.destroy = () => {\r\n                input.destroy();\r\n                texture.destroy();\r\n                modeButtons.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    curves: curves\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1);\r\n\r\n        return result;\r\n    },\r\n\r\n    apply(params: IFilterApply) {\r\n        let context = params.context;\r\n        let curves = params.input.curves;\r\n        let history = params.history;\r\n        if (!context || curves === null || !history)\r\n            return false;\r\n        history.pause(true);\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).curves(curves.r, curves.g, curves.b).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.push({\r\n            tool: [\"filter\", \"glCurves\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n\r\n        return true;\r\n    }\r\n\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\n// @ts-ignore\r\nimport checkmarkImg from 'url:~/src/app/img/ui/checkmark.svg';\r\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer, IMixMode} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\n\r\nexport const flip = {\r\n\r\n    getDialog(params: IFilterGetDialogParam) {\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\r\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n        let isHorizontal = true;\r\n        let isVertical = false;\r\n        let doFlipCanvas = true;\r\n        div.innerHTML = LANG('filter-flip-description') + \"<br/><br/>\";\r\n\r\n\r\n        let horizontalCheckbox = new Checkbox({\r\n            init: isHorizontal,\r\n            label: LANG('filter-flip-horizontal') + ' ⟷',\r\n            allowTab: true,\r\n            callback: function(v) {\r\n                isHorizontal = v;\r\n                updatePreview();\r\n            },\r\n            css: {\r\n                marginBottom: '10px'\r\n            }\r\n        });\r\n        let verticalCheckbox = new Checkbox({\r\n            init: isVertical,\r\n            label: LANG('filter-flip-vertical') + ' ↕',\r\n            allowTab: true,\r\n            callback: function(v) {\r\n                isVertical = v;\r\n                updatePreview();\r\n            },\r\n            css: {\r\n                marginBottom: '10px'\r\n            }\r\n        });\r\n        div.appendChild(horizontalCheckbox.getElement());\r\n        div.appendChild(verticalCheckbox.getElement());\r\n\r\n\r\n\r\n\r\n\r\n        let fcOption = document.createElement(\"div\");\r\n        BB.setEventListener(fcOption, 'onpointerdown', function () {\r\n            return false;\r\n        });\r\n        fcOption.textContent = LANG('filter-flip-image');\r\n        fcOption.style.width = \"150px\";\r\n        fcOption.style.height = \"30px\";\r\n        fcOption.style.paddingTop = \"10px\";\r\n        fcOption.style.textAlign = \"center\";\r\n        fcOption.style.cssFloat = \"left\";\r\n        fcOption.style.paddingBottom = \"0px\";\r\n        fcOption.style.borderTopLeftRadius = \"10px\";\r\n        fcOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\r\n        fcOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\r\n        fcOption.style.backgroundSize = '8%';\r\n        fcOption.style.backgroundColor = \"#9e9e9e\";\r\n\r\n        let flOption = document.createElement(\"div\");\r\n        BB.setEventListener(flOption, 'onpointerdown', function () {\r\n            return false;\r\n        });\r\n        flOption.textContent = LANG('filter-flip-layer');\r\n        flOption.style.width = \"150px\";\r\n        flOption.style.height = \"30px\";\r\n        flOption.style.paddingTop = \"10px\";\r\n        flOption.style.textAlign = \"center\";\r\n        flOption.style.cssFloat = \"left\";\r\n        flOption.style.paddingBottom = \"0px\";\r\n        flOption.style.borderTopRightRadius = \"10px\";\r\n        flOption.style.cursor = \"pointer\";\r\n        flOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n        flOption.style.backgroundSize = '8%';\r\n\r\n        BB.setEventListener(fcOption, 'onpointerover', function () {\r\n            if (doFlipCanvas === false)\r\n                fcOption.style.backgroundColor = \"#ccc\";\r\n        });\r\n        BB.setEventListener(fcOption, 'onpointerout', function () {\r\n            if (doFlipCanvas === false)\r\n                fcOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n        });\r\n        BB.setEventListener(flOption, 'onpointerover', function () {\r\n            if (doFlipCanvas === true)\r\n                flOption.style.backgroundColor = \"#ccc\";\r\n        });\r\n        BB.setEventListener(flOption, 'onpointerout', function () {\r\n            if (doFlipCanvas === true)\r\n                flOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n        });\r\n\r\n        fcOption.onclick = function () {\r\n            doFlipCanvas = true;\r\n\r\n            flOption.style.background = \"\";\r\n            flOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n            flOption.style.boxShadow = \"\";\r\n            flOption.style.cursor = \"pointer\";\r\n\r\n            fcOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\r\n            fcOption.style.backgroundSize = '8%';\r\n            fcOption.style.backgroundColor = \"#9e9e9e\";\r\n            fcOption.style.cursor = \"default\";\r\n            fcOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\r\n\r\n            updatePreview();\r\n        };\r\n        flOption.onclick = function () {\r\n            doFlipCanvas = false;\r\n\r\n            fcOption.style.background = \"\";\r\n            fcOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n            fcOption.style.boxShadow = \"\";\r\n            fcOption.style.cursor = \"pointer\";\r\n\r\n            flOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\r\n            flOption.style.backgroundSize = '8%';\r\n            flOption.style.backgroundColor = \"#9e9e9e\";\r\n            flOption.style.cursor = \"default\";\r\n            flOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\r\n\r\n            updatePreview();\r\n        };\r\n\r\n        let optionWrapper = document.createElement(\"div\");\r\n        optionWrapper.appendChild(fcOption);\r\n        optionWrapper.appendChild(flOption);\r\n        div.appendChild(optionWrapper);\r\n\r\n\r\n        let previewWrapper = document.createElement(\"div\");\r\n        BB.css(previewWrapper, {\r\n            width: \"340px\",\r\n            marginLeft: \"-20px\",\r\n            height: \"220px\",\r\n            backgroundColor: \"#9e9e9e\",\r\n            marginTop: \"10px\",\r\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n            overflow: \"hidden\",\r\n            position: \"relative\",\r\n            userSelect: 'none',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            colorScheme: 'only light',\r\n        });\r\n\r\n        let previewLayer: IKlBasicLayer = {\r\n            image: BB.canvas(Math.round(w), Math.round(h)),\r\n            opacity: 1,\r\n            mixModeStr: 'source-over' as IMixMode,\r\n        };\r\n        let klCanvasPreview = new KlCanvasPreview({\r\n            width: Math.round(w),\r\n            height: Math.round(h),\r\n            layers: [previewLayer]\r\n        });\r\n\r\n        let previewInnerWrapper = BB.el({\r\n            css: {\r\n                position: 'relative',\r\n                boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                width: parseInt('' + w) + 'px',\r\n                height: parseInt('' + h) + 'px'\r\n            }\r\n        });\r\n        previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n        previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n        function updatePreview() {\r\n            let ctx = (previewLayer.image as HTMLCanvasElement).getContext('2d');\r\n            ctx.save();\r\n            ctx.clearRect(0, 0, previewLayer.image.width, previewLayer.image.height);\r\n\r\n            if (doFlipCanvas) {\r\n                if (isHorizontal) {\r\n                    ctx.translate(previewLayer.image.width, 0);\r\n                    ctx.scale(-1, 1);\r\n                }\r\n                if (isVertical) {\r\n                    ctx.translate(0, previewLayer.image.height);\r\n                    ctx.scale(1, -1);\r\n                }\r\n            }\r\n\r\n            for (let i = 0; i < layers.length; i++) {\r\n                ctx.save();\r\n                if (!doFlipCanvas && selectedLayerIndex === i) {\r\n                    if (isHorizontal) {\r\n                        ctx.translate(previewLayer.image.width, 0);\r\n                        ctx.scale(-1, 1);\r\n                    }\r\n                    if (isVertical) {\r\n                        ctx.translate(0, previewLayer.image.height);\r\n                        ctx.scale(1, -1);\r\n                    }\r\n                }\r\n                if (ctx.canvas.width > layers[i].context.canvas.width) {\r\n                    ctx.imageSmoothingEnabled = false;\r\n                }\r\n                ctx.globalAlpha = layers[i].opacity;\r\n                ctx.globalCompositeOperation = layers[i].mixModeStr;\r\n                ctx.drawImage(layers[i].context.canvas, 0, 0, previewLayer.image.width, previewLayer.image.height);\r\n                ctx.restore();\r\n            }\r\n            klCanvasPreview.render();\r\n            ctx.restore();\r\n        }\r\n        setTimeout(updatePreview, 0);\r\n\r\n\r\n        div.appendChild(previewWrapper);\r\n        result.destroy = () => {\r\n            horizontalCheckbox.destroy();\r\n            verticalCheckbox.destroy();\r\n        };\r\n        result.getInput = function () {\r\n            result.destroy();\r\n            return {\r\n                horizontal: isHorizontal,\r\n                vertical: isVertical,\r\n                flipCanvas: doFlipCanvas\r\n            };\r\n        };\r\n        return result;\r\n    },\r\n\r\n    apply(params: IFilterApply) {\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        let history = params.history;\r\n        let horizontal = params.input.horizontal;\r\n        let vertical = params.input.vertical;\r\n        let flipCanvas = params.input.flipCanvas;\r\n        if (!context || !canvas || !history) {\r\n            return false;\r\n        }\r\n\r\n        history.pause(true);\r\n        canvas.flip(horizontal, vertical, flipCanvas ? null : canvas.getLayerIndex(context.canvas));\r\n        history.pause(false);\r\n\r\n        history.push({\r\n            tool: [\"filter\", \"flip\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    },\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\n// @ts-ignore\r\nimport checkmarkImg from 'url:~/src/app/img/ui/checkmark.svg';\r\nimport {getSharedFx} from './shared-gl-fx';\r\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\n\r\nexport const glPerspective = {\r\n\r\n    getDialog(params: IFilterGetDialogParam) {\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let isSmall = window.innerWidth < 550;\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, isSmall ? 280 : 490, isSmall ? 200 : 240, 1);\r\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\r\n        let w = Math.min(displayW, context.canvas.width);\r\n        let h = Math.min(displayH, context.canvas.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (w > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n        let displayPreviewFactor = displayW / context.canvas.width;\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n        if (!isSmall) {\r\n            result.width = 500;\r\n        }\r\n\r\n        let pointerListenerArr = [];\r\n\r\n        function finishInit() {\r\n            div.innerHTML = LANG('filter-perspective-description') + \"<br/><br/>\";\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n            let ba, bb, bc, bd; //before\r\n            let aa, ab, ac, ad; //after\r\n            function update() {\r\n                try {\r\n                    glCanvas.draw(texture).perspective(\r\n                        [ba.x, ba.y, bb.x, bb.y, bc.x, bc.y, bd.x, bd.y].map((item, i) => {\r\n                            if (i % 2 === 0) {\r\n                                return item / displayW * w;\r\n                            } else {\r\n                                return item / displayH * h;\r\n                            }\r\n                        }),\r\n                        [aa.x, aa.y, ab.x, ab.y, ac.x, ac.y, ad.x, ad.y].map((item, i) => {\r\n                            if (i % 2 === 0) {\r\n                                return item / displayW * w;\r\n                            } else {\r\n                                return item / displayH * h;\r\n                            }\r\n                        })\r\n                    ).update();\r\n                    klCanvasPreview.render();\r\n                } catch(e) {\r\n                    (div as any).errorCallback(e);\r\n                }\r\n            }\r\n\r\n            function nob(x, y, callback?) {\r\n                let nobSize = 14;\r\n                let div = document.createElement(\"div\");\r\n                (div as any).x = x;\r\n                (div as any).y = y;\r\n                BB.css(div, {\r\n                    width: nobSize + \"px\",\r\n                    height: nobSize + \"px\",\r\n                    backgroundColor: \"#fff\",\r\n                    boxShadow: \"inset 0 0 0 2px #000\",\r\n                    borderRadius: nobSize + \"px\",\r\n                    position: \"absolute\",\r\n                    cursor: \"move\",\r\n                    left: ((div as any).x - nobSize / 2) + \"px\",\r\n                    top: ((div as any).y - nobSize / 2) + \"px\",\r\n                    userSelect: 'none',\r\n                    touchAction: 'none',\r\n                });\r\n\r\n                let pointerListener = new BB.PointerListener({\r\n                    target: div,\r\n                    maxPointers: 1,\r\n                    onPointer: function(event) {\r\n                        event.eventPreventDefault();\r\n                        if (event.button === 'left' && event.type === 'pointermove') {\r\n                            (div as any).x += event.dX;\r\n                            (div as any).y += event.dY;\r\n                            div.style.left = ((div as any).x - nobSize / 2) + \"px\";\r\n                            div.style.top = ((div as any).y - nobSize / 2) + \"px\";\r\n                            if (callback) {\r\n                                callback();\r\n                            }\r\n                            update();\r\n                        }\r\n                    }\r\n                });\r\n                (div as any).copy = function (p) {\r\n                    (div as any).x = p.x;\r\n                    (div as any).y = p.y;\r\n                    div.style.left = ((div as any).x - nobSize / 2) + \"px\";\r\n                    div.style.top = ((div as any).y - nobSize / 2) + \"px\";\r\n                };\r\n                pointerListenerArr.push(pointerListener);\r\n                return div;\r\n            }\r\n\r\n            function updateAfter() {\r\n                aa.copy(ba);\r\n                ab.copy(bb);\r\n                ac.copy(bc);\r\n                ad.copy(bd);\r\n            }\r\n\r\n            ba = nob(0, 0, updateAfter);\r\n            bb = nob(displayW, 0, updateAfter);\r\n            bc = nob(displayW, displayH, updateAfter);\r\n            bd = nob(0, displayH, updateAfter);\r\n            aa = nob(0, 0);\r\n            ab = nob(displayW, 0);\r\n            ac = nob(displayW, displayH);\r\n            ad = nob(0, displayH);\r\n\r\n            let before = false;\r\n            let beforeOption = document.createElement(\"div\");\r\n            BB.setEventListener(beforeOption, 'onpointerdown', function () {\r\n                return false;\r\n            });\r\n            beforeOption.textContent = LANG('filter-perspective-before');\r\n            beforeOption.style.width = \"150px\";\r\n            beforeOption.style.height = \"30px\";\r\n            beforeOption.style.marginLeft = isSmall ? '0' : \"100px\";\r\n            beforeOption.style.paddingTop = \"10px\";\r\n            beforeOption.style.textAlign = \"center\";\r\n            beforeOption.style.cssFloat = \"left\";\r\n            beforeOption.style.paddingBottom = \"0px\";\r\n            beforeOption.style.borderTopLeftRadius = \"10px\";\r\n            beforeOption.style.cursor = \"pointer\";\r\n            beforeOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n            beforeOption.style.backgroundSize = '8%';\r\n\r\n            let afterOption = document.createElement(\"div\");\r\n            BB.setEventListener(afterOption, 'onpointerdown', function () {\r\n                return false;\r\n            });\r\n            afterOption.textContent = LANG('filter-perspective-after');\r\n            afterOption.style.width = \"150px\";\r\n            afterOption.style.height = \"30px\";\r\n            afterOption.style.paddingTop = \"10px\";\r\n            afterOption.style.textAlign = \"center\";\r\n            afterOption.style.cssFloat = \"left\";\r\n            afterOption.style.paddingBottom = \"0px\";\r\n            afterOption.style.borderTopRightRadius = \"10px\";\r\n            afterOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\r\n            afterOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\r\n            afterOption.style.backgroundSize = '8%';\r\n            afterOption.style.backgroundColor = \"#9e9e9e\";\r\n\r\n\r\n            BB.setEventListener(beforeOption, 'onpointerover', function () {\r\n                if (before === false)\r\n                    beforeOption.style.backgroundColor = \"#ccc\";\r\n            });\r\n            BB.setEventListener(beforeOption, 'onpointerout', function () {\r\n                if (before === false)\r\n                    beforeOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n            });\r\n            BB.setEventListener(afterOption, 'onpointerover', function () {\r\n                if (before === true)\r\n                    afterOption.style.backgroundColor = \"#ccc\";\r\n            });\r\n            BB.setEventListener(afterOption, 'onpointerout', function () {\r\n                if (before === true)\r\n                    afterOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n            });\r\n\r\n            beforeOption.onclick = function () {\r\n\r\n                beforeOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\r\n                beforeOption.style.backgroundSize = '8%';\r\n                beforeOption.style.backgroundColor = \"#9e9e9e\";\r\n                beforeOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\r\n                beforeOption.style.cursor = \"default\";\r\n\r\n                afterOption.style.background = \"\";\r\n                afterOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n                afterOption.style.boxShadow = \"\";\r\n                afterOption.style.cursor = \"pointer\";\r\n\r\n                aa.style.display = \"none\";\r\n                ab.style.display = \"none\";\r\n                ac.style.display = \"none\";\r\n                ad.style.display = \"none\";\r\n\r\n                ba.style.display = \"block\";\r\n                bb.style.display = \"block\";\r\n                bc.style.display = \"block\";\r\n                bd.style.display = \"block\";\r\n                ba.copy(aa);\r\n                bb.copy(ab);\r\n                bc.copy(ac);\r\n                bd.copy(ad);\r\n                before = true;\r\n                update();\r\n            };\r\n            afterOption.onclick = function () {\r\n                before = false;\r\n\r\n                afterOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\r\n                afterOption.style.backgroundSize = '8%';\r\n                afterOption.style.backgroundColor = \"#9e9e9e\";\r\n                afterOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\r\n                afterOption.style.cursor = \"default\";\r\n\r\n                beforeOption.style.background = \"\";\r\n                beforeOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n                beforeOption.style.boxShadow = \"\";\r\n                beforeOption.style.cursor = \"pointer\";\r\n\r\n                ba.style.display = \"none\";\r\n                bb.style.display = \"none\";\r\n                bc.style.display = \"none\";\r\n                bd.style.display = \"none\";\r\n\r\n                aa.style.display = \"block\";\r\n                ab.style.display = \"block\";\r\n                ac.style.display = \"block\";\r\n                ad.style.display = \"block\";\r\n                aa.copy(ba);\r\n                ab.copy(bb);\r\n                ac.copy(bc);\r\n                ad.copy(bd);\r\n            };\r\n\r\n            let optionWrapper = document.createElement(\"div\");\r\n            optionWrapper.appendChild(beforeOption);\r\n            optionWrapper.appendChild(afterOption);\r\n            div.appendChild(optionWrapper);\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            previewWrapper.oncontextmenu = function () {\r\n                return false;\r\n            };\r\n            BB.css(previewWrapper, {\r\n                width: isSmall ? '340px' : '540px',\r\n                marginLeft: \"-20px\",\r\n                height: isSmall ? '260px' : '300px',\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr: IKlBasicLayer[] = [];\r\n            {\r\n                for (let i = 0; i < layers.length; i++) {\r\n                    let canvas = i === selectedLayerIndex ? glCanvas : layers[i].context.canvas;\r\n                    previewLayerArr.push({\r\n                        image: canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            let klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + displayW),\r\n                height: parseInt('' + displayH),\r\n                layers: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + displayW) + 'px',\r\n                    height: parseInt('' + displayH) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n            previewInnerWrapper.appendChild(aa);\r\n            previewInnerWrapper.appendChild(ab);\r\n            previewInnerWrapper.appendChild(ac);\r\n            previewInnerWrapper.appendChild(ad);\r\n\r\n            ba.style.display = \"none\";\r\n            bb.style.display = \"none\";\r\n            bc.style.display = \"none\";\r\n            bd.style.display = \"none\";\r\n            previewInnerWrapper.appendChild(ba);\r\n            previewInnerWrapper.appendChild(bb);\r\n            previewInnerWrapper.appendChild(bc);\r\n            previewInnerWrapper.appendChild(bd);\r\n\r\n\r\n            div.appendChild(previewWrapper);\r\n            update();\r\n            result.destroy = () => {\r\n                for (let i = 0; i < pointerListenerArr.length; i++) {\r\n                    pointerListenerArr[i].destroy();\r\n                }\r\n                texture.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    before: [\r\n                        ba.x / displayPreviewFactor,\r\n                        ba.y / displayPreviewFactor,\r\n\r\n                        bb.x / displayPreviewFactor,\r\n                        bb.y / displayPreviewFactor,\r\n\r\n                        bc.x / displayPreviewFactor,\r\n                        bc.y / displayPreviewFactor,\r\n\r\n                        bd.x / displayPreviewFactor,\r\n                        bd.y / displayPreviewFactor,\r\n                    ],\r\n                    after: [\r\n                        aa.x / displayPreviewFactor,\r\n                        aa.y / displayPreviewFactor,\r\n\r\n                        ab.x / displayPreviewFactor,\r\n                        ab.y / displayPreviewFactor,\r\n\r\n                        ac.x / displayPreviewFactor,\r\n                        ac.y / displayPreviewFactor,\r\n\r\n                        ad.x / displayPreviewFactor,\r\n                        ad.y / displayPreviewFactor,\r\n                    ]\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1);\r\n\r\n        return result;\r\n    },\r\n\r\n    apply(params: IFilterApply) {\r\n        let context = params.context;\r\n        let history = params.history;\r\n        let before = params.input.before;\r\n        let after = params.input.after;\r\n        if (!context || !before || !after || !history)\r\n            return false;\r\n        history.pause(true);\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        let w = context.canvas.width;\r\n        let h = context.canvas.height;\r\n        glCanvas.draw(texture).perspective(before, after).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.push({\r\n            tool: [\"filter\", \"glPerspective\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"eFiVD\");","import {BB} from '../../bb/bb';\r\nimport {eventResMs} from './filters-consts';\r\nimport {KlSlider} from '../ui/base-components/kl-slider';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {getSharedFx} from './shared-gl-fx';\r\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\n\r\nexport const glHueSaturation = {\r\n\r\n    getDialog(params: IFilterGetDialogParam) {\r\n\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height,280, 200,  1);\r\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (tempCanvas.width > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n\r\n        function finishInit() {\r\n            let hue = 0, Saturation = 0;\r\n            div.innerHTML = LANG('filter-hue-sat-description') + \"<br/><br/>\";\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n\r\n            let hueSlider = new KlSlider({\r\n                label: LANG('filter-hue-sat-hue'),\r\n                width: 300,\r\n                height: 30,\r\n                min: -100,\r\n                max: 100,\r\n                initValue: hue * 100,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    hue = val / 100;\r\n                    glCanvas.draw(texture).hueSaturation(hue, Saturation).update();\r\n                    klCanvasPreview.render();\r\n                }\r\n            });\r\n            let saturationSlider = new KlSlider({\r\n                label: LANG('filter-hue-sat-saturation'),\r\n                width: 300,\r\n                height: 30,\r\n                min: 0,\r\n                max: 100,\r\n                initValue: (Saturation + 1) * 50,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    Saturation = val / 50 - 1;\r\n                    glCanvas.draw(texture).hueSaturation(hue, Saturation).update();\r\n                    klCanvasPreview.render();\r\n                }\r\n            });\r\n            hueSlider.getElement().style.marginBottom = \"10px\";\r\n            div.appendChild(hueSlider.getElement());\r\n            div.appendChild(saturationSlider.getElement());\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            BB.css(previewWrapper, {\r\n                width: \"340px\",\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr: IKlBasicLayer[] = [];\r\n            {\r\n                for (let i = 0; i < layers.length; i++) {\r\n                    previewLayerArr.push({\r\n                        image: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            let klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + w),\r\n                height: parseInt('' + h),\r\n                layers: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + w) + 'px',\r\n                    height: parseInt('' + h) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n\r\n            div.appendChild(previewWrapper);\r\n\r\n            try {\r\n                glCanvas.draw(texture).hueSaturation(hue, Saturation).update();\r\n                klCanvasPreview.render();\r\n            } catch(e) {\r\n                (div as any).errorCallback(e);\r\n            }\r\n\r\n            result.destroy = () => {\r\n                hueSlider.destroy();\r\n                saturationSlider.destroy();\r\n                texture.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    hue: hue,\r\n                    Saturation: Saturation\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1);\r\n        return result;\r\n    },\r\n\r\n    apply(params: IFilterApply) {\r\n        let context = params.context;\r\n        let hue = params.input.hue;\r\n        let history = params.history;\r\n        let Saturation = params.input.Saturation;\r\n        if (!context || hue === null || Saturation === null || !history)\r\n            return false;\r\n        history.pause(true);\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).hueSaturation(hue, Saturation).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.push({\r\n            tool: [\"filter\", \"glHueSaturation\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {getSharedFx} from './shared-gl-fx';\r\nimport {IFilterApply} from '../kl.types';\r\n\r\nexport const invert = {\r\n\r\n    apply(params: IFilterApply) {\r\n        let context = params.context;\r\n        let history = params.history;\r\n        if (!context || !history) {\r\n            return false;\r\n        }\r\n        history.pause(true);\r\n\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false;\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).invert().update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n\r\n        history.pause(false);\r\n        history.push({\r\n            tool: [\"filter\", \"invert\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {Select} from '../ui/base-components/select';\r\n// @ts-ignore\r\nimport constrainImg from 'url:~/src/app/img/ui/constrain.svg';\r\nimport {IFilterApply, IFilterGetDialogParam} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\n\r\nexport const resize = {\r\n\r\n    getDialog(params: IFilterGetDialogParam) {\r\n        //BB.centerWithin\r\n        let canvas = params.canvas;\r\n        if (!canvas)\r\n            return false;\r\n\r\n        let fit = BB.fitInto( canvas.getWidth(), canvas.getHeight(), 280, 200,1);\r\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n\r\n        let previewFactor = w / canvas.getWidth();\r\n        let tempCanvas = canvas.getCompleteCanvas(1);\r\n\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n        let newWidth = canvas.getWidth(), newHeight = canvas.getHeight();\r\n\r\n        div.innerHTML = LANG('filter-resize-description') + \"<br/><br/>\";\r\n\r\n\r\n        let maxWidth = params.maxWidth, maxHeight = params.maxHeight;\r\n\r\n        let widthWrapper = BB.el({\r\n            css: {\r\n                width: '150px',\r\n                height: '35px',\r\n                lineHeight: '30px',\r\n            }\r\n        });\r\n        let heightWrapper = BB.el({\r\n            css: {\r\n                width: '150px',\r\n                height: '35px',\r\n                lineHeight: '30px',\r\n            }\r\n        });\r\n        let widthInput = BB.el({\r\n            tagName: 'input',\r\n            css: {\r\n                cssFloat: 'right',\r\n                width: '90px',\r\n            },\r\n            custom: {\r\n                type: 'number',\r\n                min: '1',\r\n                max: '' + maxWidth,\r\n                value: '' + canvas.getWidth(),\r\n            }\r\n        }) as HTMLInputElement;\r\n        let heightInput = BB.el({\r\n            tagName: 'input',\r\n            css: {\r\n                cssFloat: 'right',\r\n                width: '90px',\r\n            },\r\n            custom: {\r\n                type: 'number',\r\n                min: '1',\r\n                max: '' + maxHeight,\r\n                value: '' + canvas.getHeight(),\r\n            }\r\n        }) as HTMLInputElement;\r\n        widthInput.onclick = function () {\r\n            (this as any).focus();\r\n            widthChanged = true;\r\n            update();\r\n        };\r\n        heightInput.onclick = function () {\r\n            (this as any).focus();\r\n            heightChanged = true;\r\n            update();\r\n        };\r\n        widthInput.onchange = function () {\r\n            widthChanged = true;\r\n            update();\r\n        };\r\n        heightInput.onchange = function () {\r\n            heightChanged = true;\r\n            update();\r\n        };\r\n        widthWrapper.append(LANG('width') + \": \", widthInput);\r\n        heightWrapper.append(LANG('height') + \": \", heightInput);\r\n        let inputWrapper = BB.el({\r\n            css: {\r\n                background: \"url(\" + constrainImg + \") no-repeat 140px 5px\",\r\n                backgroundSize: '50px 52px',\r\n            }\r\n        });\r\n        inputWrapper.append(widthWrapper, heightWrapper);\r\n        div.appendChild(inputWrapper);\r\n\r\n        //contrain checkbox\r\n        let heightChanged = false, widthChanged = false;\r\n        let ratio = canvas.getWidth() / canvas.getHeight();\r\n\r\n        function updateConstrain() {\r\n            if (isConstrained) {\r\n                widthInput.value = '' + canvas.getWidth();\r\n                heightInput.value = '' + canvas.getHeight();\r\n                inputWrapper.style.background = \"url(\" + constrainImg + \") no-repeat 140px 5px\";\r\n                inputWrapper.style.backgroundSize = '50px 52px';\r\n                update();\r\n            } else {\r\n                inputWrapper.style.background = \"\";\r\n            }\r\n        }\r\n\r\n        let isConstrained = true;\r\n        let constrainCheckbox = new Checkbox({\r\n            init: true,\r\n            label: LANG('constrain-proportions'),\r\n            allowTab: true,\r\n            callback: function(b) {\r\n                isConstrained = b;\r\n                updateConstrain();\r\n            }\r\n        });\r\n        div.appendChild(BB.el({\r\n            css: {\r\n                clear: 'both'\r\n            }\r\n        }));\r\n\r\n\r\n        let algorithmSelect = new Select({\r\n            isFocusable: true,\r\n            optionArr: [\r\n                ['smooth', LANG('algorithm-smooth')],\r\n                ['pixelated', LANG('algorithm-pixelated')]\r\n            ],\r\n            title: LANG('scaling-algorithm'),\r\n            initValue: 'smooth',\r\n            onChange: function() {\r\n                update();\r\n            },\r\n        });\r\n\r\n        let secondRowElement = BB.el({\r\n            parent: div,\r\n            css: {\r\n                display: 'flex',\r\n                justifyContent: 'space-between'\r\n            }\r\n        });\r\n        secondRowElement.appendChild(constrainCheckbox.getElement());\r\n        secondRowElement.appendChild(algorithmSelect.getElement());\r\n\r\n        let previewCanvas = BB.canvas(w, h);\r\n        previewCanvas.style.imageRendering = 'pixelated';\r\n\r\n\r\n        let previewCtx = previewCanvas.getContext('2d');\r\n\r\n\r\n        function draw() {\r\n            if (algorithmSelect.getValue() === 'smooth') {\r\n                previewCanvas.style.imageRendering = previewFactor > 1 ? 'pixelated' : '';\r\n\r\n                previewCanvas.width = canvas.getWidth();\r\n                previewCanvas.height = canvas.getHeight();\r\n\r\n                previewCtx.save();\r\n                previewCtx.imageSmoothingQuality = 'high';\r\n                previewCtx.drawImage(tempCanvas, 0, 0);\r\n                BB.resizeCanvas(previewCanvas, newWidth, newHeight);\r\n                previewCtx.restore();\r\n\r\n            } else {\r\n                previewCanvas.style.imageRendering = 'pixelated';\r\n\r\n                previewCanvas.width = newWidth;\r\n                previewCanvas.height = newHeight;\r\n                previewCtx.save();\r\n                previewCtx.imageSmoothingEnabled = false;\r\n                previewCtx.drawImage(tempCanvas, 0, 0, previewCanvas.width, previewCanvas.height);\r\n                previewCtx.restore();\r\n            }\r\n\r\n        }\r\n\r\n        function update() {\r\n            if ((widthInput.value.length === 0 && widthChanged) || (heightInput.value.length === 0 && heightChanged)) {\r\n                heightChanged = false;\r\n                widthChanged = false;\r\n                return;\r\n            }\r\n            widthInput.value = '' + Math.max(1, parseInt(widthInput.value));\r\n            heightInput.value = '' + Math.max(1, parseInt(heightInput.value));\r\n            if (isConstrained) {\r\n                if (heightChanged) {\r\n                    widthInput.value = '' + parseInt('' + (parseInt(heightInput.value) * ratio));\r\n                }\r\n                if (widthChanged) {\r\n                    heightInput.value = '' + parseInt('' + (parseInt(widthInput.value) / ratio));\r\n                }\r\n\r\n                if (parseInt(widthInput.value) > maxWidth || parseInt(heightInput.value) > maxHeight) {\r\n                    let fit = BB.fitInto(parseInt(widthInput.value), parseInt(heightInput.value), maxWidth, maxHeight, 1);\r\n                    widthInput.value = '' + parseInt('' + fit.width);\r\n                    heightInput.value = '' + parseInt('' + fit.height);\r\n                }\r\n            }\r\n\r\n            if (parseInt(widthInput.value) > maxWidth) {\r\n                widthInput.value = '' + maxWidth;\r\n            }\r\n            if (parseInt(heightInput.value) > maxHeight) {\r\n                heightInput.value = '' + maxHeight;\r\n            }\r\n\r\n            heightChanged = false;\r\n            widthChanged = false;\r\n\r\n            newWidth = parseInt(widthInput.value);\r\n            newHeight = parseInt(heightInput.value);\r\n\r\n            let preview = BB.fitInto(newWidth, newHeight, 280, 200, 1);\r\n            let previewW = parseInt('' + preview.width), previewH = parseInt('' + preview.height);\r\n            previewFactor = previewW / newWidth;\r\n\r\n            let offset = BB.centerWithin(340, 220, previewW, previewH);\r\n\r\n            draw();\r\n\r\n            previewCanvas.style.width = Math.max(1, previewW) + \"px\";\r\n            previewCanvas.style.height = Math.max(1, previewH) + \"px\";\r\n            canvasWrapper.style.left = offset.x + \"px\";\r\n            canvasWrapper.style.top = offset.y + \"px\";\r\n            canvasWrapper.style.width = Math.max(1, previewW) + \"px\";\r\n            canvasWrapper.style.height = Math.max(1, previewH) + \"px\";\r\n        }\r\n\r\n        let previewWrapper = document.createElement(\"div\");\r\n        BB.css(previewWrapper, {\r\n            width: \"340px\",\r\n            marginLeft: \"-20px\",\r\n            height: \"220px\",\r\n            display: \"table\",\r\n            backgroundColor: \"#9e9e9e\",\r\n            marginTop: \"10px\",\r\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n            position: \"relative\",\r\n            userSelect: 'none',\r\n            colorScheme: 'only light',\r\n        });\r\n\r\n\r\n        let canvasWrapper = BB.appendTextDiv(previewWrapper, \"\");\r\n        canvasWrapper.appendChild(previewCanvas);\r\n        canvasWrapper.style.width = w + \"px\";\r\n        canvasWrapper.style.height = h + \"px\";\r\n        canvasWrapper.style.position = \"absolute\";\r\n        canvasWrapper.style.overflow = \"hidden\";\r\n        canvasWrapper.style.boxShadow = \"0 0 5px rgba(0,0,0,0.8)\";\r\n        canvasWrapper.style.overflow = \"hidden\";\r\n        BB.createCheckerDataUrl(8, function (url) {\r\n            previewWrapper.style.background = \"url(\" + url + \")\";\r\n        });\r\n\r\n        div.appendChild(previewWrapper);\r\n        update();\r\n\r\n        result.destroy = () => {\r\n            constrainCheckbox.destroy();\r\n        };\r\n        result.getInput = function () {\r\n            result.destroy();\r\n            return {\r\n                width: newWidth,\r\n                height: newHeight,\r\n                algorithm: algorithmSelect.getValue()\r\n            };\r\n        };\r\n        return result;\r\n    },\r\n\r\n    apply(params: IFilterApply) {\r\n        let canvas = params.canvas;\r\n        let history = params.history;\r\n        let width = params.input.width;\r\n        let height = params.input.height;\r\n        let algorithm = params.input.algorithm;\r\n        if (!canvas || !history) {\r\n            return false;\r\n        }\r\n        history.pause(true);\r\n        canvas.resize(width, height, algorithm);\r\n        history.pause(false);\r\n        history.push({\r\n            tool: [\"filter\", \"resize\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {eventResMs} from './filters-consts';\r\nimport {KlSlider} from '../ui/base-components/kl-slider';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {getSharedFx} from './shared-gl-fx';\r\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\n\r\nexport const glTiltShift = {\r\n\r\n    getDialog(params: IFilterGetDialogParam) {\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\r\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\r\n        let w = Math.min(displayW, context.canvas.width);\r\n        let h = Math.min(displayH, context.canvas.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (w > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n        let previewFactor = w / context.canvas.width;\r\n        let displayPreviewFactor = displayW / context.canvas.width;\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n\r\n        let pointerListenerArr = [];\r\n\r\n        function finishInit() {\r\n            let blur = 20, gradient = 200;\r\n            div.innerHTML = LANG('filter-tilt-shift-description') + \"<br/><br/>\";\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n            let fa, fb; // focus line\r\n            function update() {\r\n                try {\r\n                    glCanvas.draw(texture).tiltShift(\r\n                        fa.x / displayPreviewFactor * previewFactor,\r\n                        fa.y / displayPreviewFactor * previewFactor,\r\n                        fb.x / displayPreviewFactor * previewFactor,\r\n                        fb.y / displayPreviewFactor * previewFactor,\r\n                        blur * previewFactor,\r\n                        gradient * previewFactor\r\n                    ).update();\r\n                    klCanvasPreview.render();\r\n                } catch(e) {\r\n                    (div as any).errorCallback(e);\r\n                }\r\n            }\r\n\r\n            function nob(x, y) {\r\n                let nobSize = 14;\r\n                let div = BB.el({\r\n                    css: {\r\n                        width: nobSize + \"px\",\r\n                        height: nobSize + \"px\",\r\n                        backgroundColor: '#fff',\r\n                        boxShadow: \"inset 0 0 0 2px #000\",\r\n                        borderRadius: nobSize + \"px\",\r\n                        position: \"absolute\",\r\n                        cursor: 'move',\r\n                        left: (x - nobSize / 2) + \"px\",\r\n                        top: (y - nobSize / 2) + \"px\",\r\n                        userSelect: 'none',\r\n                        touchAction: 'none',\r\n                    }\r\n                });\r\n                (div as any).x = x;\r\n                (div as any).y = y;\r\n                let pointerListener = new BB.PointerListener({\r\n                    target: div,\r\n                    maxPointers: 1,\r\n                    onPointer: function(event) {\r\n                        event.eventPreventDefault();\r\n                        if (event.button === 'left' && event.type === 'pointermove') {\r\n                            (div as any).x += event.dX;\r\n                            (div as any).y += event.dY;\r\n                            div.style.left = ((div as any).x - nobSize / 2) + \"px\";\r\n                            div.style.top = ((div as any).y - nobSize / 2) + \"px\";\r\n                            update();\r\n                        }\r\n                    }\r\n                });\r\n                pointerListenerArr.push(pointerListener);\r\n                return div;\r\n            }\r\n\r\n            fa = nob(parseInt('' + (displayW / 6)), parseInt('' + (displayH / 2)));\r\n            fb = nob(parseInt('' + (displayW - displayW / 6)), parseInt('' + (displayH - displayH / 3)));\r\n\r\n            let blurSlider = new KlSlider({\r\n                label: LANG('filter-tilt-shift-blur'),\r\n                width: 300,\r\n                height: 30,\r\n                min: 0,\r\n                max: 200,\r\n                initValue: blur,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    blur = val;\r\n                    update();\r\n                }\r\n            });\r\n            blurSlider.getElement().style.marginBottom = \"10px\";\r\n            div.appendChild(blurSlider.getElement());\r\n            let gradientSlider = new KlSlider({\r\n                label: LANG('filter-tilt-shift-gradient'),\r\n                width: 300,\r\n                height: 30,\r\n                min: 0,\r\n                max: 1000,\r\n                initValue: gradient,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    gradient = val;\r\n                    update();\r\n                }\r\n            });\r\n            div.appendChild(gradientSlider.getElement());\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            previewWrapper.oncontextmenu = function () {\r\n                return false;\r\n            };\r\n            BB.css(previewWrapper, {\r\n                width: \"340px\",\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr: IKlBasicLayer[] = [];\r\n            {\r\n                for (let i = 0; i < layers.length; i++) {\r\n                    previewLayerArr.push({\r\n                        image: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            let klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + displayW),\r\n                height: parseInt('' + displayH),\r\n                layers: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + displayW) + 'px',\r\n                    height: parseInt('' + displayH) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n            previewInnerWrapper.appendChild(fa);\r\n            previewInnerWrapper.appendChild(fb);\r\n\r\n\r\n            div.appendChild(previewWrapper);\r\n            update();\r\n            result.destroy = () => {\r\n                for (let i = 0; i < pointerListenerArr.length; i++) {\r\n                    pointerListenerArr[i].destroy();\r\n                }\r\n                blurSlider.destroy();\r\n                gradientSlider.destroy();\r\n                texture.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    a: {x: fa.x / displayPreviewFactor, y: fa.y / displayPreviewFactor},\r\n                    b: {x: fb.x / displayPreviewFactor, y: fb.y / displayPreviewFactor},\r\n                    blur: blur,\r\n                    gradient: gradient\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1);\r\n\r\n\r\n        return result;\r\n    },\r\n\r\n    apply(params: IFilterApply) {\r\n        let context = params.context;\r\n        let history = params.history;\r\n        let a = params.input.a;\r\n        let b = params.input.b;\r\n        let blur = params.input.blur;\r\n        let gradient = params.input.gradient;\r\n        if (!context || !history)\r\n            return false;\r\n        history.pause(true);\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).tiltShift(a.x, a.y, b.x, b.y, blur, gradient).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.push({\r\n            tool: [\"filter\", \"glTiltShift\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {IFilterApply, IFilterGetDialogParam} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\n\r\nexport const rotate = {\r\n\r\n    getDialog(params: IFilterGetDialogParam) {\r\n        let canvas = params.canvas;\r\n        if (!canvas)\r\n            return false;\r\n\r\n        let fit = BB.fitInto(canvas.getWidth(), canvas.getHeight(), 280, 200, 1);\r\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n\r\n        let previewFactor = w / canvas.getWidth();\r\n        let tempCanvas = BB.canvas(w, h);\r\n        tempCanvas.style.display = 'block';\r\n        tempCanvas.getContext(\"2d\").drawImage(canvas.getCompleteCanvas(previewFactor), 0, 0, w, h);\r\n\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n        let deg = 0;\r\n        div.innerHTML = LANG('filter-rotate-description') + \"<br/><br/>\";\r\n\r\n        let first = true;\r\n\r\n        function update() {\r\n            (canvasWrapper.style as any).WebkitTransform = \"rotate(\" + deg + \"deg)\";\r\n            (canvasWrapper.style as any).MozTransform = \"rotate(\" + deg + \"deg)\";\r\n            (canvasWrapper.style as any).OTransform = \"rotate(\" + deg + \"deg)\";\r\n            (canvasWrapper.style as any).msTransform = \"rotate(\" + deg + \"deg)\";\r\n            if (Math.abs(deg % 180) === 90) {\r\n                //height has to fit width because of rotation\r\n                let fit = BB.fitInto(h, w, 280, 200, 1);\r\n                let scale = parseInt('' + fit.height) / w;\r\n                (canvasWrapper.style as any).WebkitTransform = \"rotate(\" + deg + \"deg) scale(\" + scale + \")\";\r\n                (canvasWrapper.style as any).MozTransform = \"rotate(\" + deg + \"deg) scale(\" + scale + \")\";\r\n                (canvasWrapper.style as any).OTransform = \"rotate(\" + deg + \"deg) scale(\" + scale + \")\";\r\n                (canvasWrapper.style as any).msTransform = \"rotate(\" + deg + \"deg) scale(\" + scale + \")\";\r\n            }\r\n        }\r\n\r\n        let btnPlus = document.createElement(\"button\");\r\n        btnPlus.innerHTML = \"<span style='font-size: 1.3em'>⟳</span> 90°\";\r\n        let btnMinus = document.createElement(\"button\");\r\n        btnMinus.innerHTML = \"<span style='font-size: 1.3em'>⟲</span> 90°\";\r\n        btnMinus.style.marginRight = '5px';\r\n\r\n\r\n        btnPlus.onclick = function () {\r\n            deg += 90;\r\n            update();\r\n        };\r\n        btnMinus.onclick = function () {\r\n            deg -= 90;\r\n            update();\r\n        };\r\n\r\n        div.appendChild(btnMinus);\r\n        div.appendChild(btnPlus);\r\n\r\n        let previewWrapper = document.createElement(\"div\");\r\n        BB.css(previewWrapper, {\r\n            width: \"340px\",\r\n            marginLeft: \"-20px\",\r\n            height: \"220px\",\r\n            display: \"table\",\r\n            backgroundColor: \"#9e9e9e\",\r\n            marginTop: \"10px\",\r\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n            overflow: \"hidden\",\r\n            position: \"relative\",\r\n            userSelect: 'none',\r\n            colorScheme: 'only light',\r\n        });\r\n\r\n        let previewcell = document.createElement(\"div\");\r\n        previewcell.style.display = \"table-cell\";\r\n        previewcell.style.verticalAlign = \"middle\";\r\n        let canvasWrapper = BB.appendTextDiv(previewcell, \"\");\r\n        canvasWrapper.appendChild(tempCanvas);\r\n        previewWrapper.appendChild(previewcell);\r\n        canvasWrapper.style.width = w + \"px\";\r\n        canvasWrapper.style.height = h + \"px\";\r\n        canvasWrapper.style.marginLeft = \"auto\";\r\n        canvasWrapper.style.marginRight = \"auto\";\r\n        canvasWrapper.style.boxShadow = \"0 0 5px rgba(0,0,0,0.8)\";\r\n        canvasWrapper.style.overflow = \"hidden\";\r\n        BB.createCheckerDataUrl(4, function (url) {\r\n            canvasWrapper.style.background = \"url(\" + url + \")\";\r\n        });\r\n        canvasWrapper.style.transition = \"all 0.2s ease-out\";\r\n\r\n        div.appendChild(previewWrapper);\r\n        update();\r\n\r\n        result.getInput = function () {\r\n            return {\r\n                deg: deg\r\n            };\r\n        };\r\n        return result;\r\n    },\r\n\r\n    apply(params: IFilterApply) {\r\n        let canvas = params.canvas;\r\n        let history = params.history;\r\n        let deg = params.input.deg;\r\n        if (!canvas || !history)\r\n            return false;\r\n        history.pause(true);\r\n        canvas.rotate(deg);\r\n        history.pause(false);\r\n        history.push({\r\n            tool: [\"filter\", \"rotate\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"2BZYe\");","import {BB} from '../../bb/bb';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {FreeTransform, ITransform} from '../ui/components/free-transform';\r\nimport {Select} from '../ui/base-components/select';\r\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\n\r\ninterface IFilterTransformInput {\r\n    bounds: {x: number, y: number, width: number, height: number};\r\n    transform: ITransform;\r\n    isPixelated: boolean;\r\n}\r\n\r\nexport const transform = {\r\n\r\n    getDialog(params: IFilterGetDialogParam) {\r\n        let i;\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let isSmall = window.innerWidth < 550;\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, isSmall ? 280 : 490, isSmall ? 200 : 240, 1);\r\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\r\n        let w = Math.min(displayW, context.canvas.width);\r\n        let h = Math.min(displayH, context.canvas.height);\r\n        let freeTransform: FreeTransform;\r\n        let displayPreviewFactor = displayW / context.canvas.width;\r\n\r\n        // determine bounds and initial transformation\r\n        let boundsObj: {\r\n            x: number;\r\n            y: number;\r\n            width: number;\r\n            height: number;\r\n        } = { x: 0, y: 0, width: 0, height: 0 };\r\n        {\r\n            let tempBounds: any = {\r\n                x1: null,\r\n                y1: null,\r\n                x2: null,\r\n                y2: null\r\n            };\r\n            let imdat = context.getImageData(0, 0, context.canvas.width, context.canvas.height);\r\n\r\n            if (imdat.data[3] > 0 && imdat.data[imdat.data.length - 1] > 0) {\r\n                tempBounds.x1 = 0;\r\n                tempBounds.y1 = 0;\r\n                tempBounds.x2 = context.canvas.width - 1;\r\n                tempBounds.y2 = context.canvas.height - 1;\r\n            } else {\r\n                for (i = 3; i < imdat.data.length; i += 4) {\r\n                    if (imdat.data[i] > 0 ) {\r\n                        let x = ((i - 3) / 4) %  context.canvas.width;\r\n                        let y = Math.floor((i - 3) / 4 / context.canvas.width);\r\n                        if (tempBounds.x1 > x || tempBounds.x1 === null) {\r\n                            tempBounds.x1 = x;\r\n                        }\r\n                        if (tempBounds.y1 === null) {\r\n                            tempBounds.y1 = y;\r\n                        }\r\n                        if (tempBounds.x2 < x || tempBounds.x2 === null) {\r\n                            tempBounds.x2 = x;\r\n                        }\r\n                        if (tempBounds.y2 < y || tempBounds.y2 === null) {\r\n                            tempBounds.y2 = y;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (tempBounds.x1 === null || tempBounds.y1 === null) {\r\n                alert(LANG('filter-transform-empty'));\r\n                return false;\r\n            }\r\n            boundsObj.x = tempBounds.x1;\r\n            boundsObj.y = tempBounds.y1;\r\n            boundsObj.width = tempBounds.x2 - tempBounds.x1 + 1;\r\n            boundsObj.height = tempBounds.y2 - tempBounds.y1 + 1;\r\n        }\r\n\r\n        const initTransform = {\r\n            x: boundsObj.x + boundsObj.width / 2,\r\n            y: boundsObj.y + boundsObj.height / 2,\r\n            width: boundsObj.width,\r\n            height: boundsObj.height,\r\n            angleDeg: 0,\r\n        };\r\n\r\n\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n        if (!isSmall) {\r\n            result.width = 500;\r\n        }\r\n        div.innerHTML = LANG('filter-transform-description');\r\n\r\n        let keyListener = new BB.KeyListener({\r\n            onDown: function(keyStr) {\r\n                if (BB.isInputFocused(true)) {\r\n                    return;\r\n                }\r\n\r\n                if (keyStr === 'left') {\r\n                    inputX.value = '' + (parseFloat(inputX.value) - 1);\r\n                    onInputsChanged();\r\n                }\r\n                if (keyStr === 'right') {\r\n                    inputX.value = '' + (parseFloat(inputX.value) + 1);\r\n                    onInputsChanged();\r\n                }\r\n                if (keyStr === 'up') {\r\n                    inputY.value = '' + (parseFloat(inputY.value) - 1);\r\n                    onInputsChanged();\r\n                }\r\n                if (keyStr === 'down') {\r\n                    inputY.value = '' + (parseFloat(inputY.value) + 1);\r\n                    onInputsChanged();\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        let leftWrapper = document.createElement(\"div\");\r\n        let rightWrapper = document.createElement(\"div\");\r\n        let rotWrapper = document.createElement(\"div\");\r\n        let inputY = document.createElement(\"input\");\r\n        let inputX = document.createElement(\"input\");\r\n        let inputR = document.createElement(\"input\");\r\n        leftWrapper.style.width = \"100px\";\r\n        leftWrapper.style.height = \"30px\";\r\n        rightWrapper.style.width = \"100px\";\r\n        rightWrapper.style.height = \"30px\";\r\n        rightWrapper.style.display = \"inline-block\";\r\n        leftWrapper.style.display = \"inline-block\";\r\n        rotWrapper.style.display = \"inline-block\";\r\n        rotWrapper.style.width = \"150px\";\r\n        rotWrapper.style.height = \"30px\";\r\n        inputY.type = \"number\";\r\n        inputX.type = \"number\";\r\n        inputR.type = \"number\";\r\n        inputX.style.width = 70 + \"px\";\r\n        inputY.style.width = 70 + \"px\";\r\n        inputR.style.width = 70 + \"px\";\r\n        inputY.value = '0';\r\n        inputX.value = '0';\r\n        inputR.value = '0';\r\n        inputY.onclick = function () {\r\n            (this as any).focus();\r\n            onInputsChanged();\r\n        };\r\n        inputX.onclick = function () {\r\n            (this as any).focus();\r\n            onInputsChanged();\r\n        };\r\n        inputR.onclick = function () {\r\n            (this as any).focus();\r\n            onInputsChanged();\r\n        };\r\n        inputY.onchange = function () {\r\n            onInputsChanged();\r\n        };\r\n        inputX.onchange = function () {\r\n            onInputsChanged();\r\n        };\r\n        inputR.onchange = function () {\r\n            onInputsChanged();\r\n        };\r\n        inputY.onkeyup = function () {\r\n            onInputsChanged();\r\n        };\r\n        inputX.onkeyup = function () {\r\n            onInputsChanged();\r\n        };\r\n        inputR.onkeyup = function () {\r\n            onInputsChanged();\r\n        };\r\n        leftWrapper.append(\"X: \", inputX);\r\n        rightWrapper.append(\"Y: \", inputY);\r\n        rotWrapper.append(LANG('filter-transform-rotation') + ': ', inputR);\r\n        if (!isSmall) {\r\n            const inputRow = BB.el({\r\n                parent: div,\r\n                css: {\r\n                    marginTop: '10px',\r\n                }\r\n            });\r\n            inputRow.append(leftWrapper, rightWrapper, rotWrapper);\r\n        }\r\n\r\n        // buttons\r\n        const actionBtnCss = {\r\n            marginLeft: '10px',\r\n            marginTop: '10px',\r\n        };\r\n        const buttonRow = BB.el ({\r\n            parent: div,\r\n            css: {\r\n                display: 'flex',\r\n                flexWrap: 'wrap',\r\n                marginLeft: '-10px',\r\n            }\r\n        });\r\n        const flipXBtn = BB.el ({\r\n            parent: buttonRow,\r\n            tagName: 'button',\r\n            content: LANG('filter-transform-flip') + ' X',\r\n            onClick: () => {\r\n                const t = freeTransform.getTransform();\r\n                freeTransform.setSize(-t.width, t.height);\r\n            },\r\n            css: actionBtnCss,\r\n        });\r\n        const flipYBtn = BB.el ({\r\n            parent: buttonRow,\r\n            tagName: 'button',\r\n            content: LANG('filter-transform-flip') + ' Y',\r\n            onClick: () => {\r\n                const t = freeTransform.getTransform();\r\n                freeTransform.setSize(t.width, -t.height);\r\n            },\r\n            css: actionBtnCss,\r\n        });\r\n        const scaleRotLeftBtn = BB.el ({\r\n            parent: buttonRow,\r\n            tagName: 'button',\r\n            content: '-90°',\r\n            onClick: () => {\r\n                const t = freeTransform.getTransform();\r\n                t.angleDeg -= 90;\r\n                t.angleDeg %= 360;\r\n                freeTransform.setAngleDeg(t.angleDeg);\r\n                inputR.value = '' + Math.round(t.angleDeg);\r\n                updatePreview();\r\n            },\r\n            css: actionBtnCss,\r\n        });\r\n        const scaleRotRightBtn = BB.el ({\r\n            parent: buttonRow,\r\n            tagName: 'button',\r\n            content: '+90°',\r\n            onClick: () => {\r\n                const t = freeTransform.getTransform();\r\n                t.angleDeg += 90;\r\n                t.angleDeg %= 360;\r\n                freeTransform.setAngleDeg(t.angleDeg);\r\n                inputR.value = '' + Math.round(t.angleDeg);\r\n                updatePreview();\r\n            },\r\n            css: actionBtnCss,\r\n        });\r\n        const scaleDoubleBtn = BB.el ({\r\n            parent: buttonRow,\r\n            tagName: 'button',\r\n            content: '2x',\r\n            onClick: () => {\r\n                const t = freeTransform.getTransform();\r\n                if (constrainCheckbox.getValue()) {\r\n                    freeTransform.setSize(freeTransform.getRatio() * t.height * 2, t.height * 2);\r\n                } else {\r\n                    freeTransform.setSize(t.width * 2, t.height * 2);\r\n                }\r\n            },\r\n            css: actionBtnCss,\r\n        });\r\n        const scaleHalfBtn = BB.el ({\r\n            parent: buttonRow,\r\n            tagName: 'button',\r\n            content: '1/2x',\r\n            onClick: () => {\r\n                const t = freeTransform.getTransform();\r\n                freeTransform.setSize(Math.round(t.width / 2), Math.round(t.height / 2));\r\n            },\r\n            css: actionBtnCss,\r\n        });\r\n        const centerBtn = BB.el ({\r\n            parent: buttonRow,\r\n            tagName: 'button',\r\n            content: LANG('center'),\r\n            onClick: () => {\r\n                const t = freeTransform.getTransform();\r\n                freeTransform.setPos({ x: context.canvas.width / 2, y: context.canvas.height / 2 });\r\n                freeTransform.setAngleDeg(t.angleDeg);\r\n                updatePreview();\r\n            },\r\n            css: actionBtnCss,\r\n        });\r\n\r\n\r\n\r\n\r\n\r\n        let isConstrained = true;\r\n        let constrainCheckbox = new Checkbox({\r\n            init: true,\r\n            label: LANG('filter-transform-constrain'),\r\n            title: LANG('constrain-proportions'),\r\n            allowTab: true,\r\n            callback: function(b) {\r\n                isConstrained = b;\r\n                freeTransform.setConstrained(isConstrained);\r\n            },\r\n            css: {\r\n                display: 'inline-block'\r\n            }\r\n        });\r\n        let isSnapping = false;\r\n        let snappingCheckbox = new Checkbox({\r\n            init: true,\r\n            label: LANG('filter-transform-snap'),\r\n            title: LANG('filter-transform-snap-title'),\r\n            allowTab: true,\r\n            callback: function(b) {\r\n                isSnapping = b;\r\n                freeTransform.setSnapping(isSnapping);\r\n            },\r\n            css: {\r\n                display: 'inline-block',\r\n                marginLeft: '10px',\r\n            }\r\n        });\r\n        const checkboxWrapper = BB.el({});\r\n        checkboxWrapper.append(constrainCheckbox.getElement(), snappingCheckbox.getElement());\r\n\r\n        div.appendChild(BB.el({\r\n            css: {\r\n                clear: 'both',\r\n                height: '10px'\r\n            }\r\n        }));\r\n\r\n        const bottomRow = BB.el({\r\n            parent: div,\r\n            css: {\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n            }\r\n        });\r\n\r\n        let algorithmSelect = new Select({\r\n            isFocusable: true,\r\n            optionArr: [\r\n                ['smooth', LANG('algorithm-smooth')],\r\n                ['pixelated', LANG('algorithm-pixelated')]\r\n            ],\r\n            initValue: 'smooth',\r\n            title: LANG('scaling-algorithm'),\r\n            onChange: function() {\r\n                updatePreview(true);\r\n            },\r\n        });\r\n        bottomRow.append(checkboxWrapper, algorithmSelect.getElement());\r\n\r\n\r\n        let previewWrapper = document.createElement(\"div\");\r\n        previewWrapper.oncontextmenu = function () {\r\n            return false;\r\n        };\r\n        BB.css(previewWrapper, {\r\n            width: isSmall ? '340px' : '540px',\r\n            marginLeft: \"-20px\",\r\n            height: isSmall ? '260px' : '300px',\r\n            backgroundColor: \"#9e9e9e\",\r\n            marginTop: \"10px\",\r\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n            overflow: \"hidden\",\r\n            position: \"relative\",\r\n            userSelect: 'none',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            colorScheme: 'only light',\r\n        });\r\n\r\n        let previewLayerArr: IKlBasicLayer[] = [];\r\n        {\r\n            for (let i = 0; i < layers.length; i++) {\r\n                let canvas;\r\n                if (i === selectedLayerIndex) {\r\n                    canvas = BB.canvas(parseInt('' + w), parseInt('' + h));\r\n                    let ctx = canvas.getContext('2d');\r\n                    ctx.drawImage(layers[i].context.canvas, 0, 0, canvas.width, canvas.height);\r\n                } else {\r\n                    canvas = layers[i].context.canvas;\r\n                }\r\n                previewLayerArr.push({\r\n                    image: canvas,\r\n                    opacity: layers[i].opacity,\r\n                    mixModeStr: layers[i].mixModeStr\r\n                });\r\n            }\r\n        }\r\n        let klCanvasPreview = new KlCanvasPreview({\r\n            width: parseInt('' + displayW),\r\n            height: parseInt('' + displayH),\r\n            layers: previewLayerArr\r\n        });\r\n\r\n        let previewInnerWrapper = BB.el({\r\n            css: {\r\n                position: 'relative',\r\n                boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                width: parseInt('' + displayW) + 'px',\r\n                height: parseInt('' + displayH) + 'px'\r\n            }\r\n        });\r\n        previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n        previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n        let lastDrawnTransformStr;\r\n        function updatePreview(doForce: boolean = false) {\r\n            if (!freeTransform) {\r\n                return;\r\n            }\r\n            let transform = freeTransform.getTransform();\r\n            if (JSON.stringify(transform) === lastDrawnTransformStr && !doForce) {\r\n                return;\r\n            }\r\n            lastDrawnTransformStr = JSON.stringify(transform);\r\n            if (displayPreviewFactor < 1) {\r\n                transform.x *= displayPreviewFactor;\r\n                transform.y *= displayPreviewFactor;\r\n                transform.width *= displayPreviewFactor;\r\n                transform.height *= displayPreviewFactor;\r\n            }\r\n            let transformLayerCanvas = previewLayerArr[selectedLayerIndex].image as HTMLCanvasElement;\r\n            let ctx = transformLayerCanvas.getContext('2d');\r\n            ctx.save();\r\n            ctx.clearRect(0, 0, transformLayerCanvas.width, transformLayerCanvas.height);\r\n            BB.drawTransformedImageWithBounds(\r\n                ctx,\r\n                layers[selectedLayerIndex].context.canvas,\r\n                transform,\r\n                boundsObj,\r\n                algorithmSelect.getValue() === 'pixelated' ||\r\n                BB.testShouldPixelate(transform, transform.width / initTransform.width, transform.height / initTransform.height),\r\n            );\r\n            ctx.restore();\r\n            klCanvasPreview.render();\r\n        }\r\n\r\n        freeTransform = new FreeTransform({\r\n            x: initTransform.x,\r\n            y: initTransform.y,\r\n            width: initTransform.width,\r\n            height: initTransform.height,\r\n            angleDeg: initTransform.angleDeg,\r\n            isConstrained: true,\r\n            snapX: [0, context.canvas.width],\r\n            snapY: [0, context.canvas.height],\r\n            callback: function (t) {\r\n                inputX.value = '' + Math.round(t.x - initTransform.x);\r\n                inputY.value = '' + Math.round(t.y - initTransform.y);\r\n                inputR.value = '' + Math.round(t.angleDeg);\r\n                updatePreview();\r\n            },\r\n            scale: displayPreviewFactor\r\n        });\r\n        BB.css(freeTransform.getElement(), {\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0'\r\n        });\r\n        previewInnerWrapper.appendChild(freeTransform.getElement());\r\n\r\n        function onInputsChanged() {\r\n            freeTransform.setPos({\r\n                x: parseInt(inputX.value) + initTransform.x,\r\n                y: parseInt(inputY.value) + initTransform.y}\r\n            );\r\n            freeTransform.setAngleDeg(parseInt(inputR.value));\r\n            updatePreview();\r\n        }\r\n\r\n        updatePreview();\r\n\r\n        div.appendChild(previewWrapper);\r\n        result.destroy = () => {\r\n            keyListener.destroy();\r\n            freeTransform.destroy();\r\n            constrainCheckbox.destroy();\r\n            snappingCheckbox.destroy();\r\n            BB.destroyEl(flipXBtn);\r\n            BB.destroyEl(flipYBtn);\r\n            BB.destroyEl(scaleRotLeftBtn);\r\n            BB.destroyEl(scaleRotRightBtn);\r\n            BB.destroyEl(scaleDoubleBtn);\r\n            BB.destroyEl(scaleHalfBtn);\r\n            BB.destroyEl(centerBtn);\r\n        };\r\n        result.getInput = function () {\r\n            const transform = freeTransform.getTransform();\r\n            let input = {\r\n                transform,\r\n                bounds: boundsObj,\r\n                isPixelated: algorithmSelect.getValue() === 'pixelated' ||\r\n                    BB.testShouldPixelate(transform, transform.width / initTransform.width, transform.height / initTransform.height),\r\n            } as IFilterTransformInput;\r\n            result.destroy();\r\n            return JSON.parse(JSON.stringify(input));\r\n        };\r\n        return result;\r\n    },\r\n\r\n    apply(params: IFilterApply) {\r\n        const context = params.context;\r\n        const history = params.history;\r\n        if (!context || !history) {\r\n            return false;\r\n        }\r\n        history.pause(true);\r\n\r\n        const input: IFilterTransformInput = params.input;\r\n\r\n        let copyCanvas = BB.copyCanvas(context.canvas);\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        BB.drawTransformedImageWithBounds(\r\n            context,\r\n            copyCanvas,\r\n            input.transform,\r\n            input.bounds,\r\n            input.isPixelated,\r\n        );\r\n\r\n        history.pause(false);\r\n        history.push({\r\n            tool: [\"filter\", \"transform\"],\r\n            action: \"apply\",\r\n            params: [{input}],\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {KlSlider} from '../ui/base-components/kl-slider';\r\nimport {eventResMs} from './filters-consts';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {getSharedFx} from './shared-gl-fx';\r\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\n\r\nexport const glBlur = {\r\n\r\n    getDialog(params: IFilterGetDialogParam) {\r\n        let canvas = params.canvas;\r\n        let context = params.context;\r\n        if (!canvas || !context) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\r\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\r\n        let w = Math.min(displayW, context.canvas.width);\r\n        let h = Math.min(displayH, context.canvas.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (w > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n        let previewFactor = w / context.canvas.width;\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n\r\n\r\n        function finishInit() {\r\n            let radius = 10;\r\n            div.innerHTML = LANG('filter-triangle-blur-description') + \"<br/><br/>\";\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n\r\n            let radiusSlider = new KlSlider({\r\n                label: LANG('radius'),\r\n                width: 300,\r\n                height: 30,\r\n                min: 1,\r\n                max: 200,\r\n                initValue: radius,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    radius = val;\r\n                    glCanvas.draw(texture).triangleBlur(radius * previewFactor).update();\r\n                    klCanvasPreview.render();\r\n                }\r\n            });\r\n            div.appendChild(radiusSlider.getElement());\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            BB.css(previewWrapper, {\r\n                width: \"340px\",\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr: IKlBasicLayer[] = [];\r\n            {\r\n                for (let i = 0; i < layers.length; i++) {\r\n                    previewLayerArr.push({\r\n                        image: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            let klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + displayW),\r\n                height: parseInt('' + displayH),\r\n                layers: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + displayW) + 'px',\r\n                    height: parseInt('' + displayH) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n            div.appendChild(previewWrapper);\r\n\r\n            try {\r\n                glCanvas.draw(texture).triangleBlur(radius * previewFactor).update();\r\n                klCanvasPreview.render();\r\n            } catch(e) {\r\n                (div as any).errorCallback(e);\r\n            }\r\n\r\n            result.destroy = () => {\r\n                texture.destroy();\r\n                radiusSlider.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    radius: radius\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1);\r\n\r\n        return result;\r\n    },\r\n\r\n    apply(params: IFilterApply) {\r\n        let context = params.context;\r\n        let history = params.history;\r\n        let radius = params.input.radius;\r\n        if (!context || !radius || !history)\r\n            return false;\r\n        history.pause(true);\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).triangleBlur(radius).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.push({\r\n            tool: [\"filter\", \"glBlur\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {eventResMs} from './filters-consts';\r\nimport {KlSlider} from '../ui/base-components/kl-slider';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {getSharedFx} from './shared-gl-fx';\r\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\n\r\nexport const glUnsharpMask = {\r\n\r\n    getDialog(params: IFilterGetDialogParam) {\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\r\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\r\n        let w = Math.min(displayW, context.canvas.width);\r\n        let h = Math.min(displayH, context.canvas.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (w > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n        let previewFactor = w / context.canvas.width;\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n\r\n        function finishInit() {\r\n            let radius = 2, strength = 5.1 / 10;\r\n            div.innerHTML = LANG('filter-unsharp-mask-description') + \"<br/><br/>\";\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n\r\n            let radiusSlider = new KlSlider({\r\n                label: LANG('radius'),\r\n                width: 300,\r\n                height: 30,\r\n                min: 0,\r\n                max: 200,\r\n                initValue: 2,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    radius = val;\r\n                    glCanvas.draw(texture).unsharpMask(radius * previewFactor, strength).update();\r\n                    klCanvasPreview.render();\r\n                },\r\n                curve: [[0, 0], [0.1, 2], [0.5, 50], [1, 200]]\r\n            });\r\n            let strengthSlider = new KlSlider({\r\n                label: LANG('filter-unsharp-mask-strength'),\r\n                width: 300,\r\n                height: 30,\r\n                min: 0,\r\n                max: 50,\r\n                initValue: 5.1,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    strength = val / 10;\r\n                    glCanvas.draw(texture).unsharpMask(radius * previewFactor, strength).update();\r\n                    klCanvasPreview.render();\r\n                },\r\n                curve: [[0, 0], [0.1, 2], [0.5, 10], [1, 50]]\r\n            });\r\n            radiusSlider.getElement().style.marginBottom = \"10px\";\r\n            div.appendChild(radiusSlider.getElement());\r\n            div.appendChild(strengthSlider.getElement());\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            BB.css(previewWrapper, {\r\n                width: \"340px\",\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr: IKlBasicLayer[] = [];\r\n            {\r\n                for (let i = 0; i < layers.length; i++) {\r\n                    previewLayerArr.push({\r\n                        image: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            let klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + displayW),\r\n                height: parseInt('' + displayH),\r\n                layers: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + displayW) + 'px',\r\n                    height: parseInt('' + displayH) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n\r\n            div.appendChild(previewWrapper);\r\n\r\n            try {\r\n                glCanvas.draw(texture).unsharpMask(radius * previewFactor, strength).update();\r\n                klCanvasPreview.render();\r\n            } catch(e) {\r\n                (div as any).errorCallback(e);\r\n            }\r\n\r\n            result.destroy = () => {\r\n                radiusSlider.destroy();\r\n                strengthSlider.destroy();\r\n                texture.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    radius: radius,\r\n                    strength: strength\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1);\r\n\r\n        return result;\r\n    },\r\n\r\n\r\n    apply(params: IFilterApply) {\r\n        let context = params.context;\r\n        let history = params.history;\r\n        let radius = params.input.radius;\r\n        let strength = params.input.strength;\r\n        if (!context || radius === null || strength === null || !history)\r\n            return false;\r\n        history.pause(true);\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).unsharpMask(radius, strength).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.push({\r\n            tool: [\"filter\", \"glUnsharpMask\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {Options} from '../ui/base-components/options';\r\nimport {ColorOptions} from '../ui/base-components/color-options';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {getSharedFx} from './shared-gl-fx';\r\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\r\nimport {LANG} from '../../language/language';\r\n\r\nexport const toAlpha = {\r\n\r\n    getDialog(params: IFilterGetDialogParam) {\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\r\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (tempCanvas.width > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n\r\n        function finishInit() {\r\n            let radius = 2, strength = 5.1 / 10;\r\n            div.appendChild(BB.el({\r\n                content: LANG('filter-to-alpha-description'),\r\n                css: {\r\n                    marginBottom: '5px'\r\n                }\r\n            }));\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n\r\n            function updatePreview() {\r\n                glCanvas.draw(texture).toAlpha(sourceId === 'inverted-luminance', selectedRgbaObj).update();\r\n                klCanvasPreview.render();\r\n            }\r\n\r\n            // source\r\n            let sourceId = 'inverted-luminance';\r\n            let sourceOptions = new Options({\r\n                optionArr: [\r\n                    {\r\n                        id: 'inverted-luminance',\r\n                        label: LANG('filter-to-alpha-inverted-lum')\r\n                    },\r\n                    {\r\n                        id: 'luminance',\r\n                        label: LANG('filter-to-alpha-lum')\r\n                    }\r\n                ],\r\n                initialId: sourceId,\r\n                onChange: function(id) {\r\n                    sourceId = id;\r\n                    updatePreview();\r\n                }\r\n            });\r\n            div.appendChild(sourceOptions.getElement());\r\n\r\n            // color\r\n            let selectedRgbaObj = {r: 0, g: 0, b: 0, a: 1};\r\n            let colorOptionsArr = [\r\n                null,\r\n                {r: 0, g: 0, b: 0, a: 1},\r\n                {r: 255, g: 255, b: 255, a: 1}\r\n            ];\r\n            colorOptionsArr.push({\r\n                r: params.currentColorRgb.r,\r\n                g: params.currentColorRgb.g,\r\n                b: params.currentColorRgb.b,\r\n                a: 1,\r\n            });\r\n            colorOptionsArr.push({\r\n                r: params.secondaryColorRgb.r,\r\n                g: params.secondaryColorRgb.g,\r\n                b: params.secondaryColorRgb.b,\r\n                a: 1,\r\n            });\r\n\r\n            let colorOptions = new ColorOptions({\r\n                label: LANG('filter-to-alpha-replace'),\r\n                colorArr: colorOptionsArr,\r\n                initialIndex: 1,\r\n                onChange: function(rgbaObj) {\r\n                    selectedRgbaObj = rgbaObj;\r\n                    updatePreview();\r\n                }\r\n            });\r\n            colorOptions.getElement().style.marginTop = '10px';\r\n            div.appendChild(colorOptions.getElement());\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            BB.css(previewWrapper, {\r\n                width: \"340px\",\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr: IKlBasicLayer[] = [];\r\n            {\r\n                for (let i = 0; i < layers.length; i++) {\r\n                    previewLayerArr.push({\r\n                        image: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            let klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + w),\r\n                height: parseInt('' + h),\r\n                layers: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + w) + 'px',\r\n                    height: parseInt('' + h) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n\r\n            div.appendChild(previewWrapper);\r\n\r\n            setTimeout(function() { //ie has a problem otherwise...\r\n                try {\r\n                    updatePreview();\r\n                } catch(e) {\r\n                    (div as any).errorCallback(e);\r\n                }\r\n            }, 1);\r\n\r\n            result.destroy = () => {\r\n                texture.destroy();\r\n                sourceOptions.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    sourceId: sourceId,\r\n                    selectedRgbaObj: selectedRgbaObj\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1);\r\n\r\n        return result;\r\n    },\r\n\r\n\r\n    apply(params: IFilterApply) {\r\n        let context = params.context;\r\n        let history = params.history;\r\n        let sourceId = params.input.sourceId;\r\n        let selectedRgbaObj = params.input.selectedRgbaObj;\r\n        if (!context || !sourceId || !history)\r\n            return false;\r\n        history.pause(true);\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).toAlpha(sourceId === 'inverted-luminance', selectedRgbaObj).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.push({\r\n            tool: [\"filter\", \"toAlpha\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {KL} from '../kl';\r\nimport {KlCanvas} from '../canvas/kl-canvas';\r\n\r\nexport async function klCanvasToPsdBlob(klCanvas: KlCanvas): Promise<Blob> {\r\n    let layerArr = klCanvas.getLayersFast();\r\n\r\n    let psdConfig = {\r\n        width: klCanvas.getWidth(),\r\n        height: klCanvas.getHeight(),\r\n        //canvas: klCanvas.getCompleteCanvas(1), // preview, can be skipped\r\n        children: []\r\n    };\r\n    for (let i = 0; i < layerArr.length; i++) {\r\n        // todo - can be optimized if layer mostly empty\r\n        let item = layerArr[i];\r\n        psdConfig.children.push({\r\n            name: item.name,\r\n            opacity: item.opacity,\r\n            canvas: item.canvas,\r\n            blendMode: KL.PSD.blendKlToPsd(item.mixModeStr),\r\n            left: 0,\r\n            top: 0\r\n        });\r\n    }\r\n\r\n    let agPsd = await import('ag-psd');\r\n    let buffer = agPsd.writePsdBuffer(psdConfig);\r\n    return new Blob([buffer], { type: 'application/octet-stream' });\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"k9Nks\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"bBxqy\");"],"names":["$d2fa9a947070c225$export$a84540bc8b694b2d","p","klApp","agPsd","onProjectReady","project","isInitialized","Error","saveReminder","$5ngYX","SaveReminder","$gWfkn","klHistory","isDrawing","$3C7jC","KlApp","bottomBar","aboutEl","embed","url","embedUrl","onSubmit","init","loadingScreenEl","parentNode","removeChild","loadingScreenTextEl","document","body","appendChild","getEl","e","textContent","className","console","error","psdQueue","getElementById","$1mH1z","LANG","this","openProject","initError","getPNG","getPSD","$4gaLD","asyncToGenerator","$parcel$interopDefault","$cijLd","mark","_callee","readPSDs","psds","length","readItem","item","psd","readPsd","blob","$941rU","klPsdToKlProject","callback","forEach","parcelRequire","_ctx","sent","shift","push","Element","prototype","Object","defineProperty","value","x","y","scrollLeft","scrollTop","window","getItem","setItem","removeItem","$946de144e151ce6f$var$HIDDEN","$7Sc7b","$946de144e151ce6f$var$SYMBOL","$946de144e151ce6f$var$TO_PRIMITIVE","$8RiFY","$946de144e151ce6f$var$setInternalState","$jUSxl","set","$946de144e151ce6f$var$getInternalState","getterFor","$946de144e151ce6f$var$ObjectPrototype","$946de144e151ce6f$var$$Symbol","$6LGrQ","Symbol","$946de144e151ce6f$var$SymbolPrototype","$946de144e151ce6f$var$TypeError","TypeError","$946de144e151ce6f$var$QObject","QObject","$946de144e151ce6f$var$$stringify","$fdCuf","$946de144e151ce6f$var$nativeGetOwnPropertyDescriptor","$l0gwz","f","$946de144e151ce6f$var$nativeDefineProperty","$bLi0c","$946de144e151ce6f$var$nativeGetOwnPropertyNames","$8Ybf3","$946de144e151ce6f$var$nativePropertyIsEnumerable","$7wvbV","$946de144e151ce6f$var$push","$2x0T1","$946de144e151ce6f$var$AllSymbols","$eW5R0","$946de144e151ce6f$var$ObjectPrototypeSymbols","$946de144e151ce6f$var$StringToSymbolRegistry","$946de144e151ce6f$var$SymbolToStringRegistry","$946de144e151ce6f$var$WellKnownSymbolsStore","$946de144e151ce6f$var$USE_SETTER","findChild","$946de144e151ce6f$var$setSymbolDescriptor","$A56Kx","$6WghJ","$KFLt0","get","a","O","P","Attributes","ObjectPrototypeDescriptor","$946de144e151ce6f$var$wrap","tag","description","symbol","type","$946de144e151ce6f$var$$defineProperty","$edAQb","key","$hvgHk","$1JB0D","enumerable","$eqpEX","$946de144e151ce6f$var$$defineProperties","Properties","properties","$hAcvu","keys","$8xgUB","concat","$946de144e151ce6f$var$$getOwnPropertySymbols","$9ZRgk","$946de144e151ce6f$var$$propertyIsEnumerable","V","$946de144e151ce6f$var$$getOwnPropertyDescriptor","it","descriptor","$946de144e151ce6f$var$$getOwnPropertyNames","names","result","$8OCuI","IS_OBJECT_PROTOTYPE","$OTdcX","$c9sXY","arguments","undefined","$eXtvS","$VN1JY","setter","configurable","$8Opqg","$jDguE","$9hrSE","$b9pdI","$btl60","name","$bMhTS","unsafe","$JGbI2","global","wrap","forced","sham","$aUpwE","target","stat","for","string","keyFor","sym","$fcVIX","useSetter","useSimple","create","defineProperties","getOwnPropertyDescriptor","getOwnPropertyNames","getOwnPropertySymbols","$falgx","stringify","replacer","space","args","$1fDSm","$replacer","$gczVK","$gVpis","$3HoBU","$cn22k","$946de144e151ce6f$var$valueOf","valueOf","hint","$9Ebr8","module","exports","options","source","targetProperty","sourceProperty","TARGET","GLOBAL","STATIC","$7eUfi","noTargetGet","$0894edb6be15987f$require$getOwnPropertyDescriptor","$iTHz4","typeOf","$jzDTf","$8ihId","$4ed80f2f712c1a8e$var$check","Math","globalThis","self","$parcel$global","Function","$f4a66a6ea03eaec6$export$2d1720544b23b823","$f4a66a6ea03eaec6$var$$getOwnPropertyDescriptor","$k9fAW","exec","$7473205dfab1fa23$var$call","call","$10M9V","bind","apply","test","hasOwnProperty","$57a3b7844b6c90ba$export$2d1720544b23b823","$57a3b7844b6c90ba$var$$propertyIsEnumerable","propertyIsEnumerable","$57a3b7844b6c90ba$var$getOwnPropertyDescriptor","$57a3b7844b6c90ba$var$NASHORN_BUG","bitmap","writable","$atLuV","$0dsEW","$7a1174e1fb228c6f$var$Object","$7a1174e1fb228c6f$var$split","split","$lrHHl","$1d7f59e44aff4a7a$var$FunctionPrototype","$1d7f59e44aff4a7a$var$bind","$1d7f59e44aff4a7a$var$call","$1d7f59e44aff4a7a$var$uncurryThis","fn","$f9ce0419d22a9ab2$var$toString","toString","$f9ce0419d22a9ab2$var$stringSlice","slice","$000a71535b8a0314$var$TypeError","argument","$ePlFm","$acb6a29183ca6e75$var$TypeError","$acb6a29183ca6e75$var$TO_PRIMITIVE","input","pref","exoticToPrim","$3Xhmk","$a2dhY","$b124c0d396db18ae$var$Object","$e4Dh9","$Symbol","$b145ec9fce0e97f9$var$aFunction","namespace","method","isPrototypeOf","iterator","String","$ipWH0","$d68816eb2fa7297b$var$match","$d68816eb2fa7297b$var$version","$d68816eb2fa7297b$var$process","process","$d68816eb2fa7297b$var$Deno","Deno","$d68816eb2fa7297b$var$versions","versions","version","$d68816eb2fa7297b$var$v8","v8","$2F7Zt","match","func","$lEpkd","$fc30fa73bab9ad2c$var$TypeError","$dth1M","$9ceb31273476e724$var$String","$74e4662ec9137ae3$var$TypeError","val","$6731c29e73be8b43$var$WellKnownSymbolsStore","$6731c29e73be8b43$var$Symbol","$6731c29e73be8b43$var$symbolFor","$6731c29e73be8b43$var$createWellKnownSymbol","withoutSetter","$gt9ls","mode","copyright","license","$bfd69a856f043d4f$var$SHARED","$bfd69a856f043d4f$var$store","$5455786d6561d0c9$var$defineProperty","$1436b3ae35d8e28e$var$hasOwnProperty","hasOwn","$b0a8491bce44604f$var$Object","$0adb5abdb2d94f92$var$id","$0adb5abdb2d94f92$var$postfix","random","$0adb5abdb2d94f92$var$toString","$ckGOu","$8fa89027f48a411a$var$document","$8fa89027f48a411a$var$EXISTS","createElement","object","$89020c597992b0a8$export$2d1720544b23b823","$89020c597992b0a8$var$TypeError","$89020c597992b0a8$var$$defineProperty","$89020c597992b0a8$var$$getOwnPropertyDescriptor","$89020c597992b0a8$var$ENUMERABLE","$89020c597992b0a8$var$CONFIGURABLE","$89020c597992b0a8$var$WRITABLE","$8U1TM","current","$a59edb5b2fd2788a$var$String","$a59edb5b2fd2788a$var$TypeError","CONFIGURABLE","$66a6b6a20211ca84$var$getInternalState","$66a6b6a20211ca84$var$enforceInternalState","enforce","$66a6b6a20211ca84$var$TEMPLATE","state","simple","replace","$66a6b6a20211ca84$require$CONFIGURABLE_FUNCTION_NAME","join","$3jbTY","$268c60e1efd01107$var$functionToString","inspectSource","$e7fd8d2701a52c10$var$set","$e7fd8d2701a52c10$var$get","$e7fd8d2701a52c10$var$has","$e7fd8d2701a52c10$var$OBJECT_ALREADY_INITIALIZED","$e7fd8d2701a52c10$var$TypeError","$e7fd8d2701a52c10$var$WeakMap","WeakMap","$g10oc","$e7fd8d2701a52c10$var$store","$e7fd8d2701a52c10$var$wmget","$e7fd8d2701a52c10$var$wmhas","has","$e7fd8d2701a52c10$var$wmset","metadata","facade","$e7fd8d2701a52c10$var$STATE","TYPE","$ba8d0aab92e243b6$var$WeakMap","$5bb6f9496df13346$var$keys","$8e6a0786b4ae9728$var$FunctionPrototype","$8e6a0786b4ae9728$var$getDescriptor","$8e6a0786b4ae9728$var$EXISTS","$8e6a0786b4ae9728$var$PROPER","$8e6a0786b4ae9728$var$CONFIGURABLE","EXISTS","PROPER","exceptions","$6qoE5","i","$4ad849db11f07af0$var$concat","$6c1b54106766ccdc$export$2d1720544b23b823","$6c1b54106766ccdc$var$hiddenKeys","$19Y1f","indexOf","$0d85303cf0728b08$var$push","$0d85303cf0728b08$require$indexOf","$fbdcaa2c8ce11a12$var$createMethod","IS_INCLUDES","$this","el","fromIndex","$9u6Bu","index","$8BhlN","includes","$642f3ce21d97ba11$var$max","max","$642f3ce21d97ba11$var$min","min","integer","$3Hjrl","$2b1477a1a3486b52$var$ceil","ceil","$2b1477a1a3486b52$var$floor","floor","number","obj","$k8phS","$ea882b862bf27474$var$min","$81e41929279a1d56$export$2d1720544b23b823","$dc1f2810a56598f1$var$replacement","$dc1f2810a56598f1$var$isForced","feature","detection","$dc1f2810a56598f1$var$data","$dc1f2810a56598f1$var$normalize","$dc1f2810a56598f1$var$POLYFILL","$dc1f2810a56598f1$var$NATIVE","normalize","toLowerCase","data","NATIVE","POLYFILL","$90193670beecd49b$var$FunctionPrototype","$90193670beecd49b$var$apply","$90193670beecd49b$var$call","Reflect","Array","isArray","$ae3d7814aa7be7fa$var$String","$cKQyt","$94928c40ef066db6$var$TO_STRING_TAG","$94928c40ef066db6$var$Object","$94928c40ef066db6$var$CORRECT_ARGUMENTS","$kDzjR","$94928c40ef066db6$var$tryGet","callee","$f062d8d8626aa8c7$var$test","$08c4b1923d6666ef$var$activeXDocument","$08c4b1923d6666ef$var$IE_PROTO","$08c4b1923d6666ef$var$EmptyConstructor","$08c4b1923d6666ef$var$scriptTag","content","$08c4b1923d6666ef$var$LT","$08c4b1923d6666ef$var$NullProtoObjectViaActiveX","activeXDocument","write","close","temp","parentWindow","$08c4b1923d6666ef$var$NullProtoObject","ActiveXObject","iframeDocument","iframe","domain","style","display","$25rlX","src","contentWindow","open","F","$hwdBV","$e4ae7418ddbfa74e$export$2d1720544b23b823","props","$687ca5bb09d467a5$export$2d1720544b23b823","$687ca5bb09d467a5$var$windowNames","$687ca5bb09d467a5$require$$getOwnPropertyNames","$b4zeJ","$687ca5bb09d467a5$var$getWindowNames","$80fb66adf7e0f99e$var$Array","$80fb66adf7e0f99e$var$max","start","end","k","fin","n","$9MkWL","propertyKey","$85a2c45afa04bf4c$export$2d1720544b23b823","NAME","$lEmA0","$7f12ef32d76ce306$require$defineProperty","$7060b89199bc6626$var$TO_STRING_TAG","TAG","$7060b89199bc6626$require$defineProperty","$6d6d9e1ac7090127$var$push","$6d6d9e1ac7090127$var$createMethod","IS_MAP","IS_FILTER","IS_SOME","IS_EVERY","IS_FIND_INDEX","IS_FILTER_REJECT","NO_HOLES","callbackfn","that","specificCreate","boundFunction","$gAXAR","$ab5jG","map","filter","some","every","find","findIndex","filterReject","$c14e3c307d6614b8$var$bind","originalArray","$kMN3P","$f21e58c4eb8182a8$var$SPECIES","$f21e58c4eb8182a8$var$Array","C","constructor","$iHD1w","$d9da836f9a560c1d$var$noop","$d9da836f9a560c1d$var$empty","$d9da836f9a560c1d$var$construct","$d9da836f9a560c1d$var$constructorRegExp","$d9da836f9a560c1d$var$exec","$d9da836f9a560c1d$var$INCORRECT_TO_STRING","$d9da836f9a560c1d$var$isConstructorModern","$d9da836f9a560c1d$var$isConstructorLegacy","called","$95058444ce44b672$var$NativeSymbol","$95058444ce44b672$var$SymbolPrototype","$95058444ce44b672$var$EmptyStringDescriptionStore","$95058444ce44b672$var$SymbolWrapper","$95058444ce44b672$var$NATIVE_SYMBOL","$95058444ce44b672$var$symbolToString","$95058444ce44b672$var$symbolValueOf","$95058444ce44b672$var$regexp","$95058444ce44b672$var$replace","$95058444ce44b672$var$stringSlice","desc","$06d708477fabbc3c$var$IS_CONCAT_SPREADABLE","$06d708477fabbc3c$var$MAX_SAFE_INTEGER","$06d708477fabbc3c$var$MAXIMUM_ALLOWED_INDEX_EXCEEDED","$06d708477fabbc3c$var$TypeError","$06d708477fabbc3c$var$IS_CONCAT_SPREADABLE_SUPPORT","array","$06d708477fabbc3c$var$SPECIES_SUPPORT","$4SJPo","$06d708477fabbc3c$var$isConcatSpreadable","spreadable","proto","arg","len","E","A","$38dfc10b7d062b7d$var$SPECIES","METHOD_NAME","foo","Boolean","copyWithin","$04UlN","$d9AHO","$00ec15e2e443b0ba$var$min","to","from","count","inc","$9938969e81eeb096$var$UNSCOPABLES","$9938969e81eeb096$var$ArrayPrototype","fill","$5QjeM","argumentsLength","endPos","$de1f2425280a5550$require$$filter","$d33f22fb1838a81f$var$FIND","$d33f22fb1838a81f$var$SKIPS_HOLES","$d33f22fb1838a81f$require$$find","$3cfa9a6590676def$var$FIND_INDEX","$3cfa9a6590676def$var$SKIPS_HOLES","$3cfa9a6590676def$require$$findIndex","flat","depthArg","sourceLen","$3GD8y","$2af3a71f27ab42a8$var$TypeError","$2af3a71f27ab42a8$var$flattenIntoArray","original","depth","mapper","thisArg","element","elementLen","targetIndex","sourceIndex","mapFn","flatMap","$dNJyV","iterable","$jvovY","$e333eda9c4fee069$var$Array","arrayLike","IS_CONSTRUCTOR","mapfn","mapping","step","next","iteratorMethod","$aCNH3","$9WXOl","$g3ZOP","done","$9XuUh","ENTRIES","$eYYfs","kind","innerResult","innerError","$73e7ed092b9c800c$var$ITERATOR","$73e7ed092b9c800c$var$ArrayPrototype","$csbVC","$bb1ce10fd36d041e$var$TypeError","usingIterator","$7bc40018221d6442$var$ITERATOR","$a0c331ad1c26b999$var$ITERATOR","$a0c331ad1c26b999$var$SAFE_CLOSING","$a0c331ad1c26b999$var$called","$a0c331ad1c26b999$var$iteratorWithReturn","return","SKIP_CLOSING","ITERATION_SUPPORT","$4c66802a9a219c77$require$$includes","$5bc31975d32d2345$var$un$IndexOf","$5bc31975d32d2345$var$NEGATIVE_ZERO","$5bc31975d32d2345$var$STRICT_METHOD","$orWZn","searchElement","$5bc31975d32d2345$require$$IndexOf","$f56abe53ba5eb975$var$ARRAY_ITERATOR","$f56abe53ba5eb975$var$setInternalState","$f56abe53ba5eb975$var$getInternalState","$A0wh1","iterated","$f56abe53ba5eb975$var$values","Arguments","$06c3c413d837e89a$var$PROPER_FUNCTION_NAME","$ce4aN","$06c3c413d837e89a$var$CONFIGURABLE_FUNCTION_NAME","$06c3c413d837e89a$var$IteratorPrototype","$aGk5W","IteratorPrototype","$06c3c413d837e89a$var$BUGGY_SAFARI_ITERATORS","BUGGY_SAFARI_ITERATORS","$06c3c413d837e89a$var$ITERATOR","$06c3c413d837e89a$var$KEYS","$06c3c413d837e89a$var$VALUES","$06c3c413d837e89a$var$ENTRIES","$06c3c413d837e89a$var$returnThis","Iterable","IteratorConstructor","DEFAULT","IS_SET","FORCED","$bGPs6","CurrentIteratorPrototype","methods","KEY","getIterationMethod","KIND","defaultIterator","IterablePrototype","TO_STRING_TAG","INCORRECT_VALUES_NAME","nativeIterator","anyNativeIterator","entries","$f4X4V","$4HLYu","values","$882b874f0aebd4cd$var$returnThis","ENUMERABLE_NEXT","$882b874f0aebd4cd$require$IteratorPrototype","$7c6d6a0dfcded862$var$IteratorPrototype","$7c6d6a0dfcded862$var$PrototypeOfArrayIteratorPrototype","$7c6d6a0dfcded862$var$arrayIterator","$7c6d6a0dfcded862$var$ITERATOR","$7c6d6a0dfcded862$var$BUGGY_SAFARI_ITERATORS","$afa50e7eae6435d2$var$IE_PROTO","$afa50e7eae6435d2$var$Object","$afa50e7eae6435d2$var$ObjectPrototype","$khrDL","getPrototypeOf","setPrototypeOf","CORRECT_SETTER","$iHaUn","__proto__","$d9c4b44ded233f44$var$String","$d9c4b44ded233f44$var$TypeError","$bc16be61500a9223$var$un$Join","$bc16be61500a9223$var$ES3_STRINGS","$bc16be61500a9223$var$STRICT_METHOD","separator","$hYbqA","lastIndexOf","$d150e79cf147dfb5$var$min","$d150e79cf147dfb5$var$$lastIndexOf","$d150e79cf147dfb5$var$NEGATIVE_ZERO","$d150e79cf147dfb5$var$STRICT_METHOD","$d150e79cf147dfb5$var$FORCED","$a9cf0fb5298318c9$require$$map","$afe503e80150048b$var$Array","of","left","$bVA4J","reduce","$77f91bc8c728543f$require$$reduce","$77ace5066f55ab98$var$TypeError","$77ace5066f55ab98$var$createMethod","IS_RIGHT","memo","right","reduceRight","$8e76da0addb6c606$require$$reduceRight","$c69e6770946c52af$var$un$Reverse","reverse","$c69e6770946c52af$var$test","$ea74985d703c2784$var$HAS_SPECIES_SUPPORT","$ea74985d703c2784$var$SPECIES","$ea74985d703c2784$var$Array","$ea74985d703c2784$var$max","Constructor","$6d981ef59a83a93b$var$test","$6d981ef59a83a93b$var$un$Sort","sort","$6d981ef59a83a93b$var$push","$6d981ef59a83a93b$var$FAILS_ON_UNDEFINED","$6d981ef59a83a93b$var$FAILS_ON_NULL","$6d981ef59a83a93b$var$STRICT_METHOD","$6d981ef59a83a93b$var$STABLE_SORT","$efWWg","$gucwG","$3M0bw","code","chr","fromCharCode","v","b","charAt","comparefn","itemsLength","items","arrayLength","$c3NuZ","$6d981ef59a83a93b$var$getSortCompare","$8c7c294a48fbd5f0$var$floor","$8c7c294a48fbd5f0$var$mergeSort","middle","$8c7c294a48fbd5f0$var$insertionSort","$8c7c294a48fbd5f0$var$merge","j","llength","rlength","lindex","rindex","$a6102f65caba9398$var$firefox","$2bf5ff846ca490e5$var$webkit","$b5zq9","$812ba325d699cdbe$var$SPECIES","CONSTRUCTOR_NAME","$94e9d0a062f4242a$var$HAS_SPECIES_SUPPORT","$94e9d0a062f4242a$var$TypeError","$94e9d0a062f4242a$var$max","$94e9d0a062f4242a$var$min","$94e9d0a062f4242a$var$MAX_SAFE_INTEGER","$94e9d0a062f4242a$var$MAXIMUM_ALLOWED_LENGTH_EXCEEDED","splice","deleteCount","insertCount","actualDeleteCount","actualStart","$aef8fd70a5e40999$var$ARRAY_BUFFER","$aef8fd70a5e40999$var$ArrayBuffer","$h6ot1","ArrayBuffer","$c735f9db77db5a68$var$PROPER_FUNCTION_NAME","$c735f9db77db5a68$var$CONFIGURABLE_FUNCTION_NAME","$c735f9db77db5a68$var$getInternalState","$c735f9db77db5a68$var$setInternalState","$c735f9db77db5a68$var$ARRAY_BUFFER","$c735f9db77db5a68$var$DATA_VIEW","$c735f9db77db5a68$var$WRONG_INDEX","$c735f9db77db5a68$var$NativeArrayBuffer","$c735f9db77db5a68$var$$ArrayBuffer","$c735f9db77db5a68$var$ArrayBufferPrototype","$c735f9db77db5a68$var$$DataView","$c735f9db77db5a68$var$DataViewPrototype","$c735f9db77db5a68$var$ObjectPrototype","$c735f9db77db5a68$var$Array","$c735f9db77db5a68$var$RangeError","RangeError","$c735f9db77db5a68$var$fill","$c735f9db77db5a68$var$reverse","$c735f9db77db5a68$var$packIEEE754","$4JHSt","pack","$c735f9db77db5a68$var$unpackIEEE754","unpack","$c735f9db77db5a68$var$packInt8","$c735f9db77db5a68$var$packInt16","$c735f9db77db5a68$var$packInt32","$c735f9db77db5a68$var$unpackInt32","buffer","$c735f9db77db5a68$var$packFloat32","$c735f9db77db5a68$var$packFloat64","$c735f9db77db5a68$var$addGetter","$c735f9db77db5a68$var$get","view","isLittleEndian","intIndex","$75wCi","store","byteLength","bytes","byteOffset","$c735f9db77db5a68$var$set","conversion","$7jUo8","$c735f9db77db5a68$var$INCORRECT_ARRAY_BUFFER_NAME","NaN","$lIgln","$c735f9db77db5a68$var$key","$c735f9db77db5a68$var$keys","$c735f9db77db5a68$require$getOwnPropertyNames","$c735f9db77db5a68$var$j","$c735f9db77db5a68$var$testView","$c735f9db77db5a68$var$$setInt8","setInt8","getInt8","$g2jnF","setUint8","bufferLength","offset","getUint8","getInt16","getUint16","getInt32","getUint32","getFloat32","getFloat64","setInt16","setUint16","setInt32","setUint32","setFloat32","setFloat64","DataView","$fcea6295360a95aa$var$TypeError","Prototype","$52924d0b004d36a8$var$RangeError","$372d6692f9dc6c25$var$Array","$372d6692f9dc6c25$var$abs","abs","$372d6692f9dc6c25$var$pow","pow","$372d6692f9dc6c25$var$floor","$372d6692f9dc6c25$var$log","log","$372d6692f9dc6c25$var$LN2","LN2","mantissaLength","exponent","mantissa","c","exponentLength","eMax","eBias","rt","sign","Infinity","nBits","$ca7e867aeefa82f6$var$ArrayBuffer","$ca7e867aeefa82f6$var$DataView","$ca7e867aeefa82f6$var$DataViewPrototype","$ca7e867aeefa82f6$var$un$ArrayBufferSlice","$ca7e867aeefa82f6$var$getUint8","$ca7e867aeefa82f6$var$setUint8","first","$4xaB6","viewSource","viewTarget","$34d276f1cc0e9c1f$var$SPECIES","defaultConstructor","S","$3Z9Nz","$2e6eab6702fa1b0e$var$TypeError","Date","toJSON","toISOString","pv","isFinite","$5e86d5cf2559ab75$var$TO_PRIMITIVE","$5e86d5cf2559ab75$var$DatePrototype","$heBc3","$c8c0985652775684$var$TypeError","$6f7d5205848dd522$var$HAS_INSTANCE","$6f7d5205848dd522$var$FunctionPrototype","$bd587bdd09f5fb4c$var$FunctionPrototype","$bd587bdd09f5fb4c$var$functionToString","$bd587bdd09f5fb4c$var$nameRE","$bd587bdd09f5fb4c$var$regExpExec","$bd587bdd09f5fb4c$require$FUNCTION_NAME_EXISTS","$bd587bdd09f5fb4c$require$defineProperty","JSON","$6P8eJ","wrapper","common","IS_WEAK","ADDER","NativeConstructor","NativePrototype","exported","fixMethod","uncurriedNativeMethod","getConstructor","$7ahyY","enable","instance","HASNT_CHAINING","THROWS_ON_PRIMITIVES","ACCEPT_ITERABLES","BUGGY_ZERO","$instance","dummy","$4nT4Z","$d8pty","AS_ENTRIES","clear","setStrong","$5377173f5423bfef$var$REQUIRED","$5377173f5423bfef$var$METADATA","$5377173f5423bfef$var$id","$5377173f5423bfef$var$setMetadata","objectID","weakData","$5377173f5423bfef$var$meta","fastKey","$kneZa","getWeakData","onFreeze","$6jxZs","$ed519476a2f6c474$var$$isExtensible","isExtensible","$ed519476a2f6c474$var$FAILS_ON_PRIMITIVES","$8Chxf","preventExtensions","$98ffc8a58644c09f$var$TypeError","$98ffc8a58644c09f$var$Result","stopped","$98ffc8a58644c09f$var$ResultPrototype","unboundFunction","iterFn","IS_ITERATOR","INTERRUPTED","stop","condition","callFn","Wrapper","NewTarget","NewTargetPrototype","$c52cbfa92a8c3afc$var$setInternalState","$c52cbfa92a8c3afc$var$internalStateGetterFor","last","size","getInternalState","define","previous","entry","getEntry","$c52cbfa92a8c3afc$require$fastKey","removed","delete","prev","add","$c52cbfa92a8c3afc$require$defineProperty","ITERATOR_NAME","getInternalCollectionState","getInternalIteratorState","$de3580f95004286b$var$$acosh","acosh","$de3580f95004286b$var$log","$de3580f95004286b$var$sqrt","sqrt","$de3580f95004286b$var$LN2","Number","MAX_VALUE","$dVGex","$a2415beeb773b741$var$log","log1p","$2ef2ab175d68371d$var$$asinh","asinh","$2ef2ab175d68371d$var$log","$2ef2ab175d68371d$var$sqrt","$2ef2ab175d68371d$var$asinh","$51de6475ea62667d$var$$atanh","atanh","$51de6475ea62667d$var$log","$877700f786d3b071$var$abs","$877700f786d3b071$var$pow","cbrt","$fAbqV","$4d5bac8103272b52$var$floor","$4d5bac8103272b52$var$log","$4d5bac8103272b52$var$LOG2E","LOG2E","clz32","$c557c2f9fd85eb3a$var$$cosh","cosh","$c557c2f9fd85eb3a$var$abs","$c557c2f9fd85eb3a$var$E","t","$aXV8O","$7fbbbd2218a8aa4f$var$$expm1","expm1","$7fbbbd2218a8aa4f$var$exp","exp","fround","$f2b854d554808773$var$abs","$f2b854d554808773$var$pow","$f2b854d554808773$var$EPSILON","$f2b854d554808773$var$EPSILON32","$f2b854d554808773$var$MAX32","$f2b854d554808773$var$MIN32","$abs","$sign","$e0b4e047d893fcf8$var$$hypot","hypot","$e0b4e047d893fcf8$var$abs","$e0b4e047d893fcf8$var$sqrt","value1","value2","div","sum","aLen","larg","$48b0e6bcf6649d46$var$$imul","imul","UINT16","xn","yn","xl","yl","log10","$5e028cd5a1d92290$var$log","$5e028cd5a1d92290$var$LOG10E","LOG10E","$0d53237d08355bc5$var$log","$0d53237d08355bc5$var$LN2","log2","$9c130dae4f446bfc$var$abs","$9c130dae4f446bfc$var$exp","$9c130dae4f446bfc$var$E","sinh","$c49f9a2aa1cac773$var$exp","tanh","$5b6a67b5c1a51dc7$var$ceil","$5b6a67b5c1a51dc7$var$floor","trunc","trim","$b06f634510db1b10$var$NUMBER","$b06f634510db1b10$var$NativeNumber","$b06f634510db1b10$var$NumberPrototype","$b06f634510db1b10$var$TypeError","$b06f634510db1b10$var$arraySlice","$b06f634510db1b10$var$charCodeAt","charCodeAt","$b06f634510db1b10$var$toNumeric","primValue","$b06f634510db1b10$var$toNumber","third","radix","maxCode","digits","$b06f634510db1b10$require$trim","parseInt","$b06f634510db1b10$var$key","$b06f634510db1b10$var$NumberWrapper","$dBMLl","$b06f634510db1b10$var$keys","$b06f634510db1b10$require$getOwnPropertyNames","$b06f634510db1b10$var$j","$b06f634510db1b10$require$defineProperty","$b06f634510db1b10$require$getOwnPropertyDescriptor","$9304af073e986fbc$var$replace","$9304af073e986fbc$var$whitespace","$eJCyU","$9304af073e986fbc$var$ltrim","RegExp","$9304af073e986fbc$var$rtrim","$9304af073e986fbc$var$createMethod","EPSILON","$3720d9a264c3b676$var$globalIsFinite","isInteger","$a29d3ec5df192b8d$var$floor","isNaN","$b05bbdede92fb15b$var$abs","isSafeInteger","$dXAGN","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","parseFloat","$hpuGp","$cacc9274dbcca3bc$var$charAt","$cacc9274dbcca3bc$var$n$ParseFloat","$cacc9274dbcca3bc$var$Symbol","$cacc9274dbcca3bc$var$ITERATOR","$cacc9274dbcca3bc$var$FORCED","trimmedString","$cacc9274dbcca3bc$require$trim","$9W5cg","$73bd8fcb3027a7db$var$$parseInt","$73bd8fcb3027a7db$var$Symbol","$73bd8fcb3027a7db$var$ITERATOR","$73bd8fcb3027a7db$var$hex","$73bd8fcb3027a7db$var$exec","$73bd8fcb3027a7db$var$FORCED","$73bd8fcb3027a7db$require$trim","$4e1f642ad95f55f9$var$RangeError","$4e1f642ad95f55f9$var$String","$4e1f642ad95f55f9$var$floor","$4e1f642ad95f55f9$var$repeat","$kmJfO","$4e1f642ad95f55f9$var$stringSlice","$4e1f642ad95f55f9$var$un$ToFixed","toFixed","$4e1f642ad95f55f9$var$pow","acc","$4e1f642ad95f55f9$var$multiply","c2","$4e1f642ad95f55f9$var$divide","$4e1f642ad95f55f9$var$dataToString","s","fractionDigits","z","fractDigits","x2","$4e1f642ad95f55f9$var$log","$ed38f736006a189b$var$RangeError","str","assign","$lFR0S","$fc768c9ef9e1deb0$var$$assign","$fc768c9ef9e1deb0$var$defineProperty","$fc768c9ef9e1deb0$var$concat","B","alphabet","T","$4qt6g","__defineGetter__","getter","__defineSetter__","$f989467c0ff32b07$require$$entries","$c7d0dd7c98cf6620$var$propertyIsEnumerable","$c7d0dd7c98cf6620$var$push","$c7d0dd7c98cf6620$var$createMethod","TO_ENTRIES","$ae1348ad95526311$var$$freeze","freeze","$ae1348ad95526311$require$onFreeze","fromEntries","$cc1eb17eb08c9bee$var$FAILS_ON_PRIMITIVES","$cc1eb17eb08c9bee$require$nativeGetOwnPropertyDescriptor","getOwnPropertyDescriptors","$47c621318e2f76c3$require$getOwnPropertyNames","is","$8286df4accdf48ed$var$$isFrozen","isFrozen","$298641195c3c623c$var$$isSealed","isSealed","__lookupGetter__","$924d18b281a9c424$require$getOwnPropertyDescriptor","__lookupSetter__","$42abce55f97ceab5$require$getOwnPropertyDescriptor","$267d03b316d70c8b$var$$preventExtensions","$267d03b316d70c8b$require$onFreeze","$e28a496f96292dfa$var$$seal","seal","$e28a496f96292dfa$require$onFreeze","$j9rDg","$71106bf8fefef8c0$require$$values","$f63b4deb68b5ca14$var$Internal","$f63b4deb68b5ca14$var$OwnPromiseCapability","$f63b4deb68b5ca14$var$PromiseWrapper","$f63b4deb68b5ca14$var$nativeThen","$f63b4deb68b5ca14$var$SPECIES","$f63b4deb68b5ca14$var$PROMISE","$f63b4deb68b5ca14$var$getInternalState","$f63b4deb68b5ca14$var$setInternalState","$f63b4deb68b5ca14$var$getInternalPromiseState","$f63b4deb68b5ca14$var$NativePromisePrototype","$dH9yW","$f63b4deb68b5ca14$var$PromiseConstructor","$f63b4deb68b5ca14$var$PromisePrototype","$f63b4deb68b5ca14$var$TypeError","$f63b4deb68b5ca14$var$document","$f63b4deb68b5ca14$var$process","$f63b4deb68b5ca14$var$newPromiseCapability","$4l0Z8","$f63b4deb68b5ca14$var$newGenericPromiseCapability","$f63b4deb68b5ca14$var$DISPATCH_EVENT","createEvent","dispatchEvent","$f63b4deb68b5ca14$var$NATIVE_REJECTION_EVENT","PromiseRejectionEvent","$f63b4deb68b5ca14$var$UNHANDLED_REJECTION","$f63b4deb68b5ca14$var$SUBCLASSING","$f63b4deb68b5ca14$var$FORCED","PROMISE_CONSTRUCTOR_SOURCE","GLOBAL_CORE_JS_PROMISE","promise","resolve","FakePromise","then","$5qUSX","$f63b4deb68b5ca14$var$INCORRECT_ITERATION","all","$f63b4deb68b5ca14$var$isThenable","$f63b4deb68b5ca14$var$callReaction","reaction","exited","ok","handler","fail","reject","rejection","$f63b4deb68b5ca14$var$onHandleUnhandled","enter","exit","$f63b4deb68b5ca14$var$notify","isReject","notified","$cqo3L","reactions","$f63b4deb68b5ca14$var$onUnhandled","$f63b4deb68b5ca14$var$dispatchEvent","reason","event","initEvent","$46Eeh","$f63b4deb68b5ca14$require$task","$f63b4deb68b5ca14$var$isUnhandled","$emrW7","emit","parent","$f63b4deb68b5ca14$var$bind","unwrap","$f63b4deb68b5ca14$var$internalReject","$f63b4deb68b5ca14$var$internalResolve","executor","$c6xXQ","onFulfilled","onRejected","catch","Promise","r","capability","$jb14y","$promiseResolve","counter","remaining","alreadyCalled","race","$33e6d73a2ea24d6b$var$location","$33e6d73a2ea24d6b$var$defer","$33e6d73a2ea24d6b$var$channel","$33e6d73a2ea24d6b$var$port","$33e6d73a2ea24d6b$var$set","setImmediate","$33e6d73a2ea24d6b$var$clear","clearImmediate","$33e6d73a2ea24d6b$var$process","$33e6d73a2ea24d6b$var$Dispatch","Dispatch","$33e6d73a2ea24d6b$var$Function","$33e6d73a2ea24d6b$var$MessageChannel","MessageChannel","$33e6d73a2ea24d6b$var$String","$33e6d73a2ea24d6b$var$counter","$33e6d73a2ea24d6b$var$queue","$33e6d73a2ea24d6b$var$ONREADYSTATECHANGE","location","$33e6d73a2ea24d6b$var$run","id","$33e6d73a2ea24d6b$var$runner","$33e6d73a2ea24d6b$var$listener","$33e6d73a2ea24d6b$var$post","postMessage","protocol","host","nextTick","now","$eFUbX","port2","port1","onmessage","addEventListener","importScripts","setTimeout","$90ba93803394c14b$var$flush","$90ba93803394c14b$var$head","$90ba93803394c14b$var$last","$90ba93803394c14b$var$notify","$90ba93803394c14b$var$toggle","$90ba93803394c14b$var$node","$90ba93803394c14b$var$promise","$90ba93803394c14b$var$then","$90ba93803394c14b$var$MutationObserver","MutationObserver","WebKitMutationObserver","$90ba93803394c14b$var$document","$90ba93803394c14b$var$process","$90ba93803394c14b$var$Promise","$90ba93803394c14b$var$queueMicrotaskDescriptor","$90ba93803394c14b$require$getOwnPropertyDescriptor","$90ba93803394c14b$var$queueMicrotask","$jtDRH","$k2k84","$90ba93803394c14b$require$macrotask","createTextNode","observe","characterData","task","Pebble","promiseCapability","$3289e331b59edf28$export$2d1720544b23b823","$3289e331b59edf28$var$PromiseCapability","$$resolve","$$reject","$8d0064273ae794d4$var$Queue","head","tail","real","finally","onFinally","isFunction","$044557d82d23c7b7$var$method","thisArgument","argumentsList","$d991cb3405c95f1e$var$nativeConstruct","$d991cb3405c95f1e$var$ObjectPrototype","$d991cb3405c95f1e$var$push","$d991cb3405c95f1e$var$NEW_TARGET_BUG","$d991cb3405c95f1e$var$ARGS_BUG","$d991cb3405c95f1e$var$FORCED","construct","Target","newTarget","$args","$bLEKU","$8913b2b3e886b877$var$Function","$8913b2b3e886b877$var$concat","$8913b2b3e886b877$var$join","$8913b2b3e886b877$var$factories","$8913b2b3e886b877$var$construct","argsLength","list","partArgs","attributes","deleteProperty","$f6707b6d575f1de3$require$getOwnPropertyDescriptor","$a8ede88258171abd$var$get","receiver","$dxXnz","ownKeys","objectPreventExtensions","$f3bd7d05059f3f8c$var$set","existingDescriptor","ownDescriptor","$1a64a42b0b7fff6e$var$MATCH","$1a64a42b0b7fff6e$var$NativeRegExp","$1a64a42b0b7fff6e$var$RegExpPrototype","$1a64a42b0b7fff6e$var$SyntaxError","SyntaxError","$1a64a42b0b7fff6e$var$getFlags","$1wkuT","$1a64a42b0b7fff6e$var$exec","$1a64a42b0b7fff6e$var$charAt","$1a64a42b0b7fff6e$var$replace","$1a64a42b0b7fff6e$var$stringIndexOf","$1a64a42b0b7fff6e$var$stringSlice","$1a64a42b0b7fff6e$var$IS_NCG","$1a64a42b0b7fff6e$var$re1","$1a64a42b0b7fff6e$var$re2","$1a64a42b0b7fff6e$var$CORRECT_NEW","$1a64a42b0b7fff6e$var$MISSED_STICKY","$5mPjD","MISSED_STICKY","$1a64a42b0b7fff6e$var$UNSUPPORTED_Y","UNSUPPORTED_Y","$1a64a42b0b7fff6e$var$BASE_FORCED","$iolan","$15yb5","$1a64a42b0b7fff6e$var$RegExpWrapper","pattern","flags","rawFlags","dotAll","sticky","handled","thisIsRegExp","patternIsRegExp","$j7Wj1","flagsAreUndefined","groups","rawPattern","named","brackets","ncg","groupid","groupname","$1a64a42b0b7fff6e$var$handleNCG","$1a64a42b0b7fff6e$require$enforceInternalState","raw","$1a64a42b0b7fff6e$var$handleDotAll","$1a64a42b0b7fff6e$var$proxy","$1a64a42b0b7fff6e$require$defineProperty","$1a64a42b0b7fff6e$var$keys","$1a64a42b0b7fff6e$require$getOwnPropertyNames","$1a64a42b0b7fff6e$var$index","$decbe61b88b1ca94$var$MATCH","isRegExp","ignoreCase","multiline","unicode","$3e86d009365b1bcd$var$$RegExp","$3e86d009365b1bcd$var$UNSUPPORTED_Y","re","lastIndex","$3e86d009365b1bcd$var$MISSED_STICKY","$3e86d009365b1bcd$var$BROKEN_CARET","BROKEN_CARET","$d63ae31c41c02162$var$$RegExp","$0cb0c5148b1dfc95$var$$RegExp","$gDZSO","re1","re2","$c1e04a8dd1201ac1$var$nativeReplace","$c1e04a8dd1201ac1$var$nativeExec","$c1e04a8dd1201ac1$var$patchedExec","$c1e04a8dd1201ac1$var$charAt","$c1e04a8dd1201ac1$var$indexOf","$c1e04a8dd1201ac1$var$replace","$c1e04a8dd1201ac1$var$stringSlice","$c1e04a8dd1201ac1$var$UPDATES_LAST_INDEX_WRONG","$c1e04a8dd1201ac1$var$UNSUPPORTED_Y","$c1e04a8dd1201ac1$var$NPCG_INCLUDED","reCopy","group","$c1e04a8dd1201ac1$require$getInternalState","charsAdded","strCopy","$4d9034aa0a7c78c5$var$RegExpPrototype","$e33b07dd25444a37$var$TO_STRING","$e33b07dd25444a37$var$RegExpPrototype","$e33b07dd25444a37$var$n$ToString","$e33b07dd25444a37$var$getFlags","$e33b07dd25444a37$var$NOT_GENERIC","$e33b07dd25444a37$var$INCORRECT_NAME","$e33b07dd25444a37$require$PROPER_FUNCTION_NAME","R","rf","codeAt","codePointAt","pos","$84c537d40dd85849$require$codeAt","$3bbd219b097bf803$var$charAt","$3bbd219b097bf803$var$charCodeAt","$3bbd219b097bf803$var$stringSlice","$3bbd219b097bf803$var$createMethod","CONVERT_TO_STRING","second","position","$a321b1a461d318d9$var$un$EndsWith","endsWith","$a321b1a461d318d9$var$slice","$a321b1a461d318d9$var$min","$a321b1a461d318d9$var$CORRECT_IS_REGEXP_LOGIC","$gkCWb","$a321b1a461d318d9$require$getOwnPropertyDescriptor","searchString","$jliZt","endPosition","search","$e14eb5a118a77d53$var$TypeError","$be3cb7bcec3f6005$var$MATCH","regexp","error1","error2","$5a8165a23fe280d7$var$RangeError","$5a8165a23fe280d7$var$fromCharCode","$5a8165a23fe280d7$var$$fromCodePoint","fromCodePoint","$5a8165a23fe280d7$var$join","elements","$8bf07a5ea4f86bf8$var$stringIndexOf","$421d3bd28a93f302$var$STRING_ITERATOR","$421d3bd28a93f302$var$setInternalState","$421d3bd28a93f302$var$getInternalState","point","$421d3bd28a93f302$require$charAt","$1eJAF","MATCH","nativeMatch","maybeCallNative","matcher","rx","res","$2aUTa","fullUnicode","matchStr","$6DNPg","$0e6a768d17013739$var$SPECIES","$0e6a768d17013739$var$RegExpPrototype","SHAM","SYMBOL","DELEGATES_TO_SYMBOL","DELEGATES_TO_EXEC","execCalled","uncurriedNativeRegExpMethod","nativeMethod","arg2","forceStringMethod","$exec","$4d5d08f9313fe63c$require$charAt","$1958a4db80fb0f43$var$TypeError","padEnd","maxLength","$53960335dda7a9bf$require$$padEnd","$31ce6e790965ee6e$var$repeat","$31ce6e790965ee6e$var$stringSlice","$31ce6e790965ee6e$var$ceil","$31ce6e790965ee6e$var$createMethod","IS_END","fillString","fillLen","stringFiller","intMaxLength","stringLength","fillStr","padStart","$81ed00457f8ab940$require$$padStart","$8577e5a06e0ac04d$var$push","$8577e5a06e0ac04d$var$join","template","rawTemplate","literalSegments","repeat","$009f5df1198ba855$var$REPLACE","$009f5df1198ba855$var$max","$009f5df1198ba855$var$min","$009f5df1198ba855$var$concat","$009f5df1198ba855$var$push","$009f5df1198ba855$var$stringIndexOf","$009f5df1198ba855$var$stringSlice","$009f5df1198ba855$var$REPLACE_KEEPS_$0","$009f5df1198ba855$var$REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE","_","nativeReplace","UNSAFE_SUBSTITUTE","searchValue","replaceValue","functionalReplace","results","accumulatedResult","nextSourcePosition","matched","captures","namedCaptures","replacerArgs","replacement","$tmsHt","$05842203b4d319b5$var$floor","$05842203b4d319b5$var$charAt","$05842203b4d319b5$var$replace","$05842203b4d319b5$var$stringSlice","$05842203b4d319b5$var$SUBSTITUTION_SYMBOLS","$05842203b4d319b5$var$SUBSTITUTION_SYMBOLS_NO_NAMED","tailPos","m","symbols","ch","capture","SEARCH","nativeSearch","searcher","previousLastIndex","$98Orf","$cba551393cb53eca$var$UNSUPPORTED_Y","$cba551393cb53eca$var$MAX_UINT32","$cba551393cb53eca$var$min","$cba551393cb53eca$var$$push","$cba551393cb53eca$var$exec","$cba551393cb53eca$var$push","$cba551393cb53eca$var$stringSlice","$cba551393cb53eca$var$SPLIT_WORKS_WITH_OVERWRITTEN_EXEC","originalExec","SPLIT","nativeSplit","internalSplit","limit","lim","lastLength","output","lastLastIndex","separatorCopy","splitter","unicodeMatching","q","$4872c160a86fd36b$var$un$StartsWith","startsWith","$4872c160a86fd36b$var$stringSlice","$4872c160a86fd36b$var$min","$4872c160a86fd36b$var$CORRECT_IS_REGEXP_LOGIC","$4872c160a86fd36b$require$getOwnPropertyDescriptor","$ecacA","$61e74fc345dbbdfb$require$$trim","$a55a1999ac794209$require$PROPER_FUNCTION_NAME","$6f2ff22016a32dee$var$FORCED","$6f2ff22016a32dee$var$trimEnd","$6f2ff22016a32dee$require$$trimEnd","trimEnd","trimRight","$171362188355f50f$var$FORCED","$171362188355f50f$var$trimStart","$171362188355f50f$require$$trimStart","trimStart","trimLeft","$6PJ8T","anchor","$1nd9Q","$100225492babcc44$var$quot","$100225492babcc44$var$replace","attribute","p1","big","blink","bold","fixed","fontcolor","color","fontsize","italics","link","small","strike","sub","sup","$fMuLF","$b7d334927398c843$var$getInternalState","$b7d334927398c843$var$setInternalState","$b7d334927398c843$var$nativeDefineProperty","$b7d334927398c843$var$nativeGetOwnPropertyDescriptor","$b7d334927398c843$var$round","round","$b7d334927398c843$var$RangeError","$b7d334927398c843$var$ArrayBuffer","$b7d334927398c843$var$ArrayBufferPrototype","$b7d334927398c843$var$DataView","$b7d334927398c843$var$NATIVE_ARRAY_BUFFER_VIEWS","$lKaOf","NATIVE_ARRAY_BUFFER_VIEWS","$b7d334927398c843$var$TYPED_ARRAY_CONSTRUCTOR","TYPED_ARRAY_CONSTRUCTOR","$b7d334927398c843$var$TYPED_ARRAY_TAG","TYPED_ARRAY_TAG","$b7d334927398c843$var$TypedArray","TypedArray","$b7d334927398c843$var$TypedArrayPrototype","TypedArrayPrototype","$b7d334927398c843$var$aTypedArrayConstructor","aTypedArrayConstructor","$b7d334927398c843$var$isTypedArray","isTypedArray","$b7d334927398c843$var$BYTES_PER_ELEMENT","$b7d334927398c843$var$WRONG_LENGTH","$b7d334927398c843$var$fromList","$b7d334927398c843$var$addGetter","$b7d334927398c843$var$isArrayBuffer","klass","$b7d334927398c843$var$isTypedArrayIndex","$b7d334927398c843$var$wrappedGetOwnPropertyDescriptor","$b7d334927398c843$var$wrappedDefineProperty","CLAMPED","BYTES","GETTER","SETTER","NativeTypedArrayConstructor","TypedArrayConstructor","TypedArrayConstructorPrototype","addElement","$gwHTU","typedArrayOffset","$length","$1kqup","$8ecSO","$len","$c081b040a237c76f$var$ArrayBuffer","$c081b040a237c76f$var$Int8Array","Int8Array","$c081b040a237c76f$require$NATIVE_ARRAY_BUFFER_VIEWS","$fd46476516885c65$var$NAME","$fd46476516885c65$var$Constructor","$fd46476516885c65$var$Prototype","$fd46476516885c65$var$Int8Array","$fd46476516885c65$var$Int8ArrayPrototype","$fd46476516885c65$var$Uint8ClampedArray","Uint8ClampedArray","$fd46476516885c65$var$Uint8ClampedArrayPrototype","$fd46476516885c65$var$TypedArray","$fd46476516885c65$var$TypedArrayPrototype","$fd46476516885c65$var$ObjectPrototype","$fd46476516885c65$var$TypeError","$fd46476516885c65$var$TO_STRING_TAG","$fd46476516885c65$var$TYPED_ARRAY_TAG","$fd46476516885c65$var$TYPED_ARRAY_CONSTRUCTOR","$fd46476516885c65$var$NATIVE_ARRAY_BUFFER_VIEWS","opera","$fd46476516885c65$var$TYPED_ARRAY_TAG_REQUIRED","$fd46476516885c65$var$TypedArrayConstructorsList","Uint8Array","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","$fd46476516885c65$var$BigIntArrayConstructorsList","BigInt64Array","BigUint64Array","$fd46476516885c65$var$isTypedArray","aTypedArray","exportTypedArrayMethod","property","ARRAY","exportTypedArrayStaticMethod","isView","$0f7c34f15c2bb5ce$var$RangeError","$dG9ye","$9f569b4629448553$var$RangeError","$5fd99fddcaec4112$require$aTypedArrayConstructor","$b631bbe003371657$var$u$ArrayCopyWithin","$b631bbe003371657$var$aTypedArray","$b631bbe003371657$var$exportTypedArrayMethod","$d69ecf634a10a535$var$aTypedArray","$d69ecf634a10a535$var$exportTypedArrayMethod","$d69ecf634a10a535$require$$every","$4ec5af8a77aa31ac$var$aTypedArray","$4ec5af8a77aa31ac$var$exportTypedArrayMethod","$3586d39acc2774dd$var$aTypedArray","$3586d39acc2774dd$var$exportTypedArrayMethod","$3586d39acc2774dd$require$$filter","$7WNzG","$ijLgx","$97HwV","$6a4688aced6685cb$var$TYPED_ARRAY_CONSTRUCTOR","$6a4688aced6685cb$var$aTypedArrayConstructor","$79db93bd5fca1ce7$var$aTypedArray","$79db93bd5fca1ce7$var$exportTypedArrayMethod","predicate","$79db93bd5fca1ce7$require$$find","$59b8d2c114df5a4e$var$aTypedArray","$59b8d2c114df5a4e$var$exportTypedArrayMethod","$59b8d2c114df5a4e$require$$findIndex","$97423b5d490b4446$var$aTypedArray","$97423b5d490b4446$var$exportTypedArrayMethod","$6a83ddf03671ed91$var$aTypedArray","$6a83ddf03671ed91$var$exportTypedArrayMethod","$6a83ddf03671ed91$require$$includes","$15ed4ef7ba5f52a2$var$aTypedArray","$15ed4ef7ba5f52a2$var$exportTypedArrayMethod","$15ed4ef7ba5f52a2$require$$indexOf","$fc479e6228c9e0bf$var$ITERATOR","$fc479e6228c9e0bf$var$Uint8Array","$fc479e6228c9e0bf$var$arrayValues","$l4lCC","$fc479e6228c9e0bf$var$arrayKeys","$fc479e6228c9e0bf$var$arrayEntries","$fc479e6228c9e0bf$var$aTypedArray","$fc479e6228c9e0bf$var$exportTypedArrayMethod","$fc479e6228c9e0bf$var$TypedArrayPrototype","$fc479e6228c9e0bf$var$GENERIC","$fc479e6228c9e0bf$var$ITERATOR_IS_VALUES","$fc479e6228c9e0bf$var$typedArrayValues","$046afbce50198ca1$var$aTypedArray","$046afbce50198ca1$var$exportTypedArrayMethod","$046afbce50198ca1$var$$join","$f68531cb13917c81$var$aTypedArray","$f68531cb13917c81$var$exportTypedArrayMethod","$937a5b0c74fb830c$var$aTypedArray","$937a5b0c74fb830c$var$exportTypedArrayMethod","$937a5b0c74fb830c$require$$map","$c32e06b56e4a41ef$var$aTypedArrayConstructor","$c32e06b56e4a41ef$var$exportTypedArrayStaticMethod","$ec25c78e10e68660$var$aTypedArray","$ec25c78e10e68660$var$exportTypedArrayMethod","$ec25c78e10e68660$require$$reduce","$7cac9044c9527222$var$aTypedArray","$7cac9044c9527222$var$exportTypedArrayMethod","$7cac9044c9527222$require$$reduceRight","$ead7a01b48e39503$var$aTypedArray","$ead7a01b48e39503$var$exportTypedArrayMethod","$ead7a01b48e39503$var$floor","$e0a5c5b8271df7c6$var$RangeError","$e0a5c5b8271df7c6$var$Int8Array","$e0a5c5b8271df7c6$var$Int8ArrayPrototype","$e0a5c5b8271df7c6$var$$set","$e0a5c5b8271df7c6$var$aTypedArray","$e0a5c5b8271df7c6$var$exportTypedArrayMethod","$e0a5c5b8271df7c6$var$WORKS_WITH_OBJECTS_AND_GEERIC_ON_TYPED_ARRAYS","$e0a5c5b8271df7c6$var$TO_OBJECT_BUG","$c6c88b1d5fcf56c4$var$aTypedArray","$c6c88b1d5fcf56c4$var$exportTypedArrayMethod","$3f60740c905767a3$var$aTypedArray","$3f60740c905767a3$var$exportTypedArrayMethod","$3f60740c905767a3$require$$some","$5c101bffda9b4dc5$var$Array","$5c101bffda9b4dc5$var$aTypedArray","$5c101bffda9b4dc5$var$exportTypedArrayMethod","$5c101bffda9b4dc5$var$Uint16Array","$5c101bffda9b4dc5$var$un$Sort","$5c101bffda9b4dc5$var$ACCEPT_INCORRECT_ARGUMENTS","$5c101bffda9b4dc5$var$STABLE_SORT","mod","expected","$5c101bffda9b4dc5$var$getSortCompare","$54a89f2dea9e9012$var$aTypedArray","$54a89f2dea9e9012$var$exportTypedArrayMethod","begin","beginIndex","BYTES_PER_ELEMENT","$88d44de1a6a90a41$var$Int8Array","$88d44de1a6a90a41$var$aTypedArray","$88d44de1a6a90a41$var$exportTypedArrayMethod","$88d44de1a6a90a41$var$$toLocaleString","toLocaleString","$88d44de1a6a90a41$var$TO_LOCALE_STRING_BUG","$e88adbad4d614fed$var$Uint8Array","$e88adbad4d614fed$var$Uint8ArrayPrototype","$e88adbad4d614fed$var$arrayToString","$e88adbad4d614fed$var$join","$e88adbad4d614fed$var$IS_NOT_ARRAY_METHOD","$0af78d12490b7b6f$var$InternalWeakMap","$0af78d12490b7b6f$var$IS_IE11","$0af78d12490b7b6f$var$wrapper","$0af78d12490b7b6f$var$$WeakMap","$lGvw2","$0af78d12490b7b6f$var$WeakMapPrototype","$0af78d12490b7b6f$var$nativeDelete","$0af78d12490b7b6f$var$nativeHas","$0af78d12490b7b6f$var$nativeGet","$0af78d12490b7b6f$var$nativeSet","$0af78d12490b7b6f$require$enforceInternalState","frozen","$fc95f796e98c0c9a$var$setInternalState","$fc95f796e98c0c9a$var$internalStateGetterFor","$fc95f796e98c0c9a$var$find","$9otZn","$fc95f796e98c0c9a$var$findIndex","$fc95f796e98c0c9a$var$splice","$fc95f796e98c0c9a$var$id","$fc95f796e98c0c9a$var$uncaughtFrozenStore","$fc95f796e98c0c9a$var$UncaughtFrozenStore","$fc95f796e98c0c9a$var$findUncaughtFrozen","$fc95f796e98c0c9a$require$getWeakData","$983ff28d45588730$var$TO_STRING_TAG","$983ff28d45588730$var$Error","$983ff28d45588730$var$push","$983ff28d45588730$var$$AggregateError","errors","message","isInstance","$983ff28d45588730$var$AggregateErrorPrototype","$l5aDI","$1hDjD","$7w1I6","stack","$fSh1A","errorsArray","AggregateError","$578cd93057827280$var$replace","$578cd93057827280$var$TEST","$578cd93057827280$var$V8_OR_CHAKRA_STACK_ENTRY","$578cd93057827280$var$IS_V8_OR_CHAKRA_STACK","dropEntries","cause","$default","$15b9214f17cc4215$var$Object","$15b9214f17cc4215$var$initializer","compositeKey","$8p7xn","$61e681497820a0b0$var$Object","$61e681497820a0b0$var$TypeError","$61e681497820a0b0$var$Map","$61e681497820a0b0$var$WeakMap","$61e681497820a0b0$var$Node","primitives","objectsByIndex","initializer","IS_OBJECT","$61e681497820a0b0$var$root","active","compositeSymbol","deleteAll","wasDeleted","collection","remover","allDeleted","$7AisJ","Map","newMap","findKey","$d9101a8b8952cf02$var$push","nextItem","$266b05ec1b53f26d$var$push","groupBy","keyDerivative","derivedKey","$j1P8I","keyBy","keyOf","mapKeys","mapValues","merge","$0cb343ee31a7f56b$var$TypeError","noInitial","accumulator","$58d9b99d231b61f5$var$TypeError","update","isPresentInMap","$99469c90a1670338$var$min","$99469c90a1670338$var$max","clamp","lower","upper","DEG_PER_RAD","PI","$7afc466313ad437e$var$RAD_PER_DEG","degrees","radians","fscale","inLow","inHigh","outLow","outHigh","$kPZzt","$ax2Zy","scale","nx","nInLow","nInHigh","nOutLow","nOutHigh","iaddh","x0","x1","y0","y1","$x0","$y0","imulh","u","$u","$v","u0","v0","u1","v1","isubh","RAD_PER_DEG","$8203115ff05fcb06$var$DEG_PER_RAD","$83af51d30afa2190$var$SEEDED_RANDOM","$83af51d30afa2190$var$SEEDED_RANDOM_GENERATOR","$83af51d30afa2190$var$setInternalState","$83af51d30afa2190$var$getInternalState","$83af51d30afa2190$var$TypeError","$83af51d30afa2190$var$$SeededRandomGenerator","seed","seededPRNG","$4JrHk","signbit","umulh","$2ad16c82d7e5bdda$var$INVALID_NUMBER_REPRESENTATION","$2ad16c82d7e5bdda$var$RangeError","$2ad16c82d7e5bdda$var$SyntaxError","$2ad16c82d7e5bdda$var$TypeError","$2ad16c82d7e5bdda$var$valid","$2ad16c82d7e5bdda$var$charAt","$2ad16c82d7e5bdda$var$exec","$2ad16c82d7e5bdda$var$numberToString","$2ad16c82d7e5bdda$var$stringSlice","fromString","mathNum","$125e49295718c6c9$var$$$OBSERVABLE","$125e49295718c6c9$var$OBSERVABLE","$125e49295718c6c9$var$SUBSCRIPTION","$125e49295718c6c9$var$SUBSCRIPTION_OBSERVER","$125e49295718c6c9$var$getterFor","$125e49295718c6c9$var$setInternalState","$125e49295718c6c9$var$getObservableInternalState","$125e49295718c6c9$var$getSubscriptionInternalState","$125e49295718c6c9$var$getSubscriptionObserverInternalState","$125e49295718c6c9$var$Array","$125e49295718c6c9$var$SubscriptionState","observer","cleanup","subscriptionObserver","clean","subscription","closed","isClosed","$125e49295718c6c9$var$Subscription","subscriber","subscriptionState","$125e49295718c6c9$var$SubscriptionObserver","unsubscribe","$125e49295718c6c9$require$defineProperty","nextMethod","errorMethod","err","complete","completeMethod","$125e49295718c6c9$var$$Observable","$125e49295718c6c9$var$ObservablePrototype","subscribe","observableMethod","observable","Observable","allSettled","promiseResolve","status","$e2179bcb26acbb4b$var$PROMISE_ANY_ERROR","any","alreadyResolved","alreadyRejected","try","$6ec782fcb928f430$var$toMetadataKey","$aLynb","toKey","$6ec782fcb928f430$var$ordinaryDefineOwnMetadata","defineMetadata","metadataKey","metadataValue","targetKey","$7d68f4e7e4c4b782$var$Map","$7d68f4e7e4c4b782$var$WeakMap","$7d68f4e7e4c4b782$var$push","$7d68f4e7e4c4b782$var$metadata","$7d68f4e7e4c4b782$var$store","$7d68f4e7e4c4b782$var$getOrCreateMetadataMap","targetMetadata","keyMetadata","getMap","MetadataKey","metadataMap","MetadataValue","$9af708e71367b103$var$toMetadataKey","$9af708e71367b103$var$getOrCreateMetadataMap","$9af708e71367b103$var$store","deleteMetadata","$f1e6afa3d172152e$var$ordinaryHasOwnMetadata","$f1e6afa3d172152e$var$ordinaryGetOwnMetadata","$f1e6afa3d172152e$var$toMetadataKey","$f1e6afa3d172152e$var$ordinaryGetMetadata","getMetadata","$ff72e5bc2a0c8764$var$arrayUniqueBy","$ff72e5bc2a0c8764$var$concat","$ff72e5bc2a0c8764$var$ordinaryOwnMetadataKeys","$ff72e5bc2a0c8764$var$toMetadataKey","$ff72e5bc2a0c8764$var$ordinaryMetadataKeys","oKeys","pKeys","getMetadataKeys","$579ba129125d1fa5$var$Map","$579ba129125d1fa5$var$MapPrototype","$579ba129125d1fa5$var$mapForEach","$579ba129125d1fa5$var$mapHas","$579ba129125d1fa5$var$mapSet","$579ba129125d1fa5$var$push","resolver","resolverFunction","$711ec71648de990d$var$ordinaryGetOwnMetadata","$711ec71648de990d$var$toMetadataKey","getOwnMetadata","$1901db538b4d77f7$var$ordinaryOwnMetadataKeys","$1901db538b4d77f7$var$toMetadataKey","getOwnMetadataKeys","$f21eeb678da61698$var$ordinaryHasOwnMetadata","$f21eeb678da61698$var$toMetadataKey","$f21eeb678da61698$var$ordinaryHasMetadata","hasMetadata","$a93863ffbbf45637$var$ordinaryHasOwnMetadata","$a93863ffbbf45637$var$toMetadataKey","hasOwnMetadata","$8e7798a8c8e81c9d$var$toMetadataKey","$8e7798a8c8e81c9d$var$ordinaryDefineOwnMetadata","addAll","adder","difference","newSet","$iEP2p","Set","intersection","hasCheck","isDisjointFrom","isSubsetOf","otherSet","isSupersetOf","$aed530c20c995f87$var$arrayJoin","$aed530c20c995f87$var$push","sep","$267b8f450c83d607$var$TypeError","symmetricDifference","union","at","relativeIndex","$4553b2908c7726ba$require$charAt","$be139b4dd007a70a$var$codeAt","$57ZgD","$be139b4dd007a70a$var$charAt","$be139b4dd007a70a$var$STRING_ITERATOR","$be139b4dd007a70a$var$setInternalState","$be139b4dd007a70a$var$getInternalState","$be139b4dd007a70a$var$$StringIterator","codePoint","codePoints","$494c22fb3259e451$var$MATCH_ALL","$494c22fb3259e451$var$REGEXP_STRING","$494c22fb3259e451$var$REGEXP_STRING_ITERATOR","$494c22fb3259e451$var$setInternalState","$494c22fb3259e451$var$getInternalState","$494c22fb3259e451$var$RegExpPrototype","$494c22fb3259e451$var$TypeError","$494c22fb3259e451$var$getFlags","$494c22fb3259e451$var$stringIndexOf","$494c22fb3259e451$var$un$MatchAll","matchAll","$494c22fb3259e451$var$WORKS_WITH_NON_GLOBAL_REGEX","$494c22fb3259e451$var$$RegExpStringIterator","$global","$494c22fb3259e451$var$$matchAll","flagsValue","$578275b064831efe$var$REPLACE","$578275b064831efe$var$RegExpPrototype","$578275b064831efe$var$TypeError","$578275b064831efe$var$getFlags","$578275b064831efe$var$indexOf","$578275b064831efe$var$replace","$578275b064831efe$var$stringSlice","$578275b064831efe$var$max","$578275b064831efe$var$stringIndexOf","replaceAll","IS_REG_EXP","searchLength","advanceBy","endOfLastMatch","$ed4078936178e184$var$handlePrototype","CollectionPrototype","$iLKSv","$ed4078936178e184$var$COLLECTION_NAME","$2vChI","$atkun","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DOMTokenList","DataTransferItemList","FileList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList","$79fc817da0f47b47$var$classList","classList","$79fc817da0f47b47$var$DOMTokenListPrototype","$daa0fad1a5e71fc1$var$STRICT_METHOD","$daa0fad1a5e71fc1$require$$forEach","$353bf2319d4355ad$var$ITERATOR","$353bf2319d4355ad$var$TO_STRING_TAG","$353bf2319d4355ad$var$ArrayValues","$353bf2319d4355ad$var$handlePrototype","COLLECTION_NAME","$353bf2319d4355ad$var$COLLECTION_NAME","$4sgQc","$aa0122136da199d1$var$process","queueMicrotask","$ca49c6c3f5b8ed45$var$EOF","$ca49c6c3f5b8ed45$var$setInternalState","$ca49c6c3f5b8ed45$var$getInternalURLState","$ca49c6c3f5b8ed45$var$URLSearchParams","$kfur8","URLSearchParams","$ca49c6c3f5b8ed45$var$getInternalSearchParamsState","getState","$ca49c6c3f5b8ed45$var$NativeURL","URL","$ca49c6c3f5b8ed45$var$TypeError","$ca49c6c3f5b8ed45$var$parseInt","$ca49c6c3f5b8ed45$var$floor","$ca49c6c3f5b8ed45$var$pow","$ca49c6c3f5b8ed45$var$charAt","$ca49c6c3f5b8ed45$var$exec","$ca49c6c3f5b8ed45$var$join","$ca49c6c3f5b8ed45$var$numberToString","$ca49c6c3f5b8ed45$var$pop","pop","$ca49c6c3f5b8ed45$var$push","$ca49c6c3f5b8ed45$var$replace","$ca49c6c3f5b8ed45$var$shift","$ca49c6c3f5b8ed45$var$split","$ca49c6c3f5b8ed45$var$stringSlice","$ca49c6c3f5b8ed45$var$toLowerCase","$ca49c6c3f5b8ed45$var$unshift","unshift","$ca49c6c3f5b8ed45$var$INVALID_SCHEME","$ca49c6c3f5b8ed45$var$INVALID_HOST","$ca49c6c3f5b8ed45$var$INVALID_PORT","$ca49c6c3f5b8ed45$var$ALPHA","$ca49c6c3f5b8ed45$var$ALPHANUMERIC","$ca49c6c3f5b8ed45$var$DIGIT","$ca49c6c3f5b8ed45$var$HEX_START","$ca49c6c3f5b8ed45$var$OCT","$ca49c6c3f5b8ed45$var$DEC","$ca49c6c3f5b8ed45$var$HEX","$ca49c6c3f5b8ed45$var$FORBIDDEN_HOST_CODE_POINT","$ca49c6c3f5b8ed45$var$FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT","$ca49c6c3f5b8ed45$var$LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE","$ca49c6c3f5b8ed45$var$TAB_AND_NEW_LINE","$ca49c6c3f5b8ed45$var$serializeHost","compress","ignore0","ipv6","maxIndex","currStart","currLength","$ca49c6c3f5b8ed45$var$findLongestZeroSequence","$ca49c6c3f5b8ed45$var$C0ControlPercentEncodeSet","$ca49c6c3f5b8ed45$var$fragmentPercentEncodeSet","$ca49c6c3f5b8ed45$var$pathPercentEncodeSet","$ca49c6c3f5b8ed45$var$userinfoPercentEncodeSet","$ca49c6c3f5b8ed45$var$percentEncode","$ca49c6c3f5b8ed45$require$codeAt","encodeURIComponent","$ca49c6c3f5b8ed45$var$specialSchemes","ftp","file","http","https","ws","wss","$ca49c6c3f5b8ed45$var$isWindowsDriveLetter","normalized","$ca49c6c3f5b8ed45$var$startsWithWindowsDriveLetter","$ca49c6c3f5b8ed45$var$isSingleDot","segment","$ca49c6c3f5b8ed45$var$SCHEME_START","$ca49c6c3f5b8ed45$var$SCHEME","$ca49c6c3f5b8ed45$var$NO_SCHEME","$ca49c6c3f5b8ed45$var$SPECIAL_RELATIVE_OR_AUTHORITY","$ca49c6c3f5b8ed45$var$PATH_OR_AUTHORITY","$ca49c6c3f5b8ed45$var$RELATIVE","$ca49c6c3f5b8ed45$var$RELATIVE_SLASH","$ca49c6c3f5b8ed45$var$SPECIAL_AUTHORITY_SLASHES","$ca49c6c3f5b8ed45$var$SPECIAL_AUTHORITY_IGNORE_SLASHES","$ca49c6c3f5b8ed45$var$AUTHORITY","$ca49c6c3f5b8ed45$var$HOST","$ca49c6c3f5b8ed45$var$HOSTNAME","$ca49c6c3f5b8ed45$var$PORT","$ca49c6c3f5b8ed45$var$FILE","$ca49c6c3f5b8ed45$var$FILE_SLASH","$ca49c6c3f5b8ed45$var$FILE_HOST","$ca49c6c3f5b8ed45$var$PATH_START","$ca49c6c3f5b8ed45$var$PATH","$ca49c6c3f5b8ed45$var$CANNOT_BE_A_BASE_URL_PATH","$ca49c6c3f5b8ed45$var$QUERY","$ca49c6c3f5b8ed45$var$FRAGMENT","$ca49c6c3f5b8ed45$var$URLState","isBase","base","baseState","failure","searchParams","urlString","parse","bindURL","stateOverride","bufferCodePoints","pointer","seenAt","seenBracket","seenPasswordToken","scheme","username","password","port","path","query","fragment","cannotBeABaseURL","isSpecial","includesCredentials","encodedCodePoints","parseHost","shortenPath","numbersSeen","ipv4Piece","swaps","swap","address","pieceIndex","$ca49c6c3f5b8ed45$var$parseIPv6","$fTJdw","partsLength","numbers","part","ipv4","parts","$ca49c6c3f5b8ed45$var$parseIPv4","cannotHaveUsernamePasswordPort","pathSize","serialize","setHref","href","getOrigin","$ca49c6c3f5b8ed45$var$URLConstructor","origin","getProtocol","setProtocol","getUsername","setUsername","getPassword","setPassword","getHost","setHost","getHostname","setHostname","hostname","getPort","setPort","getPathname","setPathname","pathname","getSearch","setSearch","getSearchParams","getHash","setHash","hash","$ca49c6c3f5b8ed45$var$URLPrototype","$ca49c6c3f5b8ed45$var$accessorDescriptor","$ca49c6c3f5b8ed45$require$defineProperties","$ca49c6c3f5b8ed45$var$nativeCreateObjectURL","createObjectURL","$ca49c6c3f5b8ed45$var$nativeRevokeObjectURL","revokeObjectURL","$jQmSw","$e7249ecef49e6e4f$var$ITERATOR","$b92f1140f6de596b$var$maxInt","$b92f1140f6de596b$var$regexNonASCII","$b92f1140f6de596b$var$regexSeparators","$b92f1140f6de596b$var$OVERFLOW_ERROR","$b92f1140f6de596b$var$RangeError","$b92f1140f6de596b$var$exec","$b92f1140f6de596b$var$floor","$b92f1140f6de596b$var$fromCharCode","$b92f1140f6de596b$var$charCodeAt","$b92f1140f6de596b$var$join","$b92f1140f6de596b$var$push","$b92f1140f6de596b$var$replace","$b92f1140f6de596b$var$split","$b92f1140f6de596b$var$toLowerCase","$b92f1140f6de596b$var$digitToBasic","digit","$b92f1140f6de596b$var$adapt","delta","numPoints","firstTime","$b92f1140f6de596b$var$baseMinusTMin","$b92f1140f6de596b$var$base","$b92f1140f6de596b$var$encode","extra","$b92f1140f6de596b$var$ucs2decode","currentValue","inputLength","bias","basicLength","handledCPCount","handledCPCountPlusOne","qMinusT","baseMinusT","label","encoded","labels","$ebdcd16dd431135f$var$ITERATOR","$ebdcd16dd431135f$var$URL_SEARCH_PARAMS","$ebdcd16dd431135f$var$URL_SEARCH_PARAMS_ITERATOR","$ebdcd16dd431135f$var$setInternalState","$ebdcd16dd431135f$var$getInternalParamsState","$ebdcd16dd431135f$var$getInternalIteratorState","$ebdcd16dd431135f$var$n$Fetch","$ebdcd16dd431135f$var$N$Request","$ebdcd16dd431135f$var$Headers","$ebdcd16dd431135f$var$RequestPrototype","$ebdcd16dd431135f$var$HeadersPrototype","$ebdcd16dd431135f$var$RegExp","$ebdcd16dd431135f$var$TypeError","$ebdcd16dd431135f$var$decodeURIComponent","decodeURIComponent","$ebdcd16dd431135f$var$encodeURIComponent","$ebdcd16dd431135f$var$charAt","$ebdcd16dd431135f$var$join","$ebdcd16dd431135f$var$push","$ebdcd16dd431135f$var$replace","$ebdcd16dd431135f$var$shift","$ebdcd16dd431135f$var$splice","$ebdcd16dd431135f$var$split","$ebdcd16dd431135f$var$stringSlice","$ebdcd16dd431135f$var$plus","$ebdcd16dd431135f$var$sequences","$ebdcd16dd431135f$var$percentSequence","$ebdcd16dd431135f$var$percentDecode","sequence","$ebdcd16dd431135f$var$deserialize","$ebdcd16dd431135f$var$find","$ebdcd16dd431135f$var$replacements","$ebdcd16dd431135f$var$replacer","$ebdcd16dd431135f$var$serialize","$ebdcd16dd431135f$var$URLSearchParamsIterator","params","$ebdcd16dd431135f$var$URLSearchParamsState","parseObject","parseQuery","entryIterator","entryNext","updateURL","$ebdcd16dd431135f$var$URLSearchParamsConstructor","$ebdcd16dd431135f$var$URLSearchParamsPrototype","append","$lRXJh","getAll","found","$ebdcd16dd431135f$var$headersHas","$ebdcd16dd431135f$var$headersSet","$ebdcd16dd431135f$var$wrapRequestOptions","headers","fetch","$ebdcd16dd431135f$var$RequestConstructor","Request","$febce133319278e2$var$TypeError","passed","required","t1","e1","createDocumentFragment","Node","Document","DocumentFragment","insertBefore","firstChild","$cf5d938ee512ebca$export$96f6458b62e4c2c","pProject","pOptions","translateSmoothing","sizeWatcher","brushSettingService","emitSize","klCanvasWorkspace","setCursorSize","importFinishedLoading","importedImage","filename","optionStr","getResizedDimensions","width","height","w","h","klMaxCanvasSize","importAsImage","canvas","resizedDimensions","tempCanvas","$eWjiX","BB","getContext","drawImage","resizeCanvas","klCanvas","reset","image","layerName","layerManager","setCurrentLayer","getLayer","resetView","getScale","getAngleDeg","importAsImagePsd","convertedPsdObj","cropObj1","crop","targetCanvas","cropCanvas","cropObj","cropCanvas1","layers","i1","item1","layerIndex","showImportAsLayerDialog","klRootEl","transformObj","isPixelated","pause","addLayer","getLayers","renameLayer","activeLayerIndex","activeLayerContext","getLayerContext","drawTransformedImageWithBounds","tool","action","copyCanvas","popup","buttons","$hrnUX","KL","showImportImageDialog","maxSize","importAsLayer","files","showWarningPsdFlattened","extension","f1","maxResolution","doShowLoader","loaderIsOpen","closeLoader","FileReader","readerResult","loadAgPsd","agPsdLazy","convertedPsd","PSD","skipLayerImageData","skipThumbnail","alert","webkitURL","im","Image","loadImage","hasUnsupportedFile","collapseThreshold","getElement","setDirection","uiState","toolspaceCollapser","isOpen","css","setSize","uiWidth","toolWidth","uiHeight","setWide","statusOverlay","toolspace","borderLeft","borderRight","setUiState","updateCollapse","toolspaceScroller","updateUiState","layer","currentLayerCtx","context","currentBrush","setContext","layerPreview","setLayer","newImageDialog","currentColor","klColorSlider","getSecondaryRGB","getWidth","getHeight","innerWidth","handUi","onCancel","shareImage","shareCanvas","getCompleteCanvas","fileName","getDate","filenameBase","title","mainTabRow","activeStr","toolspaceToolRow","getActive","oldTabId","getOpenedTabId","keysArr","draw","hand","shape","setIsVisible","showCrop","clipboardDialog","inputObj","top","bottom","history","filterLib","cropExtend","updateBottomBar","isVisible","innerHeight","toolspaceInner","scrollHeight","bottomBarWrapper","screen","$6l0gQ","LocalStorage","app","projectStore","exportType","KlCanvas","projectObj","setHistory","initState","layerFill","g","copy","focus","getLayerCount","brushes","destroy","RGB","currentBrushId","lastNonEraserBrushId","BrushSettingService","setColor","copyObj","opacity","setOpacity","getColor","brushUiObj","getSize","getOpacity","sizeSlider","brushesUI","opacitySlider","lineSmoothing","EventChain","LineSmoothing","smoothing","LineSanitizer","lineSanitizer","setChainOut","pointerEvents","startLine","pressure","requestFrame","goLine","isCoalesced","setLastDrawEvent","endLine","getBrush","drawLineSegment","textToolSettings","align","isBold","isItalic","KlCanvasWorkspace","drawEventChain","chainIn","rgbObj","isDragDone","pickingDone","setMode","canvasX","canvasY","getLayerIndex","floodFill","fillUi","getTolerance","getSample","getGrow","getContiguous","angleRad","dialogCounter","textToolDialog","font","colorRGBA","text","textStr","ColorConverter","toRgbaStr","typeStr","shapeTool","onDown","onMove","onUp","onViewChange","viewChangeObj","changed","out","angleDeg","angle","setEnableZoomIn","getMaxScale","setEnableZoomOut","getMinScale","onUndo","canUndo","undoRedoCatchup","undo","canRedo","redo","KeyListener","keyStr","comboStr","isInputFocused","getIsDrawing","zoomByStep","keyListener","isPressed","fitView","preventDefault","sameKeys","getProject","t0","success","copyToClipboard","comboOnlyContains","translateView","setAngle","decreaseSize","increaseSize","eraserBrush","getIsTransparentBg","clearLayer","setActive","updateMainTabVisibility","brushTabRow","swapColors","KlImageDropper","onDrop","handleFileSelect","enabledTest","pasteEvent","clipboardData","getAsFile","retrieveImageFromClipboardAsBlob","imageBlob","img","onload","URLObj","getAsString","pasteStr","onerror","crossOrigin","hexToRGB","b1","Ui","onSizeChange","onOpacityChange","emitOpacity","onConfigChange","emitSliderConfig","ui","padding","StatusOverlay","oncontextmenu","onclick","handleClick","ToolspaceCollapser","overlayToolspace","OverlayToolspace","backgroundColor","toolspaceTopRow","$85H3x","ToolspaceTopRow","showIframePopup","abrupt","overlay","onLeftRight","updateUi","logoImg","onLogo","$5ebUJ","onNew","showNewImageDialog","onImport","fileTab","triggerImport","onSave","saveToComputer","save","onShare","addClassName","marginBottom","ToolspaceToolRow","onZoomIn","onZoomOut","onRedo","setIsSmall","addListener","setEnableUndo","setEnableRedo","KlColorSlider","startValue","onPick","p_color","emitColor","setHeight","setPickCallback","doPick","brushDiv","colorDiv","flexWrap","justifyContent","alignItems","toolspaceStabilizerRow","ToolspaceStabilizerRow","onSelect","setSmoothing","getOutputElement","TabRow","tooltip","brushId","onClose","keyArr","createTab","b2","HandUi","onFit","onAngleChange","isRelative","FillUi","colorSlider","TextUi","ShapeUi","ShapeTool","isDone","y2","shapeObj","shapeUi","getShape","isOutwards","getIsOutwards","getIsEraser","strokeRgb","lineWidth","getLineWidth","isAngleSnap","getIsSnap","isFixedRatio","getIsFixed","getMode","fillRgb","setComposite","drawShape","ctx","klLayerManager","LayerPreview","onClick","filterTab","FilterTab","UndoRedoCatchup","clctx","catchup","SaveToComputer","FileTab","imgurUpload","imgurKey","SettingsTab","$fxAg2","onOpen","minWidth","$2dTGs","$fuF9j","$adBnR","textUi","$cafM1","$23J3k","show","hide","$eIlXd","settingsTab","childList","subtree","ToolspaceScroller","resize","scrollY","scrollTo","_ref","swapUiLeftRight","saveAsPsd","_this","userSelect","_this1","ResizeObserver","windowResizeWatcher","e2","$iUR3L","importFilters","$9cbe98d1fb398012$export$6e4a713ddcda1e5e","$dAXbp","$3P46L","$7pyBK","$705qg","drawProject","$aSJRf","WorkspaceSvgOverlay","$7bo3M","$lV6Vy","KlCanvasPreview","$i5nyl","filterLibStatus","$kyVjY","$6rdi0","renderText","$h20yl","floodFillBits","$30Cml","$3ujzu","setDbName","$9BlwZ","indexedDb","ProjectStore","$6mTnI","$lkluh","$eyygR","calcSliderFalloffFactor","$l4PqG","Checkbox","$lXqiv","$c4LUw","Select","$21VAD","ImageToggle","$jKOQl","ImageRadioList","$gmlbk","RadioList","$bHZQg","penPressureToggle","$fCJWy","KlSlider","$llzZ0","HexColorDialog","$lfHl9","$h7i9r","KlSmallColorSlider","$kzhsD","PointSlider","$bd9hB","ColorOptions","$9A7OD","Options","$iskOY","BoxToggle","$iDHln","$bmB93","CropCopy","$hRdOL","FreeTransform","$cNhNm","FreeTransformCanvas","$kEeSq","Cropper","$32CBv","$kqmpc","FittedImage","$j1kEL","$13r5y","$9p4Zp","$8jqzp","ToolDropdown","$84zxV","$9Kxky","$1Ax5m","$e4sAN","$1uc3b","BrowserStorageUi","$9pcu9","$iVHpg","$i8UFO","$ekHRj","Popup","exportDialog","$auloj","$isYih","$8ebuX","$76Qvv","$keKW3","$kDGzx","$5ENro","$khi8I","$dJXmR","$iS9xS","$9J17G","$eK8ID","$2umOB","$bIgqE","$5rdL4","DecoyKlHistory","$b60fce38973759d6$var$historyInstance","$b60fce38973759d6$export$2a772a91f059c0f9","l","$b60fce38973759d6$export$1a1044741a812c67","dataArr","listeners","pauseStack","maxState","actionNumber","maxBefore","broadcast","bufferUpdate","$9fd01211d0fde0a8$export$63b4813c5280c707","clearSelection","focusEl","tagName","select","rootRootEl","decrease","destroyEl","xButton","bgEl","removeEventListener","rootEl","wheelPrevent","btnElArr","increase","overflow","minHeight","flexDirection","scrollContent","ignoreBackground","zIndex","$fh18w","titleHeight","lineHeight","background","boxShadow","marginRight","boxClasses","flex","boxEl","clickOnEnterBtn","stopPropagation","click","autoFocus","buttonRowEl","marginTop","marginLeft","buttonName","iconUrl","btnClasses","primaries","$c0kqC","iconImg","custom","btn","clickOnEnter","closefunc","onscroll","clearInterval","updatePos","elW","popupEl","offsetWidth","elH","offsetHeight","animationName","animationDuration","animationTimingFunction","isCssMinMaxSupported","borderRadius","titleEl","paddingLeft","tabindex","contentEl","$dd0d395ff14a3e11$export$17eb8275e0c4cab8","$dd0d395ff14a3e11$export$f5386afdb763a67e","listener","$05ec456c8871d48f$export$921068d8846a1559","eventUsesHighResTimeStamp","$6J2My","mouseEventHasMovement","hasPointerEvents","hasWebGl","getVisitor","canShareFiles","insertAfter","$7jh4K","setAttributes","removeClassName","fitInto","centerWithin","gcd","decToFraction","imageBlobToUrl","dateDayDifference","createSvg","BbLog","$i0uIf","mix","$eg83P","dist","distSquared","lenSquared","pointsToAngleRad","pointsToAngleDeg","rotate","rotateAround","Matrix","$kVHNC","Vec2","$4toIY","intDxy","roundEven","roundUneven","updateBounds","boundsInArea","projectPointOnLine","$af1iA","PointLine","BezierLine","SplineInterpolator","quadraticSplineInput","$eelgW","createCanvas","$eIcQa","testShouldPixelate","drawTransformedImageOnCanvas","createCheckerCanvas","createCheckerDataUrl","convertToAlphaChannelCanvas","freeCanvas","HSV","$dJ1E2","CMYK","testIsWhiteBestContrast","appendTextDiv","$72Jv0","makeUnfocusable","$h4olN","setEventListener","$idV3L","PointerListener","$04lDo","$exufe","$cdd5ef6b176accd6$export$d031894fc27e45","DomEl","$cdd5ef6b176accd6$export$3f65cefe8380dbea","$cdd5ef6b176accd6$export$8ff9f68337b520c0","hasWebgl","visitor","$878b1f179a521546$export$b7d78993b74f766d","navigator","userAgent","$878b1f179a521546$export$4ec3bfbae69fbb50","Event","timeStamp","$878b1f179a521546$export$ebcc19037a7ab076","mouseEvent","MouseEvent","$878b1f179a521546$export$b7b64c480b083ae0","PointerEvent","$878b1f179a521546$export$9cbe517943afd6db","premultipliedAlpha","$878b1f179a521546$export$96cd70eaafd80100","chrome","gl","$878b1f179a521546$export$fe0a7220ab4eecad","offsetLeft","$878b1f179a521546$export$558f5e20caee48c2","$44dda2e48e48a872$export$cd3d1f114b139967","$2bd9b7b9bc92046d$export$c4f94c8b3850a5a9","referenceNode","newNode","nextSibling","$2bd9b7b9bc92046d$export$fe58198efe02b173","check","$2bd9b7b9bc92046d$export$dbf350e5966cf602","styleObj","alignContent","webkitUserSelect","$2bd9b7b9bc92046d$export$74da2cba014bdc09","attrObj","setAttribute","$2bd9b7b9bc92046d$export$5cf2b5b76bc9d0c","classStr","classAttr","getAttribute","splitArr","$2bd9b7b9bc92046d$export$1789407f05ca7654","$2bd9b7b9bc92046d$export$10d8903dec122b9d","els","$2bd9b7b9bc92046d$export$fa55905620c22535","aw","ah","bw","bh","$2bd9b7b9bc92046d$export$76d0c1a172b67a61","$2bd9b7b9bc92046d$export$aa350b96d91cd94","date","getFullYear","getMonth","getHours","getMinutes","$2bd9b7b9bc92046d$export$f81847884871263e","$2bd9b7b9bc92046d$export$533b26079ad0b4b","numerator","denominator","$2bd9b7b9bc92046d$export$8215e6b900906daa","decimalNumber","$2bd9b7b9bc92046d$export$5063ec57a23c4f2e","blobObj","Blob","fauxBlob","encoding","$2bd9b7b9bc92046d$export$1093707c159148e8","dateA","dateB","setHours","getTime","$2bd9b7b9bc92046d$export$af0d87255f3cfd7e","$2bd9b7b9bc92046d$export$331c30fd60da0115","mimetype","toBlob","filesArray","File","share","$2bd9b7b9bc92046d$export$b981489921ee18cd","clickEvent","allowClick","$2bd9b7b9bc92046d$export$c54fe3b9ecaa84cf","createElementNS","elementType","childrenArr","$74d1f29ad2137b2c$var$globalKey","emitDown","d","listenerArr","emitUp","keyDown","keyCode","keyToKeyStrObj","isDownObj","comboArr","codeIsDownObj","keyUp","oldComboStr","blur","eventArr","keyToKeyStrArr","i2","keyStrToKeyObj","alt","ctrl","cmd","esc","backspace","sqbr_open","sqbr_close","plus","minus","up","down","home","code1","remove","getIsDown","getCombo","$74d1f29ad2137b2c$export$f17908c5de22d32e","onBlur","ref","keyStrArr","$74d1f29ad2137b2c$export$e9f65b0175de4c03","comboAStr","comboBStr","pointerArr","pressureNormalizeAvgCount","pressureNormalizeAvgPressure","pressureNormalizeIsComplete","pressureNormalizeFactor","$893e90c2dcf687ac$var$WheelCleaner","endSequenceTimeout","deltaY","sequenceUnit","pageX","pageY","clientX","clientY","endSequence","toEmitDelta","knownUnitArr","sequenceLength","clearTimeout","deltaMode","absDelta","$893e90c2dcf687ac$export$9371bd96776f4e82","getDragObj","pointerId","dragObjArr","removeDragObj","removedDragObj","dragPointerIdArr","normalizePressure","correctPointerEvent","corrected","correctedObj","pointerType","movementX","movementY","timeStampOffset","button","coalescedArr","eventStopPropagation","customPressure","isFirefox","coalescedEventArr","getCoalescedEvents","getPointer","pointerObj","lastPageX","lastPageY","addPointer","totalLastX","totalLastY","eventItem","correctedEvent","targetElement","getBoundingClientRect","bounds","eventPreventDefault","coalescedItem","relX","relY","dX","dY","time","createTouchOutEvent","touchListItem","touchEvent","identifier","destroyDocumentListeners","onGlobalPointerMove","onGlobalPointerUp","onGlobalPointerLeave","onPointerEnter","isOverCounter","onEnterLeaveCallback","onPointerLeave","onPointermove","tempLastPointerType","lastPointerType","maxPointers","didSkip","outEvent","createPointerOutEvent","dragObj","downPageX","downPageY","buttonsToStr","clearTouchTimeout","setTouchTimeout","lastTimeStamp","outEvent1","onPointerCallback","touchTimeout","fakeEvent","performance","onTouchTimeout","onPointer","onWheelCallback","onWheel","onEnterLeave","wheelEvent","timing","navigationStart","onPointerdown","wheelCleaner","touchArr","changedTouches","touchObj","onTouchmove","onTouchend","$9a5bdb07e7a7c42f$export$2c9e8a9632a706b2","$9a5bdb07e7a7c42f$export$6c4a311cc157c764","ax","ay","bx","by","$9a5bdb07e7a7c42f$export$499eb56409f6cbc2","$9a5bdb07e7a7c42f$export$a4f99f99d3e99cfa","$9a5bdb07e7a7c42f$export$627023b405ba5028","p2","atan2","$9a5bdb07e7a7c42f$export$c03a8450eabc2532","$9a5bdb07e7a7c42f$export$7d15b64cf5a3a4c4","num","$9a5bdb07e7a7c42f$export$bb628a54ab399bc9","deg","theta","cs","cos","sn","sin","$9a5bdb07e7a7c42f$export$95ec0760d3d00713","center","rot","$9a5bdb07e7a7c42f$export$bbf9af158036c5e9","remainder","fDx","fDy","$9a5bdb07e7a7c42f$export$94cce7adf2ec2d08","above","below","$9a5bdb07e7a7c42f$export$f373b6a7b0c159a","$9a5bdb07e7a7c42f$export$f4467a4f41373bc7","$9a5bdb07e7a7c42f$export$bbb91bbc54e7d9ac","$12950380ec51f25d$export$649a211db9812745","continueChain","chainArr","chainOut","$12950380ec51f25d$export$db3963a21c01d803","sequenceArr","timeoutObj","maxUntilSecondDown","eventQueueArr","lastSequenceItem","onDoubleTap","setupTimeout","timeoutStr","targetFunc","timeMS","diff","nowTime","minSilenceBeforeDurationMs","maxPressedDurationMs","maxPressedDistancePx","maxInbetweenDistancePx","maxUpToUpDurationMs","maxUntilSecondDownDurationMs","minSilenceAfterMs","allowedPointerTypeArr","allowedButtonArr","pointersDownIdArr","lastUpTime","isDown","isUp","processEvent","setAllowedPointerTypeArr","arr","setAllowedButtonArr","firstDownTime","firstLastDownTimeout","tapTimeout","fingerArr","lastEventTime","fingers","maxFirstLastFingerDownMs","downTime","tempLastEventTime","maxTapMs","fingerObj","fingerObj1","i3","allAreUp","i4","onTap","gestureObj1","doSwallow","secondFingerTimeout","touchPointerArr","isInProgress","continuePinch","otherPointerIdArr","downRelX","untilSecondFingerDurationMs","i6","i7","endPinch","touchPointerObj","i5","downRelY","firstFingerMaxDistancePx","gestureObj","pincherArr","actionObj","startDist","distance","startAngle","onPinch","beginPinch","$12950380ec51f25d$export$fe11e0afe623a677","eventCopy","pointers","downPointerId","ignorePointerIdArr","pressure0","pressure1","eventQueue","shiftIsPressed","direction","downEvent","onDraw","i8","$12950380ec51f25d$export$91dcf4209534d21f","lastMixedInput","inputX","inputY","inputPressure","$3f0e2f35371c9852$export$dd0873c0fb3ccff6","resultCanvas","$3f0e2f35371c9852$export$1555f643cc9a976","transform","scaleX","scaleY","whSwapped","$3f0e2f35371c9852$export$ded2b43392504635","destCtx","transformImage","pixelated","imageSmoothingEnabled","imageSmoothingQuality","translate","restore","$3f0e2f35371c9852$export$425a419ef9fc761f","baseCanvas","angleDegree","cache","$3f0e2f35371c9852$export$754559b36e94ea2f","fillStyle","fillRect","$3f0e2f35371c9852$export$42af33c76b681867","size1","toDataURL","$3f0e2f35371c9852$export$59b33278b5b2fc8a","tmp1","tmp2","oldW","oldH","newW","newH","ew","eh","base2","oldWidthEx","oldHeightEx","newWidthEx","newHeightEx","buffer1","buffer2","bufferCtx","globalCompositeOperation","currentWidth","currentHeight","newWidth","newHeight","tmp","canvasCtx","tmp1Ctx","$3f0e2f35371c9852$export$5a7576952c826b4f","imdat","getImageData","putImageData","$3f0e2f35371c9852$export$2384aff49c9b73c2","clearRect","multiplyMatrixAndPoint","$e4df33b4b16105d5$export$5b12bf1653c0dd85","getIdentity","matrix","multiplyMatrices","matrixA","matrixB","row0","row1","row2","row3","result0","result1","result2","result3","createTranslationMatrix","createRotationMatrix","createScaleMatrix","$531c9f41f98b7ec0$export$ac4bca90992eed1","nor","mul","dot","aArr","bArr","$77ae015f37ebe4f1$export$b4c5b177db876445","lineStart","lineEnd","$77ae015f37ebe4f1$export$8b36a4a83269a640","segmentArr","points","getAtDist","getLength","fac","lastAngle","pointArr","lastSpacing","spacing","controlsCallback","lastPoint","dir","lastDot","pointM1","pointM2","pointM3","curvePoints","p3","p4","resolution","getBezierPoints","pointLine","tempSpacing","lastCallbackPoint","dAngle","addFinal","newP","xa","ya","wx","sig","ddydx","getFirstX","getLastX","interpolate","klo","khi","$77ae015f37ebe4f1$export$80967b1eb9fd6eb4","findX","$5e7aac2fa49b6b1f$export$d2edaecd208aed43","$5e7aac2fa49b6b1f$export$8f9ece5a47764b93","$5e7aac2fa49b6b1f$export$89d3f85304bf0767","$5e7aac2fa49b6b1f$export$fb7efcd2e153af6e","_RGBtoHSV","minVal","maxVal","del_R","del_G","del_B","_HSVtoRGB","var_h","var_i","var_1","var_2","var_3","var_r","var_g","var_b","_CMYKtoRGB","_RGBtoCMYK","toRGB","o","toHSV","toCMYK","toHexString","ha","hb","hc","toRgbStr","rgbaObj","hexStr","$5e7aac2fa49b6b1f$export$5cf396345d1238ae","$cfe3aa45a75894cc$export$7868464f598ba79d","innerHTML","$cfe3aa45a75894cc$export$906dfdb7df31ccfc","activeElement","$cfe3aa45a75894cc$export$a3d02541b0ebf605","getSelection","sel","empty","removeAllRanges","selection","preventFocus","$cfe3aa45a75894cc$export$6bd63bfceaafae0c","didFocusRelated","relatedTarget","currentTarget","$cfe3aa45a75894cc$export$c3da0dad1b44eea9","$cfe3aa45a75894cc$var$els","onChange","customKeyArr","$cfe3aa45a75894cc$export$b1da1db524e22115","$0d0e99c175410ac4$export$9860cd9e09e6f8ba","msg","$9e5fd8359d8b22f2$export$19fffca37ef3e106","localStorage","getBundleURL","$d82e0c66c1aaca81$export$48513f6b9f8ce62d","innerEl","checked","doHighlight","allowTab","tabIndex","onchange","$aa0ec58519fa7d10$export$b7e3ae3d7c15e42e","$eb01976a4bab51ce$export$ef9b1a59e592288f","selectEl","changeListener","cursor","fontSize","colorScheme","isFocusable","optionArr","option","initValue","$5cde84e643fb89d6$export$b6d053cded550773","isActive","backgroundImage","isRadio","setValue","getValue","$459eb3dcb08ae3f8$export$7cc1012a658e6ad8","activeIndex","createOption","initId","radioEl","$12a3b74a8702bb1f$export$77219f67585650fa","isChecked","changeCallback","redraw","toggleDiv","border","cssFloat","$e1Rnq","backgroundSize","backgroundRepeat","boxSizing","$cf8be10874d1afb1$export$a1855b925e534de7","splineInterpolator","toLinearValue","useSpline","updateEnable","isEnabled","getOutsideVal","linearValue","updateLabel","pLinearValue","outVal","formatFunc","languageStrings","getCode","labelCaption","control","elementWidth","isFinal","isChangeOnFinal","eventResMs","lastCallbackTime","virtualVal","deltaX","curve","elementHeight","curveArr","controlInner","labelFontSize","pointerListener","pointerListenerTimeout","fixScribble","increaseValue","decreaseValue","config","setIsEnabled","isDisabled","$0c2dd884393cffca$export$f8e41e222e32615d","isRightButton","$dada52d673c8c4ac$export$cc42e119007cb939","createRgbInputRow","labelStr","attributeStr","rowEl","labelEl","inputEl","lastValidRgb","previewEl","hexInput","hexRowEl","hexLabel","rgbArr","copyButton","$fcsnL","execCommand","resultStr","$9eeb6c00ea2d3242$export$4e5102252876c5d7","updatePrimaryHSV","hsv","primaryColorHSV","updateSVCanvas","rgb","hueStop","updateSVPointer","svHeight","pointerSV","setColPreview","divPreview","primaryColorRGB","pickerButton","hexButton","updateSecondaryColor","secondaryColorBtn","secondaryColorRGB","secondaryColorHSV","controlH","pickCallback","outputDiv","svWrapper","svSvg","DOMParser","parseFromString","documentElement","divH","SVContainer","virtualHSV","$1nsGS","backgroundPosition","isPicking","isOver","targetEl","cv","gradH","createLinearGradient","col","addColorStop","createHueBg","factor","$3ac3f56275b45315$export$dcd33f7653c95f09","updateSV","canvasSV","gradient1","colleft","colright","heightSV","updateHPointer","pointerH","canvasH","heightH","svPointerId","svPointerListener","hPointerId","hPointerListener","cleardiv","$0b17443c34517974$export$ac00cea56cec3037","param","redrawPoint","sliderPoint","sliderPos","isDragging","pointSize","sliderLine","isFirst","imaginaryPos","margin","transition","$a19b2655062f09b7$export$24ba9b81662d4366","buttonArr","setIsSelected","selectedIndex","colorArr","checkerUrl","sItem","initialIndex","colorButton","buttonSize","textAlign","$c8511e371b1e3768$export$c019608e5b5bb4cb","optionObj","classArr","isSmall","wrapperEl","selectedId","getIndex","initialId","changeOnInit","$c1a93a3cd82636c9$export$5ee0af1d5c87e856","removeProperty","isWide","angleIm","$bv5Zj","verticalAlign","innerInnerEl","doPulse","animation","timeout3","timeout","timeout2","$81ac8fccf3fa43c3$export$8e17099f54853f0e","aboutDiv","aniToggle","imageContainer","coverImage","coverSize","aniTimeout","boxSize","ontouchstart","ontouchmove","ontouchend","$01fcd0ed15aa4018$export$40175a5948a88a57","resetCrop","updateCroppedCanvas","croppedCanvas","croppedImage","updateSelectionRect","selectionRect","thumbX","scaleW","thumbY","scaleH","toOriginalSpace","genCrop","topLeftP","bottomRightP","origTopLeftP","origBottomRightP","isReset","eventTarget","isNotCopy","previewWrapper","thumbSize","thumbCanvas","imageRendering","thumbCtx","startP","updateCropTimeout","startCrop","didMove","rect","doUpdate","stepSize","getRect","getCroppedImage","$ffd40240385bb9f9$export$32b89bc9bb92706a","fullCanvas","cropCallback","toClipboard","imgURL","cropCopy","clipboard","ClipboardItem","topWrapper","borderTop","borderBottom","KeyEvent","rectObj","$aacd8170d7ccb1c6$export$56cc6eb0b4c43d97","p_canvas","p_func","p_rootDiv","oldHistoryState","row","clearBtn","$8yL1I","suggestions","suggestionBtns","createLayerList","updatefunc","createLayerEntry","klCanvasLayerArr","layercanvas","layerElArr","posY","innerLayer","container1","container2","spot","oldOpacity","thumbDimensions","thumb","thc","lname","whiteSpace","ondblclick","opacityLabel","sliderValue","isLast","layerOpacity","largeThumbCanvas","largeThumbDiv","largeThumbInDocument","largeThumbInTimeout","largeThumbTimeout","dragstart","freshSelection","lastpos","isSelected","div1","activateLayer","updateLayersVerticalPosition","posToSpot","newSpot","oldSpot","move","selectedSpotIndex","layerListEl","child","updateHeight","layerHeight","layerSpacing","newspot","posy","oldSpotIndex","newSpotIndex","moveLayer","mergeBtn","disabled","listdiv","disableButtons","enableButtons","div2","modeWrapper","modeSelect","addnewBtn","duplicateBtn","removeBtn","renameBtn","paddingRight","$d42vI","$dKwR8","$3VpTB","$g91IK","clearboth","MAX_LAYERS","duplicateLayer","removeLayer","mixModeStr","$bBcC4","translateBlending","topCanvas","preview","spacer","alphaCanvas","bottomCanvas","globalAlpha","topOpacity","mergeDialog","mergeLayers","setMixMode","setInterval","historyState","activeLayerSpotIndex","getSelected","spotIndex","stateStr","$0621fc8724f6bfac$var$allowedMixModes","$0621fc8724f6bfac$export$9f4f73b1bd7c2f26","$0621fc8724f6bfac$export$4a819bde91671014","layerNrOffset","layerCanvasArr","pickCanvas","changeListenerArr","origLayers","updateIndices","toCopyCanvas","algorithm","layerCanvas","layerContext","offX","offY","ctemp","layerCtx","fillColor","selected","isLayerLimitReached","doReturnNull","emitChange","layerBottomIndex","layerTopIndex","isHorizontal","isVertical","tempCtx","colorObj","compositeOperation","tolerance","sampleStr","grow","isContiguous","srcData","targetCtx","targetImageData","srcCanvas","srcImageData","srcCtx","srcIndex","targetData","imageData","canvasObj","$7069db2f5e23d00f$var$fillRect","$7069db2f5e23d00f$var$mx","$7069db2f5e23d00f$var$my","$7069db2f5e23d00f$var$moveIndex","$7069db2f5e23d00f$var$testAndFill","srcArr","targetArr","initRgba","px","py","tl","tr","br","bl","$01d7180c5d1d0fdf$export$27550cc14d7ae85a","downX","downY","downAngleRad","onShape","$01d7180c5d1d0fdf$export$71b514a25c47df50","isEraser","strokeStyle","r1","r2","pAngleDeg","pAngleDegSnapped","rotated","r11","r21","ry","rdX","rdY","x1r","y1r","x2r","y2r","x1f","y1f","x2f","y2f","beginPath","moveTo","lineTo","stroke","x1f1","y1f1","x2f1","y2f1","strokeRect","ellipse","$fdc12d72a3df9be9$export$482c90f94eb9717c","outer","fontFamily","fontWeight","fontStyle","spanStr","children","offsetTop","el1","fillText","innerText","isDebug","$089586a542a12f27$export$5f63a7b18dc4503a","$2f1281ced73ab1dc$export$6e1bedb2a6cdff30","blendMode","codes","darken","multiply","lighten","exclusion","hue","saturation","luminosity","$d256278b259ca979$export$6b9252711ea5997f","rootElement","brushCircleOuter","brushCircleInner","pickerPreviewBorder","pickerPreviewCol","compassSize","compass","compassInner","compassBaseCircle","cx","cy","compassLineCircle","compassUpperTriangle","compassLowerTriangle","radius","borderColor","TMode","$d492af58f4721011$var$MIN_SCALE","$d492af58f4721011$var$TMode","$d492af58f4721011$export$6eaf6f7c0cc177fc","renderTargetCanvas","renderTargetCtx","renderWidth","renderHeight","compositeCanvas","compositeCtx","doResizeCanvas","oldTransformObj","targetTransformObj","highResTransformObj","renderedTransformObj","cursorPos","usesCssCursor","bgVisible","transformIsDirty","doAnimateTranslate","svgOverlay","emptyCanvas","isRepeat","currentInputProcessor","onKeyDown","Draw","Pick","Fill","Text","Shape","globalMode","inputProcessorObj","spaceHand","Hand","altPicker","zoom","onKeyUp","updateChangeListener","currentMode","renderTime","lastDrawEvent","linetoolProcessor","LinetoolProcessor","getMatrix","art","_this2","getRenderedTransform","matrix2","coords","matrix1","coords1","coords2","reqFrame","updateCursor","getComboStr","resetInputProcessor","coord","workspaceToCanvasCoord","onFill","onText","HandGrabbing","Zoom","offsetX","offsetY","internalZoomByStep","lastRenderedState","picker","pickedColor","getColorAt","updateColorPreview","Rotating","Rotate","centerObj","startAngleRad","dAngleRad","minimizeAngleRad","angleIsExtraSticky","pinchZoomer","PinchZoomer","snapAngleRad","oldTransform","mainDoubleTapper","DoubleTapper","middleDoubleTapper","twoFingerTap","NFingerTapper","threeFingerTap","pointerEventChain","OnePointerLimiter","CoalescedExploder","_this3","brushRadius","animationFrameRequested","lastRenderTime","updateLoop","addChangeListener","modeInt","doForce","oldMode","$hNEwm","$iOLNv","$3zTyb","$kFdtJ","oldIsHand","currentIsHand","stepNum","centerX","centerY","newStep","newScale","effectiveFactor","transformA","transformB","blendFactor","centerPosA","canvasToWorkspaceCoord","centerPosB","mixedPos","workspacePointArr","borderSize","layerArr","getLayersFast","compositeObj","updateCompass","snapDegIncrement","maxDistDeg","modDeg","doRedrawCanvas","requestAnimationFrame","newState","elapsedFrames","doRender","checkChange","testBgVisible","render","klC","oldWidth","oldHeight","modeStr","diameter","hideBrushCursorTimeout","doAnimate","canvasPointsArr","boundsObj","boundsWidth","boundsHeight","oldAngleRad","tx","ty","$6faa9d948ec87f40$export$e258ade1648009b7","$0370167ee97a20d9$var$snapToPixel","$0370167ee97a20d9$var$copyTransform","$0370167ee97a20d9$var$toTransformSpace","$0370167ee97a20d9$var$toImageSpace","$0370167ee97a20d9$export$79a74567acf241b0","classCallCheck","scaled","corners","minSnapDist","cornerCursors","gripSize","edgeSize","edges","isConstrained","snapX","snapY","snappingEnabled","ratio","transEl","boundsStartP","snap","iP","distX","distY","projected","dist1","updateCornerPositions","updateDOM","virtualPos","offsetArr","tinyOffset","constrainCorner","snapCorner","tP","indexes","updateTransformViaCorners","angleOffset","isInverted","pointerRemainder","tfD","ti","dimension","restoreRatio","angleGrip","$lQMok","anglePointerListener","snapDeg","iX","iY","cornerIndex","flip","widthChanged","heightChanged","angle90","newHeight1","skipCallback","transformOrigin","boundsEl","$48f5d87739d28bf9$export$205c2dd29f8a66b5","updatePreview","freeTransform","getTransform","destCanvas","previewLayerArr","transformIndex","initTransform","klCanvasPreview","imageWidth","imageHeight","previewFit","innerWrapper","transformSize","setPos","setAngleDeg","fit","setTransformCenter","getTransformation","getIsPixelated","$de496a1759b04ed9$export$71ed2b85d4ca43d3","transformTop","grips","maxH","transformRight","maxW","transformBottom","transformLeft","commit","cornerElArr","outline","thirdsHorizontal","thirdsVertical","gripCursors","outlinePointerListener","gripOverlay","edge0PointerListener","edge1PointerListener","edge2PointerListener","edge3PointerListener","corner0PointerListener","corner1PointerListener","corner2PointerListener","corner3PointerListener","setTransform","setScale","showThirds","$18e69c7d4cb991e8$export$d25420b53e16716f","layerObj","largeCanvasAnimationTimeout","isInstant","nameLabelEl","opacityEl","lastDrawnSize","canvasDimensions","canvasSize","animationCanvas","animationCanvasCtx","animationCanvasCheckerPattern","animationCount","animationLength","animate","drawLargeCanvas","lastDrawnState","largeCanvasIsVisible","largeCanvasSize","largeCanvas","largeCanvasCtx","largeCanvasCheckerPattern","largeCanvasWrapper","removeLargeCanvas","largeCanvasAnimationDurationMs","contentWrapperEl","canvasWrapperEl","nameWrapper","flexGrow","nameFadeEl","clickableEl","webkitTouchCallout","createPattern","showLargeCanvas","currentState","klCanvasLayerObj","$a29ff52bf33e0691$export$83ae33786c7b4ee5","$e3dfa43019bc3f08$export$962af7e240721d88","freeTransformCanvas","noteEl","originalSizeBtn","fitSizeBtn","setTransformFit","centerBtn","importImage","buttonStr","$01cb8095758db224$export$e789742143ba5b1","rootCounter","optionLayerCounter","optionImageCounter","testAcceptType","dataTransfer","types","updateOptions","optionLayerEl","optionImageEl","paddingTop","textShadow","optionStyle","$d6fe881e8fc421ac$export$9f0da9b942594e99","updateColor","selectedColorEl","updateUI","mousePos","sizeObj","hHeight","sliderHeight","queuedObj","subscriptionFunc","initialColor","sliderConfig","getSliderConfig","$6003e73b8cbb69e2$export$665d2c76b1eb8459","createButton","extraPadding","contain","logoButton","$8oUiM","newButton","$1gUFn","importButton","$gswMe","saveButton","$lLh5u","shareButton","$5xpQb","helpButton","onHelp","$kS5uZ","$18c597dee53260ff$export$a0a40f8a0b8fee15","createDropdownButton","dropdownWrapper","smallMargin","onClickDropdownBtn","closeDropdown","currentActiveIndex","updateButton","showDropdown","dropdownBtnArr","arrowButton","activeButton","titleArr","activeButtonIm","imArr","openTimeout","startX","startY","elementFromPoint","$gzZrf","borderBottomLeftRadius","borderBottomRightRadius","$a372d78c806cd0cc$export$c744a22bef9e0b97","doEmit","currentActiveStr","toolDropdown","handButton","onActivate","doLighten","doMirror","createTriangleButton","svg","viewBox","preserveAspectRatio","defs","in","stdDeviation","dx","dy","in2","operator","k2","k3","svgTriangleLeft","class","onLeft","svgTriangleRight","onRight","leftPointerListener","rightPointerListener","leftIm","leftImage","rightIm","rightImage","setIsEnabledLeft","setIsEnabledRight","zoomInNOutButton","$3KoFh","$eWf2I","zoomInButton","zoomOutButton","undoNRedoButton","$fc34V","undoButton","redoButton","$90c04b5ac185bf3d$export$8162a66cd18867a7","strengthSelect","setDeltaValue","$d04d72b97d637d65$export$3c6d17ed0106bfb9","pTabObj","useAccent","openedTabObj","tabDiv","openedTabObj1","roundRight","roundLeft","tabArr","roundSize","$4m0AU","tabId","$9934467c988b088a$export$cf20160367bae46c","scaleEl","angleEl","resetButton","onReset","fitButton","leftRotateButton","$2n4Fs","resetAngleButton","rightRotateButton","pIsVisible","pScale","$51d47356d698ffec$export$1e63e3b0645421a2","toleranceSlider","selectRow","growWrapper","growSelect","contiguousToggle","$d06987f550ff485e$export$32a22540e4b2f123","$45c003c723de07b5$export$a9387b1d4260d39c","updatePreviews","strokeWidth","lineWidthSlider","squish","rectStrokeSvgRect","rectFilledSvgRect","ellipseStrokeSvgEllipse","ellipseFilledSvgEllipse","lineSvgLine","fixedToggle","previewPadding","previewSize","snapToggle","rectStrokeSvg","rectFilledSvg","ellipseStrokeSvg","ellipseFilledSvg","lineSvg","shapeOptions","eraserToggle","outwardsToggle","$4fb68589de8a8c9a$export$f77a89101d7d6586","createRatioSize","ratioX","ratioY","maxCanvasSize","updateRatio","widthInput","heightInput","commonRatios","reducedArr","closestRatio","closestDistance","ratioWrapper","realw","U","HCF","secondaryColor","canvasWidth","canvasHeight","workspaceWidth","workspaceHeight","onConfirm","newImDiv","widthWrapper","heightWrapper","widthUnit","heightUnit","templateWrapper","presetFitBtn","presetCurrentBtn","presetSquareBtn","presetLandscapeBtn","presetPortraitBtn","presetOversizeBtn","sizeObj1","backgroundRGBA","colorOptionsArr","colorOptions","previewcell","cell","onkeyup","secondRow","secondRowLeft","$3f73fb4b1b574d52$export$5b91f641162972fc","icon","directionStr","$jiQkU","dirStr","$cd9e7df6e228ea45$export$e263e067d6140649","textCtx","textCanvas","objectSpread","textInput","alignRadioList","italicToggle","boldToggle","sizeInput","fontSelect","rotatedXY","rotatedWH","fitBounds","zoomFac","previewCanvas","layersCtx","previewCtx","checkerPattern","layersCanvas","changeZoomFac","zoomInBtn","canZoom","zoomOutBtn","onScroll","isSmallWidth","isSmallHeight","touchAction","previewPointerListener","row2n3Wrapper","fontPointerListener","zoomWrapper","sizePointerListener","$2dqOY","$rk4vM","$hucjG","$cZa2s","$03Zd8","placeholder","$c8d2eb7d799b314c$export$1bf16d9bd59fd8f9","resolutionEl","updateResolution","flattenCheckbox","doFlatten","noteStyle","warningArr","psdWarningArr","contentArr","warningMap","mask","clipping","adjustment","showWarnings","noteEl1","cropRect","$4c230b0de5e1a470$var$kl2PsdMap","$4c230b0de5e1a470$var$psd2KlMap","$4c230b0de5e1a470$var$init","$4c230b0de5e1a470$export$6df36f0c42d2440f","$4c230b0de5e1a470$export$4e3b1f7d3ad623b4","$4c230b0de5e1a470$export$3d649861c4b13fa2","psdObj","addWarning","warningStr","getMixModeStr","prepareMask","maskCanvas","defaultColor","groupMaskCtx","imData","bitsPerChannel","maxLayers","layerCount","countWithinGroup","groupObj","convertGroup","psdGroupObj","groupCanvas","groupCtx","resultArr","groupOpacity","hidden","groupMixModeStr","hasClipping","innerArr","innerItem","innerCtx","clippingCanvas","clippingCtx","clippingItem","effects","clippingCanvas1","clippingCtx1","clippingItem1","$4c230b0de5e1a470$export$56493bf279c387b3","klPsd","$41164c8aeaf53227$var$indexedDbIsSupported","indexedDB","$41164c8aeaf53227$var$dbNameStr","$41164c8aeaf53227$var$storageNameStr","$41164c8aeaf53227$export$1347f8be1f25c479","$41164c8aeaf53227$var$execIndexedDBTransaction","actionFunction","successCallback","errorCallback","onError","errorStr","hasFinished","requestObj","createObjectStore","keyPath","createIndex","unique","databaseObj","objectStoreNames","contains","deleteDatabase","storeObj","transactionObj","transaction","objectStore","e3","oncomplete","$41164c8aeaf53227$export$1448a0dd0d3fde8e","$41164c8aeaf53227$export$21ade4eb935254aa","storageProject","put","$41164c8aeaf53227$export$42ffd38884aecdac","$805be15a1e91c0ee$export$7a4e0b62a5d854bc","isLoaded","$805be15a1e91c0ee$export$395d33c8e06b92c9","glBrightnessContrast","lang","buttonLabel","webgl","updateContext","$8k5kH","getDialog","inEmbed","$4UkHZ","neededWithWebGL","glCurves","$e7LnL","$iI5sC","glHueSaturation","$eySuj","invert","$iPRwU","glPerspective","$krmR4","$92iBR","glTiltShift","$bFASM","toAlpha","$9m6gZ","$4fkq2","ieFails","glBlur","$dPWA8","glUnsharpMask","$cQHFd","$805be15a1e91c0ee$var$updateNames","$42ac5b30ad65dabb$export$7d68cd8857639377","PenBrush","$68QTJ","BlendBrush","$5PSXS","SketchyBrush","$ewgr9","PixelBrush","$kic4a","ChemyBrush","$6Nq1H","SmudgeBrush","$ltaBP","EraserBrush","$7cUpm","$3f0923cd3c55ea92$export$6f96c8f9e6ae7341","historyEntry1","settingColor","settingColorStr","updateAlphaCanvas","settingAlphaId","ALPHA_CIRCLE","ALPHA_SQUARE","instructionArr","alphaCanvas128","alphaCanvas64","alphaCanvas32","alphaOpacityArr","$5CF7D","alphaImArr","drawDot","before","settingLockLayerAlpha","arc","twoPI","closePath","targetMipmap","ALPHA_CHALK","bezierLine","lastInput","dotCallback","localPressure","lastInput2","localOpacity","settingOpacity","settingHasOpacityPressure","localSize","settingSize","settingHasSizePressure","drawArr","localSpacing","settingSpacing","actions","continueLine","loopDist","mouseDist","eX","eY","bdist","historyEntry","setAlpha","setSpacing","sizePressure","opacityPressure","setLockAlpha","getSpacing","$ff6c1f784f50f5d5$export$d116ae91f77f1f19","$74D3O","genBrushAlpha01","genBrushAlpha02","$f875015ce1aeb4d3$export$74a44bbc21d06a28","scaleFac","createImageData","sFac2","$gZSR2","noise","simplex2","noisePattern","centerDist","$f875015ce1aeb4d3$var$udSegment","ba","pa","$f875015ce1aeb4d3$export$eaa218d5d17c8f1c","pDist","centerSize","transitionSize","$dfc47a34ad9bc378$var$myModule","$dfc47a34ad9bc378$var$Grad","dot2","$dfc47a34ad9bc378$var$grad3","$dfc47a34ad9bc378$var$p","$dfc47a34ad9bc378$var$perm","$dfc47a34ad9bc378$var$gradP","$dfc47a34ad9bc378$var$F2","$dfc47a34ad9bc378$var$G2","xin","yin","j1","gi0","gi1","gi2","$02d77b8dd5755328$var$cellSize","$02d77b8dd5755328$var$clamp","$02d77b8dd5755328$export$9659db8d01dd5313","isTesting","blending","settingSizePressure","settingOpacityPressure","blendCol","blendMix","redrawBounds","cells","getTouchedCells","isTouched","touchedCells","cellsW","getCellsWidth","cellOffsetX","cellOffsetY","cellWidth","cellHeight","inCellBounds","tmpCtx","alpha","ar","ag","ab","aa","sliceBounds","randI","randLen","randArr","samples","samplesSquared","sampleOffsets","sharpness","invSharpness","sharpnessSubtrahend","sizeSquared","distDivisor","alphaMinuend","slicedBounds","ri","alphaO","alphaU","underR","invAlphaO","underG","underB","underR1","underG1","underB1","newAlpha","drawBuffer","calcSpacing","avgX","avgY","mixr","mixg","mixb","average","localColOld","avgParams","prepDot","copyFromCanvas","getAverage","localColNew","updateRedrawBounds","totalCells","drawChangedCells","$c214fbe9e4fc15b0$var$sampleCanvas","$c214fbe9e4fc15b0$var$sampleCtx","$c214fbe9e4fc15b0$export$566f9061f0f5ba33","lastX","lastY","settingBlending","settingScale","sketchySeed","setSeed","getSeed","mixmode","c1","getBlending","setBlending","p_x","p_y","preMixedColor","mixx","mixy","mixw","mixh","countmix","mixed","$58b45953679baa4a$export$4de5ef8eecde6f12","ditherPattern","updateDither","ditherCtx","settingIsEraser","ditherArr","ditherCanvas","plotLine","skipFirst","settingUseDither","sX","sY","plotCubicBezierLine","isOverThreshold","d2","d3","cubicCurveOverThreshold","controlCallback","controlObj","setIsEraser","setUseDither","getLockAlpha","$fc1a683099fb2d61$export$fe52c90afd1cf5ba","isBaseLayer","isTransparentBG","radgrad","createRadialGradient","oFac","opacity1","bezierCallback","started","setTransparentBG","$78ad817c60f81b7c$var$CELL_SIZE","$78ad817c60f81b7c$var$smudge","cSize","brush","cX","cY","aP","bP","aIndex","ai","bi","ix","iy","softnessPx","fac2","alphaLock","bx1","iy4","yStart","bx2","ix4","pixel","iy1","yStart1","x21","ix1","iy2","yStart2","x3","x22","ix2","y3","iy3","yStart3","x4","x23","ix3","$78ad817c60f81b7c$export$c9f800961903deab","completeRedrawBounds","copiedCells","copyImageData","imWidth","imHeight","$78ad817c60f81b7c$var$prepSmudge","ImageData","lineToolLastDot","updateCompleteRedrawBounds","historyIm","tmpCanvas","$348fcce123898af9$export$38b08aa4ea8f61c6","settingMode","settingDistort","settingXSymmetry","settingYSymmetry","settingGradient","Path2D","startAtTop","gradient","minY","maxY","lineJoin","distort","historyCanvas","$7de2f0eab7a9ead7$export$f1561c72be54c6a7","penBrush","$cVFne","penBrushUi","blendBrush","$9mjXI","blendBrushUi","sketchyBrush","$iYbUv","sketchyBrushUi","pixelBrush","$brjBD","pixelBrushUi","chemyBrush","$vCnsd","chemyBrushUi","smudgeBrush","$dS2qM","smudgeBrushUi","$9rc5F","eraserBrushUi","brushInterface","alphaNames","$8b6ca25eb0830594$export$a0d4983f3b0b5c8e","$7gVvp","updateAlphas","alphas","currentAlpha","spacingSpline","lockAlphaToggle","$7NTKy","pressureSizeToggle","pressureOpacityToggle","alphaWrapper","$e8a5c017c49bb311$export$5ec472fd0ce20d84","$2e3c50106ba150d5$export$156bb4fe8f4bcb4b","$cQSIC","blendingSlider","setSizePressure","setOpacityPressure","$94537af75923b9e3$export$ffae56164d1bde68","$bteky","blendSlider","scaleSlider","$9519e739bc9666ee$export$d001f3406562d07","$4PDnu","ditherToggle","getUseDither","toggleRow","$d6fc2ded7d9d56db$export$cf481ecf227135a8","$984eq","isTransparentBg","transparencyToggle","$1045b9bae2ffbbb4$export$84831662ba707e7a","$3QgTy","$18456e8104a5a825$export$80819a93636ebb04","$18kre","actualIconSize","iconSize","modeOptions","mirrorXToggle","halfSize","getXSymmetry","setXSymmetry","mirrorYToggle","getYSymmetry","setYSymmetry","gradientToggle","getGradient","setGradient","$14dc4cf18966a4f4$export$2358c75ad3c15b2d","$6f92981a32875bca$export$5334e08b3589fc5c","isEmbed","linkEl","isMaxHeight","$142eacf53b1eb43d$export$3dff5655255b5729","inputs","ignoreFocus","$0e681e75eb3cab30$export$9c72cf485ef46673","gridTemplateColumns","gridTemplateRows","gap","gridTemplateAreas","gridArea","isBroken","ageEl","textSize","storeEl","clearEl","onUpdate","timestamp","thumbnail","updateThumb","updateAge","readResult","read","ageStr","age","maxWidth","maxHeight","resetButtons","$14b343f2c12ca9c5$var$makeAsync","$14b343f2c12ca9c5$export$93d91060b9af7e2a","accessHasFailed","storeKlProjectObj","getKlProjectObj","lowLevelRead","$3hwQ7","ProjectConverter","readStorageProject","storageProject1","createStorageProject","lowLevelStore","lowLevelClear","updateTimestamp","$3ee249752703e788$var$loadImage","onabort","$3ee249752703e788$export$f3c1ac6650038646","$2wCWz","base64ToBlob","createThumbnail","HTMLCanvasElement","t2","$e3587a28373f51f9$export$b3fb17ae4345ac8f","base64Str","binStr","atob","buf","$01ce2e23a2667e77$export$a2647fbf5f056b0a","onExportTypeChange","onFileSelect","onSaveImageToComputer","onNewImage","onShareImage","onUpload","onCopyToClipboard","createSpacer","clearer","line","filemenu","uploadImgurButton","clipboardButton","$4xKQD","multiple","accept","exportTypeWrapper","exportTypeSelect","importWrapper","innerMask","importFakeButton","createImportButton","saveNote","fileBrowserStorage","refresh","$0d10046ca7f6fbd0$export$3f17d740ad471e50","getCurrentColor","getKlMaxCanvasSize","getKlCanvas","getCurrentLayerCtx","isInit","filterKey","filterArr","applyFilter","filterDialog1","currentColorRgb","secondaryColorRgb","filterDialog","getInput","finishedDialog","createDisabledButton","appName","addGroup","groupArr","filters","groupA","groupB","filterKey1","hrEl","webglnote","$6349b006a6604e1b$var$upload","_upload","gif","labelText","response","formData","$j8sUl","FormData","Authorization","json","$6349b006a6604e1b$export$b1dd62fa0b5f32f5","inputTitle","inputDescription","rows","labelTitle","labelDescription","tos","typeRadio","outDiv","infoHint","deletehash","$ae23cd0c3e53f398$var$agPsdLazy","$ae23cd0c3e53f398$export$ab3d838b1d336b38","_loadAgPsd","$06e8423858d08972$export$befc6437ad34b28a","showReminder","changeTitle","onSaveAsPsd","lastSavedActionNumber","lastSavedAt","saveBtn","closeFunc","lastReminderShownAt","onBeforeUnload","returnValue","getActionNumber","visibilityState","unsavedActions","showPopup","unsavedInterval","$956d06d740fc5053$export$75e7b60500bb415b","getExportType","format","saveImage","mimeType","$98ax7","saveAs","mimeType2","filename1","fnameArr","fileBase","layerArr1","psdConfig","blendKlToPsd","writePsdBuffer","XMLHttpRequest","responseType","g1","send","d1","a2","initMouseEvent","a1","HTMLAnchorElement","download","rel","msSaveOrOpenBlob","autoBom","warn","HTMLElement","safari","onloadend","readAsDataURL","amd","FileSaver","$48534f13b7192dff$export$5cebd3bb2d68229a","getInitState","setCurrentLayerCtx","getCurrentBrush","doIgnore","ignoreTest","oldSize","b4","id1","b3","b8","p5","b5","p6","b6","id2","b7","currentLayerIndex","logParam","localCurrentLayerCtx","p7","p8","b9","p9","b10","id3","b11","$53cc60fd413705d6$export$272bfd3ef9ef2f48","onSetColor","onSetSize","onSetOpacity","onGetColor","onGetSize","onGetOpacity","onGetSliderConfig","subscriberArr","skipSubscriber","$5562b5b6c391a7ca$export$5d396b237bd33221","customAbout","makeLicenses","licenses","overflowY","language","getLanguage","preferredLanguageRow","$fgfvl","languages","languageSelect","LS_LANGUAGE_KEY","languageHint","$7OLuX","$6qSiv","$951e508110f8a437$export$42a534af7eb650e8","upBtn","downBtn","upInterval","scrollBy","downInterval","wheelListener","$b37f5cd553722692$export$665d2c76b1eb8459","submitButton","leftRightButton","$4bb0d03ef02dc0c0$var$importFilter","libObj","moduleObj","$4bb0d03ef02dc0c0$export$4283b00eae4a6956","$99EgS","$5deND","$4d8c6","$5Ta9b","$gMKRz","$7z464","$diAhN","$c1rJJ","$2elec","$gACTl","$dIv7c","$1NZ3i","$cJB4E","$gTwOE","$1e763c481ba6cf00$export$80884bc1ac80aa1d","selectedLayerIndex","brightness","contrast","glCanvas","$5RaQo","getSharedFx","texture","brightnessSlider","$cH2YE","brightnessContrast","contrastSlider","previewInnerWrapper","$fca35583bfaa35b6$export$5ec472fd0ce20d84","$0e6e34a2063e157d$var$fxCanvas","$TEtAx","fx","$0e6e34a2063e157d$export$8c4423af32b21158","isContextLost","$5eb53faa48338ac6$export$68ae324f2f6c6252","lo","hi","wrapTexture","loadContentsOf","gl1","texture1","Texture1","fromElement","initialize","UNSIGNED_BYTE","getExtension","testTexture","RGBA","FLOAT","drawTo","spareTexture","extraTexture","flippedShader","Shader1","use","getDefaultShader","drawRect","simpleShader","shader","uniforms","textureIn","textureOut","swapWith","node","contents","getPixelArray","readPixels","dx1","dy1","dx2","dy2","dx3","dy3","det","warpShader","warp","interpolator","curves","red","green","blue","splineInterpolate","initFromBytes","textures","denoise","texSize","hueSaturation","amount","sepia","unsharpMask","strength","ensureFormat","triangleBlur","unuse","vibrance","vignette","lensBlur","lensBlurPrePass","randomShaderFunc","lensBlur0","lensBlur1","lensBlur2","power","delta0","delta1","tiltShift","endX","endY","blurRadius","gradientRadius","zoomBlur","colorHalftone","dotScreen","edgeWork1","edgeWork2","hexagonalPixelate","replaceRGBA","oldGetExtension","oldGetSupportedExtensions","OESTextureFloatLinear","getSupportedExtensions","framebuffer","createFramebuffer","byteTexture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","floatTexture","LINEAR","program","createProgram","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","shaderSource","compileShader","attachShader","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STREAM_DRAW","enableVertexAttribArray","vertexAttribPointer","useProgram","viewport","drawArrays","POINTS","supportsOESTextureFloatLinear","WebGLRenderingContext","$OES_texture_float_linear$","extensions","perspective","matrixWarp","bulgePinch","edgeWork","swirl","ink","compileSource","testPrecisionSupport","Shader","defaultFragmentSource","nameStr","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","precisionType","getShaderPrecisionFormat","precision","vertexSource","fragmentSource","vertexAttribute","texCoordAttribute","defaultVertexSource","floatPrecision","HIGH_FLOAT","MEDIUM_FLOAT","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","deleteProgram","getUniformLocation","uniform1fv","uniform2fv","uniform3fv","uniform4fv","uniformMatrix3fv","uniformMatrix4fv","isNumber","uniform1f","uniform1i","getParameter","VIEWPORT","vertexBuffer","STATIC_DRAW","texCoordBuffer","defaultShader","Texture","videoWidth","videoHeight","unit","activeTexture","TEXTURE0","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","getCanvas","pixels","other","$21fb62da4f6e89f8$export$4630dcf80f8ceb88","leftInput","rightInput","topInput","bottomInput","leftChanged","rightChanged","fit1","previewFactor","topChanged","bottomChanged","updateInput","labelStyle","ruleOThirdsCheckbox","useRuleOfThirds","cropper","selectedRgbaObj","updateBg","flexRow","bgColorOverlay","offsetWrapper","register","$e250f451a2faf8b3$export$2e9081b953703a77","canvas1","ctx1","curves1","modeButtons","p0","areah","areaw","update2","curveArea","createPoint","lock","internalY","internalX","newX","newY","updateControl","outCurves","drawCurve","getDiv","$ae0fd60a73f3b8a4$export$8a83211c878a3f1f","previewLayer","doFlipCanvas","horizontalCheckbox","verticalCheckbox","fcOption","paddingBottom","borderTopLeftRadius","$1RI49","flOption","borderTopRightRadius","optionWrapper","horizontal","vertical","flipCanvas","Saturation","hueSlider","saturationSlider","$d23471d9289cfec2$export$6897c284b6f9f4dc","$ed63f0c6c7ca7574$export$358acb0cd681f612","displayH","displayW","bb","bc","bd","ac","ad","nob","updateAfter","beforeOption","afterOption","pointerListenerArr","displayPreviewFactor","after","nobSize","$2405b4796fda9858$export$4380c87abf28fdf","algorithmSelect","canvasWrapper","previewH","inputWrapper","$jfTWC","constrainCheckbox","secondRowElement","$5b99ea702a5304d2$export$bb628a54ab399bc9","WebkitTransform","MozTransform","OTransform","msTransform","btnPlus","btnMinus","$e3bfa9cf59911118$export$83a0900d4b9a8022","fa","fb","blurSlider","gradientSlider","$dc2850290325f029$export$51186ad6e864892a","lastDrawnTransformStr","transformLayerCanvas","onInputsChanged","inputR","tempBounds","rotWrapper","leftWrapper","rightWrapper","buttonRow","flipYBtn","actionBtnCss","scaleRotLeftBtn","scaleRotRightBtn","scaleDoubleBtn","getRatio","setConstrained","isSnapping","setSnapping","snappingCheckbox","bottomRow","checkboxWrapper","flipXBtn","scaleHalfBtn","radiusSlider"],"version":3,"file":"main-embed.32cff597.js.map"}
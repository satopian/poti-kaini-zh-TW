{"mappings":"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","sources":["src/app/script/main-embed.ts","node_modules/core-js/modules/es.symbol.js","node_modules/core-js/internals/export.js","node_modules/core-js/internals/global.js","node_modules/core-js/internals/object-get-own-property-descriptor.js","node_modules/core-js/internals/descriptors.js","node_modules/core-js/internals/fails.js","node_modules/core-js/internals/function-call.js","node_modules/core-js/internals/function-bind-native.js","node_modules/core-js/internals/object-property-is-enumerable.js","node_modules/core-js/internals/create-property-descriptor.js","node_modules/core-js/internals/to-indexed-object.js","node_modules/core-js/internals/indexed-object.js","node_modules/core-js/internals/function-uncurry-this.js","node_modules/core-js/internals/classof-raw.js","node_modules/core-js/internals/require-object-coercible.js","node_modules/core-js/internals/to-property-key.js","node_modules/core-js/internals/to-primitive.js","node_modules/core-js/internals/is-object.js","node_modules/core-js/internals/is-callable.js","node_modules/core-js/internals/is-symbol.js","node_modules/core-js/internals/get-built-in.js","node_modules/core-js/internals/object-is-prototype-of.js","node_modules/core-js/internals/use-symbol-as-uid.js","node_modules/core-js/internals/native-symbol.js","node_modules/core-js/internals/engine-v8-version.js","node_modules/core-js/internals/engine-user-agent.js","node_modules/core-js/internals/get-method.js","node_modules/core-js/internals/a-callable.js","node_modules/core-js/internals/try-to-string.js","node_modules/core-js/internals/ordinary-to-primitive.js","node_modules/core-js/internals/well-known-symbol.js","node_modules/core-js/internals/shared.js","node_modules/core-js/internals/is-pure.js","node_modules/core-js/internals/shared-store.js","node_modules/core-js/internals/set-global.js","node_modules/core-js/internals/has-own-property.js","node_modules/core-js/internals/to-object.js","node_modules/core-js/internals/uid.js","node_modules/core-js/internals/ie8-dom-define.js","node_modules/core-js/internals/document-create-element.js","node_modules/core-js/internals/create-non-enumerable-property.js","node_modules/core-js/internals/object-define-property.js","node_modules/core-js/internals/v8-prototype-define-bug.js","node_modules/core-js/internals/an-object.js","node_modules/core-js/internals/redefine.js","node_modules/core-js/internals/inspect-source.js","node_modules/core-js/internals/internal-state.js","node_modules/core-js/internals/native-weak-map.js","node_modules/core-js/internals/shared-key.js","node_modules/core-js/internals/hidden-keys.js","node_modules/core-js/internals/function-name.js","node_modules/core-js/internals/copy-constructor-properties.js","node_modules/core-js/internals/own-keys.js","node_modules/core-js/internals/object-get-own-property-names.js","node_modules/core-js/internals/object-keys-internal.js","node_modules/core-js/internals/array-includes.js","node_modules/core-js/internals/to-absolute-index.js","node_modules/core-js/internals/to-integer-or-infinity.js","node_modules/core-js/internals/length-of-array-like.js","node_modules/core-js/internals/to-length.js","node_modules/core-js/internals/enum-bug-keys.js","node_modules/core-js/internals/object-get-own-property-symbols.js","node_modules/core-js/internals/is-forced.js","node_modules/core-js/internals/function-apply.js","node_modules/core-js/internals/is-array.js","node_modules/core-js/internals/to-string.js","node_modules/core-js/internals/classof.js","node_modules/core-js/internals/to-string-tag-support.js","node_modules/core-js/internals/object-create.js","node_modules/core-js/internals/object-define-properties.js","node_modules/core-js/internals/object-keys.js","node_modules/core-js/internals/html.js","node_modules/core-js/internals/object-get-own-property-names-external.js","node_modules/core-js/internals/array-slice-simple.js","node_modules/core-js/internals/create-property.js","node_modules/core-js/internals/array-slice.js","node_modules/core-js/internals/well-known-symbol-wrapped.js","node_modules/core-js/internals/define-well-known-symbol.js","node_modules/core-js/internals/path.js","node_modules/core-js/internals/set-to-string-tag.js","node_modules/core-js/internals/array-iteration.js","node_modules/core-js/internals/function-bind-context.js","node_modules/core-js/internals/array-species-create.js","node_modules/core-js/internals/array-species-constructor.js","node_modules/core-js/internals/is-constructor.js","node_modules/core-js/modules/es.symbol.description.js","node_modules/core-js/modules/es.symbol.async-iterator.js","node_modules/core-js/modules/es.symbol.has-instance.js","node_modules/core-js/modules/es.symbol.is-concat-spreadable.js","node_modules/core-js/modules/es.symbol.iterator.js","node_modules/core-js/modules/es.symbol.match.js","node_modules/core-js/modules/es.symbol.replace.js","node_modules/core-js/modules/es.symbol.search.js","node_modules/core-js/modules/es.symbol.species.js","node_modules/core-js/modules/es.symbol.split.js","node_modules/core-js/modules/es.symbol.to-primitive.js","node_modules/core-js/modules/es.symbol.to-string-tag.js","node_modules/core-js/modules/es.symbol.unscopables.js","node_modules/core-js/modules/es.array.concat.js","node_modules/core-js/internals/array-method-has-species-support.js","node_modules/core-js/modules/es.array.copy-within.js","node_modules/core-js/internals/array-copy-within.js","node_modules/core-js/internals/add-to-unscopables.js","node_modules/core-js/modules/es.array.fill.js","node_modules/core-js/internals/array-fill.js","node_modules/core-js/modules/es.array.filter.js","node_modules/core-js/modules/es.array.find.js","node_modules/core-js/modules/es.array.find-index.js","node_modules/core-js/modules/es.array.flat.js","node_modules/core-js/internals/flatten-into-array.js","node_modules/core-js/modules/es.array.flat-map.js","node_modules/core-js/modules/es.array.from.js","node_modules/core-js/internals/array-from.js","node_modules/core-js/internals/call-with-safe-iteration-closing.js","node_modules/core-js/internals/iterator-close.js","node_modules/core-js/internals/is-array-iterator-method.js","node_modules/core-js/internals/iterators.js","node_modules/core-js/internals/get-iterator.js","node_modules/core-js/internals/get-iterator-method.js","node_modules/core-js/internals/check-correctness-of-iteration.js","node_modules/core-js/modules/es.array.includes.js","node_modules/core-js/modules/es.array.index-of.js","node_modules/core-js/internals/array-method-is-strict.js","node_modules/core-js/modules/es.array.iterator.js","node_modules/core-js/internals/define-iterator.js","node_modules/core-js/internals/create-iterator-constructor.js","node_modules/core-js/internals/iterators-core.js","node_modules/core-js/internals/object-get-prototype-of.js","node_modules/core-js/internals/correct-prototype-getter.js","node_modules/core-js/internals/object-set-prototype-of.js","node_modules/core-js/internals/a-possible-prototype.js","node_modules/core-js/modules/es.array.join.js","node_modules/core-js/modules/es.array.last-index-of.js","node_modules/core-js/internals/array-last-index-of.js","node_modules/core-js/modules/es.array.map.js","node_modules/core-js/modules/es.array.of.js","node_modules/core-js/modules/es.array.reduce.js","node_modules/core-js/internals/array-reduce.js","node_modules/core-js/internals/engine-is-node.js","node_modules/core-js/modules/es.array.reduce-right.js","node_modules/core-js/modules/es.array.reverse.js","node_modules/core-js/modules/es.array.slice.js","node_modules/core-js/modules/es.array.sort.js","node_modules/core-js/internals/array-sort.js","node_modules/core-js/internals/engine-ff-version.js","node_modules/core-js/internals/engine-is-ie-or-edge.js","node_modules/core-js/internals/engine-webkit-version.js","node_modules/core-js/modules/es.array.species.js","node_modules/core-js/internals/set-species.js","node_modules/core-js/modules/es.array.splice.js","node_modules/core-js/modules/es.array.unscopables.flat.js","node_modules/core-js/modules/es.array.unscopables.flat-map.js","node_modules/core-js/modules/es.array-buffer.constructor.js","node_modules/core-js/internals/array-buffer.js","node_modules/core-js/internals/array-buffer-native.js","node_modules/core-js/internals/redefine-all.js","node_modules/core-js/internals/an-instance.js","node_modules/core-js/internals/to-index.js","node_modules/core-js/internals/ieee754.js","node_modules/core-js/modules/es.array-buffer.slice.js","node_modules/core-js/internals/species-constructor.js","node_modules/core-js/internals/a-constructor.js","node_modules/core-js/modules/es.date.to-json.js","node_modules/core-js/modules/es.date.to-primitive.js","node_modules/core-js/internals/date-to-primitive.js","node_modules/core-js/modules/es.function.has-instance.js","node_modules/core-js/modules/es.function.name.js","node_modules/core-js/modules/es.json.to-string-tag.js","node_modules/core-js/modules/es.map.js","node_modules/core-js/internals/collection.js","node_modules/core-js/internals/internal-metadata.js","node_modules/core-js/internals/object-is-extensible.js","node_modules/core-js/internals/array-buffer-non-extensible.js","node_modules/core-js/internals/freezing.js","node_modules/core-js/internals/iterate.js","node_modules/core-js/internals/inherit-if-required.js","node_modules/core-js/internals/collection-strong.js","node_modules/core-js/modules/es.math.acosh.js","node_modules/core-js/internals/math-log1p.js","node_modules/core-js/modules/es.math.asinh.js","node_modules/core-js/modules/es.math.atanh.js","node_modules/core-js/modules/es.math.cbrt.js","node_modules/core-js/internals/math-sign.js","node_modules/core-js/modules/es.math.clz32.js","node_modules/core-js/modules/es.math.cosh.js","node_modules/core-js/internals/math-expm1.js","node_modules/core-js/modules/es.math.expm1.js","node_modules/core-js/modules/es.math.fround.js","node_modules/core-js/internals/math-fround.js","node_modules/core-js/modules/es.math.hypot.js","node_modules/core-js/modules/es.math.imul.js","node_modules/core-js/modules/es.math.log10.js","node_modules/core-js/internals/math-log10.js","node_modules/core-js/modules/es.math.log1p.js","node_modules/core-js/modules/es.math.log2.js","node_modules/core-js/modules/es.math.sign.js","node_modules/core-js/modules/es.math.sinh.js","node_modules/core-js/modules/es.math.tanh.js","node_modules/core-js/modules/es.math.to-string-tag.js","node_modules/core-js/modules/es.math.trunc.js","node_modules/core-js/modules/es.number.constructor.js","node_modules/core-js/internals/this-number-value.js","node_modules/core-js/internals/string-trim.js","node_modules/core-js/internals/whitespaces.js","node_modules/core-js/modules/es.number.epsilon.js","node_modules/core-js/modules/es.number.is-finite.js","node_modules/core-js/internals/number-is-finite.js","node_modules/core-js/modules/es.number.is-integer.js","node_modules/core-js/internals/is-integral-number.js","node_modules/core-js/modules/es.number.is-nan.js","node_modules/core-js/modules/es.number.is-safe-integer.js","node_modules/core-js/modules/es.number.max-safe-integer.js","node_modules/core-js/modules/es.number.min-safe-integer.js","node_modules/core-js/modules/es.number.parse-float.js","node_modules/core-js/internals/number-parse-float.js","node_modules/core-js/modules/es.number.parse-int.js","node_modules/core-js/internals/number-parse-int.js","node_modules/core-js/modules/es.number.to-fixed.js","node_modules/core-js/internals/string-repeat.js","node_modules/core-js/modules/es.object.assign.js","node_modules/core-js/internals/object-assign.js","node_modules/core-js/modules/es.object.define-getter.js","node_modules/core-js/internals/object-prototype-accessors-forced.js","node_modules/core-js/modules/es.object.define-setter.js","node_modules/core-js/modules/es.object.entries.js","node_modules/core-js/internals/object-to-array.js","node_modules/core-js/modules/es.object.freeze.js","node_modules/core-js/modules/es.object.from-entries.js","node_modules/core-js/modules/es.object.get-own-property-descriptor.js","node_modules/core-js/modules/es.object.get-own-property-descriptors.js","node_modules/core-js/modules/es.object.get-own-property-names.js","node_modules/core-js/modules/es.object.get-prototype-of.js","node_modules/core-js/modules/es.object.is.js","node_modules/core-js/internals/same-value.js","node_modules/core-js/modules/es.object.is-extensible.js","node_modules/core-js/modules/es.object.is-frozen.js","node_modules/core-js/modules/es.object.is-sealed.js","node_modules/core-js/modules/es.object.keys.js","node_modules/core-js/modules/es.object.lookup-getter.js","node_modules/core-js/modules/es.object.lookup-setter.js","node_modules/core-js/modules/es.object.prevent-extensions.js","node_modules/core-js/modules/es.object.seal.js","node_modules/core-js/modules/es.object.set-prototype-of.js","node_modules/core-js/modules/es.object.to-string.js","node_modules/core-js/internals/object-to-string.js","node_modules/core-js/modules/es.object.values.js","node_modules/core-js/modules/es.parse-float.js","node_modules/core-js/modules/es.parse-int.js","node_modules/core-js/modules/es.promise.js","node_modules/core-js/internals/native-promise-constructor.js","node_modules/core-js/internals/task.js","node_modules/core-js/internals/engine-is-ios.js","node_modules/core-js/internals/microtask.js","node_modules/core-js/internals/engine-is-ios-pebble.js","node_modules/core-js/internals/engine-is-webos-webkit.js","node_modules/core-js/internals/promise-resolve.js","node_modules/core-js/internals/new-promise-capability.js","node_modules/core-js/internals/host-report-errors.js","node_modules/core-js/internals/perform.js","node_modules/core-js/internals/queue.js","node_modules/core-js/internals/engine-is-browser.js","node_modules/core-js/modules/es.promise.finally.js","node_modules/core-js/modules/es.reflect.apply.js","node_modules/core-js/modules/es.reflect.construct.js","node_modules/core-js/internals/function-bind.js","node_modules/core-js/modules/es.reflect.define-property.js","node_modules/core-js/modules/es.reflect.delete-property.js","node_modules/core-js/modules/es.reflect.get.js","node_modules/core-js/internals/is-data-descriptor.js","node_modules/core-js/modules/es.reflect.get-own-property-descriptor.js","node_modules/core-js/modules/es.reflect.get-prototype-of.js","node_modules/core-js/modules/es.reflect.has.js","node_modules/core-js/modules/es.reflect.is-extensible.js","node_modules/core-js/modules/es.reflect.own-keys.js","node_modules/core-js/modules/es.reflect.prevent-extensions.js","node_modules/core-js/modules/es.reflect.set.js","node_modules/core-js/modules/es.reflect.set-prototype-of.js","node_modules/core-js/modules/es.regexp.constructor.js","node_modules/core-js/internals/is-regexp.js","node_modules/core-js/internals/regexp-flags.js","node_modules/core-js/internals/regexp-sticky-helpers.js","node_modules/core-js/internals/regexp-unsupported-dot-all.js","node_modules/core-js/internals/regexp-unsupported-ncg.js","node_modules/core-js/modules/es.regexp.exec.js","node_modules/core-js/internals/regexp-exec.js","node_modules/core-js/modules/es.regexp.flags.js","node_modules/core-js/modules/es.regexp.to-string.js","node_modules/core-js/modules/es.set.js","node_modules/core-js/modules/es.string.code-point-at.js","node_modules/core-js/internals/string-multibyte.js","node_modules/core-js/modules/es.string.ends-with.js","node_modules/core-js/internals/not-a-regexp.js","node_modules/core-js/internals/correct-is-regexp-logic.js","node_modules/core-js/modules/es.string.from-code-point.js","node_modules/core-js/modules/es.string.includes.js","node_modules/core-js/modules/es.string.iterator.js","node_modules/core-js/modules/es.string.match.js","node_modules/core-js/internals/fix-regexp-well-known-symbol-logic.js","node_modules/core-js/internals/advance-string-index.js","node_modules/core-js/internals/regexp-exec-abstract.js","node_modules/core-js/modules/es.string.pad-end.js","node_modules/core-js/internals/string-pad.js","node_modules/core-js/internals/string-pad-webkit-bug.js","node_modules/core-js/modules/es.string.pad-start.js","node_modules/core-js/modules/es.string.raw.js","node_modules/core-js/modules/es.string.repeat.js","node_modules/core-js/modules/es.string.replace.js","node_modules/core-js/internals/get-substitution.js","node_modules/core-js/modules/es.string.search.js","node_modules/core-js/modules/es.string.split.js","node_modules/core-js/modules/es.string.starts-with.js","node_modules/core-js/modules/es.string.trim.js","node_modules/core-js/internals/string-trim-forced.js","node_modules/core-js/modules/es.string.trim-end.js","node_modules/core-js/modules/es.string.trim-start.js","node_modules/core-js/modules/es.string.anchor.js","node_modules/core-js/internals/create-html.js","node_modules/core-js/internals/string-html-forced.js","node_modules/core-js/modules/es.string.big.js","node_modules/core-js/modules/es.string.blink.js","node_modules/core-js/modules/es.string.bold.js","node_modules/core-js/modules/es.string.fixed.js","node_modules/core-js/modules/es.string.fontcolor.js","node_modules/core-js/modules/es.string.fontsize.js","node_modules/core-js/modules/es.string.italics.js","node_modules/core-js/modules/es.string.link.js","node_modules/core-js/modules/es.string.small.js","node_modules/core-js/modules/es.string.strike.js","node_modules/core-js/modules/es.string.sub.js","node_modules/core-js/modules/es.string.sup.js","node_modules/core-js/modules/es.typed-array.float32-array.js","node_modules/core-js/internals/typed-array-constructor.js","node_modules/core-js/internals/typed-array-constructors-require-wrappers.js","node_modules/core-js/internals/array-buffer-view-core.js","node_modules/core-js/internals/to-offset.js","node_modules/core-js/internals/to-positive-integer.js","node_modules/core-js/internals/typed-array-from.js","node_modules/core-js/modules/es.typed-array.float64-array.js","node_modules/core-js/modules/es.typed-array.int8-array.js","node_modules/core-js/modules/es.typed-array.int16-array.js","node_modules/core-js/modules/es.typed-array.int32-array.js","node_modules/core-js/modules/es.typed-array.uint8-array.js","node_modules/core-js/modules/es.typed-array.uint8-clamped-array.js","node_modules/core-js/modules/es.typed-array.uint16-array.js","node_modules/core-js/modules/es.typed-array.uint32-array.js","node_modules/core-js/modules/es.typed-array.copy-within.js","node_modules/core-js/modules/es.typed-array.every.js","node_modules/core-js/modules/es.typed-array.fill.js","node_modules/core-js/modules/es.typed-array.filter.js","node_modules/core-js/internals/typed-array-from-species-and-list.js","node_modules/core-js/internals/array-from-constructor-and-list.js","node_modules/core-js/internals/typed-array-species-constructor.js","node_modules/core-js/modules/es.typed-array.find.js","node_modules/core-js/modules/es.typed-array.find-index.js","node_modules/core-js/modules/es.typed-array.for-each.js","node_modules/core-js/modules/es.typed-array.from.js","node_modules/core-js/modules/es.typed-array.includes.js","node_modules/core-js/modules/es.typed-array.index-of.js","node_modules/core-js/modules/es.typed-array.iterator.js","node_modules/core-js/modules/es.typed-array.join.js","node_modules/core-js/modules/es.typed-array.last-index-of.js","node_modules/core-js/modules/es.typed-array.map.js","node_modules/core-js/modules/es.typed-array.of.js","node_modules/core-js/modules/es.typed-array.reduce.js","node_modules/core-js/modules/es.typed-array.reduce-right.js","node_modules/core-js/modules/es.typed-array.reverse.js","node_modules/core-js/modules/es.typed-array.set.js","node_modules/core-js/modules/es.typed-array.slice.js","node_modules/core-js/modules/es.typed-array.some.js","node_modules/core-js/modules/es.typed-array.sort.js","node_modules/core-js/modules/es.typed-array.subarray.js","node_modules/core-js/modules/es.typed-array.to-locale-string.js","node_modules/core-js/modules/es.typed-array.to-string.js","node_modules/core-js/modules/es.weak-map.js","node_modules/core-js/internals/collection-weak.js","node_modules/core-js/modules/es.weak-set.js","node_modules/core-js/modules/es.aggregate-error.js","node_modules/core-js/internals/clear-error-stack.js","node_modules/core-js/internals/install-error-cause.js","node_modules/core-js/internals/normalize-string-argument.js","node_modules/core-js/internals/error-stack-installable.js","node_modules/core-js/modules/esnext.array.last-index.js","node_modules/core-js/modules/esnext.array.last-item.js","node_modules/core-js/modules/esnext.composite-key.js","node_modules/core-js/internals/composite-key.js","node_modules/core-js/modules/esnext.composite-symbol.js","node_modules/core-js/modules/es.global-this.js","node_modules/core-js/modules/esnext.map.delete-all.js","node_modules/core-js/internals/collection-delete-all.js","node_modules/core-js/modules/esnext.map.every.js","node_modules/core-js/internals/get-map-iterator.js","node_modules/core-js/modules/esnext.map.filter.js","node_modules/core-js/modules/esnext.map.find.js","node_modules/core-js/modules/esnext.map.find-key.js","node_modules/core-js/modules/esnext.map.from.js","node_modules/core-js/internals/collection-from.js","node_modules/core-js/modules/esnext.map.group-by.js","node_modules/core-js/modules/esnext.map.includes.js","node_modules/core-js/internals/same-value-zero.js","node_modules/core-js/modules/esnext.map.key-by.js","node_modules/core-js/modules/esnext.map.key-of.js","node_modules/core-js/modules/esnext.map.map-keys.js","node_modules/core-js/modules/esnext.map.map-values.js","node_modules/core-js/modules/esnext.map.merge.js","node_modules/core-js/modules/esnext.map.of.js","node_modules/core-js/internals/collection-of.js","node_modules/core-js/modules/esnext.map.reduce.js","node_modules/core-js/modules/esnext.map.some.js","node_modules/core-js/modules/esnext.map.update.js","node_modules/core-js/modules/esnext.math.clamp.js","node_modules/core-js/modules/esnext.math.deg-per-rad.js","node_modules/core-js/modules/esnext.math.degrees.js","node_modules/core-js/modules/esnext.math.fscale.js","node_modules/core-js/internals/math-scale.js","node_modules/core-js/modules/esnext.math.iaddh.js","node_modules/core-js/modules/esnext.math.imulh.js","node_modules/core-js/modules/esnext.math.isubh.js","node_modules/core-js/modules/esnext.math.rad-per-deg.js","node_modules/core-js/modules/esnext.math.radians.js","node_modules/core-js/modules/esnext.math.scale.js","node_modules/core-js/modules/esnext.math.seeded-prng.js","node_modules/core-js/modules/esnext.math.signbit.js","node_modules/core-js/modules/esnext.math.umulh.js","node_modules/core-js/modules/esnext.number.from-string.js","node_modules/core-js/modules/esnext.observable.js","node_modules/core-js/modules/es.promise.all-settled.js","node_modules/core-js/modules/es.promise.any.js","node_modules/core-js/modules/esnext.promise.try.js","node_modules/core-js/modules/esnext.reflect.define-metadata.js","node_modules/core-js/internals/reflect-metadata.js","node_modules/core-js/modules/esnext.reflect.delete-metadata.js","node_modules/core-js/modules/esnext.reflect.get-metadata.js","node_modules/core-js/modules/esnext.reflect.get-metadata-keys.js","node_modules/core-js/internals/array-unique-by.js","node_modules/core-js/modules/esnext.reflect.get-own-metadata.js","node_modules/core-js/modules/esnext.reflect.get-own-metadata-keys.js","node_modules/core-js/modules/esnext.reflect.has-metadata.js","node_modules/core-js/modules/esnext.reflect.has-own-metadata.js","node_modules/core-js/modules/esnext.reflect.metadata.js","node_modules/core-js/modules/esnext.set.add-all.js","node_modules/core-js/internals/collection-add-all.js","node_modules/core-js/modules/esnext.set.delete-all.js","node_modules/core-js/modules/esnext.set.difference.js","node_modules/core-js/modules/esnext.set.every.js","node_modules/core-js/internals/get-set-iterator.js","node_modules/core-js/modules/esnext.set.filter.js","node_modules/core-js/modules/esnext.set.find.js","node_modules/core-js/modules/esnext.set.from.js","node_modules/core-js/modules/esnext.set.intersection.js","node_modules/core-js/modules/esnext.set.is-disjoint-from.js","node_modules/core-js/modules/esnext.set.is-subset-of.js","node_modules/core-js/modules/esnext.set.is-superset-of.js","node_modules/core-js/modules/esnext.set.join.js","node_modules/core-js/modules/esnext.set.map.js","node_modules/core-js/modules/esnext.set.of.js","node_modules/core-js/modules/esnext.set.reduce.js","node_modules/core-js/modules/esnext.set.some.js","node_modules/core-js/modules/esnext.set.symmetric-difference.js","node_modules/core-js/modules/esnext.set.union.js","node_modules/core-js/modules/esnext.string.at.js","node_modules/core-js/modules/esnext.string.code-points.js","node_modules/core-js/modules/es.string.match-all.js","node_modules/core-js/modules/es.string.replace-all.js","node_modules/core-js/modules/esnext.symbol.dispose.js","node_modules/core-js/modules/esnext.symbol.observable.js","node_modules/core-js/modules/esnext.symbol.pattern-match.js","node_modules/core-js/modules/esnext.weak-map.delete-all.js","node_modules/core-js/modules/esnext.weak-map.from.js","node_modules/core-js/modules/esnext.weak-map.of.js","node_modules/core-js/modules/esnext.weak-set.add-all.js","node_modules/core-js/modules/esnext.weak-set.delete-all.js","node_modules/core-js/modules/esnext.weak-set.from.js","node_modules/core-js/modules/esnext.weak-set.of.js","node_modules/core-js/modules/web.dom-collections.for-each.js","node_modules/core-js/internals/dom-iterables.js","node_modules/core-js/internals/dom-token-list-prototype.js","node_modules/core-js/internals/array-for-each.js","node_modules/core-js/modules/web.dom-collections.iterator.js","node_modules/core-js/modules/web.immediate.js","node_modules/core-js/modules/web.queue-microtask.js","node_modules/core-js/modules/web.url.js","node_modules/core-js/internals/native-url.js","node_modules/core-js/internals/string-punycode-to-ascii.js","node_modules/core-js/modules/web.url-search-params.js","node_modules/core-js/internals/validate-arguments-length.js","node_modules/core-js/modules/web.url.to-json.js","node_modules/mdn-polyfills/Node.prototype.append.js","src/app/script/app/kl-app.ts","src/app/script/klecks/kl.ts","src/app/script/klecks/history/kl-history.ts","src/app/script/klecks/ui/modals/popup.ts","src/app/script/klecks/ui/modals/modal-count.ts","src/app/script/bb/bb.ts","src/app/script/bb/input/event-listener.ts","src/app/script/bb/base/browser.ts","src/app/script/bb/base/create-canvas.ts","src/app/script/bb/base/base.ts","src/app/script/bb/input/key-listener.ts","src/app/script/bb/input/pointer-listener.ts","src/app/script/bb/math/math.ts","src/app/script/bb/input/event-chain.ts","src/app/script/bb/base/canvas.ts","src/app/script/bb/math/matrix.ts","src/app/script/bb/math/vec2.ts","src/app/script/bb/math/line.ts","src/app/script/bb/color/color.ts","src/app/script/bb/base/ui.ts","src/app/script/bb/base/bb-log.ts","node_modules/@parcel/runtime-js/lib/runtime-34832b43d0ebd3bf.js","node_modules/@parcel/runtime-js/lib/runtime-a96f6567e6dac4f3.js","src/app/script/klecks/ui/base-components/checkbox.ts","src/app/script/klecks/ui/base-components/input.ts","src/app/script/klecks/ui/base-components/select.ts","src/app/script/klecks/ui/base-components/image-toggle.ts","src/app/script/klecks/ui/base-components/image-radio-list.ts","src/app/script/klecks/ui/base-components/pen-pressure-toggle.ts","node_modules/@parcel/runtime-js/lib/runtime-065238818b5d6d26.js","src/app/script/klecks/ui/base-components/slider.ts","src/app/script/klecks/ui/base-components/slider-falloff.ts","src/app/script/klecks/ui/modals/color-slider-hex-dialog.ts","src/app/script/klecks/ui/base-components/color-slider.ts","node_modules/@parcel/runtime-js/lib/runtime-e7bece06ac3b91da.js","src/app/script/klecks/ui/base-components/color-slider-small.ts","src/app/script/klecks/ui/base-components/point-slider.ts","src/app/script/klecks/ui/base-components/color-options.ts","src/app/script/klecks/ui/base-components/options.ts","src/app/script/klecks/ui/components/status-overlay.ts","node_modules/@parcel/runtime-js/lib/runtime-76fc4a9796871f89.js","src/app/script/klecks/ui/modals/export-dialog-deprecated.ts","src/app/script/klecks/ui/components/crop-copy.ts","src/app/script/klecks/ui/modals/clipboard-dialog.ts","src/app/script/klecks/ui/components/tab-menu-deprecated.ts","src/app/script/klecks/ui/components/layer-manager.ts","node_modules/@parcel/runtime-js/lib/runtime-9e9c6514323b50ff.js","node_modules/@parcel/runtime-js/lib/runtime-f141aefb87a862aa.js","node_modules/@parcel/runtime-js/lib/runtime-e93ed5f4a72fe388.js","node_modules/@parcel/runtime-js/lib/runtime-e1e96fa0dcd63695.js","src/app/script/klecks/canvas-ui/workspace-svg-overlay.ts","src/app/script/klecks/canvas-ui/canvas-workspace.ts","node_modules/@parcel/runtime-js/lib/runtime-ce6158b179cda36d.js","node_modules/@parcel/runtime-js/lib/runtime-9180b336d2c14eb8.js","node_modules/@parcel/runtime-js/lib/runtime-e98ceba16f4f3e8c.js","node_modules/@parcel/runtime-js/lib/runtime-1c4e2d66dbd3cd26.js","src/app/script/klecks/canvas-ui/canvas-preview.ts","src/app/script/klecks/ui/components/free-transform.ts","node_modules/@parcel/runtime-js/lib/runtime-7b1b46c773a5d5de.js","src/app/script/klecks/ui/components/free-transform-canvas.ts","src/app/script/klecks/ui/components/cropper.ts","src/app/script/klecks/ui/modals/progress-popup.ts","node_modules/@parcel/runtime-js/lib/runtime-257b8f01a8ca9ad6.js","src/app/script/klecks/ui/components/layer-preview.ts","src/app/script/klecks/ui/components/show-reminder-toast.ts","src/app/script/klecks/ui/components/fitted-image.ts","src/app/script/klecks/ui/modals/show-import-as-layer-dialog.ts","src/app/script/klecks/ui/components/image-dropper.ts","src/app/script/klecks/ui/components/overlay-toolspace.ts","src/app/script/klecks/ui/components/toolspace-top-row.ts","node_modules/@parcel/runtime-js/lib/runtime-c595ccae60beff87.js","node_modules/@parcel/runtime-js/lib/runtime-e5d7180bbee5b536.js","node_modules/@parcel/runtime-js/lib/runtime-6c52a4e8d76ec49b.js","node_modules/@parcel/runtime-js/lib/runtime-fa73233744fc505c.js","node_modules/@parcel/runtime-js/lib/runtime-b34e92e9fb9b8c68.js","node_modules/@parcel/runtime-js/lib/runtime-8a2022a1c05c8770.js","src/app/script/klecks/ui/components/tool-dropdown.ts","node_modules/@parcel/runtime-js/lib/runtime-9034792b4642adea.js","node_modules/@parcel/runtime-js/lib/runtime-ff3da4d7dabee86d.js","node_modules/@parcel/runtime-js/lib/runtime-297f8366ec2375c9.js","node_modules/@parcel/runtime-js/lib/runtime-d831990ac91a582d.js","node_modules/@parcel/runtime-js/lib/runtime-621488e8bcab6d4d.js","src/app/script/klecks/ui/components/toolspace-tool-row.ts","node_modules/@parcel/runtime-js/lib/runtime-232f70fc872c44f9.js","node_modules/@parcel/runtime-js/lib/runtime-81519c452bdfbaa9.js","node_modules/@parcel/runtime-js/lib/runtime-3fc59c96423b70ad.js","node_modules/@parcel/runtime-js/lib/runtime-1eef10cb07c9c851.js","src/app/script/klecks/ui/components/toolspace-stabilizer-row.ts","src/app/script/klecks/ui/components/tab-row.ts","src/app/script/klecks/ui/tool-tabs/hand-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-4486cf75fca81822.js","src/app/script/klecks/ui/tool-tabs/fill-ui.ts","src/app/script/klecks/ui/tool-tabs/text-ui.ts","src/app/script/klecks/ui/tool-tabs/shape-ui.ts","src/app/script/klecks/ui/modals/new-image-dialog.ts","src/app/script/klecks/ui/components/toolspace-collapser.ts","node_modules/@parcel/runtime-js/lib/runtime-3ca3a85d3436a84f.js","src/app/script/klecks/image-operations/render-text.ts","src/app/script/klecks/ui/modals/text-tool-dialog.ts","node_modules/@parcel/runtime-js/lib/runtime-47401ec572d2cfcf.js","node_modules/@parcel/runtime-js/lib/runtime-6476cf999a0e75d3.js","node_modules/@parcel/runtime-js/lib/runtime-4ee49cef2a1bfd51.js","node_modules/@parcel/runtime-js/lib/runtime-01d9fe07522d7373.js","node_modules/@parcel/runtime-js/lib/runtime-8450ca7f4e68dde7.js","src/app/script/klecks/ui/modals/show-import-image-dialog.ts","src/app/script/klecks/image-operations/flood-fill.ts","src/app/script/klecks/storage/psd.ts","src/app/script/klecks/image-operations/shape-tool.ts","src/app/script/klecks/canvas/kl-canvas.ts","src/app/script/klecks/storage/indexed-db.ts","src/app/script/klecks/filters/filters.ts","node_modules/@parcel/runtime-js/lib/runtime-08ec85fc3ea564e8.js","node_modules/@parcel/runtime-js/lib/runtime-c105dce751d9b16c.js","node_modules/@parcel/runtime-js/lib/runtime-272cd0cc0051d99c.js","node_modules/@parcel/runtime-js/lib/runtime-d623cec3e031c802.js","node_modules/@parcel/runtime-js/lib/runtime-4aa563d1de55ad17.js","node_modules/@parcel/runtime-js/lib/runtime-acf5209c71eb3497.js","node_modules/@parcel/runtime-js/lib/runtime-726a62492af9f94e.js","node_modules/@parcel/runtime-js/lib/runtime-f1cff4f2714da535.js","node_modules/@parcel/runtime-js/lib/runtime-06b47f2ffca8a188.js","node_modules/@parcel/runtime-js/lib/runtime-866a2902b0cdf580.js","node_modules/@parcel/runtime-js/lib/runtime-3b4878106cdf1b9c.js","node_modules/@parcel/runtime-js/lib/runtime-02847deebefdd0a7.js","node_modules/@parcel/runtime-js/lib/runtime-3dce3f08da564a07.js","src/app/script/klecks/brushes/brushes.ts","src/app/script/klecks/brushes/default-brush.ts","src/app/script/klecks/brushes/brushes-common.ts","src/app/script/klecks/brushes/alphas/brush-alphas.ts","src/app/script/bb/math/perlin.ts","src/app/script/klecks/brushes/blend-brush.ts","src/app/script/klecks/brushes/sketchy-brush.ts","src/app/script/klecks/brushes/pixel-brush.ts","src/app/script/klecks/brushes/eraser-brush.ts","src/app/script/klecks/brushes/smudge-brush.ts","src/app/script/klecks/brushes-ui/brushes-ui.ts","src/app/script/klecks/brushes-ui/default-brush-ui.ts","src/app/script/klecks/brushes-ui/brushes-consts.ts","node_modules/@parcel/runtime-js/lib/runtime-5978c28553dded19.js","src/app/script/klecks/brushes-ui/blend-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-e02f7ebf4a6b68fa.js","src/app/script/klecks/brushes-ui/sketchy-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-c362cafb743e4bf7.js","src/app/script/klecks/brushes-ui/pixel-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-9083363aed84d015.js","src/app/script/klecks/brushes-ui/eraser-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-72d61ca9dbc6379a.js","src/app/script/klecks/brushes-ui/smudge-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-e361b92ab73d16f3.js","src/app/script/klecks/ui/modals/show-iframe-popup.ts","src/app/script/klecks/ui/base-components/radio-list.ts","src/app/script/klecks/ui/components/browser-storage-ui.ts","src/app/script/klecks/canvas/draw-project.ts","src/app/script/klecks/storage/project-store.ts","src/app/script/klecks/storage/project-converter.ts","src/app/script/klecks/storage/base-64-to-blob.ts","src/app/script/klecks/ui/tool-tabs/file-tab.ts","node_modules/@parcel/runtime-js/lib/runtime-174f5efa9e6f0131.js","node_modules/@parcel/runtime-js/lib/runtime-ce95b2abc71314b0.js","src/app/script/klecks/ui/tool-tabs/filter-tab.ts","src/app/script/klecks/ui/components/imgur-upload.ts","src/app/script/klecks/storage/ag-psd-wrapper.ts","node_modules/@parcel/runtime-js/lib/runtime-5ea32053680ef652.js","src/app/script/klecks/ui/components/save-reminder.ts","src/app/script/klecks/storage/save-to-computer.ts","node_modules/file-saver/src/FileSaver.js","src/app/script/klecks/history/undo-redo-catchup.ts","src/app/script/embed/toolspace-top-row.ts","node_modules/@parcel/runtime-js/lib/runtime-050615743b2088cc.js","src/app/script/klecks/filters/filters-lazy.ts","src/app/script/klecks/filters/gl-brightness-contrast.ts","src/app/script/klecks/filters/filters-consts.ts","src/app/script/klecks/filters/shared-gl-fx.ts","src/app/script-vendor/glfx.ts","src/app/script/klecks/filters/crop-extend.ts","src/app/script/klecks/filters/gl-curves.ts","src/app/script/klecks/filters/flip.ts","src/app/script/klecks/filters/gl-perspective.ts","node_modules/@parcel/runtime-js/lib/runtime-0b614230dd5a2fbc.js","src/app/script/klecks/filters/gl-hue-saturation.ts","src/app/script/klecks/filters/invert.ts","src/app/script/klecks/filters/resize.ts","src/app/script/klecks/filters/gl-tilt-shift.ts","src/app/script/klecks/filters/rotate.ts","node_modules/@parcel/runtime-js/lib/runtime-c388461235ee692d.js","src/app/script/klecks/filters/transform.ts","src/app/script/klecks/filters/gl-blur.ts","src/app/script/klecks/filters/gl-unsharp-mask.ts","src/app/script/klecks/filters/to-alpha.ts","src/app/script/klecks/storage/kl-canvas-to-psd-blob.ts"],"sourcesContent":["import './polyfills';\r\nimport {KlApp} from './app/kl-app';\r\nimport {IKlProject} from './klecks/kl.types';\r\nimport {SaveReminder} from './klecks/ui/components/save-reminder';\r\nimport {klHistory} from './klecks/history/kl-history';\r\nimport {readPsd} from './klecks/storage/psd';\r\n\r\nexport interface IEmbedParams {\r\n    project?: IKlProject,\r\n    psdBlob?: Blob,\r\n    onSubmit: (onSuccess: () => void, onError: () => void) => void;\r\n    embedUrl: string;\r\n    logoImg?: any;\r\n    bottomBar?: HTMLElement;\r\n}\r\n\r\nexport interface IReadPSD {\r\n    blob: Blob;\r\n    callback: (k: IKlProject) => void;\r\n}\r\n\r\nexport function Embed(p: IEmbedParams) {\r\n\r\n    let isInitialized: boolean = false;\r\n    let klApp;\r\n    const psdQueue: IReadPSD[] = []; // queue of psds waiting while ag-psd is loading\r\n    let agPsd: any | 'error';\r\n\r\n    let loadingScreenEl = document.getElementById(\"loading-screen\");\r\n    let loadingScreenTextEl = document.getElementById(\"loading-screen-text\");\r\n    if (loadingScreenTextEl) {\r\n        loadingScreenTextEl.textContent = 'Waiting for image';\r\n    }\r\n\r\n    function onProjectReady(project: IKlProject) {\r\n        if (isInitialized) {\r\n            throw new Error('Already called openProject');\r\n        }\r\n        isInitialized = true;\r\n\r\n        if (loadingScreenEl && loadingScreenEl.parentNode) {\r\n            loadingScreenEl.parentNode.removeChild(loadingScreenEl);\r\n        }\r\n        loadingScreenEl = null;\r\n        loadingScreenTextEl = null;\r\n\r\n        const saveReminder = new SaveReminder(klHistory, false, false);\r\n        klApp = new KlApp(\r\n            project,\r\n            {\r\n                saveReminder,\r\n                bottomBar: p.bottomBar,\r\n                embed: {\r\n                    url: p.embedUrl,\r\n                    onSubmit: p.onSubmit,\r\n                }\r\n            }\r\n        );\r\n        saveReminder.init();\r\n\r\n        document.body.appendChild(klApp.getEl());\r\n    }\r\n\r\n    if (p.project) {\r\n        onProjectReady(p.project);\r\n    }\r\n    this.openProject = onProjectReady;\r\n    this.initError = (error: string) => {\r\n        if (loadingScreenTextEl) {\r\n            loadingScreenTextEl.textContent = '❌ ' + error;\r\n        }\r\n        if (loadingScreenEl) {\r\n            loadingScreenEl.className += 'loading-screen-error';\r\n        }\r\n    };\r\n    this.getPNG = (): Blob => {\r\n        if (!klApp) {\r\n            throw new Error('App not initialized');\r\n        }\r\n        return klApp.getPNG();\r\n    };\r\n    this.getPSD = async (): Promise<Blob> => {\r\n        if (!klApp) {\r\n            throw new Error('App not initialized');\r\n        }\r\n        return await klApp.getPSD();\r\n    };\r\n    this.readPSDs = (psds: IReadPSD[]) => {\r\n        if (psds.length === 0) {\r\n            return;\r\n        }\r\n\r\n        const readItem = (item: IReadPSD) => {\r\n            try {\r\n                const psd = agPsd.readPsd(item.blob);\r\n                const project = readPsd(psd);\r\n                if (project) {\r\n                    // convert to KlekiProjectObj\r\n                    for (let i = 0; i < project.layerArr.length; i++) {\r\n                        project.layerArr[i].image = project.layerArr[i].canvas;\r\n                        delete project.layerArr[i].canvas;\r\n                    }\r\n                    project.layers = project.layerArr;\r\n                    delete project.layerArr;\r\n                }\r\n                item.callback(project);\r\n            } catch (e) {\r\n                console.error('failed to read psd', e);\r\n                item.callback(null);\r\n            }\r\n        };\r\n\r\n        if (!agPsd) {\r\n            if (psdQueue.length === 0) {\r\n                // load ag-psd\r\n                (async () => {\r\n                    try {\r\n                        agPsd = await import('ag-psd');\r\n                    } catch (e) {\r\n                        agPsd = 'error';\r\n                    }\r\n                    while (psdQueue.length) {\r\n                        readItem(psdQueue.shift());\r\n                    }\r\n                })();\r\n            }\r\n            psds.forEach(item => {\r\n                psdQueue.push(item);\r\n            });\r\n        } else {\r\n            psds.forEach(readItem);\r\n        }\r\n    };\r\n}","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar apply = require('../internals/function-apply');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar IS_PURE = require('../internals/is-pure');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\nvar fails = require('../internals/fails');\nvar hasOwn = require('../internals/has-own-property');\nvar isArray = require('../internals/is-array');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar isSymbol = require('../internals/is-symbol');\nvar anObject = require('../internals/an-object');\nvar toObject = require('../internals/to-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar $toString = require('../internals/to-string');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar nativeObjectCreate = require('../internals/object-create');\nvar objectKeys = require('../internals/object-keys');\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertyNamesExternal = require('../internals/object-get-own-property-names-external');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar definePropertyModule = require('../internals/object-define-property');\nvar definePropertiesModule = require('../internals/object-define-properties');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar arraySlice = require('../internals/array-slice');\nvar redefine = require('../internals/redefine');\nvar shared = require('../internals/shared');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar uid = require('../internals/uid');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar wrappedWellKnownSymbolModule = require('../internals/well-known-symbol-wrapped');\nvar defineWellKnownSymbol = require('../internals/define-well-known-symbol');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar InternalStateModule = require('../internals/internal-state');\nvar $forEach = require('../internals/array-iteration').forEach;\n\nvar HIDDEN = sharedKey('hidden');\nvar SYMBOL = 'Symbol';\nvar PROTOTYPE = 'prototype';\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\n\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(SYMBOL);\n\nvar ObjectPrototype = Object[PROTOTYPE];\nvar $Symbol = global.Symbol;\nvar SymbolPrototype = $Symbol && $Symbol[PROTOTYPE];\nvar TypeError = global.TypeError;\nvar QObject = global.QObject;\nvar $stringify = getBuiltIn('JSON', 'stringify');\nvar nativeGetOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\nvar nativeDefineProperty = definePropertyModule.f;\nvar nativeGetOwnPropertyNames = getOwnPropertyNamesExternal.f;\nvar nativePropertyIsEnumerable = propertyIsEnumerableModule.f;\nvar push = uncurryThis([].push);\n\nvar AllSymbols = shared('symbols');\nvar ObjectPrototypeSymbols = shared('op-symbols');\nvar StringToSymbolRegistry = shared('string-to-symbol-registry');\nvar SymbolToStringRegistry = shared('symbol-to-string-registry');\nvar WellKnownSymbolsStore = shared('wks');\n\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar USE_SETTER = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDescriptor = DESCRIPTORS && fails(function () {\n  return nativeObjectCreate(nativeDefineProperty({}, 'a', {\n    get: function () { return nativeDefineProperty(this, 'a', { value: 7 }).a; }\n  })).a != 7;\n}) ? function (O, P, Attributes) {\n  var ObjectPrototypeDescriptor = nativeGetOwnPropertyDescriptor(ObjectPrototype, P);\n  if (ObjectPrototypeDescriptor) delete ObjectPrototype[P];\n  nativeDefineProperty(O, P, Attributes);\n  if (ObjectPrototypeDescriptor && O !== ObjectPrototype) {\n    nativeDefineProperty(ObjectPrototype, P, ObjectPrototypeDescriptor);\n  }\n} : nativeDefineProperty;\n\nvar wrap = function (tag, description) {\n  var symbol = AllSymbols[tag] = nativeObjectCreate(SymbolPrototype);\n  setInternalState(symbol, {\n    type: SYMBOL,\n    tag: tag,\n    description: description\n  });\n  if (!DESCRIPTORS) symbol.description = description;\n  return symbol;\n};\n\nvar $defineProperty = function defineProperty(O, P, Attributes) {\n  if (O === ObjectPrototype) $defineProperty(ObjectPrototypeSymbols, P, Attributes);\n  anObject(O);\n  var key = toPropertyKey(P);\n  anObject(Attributes);\n  if (hasOwn(AllSymbols, key)) {\n    if (!Attributes.enumerable) {\n      if (!hasOwn(O, HIDDEN)) nativeDefineProperty(O, HIDDEN, createPropertyDescriptor(1, {}));\n      O[HIDDEN][key] = true;\n    } else {\n      if (hasOwn(O, HIDDEN) && O[HIDDEN][key]) O[HIDDEN][key] = false;\n      Attributes = nativeObjectCreate(Attributes, { enumerable: createPropertyDescriptor(0, false) });\n    } return setSymbolDescriptor(O, key, Attributes);\n  } return nativeDefineProperty(O, key, Attributes);\n};\n\nvar $defineProperties = function defineProperties(O, Properties) {\n  anObject(O);\n  var properties = toIndexedObject(Properties);\n  var keys = objectKeys(properties).concat($getOwnPropertySymbols(properties));\n  $forEach(keys, function (key) {\n    if (!DESCRIPTORS || call($propertyIsEnumerable, properties, key)) $defineProperty(O, key, properties[key]);\n  });\n  return O;\n};\n\nvar $create = function create(O, Properties) {\n  return Properties === undefined ? nativeObjectCreate(O) : $defineProperties(nativeObjectCreate(O), Properties);\n};\n\nvar $propertyIsEnumerable = function propertyIsEnumerable(V) {\n  var P = toPropertyKey(V);\n  var enumerable = call(nativePropertyIsEnumerable, this, P);\n  if (this === ObjectPrototype && hasOwn(AllSymbols, P) && !hasOwn(ObjectPrototypeSymbols, P)) return false;\n  return enumerable || !hasOwn(this, P) || !hasOwn(AllSymbols, P) || hasOwn(this, HIDDEN) && this[HIDDEN][P]\n    ? enumerable : true;\n};\n\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(O, P) {\n  var it = toIndexedObject(O);\n  var key = toPropertyKey(P);\n  if (it === ObjectPrototype && hasOwn(AllSymbols, key) && !hasOwn(ObjectPrototypeSymbols, key)) return;\n  var descriptor = nativeGetOwnPropertyDescriptor(it, key);\n  if (descriptor && hasOwn(AllSymbols, key) && !(hasOwn(it, HIDDEN) && it[HIDDEN][key])) {\n    descriptor.enumerable = true;\n  }\n  return descriptor;\n};\n\nvar $getOwnPropertyNames = function getOwnPropertyNames(O) {\n  var names = nativeGetOwnPropertyNames(toIndexedObject(O));\n  var result = [];\n  $forEach(names, function (key) {\n    if (!hasOwn(AllSymbols, key) && !hasOwn(hiddenKeys, key)) push(result, key);\n  });\n  return result;\n};\n\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(O) {\n  var IS_OBJECT_PROTOTYPE = O === ObjectPrototype;\n  var names = nativeGetOwnPropertyNames(IS_OBJECT_PROTOTYPE ? ObjectPrototypeSymbols : toIndexedObject(O));\n  var result = [];\n  $forEach(names, function (key) {\n    if (hasOwn(AllSymbols, key) && (!IS_OBJECT_PROTOTYPE || hasOwn(ObjectPrototype, key))) {\n      push(result, AllSymbols[key]);\n    }\n  });\n  return result;\n};\n\n// `Symbol` constructor\n// https://tc39.es/ecma262/#sec-symbol-constructor\nif (!NATIVE_SYMBOL) {\n  $Symbol = function Symbol() {\n    if (isPrototypeOf(SymbolPrototype, this)) throw TypeError('Symbol is not a constructor');\n    var description = !arguments.length || arguments[0] === undefined ? undefined : $toString(arguments[0]);\n    var tag = uid(description);\n    var setter = function (value) {\n      if (this === ObjectPrototype) call(setter, ObjectPrototypeSymbols, value);\n      if (hasOwn(this, HIDDEN) && hasOwn(this[HIDDEN], tag)) this[HIDDEN][tag] = false;\n      setSymbolDescriptor(this, tag, createPropertyDescriptor(1, value));\n    };\n    if (DESCRIPTORS && USE_SETTER) setSymbolDescriptor(ObjectPrototype, tag, { configurable: true, set: setter });\n    return wrap(tag, description);\n  };\n\n  SymbolPrototype = $Symbol[PROTOTYPE];\n\n  redefine(SymbolPrototype, 'toString', function toString() {\n    return getInternalState(this).tag;\n  });\n\n  redefine($Symbol, 'withoutSetter', function (description) {\n    return wrap(uid(description), description);\n  });\n\n  propertyIsEnumerableModule.f = $propertyIsEnumerable;\n  definePropertyModule.f = $defineProperty;\n  definePropertiesModule.f = $defineProperties;\n  getOwnPropertyDescriptorModule.f = $getOwnPropertyDescriptor;\n  getOwnPropertyNamesModule.f = getOwnPropertyNamesExternal.f = $getOwnPropertyNames;\n  getOwnPropertySymbolsModule.f = $getOwnPropertySymbols;\n\n  wrappedWellKnownSymbolModule.f = function (name) {\n    return wrap(wellKnownSymbol(name), name);\n  };\n\n  if (DESCRIPTORS) {\n    // https://github.com/tc39/proposal-Symbol-description\n    nativeDefineProperty(SymbolPrototype, 'description', {\n      configurable: true,\n      get: function description() {\n        return getInternalState(this).description;\n      }\n    });\n    if (!IS_PURE) {\n      redefine(ObjectPrototype, 'propertyIsEnumerable', $propertyIsEnumerable, { unsafe: true });\n    }\n  }\n}\n\n$({ global: true, wrap: true, forced: !NATIVE_SYMBOL, sham: !NATIVE_SYMBOL }, {\n  Symbol: $Symbol\n});\n\n$forEach(objectKeys(WellKnownSymbolsStore), function (name) {\n  defineWellKnownSymbol(name);\n});\n\n$({ target: SYMBOL, stat: true, forced: !NATIVE_SYMBOL }, {\n  // `Symbol.for` method\n  // https://tc39.es/ecma262/#sec-symbol.for\n  'for': function (key) {\n    var string = $toString(key);\n    if (hasOwn(StringToSymbolRegistry, string)) return StringToSymbolRegistry[string];\n    var symbol = $Symbol(string);\n    StringToSymbolRegistry[string] = symbol;\n    SymbolToStringRegistry[symbol] = string;\n    return symbol;\n  },\n  // `Symbol.keyFor` method\n  // https://tc39.es/ecma262/#sec-symbol.keyfor\n  keyFor: function keyFor(sym) {\n    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol');\n    if (hasOwn(SymbolToStringRegistry, sym)) return SymbolToStringRegistry[sym];\n  },\n  useSetter: function () { USE_SETTER = true; },\n  useSimple: function () { USE_SETTER = false; }\n});\n\n$({ target: 'Object', stat: true, forced: !NATIVE_SYMBOL, sham: !DESCRIPTORS }, {\n  // `Object.create` method\n  // https://tc39.es/ecma262/#sec-object.create\n  create: $create,\n  // `Object.defineProperty` method\n  // https://tc39.es/ecma262/#sec-object.defineproperty\n  defineProperty: $defineProperty,\n  // `Object.defineProperties` method\n  // https://tc39.es/ecma262/#sec-object.defineproperties\n  defineProperties: $defineProperties,\n  // `Object.getOwnPropertyDescriptor` method\n  // https://tc39.es/ecma262/#sec-object.getownpropertydescriptors\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor\n});\n\n$({ target: 'Object', stat: true, forced: !NATIVE_SYMBOL }, {\n  // `Object.getOwnPropertyNames` method\n  // https://tc39.es/ecma262/#sec-object.getownpropertynames\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // `Object.getOwnPropertySymbols` method\n  // https://tc39.es/ecma262/#sec-object.getownpropertysymbols\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// Chrome 38 and 39 `Object.getOwnPropertySymbols` fails on primitives\n// https://bugs.chromium.org/p/v8/issues/detail?id=3443\n$({ target: 'Object', stat: true, forced: fails(function () { getOwnPropertySymbolsModule.f(1); }) }, {\n  getOwnPropertySymbols: function getOwnPropertySymbols(it) {\n    return getOwnPropertySymbolsModule.f(toObject(it));\n  }\n});\n\n// `JSON.stringify` method behavior with symbols\n// https://tc39.es/ecma262/#sec-json.stringify\nif ($stringify) {\n  var FORCED_JSON_STRINGIFY = !NATIVE_SYMBOL || fails(function () {\n    var symbol = $Symbol();\n    // MS Edge converts symbol values to JSON as {}\n    return $stringify([symbol]) != '[null]'\n      // WebKit converts symbol values to JSON as null\n      || $stringify({ a: symbol }) != '{}'\n      // V8 throws on boxed symbols\n      || $stringify(Object(symbol)) != '{}';\n  });\n\n  $({ target: 'JSON', stat: true, forced: FORCED_JSON_STRINGIFY }, {\n    // eslint-disable-next-line no-unused-vars -- required for `.length`\n    stringify: function stringify(it, replacer, space) {\n      var args = arraySlice(arguments);\n      var $replacer = replacer;\n      if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined\n      if (!isArray(replacer)) replacer = function (key, value) {\n        if (isCallable($replacer)) value = call($replacer, this, key, value);\n        if (!isSymbol(value)) return value;\n      };\n      args[1] = replacer;\n      return apply($stringify, null, args);\n    }\n  });\n}\n\n// `Symbol.prototype[@@toPrimitive]` method\n// https://tc39.es/ecma262/#sec-symbol.prototype-@@toprimitive\nif (!SymbolPrototype[TO_PRIMITIVE]) {\n  var valueOf = SymbolPrototype.valueOf;\n  // eslint-disable-next-line no-unused-vars -- required for .length\n  redefine(SymbolPrototype, TO_PRIMITIVE, function (hint) {\n    // TODO: improve hint logic\n    return call(valueOf, this);\n  });\n}\n// `Symbol.prototype[@@toStringTag]` property\n// https://tc39.es/ecma262/#sec-symbol.prototype-@@tostringtag\nsetToStringTag($Symbol, SYMBOL);\n\nhiddenKeys[HIDDEN] = true;\n","var global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar setGlobal = require('../internals/set-global');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar isForced = require('../internals/is-forced');\n\n/*\n  options.target      - name of the target object\n  options.global      - target is the global object\n  options.stat        - export as static methods of target\n  options.proto       - export as prototype methods of target\n  options.real        - real prototype method for the `pure` version\n  options.forced      - export even if the native feature is available\n  options.bind        - bind methods to the target, required for the `pure` version\n  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n  options.sham        - add a flag to not completely full polyfills\n  options.enumerable  - export as enumerable property\n  options.noTargetGet - prevent calling a getter on target\n  options.name        - the .name of the function if it does not match the key\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || setGlobal(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.noTargetGet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty == typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    // extend global\n    redefine(target, key, sourceProperty, options);\n  }\n};\n","var check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line es/no-global-this -- safe\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  // eslint-disable-next-line no-restricted-globals -- safe\n  check(typeof self == 'object' && self) ||\n  check(typeof global == 'object' && global) ||\n  // eslint-disable-next-line no-new-func -- fallback\n  (function () { return this; })() || Function('return this')();\n","var DESCRIPTORS = require('../internals/descriptors');\nvar call = require('../internals/function-call');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar hasOwn = require('../internals/has-own-property');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\n\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? $getOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPropertyKey(P);\n  if (IE8_DOM_DEFINE) try {\n    return $getOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (hasOwn(O, P)) return createPropertyDescriptor(!call(propertyIsEnumerableModule.f, O, P), O[P]);\n};\n","var fails = require('../internals/fails');\n\n// Detect IE8's incomplete defineProperty implementation\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n});\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n","var NATIVE_BIND = require('../internals/function-bind-native');\n\nvar call = Function.prototype.call;\n\nmodule.exports = NATIVE_BIND ? call.bind(call) : function () {\n  return call.apply(call, arguments);\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  var test = (function () { /* empty */ }).bind();\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return typeof test != 'function' || test.hasOwnProperty('prototype');\n});\n","'use strict';\nvar $propertyIsEnumerable = {}.propertyIsEnumerable;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !$propertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : $propertyIsEnumerable;\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = require('../internals/indexed-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n","var global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar classof = require('../internals/classof-raw');\n\nvar Object = global.Object;\nvar split = uncurryThis(''.split);\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return !Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split(it, '') : Object(it);\n} : Object;\n","var NATIVE_BIND = require('../internals/function-bind-native');\n\nvar FunctionPrototype = Function.prototype;\nvar bind = FunctionPrototype.bind;\nvar call = FunctionPrototype.call;\nvar uncurryThis = NATIVE_BIND && bind.bind(call, call);\n\nmodule.exports = NATIVE_BIND ? function (fn) {\n  return fn && uncurryThis(fn);\n} : function (fn) {\n  return fn && function () {\n    return call.apply(fn, arguments);\n  };\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nvar toString = uncurryThis({}.toString);\nvar stringSlice = uncurryThis(''.slice);\n\nmodule.exports = function (it) {\n  return stringSlice(toString(it), 8, -1);\n};\n","var global = require('../internals/global');\n\nvar TypeError = global.TypeError;\n\n// `RequireObjectCoercible` abstract operation\n// https://tc39.es/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on \" + it);\n  return it;\n};\n","var toPrimitive = require('../internals/to-primitive');\nvar isSymbol = require('../internals/is-symbol');\n\n// `ToPropertyKey` abstract operation\n// https://tc39.es/ecma262/#sec-topropertykey\nmodule.exports = function (argument) {\n  var key = toPrimitive(argument, 'string');\n  return isSymbol(key) ? key : key + '';\n};\n","var global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar isObject = require('../internals/is-object');\nvar isSymbol = require('../internals/is-symbol');\nvar getMethod = require('../internals/get-method');\nvar ordinaryToPrimitive = require('../internals/ordinary-to-primitive');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TypeError = global.TypeError;\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\n\n// `ToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-toprimitive\nmodule.exports = function (input, pref) {\n  if (!isObject(input) || isSymbol(input)) return input;\n  var exoticToPrim = getMethod(input, TO_PRIMITIVE);\n  var result;\n  if (exoticToPrim) {\n    if (pref === undefined) pref = 'default';\n    result = call(exoticToPrim, input, pref);\n    if (!isObject(result) || isSymbol(result)) return result;\n    throw TypeError(\"Can't convert object to primitive value\");\n  }\n  if (pref === undefined) pref = 'number';\n  return ordinaryToPrimitive(input, pref);\n};\n","var isCallable = require('../internals/is-callable');\n\nmodule.exports = function (it) {\n  return typeof it == 'object' ? it !== null : isCallable(it);\n};\n","// `IsCallable` abstract operation\n// https://tc39.es/ecma262/#sec-iscallable\nmodule.exports = function (argument) {\n  return typeof argument == 'function';\n};\n","var global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar isCallable = require('../internals/is-callable');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar Object = global.Object;\n\nmodule.exports = USE_SYMBOL_AS_UID ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  var $Symbol = getBuiltIn('Symbol');\n  return isCallable($Symbol) && isPrototypeOf($Symbol.prototype, Object(it));\n};\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\n\nvar aFunction = function (argument) {\n  return isCallable(argument) ? argument : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(global[namespace]) : global[namespace] && global[namespace][method];\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nmodule.exports = uncurryThis({}.isPrototypeOf);\n","/* eslint-disable es/no-symbol -- required for testing */\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\n\nmodule.exports = NATIVE_SYMBOL\n  && !Symbol.sham\n  && typeof Symbol.iterator == 'symbol';\n","/* eslint-disable es/no-symbol -- required for testing */\nvar V8_VERSION = require('../internals/engine-v8-version');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- required for testing\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  var symbol = Symbol();\n  // Chrome 38 Symbol has incorrect toString conversion\n  // `get-own-property-symbols` polyfill symbols converted to object are not Symbol instances\n  return !String(symbol) || !(Object(symbol) instanceof Symbol) ||\n    // Chrome 38-40 symbols are not inherited from DOM collections prototypes to instances\n    !Symbol.sham && V8_VERSION && V8_VERSION < 41;\n});\n","var global = require('../internals/global');\nvar userAgent = require('../internals/engine-user-agent');\n\nvar process = global.process;\nvar Deno = global.Deno;\nvar versions = process && process.versions || Deno && Deno.version;\nvar v8 = versions && versions.v8;\nvar match, version;\n\nif (v8) {\n  match = v8.split('.');\n  // in old Chrome, versions of V8 isn't V8 = Chrome / 10\n  // but their correct versions are not interesting for us\n  version = match[0] > 0 && match[0] < 4 ? 1 : +(match[0] + match[1]);\n}\n\n// BrowserFS NodeJS `process` polyfill incorrectly set `.v8` to `0.0`\n// so check `userAgent` even if `.v8` exists, but 0\nif (!version && userAgent) {\n  match = userAgent.match(/Edge\\/(\\d+)/);\n  if (!match || match[1] >= 74) {\n    match = userAgent.match(/Chrome\\/(\\d+)/);\n    if (match) version = +match[1];\n  }\n}\n\nmodule.exports = version;\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('navigator', 'userAgent') || '';\n","var aCallable = require('../internals/a-callable');\n\n// `GetMethod` abstract operation\n// https://tc39.es/ecma262/#sec-getmethod\nmodule.exports = function (V, P) {\n  var func = V[P];\n  return func == null ? undefined : aCallable(func);\n};\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar tryToString = require('../internals/try-to-string');\n\nvar TypeError = global.TypeError;\n\n// `Assert: IsCallable(argument) is true`\nmodule.exports = function (argument) {\n  if (isCallable(argument)) return argument;\n  throw TypeError(tryToString(argument) + ' is not a function');\n};\n","var global = require('../internals/global');\n\nvar String = global.String;\n\nmodule.exports = function (argument) {\n  try {\n    return String(argument);\n  } catch (error) {\n    return 'Object';\n  }\n};\n","var global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\n\nvar TypeError = global.TypeError;\n\n// `OrdinaryToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-ordinarytoprimitive\nmodule.exports = function (input, pref) {\n  var fn, val;\n  if (pref === 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  if (isCallable(fn = input.valueOf) && !isObject(val = call(fn, input))) return val;\n  if (pref !== 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var global = require('../internals/global');\nvar shared = require('../internals/shared');\nvar hasOwn = require('../internals/has-own-property');\nvar uid = require('../internals/uid');\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar WellKnownSymbolsStore = shared('wks');\nvar Symbol = global.Symbol;\nvar symbolFor = Symbol && Symbol['for'];\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!hasOwn(WellKnownSymbolsStore, name) || !(NATIVE_SYMBOL || typeof WellKnownSymbolsStore[name] == 'string')) {\n    var description = 'Symbol.' + name;\n    if (NATIVE_SYMBOL && hasOwn(Symbol, name)) {\n      WellKnownSymbolsStore[name] = Symbol[name];\n    } else if (USE_SYMBOL_AS_UID && symbolFor) {\n      WellKnownSymbolsStore[name] = symbolFor(description);\n    } else {\n      WellKnownSymbolsStore[name] = createWellKnownSymbol(description);\n    }\n  } return WellKnownSymbolsStore[name];\n};\n","var IS_PURE = require('../internals/is-pure');\nvar store = require('../internals/shared-store');\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.20.3',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: '© 2014-2022 Denis Pushkarev (zloirock.ru)',\n  license: 'https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE',\n  source: 'https://github.com/zloirock/core-js'\n});\n","module.exports = false;\n","var global = require('../internals/global');\nvar setGlobal = require('../internals/set-global');\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || setGlobal(SHARED, {});\n\nmodule.exports = store;\n","var global = require('../internals/global');\n\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar defineProperty = Object.defineProperty;\n\nmodule.exports = function (key, value) {\n  try {\n    defineProperty(global, key, { value: value, configurable: true, writable: true });\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar toObject = require('../internals/to-object');\n\nvar hasOwnProperty = uncurryThis({}.hasOwnProperty);\n\n// `HasOwnProperty` abstract operation\n// https://tc39.es/ecma262/#sec-hasownproperty\nmodule.exports = Object.hasOwn || function hasOwn(it, key) {\n  return hasOwnProperty(toObject(it), key);\n};\n","var global = require('../internals/global');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar Object = global.Object;\n\n// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nvar id = 0;\nvar postfix = Math.random();\nvar toString = uncurryThis(1.0.toString);\n\nmodule.exports = function (key) {\n  return 'Symbol(' + (key === undefined ? '' : key) + ')_' + toString(++id + postfix, 36);\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar createElement = require('../internals/document-create-element');\n\n// Thanks to IE8 for its funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var global = require('../internals/global');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\nvar V8_PROTOTYPE_DEFINE_BUG = require('../internals/v8-prototype-define-bug');\nvar anObject = require('../internals/an-object');\nvar toPropertyKey = require('../internals/to-property-key');\n\nvar TypeError = global.TypeError;\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar $defineProperty = Object.defineProperty;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nvar ENUMERABLE = 'enumerable';\nvar CONFIGURABLE = 'configurable';\nvar WRITABLE = 'writable';\n\n// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? V8_PROTOTYPE_DEFINE_BUG ? function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (typeof O === 'function' && P === 'prototype' && 'value' in Attributes && WRITABLE in Attributes && !Attributes[WRITABLE]) {\n    var current = $getOwnPropertyDescriptor(O, P);\n    if (current && current[WRITABLE]) {\n      O[P] = Attributes.value;\n      Attributes = {\n        configurable: CONFIGURABLE in Attributes ? Attributes[CONFIGURABLE] : current[CONFIGURABLE],\n        enumerable: ENUMERABLE in Attributes ? Attributes[ENUMERABLE] : current[ENUMERABLE],\n        writable: false\n      };\n    }\n  } return $defineProperty(O, P, Attributes);\n} : $defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return $defineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\n\n// V8 ~ Chrome 36-\n// https://bugs.chromium.org/p/v8/issues/detail?id=3334\nmodule.exports = DESCRIPTORS && fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(function () { /* empty */ }, 'prototype', {\n    value: 42,\n    writable: false\n  }).prototype != 42;\n});\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar String = global.String;\nvar TypeError = global.TypeError;\n\n// `Assert: Type(argument) is Object`\nmodule.exports = function (argument) {\n  if (isObject(argument)) return argument;\n  throw TypeError(String(argument) + ' is not an object');\n};\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar hasOwn = require('../internals/has-own-property');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar setGlobal = require('../internals/set-global');\nvar inspectSource = require('../internals/inspect-source');\nvar InternalStateModule = require('../internals/internal-state');\nvar CONFIGURABLE_FUNCTION_NAME = require('../internals/function-name').CONFIGURABLE;\n\nvar getInternalState = InternalStateModule.get;\nvar enforceInternalState = InternalStateModule.enforce;\nvar TEMPLATE = String(String).split('String');\n\n(module.exports = function (O, key, value, options) {\n  var unsafe = options ? !!options.unsafe : false;\n  var simple = options ? !!options.enumerable : false;\n  var noTargetGet = options ? !!options.noTargetGet : false;\n  var name = options && options.name !== undefined ? options.name : key;\n  var state;\n  if (isCallable(value)) {\n    if (String(name).slice(0, 7) === 'Symbol(') {\n      name = '[' + String(name).replace(/^Symbol\\(([^)]*)\\)/, '$1') + ']';\n    }\n    if (!hasOwn(value, 'name') || (CONFIGURABLE_FUNCTION_NAME && value.name !== name)) {\n      createNonEnumerableProperty(value, 'name', name);\n    }\n    state = enforceInternalState(value);\n    if (!state.source) {\n      state.source = TEMPLATE.join(typeof name == 'string' ? name : '');\n    }\n  }\n  if (O === global) {\n    if (simple) O[key] = value;\n    else setGlobal(key, value);\n    return;\n  } else if (!unsafe) {\n    delete O[key];\n  } else if (!noTargetGet && O[key]) {\n    simple = true;\n  }\n  if (simple) O[key] = value;\n  else createNonEnumerableProperty(O, key, value);\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, 'toString', function toString() {\n  return isCallable(this) && getInternalState(this).source || inspectSource(this);\n});\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar isCallable = require('../internals/is-callable');\nvar store = require('../internals/shared-store');\n\nvar functionToString = uncurryThis(Function.toString);\n\n// this helper broken in `core-js@3.4.1-3.4.4`, so we can't use `shared` helper\nif (!isCallable(store.inspectSource)) {\n  store.inspectSource = function (it) {\n    return functionToString(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n","var NATIVE_WEAK_MAP = require('../internals/native-weak-map');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar hasOwn = require('../internals/has-own-property');\nvar shared = require('../internals/shared-store');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar OBJECT_ALREADY_INITIALIZED = 'Object already initialized';\nvar TypeError = global.TypeError;\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP || shared.state) {\n  var store = shared.state || (shared.state = new WeakMap());\n  var wmget = uncurryThis(store.get);\n  var wmhas = uncurryThis(store.has);\n  var wmset = uncurryThis(store.set);\n  set = function (it, metadata) {\n    if (wmhas(store, it)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    wmset(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    if (hasOwn(it, STATE)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return hasOwn(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return hasOwn(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar inspectSource = require('../internals/inspect-source');\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = isCallable(WeakMap) && /native code/.test(inspectSource(WeakMap));\n","var shared = require('../internals/shared');\nvar uid = require('../internals/uid');\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n","module.exports = {};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar hasOwn = require('../internals/has-own-property');\n\nvar FunctionPrototype = Function.prototype;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getDescriptor = DESCRIPTORS && Object.getOwnPropertyDescriptor;\n\nvar EXISTS = hasOwn(FunctionPrototype, 'name');\n// additional protection from minified / mangled / dropped function names\nvar PROPER = EXISTS && (function something() { /* empty */ }).name === 'something';\nvar CONFIGURABLE = EXISTS && (!DESCRIPTORS || (DESCRIPTORS && getDescriptor(FunctionPrototype, 'name').configurable));\n\nmodule.exports = {\n  EXISTS: EXISTS,\n  PROPER: PROPER,\n  CONFIGURABLE: CONFIGURABLE\n};\n","var hasOwn = require('../internals/has-own-property');\nvar ownKeys = require('../internals/own-keys');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar definePropertyModule = require('../internals/object-define-property');\n\nmodule.exports = function (target, source, exceptions) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!hasOwn(target, key) && !(exceptions && hasOwn(exceptions, key))) {\n      defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n    }\n  }\n};\n","var getBuiltIn = require('../internals/get-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar anObject = require('../internals/an-object');\n\nvar concat = uncurryThis([].concat);\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? concat(keys, getOwnPropertySymbols(it)) : keys;\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n// eslint-disable-next-line es/no-object-getownpropertynames -- safe\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar hasOwn = require('../internals/has-own-property');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar indexOf = require('../internals/array-includes').indexOf;\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar push = uncurryThis([].push);\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !hasOwn(hiddenKeys, key) && hasOwn(O, key) && push(result, key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (hasOwn(O, key = names[i++])) {\n    ~indexOf(result, key) || push(result, key);\n  }\n  return result;\n};\n","var toIndexedObject = require('../internals/to-indexed-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = lengthOfArrayLike(O);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare -- NaN check\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.es/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.es/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n","var toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toIntegerOrInfinity(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n","var ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `ToIntegerOrInfinity` abstract operation\n// https://tc39.es/ecma262/#sec-tointegerorinfinity\nmodule.exports = function (argument) {\n  var number = +argument;\n  // eslint-disable-next-line no-self-compare -- safe\n  return number !== number || number === 0 ? 0 : (number > 0 ? floor : ceil)(number);\n};\n","var toLength = require('../internals/to-length');\n\n// `LengthOfArrayLike` abstract operation\n// https://tc39.es/ecma262/#sec-lengthofarraylike\nmodule.exports = function (obj) {\n  return toLength(obj.length);\n};\n","var toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.es/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toIntegerOrInfinity(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n","// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n","// eslint-disable-next-line es/no-object-getownpropertysymbols -- safe\nexports.f = Object.getOwnPropertySymbols;\n","var fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : isCallable(detection) ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n","var NATIVE_BIND = require('../internals/function-bind-native');\n\nvar FunctionPrototype = Function.prototype;\nvar apply = FunctionPrototype.apply;\nvar call = FunctionPrototype.call;\n\n// eslint-disable-next-line es/no-reflect -- safe\nmodule.exports = typeof Reflect == 'object' && Reflect.apply || (NATIVE_BIND ? call.bind(apply) : function () {\n  return call.apply(apply, arguments);\n});\n","var classof = require('../internals/classof-raw');\n\n// `IsArray` abstract operation\n// https://tc39.es/ecma262/#sec-isarray\n// eslint-disable-next-line es/no-array-isarray -- safe\nmodule.exports = Array.isArray || function isArray(argument) {\n  return classof(argument) == 'Array';\n};\n","var global = require('../internals/global');\nvar classof = require('../internals/classof');\n\nvar String = global.String;\n\nmodule.exports = function (argument) {\n  if (classof(argument) === 'Symbol') throw TypeError('Cannot convert a Symbol value to a string');\n  return String(argument);\n};\n","var global = require('../internals/global');\nvar TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar isCallable = require('../internals/is-callable');\nvar classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar Object = global.Object;\n\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && isCallable(O.callee) ? 'Arguments' : result;\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","/* global ActiveXObject -- old IE, WSH */\nvar anObject = require('../internals/an-object');\nvar definePropertiesModule = require('../internals/object-define-properties');\nvar enumBugKeys = require('../internals/enum-bug-keys');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar html = require('../internals/html');\nvar documentCreateElement = require('../internals/document-create-element');\nvar sharedKey = require('../internals/shared-key');\n\nvar GT = '>';\nvar LT = '<';\nvar PROTOTYPE = 'prototype';\nvar SCRIPT = 'script';\nvar IE_PROTO = sharedKey('IE_PROTO');\n\nvar EmptyConstructor = function () { /* empty */ };\n\nvar scriptTag = function (content) {\n  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;\n};\n\n// Create object with fake `null` prototype: use ActiveX Object with cleared prototype\nvar NullProtoObjectViaActiveX = function (activeXDocument) {\n  activeXDocument.write(scriptTag(''));\n  activeXDocument.close();\n  var temp = activeXDocument.parentWindow.Object;\n  activeXDocument = null; // avoid memory leak\n  return temp;\n};\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar NullProtoObjectViaIFrame = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var JS = 'java' + SCRIPT + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  // https://github.com/zloirock/core-js/issues/475\n  iframe.src = String(JS);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(scriptTag('document.F=Object'));\n  iframeDocument.close();\n  return iframeDocument.F;\n};\n\n// Check for document.domain and active x support\n// No need to use active x approach when document.domain is not set\n// see https://github.com/es-shims/es5-shim/issues/150\n// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n// avoid IE GC bug\nvar activeXDocument;\nvar NullProtoObject = function () {\n  try {\n    activeXDocument = new ActiveXObject('htmlfile');\n  } catch (error) { /* ignore */ }\n  NullProtoObject = typeof document != 'undefined'\n    ? document.domain && activeXDocument\n      ? NullProtoObjectViaActiveX(activeXDocument) // old IE\n      : NullProtoObjectViaIFrame()\n    : NullProtoObjectViaActiveX(activeXDocument); // WSH\n  var length = enumBugKeys.length;\n  while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];\n  return NullProtoObject();\n};\n\nhiddenKeys[IE_PROTO] = true;\n\n// `Object.create` method\n// https://tc39.es/ecma262/#sec-object.create\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    EmptyConstructor[PROTOTYPE] = anObject(O);\n    result = new EmptyConstructor();\n    EmptyConstructor[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = NullProtoObject();\n  return Properties === undefined ? result : definePropertiesModule.f(result, Properties);\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar V8_PROTOTYPE_DEFINE_BUG = require('../internals/v8-prototype-define-bug');\nvar definePropertyModule = require('../internals/object-define-property');\nvar anObject = require('../internals/an-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar objectKeys = require('../internals/object-keys');\n\n// `Object.defineProperties` method\n// https://tc39.es/ecma262/#sec-object.defineproperties\n// eslint-disable-next-line es/no-object-defineproperties -- safe\nexports.f = DESCRIPTORS && !V8_PROTOTYPE_DEFINE_BUG ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var props = toIndexedObject(Properties);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) definePropertyModule.f(O, key = keys[index++], props[key]);\n  return O;\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('document', 'documentElement');\n","/* eslint-disable es/no-object-getownpropertynames -- safe */\nvar classof = require('../internals/classof-raw');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar $getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar arraySlice = require('../internals/array-slice-simple');\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function (it) {\n  try {\n    return $getOwnPropertyNames(it);\n  } catch (error) {\n    return arraySlice(windowNames);\n  }\n};\n\n// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nmodule.exports.f = function getOwnPropertyNames(it) {\n  return windowNames && classof(it) == 'Window'\n    ? getWindowNames(it)\n    : $getOwnPropertyNames(toIndexedObject(it));\n};\n","var global = require('../internals/global');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar createProperty = require('../internals/create-property');\n\nvar Array = global.Array;\nvar max = Math.max;\n\nmodule.exports = function (O, start, end) {\n  var length = lengthOfArrayLike(O);\n  var k = toAbsoluteIndex(start, length);\n  var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n  var result = Array(max(fin - k, 0));\n  for (var n = 0; k < fin; k++, n++) createProperty(result, n, O[k]);\n  result.length = n;\n  return result;\n};\n","'use strict';\nvar toPropertyKey = require('../internals/to-property-key');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPropertyKey(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nmodule.exports = uncurryThis([].slice);\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nexports.f = wellKnownSymbol;\n","var path = require('../internals/path');\nvar hasOwn = require('../internals/has-own-property');\nvar wrappedWellKnownSymbolModule = require('../internals/well-known-symbol-wrapped');\nvar defineProperty = require('../internals/object-define-property').f;\n\nmodule.exports = function (NAME) {\n  var Symbol = path.Symbol || (path.Symbol = {});\n  if (!hasOwn(Symbol, NAME)) defineProperty(Symbol, NAME, {\n    value: wrappedWellKnownSymbolModule.f(NAME)\n  });\n};\n","var global = require('../internals/global');\n\nmodule.exports = global;\n","var defineProperty = require('../internals/object-define-property').f;\nvar hasOwn = require('../internals/has-own-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n\nmodule.exports = function (target, TAG, STATIC) {\n  if (target && !STATIC) target = target.prototype;\n  if (target && !hasOwn(target, TO_STRING_TAG)) {\n    defineProperty(target, TO_STRING_TAG, { configurable: true, value: TAG });\n  }\n};\n","var bind = require('../internals/function-bind-context');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar IndexedObject = require('../internals/indexed-object');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\nvar push = uncurryThis([].push);\n\n// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex, filterReject }` methods implementation\nvar createMethod = function (TYPE) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var IS_FILTER_REJECT = TYPE == 7;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  return function ($this, callbackfn, that, specificCreate) {\n    var O = toObject($this);\n    var self = IndexedObject(O);\n    var boundFunction = bind(callbackfn, that);\n    var length = lengthOfArrayLike(self);\n    var index = 0;\n    var create = specificCreate || arraySpeciesCreate;\n    var target = IS_MAP ? create($this, length) : IS_FILTER || IS_FILTER_REJECT ? create($this, 0) : undefined;\n    var value, result;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      value = self[index];\n      result = boundFunction(value, index, O);\n      if (TYPE) {\n        if (IS_MAP) target[index] = result; // map\n        else if (result) switch (TYPE) {\n          case 3: return true;              // some\n          case 5: return value;             // find\n          case 6: return index;             // findIndex\n          case 2: push(target, value);      // filter\n        } else switch (TYPE) {\n          case 4: return false;             // every\n          case 7: push(target, value);      // filterReject\n        }\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.forEach` method\n  // https://tc39.es/ecma262/#sec-array.prototype.foreach\n  forEach: createMethod(0),\n  // `Array.prototype.map` method\n  // https://tc39.es/ecma262/#sec-array.prototype.map\n  map: createMethod(1),\n  // `Array.prototype.filter` method\n  // https://tc39.es/ecma262/#sec-array.prototype.filter\n  filter: createMethod(2),\n  // `Array.prototype.some` method\n  // https://tc39.es/ecma262/#sec-array.prototype.some\n  some: createMethod(3),\n  // `Array.prototype.every` method\n  // https://tc39.es/ecma262/#sec-array.prototype.every\n  every: createMethod(4),\n  // `Array.prototype.find` method\n  // https://tc39.es/ecma262/#sec-array.prototype.find\n  find: createMethod(5),\n  // `Array.prototype.findIndex` method\n  // https://tc39.es/ecma262/#sec-array.prototype.findIndex\n  findIndex: createMethod(6),\n  // `Array.prototype.filterReject` method\n  // https://github.com/tc39/proposal-array-filtering\n  filterReject: createMethod(7)\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar NATIVE_BIND = require('../internals/function-bind-native');\n\nvar bind = uncurryThis(uncurryThis.bind);\n\n// optional / simple context binding\nmodule.exports = function (fn, that) {\n  aCallable(fn);\n  return that === undefined ? fn : NATIVE_BIND ? bind(fn, that) : function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","var arraySpeciesConstructor = require('../internals/array-species-constructor');\n\n// `ArraySpeciesCreate` abstract operation\n// https://tc39.es/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray, length) {\n  return new (arraySpeciesConstructor(originalArray))(length === 0 ? 0 : length);\n};\n","var global = require('../internals/global');\nvar isArray = require('../internals/is-array');\nvar isConstructor = require('../internals/is-constructor');\nvar isObject = require('../internals/is-object');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\nvar Array = global.Array;\n\n// a part of `ArraySpeciesCreate` abstract operation\n// https://tc39.es/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray) {\n  var C;\n  if (isArray(originalArray)) {\n    C = originalArray.constructor;\n    // cross-realm fallback\n    if (isConstructor(C) && (C === Array || isArray(C.prototype))) C = undefined;\n    else if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return C === undefined ? Array : C;\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\nvar classof = require('../internals/classof');\nvar getBuiltIn = require('../internals/get-built-in');\nvar inspectSource = require('../internals/inspect-source');\n\nvar noop = function () { /* empty */ };\nvar empty = [];\nvar construct = getBuiltIn('Reflect', 'construct');\nvar constructorRegExp = /^\\s*(?:class|function)\\b/;\nvar exec = uncurryThis(constructorRegExp.exec);\nvar INCORRECT_TO_STRING = !constructorRegExp.exec(noop);\n\nvar isConstructorModern = function isConstructor(argument) {\n  if (!isCallable(argument)) return false;\n  try {\n    construct(noop, empty, argument);\n    return true;\n  } catch (error) {\n    return false;\n  }\n};\n\nvar isConstructorLegacy = function isConstructor(argument) {\n  if (!isCallable(argument)) return false;\n  switch (classof(argument)) {\n    case 'AsyncFunction':\n    case 'GeneratorFunction':\n    case 'AsyncGeneratorFunction': return false;\n  }\n  try {\n    // we can't check .prototype since constructors produced by .bind haven't it\n    // `Function#toString` throws on some built-it function in some legacy engines\n    // (for example, `DOMQuad` and similar in FF41-)\n    return INCORRECT_TO_STRING || !!exec(constructorRegExp, inspectSource(argument));\n  } catch (error) {\n    return true;\n  }\n};\n\nisConstructorLegacy.sham = true;\n\n// `IsConstructor` abstract operation\n// https://tc39.es/ecma262/#sec-isconstructor\nmodule.exports = !construct || fails(function () {\n  var called;\n  return isConstructorModern(isConstructorModern.call)\n    || !isConstructorModern(Object)\n    || !isConstructorModern(function () { called = true; })\n    || called;\n}) ? isConstructorLegacy : isConstructorModern;\n","// `Symbol.prototype.description` getter\n// https://tc39.es/ecma262/#sec-symbol.prototype.description\n'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar hasOwn = require('../internals/has-own-property');\nvar isCallable = require('../internals/is-callable');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar toString = require('../internals/to-string');\nvar defineProperty = require('../internals/object-define-property').f;\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\n\nvar NativeSymbol = global.Symbol;\nvar SymbolPrototype = NativeSymbol && NativeSymbol.prototype;\n\nif (DESCRIPTORS && isCallable(NativeSymbol) && (!('description' in SymbolPrototype) ||\n  // Safari 12 bug\n  NativeSymbol().description !== undefined\n)) {\n  var EmptyStringDescriptionStore = {};\n  // wrap Symbol constructor for correct work with undefined description\n  var SymbolWrapper = function Symbol() {\n    var description = arguments.length < 1 || arguments[0] === undefined ? undefined : toString(arguments[0]);\n    var result = isPrototypeOf(SymbolPrototype, this)\n      ? new NativeSymbol(description)\n      // in Edge 13, String(Symbol(undefined)) === 'Symbol(undefined)'\n      : description === undefined ? NativeSymbol() : NativeSymbol(description);\n    if (description === '') EmptyStringDescriptionStore[result] = true;\n    return result;\n  };\n\n  copyConstructorProperties(SymbolWrapper, NativeSymbol);\n  SymbolWrapper.prototype = SymbolPrototype;\n  SymbolPrototype.constructor = SymbolWrapper;\n\n  var NATIVE_SYMBOL = String(NativeSymbol('test')) == 'Symbol(test)';\n  var symbolToString = uncurryThis(SymbolPrototype.toString);\n  var symbolValueOf = uncurryThis(SymbolPrototype.valueOf);\n  var regexp = /^Symbol\\((.*)\\)[^)]+$/;\n  var replace = uncurryThis(''.replace);\n  var stringSlice = uncurryThis(''.slice);\n\n  defineProperty(SymbolPrototype, 'description', {\n    configurable: true,\n    get: function description() {\n      var symbol = symbolValueOf(this);\n      var string = symbolToString(symbol);\n      if (hasOwn(EmptyStringDescriptionStore, symbol)) return '';\n      var desc = NATIVE_SYMBOL ? stringSlice(string, 7, -1) : replace(string, regexp, '$1');\n      return desc === '' ? undefined : desc;\n    }\n  });\n\n  $({ global: true, forced: true }, {\n    Symbol: SymbolWrapper\n  });\n}\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.asyncIterator` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.asynciterator\ndefineWellKnownSymbol('asyncIterator');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.hasInstance` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.hasinstance\ndefineWellKnownSymbol('hasInstance');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.isConcatSpreadable` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.isconcatspreadable\ndefineWellKnownSymbol('isConcatSpreadable');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.iterator` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.iterator\ndefineWellKnownSymbol('iterator');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.match` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.match\ndefineWellKnownSymbol('match');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.replace` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.replace\ndefineWellKnownSymbol('replace');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.search` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.search\ndefineWellKnownSymbol('search');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.species` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.species\ndefineWellKnownSymbol('species');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.split` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.split\ndefineWellKnownSymbol('split');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.toPrimitive` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.toprimitive\ndefineWellKnownSymbol('toPrimitive');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.toStringTag` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.tostringtag\ndefineWellKnownSymbol('toStringTag');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.unscopables` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.unscopables\ndefineWellKnownSymbol('unscopables');\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar isArray = require('../internals/is-array');\nvar isObject = require('../internals/is-object');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar createProperty = require('../internals/create-property');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar IS_CONCAT_SPREADABLE = wellKnownSymbol('isConcatSpreadable');\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_INDEX_EXCEEDED = 'Maximum allowed index exceeded';\nvar TypeError = global.TypeError;\n\n// We can't use this feature detection in V8 since it causes\n// deoptimization and serious performance degradation\n// https://github.com/zloirock/core-js/issues/679\nvar IS_CONCAT_SPREADABLE_SUPPORT = V8_VERSION >= 51 || !fails(function () {\n  var array = [];\n  array[IS_CONCAT_SPREADABLE] = false;\n  return array.concat()[0] !== array;\n});\n\nvar SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('concat');\n\nvar isConcatSpreadable = function (O) {\n  if (!isObject(O)) return false;\n  var spreadable = O[IS_CONCAT_SPREADABLE];\n  return spreadable !== undefined ? !!spreadable : isArray(O);\n};\n\nvar FORCED = !IS_CONCAT_SPREADABLE_SUPPORT || !SPECIES_SUPPORT;\n\n// `Array.prototype.concat` method\n// https://tc39.es/ecma262/#sec-array.prototype.concat\n// with adding support of @@isConcatSpreadable and @@species\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  concat: function concat(arg) {\n    var O = toObject(this);\n    var A = arraySpeciesCreate(O, 0);\n    var n = 0;\n    var i, k, length, len, E;\n    for (i = -1, length = arguments.length; i < length; i++) {\n      E = i === -1 ? O : arguments[i];\n      if (isConcatSpreadable(E)) {\n        len = lengthOfArrayLike(E);\n        if (n + len > MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        for (k = 0; k < len; k++, n++) if (k in E) createProperty(A, n, E[k]);\n      } else {\n        if (n >= MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        createProperty(A, n++, E);\n      }\n    }\n    A.length = n;\n    return A;\n  }\n});\n","var fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (METHOD_NAME) {\n  // We can't use this feature detection in V8 since it causes\n  // deoptimization and serious performance degradation\n  // https://github.com/zloirock/core-js/issues/677\n  return V8_VERSION >= 51 || !fails(function () {\n    var array = [];\n    var constructor = array.constructor = {};\n    constructor[SPECIES] = function () {\n      return { foo: 1 };\n    };\n    return array[METHOD_NAME](Boolean).foo !== 1;\n  });\n};\n","var $ = require('../internals/export');\nvar copyWithin = require('../internals/array-copy-within');\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.copyWithin` method\n// https://tc39.es/ecma262/#sec-array.prototype.copywithin\n$({ target: 'Array', proto: true }, {\n  copyWithin: copyWithin\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('copyWithin');\n","'use strict';\nvar toObject = require('../internals/to-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\nvar min = Math.min;\n\n// `Array.prototype.copyWithin` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.copywithin\n// eslint-disable-next-line es/no-array-prototype-copywithin -- safe\nmodule.exports = [].copyWithin || function copyWithin(target /* = 0 */, start /* = 0, end = @length */) {\n  var O = toObject(this);\n  var len = lengthOfArrayLike(O);\n  var to = toAbsoluteIndex(target, len);\n  var from = toAbsoluteIndex(start, len);\n  var end = arguments.length > 2 ? arguments[2] : undefined;\n  var count = min((end === undefined ? len : toAbsoluteIndex(end, len)) - from, len - to);\n  var inc = 1;\n  if (from < to && to < from + count) {\n    inc = -1;\n    from += count - 1;\n    to += count - 1;\n  }\n  while (count-- > 0) {\n    if (from in O) O[to] = O[from];\n    else delete O[to];\n    to += inc;\n    from += inc;\n  } return O;\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar create = require('../internals/object-create');\nvar definePropertyModule = require('../internals/object-define-property');\n\nvar UNSCOPABLES = wellKnownSymbol('unscopables');\nvar ArrayPrototype = Array.prototype;\n\n// Array.prototype[@@unscopables]\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\nif (ArrayPrototype[UNSCOPABLES] == undefined) {\n  definePropertyModule.f(ArrayPrototype, UNSCOPABLES, {\n    configurable: true,\n    value: create(null)\n  });\n}\n\n// add a key to Array.prototype[@@unscopables]\nmodule.exports = function (key) {\n  ArrayPrototype[UNSCOPABLES][key] = true;\n};\n","var $ = require('../internals/export');\nvar fill = require('../internals/array-fill');\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.fill` method\n// https://tc39.es/ecma262/#sec-array.prototype.fill\n$({ target: 'Array', proto: true }, {\n  fill: fill\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('fill');\n","'use strict';\nvar toObject = require('../internals/to-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\n// `Array.prototype.fill` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.fill\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = lengthOfArrayLike(O);\n  var argumentsLength = arguments.length;\n  var index = toAbsoluteIndex(argumentsLength > 1 ? arguments[1] : undefined, length);\n  var end = argumentsLength > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $filter = require('../internals/array-iteration').filter;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('filter');\n\n// `Array.prototype.filter` method\n// https://tc39.es/ecma262/#sec-array.prototype.filter\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    return $filter(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.es/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","'use strict';\nvar $ = require('../internals/export');\nvar $findIndex = require('../internals/array-iteration').findIndex;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\nvar FIND_INDEX = 'findIndex';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND_INDEX in []) Array(1)[FIND_INDEX](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.findIndex` method\n// https://tc39.es/ecma262/#sec-array.prototype.findindex\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $findIndex(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND_INDEX);\n","'use strict';\nvar $ = require('../internals/export');\nvar flattenIntoArray = require('../internals/flatten-into-array');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\n// `Array.prototype.flat` method\n// https://tc39.es/ecma262/#sec-array.prototype.flat\n$({ target: 'Array', proto: true }, {\n  flat: function flat(/* depthArg = 1 */) {\n    var depthArg = arguments.length ? arguments[0] : undefined;\n    var O = toObject(this);\n    var sourceLen = lengthOfArrayLike(O);\n    var A = arraySpeciesCreate(O, 0);\n    A.length = flattenIntoArray(A, O, O, sourceLen, 0, depthArg === undefined ? 1 : toIntegerOrInfinity(depthArg));\n    return A;\n  }\n});\n","'use strict';\nvar global = require('../internals/global');\nvar isArray = require('../internals/is-array');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar bind = require('../internals/function-bind-context');\n\nvar TypeError = global.TypeError;\n\n// `FlattenIntoArray` abstract operation\n// https://tc39.github.io/proposal-flatMap/#sec-FlattenIntoArray\nvar flattenIntoArray = function (target, original, source, sourceLen, start, depth, mapper, thisArg) {\n  var targetIndex = start;\n  var sourceIndex = 0;\n  var mapFn = mapper ? bind(mapper, thisArg) : false;\n  var element, elementLen;\n\n  while (sourceIndex < sourceLen) {\n    if (sourceIndex in source) {\n      element = mapFn ? mapFn(source[sourceIndex], sourceIndex, original) : source[sourceIndex];\n\n      if (depth > 0 && isArray(element)) {\n        elementLen = lengthOfArrayLike(element);\n        targetIndex = flattenIntoArray(target, original, element, elementLen, targetIndex, depth - 1) - 1;\n      } else {\n        if (targetIndex >= 0x1FFFFFFFFFFFFF) throw TypeError('Exceed the acceptable array length');\n        target[targetIndex] = element;\n      }\n\n      targetIndex++;\n    }\n    sourceIndex++;\n  }\n  return targetIndex;\n};\n\nmodule.exports = flattenIntoArray;\n","'use strict';\nvar $ = require('../internals/export');\nvar flattenIntoArray = require('../internals/flatten-into-array');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\n// `Array.prototype.flatMap` method\n// https://tc39.es/ecma262/#sec-array.prototype.flatmap\n$({ target: 'Array', proto: true }, {\n  flatMap: function flatMap(callbackfn /* , thisArg */) {\n    var O = toObject(this);\n    var sourceLen = lengthOfArrayLike(O);\n    var A;\n    aCallable(callbackfn);\n    A = arraySpeciesCreate(O, 0);\n    A.length = flattenIntoArray(A, O, O, sourceLen, 0, 1, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return A;\n  }\n});\n","var $ = require('../internals/export');\nvar from = require('../internals/array-from');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\n\nvar INCORRECT_ITERATION = !checkCorrectnessOfIteration(function (iterable) {\n  // eslint-disable-next-line es/no-array-from -- required for testing\n  Array.from(iterable);\n});\n\n// `Array.from` method\n// https://tc39.es/ecma262/#sec-array.from\n$({ target: 'Array', stat: true, forced: INCORRECT_ITERATION }, {\n  from: from\n});\n","'use strict';\nvar global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar toObject = require('../internals/to-object');\nvar callWithSafeIterationClosing = require('../internals/call-with-safe-iteration-closing');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar isConstructor = require('../internals/is-constructor');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar createProperty = require('../internals/create-property');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\nvar Array = global.Array;\n\n// `Array.from` method implementation\n// https://tc39.es/ecma262/#sec-array.from\nmodule.exports = function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n  var O = toObject(arrayLike);\n  var IS_CONSTRUCTOR = isConstructor(this);\n  var argumentsLength = arguments.length;\n  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;\n  var mapping = mapfn !== undefined;\n  if (mapping) mapfn = bind(mapfn, argumentsLength > 2 ? arguments[2] : undefined);\n  var iteratorMethod = getIteratorMethod(O);\n  var index = 0;\n  var length, result, step, iterator, next, value;\n  // if the target is not iterable or it's an array with the default iterator - use a simple case\n  if (iteratorMethod && !(this == Array && isArrayIteratorMethod(iteratorMethod))) {\n    iterator = getIterator(O, iteratorMethod);\n    next = iterator.next;\n    result = IS_CONSTRUCTOR ? new this() : [];\n    for (;!(step = call(next, iterator)).done; index++) {\n      value = mapping ? callWithSafeIterationClosing(iterator, mapfn, [step.value, index], true) : step.value;\n      createProperty(result, index, value);\n    }\n  } else {\n    length = lengthOfArrayLike(O);\n    result = IS_CONSTRUCTOR ? new this(length) : Array(length);\n    for (;length > index; index++) {\n      value = mapping ? mapfn(O[index], index) : O[index];\n      createProperty(result, index, value);\n    }\n  }\n  result.length = index;\n  return result;\n};\n","var anObject = require('../internals/an-object');\nvar iteratorClose = require('../internals/iterator-close');\n\n// call something on iterator step with safe closing on error\nmodule.exports = function (iterator, fn, value, ENTRIES) {\n  try {\n    return ENTRIES ? fn(anObject(value)[0], value[1]) : fn(value);\n  } catch (error) {\n    iteratorClose(iterator, 'throw', error);\n  }\n};\n","var call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar getMethod = require('../internals/get-method');\n\nmodule.exports = function (iterator, kind, value) {\n  var innerResult, innerError;\n  anObject(iterator);\n  try {\n    innerResult = getMethod(iterator, 'return');\n    if (!innerResult) {\n      if (kind === 'throw') throw value;\n      return value;\n    }\n    innerResult = call(innerResult, iterator);\n  } catch (error) {\n    innerError = true;\n    innerResult = error;\n  }\n  if (kind === 'throw') throw value;\n  if (innerError) throw innerResult;\n  anObject(innerResult);\n  return value;\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar Iterators = require('../internals/iterators');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar ArrayPrototype = Array.prototype;\n\n// check on default Array iterator\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayPrototype[ITERATOR] === it);\n};\n","module.exports = {};\n","var global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar tryToString = require('../internals/try-to-string');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\nvar TypeError = global.TypeError;\n\nmodule.exports = function (argument, usingIterator) {\n  var iteratorMethod = arguments.length < 2 ? getIteratorMethod(argument) : usingIterator;\n  if (aCallable(iteratorMethod)) return anObject(call(iteratorMethod, argument));\n  throw TypeError(tryToString(argument) + ' is not iterable');\n};\n","var classof = require('../internals/classof');\nvar getMethod = require('../internals/get-method');\nvar Iterators = require('../internals/iterators');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\n\nmodule.exports = function (it) {\n  if (it != undefined) return getMethod(it, ITERATOR)\n    || getMethod(it, '@@iterator')\n    || Iterators[classof(it)];\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var called = 0;\n  var iteratorWithReturn = {\n    next: function () {\n      return { done: !!called++ };\n    },\n    'return': function () {\n      SAFE_CLOSING = true;\n    }\n  };\n  iteratorWithReturn[ITERATOR] = function () {\n    return this;\n  };\n  // eslint-disable-next-line es/no-array-from, no-throw-literal -- required for testing\n  Array.from(iteratorWithReturn, function () { throw 2; });\n} catch (error) { /* empty */ }\n\nmodule.exports = function (exec, SKIP_CLOSING) {\n  if (!SKIP_CLOSING && !SAFE_CLOSING) return false;\n  var ITERATION_SUPPORT = false;\n  try {\n    var object = {};\n    object[ITERATOR] = function () {\n      return {\n        next: function () {\n          return { done: ITERATION_SUPPORT = true };\n        }\n      };\n    };\n    exec(object);\n  } catch (error) { /* empty */ }\n  return ITERATION_SUPPORT;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $includes = require('../internals/array-includes').includes;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.includes` method\n// https://tc39.es/ecma262/#sec-array.prototype.includes\n$({ target: 'Array', proto: true }, {\n  includes: function includes(el /* , fromIndex = 0 */) {\n    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('includes');\n","'use strict';\n/* eslint-disable es/no-array-prototype-indexof -- required for testing */\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar $IndexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar un$IndexOf = uncurryThis([].indexOf);\n\nvar NEGATIVE_ZERO = !!un$IndexOf && 1 / un$IndexOf([1], 1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\n\n// `Array.prototype.indexOf` method\n// https://tc39.es/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    var fromIndex = arguments.length > 1 ? arguments[1] : undefined;\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? un$IndexOf(this, searchElement, fromIndex) || 0\n      : $IndexOf(this, searchElement, fromIndex);\n  }\n});\n","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal -- required for testing\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n","'use strict';\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar Iterators = require('../internals/iterators');\nvar InternalStateModule = require('../internals/internal-state');\nvar defineProperty = require('../internals/object-define-property').f;\nvar defineIterator = require('../internals/define-iterator');\nvar IS_PURE = require('../internals/is-pure');\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar ARRAY_ITERATOR = 'Array Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(ARRAY_ITERATOR);\n\n// `Array.prototype.entries` method\n// https://tc39.es/ecma262/#sec-array.prototype.entries\n// `Array.prototype.keys` method\n// https://tc39.es/ecma262/#sec-array.prototype.keys\n// `Array.prototype.values` method\n// https://tc39.es/ecma262/#sec-array.prototype.values\n// `Array.prototype[@@iterator]` method\n// https://tc39.es/ecma262/#sec-array.prototype-@@iterator\n// `CreateArrayIterator` internal method\n// https://tc39.es/ecma262/#sec-createarrayiterator\nmodule.exports = defineIterator(Array, 'Array', function (iterated, kind) {\n  setInternalState(this, {\n    type: ARRAY_ITERATOR,\n    target: toIndexedObject(iterated), // target\n    index: 0,                          // next index\n    kind: kind                         // kind\n  });\n// `%ArrayIteratorPrototype%.next` method\n// https://tc39.es/ecma262/#sec-%arrayiteratorprototype%.next\n}, function () {\n  var state = getInternalState(this);\n  var target = state.target;\n  var kind = state.kind;\n  var index = state.index++;\n  if (!target || index >= target.length) {\n    state.target = undefined;\n    return { value: undefined, done: true };\n  }\n  if (kind == 'keys') return { value: index, done: false };\n  if (kind == 'values') return { value: target[index], done: false };\n  return { value: [index, target[index]], done: false };\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values%\n// https://tc39.es/ecma262/#sec-createunmappedargumentsobject\n// https://tc39.es/ecma262/#sec-createmappedargumentsobject\nvar values = Iterators.Arguments = Iterators.Array;\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n\n// V8 ~ Chrome 45- bug\nif (!IS_PURE && DESCRIPTORS && values.name !== 'values') try {\n  defineProperty(values, 'name', { value: 'values' });\n} catch (error) { /* empty */ }\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar IS_PURE = require('../internals/is-pure');\nvar FunctionName = require('../internals/function-name');\nvar isCallable = require('../internals/is-callable');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar Iterators = require('../internals/iterators');\nvar IteratorsCore = require('../internals/iterators-core');\n\nvar PROPER_FUNCTION_NAME = FunctionName.PROPER;\nvar CONFIGURABLE_FUNCTION_NAME = FunctionName.CONFIGURABLE;\nvar IteratorPrototype = IteratorsCore.IteratorPrototype;\nvar BUGGY_SAFARI_ITERATORS = IteratorsCore.BUGGY_SAFARI_ITERATORS;\nvar ITERATOR = wellKnownSymbol('iterator');\nvar KEYS = 'keys';\nvar VALUES = 'values';\nvar ENTRIES = 'entries';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Iterable, NAME, IteratorConstructor, next, DEFAULT, IS_SET, FORCED) {\n  createIteratorConstructor(IteratorConstructor, NAME, next);\n\n  var getIterationMethod = function (KIND) {\n    if (KIND === DEFAULT && defaultIterator) return defaultIterator;\n    if (!BUGGY_SAFARI_ITERATORS && KIND in IterablePrototype) return IterablePrototype[KIND];\n    switch (KIND) {\n      case KEYS: return function keys() { return new IteratorConstructor(this, KIND); };\n      case VALUES: return function values() { return new IteratorConstructor(this, KIND); };\n      case ENTRIES: return function entries() { return new IteratorConstructor(this, KIND); };\n    } return function () { return new IteratorConstructor(this); };\n  };\n\n  var TO_STRING_TAG = NAME + ' Iterator';\n  var INCORRECT_VALUES_NAME = false;\n  var IterablePrototype = Iterable.prototype;\n  var nativeIterator = IterablePrototype[ITERATOR]\n    || IterablePrototype['@@iterator']\n    || DEFAULT && IterablePrototype[DEFAULT];\n  var defaultIterator = !BUGGY_SAFARI_ITERATORS && nativeIterator || getIterationMethod(DEFAULT);\n  var anyNativeIterator = NAME == 'Array' ? IterablePrototype.entries || nativeIterator : nativeIterator;\n  var CurrentIteratorPrototype, methods, KEY;\n\n  // fix native\n  if (anyNativeIterator) {\n    CurrentIteratorPrototype = getPrototypeOf(anyNativeIterator.call(new Iterable()));\n    if (CurrentIteratorPrototype !== Object.prototype && CurrentIteratorPrototype.next) {\n      if (!IS_PURE && getPrototypeOf(CurrentIteratorPrototype) !== IteratorPrototype) {\n        if (setPrototypeOf) {\n          setPrototypeOf(CurrentIteratorPrototype, IteratorPrototype);\n        } else if (!isCallable(CurrentIteratorPrototype[ITERATOR])) {\n          redefine(CurrentIteratorPrototype, ITERATOR, returnThis);\n        }\n      }\n      // Set @@toStringTag to native iterators\n      setToStringTag(CurrentIteratorPrototype, TO_STRING_TAG, true, true);\n      if (IS_PURE) Iterators[TO_STRING_TAG] = returnThis;\n    }\n  }\n\n  // fix Array.prototype.{ values, @@iterator }.name in V8 / FF\n  if (PROPER_FUNCTION_NAME && DEFAULT == VALUES && nativeIterator && nativeIterator.name !== VALUES) {\n    if (!IS_PURE && CONFIGURABLE_FUNCTION_NAME) {\n      createNonEnumerableProperty(IterablePrototype, 'name', VALUES);\n    } else {\n      INCORRECT_VALUES_NAME = true;\n      defaultIterator = function values() { return call(nativeIterator, this); };\n    }\n  }\n\n  // export additional methods\n  if (DEFAULT) {\n    methods = {\n      values: getIterationMethod(VALUES),\n      keys: IS_SET ? defaultIterator : getIterationMethod(KEYS),\n      entries: getIterationMethod(ENTRIES)\n    };\n    if (FORCED) for (KEY in methods) {\n      if (BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME || !(KEY in IterablePrototype)) {\n        redefine(IterablePrototype, KEY, methods[KEY]);\n      }\n    } else $({ target: NAME, proto: true, forced: BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME }, methods);\n  }\n\n  // define iterator\n  if ((!IS_PURE || FORCED) && IterablePrototype[ITERATOR] !== defaultIterator) {\n    redefine(IterablePrototype, ITERATOR, defaultIterator, { name: DEFAULT });\n  }\n  Iterators[NAME] = defaultIterator;\n\n  return methods;\n};\n","'use strict';\nvar IteratorPrototype = require('../internals/iterators-core').IteratorPrototype;\nvar create = require('../internals/object-create');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar Iterators = require('../internals/iterators');\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (IteratorConstructor, NAME, next, ENUMERABLE_NEXT) {\n  var TO_STRING_TAG = NAME + ' Iterator';\n  IteratorConstructor.prototype = create(IteratorPrototype, { next: createPropertyDescriptor(+!ENUMERABLE_NEXT, next) });\n  setToStringTag(IteratorConstructor, TO_STRING_TAG, false, true);\n  Iterators[TO_STRING_TAG] = returnThis;\n  return IteratorConstructor;\n};\n","'use strict';\nvar fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\nvar create = require('../internals/object-create');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar redefine = require('../internals/redefine');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar BUGGY_SAFARI_ITERATORS = false;\n\n// `%IteratorPrototype%` object\n// https://tc39.es/ecma262/#sec-%iteratorprototype%-object\nvar IteratorPrototype, PrototypeOfArrayIteratorPrototype, arrayIterator;\n\n/* eslint-disable es/no-array-prototype-keys -- safe */\nif ([].keys) {\n  arrayIterator = [].keys();\n  // Safari 8 has buggy iterators w/o `next`\n  if (!('next' in arrayIterator)) BUGGY_SAFARI_ITERATORS = true;\n  else {\n    PrototypeOfArrayIteratorPrototype = getPrototypeOf(getPrototypeOf(arrayIterator));\n    if (PrototypeOfArrayIteratorPrototype !== Object.prototype) IteratorPrototype = PrototypeOfArrayIteratorPrototype;\n  }\n}\n\nvar NEW_ITERATOR_PROTOTYPE = IteratorPrototype == undefined || fails(function () {\n  var test = {};\n  // FF44- legacy iterators case\n  return IteratorPrototype[ITERATOR].call(test) !== test;\n});\n\nif (NEW_ITERATOR_PROTOTYPE) IteratorPrototype = {};\nelse if (IS_PURE) IteratorPrototype = create(IteratorPrototype);\n\n// `%IteratorPrototype%[@@iterator]()` method\n// https://tc39.es/ecma262/#sec-%iteratorprototype%-@@iterator\nif (!isCallable(IteratorPrototype[ITERATOR])) {\n  redefine(IteratorPrototype, ITERATOR, function () {\n    return this;\n  });\n}\n\nmodule.exports = {\n  IteratorPrototype: IteratorPrototype,\n  BUGGY_SAFARI_ITERATORS: BUGGY_SAFARI_ITERATORS\n};\n","var global = require('../internals/global');\nvar hasOwn = require('../internals/has-own-property');\nvar isCallable = require('../internals/is-callable');\nvar toObject = require('../internals/to-object');\nvar sharedKey = require('../internals/shared-key');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar IE_PROTO = sharedKey('IE_PROTO');\nvar Object = global.Object;\nvar ObjectPrototype = Object.prototype;\n\n// `Object.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.getprototypeof\nmodule.exports = CORRECT_PROTOTYPE_GETTER ? Object.getPrototypeOf : function (O) {\n  var object = toObject(O);\n  if (hasOwn(object, IE_PROTO)) return object[IE_PROTO];\n  var constructor = object.constructor;\n  if (isCallable(constructor) && object instanceof constructor) {\n    return constructor.prototype;\n  } return object instanceof Object ? ObjectPrototype : null;\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  function F() { /* empty */ }\n  F.prototype.constructor = null;\n  // eslint-disable-next-line es/no-object-getprototypeof -- required for testing\n  return Object.getPrototypeOf(new F()) !== F.prototype;\n});\n","/* eslint-disable no-proto -- safe */\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar anObject = require('../internals/an-object');\nvar aPossiblePrototype = require('../internals/a-possible-prototype');\n\n// `Object.setPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.setprototypeof\n// Works with __proto__ only. Old v8 can't work with null proto objects.\n// eslint-disable-next-line es/no-object-setprototypeof -- safe\nmodule.exports = Object.setPrototypeOf || ('__proto__' in {} ? function () {\n  var CORRECT_SETTER = false;\n  var test = {};\n  var setter;\n  try {\n    // eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\n    setter = uncurryThis(Object.getOwnPropertyDescriptor(Object.prototype, '__proto__').set);\n    setter(test, []);\n    CORRECT_SETTER = test instanceof Array;\n  } catch (error) { /* empty */ }\n  return function setPrototypeOf(O, proto) {\n    anObject(O);\n    aPossiblePrototype(proto);\n    if (CORRECT_SETTER) setter(O, proto);\n    else O.__proto__ = proto;\n    return O;\n  };\n}() : undefined);\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\n\nvar String = global.String;\nvar TypeError = global.TypeError;\n\nmodule.exports = function (argument) {\n  if (typeof argument == 'object' || isCallable(argument)) return argument;\n  throw TypeError(\"Can't set \" + String(argument) + ' as a prototype');\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar IndexedObject = require('../internals/indexed-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar un$Join = uncurryThis([].join);\n\nvar ES3_STRINGS = IndexedObject != Object;\nvar STRICT_METHOD = arrayMethodIsStrict('join', ',');\n\n// `Array.prototype.join` method\n// https://tc39.es/ecma262/#sec-array.prototype.join\n$({ target: 'Array', proto: true, forced: ES3_STRINGS || !STRICT_METHOD }, {\n  join: function join(separator) {\n    return un$Join(toIndexedObject(this), separator === undefined ? ',' : separator);\n  }\n});\n","var $ = require('../internals/export');\nvar lastIndexOf = require('../internals/array-last-index-of');\n\n// `Array.prototype.lastIndexOf` method\n// https://tc39.es/ecma262/#sec-array.prototype.lastindexof\n// eslint-disable-next-line es/no-array-prototype-lastindexof -- required for testing\n$({ target: 'Array', proto: true, forced: lastIndexOf !== [].lastIndexOf }, {\n  lastIndexOf: lastIndexOf\n});\n","'use strict';\n/* eslint-disable es/no-array-prototype-lastindexof -- safe */\nvar apply = require('../internals/function-apply');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar min = Math.min;\nvar $lastIndexOf = [].lastIndexOf;\nvar NEGATIVE_ZERO = !!$lastIndexOf && 1 / [1].lastIndexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('lastIndexOf');\nvar FORCED = NEGATIVE_ZERO || !STRICT_METHOD;\n\n// `Array.prototype.lastIndexOf` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.lastindexof\nmodule.exports = FORCED ? function lastIndexOf(searchElement /* , fromIndex = @[*-1] */) {\n  // convert -0 to +0\n  if (NEGATIVE_ZERO) return apply($lastIndexOf, this, arguments) || 0;\n  var O = toIndexedObject(this);\n  var length = lengthOfArrayLike(O);\n  var index = length - 1;\n  if (arguments.length > 1) index = min(index, toIntegerOrInfinity(arguments[1]));\n  if (index < 0) index = length + index;\n  for (;index >= 0; index--) if (index in O && O[index] === searchElement) return index || 0;\n  return -1;\n} : $lastIndexOf;\n","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar isConstructor = require('../internals/is-constructor');\nvar createProperty = require('../internals/create-property');\n\nvar Array = global.Array;\n\nvar ISNT_GENERIC = fails(function () {\n  function F() { /* empty */ }\n  return !(Array.of.call(F) instanceof F);\n});\n\n// `Array.of` method\n// https://tc39.es/ecma262/#sec-array.of\n// WebKit Array.of isn't generic\n$({ target: 'Array', stat: true, forced: ISNT_GENERIC }, {\n  of: function of(/* ...args */) {\n    var index = 0;\n    var argumentsLength = arguments.length;\n    var result = new (isConstructor(this) ? this : Array)(argumentsLength);\n    while (argumentsLength > index) createProperty(result, index, arguments[index++]);\n    result.length = argumentsLength;\n    return result;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $reduce = require('../internals/array-reduce').left;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar CHROME_VERSION = require('../internals/engine-v8-version');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar STRICT_METHOD = arrayMethodIsStrict('reduce');\n// Chrome 80-82 has a critical bug\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1049982\nvar CHROME_BUG = !IS_NODE && CHROME_VERSION > 79 && CHROME_VERSION < 83;\n\n// `Array.prototype.reduce` method\n// https://tc39.es/ecma262/#sec-array.prototype.reduce\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || CHROME_BUG }, {\n  reduce: function reduce(callbackfn /* , initialValue */) {\n    var length = arguments.length;\n    return $reduce(this, callbackfn, length, length > 1 ? arguments[1] : undefined);\n  }\n});\n","var global = require('../internals/global');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar IndexedObject = require('../internals/indexed-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\nvar TypeError = global.TypeError;\n\n// `Array.prototype.{ reduce, reduceRight }` methods implementation\nvar createMethod = function (IS_RIGHT) {\n  return function (that, callbackfn, argumentsLength, memo) {\n    aCallable(callbackfn);\n    var O = toObject(that);\n    var self = IndexedObject(O);\n    var length = lengthOfArrayLike(O);\n    var index = IS_RIGHT ? length - 1 : 0;\n    var i = IS_RIGHT ? -1 : 1;\n    if (argumentsLength < 2) while (true) {\n      if (index in self) {\n        memo = self[index];\n        index += i;\n        break;\n      }\n      index += i;\n      if (IS_RIGHT ? index < 0 : length <= index) {\n        throw TypeError('Reduce of empty array with no initial value');\n      }\n    }\n    for (;IS_RIGHT ? index >= 0 : length > index; index += i) if (index in self) {\n      memo = callbackfn(memo, self[index], index, O);\n    }\n    return memo;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.reduce` method\n  // https://tc39.es/ecma262/#sec-array.prototype.reduce\n  left: createMethod(false),\n  // `Array.prototype.reduceRight` method\n  // https://tc39.es/ecma262/#sec-array.prototype.reduceright\n  right: createMethod(true)\n};\n","var classof = require('../internals/classof-raw');\nvar global = require('../internals/global');\n\nmodule.exports = classof(global.process) == 'process';\n","'use strict';\nvar $ = require('../internals/export');\nvar $reduceRight = require('../internals/array-reduce').right;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar CHROME_VERSION = require('../internals/engine-v8-version');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar STRICT_METHOD = arrayMethodIsStrict('reduceRight');\n// Chrome 80-82 has a critical bug\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1049982\nvar CHROME_BUG = !IS_NODE && CHROME_VERSION > 79 && CHROME_VERSION < 83;\n\n// `Array.prototype.reduceRight` method\n// https://tc39.es/ecma262/#sec-array.prototype.reduceright\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || CHROME_BUG }, {\n  reduceRight: function reduceRight(callbackfn /* , initialValue */) {\n    return $reduceRight(this, callbackfn, arguments.length, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isArray = require('../internals/is-array');\n\nvar un$Reverse = uncurryThis([].reverse);\nvar test = [1, 2];\n\n// `Array.prototype.reverse` method\n// https://tc39.es/ecma262/#sec-array.prototype.reverse\n// fix for Safari 12.0 bug\n// https://bugs.webkit.org/show_bug.cgi?id=188794\n$({ target: 'Array', proto: true, forced: String(test) === String(test.reverse()) }, {\n  reverse: function reverse() {\n    // eslint-disable-next-line no-self-assign -- dirty hack\n    if (isArray(this)) this.length = this.length;\n    return un$Reverse(this);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar isArray = require('../internals/is-array');\nvar isConstructor = require('../internals/is-constructor');\nvar isObject = require('../internals/is-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar createProperty = require('../internals/create-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar un$Slice = require('../internals/array-slice');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('slice');\n\nvar SPECIES = wellKnownSymbol('species');\nvar Array = global.Array;\nvar max = Math.max;\n\n// `Array.prototype.slice` method\n// https://tc39.es/ecma262/#sec-array.prototype.slice\n// fallback for not array-like ES3 strings and DOM objects\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  slice: function slice(start, end) {\n    var O = toIndexedObject(this);\n    var length = lengthOfArrayLike(O);\n    var k = toAbsoluteIndex(start, length);\n    var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n    // inline `ArraySpeciesCreate` for usage native `Array#slice` where it's possible\n    var Constructor, result, n;\n    if (isArray(O)) {\n      Constructor = O.constructor;\n      // cross-realm fallback\n      if (isConstructor(Constructor) && (Constructor === Array || isArray(Constructor.prototype))) {\n        Constructor = undefined;\n      } else if (isObject(Constructor)) {\n        Constructor = Constructor[SPECIES];\n        if (Constructor === null) Constructor = undefined;\n      }\n      if (Constructor === Array || Constructor === undefined) {\n        return un$Slice(O, k, fin);\n      }\n    }\n    result = new (Constructor === undefined ? Array : Constructor)(max(fin - k, 0));\n    for (n = 0; k < fin; k++, n++) if (k in O) createProperty(result, n, O[k]);\n    result.length = n;\n    return result;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar internalSort = require('../internals/array-sort');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar FF = require('../internals/engine-ff-version');\nvar IE_OR_EDGE = require('../internals/engine-is-ie-or-edge');\nvar V8 = require('../internals/engine-v8-version');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\nvar test = [];\nvar un$Sort = uncurryThis(test.sort);\nvar push = uncurryThis(test.push);\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? un$Sort(array) : un$Sort(array, comparefn);\n\n    var items = [];\n    var arrayLength = lengthOfArrayLike(array);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) push(items, array[index]);\n    }\n\n    internalSort(items, getSortCompare(comparefn));\n\n    itemsLength = items.length;\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) delete array[index++];\n\n    return array;\n  }\n});\n","var arraySlice = require('../internals/array-slice-simple');\n\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    array,\n    mergeSort(arraySlice(array, 0, middle), comparefn),\n    mergeSort(arraySlice(array, middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (array, left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n\n  while (lindex < llength || rindex < rlength) {\n    array[lindex + rindex] = (lindex < llength && rindex < rlength)\n      ? comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]\n      : lindex < llength ? left[lindex++] : right[rindex++];\n  } return array;\n};\n\nmodule.exports = mergeSort;\n","var userAgent = require('../internals/engine-user-agent');\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n","var UA = require('../internals/engine-user-agent');\n\nmodule.exports = /MSIE|Trident/.test(UA);\n","var userAgent = require('../internals/engine-user-agent');\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n","var setSpecies = require('../internals/set-species');\n\n// `Array[@@species]` getter\n// https://tc39.es/ecma262/#sec-get-array-@@species\nsetSpecies('Array');\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\nvar definePropertyModule = require('../internals/object-define-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (CONSTRUCTOR_NAME) {\n  var Constructor = getBuiltIn(CONSTRUCTOR_NAME);\n  var defineProperty = definePropertyModule.f;\n\n  if (DESCRIPTORS && Constructor && !Constructor[SPECIES]) {\n    defineProperty(Constructor, SPECIES, {\n      configurable: true,\n      get: function () { return this; }\n    });\n  }\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toObject = require('../internals/to-object');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar createProperty = require('../internals/create-property');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('splice');\n\nvar TypeError = global.TypeError;\nvar max = Math.max;\nvar min = Math.min;\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_LENGTH_EXCEEDED = 'Maximum allowed length exceeded';\n\n// `Array.prototype.splice` method\n// https://tc39.es/ecma262/#sec-array.prototype.splice\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  splice: function splice(start, deleteCount /* , ...items */) {\n    var O = toObject(this);\n    var len = lengthOfArrayLike(O);\n    var actualStart = toAbsoluteIndex(start, len);\n    var argumentsLength = arguments.length;\n    var insertCount, actualDeleteCount, A, k, from, to;\n    if (argumentsLength === 0) {\n      insertCount = actualDeleteCount = 0;\n    } else if (argumentsLength === 1) {\n      insertCount = 0;\n      actualDeleteCount = len - actualStart;\n    } else {\n      insertCount = argumentsLength - 2;\n      actualDeleteCount = min(max(toIntegerOrInfinity(deleteCount), 0), len - actualStart);\n    }\n    if (len + insertCount - actualDeleteCount > MAX_SAFE_INTEGER) {\n      throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED);\n    }\n    A = arraySpeciesCreate(O, actualDeleteCount);\n    for (k = 0; k < actualDeleteCount; k++) {\n      from = actualStart + k;\n      if (from in O) createProperty(A, k, O[from]);\n    }\n    A.length = actualDeleteCount;\n    if (insertCount < actualDeleteCount) {\n      for (k = actualStart; k < len - actualDeleteCount; k++) {\n        from = k + actualDeleteCount;\n        to = k + insertCount;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n      for (k = len; k > len - actualDeleteCount + insertCount; k--) delete O[k - 1];\n    } else if (insertCount > actualDeleteCount) {\n      for (k = len - actualDeleteCount; k > actualStart; k--) {\n        from = k + actualDeleteCount - 1;\n        to = k + insertCount - 1;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n    }\n    for (k = 0; k < insertCount; k++) {\n      O[k + actualStart] = arguments[k + 2];\n    }\n    O.length = len - actualDeleteCount + insertCount;\n    return A;\n  }\n});\n","// this method was added to unscopables after implementation\n// in popular engines, so it's moved to a separate module\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('flat');\n","// this method was added to unscopables after implementation\n// in popular engines, so it's moved to a separate module\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('flatMap');\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar arrayBufferModule = require('../internals/array-buffer');\nvar setSpecies = require('../internals/set-species');\n\nvar ARRAY_BUFFER = 'ArrayBuffer';\nvar ArrayBuffer = arrayBufferModule[ARRAY_BUFFER];\nvar NativeArrayBuffer = global[ARRAY_BUFFER];\n\n// `ArrayBuffer` constructor\n// https://tc39.es/ecma262/#sec-arraybuffer-constructor\n$({ global: true, forced: NativeArrayBuffer !== ArrayBuffer }, {\n  ArrayBuffer: ArrayBuffer\n});\n\nsetSpecies(ARRAY_BUFFER);\n","'use strict';\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar NATIVE_ARRAY_BUFFER = require('../internals/array-buffer-native');\nvar FunctionName = require('../internals/function-name');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefineAll = require('../internals/redefine-all');\nvar fails = require('../internals/fails');\nvar anInstance = require('../internals/an-instance');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toLength = require('../internals/to-length');\nvar toIndex = require('../internals/to-index');\nvar IEEE754 = require('../internals/ieee754');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar defineProperty = require('../internals/object-define-property').f;\nvar arrayFill = require('../internals/array-fill');\nvar arraySlice = require('../internals/array-slice-simple');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar PROPER_FUNCTION_NAME = FunctionName.PROPER;\nvar CONFIGURABLE_FUNCTION_NAME = FunctionName.CONFIGURABLE;\nvar getInternalState = InternalStateModule.get;\nvar setInternalState = InternalStateModule.set;\nvar ARRAY_BUFFER = 'ArrayBuffer';\nvar DATA_VIEW = 'DataView';\nvar PROTOTYPE = 'prototype';\nvar WRONG_LENGTH = 'Wrong length';\nvar WRONG_INDEX = 'Wrong index';\nvar NativeArrayBuffer = global[ARRAY_BUFFER];\nvar $ArrayBuffer = NativeArrayBuffer;\nvar ArrayBufferPrototype = $ArrayBuffer && $ArrayBuffer[PROTOTYPE];\nvar $DataView = global[DATA_VIEW];\nvar DataViewPrototype = $DataView && $DataView[PROTOTYPE];\nvar ObjectPrototype = Object.prototype;\nvar Array = global.Array;\nvar RangeError = global.RangeError;\nvar fill = uncurryThis(arrayFill);\nvar reverse = uncurryThis([].reverse);\n\nvar packIEEE754 = IEEE754.pack;\nvar unpackIEEE754 = IEEE754.unpack;\n\nvar packInt8 = function (number) {\n  return [number & 0xFF];\n};\n\nvar packInt16 = function (number) {\n  return [number & 0xFF, number >> 8 & 0xFF];\n};\n\nvar packInt32 = function (number) {\n  return [number & 0xFF, number >> 8 & 0xFF, number >> 16 & 0xFF, number >> 24 & 0xFF];\n};\n\nvar unpackInt32 = function (buffer) {\n  return buffer[3] << 24 | buffer[2] << 16 | buffer[1] << 8 | buffer[0];\n};\n\nvar packFloat32 = function (number) {\n  return packIEEE754(number, 23, 4);\n};\n\nvar packFloat64 = function (number) {\n  return packIEEE754(number, 52, 8);\n};\n\nvar addGetter = function (Constructor, key) {\n  defineProperty(Constructor[PROTOTYPE], key, { get: function () { return getInternalState(this)[key]; } });\n};\n\nvar get = function (view, count, index, isLittleEndian) {\n  var intIndex = toIndex(index);\n  var store = getInternalState(view);\n  if (intIndex + count > store.byteLength) throw RangeError(WRONG_INDEX);\n  var bytes = getInternalState(store.buffer).bytes;\n  var start = intIndex + store.byteOffset;\n  var pack = arraySlice(bytes, start, start + count);\n  return isLittleEndian ? pack : reverse(pack);\n};\n\nvar set = function (view, count, index, conversion, value, isLittleEndian) {\n  var intIndex = toIndex(index);\n  var store = getInternalState(view);\n  if (intIndex + count > store.byteLength) throw RangeError(WRONG_INDEX);\n  var bytes = getInternalState(store.buffer).bytes;\n  var start = intIndex + store.byteOffset;\n  var pack = conversion(+value);\n  for (var i = 0; i < count; i++) bytes[start + i] = pack[isLittleEndian ? i : count - i - 1];\n};\n\nif (!NATIVE_ARRAY_BUFFER) {\n  $ArrayBuffer = function ArrayBuffer(length) {\n    anInstance(this, ArrayBufferPrototype);\n    var byteLength = toIndex(length);\n    setInternalState(this, {\n      bytes: fill(Array(byteLength), 0),\n      byteLength: byteLength\n    });\n    if (!DESCRIPTORS) this.byteLength = byteLength;\n  };\n\n  ArrayBufferPrototype = $ArrayBuffer[PROTOTYPE];\n\n  $DataView = function DataView(buffer, byteOffset, byteLength) {\n    anInstance(this, DataViewPrototype);\n    anInstance(buffer, ArrayBufferPrototype);\n    var bufferLength = getInternalState(buffer).byteLength;\n    var offset = toIntegerOrInfinity(byteOffset);\n    if (offset < 0 || offset > bufferLength) throw RangeError('Wrong offset');\n    byteLength = byteLength === undefined ? bufferLength - offset : toLength(byteLength);\n    if (offset + byteLength > bufferLength) throw RangeError(WRONG_LENGTH);\n    setInternalState(this, {\n      buffer: buffer,\n      byteLength: byteLength,\n      byteOffset: offset\n    });\n    if (!DESCRIPTORS) {\n      this.buffer = buffer;\n      this.byteLength = byteLength;\n      this.byteOffset = offset;\n    }\n  };\n\n  DataViewPrototype = $DataView[PROTOTYPE];\n\n  if (DESCRIPTORS) {\n    addGetter($ArrayBuffer, 'byteLength');\n    addGetter($DataView, 'buffer');\n    addGetter($DataView, 'byteLength');\n    addGetter($DataView, 'byteOffset');\n  }\n\n  redefineAll(DataViewPrototype, {\n    getInt8: function getInt8(byteOffset) {\n      return get(this, 1, byteOffset)[0] << 24 >> 24;\n    },\n    getUint8: function getUint8(byteOffset) {\n      return get(this, 1, byteOffset)[0];\n    },\n    getInt16: function getInt16(byteOffset /* , littleEndian */) {\n      var bytes = get(this, 2, byteOffset, arguments.length > 1 ? arguments[1] : undefined);\n      return (bytes[1] << 8 | bytes[0]) << 16 >> 16;\n    },\n    getUint16: function getUint16(byteOffset /* , littleEndian */) {\n      var bytes = get(this, 2, byteOffset, arguments.length > 1 ? arguments[1] : undefined);\n      return bytes[1] << 8 | bytes[0];\n    },\n    getInt32: function getInt32(byteOffset /* , littleEndian */) {\n      return unpackInt32(get(this, 4, byteOffset, arguments.length > 1 ? arguments[1] : undefined));\n    },\n    getUint32: function getUint32(byteOffset /* , littleEndian */) {\n      return unpackInt32(get(this, 4, byteOffset, arguments.length > 1 ? arguments[1] : undefined)) >>> 0;\n    },\n    getFloat32: function getFloat32(byteOffset /* , littleEndian */) {\n      return unpackIEEE754(get(this, 4, byteOffset, arguments.length > 1 ? arguments[1] : undefined), 23);\n    },\n    getFloat64: function getFloat64(byteOffset /* , littleEndian */) {\n      return unpackIEEE754(get(this, 8, byteOffset, arguments.length > 1 ? arguments[1] : undefined), 52);\n    },\n    setInt8: function setInt8(byteOffset, value) {\n      set(this, 1, byteOffset, packInt8, value);\n    },\n    setUint8: function setUint8(byteOffset, value) {\n      set(this, 1, byteOffset, packInt8, value);\n    },\n    setInt16: function setInt16(byteOffset, value /* , littleEndian */) {\n      set(this, 2, byteOffset, packInt16, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setUint16: function setUint16(byteOffset, value /* , littleEndian */) {\n      set(this, 2, byteOffset, packInt16, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setInt32: function setInt32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packInt32, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setUint32: function setUint32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packInt32, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setFloat32: function setFloat32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packFloat32, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setFloat64: function setFloat64(byteOffset, value /* , littleEndian */) {\n      set(this, 8, byteOffset, packFloat64, value, arguments.length > 2 ? arguments[2] : undefined);\n    }\n  });\n} else {\n  var INCORRECT_ARRAY_BUFFER_NAME = PROPER_FUNCTION_NAME && NativeArrayBuffer.name !== ARRAY_BUFFER;\n  /* eslint-disable no-new -- required for testing */\n  if (!fails(function () {\n    NativeArrayBuffer(1);\n  }) || !fails(function () {\n    new NativeArrayBuffer(-1);\n  }) || fails(function () {\n    new NativeArrayBuffer();\n    new NativeArrayBuffer(1.5);\n    new NativeArrayBuffer(NaN);\n    return INCORRECT_ARRAY_BUFFER_NAME && !CONFIGURABLE_FUNCTION_NAME;\n  })) {\n  /* eslint-enable no-new -- required for testing */\n    $ArrayBuffer = function ArrayBuffer(length) {\n      anInstance(this, ArrayBufferPrototype);\n      return new NativeArrayBuffer(toIndex(length));\n    };\n\n    $ArrayBuffer[PROTOTYPE] = ArrayBufferPrototype;\n\n    for (var keys = getOwnPropertyNames(NativeArrayBuffer), j = 0, key; keys.length > j;) {\n      if (!((key = keys[j++]) in $ArrayBuffer)) {\n        createNonEnumerableProperty($ArrayBuffer, key, NativeArrayBuffer[key]);\n      }\n    }\n\n    ArrayBufferPrototype.constructor = $ArrayBuffer;\n  } else if (INCORRECT_ARRAY_BUFFER_NAME && CONFIGURABLE_FUNCTION_NAME) {\n    createNonEnumerableProperty(NativeArrayBuffer, 'name', ARRAY_BUFFER);\n  }\n\n  // WebKit bug - the same parent prototype for typed arrays and data view\n  if (setPrototypeOf && getPrototypeOf(DataViewPrototype) !== ObjectPrototype) {\n    setPrototypeOf(DataViewPrototype, ObjectPrototype);\n  }\n\n  // iOS Safari 7.x bug\n  var testView = new $DataView(new $ArrayBuffer(2));\n  var $setInt8 = uncurryThis(DataViewPrototype.setInt8);\n  testView.setInt8(0, 2147483648);\n  testView.setInt8(1, 2147483649);\n  if (testView.getInt8(0) || !testView.getInt8(1)) redefineAll(DataViewPrototype, {\n    setInt8: function setInt8(byteOffset, value) {\n      $setInt8(this, byteOffset, value << 24 >> 24);\n    },\n    setUint8: function setUint8(byteOffset, value) {\n      $setInt8(this, byteOffset, value << 24 >> 24);\n    }\n  }, { unsafe: true });\n}\n\nsetToStringTag($ArrayBuffer, ARRAY_BUFFER);\nsetToStringTag($DataView, DATA_VIEW);\n\nmodule.exports = {\n  ArrayBuffer: $ArrayBuffer,\n  DataView: $DataView\n};\n","// eslint-disable-next-line es/no-typed-arrays -- safe\nmodule.exports = typeof ArrayBuffer != 'undefined' && typeof DataView != 'undefined';\n","var redefine = require('../internals/redefine');\n\nmodule.exports = function (target, src, options) {\n  for (var key in src) redefine(target, key, src[key], options);\n  return target;\n};\n","var global = require('../internals/global');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\n\nvar TypeError = global.TypeError;\n\nmodule.exports = function (it, Prototype) {\n  if (isPrototypeOf(Prototype, it)) return it;\n  throw TypeError('Incorrect invocation');\n};\n","var global = require('../internals/global');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toLength = require('../internals/to-length');\n\nvar RangeError = global.RangeError;\n\n// `ToIndex` abstract operation\n// https://tc39.es/ecma262/#sec-toindex\nmodule.exports = function (it) {\n  if (it === undefined) return 0;\n  var number = toIntegerOrInfinity(it);\n  var length = toLength(number);\n  if (number !== length) throw RangeError('Wrong length or index');\n  return length;\n};\n","// IEEE754 conversions based on https://github.com/feross/ieee754\nvar global = require('../internals/global');\n\nvar Array = global.Array;\nvar abs = Math.abs;\nvar pow = Math.pow;\nvar floor = Math.floor;\nvar log = Math.log;\nvar LN2 = Math.LN2;\n\nvar pack = function (number, mantissaLength, bytes) {\n  var buffer = Array(bytes);\n  var exponentLength = bytes * 8 - mantissaLength - 1;\n  var eMax = (1 << exponentLength) - 1;\n  var eBias = eMax >> 1;\n  var rt = mantissaLength === 23 ? pow(2, -24) - pow(2, -77) : 0;\n  var sign = number < 0 || number === 0 && 1 / number < 0 ? 1 : 0;\n  var index = 0;\n  var exponent, mantissa, c;\n  number = abs(number);\n  // eslint-disable-next-line no-self-compare -- NaN check\n  if (number != number || number === Infinity) {\n    // eslint-disable-next-line no-self-compare -- NaN check\n    mantissa = number != number ? 1 : 0;\n    exponent = eMax;\n  } else {\n    exponent = floor(log(number) / LN2);\n    c = pow(2, -exponent);\n    if (number * c < 1) {\n      exponent--;\n      c *= 2;\n    }\n    if (exponent + eBias >= 1) {\n      number += rt / c;\n    } else {\n      number += rt * pow(2, 1 - eBias);\n    }\n    if (number * c >= 2) {\n      exponent++;\n      c /= 2;\n    }\n    if (exponent + eBias >= eMax) {\n      mantissa = 0;\n      exponent = eMax;\n    } else if (exponent + eBias >= 1) {\n      mantissa = (number * c - 1) * pow(2, mantissaLength);\n      exponent = exponent + eBias;\n    } else {\n      mantissa = number * pow(2, eBias - 1) * pow(2, mantissaLength);\n      exponent = 0;\n    }\n  }\n  while (mantissaLength >= 8) {\n    buffer[index++] = mantissa & 255;\n    mantissa /= 256;\n    mantissaLength -= 8;\n  }\n  exponent = exponent << mantissaLength | mantissa;\n  exponentLength += mantissaLength;\n  while (exponentLength > 0) {\n    buffer[index++] = exponent & 255;\n    exponent /= 256;\n    exponentLength -= 8;\n  }\n  buffer[--index] |= sign * 128;\n  return buffer;\n};\n\nvar unpack = function (buffer, mantissaLength) {\n  var bytes = buffer.length;\n  var exponentLength = bytes * 8 - mantissaLength - 1;\n  var eMax = (1 << exponentLength) - 1;\n  var eBias = eMax >> 1;\n  var nBits = exponentLength - 7;\n  var index = bytes - 1;\n  var sign = buffer[index--];\n  var exponent = sign & 127;\n  var mantissa;\n  sign >>= 7;\n  while (nBits > 0) {\n    exponent = exponent * 256 + buffer[index--];\n    nBits -= 8;\n  }\n  mantissa = exponent & (1 << -nBits) - 1;\n  exponent >>= -nBits;\n  nBits += mantissaLength;\n  while (nBits > 0) {\n    mantissa = mantissa * 256 + buffer[index--];\n    nBits -= 8;\n  }\n  if (exponent === 0) {\n    exponent = 1 - eBias;\n  } else if (exponent === eMax) {\n    return mantissa ? NaN : sign ? -Infinity : Infinity;\n  } else {\n    mantissa = mantissa + pow(2, mantissaLength);\n    exponent = exponent - eBias;\n  } return (sign ? -1 : 1) * mantissa * pow(2, exponent - mantissaLength);\n};\n\nmodule.exports = {\n  pack: pack,\n  unpack: unpack\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar ArrayBufferModule = require('../internals/array-buffer');\nvar anObject = require('../internals/an-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toLength = require('../internals/to-length');\nvar speciesConstructor = require('../internals/species-constructor');\n\nvar ArrayBuffer = ArrayBufferModule.ArrayBuffer;\nvar DataView = ArrayBufferModule.DataView;\nvar DataViewPrototype = DataView.prototype;\nvar un$ArrayBufferSlice = uncurryThis(ArrayBuffer.prototype.slice);\nvar getUint8 = uncurryThis(DataViewPrototype.getUint8);\nvar setUint8 = uncurryThis(DataViewPrototype.setUint8);\n\nvar INCORRECT_SLICE = fails(function () {\n  return !new ArrayBuffer(2).slice(1, undefined).byteLength;\n});\n\n// `ArrayBuffer.prototype.slice` method\n// https://tc39.es/ecma262/#sec-arraybuffer.prototype.slice\n$({ target: 'ArrayBuffer', proto: true, unsafe: true, forced: INCORRECT_SLICE }, {\n  slice: function slice(start, end) {\n    if (un$ArrayBufferSlice && end === undefined) {\n      return un$ArrayBufferSlice(anObject(this), start); // FF fix\n    }\n    var length = anObject(this).byteLength;\n    var first = toAbsoluteIndex(start, length);\n    var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n    var result = new (speciesConstructor(this, ArrayBuffer))(toLength(fin - first));\n    var viewSource = new DataView(this);\n    var viewTarget = new DataView(result);\n    var index = 0;\n    while (first < fin) {\n      setUint8(viewTarget, index++, getUint8(viewSource, first++));\n    } return result;\n  }\n});\n","var anObject = require('../internals/an-object');\nvar aConstructor = require('../internals/a-constructor');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `SpeciesConstructor` abstract operation\n// https://tc39.es/ecma262/#sec-speciesconstructor\nmodule.exports = function (O, defaultConstructor) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? defaultConstructor : aConstructor(S);\n};\n","var global = require('../internals/global');\nvar isConstructor = require('../internals/is-constructor');\nvar tryToString = require('../internals/try-to-string');\n\nvar TypeError = global.TypeError;\n\n// `Assert: IsConstructor(argument) is true`\nmodule.exports = function (argument) {\n  if (isConstructor(argument)) return argument;\n  throw TypeError(tryToString(argument) + ' is not a constructor');\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toObject = require('../internals/to-object');\nvar toPrimitive = require('../internals/to-primitive');\n\nvar FORCED = fails(function () {\n  return new Date(NaN).toJSON() !== null\n    || Date.prototype.toJSON.call({ toISOString: function () { return 1; } }) !== 1;\n});\n\n// `Date.prototype.toJSON` method\n// https://tc39.es/ecma262/#sec-date.prototype.tojson\n$({ target: 'Date', proto: true, forced: FORCED }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  toJSON: function toJSON(key) {\n    var O = toObject(this);\n    var pv = toPrimitive(O, 'number');\n    return typeof pv == 'number' && !isFinite(pv) ? null : O.toISOString();\n  }\n});\n","var hasOwn = require('../internals/has-own-property');\nvar redefine = require('../internals/redefine');\nvar dateToPrimitive = require('../internals/date-to-primitive');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\nvar DatePrototype = Date.prototype;\n\n// `Date.prototype[@@toPrimitive]` method\n// https://tc39.es/ecma262/#sec-date.prototype-@@toprimitive\nif (!hasOwn(DatePrototype, TO_PRIMITIVE)) {\n  redefine(DatePrototype, TO_PRIMITIVE, dateToPrimitive);\n}\n","'use strict';\nvar global = require('../internals/global');\nvar anObject = require('../internals/an-object');\nvar ordinaryToPrimitive = require('../internals/ordinary-to-primitive');\n\nvar TypeError = global.TypeError;\n\n// `Date.prototype[@@toPrimitive](hint)` method implementation\n// https://tc39.es/ecma262/#sec-date.prototype-@@toprimitive\nmodule.exports = function (hint) {\n  anObject(this);\n  if (hint === 'string' || hint === 'default') hint = 'string';\n  else if (hint !== 'number') throw TypeError('Incorrect hint');\n  return ordinaryToPrimitive(this, hint);\n};\n","'use strict';\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar definePropertyModule = require('../internals/object-define-property');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar HAS_INSTANCE = wellKnownSymbol('hasInstance');\nvar FunctionPrototype = Function.prototype;\n\n// `Function.prototype[@@hasInstance]` method\n// https://tc39.es/ecma262/#sec-function.prototype-@@hasinstance\nif (!(HAS_INSTANCE in FunctionPrototype)) {\n  definePropertyModule.f(FunctionPrototype, HAS_INSTANCE, { value: function (O) {\n    if (!isCallable(this) || !isObject(O)) return false;\n    var P = this.prototype;\n    if (!isObject(P)) return O instanceof this;\n    // for environment w/o native `@@hasInstance` logic enough `instanceof`, but add this:\n    while (O = getPrototypeOf(O)) if (P === O) return true;\n    return false;\n  } });\n}\n","var DESCRIPTORS = require('../internals/descriptors');\nvar FUNCTION_NAME_EXISTS = require('../internals/function-name').EXISTS;\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar FunctionPrototype = Function.prototype;\nvar functionToString = uncurryThis(FunctionPrototype.toString);\nvar nameRE = /function\\b(?:\\s|\\/\\*[\\S\\s]*?\\*\\/|\\/\\/[^\\n\\r]*[\\n\\r]+)*([^\\s(/]*)/;\nvar regExpExec = uncurryThis(nameRE.exec);\nvar NAME = 'name';\n\n// Function instances `.name` property\n// https://tc39.es/ecma262/#sec-function-instances-name\nif (DESCRIPTORS && !FUNCTION_NAME_EXISTS) {\n  defineProperty(FunctionPrototype, NAME, {\n    configurable: true,\n    get: function () {\n      try {\n        return regExpExec(nameRE, functionToString(this))[1];\n      } catch (error) {\n        return '';\n      }\n    }\n  });\n}\n","var global = require('../internals/global');\nvar setToStringTag = require('../internals/set-to-string-tag');\n\n// JSON[@@toStringTag] property\n// https://tc39.es/ecma262/#sec-json-@@tostringtag\nsetToStringTag(global.JSON, 'JSON', true);\n","'use strict';\nvar collection = require('../internals/collection');\nvar collectionStrong = require('../internals/collection-strong');\n\n// `Map` constructor\n// https://tc39.es/ecma262/#sec-map-objects\ncollection('Map', function (init) {\n  return function Map() { return init(this, arguments.length ? arguments[0] : undefined); };\n}, collectionStrong);\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isForced = require('../internals/is-forced');\nvar redefine = require('../internals/redefine');\nvar InternalMetadataModule = require('../internals/internal-metadata');\nvar iterate = require('../internals/iterate');\nvar anInstance = require('../internals/an-instance');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar fails = require('../internals/fails');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar inheritIfRequired = require('../internals/inherit-if-required');\n\nmodule.exports = function (CONSTRUCTOR_NAME, wrapper, common) {\n  var IS_MAP = CONSTRUCTOR_NAME.indexOf('Map') !== -1;\n  var IS_WEAK = CONSTRUCTOR_NAME.indexOf('Weak') !== -1;\n  var ADDER = IS_MAP ? 'set' : 'add';\n  var NativeConstructor = global[CONSTRUCTOR_NAME];\n  var NativePrototype = NativeConstructor && NativeConstructor.prototype;\n  var Constructor = NativeConstructor;\n  var exported = {};\n\n  var fixMethod = function (KEY) {\n    var uncurriedNativeMethod = uncurryThis(NativePrototype[KEY]);\n    redefine(NativePrototype, KEY,\n      KEY == 'add' ? function add(value) {\n        uncurriedNativeMethod(this, value === 0 ? 0 : value);\n        return this;\n      } : KEY == 'delete' ? function (key) {\n        return IS_WEAK && !isObject(key) ? false : uncurriedNativeMethod(this, key === 0 ? 0 : key);\n      } : KEY == 'get' ? function get(key) {\n        return IS_WEAK && !isObject(key) ? undefined : uncurriedNativeMethod(this, key === 0 ? 0 : key);\n      } : KEY == 'has' ? function has(key) {\n        return IS_WEAK && !isObject(key) ? false : uncurriedNativeMethod(this, key === 0 ? 0 : key);\n      } : function set(key, value) {\n        uncurriedNativeMethod(this, key === 0 ? 0 : key, value);\n        return this;\n      }\n    );\n  };\n\n  var REPLACE = isForced(\n    CONSTRUCTOR_NAME,\n    !isCallable(NativeConstructor) || !(IS_WEAK || NativePrototype.forEach && !fails(function () {\n      new NativeConstructor().entries().next();\n    }))\n  );\n\n  if (REPLACE) {\n    // create collection constructor\n    Constructor = common.getConstructor(wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER);\n    InternalMetadataModule.enable();\n  } else if (isForced(CONSTRUCTOR_NAME, true)) {\n    var instance = new Constructor();\n    // early implementations not supports chaining\n    var HASNT_CHAINING = instance[ADDER](IS_WEAK ? {} : -0, 1) != instance;\n    // V8 ~ Chromium 40- weak-collections throws on primitives, but should return false\n    var THROWS_ON_PRIMITIVES = fails(function () { instance.has(1); });\n    // most early implementations doesn't supports iterables, most modern - not close it correctly\n    // eslint-disable-next-line no-new -- required for testing\n    var ACCEPT_ITERABLES = checkCorrectnessOfIteration(function (iterable) { new NativeConstructor(iterable); });\n    // for early implementations -0 and +0 not the same\n    var BUGGY_ZERO = !IS_WEAK && fails(function () {\n      // V8 ~ Chromium 42- fails only with 5+ elements\n      var $instance = new NativeConstructor();\n      var index = 5;\n      while (index--) $instance[ADDER](index, index);\n      return !$instance.has(-0);\n    });\n\n    if (!ACCEPT_ITERABLES) {\n      Constructor = wrapper(function (dummy, iterable) {\n        anInstance(dummy, NativePrototype);\n        var that = inheritIfRequired(new NativeConstructor(), dummy, Constructor);\n        if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n        return that;\n      });\n      Constructor.prototype = NativePrototype;\n      NativePrototype.constructor = Constructor;\n    }\n\n    if (THROWS_ON_PRIMITIVES || BUGGY_ZERO) {\n      fixMethod('delete');\n      fixMethod('has');\n      IS_MAP && fixMethod('get');\n    }\n\n    if (BUGGY_ZERO || HASNT_CHAINING) fixMethod(ADDER);\n\n    // weak collections should not contains .clear method\n    if (IS_WEAK && NativePrototype.clear) delete NativePrototype.clear;\n  }\n\n  exported[CONSTRUCTOR_NAME] = Constructor;\n  $({ global: true, forced: Constructor != NativeConstructor }, exported);\n\n  setToStringTag(Constructor, CONSTRUCTOR_NAME);\n\n  if (!IS_WEAK) common.setStrong(Constructor, CONSTRUCTOR_NAME, IS_MAP);\n\n  return Constructor;\n};\n","var $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar isObject = require('../internals/is-object');\nvar hasOwn = require('../internals/has-own-property');\nvar defineProperty = require('../internals/object-define-property').f;\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertyNamesExternalModule = require('../internals/object-get-own-property-names-external');\nvar isExtensible = require('../internals/object-is-extensible');\nvar uid = require('../internals/uid');\nvar FREEZING = require('../internals/freezing');\n\nvar REQUIRED = false;\nvar METADATA = uid('meta');\nvar id = 0;\n\nvar setMetadata = function (it) {\n  defineProperty(it, METADATA, { value: {\n    objectID: 'O' + id++, // object ID\n    weakData: {}          // weak collections IDs\n  } });\n};\n\nvar fastKey = function (it, create) {\n  // return a primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!hasOwn(it, METADATA)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMetadata(it);\n  // return object ID\n  } return it[METADATA].objectID;\n};\n\nvar getWeakData = function (it, create) {\n  if (!hasOwn(it, METADATA)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMetadata(it);\n  // return the store of weak collections IDs\n  } return it[METADATA].weakData;\n};\n\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZING && REQUIRED && isExtensible(it) && !hasOwn(it, METADATA)) setMetadata(it);\n  return it;\n};\n\nvar enable = function () {\n  meta.enable = function () { /* empty */ };\n  REQUIRED = true;\n  var getOwnPropertyNames = getOwnPropertyNamesModule.f;\n  var splice = uncurryThis([].splice);\n  var test = {};\n  test[METADATA] = 1;\n\n  // prevent exposing of metadata key\n  if (getOwnPropertyNames(test).length) {\n    getOwnPropertyNamesModule.f = function (it) {\n      var result = getOwnPropertyNames(it);\n      for (var i = 0, length = result.length; i < length; i++) {\n        if (result[i] === METADATA) {\n          splice(result, i, 1);\n          break;\n        }\n      } return result;\n    };\n\n    $({ target: 'Object', stat: true, forced: true }, {\n      getOwnPropertyNames: getOwnPropertyNamesExternalModule.f\n    });\n  }\n};\n\nvar meta = module.exports = {\n  enable: enable,\n  fastKey: fastKey,\n  getWeakData: getWeakData,\n  onFreeze: onFreeze\n};\n\nhiddenKeys[METADATA] = true;\n","var fails = require('../internals/fails');\nvar isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar ARRAY_BUFFER_NON_EXTENSIBLE = require('../internals/array-buffer-non-extensible');\n\n// eslint-disable-next-line es/no-object-isextensible -- safe\nvar $isExtensible = Object.isExtensible;\nvar FAILS_ON_PRIMITIVES = fails(function () { $isExtensible(1); });\n\n// `Object.isExtensible` method\n// https://tc39.es/ecma262/#sec-object.isextensible\nmodule.exports = (FAILS_ON_PRIMITIVES || ARRAY_BUFFER_NON_EXTENSIBLE) ? function isExtensible(it) {\n  if (!isObject(it)) return false;\n  if (ARRAY_BUFFER_NON_EXTENSIBLE && classof(it) == 'ArrayBuffer') return false;\n  return $isExtensible ? $isExtensible(it) : true;\n} : $isExtensible;\n","// FF26- bug: ArrayBuffers are non-extensible, but Object.isExtensible does not report it\nvar fails = require('../internals/fails');\n\nmodule.exports = fails(function () {\n  if (typeof ArrayBuffer == 'function') {\n    var buffer = new ArrayBuffer(8);\n    // eslint-disable-next-line es/no-object-isextensible, es/no-object-defineproperty -- safe\n    if (Object.isExtensible(buffer)) Object.defineProperty(buffer, 'a', { value: 8 });\n  }\n});\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-isextensible, es/no-object-preventextensions -- required for testing\n  return Object.isExtensible(Object.preventExtensions({}));\n});\n","var global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar tryToString = require('../internals/try-to-string');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar iteratorClose = require('../internals/iterator-close');\n\nvar TypeError = global.TypeError;\n\nvar Result = function (stopped, result) {\n  this.stopped = stopped;\n  this.result = result;\n};\n\nvar ResultPrototype = Result.prototype;\n\nmodule.exports = function (iterable, unboundFunction, options) {\n  var that = options && options.that;\n  var AS_ENTRIES = !!(options && options.AS_ENTRIES);\n  var IS_ITERATOR = !!(options && options.IS_ITERATOR);\n  var INTERRUPTED = !!(options && options.INTERRUPTED);\n  var fn = bind(unboundFunction, that);\n  var iterator, iterFn, index, length, result, next, step;\n\n  var stop = function (condition) {\n    if (iterator) iteratorClose(iterator, 'normal', condition);\n    return new Result(true, condition);\n  };\n\n  var callFn = function (value) {\n    if (AS_ENTRIES) {\n      anObject(value);\n      return INTERRUPTED ? fn(value[0], value[1], stop) : fn(value[0], value[1]);\n    } return INTERRUPTED ? fn(value, stop) : fn(value);\n  };\n\n  if (IS_ITERATOR) {\n    iterator = iterable;\n  } else {\n    iterFn = getIteratorMethod(iterable);\n    if (!iterFn) throw TypeError(tryToString(iterable) + ' is not iterable');\n    // optimisation for array iterators\n    if (isArrayIteratorMethod(iterFn)) {\n      for (index = 0, length = lengthOfArrayLike(iterable); length > index; index++) {\n        result = callFn(iterable[index]);\n        if (result && isPrototypeOf(ResultPrototype, result)) return result;\n      } return new Result(false);\n    }\n    iterator = getIterator(iterable, iterFn);\n  }\n\n  next = iterator.next;\n  while (!(step = call(next, iterator)).done) {\n    try {\n      result = callFn(step.value);\n    } catch (error) {\n      iteratorClose(iterator, 'throw', error);\n    }\n    if (typeof result == 'object' && result && isPrototypeOf(ResultPrototype, result)) return result;\n  } return new Result(false);\n};\n","var isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\n\n// makes subclassing work correct for wrapped built-ins\nmodule.exports = function ($this, dummy, Wrapper) {\n  var NewTarget, NewTargetPrototype;\n  if (\n    // it can work only with native `setPrototypeOf`\n    setPrototypeOf &&\n    // we haven't completely correct pre-ES6 way for getting `new.target`, so use this\n    isCallable(NewTarget = dummy.constructor) &&\n    NewTarget !== Wrapper &&\n    isObject(NewTargetPrototype = NewTarget.prototype) &&\n    NewTargetPrototype !== Wrapper.prototype\n  ) setPrototypeOf($this, NewTargetPrototype);\n  return $this;\n};\n","'use strict';\nvar defineProperty = require('../internals/object-define-property').f;\nvar create = require('../internals/object-create');\nvar redefineAll = require('../internals/redefine-all');\nvar bind = require('../internals/function-bind-context');\nvar anInstance = require('../internals/an-instance');\nvar iterate = require('../internals/iterate');\nvar defineIterator = require('../internals/define-iterator');\nvar setSpecies = require('../internals/set-species');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar fastKey = require('../internals/internal-metadata').fastKey;\nvar InternalStateModule = require('../internals/internal-state');\n\nvar setInternalState = InternalStateModule.set;\nvar internalStateGetterFor = InternalStateModule.getterFor;\n\nmodule.exports = {\n  getConstructor: function (wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER) {\n    var Constructor = wrapper(function (that, iterable) {\n      anInstance(that, Prototype);\n      setInternalState(that, {\n        type: CONSTRUCTOR_NAME,\n        index: create(null),\n        first: undefined,\n        last: undefined,\n        size: 0\n      });\n      if (!DESCRIPTORS) that.size = 0;\n      if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n    });\n\n    var Prototype = Constructor.prototype;\n\n    var getInternalState = internalStateGetterFor(CONSTRUCTOR_NAME);\n\n    var define = function (that, key, value) {\n      var state = getInternalState(that);\n      var entry = getEntry(that, key);\n      var previous, index;\n      // change existing entry\n      if (entry) {\n        entry.value = value;\n      // create new entry\n      } else {\n        state.last = entry = {\n          index: index = fastKey(key, true),\n          key: key,\n          value: value,\n          previous: previous = state.last,\n          next: undefined,\n          removed: false\n        };\n        if (!state.first) state.first = entry;\n        if (previous) previous.next = entry;\n        if (DESCRIPTORS) state.size++;\n        else that.size++;\n        // add to index\n        if (index !== 'F') state.index[index] = entry;\n      } return that;\n    };\n\n    var getEntry = function (that, key) {\n      var state = getInternalState(that);\n      // fast case\n      var index = fastKey(key);\n      var entry;\n      if (index !== 'F') return state.index[index];\n      // frozen object case\n      for (entry = state.first; entry; entry = entry.next) {\n        if (entry.key == key) return entry;\n      }\n    };\n\n    redefineAll(Prototype, {\n      // `{ Map, Set }.prototype.clear()` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.clear\n      // https://tc39.es/ecma262/#sec-set.prototype.clear\n      clear: function clear() {\n        var that = this;\n        var state = getInternalState(that);\n        var data = state.index;\n        var entry = state.first;\n        while (entry) {\n          entry.removed = true;\n          if (entry.previous) entry.previous = entry.previous.next = undefined;\n          delete data[entry.index];\n          entry = entry.next;\n        }\n        state.first = state.last = undefined;\n        if (DESCRIPTORS) state.size = 0;\n        else that.size = 0;\n      },\n      // `{ Map, Set }.prototype.delete(key)` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.delete\n      // https://tc39.es/ecma262/#sec-set.prototype.delete\n      'delete': function (key) {\n        var that = this;\n        var state = getInternalState(that);\n        var entry = getEntry(that, key);\n        if (entry) {\n          var next = entry.next;\n          var prev = entry.previous;\n          delete state.index[entry.index];\n          entry.removed = true;\n          if (prev) prev.next = next;\n          if (next) next.previous = prev;\n          if (state.first == entry) state.first = next;\n          if (state.last == entry) state.last = prev;\n          if (DESCRIPTORS) state.size--;\n          else that.size--;\n        } return !!entry;\n      },\n      // `{ Map, Set }.prototype.forEach(callbackfn, thisArg = undefined)` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.foreach\n      // https://tc39.es/ecma262/#sec-set.prototype.foreach\n      forEach: function forEach(callbackfn /* , that = undefined */) {\n        var state = getInternalState(this);\n        var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n        var entry;\n        while (entry = entry ? entry.next : state.first) {\n          boundFunction(entry.value, entry.key, this);\n          // revert to the last existing entry\n          while (entry && entry.removed) entry = entry.previous;\n        }\n      },\n      // `{ Map, Set}.prototype.has(key)` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.has\n      // https://tc39.es/ecma262/#sec-set.prototype.has\n      has: function has(key) {\n        return !!getEntry(this, key);\n      }\n    });\n\n    redefineAll(Prototype, IS_MAP ? {\n      // `Map.prototype.get(key)` method\n      // https://tc39.es/ecma262/#sec-map.prototype.get\n      get: function get(key) {\n        var entry = getEntry(this, key);\n        return entry && entry.value;\n      },\n      // `Map.prototype.set(key, value)` method\n      // https://tc39.es/ecma262/#sec-map.prototype.set\n      set: function set(key, value) {\n        return define(this, key === 0 ? 0 : key, value);\n      }\n    } : {\n      // `Set.prototype.add(value)` method\n      // https://tc39.es/ecma262/#sec-set.prototype.add\n      add: function add(value) {\n        return define(this, value = value === 0 ? 0 : value, value);\n      }\n    });\n    if (DESCRIPTORS) defineProperty(Prototype, 'size', {\n      get: function () {\n        return getInternalState(this).size;\n      }\n    });\n    return Constructor;\n  },\n  setStrong: function (Constructor, CONSTRUCTOR_NAME, IS_MAP) {\n    var ITERATOR_NAME = CONSTRUCTOR_NAME + ' Iterator';\n    var getInternalCollectionState = internalStateGetterFor(CONSTRUCTOR_NAME);\n    var getInternalIteratorState = internalStateGetterFor(ITERATOR_NAME);\n    // `{ Map, Set }.prototype.{ keys, values, entries, @@iterator }()` methods\n    // https://tc39.es/ecma262/#sec-map.prototype.entries\n    // https://tc39.es/ecma262/#sec-map.prototype.keys\n    // https://tc39.es/ecma262/#sec-map.prototype.values\n    // https://tc39.es/ecma262/#sec-map.prototype-@@iterator\n    // https://tc39.es/ecma262/#sec-set.prototype.entries\n    // https://tc39.es/ecma262/#sec-set.prototype.keys\n    // https://tc39.es/ecma262/#sec-set.prototype.values\n    // https://tc39.es/ecma262/#sec-set.prototype-@@iterator\n    defineIterator(Constructor, CONSTRUCTOR_NAME, function (iterated, kind) {\n      setInternalState(this, {\n        type: ITERATOR_NAME,\n        target: iterated,\n        state: getInternalCollectionState(iterated),\n        kind: kind,\n        last: undefined\n      });\n    }, function () {\n      var state = getInternalIteratorState(this);\n      var kind = state.kind;\n      var entry = state.last;\n      // revert to the last existing entry\n      while (entry && entry.removed) entry = entry.previous;\n      // get next entry\n      if (!state.target || !(state.last = entry = entry ? entry.next : state.state.first)) {\n        // or finish the iteration\n        state.target = undefined;\n        return { value: undefined, done: true };\n      }\n      // return step by kind\n      if (kind == 'keys') return { value: entry.key, done: false };\n      if (kind == 'values') return { value: entry.value, done: false };\n      return { value: [entry.key, entry.value], done: false };\n    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);\n\n    // `{ Map, Set }.prototype[@@species]` accessors\n    // https://tc39.es/ecma262/#sec-get-map-@@species\n    // https://tc39.es/ecma262/#sec-get-set-@@species\n    setSpecies(CONSTRUCTOR_NAME);\n  }\n};\n","var $ = require('../internals/export');\nvar log1p = require('../internals/math-log1p');\n\n// eslint-disable-next-line es/no-math-acosh -- required for testing\nvar $acosh = Math.acosh;\nvar log = Math.log;\nvar sqrt = Math.sqrt;\nvar LN2 = Math.LN2;\n\nvar FORCED = !$acosh\n  // V8 bug: https://code.google.com/p/v8/issues/detail?id=3509\n  || Math.floor($acosh(Number.MAX_VALUE)) != 710\n  // Tor Browser bug: Math.acosh(Infinity) -> NaN\n  || $acosh(Infinity) != Infinity;\n\n// `Math.acosh` method\n// https://tc39.es/ecma262/#sec-math.acosh\n$({ target: 'Math', stat: true, forced: FORCED }, {\n  acosh: function acosh(x) {\n    return (x = +x) < 1 ? NaN : x > 94906265.62425156\n      ? log(x) + LN2\n      : log1p(x - 1 + sqrt(x - 1) * sqrt(x + 1));\n  }\n});\n","var log = Math.log;\n\n// `Math.log1p` method implementation\n// https://tc39.es/ecma262/#sec-math.log1p\n// eslint-disable-next-line es/no-math-log1p -- safe\nmodule.exports = Math.log1p || function log1p(x) {\n  return (x = +x) > -1e-8 && x < 1e-8 ? x - x * x / 2 : log(1 + x);\n};\n","var $ = require('../internals/export');\n\n// eslint-disable-next-line es/no-math-asinh -- required for testing\nvar $asinh = Math.asinh;\nvar log = Math.log;\nvar sqrt = Math.sqrt;\n\nfunction asinh(x) {\n  return !isFinite(x = +x) || x == 0 ? x : x < 0 ? -asinh(-x) : log(x + sqrt(x * x + 1));\n}\n\n// `Math.asinh` method\n// https://tc39.es/ecma262/#sec-math.asinh\n// Tor Browser bug: Math.asinh(0) -> -0\n$({ target: 'Math', stat: true, forced: !($asinh && 1 / $asinh(0) > 0) }, {\n  asinh: asinh\n});\n","var $ = require('../internals/export');\n\n// eslint-disable-next-line es/no-math-atanh -- required for testing\nvar $atanh = Math.atanh;\nvar log = Math.log;\n\n// `Math.atanh` method\n// https://tc39.es/ecma262/#sec-math.atanh\n// Tor Browser bug: Math.atanh(-0) -> 0\n$({ target: 'Math', stat: true, forced: !($atanh && 1 / $atanh(-0) < 0) }, {\n  atanh: function atanh(x) {\n    return (x = +x) == 0 ? x : log((1 + x) / (1 - x)) / 2;\n  }\n});\n","var $ = require('../internals/export');\nvar sign = require('../internals/math-sign');\n\nvar abs = Math.abs;\nvar pow = Math.pow;\n\n// `Math.cbrt` method\n// https://tc39.es/ecma262/#sec-math.cbrt\n$({ target: 'Math', stat: true }, {\n  cbrt: function cbrt(x) {\n    return sign(x = +x) * pow(abs(x), 1 / 3);\n  }\n});\n","// `Math.sign` method implementation\n// https://tc39.es/ecma262/#sec-math.sign\n// eslint-disable-next-line es/no-math-sign -- safe\nmodule.exports = Math.sign || function sign(x) {\n  // eslint-disable-next-line no-self-compare -- NaN check\n  return (x = +x) == 0 || x != x ? x : x < 0 ? -1 : 1;\n};\n","var $ = require('../internals/export');\n\nvar floor = Math.floor;\nvar log = Math.log;\nvar LOG2E = Math.LOG2E;\n\n// `Math.clz32` method\n// https://tc39.es/ecma262/#sec-math.clz32\n$({ target: 'Math', stat: true }, {\n  clz32: function clz32(x) {\n    return (x >>>= 0) ? 31 - floor(log(x + 0.5) * LOG2E) : 32;\n  }\n});\n","var $ = require('../internals/export');\nvar expm1 = require('../internals/math-expm1');\n\n// eslint-disable-next-line es/no-math-cosh -- required for testing\nvar $cosh = Math.cosh;\nvar abs = Math.abs;\nvar E = Math.E;\n\n// `Math.cosh` method\n// https://tc39.es/ecma262/#sec-math.cosh\n$({ target: 'Math', stat: true, forced: !$cosh || $cosh(710) === Infinity }, {\n  cosh: function cosh(x) {\n    var t = expm1(abs(x) - 1) + 1;\n    return (t + 1 / (t * E * E)) * (E / 2);\n  }\n});\n","// eslint-disable-next-line es/no-math-expm1 -- safe\nvar $expm1 = Math.expm1;\nvar exp = Math.exp;\n\n// `Math.expm1` method implementation\n// https://tc39.es/ecma262/#sec-math.expm1\nmodule.exports = (!$expm1\n  // Old FF bug\n  || $expm1(10) > 22025.465794806719 || $expm1(10) < 22025.4657948067165168\n  // Tor Browser bug\n  || $expm1(-2e-17) != -2e-17\n) ? function expm1(x) {\n  return (x = +x) == 0 ? x : x > -1e-6 && x < 1e-6 ? x + x * x / 2 : exp(x) - 1;\n} : $expm1;\n","var $ = require('../internals/export');\nvar expm1 = require('../internals/math-expm1');\n\n// `Math.expm1` method\n// https://tc39.es/ecma262/#sec-math.expm1\n// eslint-disable-next-line es/no-math-expm1 -- required for testing\n$({ target: 'Math', stat: true, forced: expm1 != Math.expm1 }, { expm1: expm1 });\n","var $ = require('../internals/export');\nvar fround = require('../internals/math-fround');\n\n// `Math.fround` method\n// https://tc39.es/ecma262/#sec-math.fround\n$({ target: 'Math', stat: true }, { fround: fround });\n","var sign = require('../internals/math-sign');\n\nvar abs = Math.abs;\nvar pow = Math.pow;\nvar EPSILON = pow(2, -52);\nvar EPSILON32 = pow(2, -23);\nvar MAX32 = pow(2, 127) * (2 - EPSILON32);\nvar MIN32 = pow(2, -126);\n\nvar roundTiesToEven = function (n) {\n  return n + 1 / EPSILON - 1 / EPSILON;\n};\n\n// `Math.fround` method implementation\n// https://tc39.es/ecma262/#sec-math.fround\n// eslint-disable-next-line es/no-math-fround -- safe\nmodule.exports = Math.fround || function fround(x) {\n  var $abs = abs(x);\n  var $sign = sign(x);\n  var a, result;\n  if ($abs < MIN32) return $sign * roundTiesToEven($abs / MIN32 / EPSILON32) * MIN32 * EPSILON32;\n  a = (1 + EPSILON32 / EPSILON) * $abs;\n  result = a - (a - $abs);\n  // eslint-disable-next-line no-self-compare -- NaN check\n  if (result > MAX32 || result != result) return $sign * Infinity;\n  return $sign * result;\n};\n","var $ = require('../internals/export');\n\n// eslint-disable-next-line es/no-math-hypot -- required for testing\nvar $hypot = Math.hypot;\nvar abs = Math.abs;\nvar sqrt = Math.sqrt;\n\n// Chrome 77 bug\n// https://bugs.chromium.org/p/v8/issues/detail?id=9546\nvar BUGGY = !!$hypot && $hypot(Infinity, NaN) !== Infinity;\n\n// `Math.hypot` method\n// https://tc39.es/ecma262/#sec-math.hypot\n$({ target: 'Math', stat: true, forced: BUGGY }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  hypot: function hypot(value1, value2) {\n    var sum = 0;\n    var i = 0;\n    var aLen = arguments.length;\n    var larg = 0;\n    var arg, div;\n    while (i < aLen) {\n      arg = abs(arguments[i++]);\n      if (larg < arg) {\n        div = larg / arg;\n        sum = sum * div * div + 1;\n        larg = arg;\n      } else if (arg > 0) {\n        div = arg / larg;\n        sum += div * div;\n      } else sum += arg;\n    }\n    return larg === Infinity ? Infinity : larg * sqrt(sum);\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-math-imul -- required for testing\nvar $imul = Math.imul;\n\nvar FORCED = fails(function () {\n  return $imul(0xFFFFFFFF, 5) != -5 || $imul.length != 2;\n});\n\n// `Math.imul` method\n// https://tc39.es/ecma262/#sec-math.imul\n// some WebKit versions fails with big numbers, some has wrong arity\n$({ target: 'Math', stat: true, forced: FORCED }, {\n  imul: function imul(x, y) {\n    var UINT16 = 0xFFFF;\n    var xn = +x;\n    var yn = +y;\n    var xl = UINT16 & xn;\n    var yl = UINT16 & yn;\n    return 0 | xl * yl + ((UINT16 & xn >>> 16) * yl + xl * (UINT16 & yn >>> 16) << 16 >>> 0);\n  }\n});\n","var $ = require('../internals/export');\nvar log10 = require('../internals/math-log10');\n\n// `Math.log10` method\n// https://tc39.es/ecma262/#sec-math.log10\n$({ target: 'Math', stat: true }, {\n  log10: log10\n});\n","var log = Math.log;\nvar LOG10E = Math.LOG10E;\n\n// eslint-disable-next-line es/no-math-log10 -- safe\nmodule.exports = Math.log10 || function log10(x) {\n  return log(x) * LOG10E;\n};\n","var $ = require('../internals/export');\nvar log1p = require('../internals/math-log1p');\n\n// `Math.log1p` method\n// https://tc39.es/ecma262/#sec-math.log1p\n$({ target: 'Math', stat: true }, { log1p: log1p });\n","var $ = require('../internals/export');\n\nvar log = Math.log;\nvar LN2 = Math.LN2;\n\n// `Math.log2` method\n// https://tc39.es/ecma262/#sec-math.log2\n$({ target: 'Math', stat: true }, {\n  log2: function log2(x) {\n    return log(x) / LN2;\n  }\n});\n","var $ = require('../internals/export');\nvar sign = require('../internals/math-sign');\n\n// `Math.sign` method\n// https://tc39.es/ecma262/#sec-math.sign\n$({ target: 'Math', stat: true }, {\n  sign: sign\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar expm1 = require('../internals/math-expm1');\n\nvar abs = Math.abs;\nvar exp = Math.exp;\nvar E = Math.E;\n\nvar FORCED = fails(function () {\n  // eslint-disable-next-line es/no-math-sinh -- required for testing\n  return Math.sinh(-2e-17) != -2e-17;\n});\n\n// `Math.sinh` method\n// https://tc39.es/ecma262/#sec-math.sinh\n// V8 near Chromium 38 has a problem with very small numbers\n$({ target: 'Math', stat: true, forced: FORCED }, {\n  sinh: function sinh(x) {\n    return abs(x = +x) < 1 ? (expm1(x) - expm1(-x)) / 2 : (exp(x - 1) - exp(-x - 1)) * (E / 2);\n  }\n});\n","var $ = require('../internals/export');\nvar expm1 = require('../internals/math-expm1');\n\nvar exp = Math.exp;\n\n// `Math.tanh` method\n// https://tc39.es/ecma262/#sec-math.tanh\n$({ target: 'Math', stat: true }, {\n  tanh: function tanh(x) {\n    var a = expm1(x = +x);\n    var b = expm1(-x);\n    return a == Infinity ? 1 : b == Infinity ? -1 : (a - b) / (exp(x) + exp(-x));\n  }\n});\n","var setToStringTag = require('../internals/set-to-string-tag');\n\n// Math[@@toStringTag] property\n// https://tc39.es/ecma262/#sec-math-@@tostringtag\nsetToStringTag(Math, 'Math', true);\n","var $ = require('../internals/export');\n\nvar ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `Math.trunc` method\n// https://tc39.es/ecma262/#sec-math.trunc\n$({ target: 'Math', stat: true }, {\n  trunc: function trunc(it) {\n    return (it > 0 ? floor : ceil)(it);\n  }\n});\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isForced = require('../internals/is-forced');\nvar redefine = require('../internals/redefine');\nvar hasOwn = require('../internals/has-own-property');\nvar inheritIfRequired = require('../internals/inherit-if-required');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar isSymbol = require('../internals/is-symbol');\nvar toPrimitive = require('../internals/to-primitive');\nvar fails = require('../internals/fails');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar defineProperty = require('../internals/object-define-property').f;\nvar thisNumberValue = require('../internals/this-number-value');\nvar trim = require('../internals/string-trim').trim;\n\nvar NUMBER = 'Number';\nvar NativeNumber = global[NUMBER];\nvar NumberPrototype = NativeNumber.prototype;\nvar TypeError = global.TypeError;\nvar arraySlice = uncurryThis(''.slice);\nvar charCodeAt = uncurryThis(''.charCodeAt);\n\n// `ToNumeric` abstract operation\n// https://tc39.es/ecma262/#sec-tonumeric\nvar toNumeric = function (value) {\n  var primValue = toPrimitive(value, 'number');\n  return typeof primValue == 'bigint' ? primValue : toNumber(primValue);\n};\n\n// `ToNumber` abstract operation\n// https://tc39.es/ecma262/#sec-tonumber\nvar toNumber = function (argument) {\n  var it = toPrimitive(argument, 'number');\n  var first, third, radix, maxCode, digits, length, index, code;\n  if (isSymbol(it)) throw TypeError('Cannot convert a Symbol value to a number');\n  if (typeof it == 'string' && it.length > 2) {\n    it = trim(it);\n    first = charCodeAt(it, 0);\n    if (first === 43 || first === 45) {\n      third = charCodeAt(it, 2);\n      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix\n    } else if (first === 48) {\n      switch (charCodeAt(it, 1)) {\n        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal of /^0b[01]+$/i\n        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal of /^0o[0-7]+$/i\n        default: return +it;\n      }\n      digits = arraySlice(it, 2);\n      length = digits.length;\n      for (index = 0; index < length; index++) {\n        code = charCodeAt(digits, index);\n        // parseInt parses a string to a first unavailable symbol\n        // but ToNumber should return NaN if a string contains unavailable symbols\n        if (code < 48 || code > maxCode) return NaN;\n      } return parseInt(digits, radix);\n    }\n  } return +it;\n};\n\n// `Number` constructor\n// https://tc39.es/ecma262/#sec-number-constructor\nif (isForced(NUMBER, !NativeNumber(' 0o1') || !NativeNumber('0b1') || NativeNumber('+0x1'))) {\n  var NumberWrapper = function Number(value) {\n    var n = arguments.length < 1 ? 0 : NativeNumber(toNumeric(value));\n    var dummy = this;\n    // check on 1..constructor(foo) case\n    return isPrototypeOf(NumberPrototype, dummy) && fails(function () { thisNumberValue(dummy); })\n      ? inheritIfRequired(Object(n), dummy, NumberWrapper) : n;\n  };\n  for (var keys = DESCRIPTORS ? getOwnPropertyNames(NativeNumber) : (\n    // ES3:\n    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +\n    // ES2015 (in case, if modules with ES2015 Number statics required before):\n    'EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,' +\n    // ESNext\n    'fromString,range'\n  ).split(','), j = 0, key; keys.length > j; j++) {\n    if (hasOwn(NativeNumber, key = keys[j]) && !hasOwn(NumberWrapper, key)) {\n      defineProperty(NumberWrapper, key, getOwnPropertyDescriptor(NativeNumber, key));\n    }\n  }\n  NumberWrapper.prototype = NumberPrototype;\n  NumberPrototype.constructor = NumberWrapper;\n  redefine(global, NUMBER, NumberWrapper);\n}\n","var uncurryThis = require('../internals/function-uncurry-this');\n\n// `thisNumberValue` abstract operation\n// https://tc39.es/ecma262/#sec-thisnumbervalue\nmodule.exports = uncurryThis(1.0.valueOf);\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toString = require('../internals/to-string');\nvar whitespaces = require('../internals/whitespaces');\n\nvar replace = uncurryThis(''.replace);\nvar whitespace = '[' + whitespaces + ']';\nvar ltrim = RegExp('^' + whitespace + whitespace + '*');\nvar rtrim = RegExp(whitespace + whitespace + '*$');\n\n// `String.prototype.{ trim, trimStart, trimEnd, trimLeft, trimRight }` methods implementation\nvar createMethod = function (TYPE) {\n  return function ($this) {\n    var string = toString(requireObjectCoercible($this));\n    if (TYPE & 1) string = replace(string, ltrim, '');\n    if (TYPE & 2) string = replace(string, rtrim, '');\n    return string;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.{ trimLeft, trimStart }` methods\n  // https://tc39.es/ecma262/#sec-string.prototype.trimstart\n  start: createMethod(1),\n  // `String.prototype.{ trimRight, trimEnd }` methods\n  // https://tc39.es/ecma262/#sec-string.prototype.trimend\n  end: createMethod(2),\n  // `String.prototype.trim` method\n  // https://tc39.es/ecma262/#sec-string.prototype.trim\n  trim: createMethod(3)\n};\n","// a string of all valid unicode whitespaces\nmodule.exports = '\\u0009\\u000A\\u000B\\u000C\\u000D\\u0020\\u00A0\\u1680\\u2000\\u2001\\u2002' +\n  '\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n","var $ = require('../internals/export');\n\n// `Number.EPSILON` constant\n// https://tc39.es/ecma262/#sec-number.epsilon\n$({ target: 'Number', stat: true }, {\n  EPSILON: Math.pow(2, -52)\n});\n","var $ = require('../internals/export');\nvar numberIsFinite = require('../internals/number-is-finite');\n\n// `Number.isFinite` method\n// https://tc39.es/ecma262/#sec-number.isfinite\n$({ target: 'Number', stat: true }, { isFinite: numberIsFinite });\n","var global = require('../internals/global');\n\nvar globalIsFinite = global.isFinite;\n\n// `Number.isFinite` method\n// https://tc39.es/ecma262/#sec-number.isfinite\n// eslint-disable-next-line es/no-number-isfinite -- safe\nmodule.exports = Number.isFinite || function isFinite(it) {\n  return typeof it == 'number' && globalIsFinite(it);\n};\n","var $ = require('../internals/export');\nvar isIntegralNumber = require('../internals/is-integral-number');\n\n// `Number.isInteger` method\n// https://tc39.es/ecma262/#sec-number.isinteger\n$({ target: 'Number', stat: true }, {\n  isInteger: isIntegralNumber\n});\n","var isObject = require('../internals/is-object');\n\nvar floor = Math.floor;\n\n// `IsIntegralNumber` abstract operation\n// https://tc39.es/ecma262/#sec-isintegralnumber\n// eslint-disable-next-line es/no-number-isinteger -- safe\nmodule.exports = Number.isInteger || function isInteger(it) {\n  return !isObject(it) && isFinite(it) && floor(it) === it;\n};\n","var $ = require('../internals/export');\n\n// `Number.isNaN` method\n// https://tc39.es/ecma262/#sec-number.isnan\n$({ target: 'Number', stat: true }, {\n  isNaN: function isNaN(number) {\n    // eslint-disable-next-line no-self-compare -- NaN check\n    return number != number;\n  }\n});\n","var $ = require('../internals/export');\nvar isIntegralNumber = require('../internals/is-integral-number');\n\nvar abs = Math.abs;\n\n// `Number.isSafeInteger` method\n// https://tc39.es/ecma262/#sec-number.issafeinteger\n$({ target: 'Number', stat: true }, {\n  isSafeInteger: function isSafeInteger(number) {\n    return isIntegralNumber(number) && abs(number) <= 0x1FFFFFFFFFFFFF;\n  }\n});\n","var $ = require('../internals/export');\n\n// `Number.MAX_SAFE_INTEGER` constant\n// https://tc39.es/ecma262/#sec-number.max_safe_integer\n$({ target: 'Number', stat: true }, {\n  MAX_SAFE_INTEGER: 0x1FFFFFFFFFFFFF\n});\n","var $ = require('../internals/export');\n\n// `Number.MIN_SAFE_INTEGER` constant\n// https://tc39.es/ecma262/#sec-number.min_safe_integer\n$({ target: 'Number', stat: true }, {\n  MIN_SAFE_INTEGER: -0x1FFFFFFFFFFFFF\n});\n","var $ = require('../internals/export');\nvar parseFloat = require('../internals/number-parse-float');\n\n// `Number.parseFloat` method\n// https://tc39.es/ecma262/#sec-number.parseFloat\n// eslint-disable-next-line es/no-number-parsefloat -- required for testing\n$({ target: 'Number', stat: true, forced: Number.parseFloat != parseFloat }, {\n  parseFloat: parseFloat\n});\n","var global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar trim = require('../internals/string-trim').trim;\nvar whitespaces = require('../internals/whitespaces');\n\nvar charAt = uncurryThis(''.charAt);\nvar n$ParseFloat = global.parseFloat;\nvar Symbol = global.Symbol;\nvar ITERATOR = Symbol && Symbol.iterator;\nvar FORCED = 1 / n$ParseFloat(whitespaces + '-0') !== -Infinity\n  // MS Edge 18- broken with boxed symbols\n  || (ITERATOR && !fails(function () { n$ParseFloat(Object(ITERATOR)); }));\n\n// `parseFloat` method\n// https://tc39.es/ecma262/#sec-parsefloat-string\nmodule.exports = FORCED ? function parseFloat(string) {\n  var trimmedString = trim(toString(string));\n  var result = n$ParseFloat(trimmedString);\n  return result === 0 && charAt(trimmedString, 0) == '-' ? -0 : result;\n} : n$ParseFloat;\n","var $ = require('../internals/export');\nvar parseInt = require('../internals/number-parse-int');\n\n// `Number.parseInt` method\n// https://tc39.es/ecma262/#sec-number.parseint\n// eslint-disable-next-line es/no-number-parseint -- required for testing\n$({ target: 'Number', stat: true, forced: Number.parseInt != parseInt }, {\n  parseInt: parseInt\n});\n","var global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar trim = require('../internals/string-trim').trim;\nvar whitespaces = require('../internals/whitespaces');\n\nvar $parseInt = global.parseInt;\nvar Symbol = global.Symbol;\nvar ITERATOR = Symbol && Symbol.iterator;\nvar hex = /^[+-]?0x/i;\nvar exec = uncurryThis(hex.exec);\nvar FORCED = $parseInt(whitespaces + '08') !== 8 || $parseInt(whitespaces + '0x16') !== 22\n  // MS Edge 18- broken with boxed symbols\n  || (ITERATOR && !fails(function () { $parseInt(Object(ITERATOR)); }));\n\n// `parseInt` method\n// https://tc39.es/ecma262/#sec-parseint-string-radix\nmodule.exports = FORCED ? function parseInt(string, radix) {\n  var S = trim(toString(string));\n  return $parseInt(S, (radix >>> 0) || (exec(hex, S) ? 16 : 10));\n} : $parseInt;\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar thisNumberValue = require('../internals/this-number-value');\nvar $repeat = require('../internals/string-repeat');\nvar fails = require('../internals/fails');\n\nvar RangeError = global.RangeError;\nvar String = global.String;\nvar floor = Math.floor;\nvar repeat = uncurryThis($repeat);\nvar stringSlice = uncurryThis(''.slice);\nvar un$ToFixed = uncurryThis(1.0.toFixed);\n\nvar pow = function (x, n, acc) {\n  return n === 0 ? acc : n % 2 === 1 ? pow(x, n - 1, acc * x) : pow(x * x, n / 2, acc);\n};\n\nvar log = function (x) {\n  var n = 0;\n  var x2 = x;\n  while (x2 >= 4096) {\n    n += 12;\n    x2 /= 4096;\n  }\n  while (x2 >= 2) {\n    n += 1;\n    x2 /= 2;\n  } return n;\n};\n\nvar multiply = function (data, n, c) {\n  var index = -1;\n  var c2 = c;\n  while (++index < 6) {\n    c2 += n * data[index];\n    data[index] = c2 % 1e7;\n    c2 = floor(c2 / 1e7);\n  }\n};\n\nvar divide = function (data, n) {\n  var index = 6;\n  var c = 0;\n  while (--index >= 0) {\n    c += data[index];\n    data[index] = floor(c / n);\n    c = (c % n) * 1e7;\n  }\n};\n\nvar dataToString = function (data) {\n  var index = 6;\n  var s = '';\n  while (--index >= 0) {\n    if (s !== '' || index === 0 || data[index] !== 0) {\n      var t = String(data[index]);\n      s = s === '' ? t : s + repeat('0', 7 - t.length) + t;\n    }\n  } return s;\n};\n\nvar FORCED = fails(function () {\n  return un$ToFixed(0.00008, 3) !== '0.000' ||\n    un$ToFixed(0.9, 0) !== '1' ||\n    un$ToFixed(1.255, 2) !== '1.25' ||\n    un$ToFixed(1000000000000000128.0, 0) !== '1000000000000000128';\n}) || !fails(function () {\n  // V8 ~ Android 4.3-\n  un$ToFixed({});\n});\n\n// `Number.prototype.toFixed` method\n// https://tc39.es/ecma262/#sec-number.prototype.tofixed\n$({ target: 'Number', proto: true, forced: FORCED }, {\n  toFixed: function toFixed(fractionDigits) {\n    var number = thisNumberValue(this);\n    var fractDigits = toIntegerOrInfinity(fractionDigits);\n    var data = [0, 0, 0, 0, 0, 0];\n    var sign = '';\n    var result = '0';\n    var e, z, j, k;\n\n    // TODO: ES2018 increased the maximum number of fraction digits to 100, need to improve the implementation\n    if (fractDigits < 0 || fractDigits > 20) throw RangeError('Incorrect fraction digits');\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (number != number) return 'NaN';\n    if (number <= -1e21 || number >= 1e21) return String(number);\n    if (number < 0) {\n      sign = '-';\n      number = -number;\n    }\n    if (number > 1e-21) {\n      e = log(number * pow(2, 69, 1)) - 69;\n      z = e < 0 ? number * pow(2, -e, 1) : number / pow(2, e, 1);\n      z *= 0x10000000000000;\n      e = 52 - e;\n      if (e > 0) {\n        multiply(data, 0, z);\n        j = fractDigits;\n        while (j >= 7) {\n          multiply(data, 1e7, 0);\n          j -= 7;\n        }\n        multiply(data, pow(10, j, 1), 0);\n        j = e - 1;\n        while (j >= 23) {\n          divide(data, 1 << 23);\n          j -= 23;\n        }\n        divide(data, 1 << j);\n        multiply(data, 1, 1);\n        divide(data, 2);\n        result = dataToString(data);\n      } else {\n        multiply(data, 0, z);\n        multiply(data, 1 << -e, 0);\n        result = dataToString(data) + repeat('0', fractDigits);\n      }\n    }\n    if (fractDigits > 0) {\n      k = result.length;\n      result = sign + (k <= fractDigits\n        ? '0.' + repeat('0', fractDigits - k) + result\n        : stringSlice(result, 0, k - fractDigits) + '.' + stringSlice(result, k - fractDigits));\n    } else {\n      result = sign + result;\n    } return result;\n  }\n});\n","'use strict';\nvar global = require('../internals/global');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toString = require('../internals/to-string');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar RangeError = global.RangeError;\n\n// `String.prototype.repeat` method implementation\n// https://tc39.es/ecma262/#sec-string.prototype.repeat\nmodule.exports = function repeat(count) {\n  var str = toString(requireObjectCoercible(this));\n  var result = '';\n  var n = toIntegerOrInfinity(count);\n  if (n < 0 || n == Infinity) throw RangeError('Wrong number of repetitions');\n  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) result += str;\n  return result;\n};\n","var $ = require('../internals/export');\nvar assign = require('../internals/object-assign');\n\n// `Object.assign` method\n// https://tc39.es/ecma262/#sec-object.assign\n// eslint-disable-next-line es/no-object-assign -- required for testing\n$({ target: 'Object', stat: true, forced: Object.assign !== assign }, {\n  assign: assign\n});\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar call = require('../internals/function-call');\nvar fails = require('../internals/fails');\nvar objectKeys = require('../internals/object-keys');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar toObject = require('../internals/to-object');\nvar IndexedObject = require('../internals/indexed-object');\n\n// eslint-disable-next-line es/no-object-assign -- safe\nvar $assign = Object.assign;\n// eslint-disable-next-line es/no-object-defineproperty -- required for testing\nvar defineProperty = Object.defineProperty;\nvar concat = uncurryThis([].concat);\n\n// `Object.assign` method\n// https://tc39.es/ecma262/#sec-object.assign\nmodule.exports = !$assign || fails(function () {\n  // should have correct order of operations (Edge bug)\n  if (DESCRIPTORS && $assign({ b: 1 }, $assign(defineProperty({}, 'a', {\n    enumerable: true,\n    get: function () {\n      defineProperty(this, 'b', {\n        value: 3,\n        enumerable: false\n      });\n    }\n  }), { b: 2 })).b !== 1) return true;\n  // should work with symbols and should have deterministic property order (V8 bug)\n  var A = {};\n  var B = {};\n  // eslint-disable-next-line es/no-symbol -- safe\n  var symbol = Symbol();\n  var alphabet = 'abcdefghijklmnopqrst';\n  A[symbol] = 7;\n  alphabet.split('').forEach(function (chr) { B[chr] = chr; });\n  return $assign({}, A)[symbol] != 7 || objectKeys($assign({}, B)).join('') != alphabet;\n}) ? function assign(target, source) { // eslint-disable-line no-unused-vars -- required for `.length`\n  var T = toObject(target);\n  var argumentsLength = arguments.length;\n  var index = 1;\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  var propertyIsEnumerable = propertyIsEnumerableModule.f;\n  while (argumentsLength > index) {\n    var S = IndexedObject(arguments[index++]);\n    var keys = getOwnPropertySymbols ? concat(objectKeys(S), getOwnPropertySymbols(S)) : objectKeys(S);\n    var length = keys.length;\n    var j = 0;\n    var key;\n    while (length > j) {\n      key = keys[j++];\n      if (!DESCRIPTORS || call(propertyIsEnumerable, S, key)) T[key] = S[key];\n    }\n  } return T;\n} : $assign;\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar definePropertyModule = require('../internals/object-define-property');\n\n// `Object.prototype.__defineGetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__defineGetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __defineGetter__: function __defineGetter__(P, getter) {\n      definePropertyModule.f(toObject(this), P, { get: aCallable(getter), enumerable: true, configurable: true });\n    }\n  });\n}\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\n// Forced replacement object prototype accessors methods\nmodule.exports = IS_PURE || !fails(function () {\n  // This feature detection crashes old WebKit\n  // https://github.com/zloirock/core-js/issues/232\n  if (WEBKIT && WEBKIT < 535) return;\n  var key = Math.random();\n  // In FF throws only define methods\n  // eslint-disable-next-line no-undef, no-useless-call -- required for testing\n  __defineSetter__.call(null, key, function () { /* empty */ });\n  delete global[key];\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar definePropertyModule = require('../internals/object-define-property');\n\n// `Object.prototype.__defineSetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__defineSetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __defineSetter__: function __defineSetter__(P, setter) {\n      definePropertyModule.f(toObject(this), P, { set: aCallable(setter), enumerable: true, configurable: true });\n    }\n  });\n}\n","var $ = require('../internals/export');\nvar $entries = require('../internals/object-to-array').entries;\n\n// `Object.entries` method\n// https://tc39.es/ecma262/#sec-object.entries\n$({ target: 'Object', stat: true }, {\n  entries: function entries(O) {\n    return $entries(O);\n  }\n});\n","var DESCRIPTORS = require('../internals/descriptors');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar objectKeys = require('../internals/object-keys');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar $propertyIsEnumerable = require('../internals/object-property-is-enumerable').f;\n\nvar propertyIsEnumerable = uncurryThis($propertyIsEnumerable);\nvar push = uncurryThis([].push);\n\n// `Object.{ entries, values }` methods implementation\nvar createMethod = function (TO_ENTRIES) {\n  return function (it) {\n    var O = toIndexedObject(it);\n    var keys = objectKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) {\n      key = keys[i++];\n      if (!DESCRIPTORS || propertyIsEnumerable(O, key)) {\n        push(result, TO_ENTRIES ? [key, O[key]] : O[key]);\n      }\n    }\n    return result;\n  };\n};\n\nmodule.exports = {\n  // `Object.entries` method\n  // https://tc39.es/ecma262/#sec-object.entries\n  entries: createMethod(true),\n  // `Object.values` method\n  // https://tc39.es/ecma262/#sec-object.values\n  values: createMethod(false)\n};\n","var $ = require('../internals/export');\nvar FREEZING = require('../internals/freezing');\nvar fails = require('../internals/fails');\nvar isObject = require('../internals/is-object');\nvar onFreeze = require('../internals/internal-metadata').onFreeze;\n\n// eslint-disable-next-line es/no-object-freeze -- safe\nvar $freeze = Object.freeze;\nvar FAILS_ON_PRIMITIVES = fails(function () { $freeze(1); });\n\n// `Object.freeze` method\n// https://tc39.es/ecma262/#sec-object.freeze\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !FREEZING }, {\n  freeze: function freeze(it) {\n    return $freeze && isObject(it) ? $freeze(onFreeze(it)) : it;\n  }\n});\n","var $ = require('../internals/export');\nvar iterate = require('../internals/iterate');\nvar createProperty = require('../internals/create-property');\n\n// `Object.fromEntries` method\n// https://github.com/tc39/proposal-object-from-entries\n$({ target: 'Object', stat: true }, {\n  fromEntries: function fromEntries(iterable) {\n    var obj = {};\n    iterate(iterable, function (k, v) {\n      createProperty(obj, k, v);\n    }, { AS_ENTRIES: true });\n    return obj;\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar nativeGetOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeGetOwnPropertyDescriptor(1); });\nvar FORCED = !DESCRIPTORS || FAILS_ON_PRIMITIVES;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\n$({ target: 'Object', stat: true, forced: FORCED, sham: !DESCRIPTORS }, {\n  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(it, key) {\n    return nativeGetOwnPropertyDescriptor(toIndexedObject(it), key);\n  }\n});\n","var $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar ownKeys = require('../internals/own-keys');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar createProperty = require('../internals/create-property');\n\n// `Object.getOwnPropertyDescriptors` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptors\n$({ target: 'Object', stat: true, sham: !DESCRIPTORS }, {\n  getOwnPropertyDescriptors: function getOwnPropertyDescriptors(object) {\n    var O = toIndexedObject(object);\n    var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n    var keys = ownKeys(O);\n    var result = {};\n    var index = 0;\n    var key, descriptor;\n    while (keys.length > index) {\n      descriptor = getOwnPropertyDescriptor(O, key = keys[index++]);\n      if (descriptor !== undefined) createProperty(result, key, descriptor);\n    }\n    return result;\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names-external').f;\n\n// eslint-disable-next-line es/no-object-getownpropertynames -- required for testing\nvar FAILS_ON_PRIMITIVES = fails(function () { return !Object.getOwnPropertyNames(1); });\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  getOwnPropertyNames: getOwnPropertyNames\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toObject = require('../internals/to-object');\nvar nativeGetPrototypeOf = require('../internals/object-get-prototype-of');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeGetPrototypeOf(1); });\n\n// `Object.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.getprototypeof\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !CORRECT_PROTOTYPE_GETTER }, {\n  getPrototypeOf: function getPrototypeOf(it) {\n    return nativeGetPrototypeOf(toObject(it));\n  }\n});\n\n","var $ = require('../internals/export');\nvar is = require('../internals/same-value');\n\n// `Object.is` method\n// https://tc39.es/ecma262/#sec-object.is\n$({ target: 'Object', stat: true }, {\n  is: is\n});\n","// `SameValue` abstract operation\n// https://tc39.es/ecma262/#sec-samevalue\n// eslint-disable-next-line es/no-object-is -- safe\nmodule.exports = Object.is || function is(x, y) {\n  // eslint-disable-next-line no-self-compare -- NaN check\n  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;\n};\n","var $ = require('../internals/export');\nvar $isExtensible = require('../internals/object-is-extensible');\n\n// `Object.isExtensible` method\n// https://tc39.es/ecma262/#sec-object.isextensible\n// eslint-disable-next-line es/no-object-isextensible -- safe\n$({ target: 'Object', stat: true, forced: Object.isExtensible !== $isExtensible }, {\n  isExtensible: $isExtensible\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar ARRAY_BUFFER_NON_EXTENSIBLE = require('../internals/array-buffer-non-extensible');\n\n// eslint-disable-next-line es/no-object-isfrozen -- safe\nvar $isFrozen = Object.isFrozen;\nvar FAILS_ON_PRIMITIVES = fails(function () { $isFrozen(1); });\n\n// `Object.isFrozen` method\n// https://tc39.es/ecma262/#sec-object.isfrozen\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES || ARRAY_BUFFER_NON_EXTENSIBLE }, {\n  isFrozen: function isFrozen(it) {\n    if (!isObject(it)) return true;\n    if (ARRAY_BUFFER_NON_EXTENSIBLE && classof(it) == 'ArrayBuffer') return true;\n    return $isFrozen ? $isFrozen(it) : false;\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar ARRAY_BUFFER_NON_EXTENSIBLE = require('../internals/array-buffer-non-extensible');\n\n// eslint-disable-next-line es/no-object-issealed -- safe\nvar $isSealed = Object.isSealed;\nvar FAILS_ON_PRIMITIVES = fails(function () { $isSealed(1); });\n\n// `Object.isSealed` method\n// https://tc39.es/ecma262/#sec-object.issealed\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES || ARRAY_BUFFER_NON_EXTENSIBLE }, {\n  isSealed: function isSealed(it) {\n    if (!isObject(it)) return true;\n    if (ARRAY_BUFFER_NON_EXTENSIBLE && classof(it) == 'ArrayBuffer') return true;\n    return $isSealed ? $isSealed(it) : false;\n  }\n});\n","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar toObject = require('../internals/to-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\n\n// `Object.prototype.__lookupGetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__lookupGetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __lookupGetter__: function __lookupGetter__(P) {\n      var O = toObject(this);\n      var key = toPropertyKey(P);\n      var desc;\n      do {\n        if (desc = getOwnPropertyDescriptor(O, key)) return desc.get;\n      } while (O = getPrototypeOf(O));\n    }\n  });\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar toObject = require('../internals/to-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\n\n// `Object.prototype.__lookupSetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__lookupSetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __lookupSetter__: function __lookupSetter__(P) {\n      var O = toObject(this);\n      var key = toPropertyKey(P);\n      var desc;\n      do {\n        if (desc = getOwnPropertyDescriptor(O, key)) return desc.set;\n      } while (O = getPrototypeOf(O));\n    }\n  });\n}\n","var $ = require('../internals/export');\nvar isObject = require('../internals/is-object');\nvar onFreeze = require('../internals/internal-metadata').onFreeze;\nvar FREEZING = require('../internals/freezing');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-object-preventextensions -- safe\nvar $preventExtensions = Object.preventExtensions;\nvar FAILS_ON_PRIMITIVES = fails(function () { $preventExtensions(1); });\n\n// `Object.preventExtensions` method\n// https://tc39.es/ecma262/#sec-object.preventextensions\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !FREEZING }, {\n  preventExtensions: function preventExtensions(it) {\n    return $preventExtensions && isObject(it) ? $preventExtensions(onFreeze(it)) : it;\n  }\n});\n","var $ = require('../internals/export');\nvar isObject = require('../internals/is-object');\nvar onFreeze = require('../internals/internal-metadata').onFreeze;\nvar FREEZING = require('../internals/freezing');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-object-seal -- safe\nvar $seal = Object.seal;\nvar FAILS_ON_PRIMITIVES = fails(function () { $seal(1); });\n\n// `Object.seal` method\n// https://tc39.es/ecma262/#sec-object.seal\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !FREEZING }, {\n  seal: function seal(it) {\n    return $seal && isObject(it) ? $seal(onFreeze(it)) : it;\n  }\n});\n","var $ = require('../internals/export');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\n\n// `Object.setPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.setprototypeof\n$({ target: 'Object', stat: true }, {\n  setPrototypeOf: setPrototypeOf\n});\n","var TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar redefine = require('../internals/redefine');\nvar toString = require('../internals/object-to-string');\n\n// `Object.prototype.toString` method\n// https://tc39.es/ecma262/#sec-object.prototype.tostring\nif (!TO_STRING_TAG_SUPPORT) {\n  redefine(Object.prototype, 'toString', toString, { unsafe: true });\n}\n","'use strict';\nvar TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar classof = require('../internals/classof');\n\n// `Object.prototype.toString` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.tostring\nmodule.exports = TO_STRING_TAG_SUPPORT ? {}.toString : function toString() {\n  return '[object ' + classof(this) + ']';\n};\n","var $ = require('../internals/export');\nvar $values = require('../internals/object-to-array').values;\n\n// `Object.values` method\n// https://tc39.es/ecma262/#sec-object.values\n$({ target: 'Object', stat: true }, {\n  values: function values(O) {\n    return $values(O);\n  }\n});\n","var $ = require('../internals/export');\nvar $parseFloat = require('../internals/number-parse-float');\n\n// `parseFloat` method\n// https://tc39.es/ecma262/#sec-parsefloat-string\n$({ global: true, forced: parseFloat != $parseFloat }, {\n  parseFloat: $parseFloat\n});\n","var $ = require('../internals/export');\nvar $parseInt = require('../internals/number-parse-int');\n\n// `parseInt` method\n// https://tc39.es/ecma262/#sec-parseint-string-radix\n$({ global: true, forced: parseInt != $parseInt }, {\n  parseInt: $parseInt\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar NativePromise = require('../internals/native-promise-constructor');\nvar redefine = require('../internals/redefine');\nvar redefineAll = require('../internals/redefine-all');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar setSpecies = require('../internals/set-species');\nvar aCallable = require('../internals/a-callable');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar anInstance = require('../internals/an-instance');\nvar inspectSource = require('../internals/inspect-source');\nvar iterate = require('../internals/iterate');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar speciesConstructor = require('../internals/species-constructor');\nvar task = require('../internals/task').set;\nvar microtask = require('../internals/microtask');\nvar promiseResolve = require('../internals/promise-resolve');\nvar hostReportErrors = require('../internals/host-report-errors');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar Queue = require('../internals/queue');\nvar InternalStateModule = require('../internals/internal-state');\nvar isForced = require('../internals/is-forced');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_BROWSER = require('../internals/engine-is-browser');\nvar IS_NODE = require('../internals/engine-is-node');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar SPECIES = wellKnownSymbol('species');\nvar PROMISE = 'Promise';\n\nvar getInternalState = InternalStateModule.getterFor(PROMISE);\nvar setInternalState = InternalStateModule.set;\nvar getInternalPromiseState = InternalStateModule.getterFor(PROMISE);\nvar NativePromisePrototype = NativePromise && NativePromise.prototype;\nvar PromiseConstructor = NativePromise;\nvar PromisePrototype = NativePromisePrototype;\nvar TypeError = global.TypeError;\nvar document = global.document;\nvar process = global.process;\nvar newPromiseCapability = newPromiseCapabilityModule.f;\nvar newGenericPromiseCapability = newPromiseCapability;\n\nvar DISPATCH_EVENT = !!(document && document.createEvent && global.dispatchEvent);\nvar NATIVE_REJECTION_EVENT = isCallable(global.PromiseRejectionEvent);\nvar UNHANDLED_REJECTION = 'unhandledrejection';\nvar REJECTION_HANDLED = 'rejectionhandled';\nvar PENDING = 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\nvar HANDLED = 1;\nvar UNHANDLED = 2;\nvar SUBCLASSING = false;\n\nvar Internal, OwnPromiseCapability, PromiseWrapper, nativeThen;\n\nvar FORCED = isForced(PROMISE, function () {\n  var PROMISE_CONSTRUCTOR_SOURCE = inspectSource(PromiseConstructor);\n  var GLOBAL_CORE_JS_PROMISE = PROMISE_CONSTRUCTOR_SOURCE !== String(PromiseConstructor);\n  // V8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=830565\n  // We can't detect it synchronously, so just check versions\n  if (!GLOBAL_CORE_JS_PROMISE && V8_VERSION === 66) return true;\n  // We need Promise#finally in the pure version for preventing prototype pollution\n  if (IS_PURE && !PromisePrototype['finally']) return true;\n  // We can't use @@species feature detection in V8 since it causes\n  // deoptimization and performance degradation\n  // https://github.com/zloirock/core-js/issues/679\n  if (V8_VERSION >= 51 && /native code/.test(PROMISE_CONSTRUCTOR_SOURCE)) return false;\n  // Detect correctness of subclassing with @@species support\n  var promise = new PromiseConstructor(function (resolve) { resolve(1); });\n  var FakePromise = function (exec) {\n    exec(function () { /* empty */ }, function () { /* empty */ });\n  };\n  var constructor = promise.constructor = {};\n  constructor[SPECIES] = FakePromise;\n  SUBCLASSING = promise.then(function () { /* empty */ }) instanceof FakePromise;\n  if (!SUBCLASSING) return true;\n  // Unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n  return !GLOBAL_CORE_JS_PROMISE && IS_BROWSER && !NATIVE_REJECTION_EVENT;\n});\n\nvar INCORRECT_ITERATION = FORCED || !checkCorrectnessOfIteration(function (iterable) {\n  PromiseConstructor.all(iterable)['catch'](function () { /* empty */ });\n});\n\n// helpers\nvar isThenable = function (it) {\n  var then;\n  return isObject(it) && isCallable(then = it.then) ? then : false;\n};\n\nvar callReaction = function (reaction, state) {\n  var value = state.value;\n  var ok = state.state == FULFILLED;\n  var handler = ok ? reaction.ok : reaction.fail;\n  var resolve = reaction.resolve;\n  var reject = reaction.reject;\n  var domain = reaction.domain;\n  var result, then, exited;\n  try {\n    if (handler) {\n      if (!ok) {\n        if (state.rejection === UNHANDLED) onHandleUnhandled(state);\n        state.rejection = HANDLED;\n      }\n      if (handler === true) result = value;\n      else {\n        if (domain) domain.enter();\n        result = handler(value); // can throw\n        if (domain) {\n          domain.exit();\n          exited = true;\n        }\n      }\n      if (result === reaction.promise) {\n        reject(TypeError('Promise-chain cycle'));\n      } else if (then = isThenable(result)) {\n        call(then, result, resolve, reject);\n      } else resolve(result);\n    } else reject(value);\n  } catch (error) {\n    if (domain && !exited) domain.exit();\n    reject(error);\n  }\n};\n\nvar notify = function (state, isReject) {\n  if (state.notified) return;\n  state.notified = true;\n  microtask(function () {\n    var reactions = state.reactions;\n    var reaction;\n    while (reaction = reactions.get()) {\n      callReaction(reaction, state);\n    }\n    state.notified = false;\n    if (isReject && !state.rejection) onUnhandled(state);\n  });\n};\n\nvar dispatchEvent = function (name, promise, reason) {\n  var event, handler;\n  if (DISPATCH_EVENT) {\n    event = document.createEvent('Event');\n    event.promise = promise;\n    event.reason = reason;\n    event.initEvent(name, false, true);\n    global.dispatchEvent(event);\n  } else event = { promise: promise, reason: reason };\n  if (!NATIVE_REJECTION_EVENT && (handler = global['on' + name])) handler(event);\n  else if (name === UNHANDLED_REJECTION) hostReportErrors('Unhandled promise rejection', reason);\n};\n\nvar onUnhandled = function (state) {\n  call(task, global, function () {\n    var promise = state.facade;\n    var value = state.value;\n    var IS_UNHANDLED = isUnhandled(state);\n    var result;\n    if (IS_UNHANDLED) {\n      result = perform(function () {\n        if (IS_NODE) {\n          process.emit('unhandledRejection', value, promise);\n        } else dispatchEvent(UNHANDLED_REJECTION, promise, value);\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      state.rejection = IS_NODE || isUnhandled(state) ? UNHANDLED : HANDLED;\n      if (result.error) throw result.value;\n    }\n  });\n};\n\nvar isUnhandled = function (state) {\n  return state.rejection !== HANDLED && !state.parent;\n};\n\nvar onHandleUnhandled = function (state) {\n  call(task, global, function () {\n    var promise = state.facade;\n    if (IS_NODE) {\n      process.emit('rejectionHandled', promise);\n    } else dispatchEvent(REJECTION_HANDLED, promise, state.value);\n  });\n};\n\nvar bind = function (fn, state, unwrap) {\n  return function (value) {\n    fn(state, value, unwrap);\n  };\n};\n\nvar internalReject = function (state, value, unwrap) {\n  if (state.done) return;\n  state.done = true;\n  if (unwrap) state = unwrap;\n  state.value = value;\n  state.state = REJECTED;\n  notify(state, true);\n};\n\nvar internalResolve = function (state, value, unwrap) {\n  if (state.done) return;\n  state.done = true;\n  if (unwrap) state = unwrap;\n  try {\n    if (state.facade === value) throw TypeError(\"Promise can't be resolved itself\");\n    var then = isThenable(value);\n    if (then) {\n      microtask(function () {\n        var wrapper = { done: false };\n        try {\n          call(then, value,\n            bind(internalResolve, wrapper, state),\n            bind(internalReject, wrapper, state)\n          );\n        } catch (error) {\n          internalReject(wrapper, error, state);\n        }\n      });\n    } else {\n      state.value = value;\n      state.state = FULFILLED;\n      notify(state, false);\n    }\n  } catch (error) {\n    internalReject({ done: false }, error, state);\n  }\n};\n\n// constructor polyfill\nif (FORCED) {\n  // 25.4.3.1 Promise(executor)\n  PromiseConstructor = function Promise(executor) {\n    anInstance(this, PromisePrototype);\n    aCallable(executor);\n    call(Internal, this);\n    var state = getInternalState(this);\n    try {\n      executor(bind(internalResolve, state), bind(internalReject, state));\n    } catch (error) {\n      internalReject(state, error);\n    }\n  };\n  PromisePrototype = PromiseConstructor.prototype;\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  Internal = function Promise(executor) {\n    setInternalState(this, {\n      type: PROMISE,\n      done: false,\n      notified: false,\n      parent: false,\n      reactions: new Queue(),\n      rejection: false,\n      state: PENDING,\n      value: undefined\n    });\n  };\n  Internal.prototype = redefineAll(PromisePrototype, {\n    // `Promise.prototype.then` method\n    // https://tc39.es/ecma262/#sec-promise.prototype.then\n    // eslint-disable-next-line unicorn/no-thenable -- safe\n    then: function then(onFulfilled, onRejected) {\n      var state = getInternalPromiseState(this);\n      var reaction = newPromiseCapability(speciesConstructor(this, PromiseConstructor));\n      state.parent = true;\n      reaction.ok = isCallable(onFulfilled) ? onFulfilled : true;\n      reaction.fail = isCallable(onRejected) && onRejected;\n      reaction.domain = IS_NODE ? process.domain : undefined;\n      if (state.state == PENDING) state.reactions.add(reaction);\n      else microtask(function () {\n        callReaction(reaction, state);\n      });\n      return reaction.promise;\n    },\n    // `Promise.prototype.catch` method\n    // https://tc39.es/ecma262/#sec-promise.prototype.catch\n    'catch': function (onRejected) {\n      return this.then(undefined, onRejected);\n    }\n  });\n  OwnPromiseCapability = function () {\n    var promise = new Internal();\n    var state = getInternalState(promise);\n    this.promise = promise;\n    this.resolve = bind(internalResolve, state);\n    this.reject = bind(internalReject, state);\n  };\n  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {\n    return C === PromiseConstructor || C === PromiseWrapper\n      ? new OwnPromiseCapability(C)\n      : newGenericPromiseCapability(C);\n  };\n\n  if (!IS_PURE && isCallable(NativePromise) && NativePromisePrototype !== Object.prototype) {\n    nativeThen = NativePromisePrototype.then;\n\n    if (!SUBCLASSING) {\n      // make `Promise#then` return a polyfilled `Promise` for native promise-based APIs\n      redefine(NativePromisePrototype, 'then', function then(onFulfilled, onRejected) {\n        var that = this;\n        return new PromiseConstructor(function (resolve, reject) {\n          call(nativeThen, that, resolve, reject);\n        }).then(onFulfilled, onRejected);\n      // https://github.com/zloirock/core-js/issues/640\n      }, { unsafe: true });\n\n      // makes sure that native promise-based APIs `Promise#catch` properly works with patched `Promise#then`\n      redefine(NativePromisePrototype, 'catch', PromisePrototype['catch'], { unsafe: true });\n    }\n\n    // make `.constructor === Promise` work for native promise-based APIs\n    try {\n      delete NativePromisePrototype.constructor;\n    } catch (error) { /* empty */ }\n\n    // make `instanceof Promise` work for native promise-based APIs\n    if (setPrototypeOf) {\n      setPrototypeOf(NativePromisePrototype, PromisePrototype);\n    }\n  }\n}\n\n$({ global: true, wrap: true, forced: FORCED }, {\n  Promise: PromiseConstructor\n});\n\nsetToStringTag(PromiseConstructor, PROMISE, false, true);\nsetSpecies(PROMISE);\n\nPromiseWrapper = getBuiltIn(PROMISE);\n\n// statics\n$({ target: PROMISE, stat: true, forced: FORCED }, {\n  // `Promise.reject` method\n  // https://tc39.es/ecma262/#sec-promise.reject\n  reject: function reject(r) {\n    var capability = newPromiseCapability(this);\n    call(capability.reject, undefined, r);\n    return capability.promise;\n  }\n});\n\n$({ target: PROMISE, stat: true, forced: IS_PURE || FORCED }, {\n  // `Promise.resolve` method\n  // https://tc39.es/ecma262/#sec-promise.resolve\n  resolve: function resolve(x) {\n    return promiseResolve(IS_PURE && this === PromiseWrapper ? PromiseConstructor : this, x);\n  }\n});\n\n$({ target: PROMISE, stat: true, forced: INCORRECT_ITERATION }, {\n  // `Promise.all` method\n  // https://tc39.es/ecma262/#sec-promise.all\n  all: function all(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var $promiseResolve = aCallable(C.resolve);\n      var values = [];\n      var counter = 0;\n      var remaining = 1;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyCalled = false;\n        remaining++;\n        call($promiseResolve, C, promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  },\n  // `Promise.race` method\n  // https://tc39.es/ecma262/#sec-promise.race\n  race: function race(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var reject = capability.reject;\n    var result = perform(function () {\n      var $promiseResolve = aCallable(C.resolve);\n      iterate(iterable, function (promise) {\n        call($promiseResolve, C, promise).then(capability.resolve, reject);\n      });\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","var global = require('../internals/global');\n\nmodule.exports = global.Promise;\n","var global = require('../internals/global');\nvar apply = require('../internals/function-apply');\nvar bind = require('../internals/function-bind-context');\nvar isCallable = require('../internals/is-callable');\nvar hasOwn = require('../internals/has-own-property');\nvar fails = require('../internals/fails');\nvar html = require('../internals/html');\nvar arraySlice = require('../internals/array-slice');\nvar createElement = require('../internals/document-create-element');\nvar IS_IOS = require('../internals/engine-is-ios');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar set = global.setImmediate;\nvar clear = global.clearImmediate;\nvar process = global.process;\nvar Dispatch = global.Dispatch;\nvar Function = global.Function;\nvar MessageChannel = global.MessageChannel;\nvar String = global.String;\nvar counter = 0;\nvar queue = {};\nvar ONREADYSTATECHANGE = 'onreadystatechange';\nvar location, defer, channel, port;\n\ntry {\n  // Deno throws a ReferenceError on `location` access without `--location` flag\n  location = global.location;\n} catch (error) { /* empty */ }\n\nvar run = function (id) {\n  if (hasOwn(queue, id)) {\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\n\nvar runner = function (id) {\n  return function () {\n    run(id);\n  };\n};\n\nvar listener = function (event) {\n  run(event.data);\n};\n\nvar post = function (id) {\n  // old engines have not location.origin\n  global.postMessage(String(id), location.protocol + '//' + location.host);\n};\n\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif (!set || !clear) {\n  set = function setImmediate(fn) {\n    var args = arraySlice(arguments, 1);\n    queue[++counter] = function () {\n      apply(isCallable(fn) ? fn : Function(fn), undefined, args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clear = function clearImmediate(id) {\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if (IS_NODE) {\n    defer = function (id) {\n      process.nextTick(runner(id));\n    };\n  // Sphere (JS game engine) Dispatch API\n  } else if (Dispatch && Dispatch.now) {\n    defer = function (id) {\n      Dispatch.now(runner(id));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  // except iOS - https://github.com/zloirock/core-js/issues/624\n  } else if (MessageChannel && !IS_IOS) {\n    channel = new MessageChannel();\n    port = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = bind(port.postMessage, port);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if (\n    global.addEventListener &&\n    isCallable(global.postMessage) &&\n    !global.importScripts &&\n    location && location.protocol !== 'file:' &&\n    !fails(post)\n  ) {\n    defer = post;\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if (ONREADYSTATECHANGE in createElement('script')) {\n    defer = function (id) {\n      html.appendChild(createElement('script'))[ONREADYSTATECHANGE] = function () {\n        html.removeChild(this);\n        run(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function (id) {\n      setTimeout(runner(id), 0);\n    };\n  }\n}\n\nmodule.exports = {\n  set: set,\n  clear: clear\n};\n","var userAgent = require('../internals/engine-user-agent');\n\nmodule.exports = /(?:ipad|iphone|ipod).*applewebkit/i.test(userAgent);\n","var global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar macrotask = require('../internals/task').set;\nvar IS_IOS = require('../internals/engine-is-ios');\nvar IS_IOS_PEBBLE = require('../internals/engine-is-ios-pebble');\nvar IS_WEBOS_WEBKIT = require('../internals/engine-is-webos-webkit');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar MutationObserver = global.MutationObserver || global.WebKitMutationObserver;\nvar document = global.document;\nvar process = global.process;\nvar Promise = global.Promise;\n// Node.js 11 shows ExperimentalWarning on getting `queueMicrotask`\nvar queueMicrotaskDescriptor = getOwnPropertyDescriptor(global, 'queueMicrotask');\nvar queueMicrotask = queueMicrotaskDescriptor && queueMicrotaskDescriptor.value;\n\nvar flush, head, last, notify, toggle, node, promise, then;\n\n// modern engines have queueMicrotask method\nif (!queueMicrotask) {\n  flush = function () {\n    var parent, fn;\n    if (IS_NODE && (parent = process.domain)) parent.exit();\n    while (head) {\n      fn = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch (error) {\n        if (head) notify();\n        else last = undefined;\n        throw error;\n      }\n    } last = undefined;\n    if (parent) parent.enter();\n  };\n\n  // browsers with MutationObserver, except iOS - https://github.com/zloirock/core-js/issues/339\n  // also except WebOS Webkit https://github.com/zloirock/core-js/issues/898\n  if (!IS_IOS && !IS_NODE && !IS_WEBOS_WEBKIT && MutationObserver && document) {\n    toggle = true;\n    node = document.createTextNode('');\n    new MutationObserver(flush).observe(node, { characterData: true });\n    notify = function () {\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if (!IS_IOS_PEBBLE && Promise && Promise.resolve) {\n    // Promise.resolve without an argument throws an error in LG WebOS 2\n    promise = Promise.resolve(undefined);\n    // workaround of WebKit ~ iOS Safari 10.1 bug\n    promise.constructor = Promise;\n    then = bind(promise.then, promise);\n    notify = function () {\n      then(flush);\n    };\n  // Node.js without promises\n  } else if (IS_NODE) {\n    notify = function () {\n      process.nextTick(flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    // strange IE + webpack dev server bug - use .bind(global)\n    macrotask = bind(macrotask, global);\n    notify = function () {\n      macrotask(flush);\n    };\n  }\n}\n\nmodule.exports = queueMicrotask || function (fn) {\n  var task = { fn: fn, next: undefined };\n  if (last) last.next = task;\n  if (!head) {\n    head = task;\n    notify();\n  } last = task;\n};\n","var userAgent = require('../internals/engine-user-agent');\nvar global = require('../internals/global');\n\nmodule.exports = /ipad|iphone|ipod/i.test(userAgent) && global.Pebble !== undefined;\n","var userAgent = require('../internals/engine-user-agent');\n\nmodule.exports = /web0s(?!.*chrome)/i.test(userAgent);\n","var anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar newPromiseCapability = require('../internals/new-promise-capability');\n\nmodule.exports = function (C, x) {\n  anObject(C);\n  if (isObject(x) && x.constructor === C) return x;\n  var promiseCapability = newPromiseCapability.f(C);\n  var resolve = promiseCapability.resolve;\n  resolve(x);\n  return promiseCapability.promise;\n};\n","'use strict';\nvar aCallable = require('../internals/a-callable');\n\nvar PromiseCapability = function (C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aCallable(resolve);\n  this.reject = aCallable(reject);\n};\n\n// `NewPromiseCapability` abstract operation\n// https://tc39.es/ecma262/#sec-newpromisecapability\nmodule.exports.f = function (C) {\n  return new PromiseCapability(C);\n};\n","var global = require('../internals/global');\n\nmodule.exports = function (a, b) {\n  var console = global.console;\n  if (console && console.error) {\n    arguments.length == 1 ? console.error(a) : console.error(a, b);\n  }\n};\n","module.exports = function (exec) {\n  try {\n    return { error: false, value: exec() };\n  } catch (error) {\n    return { error: true, value: error };\n  }\n};\n","var Queue = function () {\n  this.head = null;\n  this.tail = null;\n};\n\nQueue.prototype = {\n  add: function (item) {\n    var entry = { item: item, next: null };\n    if (this.head) this.tail.next = entry;\n    else this.head = entry;\n    this.tail = entry;\n  },\n  get: function () {\n    var entry = this.head;\n    if (entry) {\n      this.head = entry.next;\n      if (this.tail === entry) this.tail = null;\n      return entry.item;\n    }\n  }\n};\n\nmodule.exports = Queue;\n","module.exports = typeof window == 'object';\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar NativePromise = require('../internals/native-promise-constructor');\nvar fails = require('../internals/fails');\nvar getBuiltIn = require('../internals/get-built-in');\nvar isCallable = require('../internals/is-callable');\nvar speciesConstructor = require('../internals/species-constructor');\nvar promiseResolve = require('../internals/promise-resolve');\nvar redefine = require('../internals/redefine');\n\n// Safari bug https://bugs.webkit.org/show_bug.cgi?id=200829\nvar NON_GENERIC = !!NativePromise && fails(function () {\n  // eslint-disable-next-line unicorn/no-thenable -- required for testing\n  NativePromise.prototype['finally'].call({ then: function () { /* empty */ } }, function () { /* empty */ });\n});\n\n// `Promise.prototype.finally` method\n// https://tc39.es/ecma262/#sec-promise.prototype.finally\n$({ target: 'Promise', proto: true, real: true, forced: NON_GENERIC }, {\n  'finally': function (onFinally) {\n    var C = speciesConstructor(this, getBuiltIn('Promise'));\n    var isFunction = isCallable(onFinally);\n    return this.then(\n      isFunction ? function (x) {\n        return promiseResolve(C, onFinally()).then(function () { return x; });\n      } : onFinally,\n      isFunction ? function (e) {\n        return promiseResolve(C, onFinally()).then(function () { throw e; });\n      } : onFinally\n    );\n  }\n});\n\n// makes sure that native promise-based APIs `Promise#finally` properly works with patched `Promise#then`\nif (!IS_PURE && isCallable(NativePromise)) {\n  var method = getBuiltIn('Promise').prototype['finally'];\n  if (NativePromise.prototype['finally'] !== method) {\n    redefine(NativePromise.prototype, 'finally', method, { unsafe: true });\n  }\n}\n","var $ = require('../internals/export');\nvar functionApply = require('../internals/function-apply');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar fails = require('../internals/fails');\n\n// MS Edge argumentsList argument is optional\nvar OPTIONAL_ARGUMENTS_LIST = !fails(function () {\n  // eslint-disable-next-line es/no-reflect -- required for testing\n  Reflect.apply(function () { /* empty */ });\n});\n\n// `Reflect.apply` method\n// https://tc39.es/ecma262/#sec-reflect.apply\n$({ target: 'Reflect', stat: true, forced: OPTIONAL_ARGUMENTS_LIST }, {\n  apply: function apply(target, thisArgument, argumentsList) {\n    return functionApply(aCallable(target), thisArgument, anObject(argumentsList));\n  }\n});\n","var $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar apply = require('../internals/function-apply');\nvar bind = require('../internals/function-bind');\nvar aConstructor = require('../internals/a-constructor');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar create = require('../internals/object-create');\nvar fails = require('../internals/fails');\n\nvar nativeConstruct = getBuiltIn('Reflect', 'construct');\nvar ObjectPrototype = Object.prototype;\nvar push = [].push;\n\n// `Reflect.construct` method\n// https://tc39.es/ecma262/#sec-reflect.construct\n// MS Edge supports only 2 arguments and argumentsList argument is optional\n// FF Nightly sets third argument as `new.target`, but does not create `this` from it\nvar NEW_TARGET_BUG = fails(function () {\n  function F() { /* empty */ }\n  return !(nativeConstruct(function () { /* empty */ }, [], F) instanceof F);\n});\n\nvar ARGS_BUG = !fails(function () {\n  nativeConstruct(function () { /* empty */ });\n});\n\nvar FORCED = NEW_TARGET_BUG || ARGS_BUG;\n\n$({ target: 'Reflect', stat: true, forced: FORCED, sham: FORCED }, {\n  construct: function construct(Target, args /* , newTarget */) {\n    aConstructor(Target);\n    anObject(args);\n    var newTarget = arguments.length < 3 ? Target : aConstructor(arguments[2]);\n    if (ARGS_BUG && !NEW_TARGET_BUG) return nativeConstruct(Target, args, newTarget);\n    if (Target == newTarget) {\n      // w/o altered newTarget, optimization for 0-4 arguments\n      switch (args.length) {\n        case 0: return new Target();\n        case 1: return new Target(args[0]);\n        case 2: return new Target(args[0], args[1]);\n        case 3: return new Target(args[0], args[1], args[2]);\n        case 4: return new Target(args[0], args[1], args[2], args[3]);\n      }\n      // w/o altered newTarget, lot of arguments case\n      var $args = [null];\n      apply(push, $args, args);\n      return new (apply(bind, Target, $args))();\n    }\n    // with altered newTarget, not support built-in constructors\n    var proto = newTarget.prototype;\n    var instance = create(isObject(proto) ? proto : ObjectPrototype);\n    var result = apply(Target, instance, args);\n    return isObject(result) ? result : instance;\n  }\n});\n","'use strict';\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar isObject = require('../internals/is-object');\nvar hasOwn = require('../internals/has-own-property');\nvar arraySlice = require('../internals/array-slice');\nvar NATIVE_BIND = require('../internals/function-bind-native');\n\nvar Function = global.Function;\nvar concat = uncurryThis([].concat);\nvar join = uncurryThis([].join);\nvar factories = {};\n\nvar construct = function (C, argsLength, args) {\n  if (!hasOwn(factories, argsLength)) {\n    for (var list = [], i = 0; i < argsLength; i++) list[i] = 'a[' + i + ']';\n    factories[argsLength] = Function('C,a', 'return new C(' + join(list, ',') + ')');\n  } return factories[argsLength](C, args);\n};\n\n// `Function.prototype.bind` method implementation\n// https://tc39.es/ecma262/#sec-function.prototype.bind\nmodule.exports = NATIVE_BIND ? Function.bind : function bind(that /* , ...args */) {\n  var F = aCallable(this);\n  var Prototype = F.prototype;\n  var partArgs = arraySlice(arguments, 1);\n  var boundFunction = function bound(/* args... */) {\n    var args = concat(partArgs, arraySlice(arguments));\n    return this instanceof boundFunction ? construct(F, args.length, args) : F.apply(that, args);\n  };\n  if (isObject(Prototype)) boundFunction.prototype = Prototype;\n  return boundFunction;\n};\n","var $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar anObject = require('../internals/an-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar definePropertyModule = require('../internals/object-define-property');\nvar fails = require('../internals/fails');\n\n// MS Edge has broken Reflect.defineProperty - throwing instead of returning false\nvar ERROR_INSTEAD_OF_FALSE = fails(function () {\n  // eslint-disable-next-line es/no-reflect -- required for testing\n  Reflect.defineProperty(definePropertyModule.f({}, 1, { value: 1 }), 1, { value: 2 });\n});\n\n// `Reflect.defineProperty` method\n// https://tc39.es/ecma262/#sec-reflect.defineproperty\n$({ target: 'Reflect', stat: true, forced: ERROR_INSTEAD_OF_FALSE, sham: !DESCRIPTORS }, {\n  defineProperty: function defineProperty(target, propertyKey, attributes) {\n    anObject(target);\n    var key = toPropertyKey(propertyKey);\n    anObject(attributes);\n    try {\n      definePropertyModule.f(target, key, attributes);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n});\n","var $ = require('../internals/export');\nvar anObject = require('../internals/an-object');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\n\n// `Reflect.deleteProperty` method\n// https://tc39.es/ecma262/#sec-reflect.deleteproperty\n$({ target: 'Reflect', stat: true }, {\n  deleteProperty: function deleteProperty(target, propertyKey) {\n    var descriptor = getOwnPropertyDescriptor(anObject(target), propertyKey);\n    return descriptor && !descriptor.configurable ? false : delete target[propertyKey];\n  }\n});\n","var $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar isObject = require('../internals/is-object');\nvar anObject = require('../internals/an-object');\nvar isDataDescriptor = require('../internals/is-data-descriptor');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\n\n// `Reflect.get` method\n// https://tc39.es/ecma262/#sec-reflect.get\nfunction get(target, propertyKey /* , receiver */) {\n  var receiver = arguments.length < 3 ? target : arguments[2];\n  var descriptor, prototype;\n  if (anObject(target) === receiver) return target[propertyKey];\n  descriptor = getOwnPropertyDescriptorModule.f(target, propertyKey);\n  if (descriptor) return isDataDescriptor(descriptor)\n    ? descriptor.value\n    : descriptor.get === undefined ? undefined : call(descriptor.get, receiver);\n  if (isObject(prototype = getPrototypeOf(target))) return get(prototype, propertyKey, receiver);\n}\n\n$({ target: 'Reflect', stat: true }, {\n  get: get\n});\n","var hasOwn = require('../internals/has-own-property');\n\nmodule.exports = function (descriptor) {\n  return descriptor !== undefined && (hasOwn(descriptor, 'value') || hasOwn(descriptor, 'writable'));\n};\n","var $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar anObject = require('../internals/an-object');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\n\n// `Reflect.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-reflect.getownpropertydescriptor\n$({ target: 'Reflect', stat: true, sham: !DESCRIPTORS }, {\n  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(target, propertyKey) {\n    return getOwnPropertyDescriptorModule.f(anObject(target), propertyKey);\n  }\n});\n","var $ = require('../internals/export');\nvar anObject = require('../internals/an-object');\nvar objectGetPrototypeOf = require('../internals/object-get-prototype-of');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\n// `Reflect.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-reflect.getprototypeof\n$({ target: 'Reflect', stat: true, sham: !CORRECT_PROTOTYPE_GETTER }, {\n  getPrototypeOf: function getPrototypeOf(target) {\n    return objectGetPrototypeOf(anObject(target));\n  }\n});\n","var $ = require('../internals/export');\n\n// `Reflect.has` method\n// https://tc39.es/ecma262/#sec-reflect.has\n$({ target: 'Reflect', stat: true }, {\n  has: function has(target, propertyKey) {\n    return propertyKey in target;\n  }\n});\n","var $ = require('../internals/export');\nvar anObject = require('../internals/an-object');\nvar $isExtensible = require('../internals/object-is-extensible');\n\n// `Reflect.isExtensible` method\n// https://tc39.es/ecma262/#sec-reflect.isextensible\n$({ target: 'Reflect', stat: true }, {\n  isExtensible: function isExtensible(target) {\n    anObject(target);\n    return $isExtensible(target);\n  }\n});\n","var $ = require('../internals/export');\nvar ownKeys = require('../internals/own-keys');\n\n// `Reflect.ownKeys` method\n// https://tc39.es/ecma262/#sec-reflect.ownkeys\n$({ target: 'Reflect', stat: true }, {\n  ownKeys: ownKeys\n});\n","var $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar anObject = require('../internals/an-object');\nvar FREEZING = require('../internals/freezing');\n\n// `Reflect.preventExtensions` method\n// https://tc39.es/ecma262/#sec-reflect.preventextensions\n$({ target: 'Reflect', stat: true, sham: !FREEZING }, {\n  preventExtensions: function preventExtensions(target) {\n    anObject(target);\n    try {\n      var objectPreventExtensions = getBuiltIn('Object', 'preventExtensions');\n      if (objectPreventExtensions) objectPreventExtensions(target);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n});\n","var $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar isDataDescriptor = require('../internals/is-data-descriptor');\nvar fails = require('../internals/fails');\nvar definePropertyModule = require('../internals/object-define-property');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\n// `Reflect.set` method\n// https://tc39.es/ecma262/#sec-reflect.set\nfunction set(target, propertyKey, V /* , receiver */) {\n  var receiver = arguments.length < 4 ? target : arguments[3];\n  var ownDescriptor = getOwnPropertyDescriptorModule.f(anObject(target), propertyKey);\n  var existingDescriptor, prototype, setter;\n  if (!ownDescriptor) {\n    if (isObject(prototype = getPrototypeOf(target))) {\n      return set(prototype, propertyKey, V, receiver);\n    }\n    ownDescriptor = createPropertyDescriptor(0);\n  }\n  if (isDataDescriptor(ownDescriptor)) {\n    if (ownDescriptor.writable === false || !isObject(receiver)) return false;\n    if (existingDescriptor = getOwnPropertyDescriptorModule.f(receiver, propertyKey)) {\n      if (existingDescriptor.get || existingDescriptor.set || existingDescriptor.writable === false) return false;\n      existingDescriptor.value = V;\n      definePropertyModule.f(receiver, propertyKey, existingDescriptor);\n    } else definePropertyModule.f(receiver, propertyKey, createPropertyDescriptor(0, V));\n  } else {\n    setter = ownDescriptor.set;\n    if (setter === undefined) return false;\n    call(setter, receiver, V);\n  } return true;\n}\n\n// MS Edge 17-18 Reflect.set allows setting the property to object\n// with non-writable property on the prototype\nvar MS_EDGE_BUG = fails(function () {\n  var Constructor = function () { /* empty */ };\n  var object = definePropertyModule.f(new Constructor(), 'a', { configurable: true });\n  // eslint-disable-next-line es/no-reflect -- required for testing\n  return Reflect.set(Constructor.prototype, 'a', 1, object) !== false;\n});\n\n$({ target: 'Reflect', stat: true, forced: MS_EDGE_BUG }, {\n  set: set\n});\n","var $ = require('../internals/export');\nvar anObject = require('../internals/an-object');\nvar aPossiblePrototype = require('../internals/a-possible-prototype');\nvar objectSetPrototypeOf = require('../internals/object-set-prototype-of');\n\n// `Reflect.setPrototypeOf` method\n// https://tc39.es/ecma262/#sec-reflect.setprototypeof\nif (objectSetPrototypeOf) $({ target: 'Reflect', stat: true }, {\n  setPrototypeOf: function setPrototypeOf(target, proto) {\n    anObject(target);\n    aPossiblePrototype(proto);\n    try {\n      objectSetPrototypeOf(target, proto);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n});\n","var DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isForced = require('../internals/is-forced');\nvar inheritIfRequired = require('../internals/inherit-if-required');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar defineProperty = require('../internals/object-define-property').f;\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar isRegExp = require('../internals/is-regexp');\nvar toString = require('../internals/to-string');\nvar regExpFlags = require('../internals/regexp-flags');\nvar stickyHelpers = require('../internals/regexp-sticky-helpers');\nvar redefine = require('../internals/redefine');\nvar fails = require('../internals/fails');\nvar hasOwn = require('../internals/has-own-property');\nvar enforceInternalState = require('../internals/internal-state').enforce;\nvar setSpecies = require('../internals/set-species');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar UNSUPPORTED_DOT_ALL = require('../internals/regexp-unsupported-dot-all');\nvar UNSUPPORTED_NCG = require('../internals/regexp-unsupported-ncg');\n\nvar MATCH = wellKnownSymbol('match');\nvar NativeRegExp = global.RegExp;\nvar RegExpPrototype = NativeRegExp.prototype;\nvar SyntaxError = global.SyntaxError;\nvar getFlags = uncurryThis(regExpFlags);\nvar exec = uncurryThis(RegExpPrototype.exec);\nvar charAt = uncurryThis(''.charAt);\nvar replace = uncurryThis(''.replace);\nvar stringIndexOf = uncurryThis(''.indexOf);\nvar stringSlice = uncurryThis(''.slice);\n// TODO: Use only propper RegExpIdentifierName\nvar IS_NCG = /^\\?<[^\\s\\d!#%&*+<=>@^][^\\s!#%&*+<=>@^]*>/;\nvar re1 = /a/g;\nvar re2 = /a/g;\n\n// \"new\" should create a new object, old webkit bug\nvar CORRECT_NEW = new NativeRegExp(re1) !== re1;\n\nvar MISSED_STICKY = stickyHelpers.MISSED_STICKY;\nvar UNSUPPORTED_Y = stickyHelpers.UNSUPPORTED_Y;\n\nvar BASE_FORCED = DESCRIPTORS &&\n  (!CORRECT_NEW || MISSED_STICKY || UNSUPPORTED_DOT_ALL || UNSUPPORTED_NCG || fails(function () {\n    re2[MATCH] = false;\n    // RegExp constructor can alter flags and IsRegExp works correct with @@match\n    return NativeRegExp(re1) != re1 || NativeRegExp(re2) == re2 || NativeRegExp(re1, 'i') != '/a/i';\n  }));\n\nvar handleDotAll = function (string) {\n  var length = string.length;\n  var index = 0;\n  var result = '';\n  var brackets = false;\n  var chr;\n  for (; index <= length; index++) {\n    chr = charAt(string, index);\n    if (chr === '\\\\') {\n      result += chr + charAt(string, ++index);\n      continue;\n    }\n    if (!brackets && chr === '.') {\n      result += '[\\\\s\\\\S]';\n    } else {\n      if (chr === '[') {\n        brackets = true;\n      } else if (chr === ']') {\n        brackets = false;\n      } result += chr;\n    }\n  } return result;\n};\n\nvar handleNCG = function (string) {\n  var length = string.length;\n  var index = 0;\n  var result = '';\n  var named = [];\n  var names = {};\n  var brackets = false;\n  var ncg = false;\n  var groupid = 0;\n  var groupname = '';\n  var chr;\n  for (; index <= length; index++) {\n    chr = charAt(string, index);\n    if (chr === '\\\\') {\n      chr = chr + charAt(string, ++index);\n    } else if (chr === ']') {\n      brackets = false;\n    } else if (!brackets) switch (true) {\n      case chr === '[':\n        brackets = true;\n        break;\n      case chr === '(':\n        if (exec(IS_NCG, stringSlice(string, index + 1))) {\n          index += 2;\n          ncg = true;\n        }\n        result += chr;\n        groupid++;\n        continue;\n      case chr === '>' && ncg:\n        if (groupname === '' || hasOwn(names, groupname)) {\n          throw new SyntaxError('Invalid capture group name');\n        }\n        names[groupname] = true;\n        named[named.length] = [groupname, groupid];\n        ncg = false;\n        groupname = '';\n        continue;\n    }\n    if (ncg) groupname += chr;\n    else result += chr;\n  } return [result, named];\n};\n\n// `RegExp` constructor\n// https://tc39.es/ecma262/#sec-regexp-constructor\nif (isForced('RegExp', BASE_FORCED)) {\n  var RegExpWrapper = function RegExp(pattern, flags) {\n    var thisIsRegExp = isPrototypeOf(RegExpPrototype, this);\n    var patternIsRegExp = isRegExp(pattern);\n    var flagsAreUndefined = flags === undefined;\n    var groups = [];\n    var rawPattern = pattern;\n    var rawFlags, dotAll, sticky, handled, result, state;\n\n    if (!thisIsRegExp && patternIsRegExp && flagsAreUndefined && pattern.constructor === RegExpWrapper) {\n      return pattern;\n    }\n\n    if (patternIsRegExp || isPrototypeOf(RegExpPrototype, pattern)) {\n      pattern = pattern.source;\n      if (flagsAreUndefined) flags = 'flags' in rawPattern ? rawPattern.flags : getFlags(rawPattern);\n    }\n\n    pattern = pattern === undefined ? '' : toString(pattern);\n    flags = flags === undefined ? '' : toString(flags);\n    rawPattern = pattern;\n\n    if (UNSUPPORTED_DOT_ALL && 'dotAll' in re1) {\n      dotAll = !!flags && stringIndexOf(flags, 's') > -1;\n      if (dotAll) flags = replace(flags, /s/g, '');\n    }\n\n    rawFlags = flags;\n\n    if (MISSED_STICKY && 'sticky' in re1) {\n      sticky = !!flags && stringIndexOf(flags, 'y') > -1;\n      if (sticky && UNSUPPORTED_Y) flags = replace(flags, /y/g, '');\n    }\n\n    if (UNSUPPORTED_NCG) {\n      handled = handleNCG(pattern);\n      pattern = handled[0];\n      groups = handled[1];\n    }\n\n    result = inheritIfRequired(NativeRegExp(pattern, flags), thisIsRegExp ? this : RegExpPrototype, RegExpWrapper);\n\n    if (dotAll || sticky || groups.length) {\n      state = enforceInternalState(result);\n      if (dotAll) {\n        state.dotAll = true;\n        state.raw = RegExpWrapper(handleDotAll(pattern), rawFlags);\n      }\n      if (sticky) state.sticky = true;\n      if (groups.length) state.groups = groups;\n    }\n\n    if (pattern !== rawPattern) try {\n      // fails in old engines, but we have no alternatives for unsupported regex syntax\n      createNonEnumerableProperty(result, 'source', rawPattern === '' ? '(?:)' : rawPattern);\n    } catch (error) { /* empty */ }\n\n    return result;\n  };\n\n  var proxy = function (key) {\n    key in RegExpWrapper || defineProperty(RegExpWrapper, key, {\n      configurable: true,\n      get: function () { return NativeRegExp[key]; },\n      set: function (it) { NativeRegExp[key] = it; }\n    });\n  };\n\n  for (var keys = getOwnPropertyNames(NativeRegExp), index = 0; keys.length > index;) {\n    proxy(keys[index++]);\n  }\n\n  RegExpPrototype.constructor = RegExpWrapper;\n  RegExpWrapper.prototype = RegExpPrototype;\n  redefine(global, 'RegExp', RegExpWrapper);\n}\n\n// https://tc39.es/ecma262/#sec-get-regexp-@@species\nsetSpecies('RegExp');\n","var isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\n// `IsRegExp` abstract operation\n// https://tc39.es/ecma262/#sec-isregexp\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : classof(it) == 'RegExp');\n};\n","'use strict';\nvar anObject = require('../internals/an-object');\n\n// `RegExp.prototype.flags` getter implementation\n// https://tc39.es/ecma262/#sec-get-regexp.prototype.flags\nmodule.exports = function () {\n  var that = anObject(this);\n  var result = '';\n  if (that.global) result += 'g';\n  if (that.ignoreCase) result += 'i';\n  if (that.multiline) result += 'm';\n  if (that.dotAll) result += 's';\n  if (that.unicode) result += 'u';\n  if (that.sticky) result += 'y';\n  return result;\n};\n","var fails = require('../internals/fails');\nvar global = require('../internals/global');\n\n// babel-minify and Closure Compiler transpiles RegExp('a', 'y') -> /a/y and it causes SyntaxError\nvar $RegExp = global.RegExp;\n\nvar UNSUPPORTED_Y = fails(function () {\n  var re = $RegExp('a', 'y');\n  re.lastIndex = 2;\n  return re.exec('abcd') != null;\n});\n\n// UC Browser bug\n// https://github.com/zloirock/core-js/issues/1008\nvar MISSED_STICKY = UNSUPPORTED_Y || fails(function () {\n  return !$RegExp('a', 'y').sticky;\n});\n\nvar BROKEN_CARET = UNSUPPORTED_Y || fails(function () {\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=773687\n  var re = $RegExp('^r', 'gy');\n  re.lastIndex = 2;\n  return re.exec('str') != null;\n});\n\nmodule.exports = {\n  BROKEN_CARET: BROKEN_CARET,\n  MISSED_STICKY: MISSED_STICKY,\n  UNSUPPORTED_Y: UNSUPPORTED_Y\n};\n","var fails = require('../internals/fails');\nvar global = require('../internals/global');\n\n// babel-minify and Closure Compiler transpiles RegExp('.', 's') -> /./s and it causes SyntaxError\nvar $RegExp = global.RegExp;\n\nmodule.exports = fails(function () {\n  var re = $RegExp('.', 's');\n  return !(re.dotAll && re.exec('\\n') && re.flags === 's');\n});\n","var fails = require('../internals/fails');\nvar global = require('../internals/global');\n\n// babel-minify and Closure Compiler transpiles RegExp('(?<a>b)', 'g') -> /(?<a>b)/g and it causes SyntaxError\nvar $RegExp = global.RegExp;\n\nmodule.exports = fails(function () {\n  var re = $RegExp('(?<a>b)', 'g');\n  return re.exec('b').groups.a !== 'b' ||\n    'b'.replace(re, '$<a>c') !== 'bc';\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar exec = require('../internals/regexp-exec');\n\n// `RegExp.prototype.exec` method\n// https://tc39.es/ecma262/#sec-regexp.prototype.exec\n$({ target: 'RegExp', proto: true, forced: /./.exec !== exec }, {\n  exec: exec\n});\n","'use strict';\n/* eslint-disable regexp/no-empty-capturing-group, regexp/no-empty-group, regexp/no-lazy-ends -- testing */\n/* eslint-disable regexp/no-useless-quantifier -- testing */\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar regexpFlags = require('../internals/regexp-flags');\nvar stickyHelpers = require('../internals/regexp-sticky-helpers');\nvar shared = require('../internals/shared');\nvar create = require('../internals/object-create');\nvar getInternalState = require('../internals/internal-state').get;\nvar UNSUPPORTED_DOT_ALL = require('../internals/regexp-unsupported-dot-all');\nvar UNSUPPORTED_NCG = require('../internals/regexp-unsupported-ncg');\n\nvar nativeReplace = shared('native-string-replace', String.prototype.replace);\nvar nativeExec = RegExp.prototype.exec;\nvar patchedExec = nativeExec;\nvar charAt = uncurryThis(''.charAt);\nvar indexOf = uncurryThis(''.indexOf);\nvar replace = uncurryThis(''.replace);\nvar stringSlice = uncurryThis(''.slice);\n\nvar UPDATES_LAST_INDEX_WRONG = (function () {\n  var re1 = /a/;\n  var re2 = /b*/g;\n  call(nativeExec, re1, 'a');\n  call(nativeExec, re2, 'a');\n  return re1.lastIndex !== 0 || re2.lastIndex !== 0;\n})();\n\nvar UNSUPPORTED_Y = stickyHelpers.BROKEN_CARET;\n\n// nonparticipating capturing group, copied from es5-shim's String#split patch.\nvar NPCG_INCLUDED = /()??/.exec('')[1] !== undefined;\n\nvar PATCH = UPDATES_LAST_INDEX_WRONG || NPCG_INCLUDED || UNSUPPORTED_Y || UNSUPPORTED_DOT_ALL || UNSUPPORTED_NCG;\n\nif (PATCH) {\n  patchedExec = function exec(string) {\n    var re = this;\n    var state = getInternalState(re);\n    var str = toString(string);\n    var raw = state.raw;\n    var result, reCopy, lastIndex, match, i, object, group;\n\n    if (raw) {\n      raw.lastIndex = re.lastIndex;\n      result = call(patchedExec, raw, str);\n      re.lastIndex = raw.lastIndex;\n      return result;\n    }\n\n    var groups = state.groups;\n    var sticky = UNSUPPORTED_Y && re.sticky;\n    var flags = call(regexpFlags, re);\n    var source = re.source;\n    var charsAdded = 0;\n    var strCopy = str;\n\n    if (sticky) {\n      flags = replace(flags, 'y', '');\n      if (indexOf(flags, 'g') === -1) {\n        flags += 'g';\n      }\n\n      strCopy = stringSlice(str, re.lastIndex);\n      // Support anchored sticky behavior.\n      if (re.lastIndex > 0 && (!re.multiline || re.multiline && charAt(str, re.lastIndex - 1) !== '\\n')) {\n        source = '(?: ' + source + ')';\n        strCopy = ' ' + strCopy;\n        charsAdded++;\n      }\n      // ^(? + rx + ) is needed, in combination with some str slicing, to\n      // simulate the 'y' flag.\n      reCopy = new RegExp('^(?:' + source + ')', flags);\n    }\n\n    if (NPCG_INCLUDED) {\n      reCopy = new RegExp('^' + source + '$(?!\\\\s)', flags);\n    }\n    if (UPDATES_LAST_INDEX_WRONG) lastIndex = re.lastIndex;\n\n    match = call(nativeExec, sticky ? reCopy : re, strCopy);\n\n    if (sticky) {\n      if (match) {\n        match.input = stringSlice(match.input, charsAdded);\n        match[0] = stringSlice(match[0], charsAdded);\n        match.index = re.lastIndex;\n        re.lastIndex += match[0].length;\n      } else re.lastIndex = 0;\n    } else if (UPDATES_LAST_INDEX_WRONG && match) {\n      re.lastIndex = re.global ? match.index + match[0].length : lastIndex;\n    }\n    if (NPCG_INCLUDED && match && match.length > 1) {\n      // Fix browsers whose `exec` methods don't consistently return `undefined`\n      // for NPCG, like IE8. NOTE: This doesn' work for /(.?)?/\n      call(nativeReplace, match[0], reCopy, function () {\n        for (i = 1; i < arguments.length - 2; i++) {\n          if (arguments[i] === undefined) match[i] = undefined;\n        }\n      });\n    }\n\n    if (match && groups) {\n      match.groups = object = create(null);\n      for (i = 0; i < groups.length; i++) {\n        group = groups[i];\n        object[group[0]] = match[group[1]];\n      }\n    }\n\n    return match;\n  };\n}\n\nmodule.exports = patchedExec;\n","var DESCRIPTORS = require('../internals/descriptors');\nvar objectDefinePropertyModule = require('../internals/object-define-property');\nvar regExpFlags = require('../internals/regexp-flags');\nvar fails = require('../internals/fails');\n\nvar RegExpPrototype = RegExp.prototype;\n\nvar FORCED = DESCRIPTORS && fails(function () {\n  // eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\n  return Object.getOwnPropertyDescriptor(RegExpPrototype, 'flags').get.call({ dotAll: true, sticky: true }) !== 'sy';\n});\n\n// `RegExp.prototype.flags` getter\n// https://tc39.es/ecma262/#sec-get-regexp.prototype.flags\nif (FORCED) objectDefinePropertyModule.f(RegExpPrototype, 'flags', {\n  configurable: true,\n  get: regExpFlags\n});\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar redefine = require('../internals/redefine');\nvar anObject = require('../internals/an-object');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar $toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar regExpFlags = require('../internals/regexp-flags');\n\nvar TO_STRING = 'toString';\nvar RegExpPrototype = RegExp.prototype;\nvar n$ToString = RegExpPrototype[TO_STRING];\nvar getFlags = uncurryThis(regExpFlags);\n\nvar NOT_GENERIC = fails(function () { return n$ToString.call({ source: 'a', flags: 'b' }) != '/a/b'; });\n// FF44- RegExp#toString has a wrong name\nvar INCORRECT_NAME = PROPER_FUNCTION_NAME && n$ToString.name != TO_STRING;\n\n// `RegExp.prototype.toString` method\n// https://tc39.es/ecma262/#sec-regexp.prototype.tostring\nif (NOT_GENERIC || INCORRECT_NAME) {\n  redefine(RegExp.prototype, TO_STRING, function toString() {\n    var R = anObject(this);\n    var p = $toString(R.source);\n    var rf = R.flags;\n    var f = $toString(rf === undefined && isPrototypeOf(RegExpPrototype, R) && !('flags' in RegExpPrototype) ? getFlags(R) : rf);\n    return '/' + p + '/' + f;\n  }, { unsafe: true });\n}\n","'use strict';\nvar collection = require('../internals/collection');\nvar collectionStrong = require('../internals/collection-strong');\n\n// `Set` constructor\n// https://tc39.es/ecma262/#sec-set-objects\ncollection('Set', function (init) {\n  return function Set() { return init(this, arguments.length ? arguments[0] : undefined); };\n}, collectionStrong);\n","'use strict';\nvar $ = require('../internals/export');\nvar codeAt = require('../internals/string-multibyte').codeAt;\n\n// `String.prototype.codePointAt` method\n// https://tc39.es/ecma262/#sec-string.prototype.codepointat\n$({ target: 'String', proto: true }, {\n  codePointAt: function codePointAt(pos) {\n    return codeAt(this, pos);\n  }\n});\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toString = require('../internals/to-string');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar charAt = uncurryThis(''.charAt);\nvar charCodeAt = uncurryThis(''.charCodeAt);\nvar stringSlice = uncurryThis(''.slice);\n\nvar createMethod = function (CONVERT_TO_STRING) {\n  return function ($this, pos) {\n    var S = toString(requireObjectCoercible($this));\n    var position = toIntegerOrInfinity(pos);\n    var size = S.length;\n    var first, second;\n    if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;\n    first = charCodeAt(S, position);\n    return first < 0xD800 || first > 0xDBFF || position + 1 === size\n      || (second = charCodeAt(S, position + 1)) < 0xDC00 || second > 0xDFFF\n        ? CONVERT_TO_STRING\n          ? charAt(S, position)\n          : first\n        : CONVERT_TO_STRING\n          ? stringSlice(S, position, position + 2)\n          : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.codePointAt` method\n  // https://tc39.es/ecma262/#sec-string.prototype.codepointat\n  codeAt: createMethod(false),\n  // `String.prototype.at` method\n  // https://github.com/mathiasbynens/String.prototype.at\n  charAt: createMethod(true)\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\nvar IS_PURE = require('../internals/is-pure');\n\n// eslint-disable-next-line es/no-string-prototype-endswith -- safe\nvar un$EndsWith = uncurryThis(''.endsWith);\nvar slice = uncurryThis(''.slice);\nvar min = Math.min;\n\nvar CORRECT_IS_REGEXP_LOGIC = correctIsRegExpLogic('endsWith');\n// https://github.com/zloirock/core-js/pull/702\nvar MDN_POLYFILL_BUG = !IS_PURE && !CORRECT_IS_REGEXP_LOGIC && !!function () {\n  var descriptor = getOwnPropertyDescriptor(String.prototype, 'endsWith');\n  return descriptor && !descriptor.writable;\n}();\n\n// `String.prototype.endsWith` method\n// https://tc39.es/ecma262/#sec-string.prototype.endswith\n$({ target: 'String', proto: true, forced: !MDN_POLYFILL_BUG && !CORRECT_IS_REGEXP_LOGIC }, {\n  endsWith: function endsWith(searchString /* , endPosition = @length */) {\n    var that = toString(requireObjectCoercible(this));\n    notARegExp(searchString);\n    var endPosition = arguments.length > 1 ? arguments[1] : undefined;\n    var len = that.length;\n    var end = endPosition === undefined ? len : min(toLength(endPosition), len);\n    var search = toString(searchString);\n    return un$EndsWith\n      ? un$EndsWith(that, search, end)\n      : slice(that, end - search.length, end) === search;\n  }\n});\n","var global = require('../internals/global');\nvar isRegExp = require('../internals/is-regexp');\n\nvar TypeError = global.TypeError;\n\nmodule.exports = function (it) {\n  if (isRegExp(it)) {\n    throw TypeError(\"The method doesn't accept regular expressions\");\n  } return it;\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\nmodule.exports = function (METHOD_NAME) {\n  var regexp = /./;\n  try {\n    '/./'[METHOD_NAME](regexp);\n  } catch (error1) {\n    try {\n      regexp[MATCH] = false;\n      return '/./'[METHOD_NAME](regexp);\n    } catch (error2) { /* empty */ }\n  } return false;\n};\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\n\nvar RangeError = global.RangeError;\nvar fromCharCode = String.fromCharCode;\n// eslint-disable-next-line es/no-string-fromcodepoint -- required for testing\nvar $fromCodePoint = String.fromCodePoint;\nvar join = uncurryThis([].join);\n\n// length should be 1, old FF problem\nvar INCORRECT_LENGTH = !!$fromCodePoint && $fromCodePoint.length != 1;\n\n// `String.fromCodePoint` method\n// https://tc39.es/ecma262/#sec-string.fromcodepoint\n$({ target: 'String', stat: true, forced: INCORRECT_LENGTH }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  fromCodePoint: function fromCodePoint(x) {\n    var elements = [];\n    var length = arguments.length;\n    var i = 0;\n    var code;\n    while (length > i) {\n      code = +arguments[i++];\n      if (toAbsoluteIndex(code, 0x10FFFF) !== code) throw RangeError(code + ' is not a valid code point');\n      elements[i] = code < 0x10000\n        ? fromCharCode(code)\n        : fromCharCode(((code -= 0x10000) >> 10) + 0xD800, code % 0x400 + 0xDC00);\n    } return join(elements, '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toString = require('../internals/to-string');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\n\nvar stringIndexOf = uncurryThis(''.indexOf);\n\n// `String.prototype.includes` method\n// https://tc39.es/ecma262/#sec-string.prototype.includes\n$({ target: 'String', proto: true, forced: !correctIsRegExpLogic('includes') }, {\n  includes: function includes(searchString /* , position = 0 */) {\n    return !!~stringIndexOf(\n      toString(requireObjectCoercible(this)),\n      toString(notARegExp(searchString)),\n      arguments.length > 1 ? arguments[1] : undefined\n    );\n  }\n});\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\nvar toString = require('../internals/to-string');\nvar InternalStateModule = require('../internals/internal-state');\nvar defineIterator = require('../internals/define-iterator');\n\nvar STRING_ITERATOR = 'String Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(STRING_ITERATOR);\n\n// `String.prototype[@@iterator]` method\n// https://tc39.es/ecma262/#sec-string.prototype-@@iterator\ndefineIterator(String, 'String', function (iterated) {\n  setInternalState(this, {\n    type: STRING_ITERATOR,\n    string: toString(iterated),\n    index: 0\n  });\n// `%StringIteratorPrototype%.next` method\n// https://tc39.es/ecma262/#sec-%stringiteratorprototype%.next\n}, function next() {\n  var state = getInternalState(this);\n  var string = state.string;\n  var index = state.index;\n  var point;\n  if (index >= string.length) return { value: undefined, done: true };\n  point = charAt(string, index);\n  state.index += point.length;\n  return { value: point, done: false };\n});\n","'use strict';\nvar call = require('../internals/function-call');\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar getMethod = require('../internals/get-method');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\n// @@match logic\nfixRegExpWellKnownSymbolLogic('match', function (MATCH, nativeMatch, maybeCallNative) {\n  return [\n    // `String.prototype.match` method\n    // https://tc39.es/ecma262/#sec-string.prototype.match\n    function match(regexp) {\n      var O = requireObjectCoercible(this);\n      var matcher = regexp == undefined ? undefined : getMethod(regexp, MATCH);\n      return matcher ? call(matcher, regexp, O) : new RegExp(regexp)[MATCH](toString(O));\n    },\n    // `RegExp.prototype[@@match]` method\n    // https://tc39.es/ecma262/#sec-regexp.prototype-@@match\n    function (string) {\n      var rx = anObject(this);\n      var S = toString(string);\n      var res = maybeCallNative(nativeMatch, rx, S);\n\n      if (res.done) return res.value;\n\n      if (!rx.global) return regExpExec(rx, S);\n\n      var fullUnicode = rx.unicode;\n      rx.lastIndex = 0;\n      var A = [];\n      var n = 0;\n      var result;\n      while ((result = regExpExec(rx, S)) !== null) {\n        var matchStr = toString(result[0]);\n        A[n] = matchStr;\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n        n++;\n      }\n      return n === 0 ? null : A;\n    }\n  ];\n});\n","'use strict';\n// TODO: Remove from `core-js@4` since it's moved to entry points\nrequire('../modules/es.regexp.exec');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar redefine = require('../internals/redefine');\nvar regexpExec = require('../internals/regexp-exec');\nvar fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nvar SPECIES = wellKnownSymbol('species');\nvar RegExpPrototype = RegExp.prototype;\n\nmodule.exports = function (KEY, exec, FORCED, SHAM) {\n  var SYMBOL = wellKnownSymbol(KEY);\n\n  var DELEGATES_TO_SYMBOL = !fails(function () {\n    // String methods call symbol-named RegEp methods\n    var O = {};\n    O[SYMBOL] = function () { return 7; };\n    return ''[KEY](O) != 7;\n  });\n\n  var DELEGATES_TO_EXEC = DELEGATES_TO_SYMBOL && !fails(function () {\n    // Symbol-named RegExp methods call .exec\n    var execCalled = false;\n    var re = /a/;\n\n    if (KEY === 'split') {\n      // We can't use real regex here since it causes deoptimization\n      // and serious performance degradation in V8\n      // https://github.com/zloirock/core-js/issues/306\n      re = {};\n      // RegExp[@@split] doesn't call the regex's exec method, but first creates\n      // a new one. We need to return the patched regex when creating the new one.\n      re.constructor = {};\n      re.constructor[SPECIES] = function () { return re; };\n      re.flags = '';\n      re[SYMBOL] = /./[SYMBOL];\n    }\n\n    re.exec = function () { execCalled = true; return null; };\n\n    re[SYMBOL]('');\n    return !execCalled;\n  });\n\n  if (\n    !DELEGATES_TO_SYMBOL ||\n    !DELEGATES_TO_EXEC ||\n    FORCED\n  ) {\n    var uncurriedNativeRegExpMethod = uncurryThis(/./[SYMBOL]);\n    var methods = exec(SYMBOL, ''[KEY], function (nativeMethod, regexp, str, arg2, forceStringMethod) {\n      var uncurriedNativeMethod = uncurryThis(nativeMethod);\n      var $exec = regexp.exec;\n      if ($exec === regexpExec || $exec === RegExpPrototype.exec) {\n        if (DELEGATES_TO_SYMBOL && !forceStringMethod) {\n          // The native String method already delegates to @@method (this\n          // polyfilled function), leasing to infinite recursion.\n          // We avoid it by directly calling the native @@method method.\n          return { done: true, value: uncurriedNativeRegExpMethod(regexp, str, arg2) };\n        }\n        return { done: true, value: uncurriedNativeMethod(str, regexp, arg2) };\n      }\n      return { done: false };\n    });\n\n    redefine(String.prototype, KEY, methods[0]);\n    redefine(RegExpPrototype, SYMBOL, methods[1]);\n  }\n\n  if (SHAM) createNonEnumerableProperty(RegExpPrototype[SYMBOL], 'sham', true);\n};\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\n\n// `AdvanceStringIndex` abstract operation\n// https://tc39.es/ecma262/#sec-advancestringindex\nmodule.exports = function (S, index, unicode) {\n  return index + (unicode ? charAt(S, index).length : 1);\n};\n","var global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar isCallable = require('../internals/is-callable');\nvar classof = require('../internals/classof-raw');\nvar regexpExec = require('../internals/regexp-exec');\n\nvar TypeError = global.TypeError;\n\n// `RegExpExec` abstract operation\n// https://tc39.es/ecma262/#sec-regexpexec\nmodule.exports = function (R, S) {\n  var exec = R.exec;\n  if (isCallable(exec)) {\n    var result = call(exec, R, S);\n    if (result !== null) anObject(result);\n    return result;\n  }\n  if (classof(R) === 'RegExp') return call(regexpExec, R, S);\n  throw TypeError('RegExp#exec called on incompatible receiver');\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $padEnd = require('../internals/string-pad').end;\nvar WEBKIT_BUG = require('../internals/string-pad-webkit-bug');\n\n// `String.prototype.padEnd` method\n// https://tc39.es/ecma262/#sec-string.prototype.padend\n$({ target: 'String', proto: true, forced: WEBKIT_BUG }, {\n  padEnd: function padEnd(maxLength /* , fillString = ' ' */) {\n    return $padEnd(this, maxLength, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","// https://github.com/tc39/proposal-string-pad-start-end\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar $repeat = require('../internals/string-repeat');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar repeat = uncurryThis($repeat);\nvar stringSlice = uncurryThis(''.slice);\nvar ceil = Math.ceil;\n\n// `String.prototype.{ padStart, padEnd }` methods implementation\nvar createMethod = function (IS_END) {\n  return function ($this, maxLength, fillString) {\n    var S = toString(requireObjectCoercible($this));\n    var intMaxLength = toLength(maxLength);\n    var stringLength = S.length;\n    var fillStr = fillString === undefined ? ' ' : toString(fillString);\n    var fillLen, stringFiller;\n    if (intMaxLength <= stringLength || fillStr == '') return S;\n    fillLen = intMaxLength - stringLength;\n    stringFiller = repeat(fillStr, ceil(fillLen / fillStr.length));\n    if (stringFiller.length > fillLen) stringFiller = stringSlice(stringFiller, 0, fillLen);\n    return IS_END ? S + stringFiller : stringFiller + S;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.padStart` method\n  // https://tc39.es/ecma262/#sec-string.prototype.padstart\n  start: createMethod(false),\n  // `String.prototype.padEnd` method\n  // https://tc39.es/ecma262/#sec-string.prototype.padend\n  end: createMethod(true)\n};\n","// https://github.com/zloirock/core-js/issues/280\nvar userAgent = require('../internals/engine-user-agent');\n\nmodule.exports = /Version\\/10(?:\\.\\d+){1,2}(?: [\\w./]+)?(?: Mobile\\/\\w+)? Safari\\//.test(userAgent);\n","'use strict';\nvar $ = require('../internals/export');\nvar $padStart = require('../internals/string-pad').start;\nvar WEBKIT_BUG = require('../internals/string-pad-webkit-bug');\n\n// `String.prototype.padStart` method\n// https://tc39.es/ecma262/#sec-string.prototype.padstart\n$({ target: 'String', proto: true, forced: WEBKIT_BUG }, {\n  padStart: function padStart(maxLength /* , fillString = ' ' */) {\n    return $padStart(this, maxLength, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","var $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toObject = require('../internals/to-object');\nvar toString = require('../internals/to-string');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\nvar push = uncurryThis([].push);\nvar join = uncurryThis([].join);\n\n// `String.raw` method\n// https://tc39.es/ecma262/#sec-string.raw\n$({ target: 'String', stat: true }, {\n  raw: function raw(template) {\n    var rawTemplate = toIndexedObject(toObject(template).raw);\n    var literalSegments = lengthOfArrayLike(rawTemplate);\n    var argumentsLength = arguments.length;\n    var elements = [];\n    var i = 0;\n    while (literalSegments > i) {\n      push(elements, toString(rawTemplate[i++]));\n      if (i === literalSegments) return join(elements, '');\n      if (i < argumentsLength) push(elements, toString(arguments[i]));\n    }\n  }\n});\n","var $ = require('../internals/export');\nvar repeat = require('../internals/string-repeat');\n\n// `String.prototype.repeat` method\n// https://tc39.es/ecma262/#sec-string.prototype.repeat\n$({ target: 'String', proto: true }, {\n  repeat: repeat\n});\n","'use strict';\nvar apply = require('../internals/function-apply');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar fails = require('../internals/fails');\nvar anObject = require('../internals/an-object');\nvar isCallable = require('../internals/is-callable');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar getMethod = require('../internals/get-method');\nvar getSubstitution = require('../internals/get-substitution');\nvar regExpExec = require('../internals/regexp-exec-abstract');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar REPLACE = wellKnownSymbol('replace');\nvar max = Math.max;\nvar min = Math.min;\nvar concat = uncurryThis([].concat);\nvar push = uncurryThis([].push);\nvar stringIndexOf = uncurryThis(''.indexOf);\nvar stringSlice = uncurryThis(''.slice);\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// IE <= 11 replaces $0 with the whole match, as if it was $&\n// https://stackoverflow.com/questions/6024666/getting-ie-to-replace-a-regex-with-the-literal-string-0\nvar REPLACE_KEEPS_$0 = (function () {\n  // eslint-disable-next-line regexp/prefer-escape-replacement-dollar-char -- required for testing\n  return 'a'.replace(/./, '$0') === '$0';\n})();\n\n// Safari <= 13.0.3(?) substitutes nth capture where n>m with an empty string\nvar REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE = (function () {\n  if (/./[REPLACE]) {\n    return /./[REPLACE]('a', '$0') === '';\n  }\n  return false;\n})();\n\nvar REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {\n  var re = /./;\n  re.exec = function () {\n    var result = [];\n    result.groups = { a: '7' };\n    return result;\n  };\n  // eslint-disable-next-line regexp/no-useless-dollar-replacements -- false positive\n  return ''.replace(re, '$<a>') !== '7';\n});\n\n// @@replace logic\nfixRegExpWellKnownSymbolLogic('replace', function (_, nativeReplace, maybeCallNative) {\n  var UNSAFE_SUBSTITUTE = REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE ? '$' : '$0';\n\n  return [\n    // `String.prototype.replace` method\n    // https://tc39.es/ecma262/#sec-string.prototype.replace\n    function replace(searchValue, replaceValue) {\n      var O = requireObjectCoercible(this);\n      var replacer = searchValue == undefined ? undefined : getMethod(searchValue, REPLACE);\n      return replacer\n        ? call(replacer, searchValue, O, replaceValue)\n        : call(nativeReplace, toString(O), searchValue, replaceValue);\n    },\n    // `RegExp.prototype[@@replace]` method\n    // https://tc39.es/ecma262/#sec-regexp.prototype-@@replace\n    function (string, replaceValue) {\n      var rx = anObject(this);\n      var S = toString(string);\n\n      if (\n        typeof replaceValue == 'string' &&\n        stringIndexOf(replaceValue, UNSAFE_SUBSTITUTE) === -1 &&\n        stringIndexOf(replaceValue, '$<') === -1\n      ) {\n        var res = maybeCallNative(nativeReplace, rx, S, replaceValue);\n        if (res.done) return res.value;\n      }\n\n      var functionalReplace = isCallable(replaceValue);\n      if (!functionalReplace) replaceValue = toString(replaceValue);\n\n      var global = rx.global;\n      if (global) {\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n      }\n      var results = [];\n      while (true) {\n        var result = regExpExec(rx, S);\n        if (result === null) break;\n\n        push(results, result);\n        if (!global) break;\n\n        var matchStr = toString(result[0]);\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n      }\n\n      var accumulatedResult = '';\n      var nextSourcePosition = 0;\n      for (var i = 0; i < results.length; i++) {\n        result = results[i];\n\n        var matched = toString(result[0]);\n        var position = max(min(toIntegerOrInfinity(result.index), S.length), 0);\n        var captures = [];\n        // NOTE: This is equivalent to\n        //   captures = result.slice(1).map(maybeToString)\n        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n        // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n        for (var j = 1; j < result.length; j++) push(captures, maybeToString(result[j]));\n        var namedCaptures = result.groups;\n        if (functionalReplace) {\n          var replacerArgs = concat([matched], captures, position, S);\n          if (namedCaptures !== undefined) push(replacerArgs, namedCaptures);\n          var replacement = toString(apply(replaceValue, undefined, replacerArgs));\n        } else {\n          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n        }\n        if (position >= nextSourcePosition) {\n          accumulatedResult += stringSlice(S, nextSourcePosition, position) + replacement;\n          nextSourcePosition = position + matched.length;\n        }\n      }\n      return accumulatedResult + stringSlice(S, nextSourcePosition);\n    }\n  ];\n}, !REPLACE_SUPPORTS_NAMED_GROUPS || !REPLACE_KEEPS_$0 || REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE);\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar toObject = require('../internals/to-object');\n\nvar floor = Math.floor;\nvar charAt = uncurryThis(''.charAt);\nvar replace = uncurryThis(''.replace);\nvar stringSlice = uncurryThis(''.slice);\nvar SUBSTITUTION_SYMBOLS = /\\$([$&'`]|\\d{1,2}|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&'`]|\\d{1,2})/g;\n\n// `GetSubstitution` abstract operation\n// https://tc39.es/ecma262/#sec-getsubstitution\nmodule.exports = function (matched, str, position, captures, namedCaptures, replacement) {\n  var tailPos = position + matched.length;\n  var m = captures.length;\n  var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n  if (namedCaptures !== undefined) {\n    namedCaptures = toObject(namedCaptures);\n    symbols = SUBSTITUTION_SYMBOLS;\n  }\n  return replace(replacement, symbols, function (match, ch) {\n    var capture;\n    switch (charAt(ch, 0)) {\n      case '$': return '$';\n      case '&': return matched;\n      case '`': return stringSlice(str, 0, position);\n      case \"'\": return stringSlice(str, tailPos);\n      case '<':\n        capture = namedCaptures[stringSlice(ch, 1, -1)];\n        break;\n      default: // \\d\\d?\n        var n = +ch;\n        if (n === 0) return match;\n        if (n > m) {\n          var f = floor(n / 10);\n          if (f === 0) return match;\n          if (f <= m) return captures[f - 1] === undefined ? charAt(ch, 1) : captures[f - 1] + charAt(ch, 1);\n          return match;\n        }\n        capture = captures[n - 1];\n    }\n    return capture === undefined ? '' : capture;\n  });\n};\n","'use strict';\nvar call = require('../internals/function-call');\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar sameValue = require('../internals/same-value');\nvar toString = require('../internals/to-string');\nvar getMethod = require('../internals/get-method');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\n// @@search logic\nfixRegExpWellKnownSymbolLogic('search', function (SEARCH, nativeSearch, maybeCallNative) {\n  return [\n    // `String.prototype.search` method\n    // https://tc39.es/ecma262/#sec-string.prototype.search\n    function search(regexp) {\n      var O = requireObjectCoercible(this);\n      var searcher = regexp == undefined ? undefined : getMethod(regexp, SEARCH);\n      return searcher ? call(searcher, regexp, O) : new RegExp(regexp)[SEARCH](toString(O));\n    },\n    // `RegExp.prototype[@@search]` method\n    // https://tc39.es/ecma262/#sec-regexp.prototype-@@search\n    function (string) {\n      var rx = anObject(this);\n      var S = toString(string);\n      var res = maybeCallNative(nativeSearch, rx, S);\n\n      if (res.done) return res.value;\n\n      var previousLastIndex = rx.lastIndex;\n      if (!sameValue(previousLastIndex, 0)) rx.lastIndex = 0;\n      var result = regExpExec(rx, S);\n      if (!sameValue(rx.lastIndex, previousLastIndex)) rx.lastIndex = previousLastIndex;\n      return result === null ? -1 : result.index;\n    }\n  ];\n});\n","'use strict';\nvar apply = require('../internals/function-apply');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar isRegExp = require('../internals/is-regexp');\nvar anObject = require('../internals/an-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar speciesConstructor = require('../internals/species-constructor');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar getMethod = require('../internals/get-method');\nvar arraySlice = require('../internals/array-slice-simple');\nvar callRegExpExec = require('../internals/regexp-exec-abstract');\nvar regexpExec = require('../internals/regexp-exec');\nvar stickyHelpers = require('../internals/regexp-sticky-helpers');\nvar fails = require('../internals/fails');\n\nvar UNSUPPORTED_Y = stickyHelpers.UNSUPPORTED_Y;\nvar MAX_UINT32 = 0xFFFFFFFF;\nvar min = Math.min;\nvar $push = [].push;\nvar exec = uncurryThis(/./.exec);\nvar push = uncurryThis($push);\nvar stringSlice = uncurryThis(''.slice);\n\n// Chrome 51 has a buggy \"split\" implementation when RegExp#exec !== nativeExec\n// Weex JS has frozen built-in prototypes, so use try / catch wrapper\nvar SPLIT_WORKS_WITH_OVERWRITTEN_EXEC = !fails(function () {\n  // eslint-disable-next-line regexp/no-empty-group -- required for testing\n  var re = /(?:)/;\n  var originalExec = re.exec;\n  re.exec = function () { return originalExec.apply(this, arguments); };\n  var result = 'ab'.split(re);\n  return result.length !== 2 || result[0] !== 'a' || result[1] !== 'b';\n});\n\n// @@split logic\nfixRegExpWellKnownSymbolLogic('split', function (SPLIT, nativeSplit, maybeCallNative) {\n  var internalSplit;\n  if (\n    'abbc'.split(/(b)*/)[1] == 'c' ||\n    // eslint-disable-next-line regexp/no-empty-group -- required for testing\n    'test'.split(/(?:)/, -1).length != 4 ||\n    'ab'.split(/(?:ab)*/).length != 2 ||\n    '.'.split(/(.?)(.?)/).length != 4 ||\n    // eslint-disable-next-line regexp/no-empty-capturing-group, regexp/no-empty-group -- required for testing\n    '.'.split(/()()/).length > 1 ||\n    ''.split(/.?/).length\n  ) {\n    // based on es5-shim implementation, need to rework it\n    internalSplit = function (separator, limit) {\n      var string = toString(requireObjectCoercible(this));\n      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      if (lim === 0) return [];\n      if (separator === undefined) return [string];\n      // If `separator` is not a regex, use native split\n      if (!isRegExp(separator)) {\n        return call(nativeSplit, string, separator, lim);\n      }\n      var output = [];\n      var flags = (separator.ignoreCase ? 'i' : '') +\n                  (separator.multiline ? 'm' : '') +\n                  (separator.unicode ? 'u' : '') +\n                  (separator.sticky ? 'y' : '');\n      var lastLastIndex = 0;\n      // Make `global` and avoid `lastIndex` issues by working with a copy\n      var separatorCopy = new RegExp(separator.source, flags + 'g');\n      var match, lastIndex, lastLength;\n      while (match = call(regexpExec, separatorCopy, string)) {\n        lastIndex = separatorCopy.lastIndex;\n        if (lastIndex > lastLastIndex) {\n          push(output, stringSlice(string, lastLastIndex, match.index));\n          if (match.length > 1 && match.index < string.length) apply($push, output, arraySlice(match, 1));\n          lastLength = match[0].length;\n          lastLastIndex = lastIndex;\n          if (output.length >= lim) break;\n        }\n        if (separatorCopy.lastIndex === match.index) separatorCopy.lastIndex++; // Avoid an infinite loop\n      }\n      if (lastLastIndex === string.length) {\n        if (lastLength || !exec(separatorCopy, '')) push(output, '');\n      } else push(output, stringSlice(string, lastLastIndex));\n      return output.length > lim ? arraySlice(output, 0, lim) : output;\n    };\n  // Chakra, V8\n  } else if ('0'.split(undefined, 0).length) {\n    internalSplit = function (separator, limit) {\n      return separator === undefined && limit === 0 ? [] : call(nativeSplit, this, separator, limit);\n    };\n  } else internalSplit = nativeSplit;\n\n  return [\n    // `String.prototype.split` method\n    // https://tc39.es/ecma262/#sec-string.prototype.split\n    function split(separator, limit) {\n      var O = requireObjectCoercible(this);\n      var splitter = separator == undefined ? undefined : getMethod(separator, SPLIT);\n      return splitter\n        ? call(splitter, separator, O, limit)\n        : call(internalSplit, toString(O), separator, limit);\n    },\n    // `RegExp.prototype[@@split]` method\n    // https://tc39.es/ecma262/#sec-regexp.prototype-@@split\n    //\n    // NOTE: This cannot be properly polyfilled in engines that don't support\n    // the 'y' flag.\n    function (string, limit) {\n      var rx = anObject(this);\n      var S = toString(string);\n      var res = maybeCallNative(internalSplit, rx, S, limit, internalSplit !== nativeSplit);\n\n      if (res.done) return res.value;\n\n      var C = speciesConstructor(rx, RegExp);\n\n      var unicodeMatching = rx.unicode;\n      var flags = (rx.ignoreCase ? 'i' : '') +\n                  (rx.multiline ? 'm' : '') +\n                  (rx.unicode ? 'u' : '') +\n                  (UNSUPPORTED_Y ? 'g' : 'y');\n\n      // ^(? + rx + ) is needed, in combination with some S slicing, to\n      // simulate the 'y' flag.\n      var splitter = new C(UNSUPPORTED_Y ? '^(?:' + rx.source + ')' : rx, flags);\n      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      if (lim === 0) return [];\n      if (S.length === 0) return callRegExpExec(splitter, S) === null ? [S] : [];\n      var p = 0;\n      var q = 0;\n      var A = [];\n      while (q < S.length) {\n        splitter.lastIndex = UNSUPPORTED_Y ? 0 : q;\n        var z = callRegExpExec(splitter, UNSUPPORTED_Y ? stringSlice(S, q) : S);\n        var e;\n        if (\n          z === null ||\n          (e = min(toLength(splitter.lastIndex + (UNSUPPORTED_Y ? q : 0)), S.length)) === p\n        ) {\n          q = advanceStringIndex(S, q, unicodeMatching);\n        } else {\n          push(A, stringSlice(S, p, q));\n          if (A.length === lim) return A;\n          for (var i = 1; i <= z.length - 1; i++) {\n            push(A, z[i]);\n            if (A.length === lim) return A;\n          }\n          q = p = e;\n        }\n      }\n      push(A, stringSlice(S, p));\n      return A;\n    }\n  ];\n}, !SPLIT_WORKS_WITH_OVERWRITTEN_EXEC, UNSUPPORTED_Y);\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\nvar IS_PURE = require('../internals/is-pure');\n\n// eslint-disable-next-line es/no-string-prototype-startswith -- safe\nvar un$StartsWith = uncurryThis(''.startsWith);\nvar stringSlice = uncurryThis(''.slice);\nvar min = Math.min;\n\nvar CORRECT_IS_REGEXP_LOGIC = correctIsRegExpLogic('startsWith');\n// https://github.com/zloirock/core-js/pull/702\nvar MDN_POLYFILL_BUG = !IS_PURE && !CORRECT_IS_REGEXP_LOGIC && !!function () {\n  var descriptor = getOwnPropertyDescriptor(String.prototype, 'startsWith');\n  return descriptor && !descriptor.writable;\n}();\n\n// `String.prototype.startsWith` method\n// https://tc39.es/ecma262/#sec-string.prototype.startswith\n$({ target: 'String', proto: true, forced: !MDN_POLYFILL_BUG && !CORRECT_IS_REGEXP_LOGIC }, {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = toString(requireObjectCoercible(this));\n    notARegExp(searchString);\n    var index = toLength(min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = toString(searchString);\n    return un$StartsWith\n      ? un$StartsWith(that, search, index)\n      : stringSlice(that, index, index + search.length) === search;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.es/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n","var PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]()\n      || non[METHOD_NAME]() !== non\n      || (PROPER_FUNCTION_NAME && whitespaces[METHOD_NAME].name !== METHOD_NAME);\n  });\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $trimEnd = require('../internals/string-trim').end;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\nvar FORCED = forcedStringTrimMethod('trimEnd');\n\nvar trimEnd = FORCED ? function trimEnd() {\n  return $trimEnd(this);\n// eslint-disable-next-line es/no-string-prototype-trimstart-trimend -- safe\n} : ''.trimEnd;\n\n// `String.prototype.{ trimEnd, trimRight }` methods\n// https://tc39.es/ecma262/#sec-string.prototype.trimend\n// https://tc39.es/ecma262/#String.prototype.trimright\n$({ target: 'String', proto: true, name: 'trimEnd', forced: FORCED }, {\n  trimEnd: trimEnd,\n  trimRight: trimEnd\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $trimStart = require('../internals/string-trim').start;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\nvar FORCED = forcedStringTrimMethod('trimStart');\n\nvar trimStart = FORCED ? function trimStart() {\n  return $trimStart(this);\n// eslint-disable-next-line es/no-string-prototype-trimstart-trimend -- safe\n} : ''.trimStart;\n\n// `String.prototype.{ trimStart, trimLeft }` methods\n// https://tc39.es/ecma262/#sec-string.prototype.trimstart\n// https://tc39.es/ecma262/#String.prototype.trimleft\n$({ target: 'String', proto: true, name: 'trimStart', forced: FORCED }, {\n  trimStart: trimStart,\n  trimLeft: trimStart\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.anchor` method\n// https://tc39.es/ecma262/#sec-string.prototype.anchor\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('anchor') }, {\n  anchor: function anchor(name) {\n    return createHTML(this, 'a', 'name', name);\n  }\n});\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toString = require('../internals/to-string');\n\nvar quot = /\"/g;\nvar replace = uncurryThis(''.replace);\n\n// `CreateHTML` abstract operation\n// https://tc39.es/ecma262/#sec-createhtml\nmodule.exports = function (string, tag, attribute, value) {\n  var S = toString(requireObjectCoercible(string));\n  var p1 = '<' + tag;\n  if (attribute !== '') p1 += ' ' + attribute + '=\"' + replace(toString(value), quot, '&quot;') + '\"';\n  return p1 + '>' + S + '</' + tag + '>';\n};\n","var fails = require('../internals/fails');\n\n// check the existence of a method, lowercase\n// of a tag and escaping quotes in arguments\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    var test = ''[METHOD_NAME]('\"');\n    return test !== test.toLowerCase() || test.split('\"').length > 3;\n  });\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.big` method\n// https://tc39.es/ecma262/#sec-string.prototype.big\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('big') }, {\n  big: function big() {\n    return createHTML(this, 'big', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.blink` method\n// https://tc39.es/ecma262/#sec-string.prototype.blink\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('blink') }, {\n  blink: function blink() {\n    return createHTML(this, 'blink', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.bold` method\n// https://tc39.es/ecma262/#sec-string.prototype.bold\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('bold') }, {\n  bold: function bold() {\n    return createHTML(this, 'b', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.fixed` method\n// https://tc39.es/ecma262/#sec-string.prototype.fixed\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('fixed') }, {\n  fixed: function fixed() {\n    return createHTML(this, 'tt', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.fontcolor` method\n// https://tc39.es/ecma262/#sec-string.prototype.fontcolor\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('fontcolor') }, {\n  fontcolor: function fontcolor(color) {\n    return createHTML(this, 'font', 'color', color);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.fontsize` method\n// https://tc39.es/ecma262/#sec-string.prototype.fontsize\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('fontsize') }, {\n  fontsize: function fontsize(size) {\n    return createHTML(this, 'font', 'size', size);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.italics` method\n// https://tc39.es/ecma262/#sec-string.prototype.italics\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('italics') }, {\n  italics: function italics() {\n    return createHTML(this, 'i', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.link` method\n// https://tc39.es/ecma262/#sec-string.prototype.link\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('link') }, {\n  link: function link(url) {\n    return createHTML(this, 'a', 'href', url);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.small` method\n// https://tc39.es/ecma262/#sec-string.prototype.small\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('small') }, {\n  small: function small() {\n    return createHTML(this, 'small', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.strike` method\n// https://tc39.es/ecma262/#sec-string.prototype.strike\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('strike') }, {\n  strike: function strike() {\n    return createHTML(this, 'strike', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.sub` method\n// https://tc39.es/ecma262/#sec-string.prototype.sub\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('sub') }, {\n  sub: function sub() {\n    return createHTML(this, 'sub', '', '');\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.sup` method\n// https://tc39.es/ecma262/#sec-string.prototype.sup\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('sup') }, {\n  sup: function sup() {\n    return createHTML(this, 'sup', '', '');\n  }\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Float32Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Float32', function (init) {\n  return function Float32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS = require('../internals/typed-array-constructors-require-wrappers');\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar ArrayBufferModule = require('../internals/array-buffer');\nvar anInstance = require('../internals/an-instance');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar isIntegralNumber = require('../internals/is-integral-number');\nvar toLength = require('../internals/to-length');\nvar toIndex = require('../internals/to-index');\nvar toOffset = require('../internals/to-offset');\nvar toPropertyKey = require('../internals/to-property-key');\nvar hasOwn = require('../internals/has-own-property');\nvar classof = require('../internals/classof');\nvar isObject = require('../internals/is-object');\nvar isSymbol = require('../internals/is-symbol');\nvar create = require('../internals/object-create');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar typedArrayFrom = require('../internals/typed-array-from');\nvar forEach = require('../internals/array-iteration').forEach;\nvar setSpecies = require('../internals/set-species');\nvar definePropertyModule = require('../internals/object-define-property');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar InternalStateModule = require('../internals/internal-state');\nvar inheritIfRequired = require('../internals/inherit-if-required');\n\nvar getInternalState = InternalStateModule.get;\nvar setInternalState = InternalStateModule.set;\nvar nativeDefineProperty = definePropertyModule.f;\nvar nativeGetOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\nvar round = Math.round;\nvar RangeError = global.RangeError;\nvar ArrayBuffer = ArrayBufferModule.ArrayBuffer;\nvar ArrayBufferPrototype = ArrayBuffer.prototype;\nvar DataView = ArrayBufferModule.DataView;\nvar NATIVE_ARRAY_BUFFER_VIEWS = ArrayBufferViewCore.NATIVE_ARRAY_BUFFER_VIEWS;\nvar TYPED_ARRAY_CONSTRUCTOR = ArrayBufferViewCore.TYPED_ARRAY_CONSTRUCTOR;\nvar TYPED_ARRAY_TAG = ArrayBufferViewCore.TYPED_ARRAY_TAG;\nvar TypedArray = ArrayBufferViewCore.TypedArray;\nvar TypedArrayPrototype = ArrayBufferViewCore.TypedArrayPrototype;\nvar aTypedArrayConstructor = ArrayBufferViewCore.aTypedArrayConstructor;\nvar isTypedArray = ArrayBufferViewCore.isTypedArray;\nvar BYTES_PER_ELEMENT = 'BYTES_PER_ELEMENT';\nvar WRONG_LENGTH = 'Wrong length';\n\nvar fromList = function (C, list) {\n  aTypedArrayConstructor(C);\n  var index = 0;\n  var length = list.length;\n  var result = new C(length);\n  while (length > index) result[index] = list[index++];\n  return result;\n};\n\nvar addGetter = function (it, key) {\n  nativeDefineProperty(it, key, { get: function () {\n    return getInternalState(this)[key];\n  } });\n};\n\nvar isArrayBuffer = function (it) {\n  var klass;\n  return isPrototypeOf(ArrayBufferPrototype, it) || (klass = classof(it)) == 'ArrayBuffer' || klass == 'SharedArrayBuffer';\n};\n\nvar isTypedArrayIndex = function (target, key) {\n  return isTypedArray(target)\n    && !isSymbol(key)\n    && key in target\n    && isIntegralNumber(+key)\n    && key >= 0;\n};\n\nvar wrappedGetOwnPropertyDescriptor = function getOwnPropertyDescriptor(target, key) {\n  key = toPropertyKey(key);\n  return isTypedArrayIndex(target, key)\n    ? createPropertyDescriptor(2, target[key])\n    : nativeGetOwnPropertyDescriptor(target, key);\n};\n\nvar wrappedDefineProperty = function defineProperty(target, key, descriptor) {\n  key = toPropertyKey(key);\n  if (isTypedArrayIndex(target, key)\n    && isObject(descriptor)\n    && hasOwn(descriptor, 'value')\n    && !hasOwn(descriptor, 'get')\n    && !hasOwn(descriptor, 'set')\n    // TODO: add validation descriptor w/o calling accessors\n    && !descriptor.configurable\n    && (!hasOwn(descriptor, 'writable') || descriptor.writable)\n    && (!hasOwn(descriptor, 'enumerable') || descriptor.enumerable)\n  ) {\n    target[key] = descriptor.value;\n    return target;\n  } return nativeDefineProperty(target, key, descriptor);\n};\n\nif (DESCRIPTORS) {\n  if (!NATIVE_ARRAY_BUFFER_VIEWS) {\n    getOwnPropertyDescriptorModule.f = wrappedGetOwnPropertyDescriptor;\n    definePropertyModule.f = wrappedDefineProperty;\n    addGetter(TypedArrayPrototype, 'buffer');\n    addGetter(TypedArrayPrototype, 'byteOffset');\n    addGetter(TypedArrayPrototype, 'byteLength');\n    addGetter(TypedArrayPrototype, 'length');\n  }\n\n  $({ target: 'Object', stat: true, forced: !NATIVE_ARRAY_BUFFER_VIEWS }, {\n    getOwnPropertyDescriptor: wrappedGetOwnPropertyDescriptor,\n    defineProperty: wrappedDefineProperty\n  });\n\n  module.exports = function (TYPE, wrapper, CLAMPED) {\n    var BYTES = TYPE.match(/\\d+$/)[0] / 8;\n    var CONSTRUCTOR_NAME = TYPE + (CLAMPED ? 'Clamped' : '') + 'Array';\n    var GETTER = 'get' + TYPE;\n    var SETTER = 'set' + TYPE;\n    var NativeTypedArrayConstructor = global[CONSTRUCTOR_NAME];\n    var TypedArrayConstructor = NativeTypedArrayConstructor;\n    var TypedArrayConstructorPrototype = TypedArrayConstructor && TypedArrayConstructor.prototype;\n    var exported = {};\n\n    var getter = function (that, index) {\n      var data = getInternalState(that);\n      return data.view[GETTER](index * BYTES + data.byteOffset, true);\n    };\n\n    var setter = function (that, index, value) {\n      var data = getInternalState(that);\n      if (CLAMPED) value = (value = round(value)) < 0 ? 0 : value > 0xFF ? 0xFF : value & 0xFF;\n      data.view[SETTER](index * BYTES + data.byteOffset, value, true);\n    };\n\n    var addElement = function (that, index) {\n      nativeDefineProperty(that, index, {\n        get: function () {\n          return getter(this, index);\n        },\n        set: function (value) {\n          return setter(this, index, value);\n        },\n        enumerable: true\n      });\n    };\n\n    if (!NATIVE_ARRAY_BUFFER_VIEWS) {\n      TypedArrayConstructor = wrapper(function (that, data, offset, $length) {\n        anInstance(that, TypedArrayConstructorPrototype);\n        var index = 0;\n        var byteOffset = 0;\n        var buffer, byteLength, length;\n        if (!isObject(data)) {\n          length = toIndex(data);\n          byteLength = length * BYTES;\n          buffer = new ArrayBuffer(byteLength);\n        } else if (isArrayBuffer(data)) {\n          buffer = data;\n          byteOffset = toOffset(offset, BYTES);\n          var $len = data.byteLength;\n          if ($length === undefined) {\n            if ($len % BYTES) throw RangeError(WRONG_LENGTH);\n            byteLength = $len - byteOffset;\n            if (byteLength < 0) throw RangeError(WRONG_LENGTH);\n          } else {\n            byteLength = toLength($length) * BYTES;\n            if (byteLength + byteOffset > $len) throw RangeError(WRONG_LENGTH);\n          }\n          length = byteLength / BYTES;\n        } else if (isTypedArray(data)) {\n          return fromList(TypedArrayConstructor, data);\n        } else {\n          return call(typedArrayFrom, TypedArrayConstructor, data);\n        }\n        setInternalState(that, {\n          buffer: buffer,\n          byteOffset: byteOffset,\n          byteLength: byteLength,\n          length: length,\n          view: new DataView(buffer)\n        });\n        while (index < length) addElement(that, index++);\n      });\n\n      if (setPrototypeOf) setPrototypeOf(TypedArrayConstructor, TypedArray);\n      TypedArrayConstructorPrototype = TypedArrayConstructor.prototype = create(TypedArrayPrototype);\n    } else if (TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS) {\n      TypedArrayConstructor = wrapper(function (dummy, data, typedArrayOffset, $length) {\n        anInstance(dummy, TypedArrayConstructorPrototype);\n        return inheritIfRequired(function () {\n          if (!isObject(data)) return new NativeTypedArrayConstructor(toIndex(data));\n          if (isArrayBuffer(data)) return $length !== undefined\n            ? new NativeTypedArrayConstructor(data, toOffset(typedArrayOffset, BYTES), $length)\n            : typedArrayOffset !== undefined\n              ? new NativeTypedArrayConstructor(data, toOffset(typedArrayOffset, BYTES))\n              : new NativeTypedArrayConstructor(data);\n          if (isTypedArray(data)) return fromList(TypedArrayConstructor, data);\n          return call(typedArrayFrom, TypedArrayConstructor, data);\n        }(), dummy, TypedArrayConstructor);\n      });\n\n      if (setPrototypeOf) setPrototypeOf(TypedArrayConstructor, TypedArray);\n      forEach(getOwnPropertyNames(NativeTypedArrayConstructor), function (key) {\n        if (!(key in TypedArrayConstructor)) {\n          createNonEnumerableProperty(TypedArrayConstructor, key, NativeTypedArrayConstructor[key]);\n        }\n      });\n      TypedArrayConstructor.prototype = TypedArrayConstructorPrototype;\n    }\n\n    if (TypedArrayConstructorPrototype.constructor !== TypedArrayConstructor) {\n      createNonEnumerableProperty(TypedArrayConstructorPrototype, 'constructor', TypedArrayConstructor);\n    }\n\n    createNonEnumerableProperty(TypedArrayConstructorPrototype, TYPED_ARRAY_CONSTRUCTOR, TypedArrayConstructor);\n\n    if (TYPED_ARRAY_TAG) {\n      createNonEnumerableProperty(TypedArrayConstructorPrototype, TYPED_ARRAY_TAG, CONSTRUCTOR_NAME);\n    }\n\n    exported[CONSTRUCTOR_NAME] = TypedArrayConstructor;\n\n    $({\n      global: true, forced: TypedArrayConstructor != NativeTypedArrayConstructor, sham: !NATIVE_ARRAY_BUFFER_VIEWS\n    }, exported);\n\n    if (!(BYTES_PER_ELEMENT in TypedArrayConstructor)) {\n      createNonEnumerableProperty(TypedArrayConstructor, BYTES_PER_ELEMENT, BYTES);\n    }\n\n    if (!(BYTES_PER_ELEMENT in TypedArrayConstructorPrototype)) {\n      createNonEnumerableProperty(TypedArrayConstructorPrototype, BYTES_PER_ELEMENT, BYTES);\n    }\n\n    setSpecies(CONSTRUCTOR_NAME);\n  };\n} else module.exports = function () { /* empty */ };\n","/* eslint-disable no-new -- required for testing */\nvar global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar NATIVE_ARRAY_BUFFER_VIEWS = require('../internals/array-buffer-view-core').NATIVE_ARRAY_BUFFER_VIEWS;\n\nvar ArrayBuffer = global.ArrayBuffer;\nvar Int8Array = global.Int8Array;\n\nmodule.exports = !NATIVE_ARRAY_BUFFER_VIEWS || !fails(function () {\n  Int8Array(1);\n}) || !fails(function () {\n  new Int8Array(-1);\n}) || !checkCorrectnessOfIteration(function (iterable) {\n  new Int8Array();\n  new Int8Array(null);\n  new Int8Array(1.5);\n  new Int8Array(iterable);\n}, true) || fails(function () {\n  // Safari (11+) bug - a reason why even Safari 13 should load a typed array polyfill\n  return new Int8Array(new ArrayBuffer(2), 1, undefined).length !== 1;\n});\n","'use strict';\nvar NATIVE_ARRAY_BUFFER = require('../internals/array-buffer-native');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar hasOwn = require('../internals/has-own-property');\nvar classof = require('../internals/classof');\nvar tryToString = require('../internals/try-to-string');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar defineProperty = require('../internals/object-define-property').f;\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar uid = require('../internals/uid');\n\nvar Int8Array = global.Int8Array;\nvar Int8ArrayPrototype = Int8Array && Int8Array.prototype;\nvar Uint8ClampedArray = global.Uint8ClampedArray;\nvar Uint8ClampedArrayPrototype = Uint8ClampedArray && Uint8ClampedArray.prototype;\nvar TypedArray = Int8Array && getPrototypeOf(Int8Array);\nvar TypedArrayPrototype = Int8ArrayPrototype && getPrototypeOf(Int8ArrayPrototype);\nvar ObjectPrototype = Object.prototype;\nvar TypeError = global.TypeError;\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar TYPED_ARRAY_TAG = uid('TYPED_ARRAY_TAG');\nvar TYPED_ARRAY_CONSTRUCTOR = uid('TYPED_ARRAY_CONSTRUCTOR');\n// Fixing native typed arrays in Opera Presto crashes the browser, see #595\nvar NATIVE_ARRAY_BUFFER_VIEWS = NATIVE_ARRAY_BUFFER && !!setPrototypeOf && classof(global.opera) !== 'Opera';\nvar TYPED_ARRAY_TAG_REQUIRED = false;\nvar NAME, Constructor, Prototype;\n\nvar TypedArrayConstructorsList = {\n  Int8Array: 1,\n  Uint8Array: 1,\n  Uint8ClampedArray: 1,\n  Int16Array: 2,\n  Uint16Array: 2,\n  Int32Array: 4,\n  Uint32Array: 4,\n  Float32Array: 4,\n  Float64Array: 8\n};\n\nvar BigIntArrayConstructorsList = {\n  BigInt64Array: 8,\n  BigUint64Array: 8\n};\n\nvar isView = function isView(it) {\n  if (!isObject(it)) return false;\n  var klass = classof(it);\n  return klass === 'DataView'\n    || hasOwn(TypedArrayConstructorsList, klass)\n    || hasOwn(BigIntArrayConstructorsList, klass);\n};\n\nvar isTypedArray = function (it) {\n  if (!isObject(it)) return false;\n  var klass = classof(it);\n  return hasOwn(TypedArrayConstructorsList, klass)\n    || hasOwn(BigIntArrayConstructorsList, klass);\n};\n\nvar aTypedArray = function (it) {\n  if (isTypedArray(it)) return it;\n  throw TypeError('Target is not a typed array');\n};\n\nvar aTypedArrayConstructor = function (C) {\n  if (isCallable(C) && (!setPrototypeOf || isPrototypeOf(TypedArray, C))) return C;\n  throw TypeError(tryToString(C) + ' is not a typed array constructor');\n};\n\nvar exportTypedArrayMethod = function (KEY, property, forced, options) {\n  if (!DESCRIPTORS) return;\n  if (forced) for (var ARRAY in TypedArrayConstructorsList) {\n    var TypedArrayConstructor = global[ARRAY];\n    if (TypedArrayConstructor && hasOwn(TypedArrayConstructor.prototype, KEY)) try {\n      delete TypedArrayConstructor.prototype[KEY];\n    } catch (error) {\n      // old WebKit bug - some methods are non-configurable\n      try {\n        TypedArrayConstructor.prototype[KEY] = property;\n      } catch (error2) { /* empty */ }\n    }\n  }\n  if (!TypedArrayPrototype[KEY] || forced) {\n    redefine(TypedArrayPrototype, KEY, forced ? property\n      : NATIVE_ARRAY_BUFFER_VIEWS && Int8ArrayPrototype[KEY] || property, options);\n  }\n};\n\nvar exportTypedArrayStaticMethod = function (KEY, property, forced) {\n  var ARRAY, TypedArrayConstructor;\n  if (!DESCRIPTORS) return;\n  if (setPrototypeOf) {\n    if (forced) for (ARRAY in TypedArrayConstructorsList) {\n      TypedArrayConstructor = global[ARRAY];\n      if (TypedArrayConstructor && hasOwn(TypedArrayConstructor, KEY)) try {\n        delete TypedArrayConstructor[KEY];\n      } catch (error) { /* empty */ }\n    }\n    if (!TypedArray[KEY] || forced) {\n      // V8 ~ Chrome 49-50 `%TypedArray%` methods are non-writable non-configurable\n      try {\n        return redefine(TypedArray, KEY, forced ? property : NATIVE_ARRAY_BUFFER_VIEWS && TypedArray[KEY] || property);\n      } catch (error) { /* empty */ }\n    } else return;\n  }\n  for (ARRAY in TypedArrayConstructorsList) {\n    TypedArrayConstructor = global[ARRAY];\n    if (TypedArrayConstructor && (!TypedArrayConstructor[KEY] || forced)) {\n      redefine(TypedArrayConstructor, KEY, property);\n    }\n  }\n};\n\nfor (NAME in TypedArrayConstructorsList) {\n  Constructor = global[NAME];\n  Prototype = Constructor && Constructor.prototype;\n  if (Prototype) createNonEnumerableProperty(Prototype, TYPED_ARRAY_CONSTRUCTOR, Constructor);\n  else NATIVE_ARRAY_BUFFER_VIEWS = false;\n}\n\nfor (NAME in BigIntArrayConstructorsList) {\n  Constructor = global[NAME];\n  Prototype = Constructor && Constructor.prototype;\n  if (Prototype) createNonEnumerableProperty(Prototype, TYPED_ARRAY_CONSTRUCTOR, Constructor);\n}\n\n// WebKit bug - typed arrays constructors prototype is Object.prototype\nif (!NATIVE_ARRAY_BUFFER_VIEWS || !isCallable(TypedArray) || TypedArray === Function.prototype) {\n  // eslint-disable-next-line no-shadow -- safe\n  TypedArray = function TypedArray() {\n    throw TypeError('Incorrect invocation');\n  };\n  if (NATIVE_ARRAY_BUFFER_VIEWS) for (NAME in TypedArrayConstructorsList) {\n    if (global[NAME]) setPrototypeOf(global[NAME], TypedArray);\n  }\n}\n\nif (!NATIVE_ARRAY_BUFFER_VIEWS || !TypedArrayPrototype || TypedArrayPrototype === ObjectPrototype) {\n  TypedArrayPrototype = TypedArray.prototype;\n  if (NATIVE_ARRAY_BUFFER_VIEWS) for (NAME in TypedArrayConstructorsList) {\n    if (global[NAME]) setPrototypeOf(global[NAME].prototype, TypedArrayPrototype);\n  }\n}\n\n// WebKit bug - one more object in Uint8ClampedArray prototype chain\nif (NATIVE_ARRAY_BUFFER_VIEWS && getPrototypeOf(Uint8ClampedArrayPrototype) !== TypedArrayPrototype) {\n  setPrototypeOf(Uint8ClampedArrayPrototype, TypedArrayPrototype);\n}\n\nif (DESCRIPTORS && !hasOwn(TypedArrayPrototype, TO_STRING_TAG)) {\n  TYPED_ARRAY_TAG_REQUIRED = true;\n  defineProperty(TypedArrayPrototype, TO_STRING_TAG, { get: function () {\n    return isObject(this) ? this[TYPED_ARRAY_TAG] : undefined;\n  } });\n  for (NAME in TypedArrayConstructorsList) if (global[NAME]) {\n    createNonEnumerableProperty(global[NAME], TYPED_ARRAY_TAG, NAME);\n  }\n}\n\nmodule.exports = {\n  NATIVE_ARRAY_BUFFER_VIEWS: NATIVE_ARRAY_BUFFER_VIEWS,\n  TYPED_ARRAY_CONSTRUCTOR: TYPED_ARRAY_CONSTRUCTOR,\n  TYPED_ARRAY_TAG: TYPED_ARRAY_TAG_REQUIRED && TYPED_ARRAY_TAG,\n  aTypedArray: aTypedArray,\n  aTypedArrayConstructor: aTypedArrayConstructor,\n  exportTypedArrayMethod: exportTypedArrayMethod,\n  exportTypedArrayStaticMethod: exportTypedArrayStaticMethod,\n  isView: isView,\n  isTypedArray: isTypedArray,\n  TypedArray: TypedArray,\n  TypedArrayPrototype: TypedArrayPrototype\n};\n","var global = require('../internals/global');\nvar toPositiveInteger = require('../internals/to-positive-integer');\n\nvar RangeError = global.RangeError;\n\nmodule.exports = function (it, BYTES) {\n  var offset = toPositiveInteger(it);\n  if (offset % BYTES) throw RangeError('Wrong offset');\n  return offset;\n};\n","var global = require('../internals/global');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\n\nvar RangeError = global.RangeError;\n\nmodule.exports = function (it) {\n  var result = toIntegerOrInfinity(it);\n  if (result < 0) throw RangeError(\"The argument can't be less than 0\");\n  return result;\n};\n","var bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aConstructor = require('../internals/a-constructor');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar aTypedArrayConstructor = require('../internals/array-buffer-view-core').aTypedArrayConstructor;\n\nmodule.exports = function from(source /* , mapfn, thisArg */) {\n  var C = aConstructor(this);\n  var O = toObject(source);\n  var argumentsLength = arguments.length;\n  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;\n  var mapping = mapfn !== undefined;\n  var iteratorMethod = getIteratorMethod(O);\n  var i, length, result, step, iterator, next;\n  if (iteratorMethod && !isArrayIteratorMethod(iteratorMethod)) {\n    iterator = getIterator(O, iteratorMethod);\n    next = iterator.next;\n    O = [];\n    while (!(step = call(next, iterator)).done) {\n      O.push(step.value);\n    }\n  }\n  if (mapping && argumentsLength > 2) {\n    mapfn = bind(mapfn, arguments[2]);\n  }\n  length = lengthOfArrayLike(O);\n  result = new (aTypedArrayConstructor(C))(length);\n  for (i = 0; length > i; i++) {\n    result[i] = mapping ? mapfn(O[i], i) : O[i];\n  }\n  return result;\n};\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Float64Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Float64', function (init) {\n  return function Float64Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Int8Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Int8', function (init) {\n  return function Int8Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Int16Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Int16', function (init) {\n  return function Int16Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Int32Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Int32', function (init) {\n  return function Int32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Uint8Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Uint8', function (init) {\n  return function Uint8Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Uint8ClampedArray` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Uint8', function (init) {\n  return function Uint8ClampedArray(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n}, true);\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Uint16Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Uint16', function (init) {\n  return function Uint16Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Uint32Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Uint32', function (init) {\n  return function Uint32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $ArrayCopyWithin = require('../internals/array-copy-within');\n\nvar u$ArrayCopyWithin = uncurryThis($ArrayCopyWithin);\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.copyWithin` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.copywithin\nexportTypedArrayMethod('copyWithin', function copyWithin(target, start /* , end */) {\n  return u$ArrayCopyWithin(aTypedArray(this), target, start, arguments.length > 2 ? arguments[2] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $every = require('../internals/array-iteration').every;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.every` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.every\nexportTypedArrayMethod('every', function every(callbackfn /* , thisArg */) {\n  return $every(aTypedArray(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar call = require('../internals/function-call');\nvar $fill = require('../internals/array-fill');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.fill` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.fill\nexportTypedArrayMethod('fill', function fill(value /* , start, end */) {\n  var length = arguments.length;\n  return call(\n    $fill,\n    aTypedArray(this),\n    value,\n    length > 1 ? arguments[1] : undefined,\n    length > 2 ? arguments[2] : undefined\n  );\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $filter = require('../internals/array-iteration').filter;\nvar fromSpeciesAndList = require('../internals/typed-array-from-species-and-list');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.filter` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.filter\nexportTypedArrayMethod('filter', function filter(callbackfn /* , thisArg */) {\n  var list = $filter(aTypedArray(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  return fromSpeciesAndList(this, list);\n});\n","var arrayFromConstructorAndList = require('../internals/array-from-constructor-and-list');\nvar typedArraySpeciesConstructor = require('../internals/typed-array-species-constructor');\n\nmodule.exports = function (instance, list) {\n  return arrayFromConstructorAndList(typedArraySpeciesConstructor(instance), list);\n};\n","var lengthOfArrayLike = require('../internals/length-of-array-like');\n\nmodule.exports = function (Constructor, list) {\n  var index = 0;\n  var length = lengthOfArrayLike(list);\n  var result = new Constructor(length);\n  while (length > index) result[index] = list[index++];\n  return result;\n};\n","var ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar speciesConstructor = require('../internals/species-constructor');\n\nvar TYPED_ARRAY_CONSTRUCTOR = ArrayBufferViewCore.TYPED_ARRAY_CONSTRUCTOR;\nvar aTypedArrayConstructor = ArrayBufferViewCore.aTypedArrayConstructor;\n\n// a part of `TypedArraySpeciesCreate` abstract operation\n// https://tc39.es/ecma262/#typedarray-species-create\nmodule.exports = function (originalArray) {\n  return aTypedArrayConstructor(speciesConstructor(originalArray, originalArray[TYPED_ARRAY_CONSTRUCTOR]));\n};\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $find = require('../internals/array-iteration').find;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.find` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.find\nexportTypedArrayMethod('find', function find(predicate /* , thisArg */) {\n  return $find(aTypedArray(this), predicate, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $findIndex = require('../internals/array-iteration').findIndex;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.findIndex` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.findindex\nexportTypedArrayMethod('findIndex', function findIndex(predicate /* , thisArg */) {\n  return $findIndex(aTypedArray(this), predicate, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $forEach = require('../internals/array-iteration').forEach;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.forEach` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.foreach\nexportTypedArrayMethod('forEach', function forEach(callbackfn /* , thisArg */) {\n  $forEach(aTypedArray(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS = require('../internals/typed-array-constructors-require-wrappers');\nvar exportTypedArrayStaticMethod = require('../internals/array-buffer-view-core').exportTypedArrayStaticMethod;\nvar typedArrayFrom = require('../internals/typed-array-from');\n\n// `%TypedArray%.from` method\n// https://tc39.es/ecma262/#sec-%typedarray%.from\nexportTypedArrayStaticMethod('from', typedArrayFrom, TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS);\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $includes = require('../internals/array-includes').includes;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.includes` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.includes\nexportTypedArrayMethod('includes', function includes(searchElement /* , fromIndex */) {\n  return $includes(aTypedArray(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $indexOf = require('../internals/array-includes').indexOf;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.indexOf` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.indexof\nexportTypedArrayMethod('indexOf', function indexOf(searchElement /* , fromIndex */) {\n  return $indexOf(aTypedArray(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar ArrayIterators = require('../modules/es.array.iterator');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar Uint8Array = global.Uint8Array;\nvar arrayValues = uncurryThis(ArrayIterators.values);\nvar arrayKeys = uncurryThis(ArrayIterators.keys);\nvar arrayEntries = uncurryThis(ArrayIterators.entries);\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\nvar TypedArrayPrototype = Uint8Array && Uint8Array.prototype;\n\nvar GENERIC = !fails(function () {\n  TypedArrayPrototype[ITERATOR].call([1]);\n});\n\nvar ITERATOR_IS_VALUES = !!TypedArrayPrototype\n  && TypedArrayPrototype.values\n  && TypedArrayPrototype[ITERATOR] === TypedArrayPrototype.values\n  && TypedArrayPrototype.values.name === 'values';\n\nvar typedArrayValues = function values() {\n  return arrayValues(aTypedArray(this));\n};\n\n// `%TypedArray%.prototype.entries` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.entries\nexportTypedArrayMethod('entries', function entries() {\n  return arrayEntries(aTypedArray(this));\n}, GENERIC);\n// `%TypedArray%.prototype.keys` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.keys\nexportTypedArrayMethod('keys', function keys() {\n  return arrayKeys(aTypedArray(this));\n}, GENERIC);\n// `%TypedArray%.prototype.values` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.values\nexportTypedArrayMethod('values', typedArrayValues, GENERIC || !ITERATOR_IS_VALUES, { name: 'values' });\n// `%TypedArray%.prototype[@@iterator]` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype-@@iterator\nexportTypedArrayMethod(ITERATOR, typedArrayValues, GENERIC || !ITERATOR_IS_VALUES, { name: 'values' });\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\nvar $join = uncurryThis([].join);\n\n// `%TypedArray%.prototype.join` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.join\nexportTypedArrayMethod('join', function join(separator) {\n  return $join(aTypedArray(this), separator);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar apply = require('../internals/function-apply');\nvar $lastIndexOf = require('../internals/array-last-index-of');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.lastIndexOf` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.lastindexof\nexportTypedArrayMethod('lastIndexOf', function lastIndexOf(searchElement /* , fromIndex */) {\n  var length = arguments.length;\n  return apply($lastIndexOf, aTypedArray(this), length > 1 ? [searchElement, arguments[1]] : [searchElement]);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $map = require('../internals/array-iteration').map;\nvar typedArraySpeciesConstructor = require('../internals/typed-array-species-constructor');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.map` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.map\nexportTypedArrayMethod('map', function map(mapfn /* , thisArg */) {\n  return $map(aTypedArray(this), mapfn, arguments.length > 1 ? arguments[1] : undefined, function (O, length) {\n    return new (typedArraySpeciesConstructor(O))(length);\n  });\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS = require('../internals/typed-array-constructors-require-wrappers');\n\nvar aTypedArrayConstructor = ArrayBufferViewCore.aTypedArrayConstructor;\nvar exportTypedArrayStaticMethod = ArrayBufferViewCore.exportTypedArrayStaticMethod;\n\n// `%TypedArray%.of` method\n// https://tc39.es/ecma262/#sec-%typedarray%.of\nexportTypedArrayStaticMethod('of', function of(/* ...items */) {\n  var index = 0;\n  var length = arguments.length;\n  var result = new (aTypedArrayConstructor(this))(length);\n  while (length > index) result[index] = arguments[index++];\n  return result;\n}, TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS);\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $reduce = require('../internals/array-reduce').left;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.reduce` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.reduce\nexportTypedArrayMethod('reduce', function reduce(callbackfn /* , initialValue */) {\n  var length = arguments.length;\n  return $reduce(aTypedArray(this), callbackfn, length, length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $reduceRight = require('../internals/array-reduce').right;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.reduceRicht` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.reduceright\nexportTypedArrayMethod('reduceRight', function reduceRight(callbackfn /* , initialValue */) {\n  var length = arguments.length;\n  return $reduceRight(aTypedArray(this), callbackfn, length, length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\nvar floor = Math.floor;\n\n// `%TypedArray%.prototype.reverse` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.reverse\nexportTypedArrayMethod('reverse', function reverse() {\n  var that = this;\n  var length = aTypedArray(that).length;\n  var middle = floor(length / 2);\n  var index = 0;\n  var value;\n  while (index < middle) {\n    value = that[index];\n    that[index++] = that[--length];\n    that[length] = value;\n  } return that;\n});\n","'use strict';\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toOffset = require('../internals/to-offset');\nvar toIndexedObject = require('../internals/to-object');\nvar fails = require('../internals/fails');\n\nvar RangeError = global.RangeError;\nvar Int8Array = global.Int8Array;\nvar Int8ArrayPrototype = Int8Array && Int8Array.prototype;\nvar $set = Int8ArrayPrototype && Int8ArrayPrototype.set;\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\nvar WORKS_WITH_OBJECTS_AND_GEERIC_ON_TYPED_ARRAYS = !fails(function () {\n  // eslint-disable-next-line es/no-typed-arrays -- required for testing\n  var array = new Uint8ClampedArray(2);\n  call($set, array, { length: 1, 0: 3 }, 1);\n  return array[1] !== 3;\n});\n\n// https://bugs.chromium.org/p/v8/issues/detail?id=11294 and other\nvar TO_OBJECT_BUG = WORKS_WITH_OBJECTS_AND_GEERIC_ON_TYPED_ARRAYS && ArrayBufferViewCore.NATIVE_ARRAY_BUFFER_VIEWS && fails(function () {\n  var array = new Int8Array(2);\n  array.set(1);\n  array.set('2', 1);\n  return array[0] !== 0 || array[1] !== 2;\n});\n\n// `%TypedArray%.prototype.set` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.set\nexportTypedArrayMethod('set', function set(arrayLike /* , offset */) {\n  aTypedArray(this);\n  var offset = toOffset(arguments.length > 1 ? arguments[1] : undefined, 1);\n  var src = toIndexedObject(arrayLike);\n  if (WORKS_WITH_OBJECTS_AND_GEERIC_ON_TYPED_ARRAYS) return call($set, this, src, offset);\n  var length = this.length;\n  var len = lengthOfArrayLike(src);\n  var index = 0;\n  if (len + offset > length) throw RangeError('Wrong length');\n  while (index < len) this[offset + index] = src[index++];\n}, !WORKS_WITH_OBJECTS_AND_GEERIC_ON_TYPED_ARRAYS || TO_OBJECT_BUG);\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar typedArraySpeciesConstructor = require('../internals/typed-array-species-constructor');\nvar fails = require('../internals/fails');\nvar arraySlice = require('../internals/array-slice');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\nvar FORCED = fails(function () {\n  // eslint-disable-next-line es/no-typed-arrays -- required for testing\n  new Int8Array(1).slice();\n});\n\n// `%TypedArray%.prototype.slice` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.slice\nexportTypedArrayMethod('slice', function slice(start, end) {\n  var list = arraySlice(aTypedArray(this), start, end);\n  var C = typedArraySpeciesConstructor(this);\n  var index = 0;\n  var length = list.length;\n  var result = new C(length);\n  while (length > index) result[index] = list[index++];\n  return result;\n}, FORCED);\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $some = require('../internals/array-iteration').some;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.some` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.some\nexportTypedArrayMethod('some', function some(callbackfn /* , thisArg */) {\n  return $some(aTypedArray(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar aCallable = require('../internals/a-callable');\nvar internalSort = require('../internals/array-sort');\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar FF = require('../internals/engine-ff-version');\nvar IE_OR_EDGE = require('../internals/engine-is-ie-or-edge');\nvar V8 = require('../internals/engine-v8-version');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\nvar Array = global.Array;\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\nvar Uint16Array = global.Uint16Array;\nvar un$Sort = Uint16Array && uncurryThis(Uint16Array.prototype.sort);\n\n// WebKit\nvar ACCEPT_INCORRECT_ARGUMENTS = !!un$Sort && !(fails(function () {\n  un$Sort(new Uint16Array(2), null);\n}) && fails(function () {\n  un$Sort(new Uint16Array(2), {});\n}));\n\nvar STABLE_SORT = !!un$Sort && !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 74;\n  if (FF) return FF < 67;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 602;\n\n  var array = new Uint16Array(516);\n  var expected = Array(516);\n  var index, mod;\n\n  for (index = 0; index < 516; index++) {\n    mod = index % 4;\n    array[index] = 515 - index;\n    expected[index] = index - 2 * mod + 3;\n  }\n\n  un$Sort(array, function (a, b) {\n    return (a / 4 | 0) - (b / 4 | 0);\n  });\n\n  for (index = 0; index < 516; index++) {\n    if (array[index] !== expected[index]) return true;\n  }\n});\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (y !== y) return -1;\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (x !== x) return 1;\n    if (x === 0 && y === 0) return 1 / x > 0 && 1 / y < 0 ? 1 : -1;\n    return x > y;\n  };\n};\n\n// `%TypedArray%.prototype.sort` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.sort\nexportTypedArrayMethod('sort', function sort(comparefn) {\n  if (comparefn !== undefined) aCallable(comparefn);\n  if (STABLE_SORT) return un$Sort(this, comparefn);\n\n  return internalSort(aTypedArray(this), getSortCompare(comparefn));\n}, !STABLE_SORT || ACCEPT_INCORRECT_ARGUMENTS);\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar toLength = require('../internals/to-length');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar typedArraySpeciesConstructor = require('../internals/typed-array-species-constructor');\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.subarray` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.subarray\nexportTypedArrayMethod('subarray', function subarray(begin, end) {\n  var O = aTypedArray(this);\n  var length = O.length;\n  var beginIndex = toAbsoluteIndex(begin, length);\n  var C = typedArraySpeciesConstructor(O);\n  return new C(\n    O.buffer,\n    O.byteOffset + beginIndex * O.BYTES_PER_ELEMENT,\n    toLength((end === undefined ? length : toAbsoluteIndex(end, length)) - beginIndex)\n  );\n});\n","'use strict';\nvar global = require('../internals/global');\nvar apply = require('../internals/function-apply');\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar fails = require('../internals/fails');\nvar arraySlice = require('../internals/array-slice');\n\nvar Int8Array = global.Int8Array;\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\nvar $toLocaleString = [].toLocaleString;\n\n// iOS Safari 6.x fails here\nvar TO_LOCALE_STRING_BUG = !!Int8Array && fails(function () {\n  $toLocaleString.call(new Int8Array(1));\n});\n\nvar FORCED = fails(function () {\n  return [1, 2].toLocaleString() != new Int8Array([1, 2]).toLocaleString();\n}) || !fails(function () {\n  Int8Array.prototype.toLocaleString.call([1, 2]);\n});\n\n// `%TypedArray%.prototype.toLocaleString` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.tolocalestring\nexportTypedArrayMethod('toLocaleString', function toLocaleString() {\n  return apply(\n    $toLocaleString,\n    TO_LOCALE_STRING_BUG ? arraySlice(aTypedArray(this)) : aTypedArray(this),\n    arraySlice(arguments)\n  );\n}, FORCED);\n","'use strict';\nvar exportTypedArrayMethod = require('../internals/array-buffer-view-core').exportTypedArrayMethod;\nvar fails = require('../internals/fails');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nvar Uint8Array = global.Uint8Array;\nvar Uint8ArrayPrototype = Uint8Array && Uint8Array.prototype || {};\nvar arrayToString = [].toString;\nvar join = uncurryThis([].join);\n\nif (fails(function () { arrayToString.call({}); })) {\n  arrayToString = function toString() {\n    return join(this);\n  };\n}\n\nvar IS_NOT_ARRAY_METHOD = Uint8ArrayPrototype.toString != arrayToString;\n\n// `%TypedArray%.prototype.toString` method\n// https://tc39.es/ecma262/#sec-%typedarray%.prototype.tostring\nexportTypedArrayMethod('toString', arrayToString, IS_NOT_ARRAY_METHOD);\n","'use strict';\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar redefineAll = require('../internals/redefine-all');\nvar InternalMetadataModule = require('../internals/internal-metadata');\nvar collection = require('../internals/collection');\nvar collectionWeak = require('../internals/collection-weak');\nvar isObject = require('../internals/is-object');\nvar isExtensible = require('../internals/object-is-extensible');\nvar enforceInternalState = require('../internals/internal-state').enforce;\nvar NATIVE_WEAK_MAP = require('../internals/native-weak-map');\n\nvar IS_IE11 = !global.ActiveXObject && 'ActiveXObject' in global;\nvar InternalWeakMap;\n\nvar wrapper = function (init) {\n  return function WeakMap() {\n    return init(this, arguments.length ? arguments[0] : undefined);\n  };\n};\n\n// `WeakMap` constructor\n// https://tc39.es/ecma262/#sec-weakmap-constructor\nvar $WeakMap = collection('WeakMap', wrapper, collectionWeak);\n\n// IE11 WeakMap frozen keys fix\n// We can't use feature detection because it crash some old IE builds\n// https://github.com/zloirock/core-js/issues/485\nif (NATIVE_WEAK_MAP && IS_IE11) {\n  InternalWeakMap = collectionWeak.getConstructor(wrapper, 'WeakMap', true);\n  InternalMetadataModule.enable();\n  var WeakMapPrototype = $WeakMap.prototype;\n  var nativeDelete = uncurryThis(WeakMapPrototype['delete']);\n  var nativeHas = uncurryThis(WeakMapPrototype.has);\n  var nativeGet = uncurryThis(WeakMapPrototype.get);\n  var nativeSet = uncurryThis(WeakMapPrototype.set);\n  redefineAll(WeakMapPrototype, {\n    'delete': function (key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeDelete(this, key) || state.frozen['delete'](key);\n      } return nativeDelete(this, key);\n    },\n    has: function has(key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeHas(this, key) || state.frozen.has(key);\n      } return nativeHas(this, key);\n    },\n    get: function get(key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeHas(this, key) ? nativeGet(this, key) : state.frozen.get(key);\n      } return nativeGet(this, key);\n    },\n    set: function set(key, value) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        nativeHas(this, key) ? nativeSet(this, key, value) : state.frozen.set(key, value);\n      } else nativeSet(this, key, value);\n      return this;\n    }\n  });\n}\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar redefineAll = require('../internals/redefine-all');\nvar getWeakData = require('../internals/internal-metadata').getWeakData;\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar anInstance = require('../internals/an-instance');\nvar iterate = require('../internals/iterate');\nvar ArrayIterationModule = require('../internals/array-iteration');\nvar hasOwn = require('../internals/has-own-property');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar setInternalState = InternalStateModule.set;\nvar internalStateGetterFor = InternalStateModule.getterFor;\nvar find = ArrayIterationModule.find;\nvar findIndex = ArrayIterationModule.findIndex;\nvar splice = uncurryThis([].splice);\nvar id = 0;\n\n// fallback for uncaught frozen keys\nvar uncaughtFrozenStore = function (store) {\n  return store.frozen || (store.frozen = new UncaughtFrozenStore());\n};\n\nvar UncaughtFrozenStore = function () {\n  this.entries = [];\n};\n\nvar findUncaughtFrozen = function (store, key) {\n  return find(store.entries, function (it) {\n    return it[0] === key;\n  });\n};\n\nUncaughtFrozenStore.prototype = {\n  get: function (key) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) return entry[1];\n  },\n  has: function (key) {\n    return !!findUncaughtFrozen(this, key);\n  },\n  set: function (key, value) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) entry[1] = value;\n    else this.entries.push([key, value]);\n  },\n  'delete': function (key) {\n    var index = findIndex(this.entries, function (it) {\n      return it[0] === key;\n    });\n    if (~index) splice(this.entries, index, 1);\n    return !!~index;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function (wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER) {\n    var Constructor = wrapper(function (that, iterable) {\n      anInstance(that, Prototype);\n      setInternalState(that, {\n        type: CONSTRUCTOR_NAME,\n        id: id++,\n        frozen: undefined\n      });\n      if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n    });\n\n    var Prototype = Constructor.prototype;\n\n    var getInternalState = internalStateGetterFor(CONSTRUCTOR_NAME);\n\n    var define = function (that, key, value) {\n      var state = getInternalState(that);\n      var data = getWeakData(anObject(key), true);\n      if (data === true) uncaughtFrozenStore(state).set(key, value);\n      else data[state.id] = value;\n      return that;\n    };\n\n    redefineAll(Prototype, {\n      // `{ WeakMap, WeakSet }.prototype.delete(key)` methods\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.delete\n      // https://tc39.es/ecma262/#sec-weakset.prototype.delete\n      'delete': function (key) {\n        var state = getInternalState(this);\n        if (!isObject(key)) return false;\n        var data = getWeakData(key);\n        if (data === true) return uncaughtFrozenStore(state)['delete'](key);\n        return data && hasOwn(data, state.id) && delete data[state.id];\n      },\n      // `{ WeakMap, WeakSet }.prototype.has(key)` methods\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.has\n      // https://tc39.es/ecma262/#sec-weakset.prototype.has\n      has: function has(key) {\n        var state = getInternalState(this);\n        if (!isObject(key)) return false;\n        var data = getWeakData(key);\n        if (data === true) return uncaughtFrozenStore(state).has(key);\n        return data && hasOwn(data, state.id);\n      }\n    });\n\n    redefineAll(Prototype, IS_MAP ? {\n      // `WeakMap.prototype.get(key)` method\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.get\n      get: function get(key) {\n        var state = getInternalState(this);\n        if (isObject(key)) {\n          var data = getWeakData(key);\n          if (data === true) return uncaughtFrozenStore(state).get(key);\n          return data ? data[state.id] : undefined;\n        }\n      },\n      // `WeakMap.prototype.set(key, value)` method\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.set\n      set: function set(key, value) {\n        return define(this, key, value);\n      }\n    } : {\n      // `WeakSet.prototype.add(value)` method\n      // https://tc39.es/ecma262/#sec-weakset.prototype.add\n      add: function add(value) {\n        return define(this, value, true);\n      }\n    });\n\n    return Constructor;\n  }\n};\n","'use strict';\nvar collection = require('../internals/collection');\nvar collectionWeak = require('../internals/collection-weak');\n\n// `WeakSet` constructor\n// https://tc39.es/ecma262/#sec-weakset-constructor\ncollection('WeakSet', function (init) {\n  return function WeakSet() { return init(this, arguments.length ? arguments[0] : undefined); };\n}, collectionWeak);\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar create = require('../internals/object-create');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar clearErrorStack = require('../internals/clear-error-stack');\nvar installErrorCause = require('../internals/install-error-cause');\nvar iterate = require('../internals/iterate');\nvar normalizeStringArgument = require('../internals/normalize-string-argument');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar ERROR_STACK_INSTALLABLE = require('../internals/error-stack-installable');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar Error = global.Error;\nvar push = [].push;\n\nvar $AggregateError = function AggregateError(errors, message /* , options */) {\n  var options = arguments.length > 2 ? arguments[2] : undefined;\n  var isInstance = isPrototypeOf(AggregateErrorPrototype, this);\n  var that;\n  if (setPrototypeOf) {\n    that = setPrototypeOf(new Error(), isInstance ? getPrototypeOf(this) : AggregateErrorPrototype);\n  } else {\n    that = isInstance ? this : create(AggregateErrorPrototype);\n    createNonEnumerableProperty(that, TO_STRING_TAG, 'Error');\n  }\n  if (message !== undefined) createNonEnumerableProperty(that, 'message', normalizeStringArgument(message));\n  if (ERROR_STACK_INSTALLABLE) createNonEnumerableProperty(that, 'stack', clearErrorStack(that.stack, 1));\n  installErrorCause(that, options);\n  var errorsArray = [];\n  iterate(errors, push, { that: errorsArray });\n  createNonEnumerableProperty(that, 'errors', errorsArray);\n  return that;\n};\n\nif (setPrototypeOf) setPrototypeOf($AggregateError, Error);\nelse copyConstructorProperties($AggregateError, Error, { name: true });\n\nvar AggregateErrorPrototype = $AggregateError.prototype = create(Error.prototype, {\n  constructor: createPropertyDescriptor(1, $AggregateError),\n  message: createPropertyDescriptor(1, ''),\n  name: createPropertyDescriptor(1, 'AggregateError')\n});\n\n// `AggregateError` constructor\n// https://tc39.es/ecma262/#sec-aggregate-error-constructor\n$({ global: true }, {\n  AggregateError: $AggregateError\n});\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nvar replace = uncurryThis(''.replace);\n\nvar TEST = (function (arg) { return String(Error(arg).stack); })('zxcasd');\nvar V8_OR_CHAKRA_STACK_ENTRY = /\\n\\s*at [^:]*:[^\\n]*/;\nvar IS_V8_OR_CHAKRA_STACK = V8_OR_CHAKRA_STACK_ENTRY.test(TEST);\n\nmodule.exports = function (stack, dropEntries) {\n  if (IS_V8_OR_CHAKRA_STACK && typeof stack == 'string') {\n    while (dropEntries--) stack = replace(stack, V8_OR_CHAKRA_STACK_ENTRY, '');\n  } return stack;\n};\n","var isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\n// `InstallErrorCause` abstract operation\n// https://tc39.es/proposal-error-cause/#sec-errorobjects-install-error-cause\nmodule.exports = function (O, options) {\n  if (isObject(options) && 'cause' in options) {\n    createNonEnumerableProperty(O, 'cause', options.cause);\n  }\n};\n","var toString = require('../internals/to-string');\n\nmodule.exports = function (argument, $default) {\n  return argument === undefined ? arguments.length < 2 ? '' : $default : toString(argument);\n};\n","var fails = require('../internals/fails');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = !fails(function () {\n  var error = Error('a');\n  if (!('stack' in error)) return true;\n  // eslint-disable-next-line es/no-object-defineproperty -- safe\n  Object.defineProperty(error, 'stack', createPropertyDescriptor(1, 7));\n  return error.stack !== 7;\n});\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar defineProperty = require('../internals/object-define-property').f;\n\n// `Array.prototype.lastIndex` getter\n// https://github.com/keithamus/proposal-array-last\nif (DESCRIPTORS && !('lastIndex' in [])) {\n  defineProperty(Array.prototype, 'lastIndex', {\n    configurable: true,\n    get: function lastIndex() {\n      var O = toObject(this);\n      var len = lengthOfArrayLike(O);\n      return len == 0 ? 0 : len - 1;\n    }\n  });\n\n  addToUnscopables('lastIndex');\n}\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar defineProperty = require('../internals/object-define-property').f;\n\n// `Array.prototype.lastIndex` accessor\n// https://github.com/keithamus/proposal-array-last\nif (DESCRIPTORS && !('lastItem' in [])) {\n  defineProperty(Array.prototype, 'lastItem', {\n    configurable: true,\n    get: function lastItem() {\n      var O = toObject(this);\n      var len = lengthOfArrayLike(O);\n      return len == 0 ? undefined : O[len - 1];\n    },\n    set: function lastItem(value) {\n      var O = toObject(this);\n      var len = lengthOfArrayLike(O);\n      return O[len == 0 ? 0 : len - 1] = value;\n    }\n  });\n\n  addToUnscopables('lastItem');\n}\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar apply = require('../internals/function-apply');\nvar getCompositeKeyNode = require('../internals/composite-key');\nvar getBuiltIn = require('../internals/get-built-in');\nvar create = require('../internals/object-create');\n\nvar Object = global.Object;\n\nvar initializer = function () {\n  var freeze = getBuiltIn('Object', 'freeze');\n  return freeze ? freeze(create(null)) : create(null);\n};\n\n// https://github.com/tc39/proposal-richer-keys/tree/master/compositeKey\n$({ global: true }, {\n  compositeKey: function compositeKey() {\n    return apply(getCompositeKeyNode, Object, arguments).get('object', initializer);\n  }\n});\n","// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.map');\nrequire('../modules/es.weak-map');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar create = require('../internals/object-create');\nvar isObject = require('../internals/is-object');\n\nvar Object = global.Object;\nvar TypeError = global.TypeError;\nvar Map = getBuiltIn('Map');\nvar WeakMap = getBuiltIn('WeakMap');\n\nvar Node = function () {\n  // keys\n  this.object = null;\n  this.symbol = null;\n  // child nodes\n  this.primitives = null;\n  this.objectsByIndex = create(null);\n};\n\nNode.prototype.get = function (key, initializer) {\n  return this[key] || (this[key] = initializer());\n};\n\nNode.prototype.next = function (i, it, IS_OBJECT) {\n  var store = IS_OBJECT\n    ? this.objectsByIndex[i] || (this.objectsByIndex[i] = new WeakMap())\n    : this.primitives || (this.primitives = new Map());\n  var entry = store.get(it);\n  if (!entry) store.set(it, entry = new Node());\n  return entry;\n};\n\nvar root = new Node();\n\nmodule.exports = function () {\n  var active = root;\n  var length = arguments.length;\n  var i, it;\n  // for prevent leaking, start from objects\n  for (i = 0; i < length; i++) {\n    if (isObject(it = arguments[i])) active = active.next(i, it, true);\n  }\n  if (this === Object && active === root) throw TypeError('Composite keys must contain a non-primitive component');\n  for (i = 0; i < length; i++) {\n    if (!isObject(it = arguments[i])) active = active.next(i, it, false);\n  } return active;\n};\n","var $ = require('../internals/export');\nvar getCompositeKeyNode = require('../internals/composite-key');\nvar getBuiltIn = require('../internals/get-built-in');\nvar apply = require('../internals/function-apply');\n\n// https://github.com/tc39/proposal-richer-keys/tree/master/compositeKey\n$({ global: true }, {\n  compositeSymbol: function compositeSymbol() {\n    if (arguments.length == 1 && typeof arguments[0] == 'string') return getBuiltIn('Symbol')['for'](arguments[0]);\n    return apply(getCompositeKeyNode, null, arguments).get('symbol', getBuiltIn('Symbol'));\n  }\n});\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\n\n// `globalThis` object\n// https://tc39.es/ecma262/#sec-globalthis\n$({ global: true }, {\n  globalThis: global\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar deleteAll = require('../internals/collection-delete-all');\n\n// `Map.prototype.deleteAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  deleteAll: deleteAll\n});\n","'use strict';\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\n\n// https://github.com/tc39/collection-methods\nmodule.exports = function deleteAll(/* ...elements */) {\n  var collection = anObject(this);\n  var remover = aCallable(collection['delete']);\n  var allDeleted = true;\n  var wasDeleted;\n  for (var k = 0, len = arguments.length; k < len; k++) {\n    wasDeleted = call(remover, collection, arguments[k]);\n    allDeleted = allDeleted && wasDeleted;\n  }\n  return !!allDeleted;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.every` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  every: function every(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return !iterate(iterator, function (key, value, stop) {\n      if (!boundFunction(value, key, map)) return stop();\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","var call = require('../internals/function-call');\n\nmodule.exports = function (it) {\n  // eslint-disable-next-line es/no-map -- safe\n  return call(Map.prototype.entries, it);\n};\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.filter` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newMap = new (speciesConstructor(map, getBuiltIn('Map')))();\n    var setter = aCallable(newMap.set);\n    iterate(iterator, function (key, value) {\n      if (boundFunction(value, key, map)) call(setter, newMap, key, value);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true });\n    return newMap;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.find` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  find: function find(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (key, value, stop) {\n      if (boundFunction(value, key, map)) return stop(value);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).result;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.findKey` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  findKey: function findKey(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (key, value, stop) {\n      if (boundFunction(value, key, map)) return stop(key);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).result;\n  }\n});\n","var $ = require('../internals/export');\nvar from = require('../internals/collection-from');\n\n// `Map.from` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-map.from\n$({ target: 'Map', stat: true }, {\n  from: from\n});\n","'use strict';\n// https://tc39.github.io/proposal-setmap-offrom/\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar aConstructor = require('../internals/a-constructor');\nvar iterate = require('../internals/iterate');\n\nvar push = [].push;\n\nmodule.exports = function from(source /* , mapFn, thisArg */) {\n  var length = arguments.length;\n  var mapFn = length > 1 ? arguments[1] : undefined;\n  var mapping, array, n, boundFunction;\n  aConstructor(this);\n  mapping = mapFn !== undefined;\n  if (mapping) aCallable(mapFn);\n  if (source == undefined) return new this();\n  array = [];\n  if (mapping) {\n    n = 0;\n    boundFunction = bind(mapFn, length > 2 ? arguments[2] : undefined);\n    iterate(source, function (nextItem) {\n      call(push, array, boundFunction(nextItem, n++));\n    });\n  } else {\n    iterate(source, push, { that: array });\n  }\n  return new this(array);\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar getIterator = require('../internals/get-iterator');\nvar iterate = require('../internals/iterate');\n\nvar push = uncurryThis([].push);\n\n// `Map.groupBy` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', stat: true }, {\n  groupBy: function groupBy(iterable, keyDerivative) {\n    aCallable(keyDerivative);\n    var iterator = getIterator(iterable);\n    var newMap = new this();\n    var has = aCallable(newMap.has);\n    var get = aCallable(newMap.get);\n    var set = aCallable(newMap.set);\n    iterate(iterator, function (element) {\n      var derivedKey = keyDerivative(element);\n      if (!call(has, newMap, derivedKey)) call(set, newMap, derivedKey, [element]);\n      else push(call(get, newMap, derivedKey), element);\n    }, { IS_ITERATOR: true });\n    return newMap;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar anObject = require('../internals/an-object');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar sameValueZero = require('../internals/same-value-zero');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.includes` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  includes: function includes(searchElement) {\n    return iterate(getMapIterator(anObject(this)), function (key, value, stop) {\n      if (sameValueZero(value, searchElement)) return stop();\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","// `SameValueZero` abstract operation\n// https://tc39.es/ecma262/#sec-samevaluezero\nmodule.exports = function (x, y) {\n  // eslint-disable-next-line no-self-compare -- NaN check\n  return x === y || x != x && y != y;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar iterate = require('../internals/iterate');\nvar aCallable = require('../internals/a-callable');\n\n// `Map.keyBy` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', stat: true }, {\n  keyBy: function keyBy(iterable, keyDerivative) {\n    var newMap = new this();\n    aCallable(keyDerivative);\n    var setter = aCallable(newMap.set);\n    iterate(iterable, function (element) {\n      call(setter, newMap, keyDerivative(element), element);\n    });\n    return newMap;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.keyOf` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  keyOf: function keyOf(searchElement) {\n    return iterate(getMapIterator(anObject(this)), function (key, value, stop) {\n      if (value === searchElement) return stop(key);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).result;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.mapKeys` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  mapKeys: function mapKeys(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newMap = new (speciesConstructor(map, getBuiltIn('Map')))();\n    var setter = aCallable(newMap.set);\n    iterate(iterator, function (key, value) {\n      call(setter, newMap, boundFunction(value, key, map), value);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true });\n    return newMap;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.mapValues` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  mapValues: function mapValues(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newMap = new (speciesConstructor(map, getBuiltIn('Map')))();\n    var setter = aCallable(newMap.set);\n    iterate(iterator, function (key, value) {\n      call(setter, newMap, key, boundFunction(value, key, map));\n    }, { AS_ENTRIES: true, IS_ITERATOR: true });\n    return newMap;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.merge` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  merge: function merge(iterable /* ...iterables */) {\n    var map = anObject(this);\n    var setter = aCallable(map.set);\n    var argumentsLength = arguments.length;\n    var i = 0;\n    while (i < argumentsLength) {\n      iterate(arguments[i++], setter, { that: map, AS_ENTRIES: true });\n    }\n    return map;\n  }\n});\n","var $ = require('../internals/export');\nvar of = require('../internals/collection-of');\n\n// `Map.of` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-map.of\n$({ target: 'Map', stat: true }, {\n  of: of\n});\n","'use strict';\nvar arraySlice = require('../internals/array-slice');\n\n// https://tc39.github.io/proposal-setmap-offrom/\nmodule.exports = function of() {\n  return new this(arraySlice(arguments));\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar aCallable = require('../internals/a-callable');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\nvar TypeError = global.TypeError;\n\n// `Map.prototype.reduce` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  reduce: function reduce(callbackfn /* , initialValue */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var noInitial = arguments.length < 2;\n    var accumulator = noInitial ? undefined : arguments[1];\n    aCallable(callbackfn);\n    iterate(iterator, function (key, value) {\n      if (noInitial) {\n        noInitial = false;\n        accumulator = value;\n      } else {\n        accumulator = callbackfn(accumulator, value, key, map);\n      }\n    }, { AS_ENTRIES: true, IS_ITERATOR: true });\n    if (noInitial) throw TypeError('Reduce of empty map with no initial value');\n    return accumulator;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.some` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  some: function some(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (key, value, stop) {\n      if (boundFunction(value, key, map)) return stop();\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar aCallable = require('../internals/a-callable');\n\nvar TypeError = global.TypeError;\n\n// `Set.prototype.update` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  update: function update(key, callback /* , thunk */) {\n    var map = anObject(this);\n    var get = aCallable(map.get);\n    var has = aCallable(map.has);\n    var set = aCallable(map.set);\n    var length = arguments.length;\n    aCallable(callback);\n    var isPresentInMap = call(has, map, key);\n    if (!isPresentInMap && length < 3) {\n      throw TypeError('Updating absent value');\n    }\n    var value = isPresentInMap ? call(get, map, key) : aCallable(length > 2 ? arguments[2] : undefined)(key, map);\n    call(set, map, key, callback(value, key, map));\n    return map;\n  }\n});\n","var $ = require('../internals/export');\n\nvar min = Math.min;\nvar max = Math.max;\n\n// `Math.clamp` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  clamp: function clamp(x, lower, upper) {\n    return min(upper, max(lower, x));\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.DEG_PER_RAD` constant\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  DEG_PER_RAD: Math.PI / 180\n});\n","var $ = require('../internals/export');\n\nvar RAD_PER_DEG = 180 / Math.PI;\n\n// `Math.degrees` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  degrees: function degrees(radians) {\n    return radians * RAD_PER_DEG;\n  }\n});\n","var $ = require('../internals/export');\n\nvar scale = require('../internals/math-scale');\nvar fround = require('../internals/math-fround');\n\n// `Math.fscale` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  fscale: function fscale(x, inLow, inHigh, outLow, outHigh) {\n    return fround(scale(x, inLow, inHigh, outLow, outHigh));\n  }\n});\n","// `Math.scale` method implementation\n// https://rwaldron.github.io/proposal-math-extensions/\nmodule.exports = Math.scale || function scale(x, inLow, inHigh, outLow, outHigh) {\n  var nx = +x;\n  var nInLow = +inLow;\n  var nInHigh = +inHigh;\n  var nOutLow = +outLow;\n  var nOutHigh = +outHigh;\n  // eslint-disable-next-line no-self-compare -- NaN check\n  if (nx != nx || nInLow != nInLow || nInHigh != nInHigh || nOutLow != nOutLow || nOutHigh != nOutHigh) return NaN;\n  if (nx === Infinity || nx === -Infinity) return nx;\n  return (nx - nInLow) * (nOutHigh - nOutLow) / (nInHigh - nInLow) + nOutLow;\n};\n","var $ = require('../internals/export');\n\n// `Math.iaddh` method\n// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\n// TODO: Remove from `core-js@4`\n$({ target: 'Math', stat: true }, {\n  iaddh: function iaddh(x0, x1, y0, y1) {\n    var $x0 = x0 >>> 0;\n    var $x1 = x1 >>> 0;\n    var $y0 = y0 >>> 0;\n    return $x1 + (y1 >>> 0) + (($x0 & $y0 | ($x0 | $y0) & ~($x0 + $y0 >>> 0)) >>> 31) | 0;\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.imulh` method\n// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\n// TODO: Remove from `core-js@4`\n$({ target: 'Math', stat: true }, {\n  imulh: function imulh(u, v) {\n    var UINT16 = 0xFFFF;\n    var $u = +u;\n    var $v = +v;\n    var u0 = $u & UINT16;\n    var v0 = $v & UINT16;\n    var u1 = $u >> 16;\n    var v1 = $v >> 16;\n    var t = (u1 * v0 >>> 0) + (u0 * v0 >>> 16);\n    return u1 * v1 + (t >> 16) + ((u0 * v1 >>> 0) + (t & UINT16) >> 16);\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.isubh` method\n// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\n// TODO: Remove from `core-js@4`\n$({ target: 'Math', stat: true }, {\n  isubh: function isubh(x0, x1, y0, y1) {\n    var $x0 = x0 >>> 0;\n    var $x1 = x1 >>> 0;\n    var $y0 = y0 >>> 0;\n    return $x1 - (y1 >>> 0) - ((~$x0 & $y0 | ~($x0 ^ $y0) & $x0 - $y0 >>> 0) >>> 31) | 0;\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.RAD_PER_DEG` constant\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  RAD_PER_DEG: 180 / Math.PI\n});\n","var $ = require('../internals/export');\n\nvar DEG_PER_RAD = Math.PI / 180;\n\n// `Math.radians` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  radians: function radians(degrees) {\n    return degrees * DEG_PER_RAD;\n  }\n});\n","var $ = require('../internals/export');\nvar scale = require('../internals/math-scale');\n\n// `Math.scale` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  scale: scale\n});\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar anObject = require('../internals/an-object');\nvar numberIsFinite = require('../internals/number-is-finite');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar SEEDED_RANDOM = 'Seeded Random';\nvar SEEDED_RANDOM_GENERATOR = SEEDED_RANDOM + ' Generator';\nvar SEED_TYPE_ERROR = 'Math.seededPRNG() argument should have a \"seed\" field with a finite value.';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(SEEDED_RANDOM_GENERATOR);\nvar TypeError = global.TypeError;\n\nvar $SeededRandomGenerator = createIteratorConstructor(function SeededRandomGenerator(seed) {\n  setInternalState(this, {\n    type: SEEDED_RANDOM_GENERATOR,\n    seed: seed % 2147483647\n  });\n}, SEEDED_RANDOM, function next() {\n  var state = getInternalState(this);\n  var seed = state.seed = (state.seed * 1103515245 + 12345) % 2147483647;\n  return { value: (seed & 1073741823) / 1073741823, done: false };\n});\n\n// `Math.seededPRNG` method\n// https://github.com/tc39/proposal-seeded-random\n// based on https://github.com/tc39/proposal-seeded-random/blob/78b8258835b57fc2100d076151ab506bc3202ae6/demo.html\n$({ target: 'Math', stat: true, forced: true }, {\n  seededPRNG: function seededPRNG(it) {\n    var seed = anObject(it).seed;\n    if (!numberIsFinite(seed)) throw TypeError(SEED_TYPE_ERROR);\n    return new $SeededRandomGenerator(seed);\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.signbit` method\n// https://github.com/tc39/proposal-Math.signbit\n$({ target: 'Math', stat: true }, {\n  signbit: function signbit(x) {\n    return (x = +x) == x && x == 0 ? 1 / x == -Infinity : x < 0;\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.umulh` method\n// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\n// TODO: Remove from `core-js@4`\n$({ target: 'Math', stat: true }, {\n  umulh: function umulh(u, v) {\n    var UINT16 = 0xFFFF;\n    var $u = +u;\n    var $v = +v;\n    var u0 = $u & UINT16;\n    var v0 = $v & UINT16;\n    var u1 = $u >>> 16;\n    var v1 = $v >>> 16;\n    var t = (u1 * v0 >>> 0) + (u0 * v0 >>> 16);\n    return u1 * v1 + (t >>> 16) + ((u0 * v1 >>> 0) + (t & UINT16) >>> 16);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar parseInt = require('../internals/number-parse-int');\n\nvar INVALID_NUMBER_REPRESENTATION = 'Invalid number representation';\nvar INVALID_RADIX = 'Invalid radix';\nvar RangeError = global.RangeError;\nvar SyntaxError = global.SyntaxError;\nvar TypeError = global.TypeError;\nvar valid = /^[\\da-z]+$/;\nvar charAt = uncurryThis(''.charAt);\nvar exec = uncurryThis(valid.exec);\nvar numberToString = uncurryThis(1.0.toString);\nvar stringSlice = uncurryThis(''.slice);\n\n// `Number.fromString` method\n// https://github.com/tc39/proposal-number-fromstring\n$({ target: 'Number', stat: true }, {\n  fromString: function fromString(string, radix) {\n    var sign = 1;\n    var R, mathNum;\n    if (typeof string != 'string') throw TypeError(INVALID_NUMBER_REPRESENTATION);\n    if (!string.length) throw SyntaxError(INVALID_NUMBER_REPRESENTATION);\n    if (charAt(string, 0) == '-') {\n      sign = -1;\n      string = stringSlice(string, 1);\n      if (!string.length) throw SyntaxError(INVALID_NUMBER_REPRESENTATION);\n    }\n    R = radix === undefined ? 10 : toIntegerOrInfinity(radix);\n    if (R < 2 || R > 36) throw RangeError(INVALID_RADIX);\n    if (!exec(valid, string) || numberToString(mathNum = parseInt(string, R), R) !== string) {\n      throw SyntaxError(INVALID_NUMBER_REPRESENTATION);\n    }\n    return sign * mathNum;\n  }\n});\n","'use strict';\n// https://github.com/tc39/proposal-observable\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar setSpecies = require('../internals/set-species');\nvar aCallable = require('../internals/a-callable');\nvar isCallable = require('../internals/is-callable');\nvar isConstructor = require('../internals/is-constructor');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar anInstance = require('../internals/an-instance');\nvar defineProperty = require('../internals/object-define-property').f;\nvar redefine = require('../internals/redefine');\nvar redefineAll = require('../internals/redefine-all');\nvar getIterator = require('../internals/get-iterator');\nvar getMethod = require('../internals/get-method');\nvar iterate = require('../internals/iterate');\nvar hostReportErrors = require('../internals/host-report-errors');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar $$OBSERVABLE = wellKnownSymbol('observable');\nvar OBSERVABLE = 'Observable';\nvar SUBSCRIPTION = 'Subscription';\nvar SUBSCRIPTION_OBSERVER = 'SubscriptionObserver';\nvar getterFor = InternalStateModule.getterFor;\nvar setInternalState = InternalStateModule.set;\nvar getObservableInternalState = getterFor(OBSERVABLE);\nvar getSubscriptionInternalState = getterFor(SUBSCRIPTION);\nvar getSubscriptionObserverInternalState = getterFor(SUBSCRIPTION_OBSERVER);\nvar Array = global.Array;\n\nvar SubscriptionState = function (observer) {\n  this.observer = anObject(observer);\n  this.cleanup = undefined;\n  this.subscriptionObserver = undefined;\n};\n\nSubscriptionState.prototype = {\n  type: SUBSCRIPTION,\n  clean: function () {\n    var cleanup = this.cleanup;\n    if (cleanup) {\n      this.cleanup = undefined;\n      try {\n        cleanup();\n      } catch (error) {\n        hostReportErrors(error);\n      }\n    }\n  },\n  close: function () {\n    if (!DESCRIPTORS) {\n      var subscription = this.facade;\n      var subscriptionObserver = this.subscriptionObserver;\n      subscription.closed = true;\n      if (subscriptionObserver) subscriptionObserver.closed = true;\n    } this.observer = undefined;\n  },\n  isClosed: function () {\n    return this.observer === undefined;\n  }\n};\n\nvar Subscription = function (observer, subscriber) {\n  var subscriptionState = setInternalState(this, new SubscriptionState(observer));\n  var start;\n  if (!DESCRIPTORS) this.closed = false;\n  try {\n    if (start = getMethod(observer, 'start')) call(start, observer, this);\n  } catch (error) {\n    hostReportErrors(error);\n  }\n  if (subscriptionState.isClosed()) return;\n  var subscriptionObserver = subscriptionState.subscriptionObserver = new SubscriptionObserver(subscriptionState);\n  try {\n    var cleanup = subscriber(subscriptionObserver);\n    var subscription = cleanup;\n    if (cleanup != null) subscriptionState.cleanup = isCallable(cleanup.unsubscribe)\n      ? function () { subscription.unsubscribe(); }\n      : aCallable(cleanup);\n  } catch (error) {\n    subscriptionObserver.error(error);\n    return;\n  } if (subscriptionState.isClosed()) subscriptionState.clean();\n};\n\nSubscription.prototype = redefineAll({}, {\n  unsubscribe: function unsubscribe() {\n    var subscriptionState = getSubscriptionInternalState(this);\n    if (!subscriptionState.isClosed()) {\n      subscriptionState.close();\n      subscriptionState.clean();\n    }\n  }\n});\n\nif (DESCRIPTORS) defineProperty(Subscription.prototype, 'closed', {\n  configurable: true,\n  get: function () {\n    return getSubscriptionInternalState(this).isClosed();\n  }\n});\n\nvar SubscriptionObserver = function (subscriptionState) {\n  setInternalState(this, {\n    type: SUBSCRIPTION_OBSERVER,\n    subscriptionState: subscriptionState\n  });\n  if (!DESCRIPTORS) this.closed = false;\n};\n\nSubscriptionObserver.prototype = redefineAll({}, {\n  next: function next(value) {\n    var subscriptionState = getSubscriptionObserverInternalState(this).subscriptionState;\n    if (!subscriptionState.isClosed()) {\n      var observer = subscriptionState.observer;\n      try {\n        var nextMethod = getMethod(observer, 'next');\n        if (nextMethod) call(nextMethod, observer, value);\n      } catch (error) {\n        hostReportErrors(error);\n      }\n    }\n  },\n  error: function error(value) {\n    var subscriptionState = getSubscriptionObserverInternalState(this).subscriptionState;\n    if (!subscriptionState.isClosed()) {\n      var observer = subscriptionState.observer;\n      subscriptionState.close();\n      try {\n        var errorMethod = getMethod(observer, 'error');\n        if (errorMethod) call(errorMethod, observer, value);\n        else hostReportErrors(value);\n      } catch (err) {\n        hostReportErrors(err);\n      } subscriptionState.clean();\n    }\n  },\n  complete: function complete() {\n    var subscriptionState = getSubscriptionObserverInternalState(this).subscriptionState;\n    if (!subscriptionState.isClosed()) {\n      var observer = subscriptionState.observer;\n      subscriptionState.close();\n      try {\n        var completeMethod = getMethod(observer, 'complete');\n        if (completeMethod) call(completeMethod, observer);\n      } catch (error) {\n        hostReportErrors(error);\n      } subscriptionState.clean();\n    }\n  }\n});\n\nif (DESCRIPTORS) defineProperty(SubscriptionObserver.prototype, 'closed', {\n  configurable: true,\n  get: function () {\n    return getSubscriptionObserverInternalState(this).subscriptionState.isClosed();\n  }\n});\n\nvar $Observable = function Observable(subscriber) {\n  anInstance(this, ObservablePrototype);\n  setInternalState(this, {\n    type: OBSERVABLE,\n    subscriber: aCallable(subscriber)\n  });\n};\n\nvar ObservablePrototype = $Observable.prototype;\n\nredefineAll(ObservablePrototype, {\n  subscribe: function subscribe(observer) {\n    var length = arguments.length;\n    return new Subscription(isCallable(observer) ? {\n      next: observer,\n      error: length > 1 ? arguments[1] : undefined,\n      complete: length > 2 ? arguments[2] : undefined\n    } : isObject(observer) ? observer : {}, getObservableInternalState(this).subscriber);\n  }\n});\n\nredefineAll($Observable, {\n  from: function from(x) {\n    var C = isConstructor(this) ? this : $Observable;\n    var observableMethod = getMethod(anObject(x), $$OBSERVABLE);\n    if (observableMethod) {\n      var observable = anObject(call(observableMethod, x));\n      return observable.constructor === C ? observable : new C(function (observer) {\n        return observable.subscribe(observer);\n      });\n    }\n    var iterator = getIterator(x);\n    return new C(function (observer) {\n      iterate(iterator, function (it, stop) {\n        observer.next(it);\n        if (observer.closed) return stop();\n      }, { IS_ITERATOR: true, INTERRUPTED: true });\n      observer.complete();\n    });\n  },\n  of: function of() {\n    var C = isConstructor(this) ? this : $Observable;\n    var length = arguments.length;\n    var items = Array(length);\n    var index = 0;\n    while (index < length) items[index] = arguments[index++];\n    return new C(function (observer) {\n      for (var i = 0; i < length; i++) {\n        observer.next(items[i]);\n        if (observer.closed) return;\n      } observer.complete();\n    });\n  }\n});\n\nredefine(ObservablePrototype, $$OBSERVABLE, function () { return this; });\n\n$({ global: true }, {\n  Observable: $Observable\n});\n\nsetSpecies(OBSERVABLE);\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar iterate = require('../internals/iterate');\n\n// `Promise.allSettled` method\n// https://tc39.es/ecma262/#sec-promise.allsettled\n$({ target: 'Promise', stat: true }, {\n  allSettled: function allSettled(iterable) {\n    var C = this;\n    var capability = newPromiseCapabilityModule.f(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var promiseResolve = aCallable(C.resolve);\n      var values = [];\n      var counter = 0;\n      var remaining = 1;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyCalled = false;\n        remaining++;\n        call(promiseResolve, C, promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = { status: 'fulfilled', value: value };\n          --remaining || resolve(values);\n        }, function (error) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = { status: 'rejected', reason: error };\n          --remaining || resolve(values);\n        });\n      });\n      --remaining || resolve(values);\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar aCallable = require('../internals/a-callable');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar iterate = require('../internals/iterate');\n\nvar PROMISE_ANY_ERROR = 'No one promise resolved';\n\n// `Promise.any` method\n// https://tc39.es/ecma262/#sec-promise.any\n$({ target: 'Promise', stat: true }, {\n  any: function any(iterable) {\n    var C = this;\n    var AggregateError = getBuiltIn('AggregateError');\n    var capability = newPromiseCapabilityModule.f(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var promiseResolve = aCallable(C.resolve);\n      var errors = [];\n      var counter = 0;\n      var remaining = 1;\n      var alreadyResolved = false;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyRejected = false;\n        remaining++;\n        call(promiseResolve, C, promise).then(function (value) {\n          if (alreadyRejected || alreadyResolved) return;\n          alreadyResolved = true;\n          resolve(value);\n        }, function (error) {\n          if (alreadyRejected || alreadyResolved) return;\n          alreadyRejected = true;\n          errors[index] = error;\n          --remaining || reject(new AggregateError(errors, PROMISE_ANY_ERROR));\n        });\n      });\n      --remaining || reject(new AggregateError(errors, PROMISE_ANY_ERROR));\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\n\n// `Promise.try` method\n// https://github.com/tc39/proposal-promise-try\n$({ target: 'Promise', stat: true }, {\n  'try': function (callbackfn) {\n    var promiseCapability = newPromiseCapabilityModule.f(this);\n    var result = perform(callbackfn);\n    (result.error ? promiseCapability.reject : promiseCapability.resolve)(result.value);\n    return promiseCapability.promise;\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar toMetadataKey = ReflectMetadataModule.toKey;\nvar ordinaryDefineOwnMetadata = ReflectMetadataModule.set;\n\n// `Reflect.defineMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  defineMetadata: function defineMetadata(metadataKey, metadataValue, target /* , targetKey */) {\n    var targetKey = arguments.length < 4 ? undefined : toMetadataKey(arguments[3]);\n    ordinaryDefineOwnMetadata(metadataKey, metadataValue, anObject(target), targetKey);\n  }\n});\n","// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.map');\nrequire('../modules/es.weak-map');\nvar getBuiltIn = require('../internals/get-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar shared = require('../internals/shared');\n\nvar Map = getBuiltIn('Map');\nvar WeakMap = getBuiltIn('WeakMap');\nvar push = uncurryThis([].push);\n\nvar metadata = shared('metadata');\nvar store = metadata.store || (metadata.store = new WeakMap());\n\nvar getOrCreateMetadataMap = function (target, targetKey, create) {\n  var targetMetadata = store.get(target);\n  if (!targetMetadata) {\n    if (!create) return;\n    store.set(target, targetMetadata = new Map());\n  }\n  var keyMetadata = targetMetadata.get(targetKey);\n  if (!keyMetadata) {\n    if (!create) return;\n    targetMetadata.set(targetKey, keyMetadata = new Map());\n  } return keyMetadata;\n};\n\nvar ordinaryHasOwnMetadata = function (MetadataKey, O, P) {\n  var metadataMap = getOrCreateMetadataMap(O, P, false);\n  return metadataMap === undefined ? false : metadataMap.has(MetadataKey);\n};\n\nvar ordinaryGetOwnMetadata = function (MetadataKey, O, P) {\n  var metadataMap = getOrCreateMetadataMap(O, P, false);\n  return metadataMap === undefined ? undefined : metadataMap.get(MetadataKey);\n};\n\nvar ordinaryDefineOwnMetadata = function (MetadataKey, MetadataValue, O, P) {\n  getOrCreateMetadataMap(O, P, true).set(MetadataKey, MetadataValue);\n};\n\nvar ordinaryOwnMetadataKeys = function (target, targetKey) {\n  var metadataMap = getOrCreateMetadataMap(target, targetKey, false);\n  var keys = [];\n  if (metadataMap) metadataMap.forEach(function (_, key) { push(keys, key); });\n  return keys;\n};\n\nvar toMetadataKey = function (it) {\n  return it === undefined || typeof it == 'symbol' ? it : String(it);\n};\n\nmodule.exports = {\n  store: store,\n  getMap: getOrCreateMetadataMap,\n  has: ordinaryHasOwnMetadata,\n  get: ordinaryGetOwnMetadata,\n  set: ordinaryDefineOwnMetadata,\n  keys: ordinaryOwnMetadataKeys,\n  toKey: toMetadataKey\n};\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar toMetadataKey = ReflectMetadataModule.toKey;\nvar getOrCreateMetadataMap = ReflectMetadataModule.getMap;\nvar store = ReflectMetadataModule.store;\n\n// `Reflect.deleteMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  deleteMetadata: function deleteMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    var metadataMap = getOrCreateMetadataMap(anObject(target), targetKey, false);\n    if (metadataMap === undefined || !metadataMap['delete'](metadataKey)) return false;\n    if (metadataMap.size) return true;\n    var targetMetadata = store.get(target);\n    targetMetadata['delete'](targetKey);\n    return !!targetMetadata.size || store['delete'](target);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\n\nvar ordinaryHasOwnMetadata = ReflectMetadataModule.has;\nvar ordinaryGetOwnMetadata = ReflectMetadataModule.get;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\nvar ordinaryGetMetadata = function (MetadataKey, O, P) {\n  var hasOwn = ordinaryHasOwnMetadata(MetadataKey, O, P);\n  if (hasOwn) return ordinaryGetOwnMetadata(MetadataKey, O, P);\n  var parent = getPrototypeOf(O);\n  return parent !== null ? ordinaryGetMetadata(MetadataKey, parent, P) : undefined;\n};\n\n// `Reflect.getMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  getMetadata: function getMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    return ordinaryGetMetadata(metadataKey, anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar $arrayUniqueBy = require('../internals/array-unique-by');\n\nvar arrayUniqueBy = uncurryThis($arrayUniqueBy);\nvar concat = uncurryThis([].concat);\nvar ordinaryOwnMetadataKeys = ReflectMetadataModule.keys;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\nvar ordinaryMetadataKeys = function (O, P) {\n  var oKeys = ordinaryOwnMetadataKeys(O, P);\n  var parent = getPrototypeOf(O);\n  if (parent === null) return oKeys;\n  var pKeys = ordinaryMetadataKeys(parent, P);\n  return pKeys.length ? oKeys.length ? arrayUniqueBy(concat(oKeys, pKeys)) : pKeys : oKeys;\n};\n\n// `Reflect.getMetadataKeys` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  getMetadataKeys: function getMetadataKeys(target /* , targetKey */) {\n    var targetKey = arguments.length < 2 ? undefined : toMetadataKey(arguments[1]);\n    return ordinaryMetadataKeys(anObject(target), targetKey);\n  }\n});\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toObject = require('../internals/to-object');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\nvar Map = getBuiltIn('Map');\nvar MapPrototype = Map.prototype;\nvar mapForEach = uncurryThis(MapPrototype.forEach);\nvar mapHas = uncurryThis(MapPrototype.has);\nvar mapSet = uncurryThis(MapPrototype.set);\nvar push = uncurryThis([].push);\n\n// `Array.prototype.uniqueBy` method\n// https://github.com/tc39/proposal-array-unique\nmodule.exports = function uniqueBy(resolver) {\n  var that = toObject(this);\n  var length = lengthOfArrayLike(that);\n  var result = arraySpeciesCreate(that, 0);\n  var map = new Map();\n  var resolverFunction = resolver != null ? aCallable(resolver) : function (value) {\n    return value;\n  };\n  var index, item, key;\n  for (index = 0; index < length; index++) {\n    item = that[index];\n    key = resolverFunction(item);\n    if (!mapHas(map, key)) mapSet(map, key, item);\n  }\n  mapForEach(map, function (value) {\n    push(result, value);\n  });\n  return result;\n};\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar ordinaryGetOwnMetadata = ReflectMetadataModule.get;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\n// `Reflect.getOwnMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  getOwnMetadata: function getOwnMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    return ordinaryGetOwnMetadata(metadataKey, anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar ordinaryOwnMetadataKeys = ReflectMetadataModule.keys;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\n// `Reflect.getOwnMetadataKeys` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  getOwnMetadataKeys: function getOwnMetadataKeys(target /* , targetKey */) {\n    var targetKey = arguments.length < 2 ? undefined : toMetadataKey(arguments[1]);\n    return ordinaryOwnMetadataKeys(anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\n\nvar ordinaryHasOwnMetadata = ReflectMetadataModule.has;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\nvar ordinaryHasMetadata = function (MetadataKey, O, P) {\n  var hasOwn = ordinaryHasOwnMetadata(MetadataKey, O, P);\n  if (hasOwn) return true;\n  var parent = getPrototypeOf(O);\n  return parent !== null ? ordinaryHasMetadata(MetadataKey, parent, P) : false;\n};\n\n// `Reflect.hasMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  hasMetadata: function hasMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    return ordinaryHasMetadata(metadataKey, anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar ordinaryHasOwnMetadata = ReflectMetadataModule.has;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\n// `Reflect.hasOwnMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  hasOwnMetadata: function hasOwnMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    return ordinaryHasOwnMetadata(metadataKey, anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar toMetadataKey = ReflectMetadataModule.toKey;\nvar ordinaryDefineOwnMetadata = ReflectMetadataModule.set;\n\n// `Reflect.metadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  metadata: function metadata(metadataKey, metadataValue) {\n    return function decorator(target, key) {\n      ordinaryDefineOwnMetadata(metadataKey, metadataValue, anObject(target), toMetadataKey(key));\n    };\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar addAll = require('../internals/collection-add-all');\n\n// `Set.prototype.addAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  addAll: addAll\n});\n","'use strict';\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\n\n// https://github.com/tc39/collection-methods\nmodule.exports = function addAll(/* ...elements */) {\n  var set = anObject(this);\n  var adder = aCallable(set.add);\n  for (var k = 0, len = arguments.length; k < len; k++) {\n    call(adder, set, arguments[k]);\n  }\n  return set;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar deleteAll = require('../internals/collection-delete-all');\n\n// `Set.prototype.deleteAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  deleteAll: deleteAll\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.difference` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  difference: function difference(iterable) {\n    var set = anObject(this);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))(set);\n    var remover = aCallable(newSet['delete']);\n    iterate(iterable, function (value) {\n      call(remover, newSet, value);\n    });\n    return newSet;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.every` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  every: function every(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return !iterate(iterator, function (value, stop) {\n      if (!boundFunction(value, value, set)) return stop();\n    }, { IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","var call = require('../internals/function-call');\n\nmodule.exports = function (it) {\n  // eslint-disable-next-line es/no-set -- safe\n  return call(Set.prototype.values, it);\n};\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.filter` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))();\n    var adder = aCallable(newSet.add);\n    iterate(iterator, function (value) {\n      if (boundFunction(value, value, set)) call(adder, newSet, value);\n    }, { IS_ITERATOR: true });\n    return newSet;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.find` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  find: function find(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (value, stop) {\n      if (boundFunction(value, value, set)) return stop(value);\n    }, { IS_ITERATOR: true, INTERRUPTED: true }).result;\n  }\n});\n","var $ = require('../internals/export');\nvar from = require('../internals/collection-from');\n\n// `Set.from` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-set.from\n$({ target: 'Set', stat: true }, {\n  from: from\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.intersection` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  intersection: function intersection(iterable) {\n    var set = anObject(this);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))();\n    var hasCheck = aCallable(set.has);\n    var adder = aCallable(newSet.add);\n    iterate(iterable, function (value) {\n      if (call(hasCheck, set, value)) call(adder, newSet, value);\n    });\n    return newSet;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.isDisjointFrom` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isDisjointFrom\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  isDisjointFrom: function isDisjointFrom(iterable) {\n    var set = anObject(this);\n    var hasCheck = aCallable(set.has);\n    return !iterate(iterable, function (value, stop) {\n      if (call(hasCheck, set, value) === true) return stop();\n    }, { INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar isCallable = require('../internals/is-callable');\nvar anObject = require('../internals/an-object');\nvar getIterator = require('../internals/get-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.isSubsetOf` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isSubsetOf\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  isSubsetOf: function isSubsetOf(iterable) {\n    var iterator = getIterator(this);\n    var otherSet = anObject(iterable);\n    var hasCheck = otherSet.has;\n    if (!isCallable(hasCheck)) {\n      otherSet = new (getBuiltIn('Set'))(iterable);\n      hasCheck = aCallable(otherSet.has);\n    }\n    return !iterate(iterator, function (value, stop) {\n      if (call(hasCheck, otherSet, value) === false) return stop();\n    }, { IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.isSupersetOf` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isSupersetOf\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  isSupersetOf: function isSupersetOf(iterable) {\n    var set = anObject(this);\n    var hasCheck = aCallable(set.has);\n    return !iterate(iterable, function (value, stop) {\n      if (call(hasCheck, set, value) === false) return stop();\n    }, { INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar anObject = require('../internals/an-object');\nvar toString = require('../internals/to-string');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\nvar arrayJoin = uncurryThis([].join);\nvar push = [].push;\n\n// `Set.prototype.join` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  join: function join(separator) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var sep = separator === undefined ? ',' : toString(separator);\n    var result = [];\n    iterate(iterator, push, { that: result, IS_ITERATOR: true });\n    return arrayJoin(result, sep);\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.map` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  map: function map(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))();\n    var adder = aCallable(newSet.add);\n    iterate(iterator, function (value) {\n      call(adder, newSet, boundFunction(value, value, set));\n    }, { IS_ITERATOR: true });\n    return newSet;\n  }\n});\n","var $ = require('../internals/export');\nvar of = require('../internals/collection-of');\n\n// `Set.of` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-set.of\n$({ target: 'Set', stat: true }, {\n  of: of\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar IS_PURE = require('../internals/is-pure');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\nvar TypeError = global.TypeError;\n\n// `Set.prototype.reduce` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  reduce: function reduce(callbackfn /* , initialValue */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var noInitial = arguments.length < 2;\n    var accumulator = noInitial ? undefined : arguments[1];\n    aCallable(callbackfn);\n    iterate(iterator, function (value) {\n      if (noInitial) {\n        noInitial = false;\n        accumulator = value;\n      } else {\n        accumulator = callbackfn(accumulator, value, value, set);\n      }\n    }, { IS_ITERATOR: true });\n    if (noInitial) throw TypeError('Reduce of empty set with no initial value');\n    return accumulator;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.some` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  some: function some(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (value, stop) {\n      if (boundFunction(value, value, set)) return stop();\n    }, { IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.symmetricDifference` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  symmetricDifference: function symmetricDifference(iterable) {\n    var set = anObject(this);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))(set);\n    var remover = aCallable(newSet['delete']);\n    var adder = aCallable(newSet.add);\n    iterate(iterable, function (value) {\n      call(remover, newSet, value) || call(adder, newSet, value);\n    });\n    return newSet;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar getBuiltIn = require('../internals/get-built-in');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.union` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  union: function union(iterable) {\n    var set = anObject(this);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))(set);\n    iterate(iterable, aCallable(newSet.add), { that: newSet });\n    return newSet;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar charAt = require('../internals/string-multibyte').charAt;\nvar fails = require('../internals/fails');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toString = require('../internals/to-string');\n\nvar FORCED = fails(function () {\n  return '𠮷'.at(-2) !== '𠮷';\n});\n\n// `String.prototype.at` method\n// https://github.com/mathiasbynens/String.prototype.at\n$({ target: 'String', proto: true, forced: FORCED }, {\n  at: function at(index) {\n    var S = toString(requireObjectCoercible(this));\n    var len = S.length;\n    var relativeIndex = toIntegerOrInfinity(index);\n    var k = relativeIndex >= 0 ? relativeIndex : len + relativeIndex;\n    return (k < 0 || k >= len) ? undefined : charAt(S, k);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toString = require('../internals/to-string');\nvar InternalStateModule = require('../internals/internal-state');\nvar StringMultibyteModule = require('../internals/string-multibyte');\n\nvar codeAt = StringMultibyteModule.codeAt;\nvar charAt = StringMultibyteModule.charAt;\nvar STRING_ITERATOR = 'String Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(STRING_ITERATOR);\n\n// TODO: unify with String#@@iterator\nvar $StringIterator = createIteratorConstructor(function StringIterator(string) {\n  setInternalState(this, {\n    type: STRING_ITERATOR,\n    string: string,\n    index: 0\n  });\n}, 'String', function next() {\n  var state = getInternalState(this);\n  var string = state.string;\n  var index = state.index;\n  var point;\n  if (index >= string.length) return { value: undefined, done: true };\n  point = charAt(string, index);\n  state.index += point.length;\n  return { value: { codePoint: codeAt(point, 0), position: index }, done: false };\n});\n\n// `String.prototype.codePoints` method\n// https://github.com/tc39/proposal-string-prototype-codepoints\n$({ target: 'String', proto: true }, {\n  codePoints: function codePoints() {\n    return new $StringIterator(toString(requireObjectCoercible(this)));\n  }\n});\n","'use strict';\n/* eslint-disable es/no-string-prototype-matchall -- safe */\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar anObject = require('../internals/an-object');\nvar classof = require('../internals/classof-raw');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar isRegExp = require('../internals/is-regexp');\nvar regExpFlags = require('../internals/regexp-flags');\nvar getMethod = require('../internals/get-method');\nvar redefine = require('../internals/redefine');\nvar fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar speciesConstructor = require('../internals/species-constructor');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar regExpExec = require('../internals/regexp-exec-abstract');\nvar InternalStateModule = require('../internals/internal-state');\nvar IS_PURE = require('../internals/is-pure');\n\nvar MATCH_ALL = wellKnownSymbol('matchAll');\nvar REGEXP_STRING = 'RegExp String';\nvar REGEXP_STRING_ITERATOR = REGEXP_STRING + ' Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(REGEXP_STRING_ITERATOR);\nvar RegExpPrototype = RegExp.prototype;\nvar TypeError = global.TypeError;\nvar getFlags = uncurryThis(regExpFlags);\nvar stringIndexOf = uncurryThis(''.indexOf);\nvar un$MatchAll = uncurryThis(''.matchAll);\n\nvar WORKS_WITH_NON_GLOBAL_REGEX = !!un$MatchAll && !fails(function () {\n  un$MatchAll('a', /./);\n});\n\nvar $RegExpStringIterator = createIteratorConstructor(function RegExpStringIterator(regexp, string, $global, fullUnicode) {\n  setInternalState(this, {\n    type: REGEXP_STRING_ITERATOR,\n    regexp: regexp,\n    string: string,\n    global: $global,\n    unicode: fullUnicode,\n    done: false\n  });\n}, REGEXP_STRING, function next() {\n  var state = getInternalState(this);\n  if (state.done) return { value: undefined, done: true };\n  var R = state.regexp;\n  var S = state.string;\n  var match = regExpExec(R, S);\n  if (match === null) return { value: undefined, done: state.done = true };\n  if (state.global) {\n    if (toString(match[0]) === '') R.lastIndex = advanceStringIndex(S, toLength(R.lastIndex), state.unicode);\n    return { value: match, done: false };\n  }\n  state.done = true;\n  return { value: match, done: false };\n});\n\nvar $matchAll = function (string) {\n  var R = anObject(this);\n  var S = toString(string);\n  var C, flagsValue, flags, matcher, $global, fullUnicode;\n  C = speciesConstructor(R, RegExp);\n  flagsValue = R.flags;\n  if (flagsValue === undefined && isPrototypeOf(RegExpPrototype, R) && !('flags' in RegExpPrototype)) {\n    flagsValue = getFlags(R);\n  }\n  flags = flagsValue === undefined ? '' : toString(flagsValue);\n  matcher = new C(C === RegExp ? R.source : R, flags);\n  $global = !!~stringIndexOf(flags, 'g');\n  fullUnicode = !!~stringIndexOf(flags, 'u');\n  matcher.lastIndex = toLength(R.lastIndex);\n  return new $RegExpStringIterator(matcher, S, $global, fullUnicode);\n};\n\n// `String.prototype.matchAll` method\n// https://tc39.es/ecma262/#sec-string.prototype.matchall\n$({ target: 'String', proto: true, forced: WORKS_WITH_NON_GLOBAL_REGEX }, {\n  matchAll: function matchAll(regexp) {\n    var O = requireObjectCoercible(this);\n    var flags, S, matcher, rx;\n    if (regexp != null) {\n      if (isRegExp(regexp)) {\n        flags = toString(requireObjectCoercible('flags' in RegExpPrototype\n          ? regexp.flags\n          : getFlags(regexp)\n        ));\n        if (!~stringIndexOf(flags, 'g')) throw TypeError('`.matchAll` does not allow non-global regexes');\n      }\n      if (WORKS_WITH_NON_GLOBAL_REGEX) return un$MatchAll(O, regexp);\n      matcher = getMethod(regexp, MATCH_ALL);\n      if (matcher === undefined && IS_PURE && classof(regexp) == 'RegExp') matcher = $matchAll;\n      if (matcher) return call(matcher, regexp, O);\n    } else if (WORKS_WITH_NON_GLOBAL_REGEX) return un$MatchAll(O, regexp);\n    S = toString(O);\n    rx = new RegExp(regexp, 'g');\n    return IS_PURE ? call($matchAll, rx, S) : rx[MATCH_ALL](S);\n  }\n});\n\nIS_PURE || MATCH_ALL in RegExpPrototype || redefine(RegExpPrototype, MATCH_ALL, $matchAll);\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar isCallable = require('../internals/is-callable');\nvar isRegExp = require('../internals/is-regexp');\nvar toString = require('../internals/to-string');\nvar getMethod = require('../internals/get-method');\nvar regExpFlags = require('../internals/regexp-flags');\nvar getSubstitution = require('../internals/get-substitution');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar REPLACE = wellKnownSymbol('replace');\nvar RegExpPrototype = RegExp.prototype;\nvar TypeError = global.TypeError;\nvar getFlags = uncurryThis(regExpFlags);\nvar indexOf = uncurryThis(''.indexOf);\nvar replace = uncurryThis(''.replace);\nvar stringSlice = uncurryThis(''.slice);\nvar max = Math.max;\n\nvar stringIndexOf = function (string, searchValue, fromIndex) {\n  if (fromIndex > string.length) return -1;\n  if (searchValue === '') return fromIndex;\n  return indexOf(string, searchValue, fromIndex);\n};\n\n// `String.prototype.replaceAll` method\n// https://tc39.es/ecma262/#sec-string.prototype.replaceall\n$({ target: 'String', proto: true }, {\n  replaceAll: function replaceAll(searchValue, replaceValue) {\n    var O = requireObjectCoercible(this);\n    var IS_REG_EXP, flags, replacer, string, searchString, functionalReplace, searchLength, advanceBy, replacement;\n    var position = 0;\n    var endOfLastMatch = 0;\n    var result = '';\n    if (searchValue != null) {\n      IS_REG_EXP = isRegExp(searchValue);\n      if (IS_REG_EXP) {\n        flags = toString(requireObjectCoercible('flags' in RegExpPrototype\n          ? searchValue.flags\n          : getFlags(searchValue)\n        ));\n        if (!~indexOf(flags, 'g')) throw TypeError('`.replaceAll` does not allow non-global regexes');\n      }\n      replacer = getMethod(searchValue, REPLACE);\n      if (replacer) {\n        return call(replacer, searchValue, O, replaceValue);\n      } else if (IS_PURE && IS_REG_EXP) {\n        return replace(toString(O), searchValue, replaceValue);\n      }\n    }\n    string = toString(O);\n    searchString = toString(searchValue);\n    functionalReplace = isCallable(replaceValue);\n    if (!functionalReplace) replaceValue = toString(replaceValue);\n    searchLength = searchString.length;\n    advanceBy = max(1, searchLength);\n    position = stringIndexOf(string, searchString, 0);\n    while (position !== -1) {\n      replacement = functionalReplace\n        ? toString(replaceValue(searchString, position, string))\n        : getSubstitution(searchString, string, position, [], undefined, replaceValue);\n      result += stringSlice(string, endOfLastMatch, position) + replacement;\n      endOfLastMatch = position + searchLength;\n      position = stringIndexOf(string, searchString, position + advanceBy);\n    }\n    if (endOfLastMatch < string.length) {\n      result += stringSlice(string, endOfLastMatch);\n    }\n    return result;\n  }\n});\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.dispose` well-known symbol\n// https://github.com/tc39/proposal-using-statement\ndefineWellKnownSymbol('dispose');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.observable` well-known symbol\n// https://github.com/tc39/proposal-observable\ndefineWellKnownSymbol('observable');\n","// TODO: remove from `core-js@4`\nvar defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.patternMatch` well-known symbol\n// https://github.com/tc39/proposal-pattern-matching\ndefineWellKnownSymbol('patternMatch');\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar deleteAll = require('../internals/collection-delete-all');\n\n// `WeakMap.prototype.deleteAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'WeakMap', proto: true, real: true, forced: IS_PURE }, {\n  deleteAll: deleteAll\n});\n","var $ = require('../internals/export');\nvar from = require('../internals/collection-from');\n\n// `WeakMap.from` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-weakmap.from\n$({ target: 'WeakMap', stat: true }, {\n  from: from\n});\n","var $ = require('../internals/export');\nvar of = require('../internals/collection-of');\n\n// `WeakMap.of` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-weakmap.of\n$({ target: 'WeakMap', stat: true }, {\n  of: of\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar addAll = require('../internals/collection-add-all');\n\n// `WeakSet.prototype.addAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'WeakSet', proto: true, real: true, forced: IS_PURE }, {\n  addAll: addAll\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar deleteAll = require('../internals/collection-delete-all');\n\n// `WeakSet.prototype.deleteAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'WeakSet', proto: true, real: true, forced: IS_PURE }, {\n  deleteAll: deleteAll\n});\n","var $ = require('../internals/export');\nvar from = require('../internals/collection-from');\n\n// `WeakSet.from` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-weakset.from\n$({ target: 'WeakSet', stat: true }, {\n  from: from\n});\n","var $ = require('../internals/export');\nvar of = require('../internals/collection-of');\n\n// `WeakSet.of` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-weakset.of\n$({ target: 'WeakSet', stat: true }, {\n  of: of\n});\n","var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar DOMTokenListPrototype = require('../internals/dom-token-list-prototype');\nvar forEach = require('../internals/array-for-each');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nvar handlePrototype = function (CollectionPrototype) {\n  // some Chrome versions have non-configurable methods on DOMTokenList\n  if (CollectionPrototype && CollectionPrototype.forEach !== forEach) try {\n    createNonEnumerableProperty(CollectionPrototype, 'forEach', forEach);\n  } catch (error) {\n    CollectionPrototype.forEach = forEach;\n  }\n};\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  if (DOMIterables[COLLECTION_NAME]) {\n    handlePrototype(global[COLLECTION_NAME] && global[COLLECTION_NAME].prototype);\n  }\n}\n\nhandlePrototype(DOMTokenListPrototype);\n","// iterable DOM collections\n// flag - `iterable` interface - 'entries', 'keys', 'values', 'forEach' methods\nmodule.exports = {\n  CSSRuleList: 0,\n  CSSStyleDeclaration: 0,\n  CSSValueList: 0,\n  ClientRectList: 0,\n  DOMRectList: 0,\n  DOMStringList: 0,\n  DOMTokenList: 1,\n  DataTransferItemList: 0,\n  FileList: 0,\n  HTMLAllCollection: 0,\n  HTMLCollection: 0,\n  HTMLFormElement: 0,\n  HTMLSelectElement: 0,\n  MediaList: 0,\n  MimeTypeArray: 0,\n  NamedNodeMap: 0,\n  NodeList: 1,\n  PaintRequestList: 0,\n  Plugin: 0,\n  PluginArray: 0,\n  SVGLengthList: 0,\n  SVGNumberList: 0,\n  SVGPathSegList: 0,\n  SVGPointList: 0,\n  SVGStringList: 0,\n  SVGTransformList: 0,\n  SourceBufferList: 0,\n  StyleSheetList: 0,\n  TextTrackCueList: 0,\n  TextTrackList: 0,\n  TouchList: 0\n};\n","// in old WebKit versions, `element.classList` is not an instance of global `DOMTokenList`\nvar documentCreateElement = require('../internals/document-create-element');\n\nvar classList = documentCreateElement('span').classList;\nvar DOMTokenListPrototype = classList && classList.constructor && classList.constructor.prototype;\n\nmodule.exports = DOMTokenListPrototype === Object.prototype ? undefined : DOMTokenListPrototype;\n","'use strict';\nvar $forEach = require('../internals/array-iteration').forEach;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar STRICT_METHOD = arrayMethodIsStrict('forEach');\n\n// `Array.prototype.forEach` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.foreach\nmodule.exports = !STRICT_METHOD ? function forEach(callbackfn /* , thisArg */) {\n  return $forEach(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n// eslint-disable-next-line es/no-array-prototype-foreach -- safe\n} : [].forEach;\n","var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar DOMTokenListPrototype = require('../internals/dom-token-list-prototype');\nvar ArrayIteratorMethods = require('../modules/es.array.iterator');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar ArrayValues = ArrayIteratorMethods.values;\n\nvar handlePrototype = function (CollectionPrototype, COLLECTION_NAME) {\n  if (CollectionPrototype) {\n    // some Chrome versions have non-configurable methods on DOMTokenList\n    if (CollectionPrototype[ITERATOR] !== ArrayValues) try {\n      createNonEnumerableProperty(CollectionPrototype, ITERATOR, ArrayValues);\n    } catch (error) {\n      CollectionPrototype[ITERATOR] = ArrayValues;\n    }\n    if (!CollectionPrototype[TO_STRING_TAG]) {\n      createNonEnumerableProperty(CollectionPrototype, TO_STRING_TAG, COLLECTION_NAME);\n    }\n    if (DOMIterables[COLLECTION_NAME]) for (var METHOD_NAME in ArrayIteratorMethods) {\n      // some Chrome versions have non-configurable methods on DOMTokenList\n      if (CollectionPrototype[METHOD_NAME] !== ArrayIteratorMethods[METHOD_NAME]) try {\n        createNonEnumerableProperty(CollectionPrototype, METHOD_NAME, ArrayIteratorMethods[METHOD_NAME]);\n      } catch (error) {\n        CollectionPrototype[METHOD_NAME] = ArrayIteratorMethods[METHOD_NAME];\n      }\n    }\n  }\n};\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  handlePrototype(global[COLLECTION_NAME] && global[COLLECTION_NAME].prototype, COLLECTION_NAME);\n}\n\nhandlePrototype(DOMTokenListPrototype, 'DOMTokenList');\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar task = require('../internals/task');\n\nvar FORCED = !global.setImmediate || !global.clearImmediate;\n\n// http://w3c.github.io/setImmediate/\n$({ global: true, bind: true, enumerable: true, forced: FORCED }, {\n  // `setImmediate` method\n  // http://w3c.github.io/setImmediate/#si-setImmediate\n  setImmediate: task.set,\n  // `clearImmediate` method\n  // http://w3c.github.io/setImmediate/#si-clearImmediate\n  clearImmediate: task.clear\n});\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar microtask = require('../internals/microtask');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar process = global.process;\n\n// `queueMicrotask` method\n// https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-queuemicrotask\n$({ global: true, enumerable: true, noTargetGet: true }, {\n  queueMicrotask: function queueMicrotask(fn) {\n    var domain = IS_NODE && process.domain;\n    microtask(domain ? domain.bind(fn) : fn);\n  }\n});\n","'use strict';\n// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.string.iterator');\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar USE_NATIVE_URL = require('../internals/native-url');\nvar global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar defineProperties = require('../internals/object-define-properties').f;\nvar redefine = require('../internals/redefine');\nvar anInstance = require('../internals/an-instance');\nvar hasOwn = require('../internals/has-own-property');\nvar assign = require('../internals/object-assign');\nvar arrayFrom = require('../internals/array-from');\nvar arraySlice = require('../internals/array-slice-simple');\nvar codeAt = require('../internals/string-multibyte').codeAt;\nvar toASCII = require('../internals/string-punycode-to-ascii');\nvar $toString = require('../internals/to-string');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar URLSearchParamsModule = require('../modules/web.url-search-params');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar setInternalState = InternalStateModule.set;\nvar getInternalURLState = InternalStateModule.getterFor('URL');\nvar URLSearchParams = URLSearchParamsModule.URLSearchParams;\nvar getInternalSearchParamsState = URLSearchParamsModule.getState;\n\nvar NativeURL = global.URL;\nvar TypeError = global.TypeError;\nvar parseInt = global.parseInt;\nvar floor = Math.floor;\nvar pow = Math.pow;\nvar charAt = uncurryThis(''.charAt);\nvar exec = uncurryThis(/./.exec);\nvar join = uncurryThis([].join);\nvar numberToString = uncurryThis(1.0.toString);\nvar pop = uncurryThis([].pop);\nvar push = uncurryThis([].push);\nvar replace = uncurryThis(''.replace);\nvar shift = uncurryThis([].shift);\nvar split = uncurryThis(''.split);\nvar stringSlice = uncurryThis(''.slice);\nvar toLowerCase = uncurryThis(''.toLowerCase);\nvar unshift = uncurryThis([].unshift);\n\nvar INVALID_AUTHORITY = 'Invalid authority';\nvar INVALID_SCHEME = 'Invalid scheme';\nvar INVALID_HOST = 'Invalid host';\nvar INVALID_PORT = 'Invalid port';\n\nvar ALPHA = /[a-z]/i;\n// eslint-disable-next-line regexp/no-obscure-range -- safe\nvar ALPHANUMERIC = /[\\d+-.a-z]/i;\nvar DIGIT = /\\d/;\nvar HEX_START = /^0x/i;\nvar OCT = /^[0-7]+$/;\nvar DEC = /^\\d+$/;\nvar HEX = /^[\\da-f]+$/i;\n/* eslint-disable regexp/no-control-character -- safe */\nvar FORBIDDEN_HOST_CODE_POINT = /[\\0\\t\\n\\r #%/:<>?@[\\\\\\]^|]/;\nvar FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT = /[\\0\\t\\n\\r #/:<>?@[\\\\\\]^|]/;\nvar LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE = /^[\\u0000-\\u0020]+|[\\u0000-\\u0020]+$/g;\nvar TAB_AND_NEW_LINE = /[\\t\\n\\r]/g;\n/* eslint-enable regexp/no-control-character -- safe */\nvar EOF;\n\n// https://url.spec.whatwg.org/#ipv4-number-parser\nvar parseIPv4 = function (input) {\n  var parts = split(input, '.');\n  var partsLength, numbers, index, part, radix, number, ipv4;\n  if (parts.length && parts[parts.length - 1] == '') {\n    parts.length--;\n  }\n  partsLength = parts.length;\n  if (partsLength > 4) return input;\n  numbers = [];\n  for (index = 0; index < partsLength; index++) {\n    part = parts[index];\n    if (part == '') return input;\n    radix = 10;\n    if (part.length > 1 && charAt(part, 0) == '0') {\n      radix = exec(HEX_START, part) ? 16 : 8;\n      part = stringSlice(part, radix == 8 ? 1 : 2);\n    }\n    if (part === '') {\n      number = 0;\n    } else {\n      if (!exec(radix == 10 ? DEC : radix == 8 ? OCT : HEX, part)) return input;\n      number = parseInt(part, radix);\n    }\n    push(numbers, number);\n  }\n  for (index = 0; index < partsLength; index++) {\n    number = numbers[index];\n    if (index == partsLength - 1) {\n      if (number >= pow(256, 5 - partsLength)) return null;\n    } else if (number > 255) return null;\n  }\n  ipv4 = pop(numbers);\n  for (index = 0; index < numbers.length; index++) {\n    ipv4 += numbers[index] * pow(256, 3 - index);\n  }\n  return ipv4;\n};\n\n// https://url.spec.whatwg.org/#concept-ipv6-parser\n// eslint-disable-next-line max-statements -- TODO\nvar parseIPv6 = function (input) {\n  var address = [0, 0, 0, 0, 0, 0, 0, 0];\n  var pieceIndex = 0;\n  var compress = null;\n  var pointer = 0;\n  var value, length, numbersSeen, ipv4Piece, number, swaps, swap;\n\n  var chr = function () {\n    return charAt(input, pointer);\n  };\n\n  if (chr() == ':') {\n    if (charAt(input, 1) != ':') return;\n    pointer += 2;\n    pieceIndex++;\n    compress = pieceIndex;\n  }\n  while (chr()) {\n    if (pieceIndex == 8) return;\n    if (chr() == ':') {\n      if (compress !== null) return;\n      pointer++;\n      pieceIndex++;\n      compress = pieceIndex;\n      continue;\n    }\n    value = length = 0;\n    while (length < 4 && exec(HEX, chr())) {\n      value = value * 16 + parseInt(chr(), 16);\n      pointer++;\n      length++;\n    }\n    if (chr() == '.') {\n      if (length == 0) return;\n      pointer -= length;\n      if (pieceIndex > 6) return;\n      numbersSeen = 0;\n      while (chr()) {\n        ipv4Piece = null;\n        if (numbersSeen > 0) {\n          if (chr() == '.' && numbersSeen < 4) pointer++;\n          else return;\n        }\n        if (!exec(DIGIT, chr())) return;\n        while (exec(DIGIT, chr())) {\n          number = parseInt(chr(), 10);\n          if (ipv4Piece === null) ipv4Piece = number;\n          else if (ipv4Piece == 0) return;\n          else ipv4Piece = ipv4Piece * 10 + number;\n          if (ipv4Piece > 255) return;\n          pointer++;\n        }\n        address[pieceIndex] = address[pieceIndex] * 256 + ipv4Piece;\n        numbersSeen++;\n        if (numbersSeen == 2 || numbersSeen == 4) pieceIndex++;\n      }\n      if (numbersSeen != 4) return;\n      break;\n    } else if (chr() == ':') {\n      pointer++;\n      if (!chr()) return;\n    } else if (chr()) return;\n    address[pieceIndex++] = value;\n  }\n  if (compress !== null) {\n    swaps = pieceIndex - compress;\n    pieceIndex = 7;\n    while (pieceIndex != 0 && swaps > 0) {\n      swap = address[pieceIndex];\n      address[pieceIndex--] = address[compress + swaps - 1];\n      address[compress + --swaps] = swap;\n    }\n  } else if (pieceIndex != 8) return;\n  return address;\n};\n\nvar findLongestZeroSequence = function (ipv6) {\n  var maxIndex = null;\n  var maxLength = 1;\n  var currStart = null;\n  var currLength = 0;\n  var index = 0;\n  for (; index < 8; index++) {\n    if (ipv6[index] !== 0) {\n      if (currLength > maxLength) {\n        maxIndex = currStart;\n        maxLength = currLength;\n      }\n      currStart = null;\n      currLength = 0;\n    } else {\n      if (currStart === null) currStart = index;\n      ++currLength;\n    }\n  }\n  if (currLength > maxLength) {\n    maxIndex = currStart;\n    maxLength = currLength;\n  }\n  return maxIndex;\n};\n\n// https://url.spec.whatwg.org/#host-serializing\nvar serializeHost = function (host) {\n  var result, index, compress, ignore0;\n  // ipv4\n  if (typeof host == 'number') {\n    result = [];\n    for (index = 0; index < 4; index++) {\n      unshift(result, host % 256);\n      host = floor(host / 256);\n    } return join(result, '.');\n  // ipv6\n  } else if (typeof host == 'object') {\n    result = '';\n    compress = findLongestZeroSequence(host);\n    for (index = 0; index < 8; index++) {\n      if (ignore0 && host[index] === 0) continue;\n      if (ignore0) ignore0 = false;\n      if (compress === index) {\n        result += index ? ':' : '::';\n        ignore0 = true;\n      } else {\n        result += numberToString(host[index], 16);\n        if (index < 7) result += ':';\n      }\n    }\n    return '[' + result + ']';\n  } return host;\n};\n\nvar C0ControlPercentEncodeSet = {};\nvar fragmentPercentEncodeSet = assign({}, C0ControlPercentEncodeSet, {\n  ' ': 1, '\"': 1, '<': 1, '>': 1, '`': 1\n});\nvar pathPercentEncodeSet = assign({}, fragmentPercentEncodeSet, {\n  '#': 1, '?': 1, '{': 1, '}': 1\n});\nvar userinfoPercentEncodeSet = assign({}, pathPercentEncodeSet, {\n  '/': 1, ':': 1, ';': 1, '=': 1, '@': 1, '[': 1, '\\\\': 1, ']': 1, '^': 1, '|': 1\n});\n\nvar percentEncode = function (chr, set) {\n  var code = codeAt(chr, 0);\n  return code > 0x20 && code < 0x7F && !hasOwn(set, chr) ? chr : encodeURIComponent(chr);\n};\n\n// https://url.spec.whatwg.org/#special-scheme\nvar specialSchemes = {\n  ftp: 21,\n  file: null,\n  http: 80,\n  https: 443,\n  ws: 80,\n  wss: 443\n};\n\n// https://url.spec.whatwg.org/#windows-drive-letter\nvar isWindowsDriveLetter = function (string, normalized) {\n  var second;\n  return string.length == 2 && exec(ALPHA, charAt(string, 0))\n    && ((second = charAt(string, 1)) == ':' || (!normalized && second == '|'));\n};\n\n// https://url.spec.whatwg.org/#start-with-a-windows-drive-letter\nvar startsWithWindowsDriveLetter = function (string) {\n  var third;\n  return string.length > 1 && isWindowsDriveLetter(stringSlice(string, 0, 2)) && (\n    string.length == 2 ||\n    ((third = charAt(string, 2)) === '/' || third === '\\\\' || third === '?' || third === '#')\n  );\n};\n\n// https://url.spec.whatwg.org/#single-dot-path-segment\nvar isSingleDot = function (segment) {\n  return segment === '.' || toLowerCase(segment) === '%2e';\n};\n\n// https://url.spec.whatwg.org/#double-dot-path-segment\nvar isDoubleDot = function (segment) {\n  segment = toLowerCase(segment);\n  return segment === '..' || segment === '%2e.' || segment === '.%2e' || segment === '%2e%2e';\n};\n\n// States:\nvar SCHEME_START = {};\nvar SCHEME = {};\nvar NO_SCHEME = {};\nvar SPECIAL_RELATIVE_OR_AUTHORITY = {};\nvar PATH_OR_AUTHORITY = {};\nvar RELATIVE = {};\nvar RELATIVE_SLASH = {};\nvar SPECIAL_AUTHORITY_SLASHES = {};\nvar SPECIAL_AUTHORITY_IGNORE_SLASHES = {};\nvar AUTHORITY = {};\nvar HOST = {};\nvar HOSTNAME = {};\nvar PORT = {};\nvar FILE = {};\nvar FILE_SLASH = {};\nvar FILE_HOST = {};\nvar PATH_START = {};\nvar PATH = {};\nvar CANNOT_BE_A_BASE_URL_PATH = {};\nvar QUERY = {};\nvar FRAGMENT = {};\n\nvar URLState = function (url, isBase, base) {\n  var urlString = $toString(url);\n  var baseState, failure, searchParams;\n  if (isBase) {\n    failure = this.parse(urlString);\n    if (failure) throw TypeError(failure);\n    this.searchParams = null;\n  } else {\n    if (base !== undefined) baseState = new URLState(base, true);\n    failure = this.parse(urlString, null, baseState);\n    if (failure) throw TypeError(failure);\n    searchParams = getInternalSearchParamsState(new URLSearchParams());\n    searchParams.bindURL(this);\n    this.searchParams = searchParams;\n  }\n};\n\nURLState.prototype = {\n  type: 'URL',\n  // https://url.spec.whatwg.org/#url-parsing\n  // eslint-disable-next-line max-statements -- TODO\n  parse: function (input, stateOverride, base) {\n    var url = this;\n    var state = stateOverride || SCHEME_START;\n    var pointer = 0;\n    var buffer = '';\n    var seenAt = false;\n    var seenBracket = false;\n    var seenPasswordToken = false;\n    var codePoints, chr, bufferCodePoints, failure;\n\n    input = $toString(input);\n\n    if (!stateOverride) {\n      url.scheme = '';\n      url.username = '';\n      url.password = '';\n      url.host = null;\n      url.port = null;\n      url.path = [];\n      url.query = null;\n      url.fragment = null;\n      url.cannotBeABaseURL = false;\n      input = replace(input, LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE, '');\n    }\n\n    input = replace(input, TAB_AND_NEW_LINE, '');\n\n    codePoints = arrayFrom(input);\n\n    while (pointer <= codePoints.length) {\n      chr = codePoints[pointer];\n      switch (state) {\n        case SCHEME_START:\n          if (chr && exec(ALPHA, chr)) {\n            buffer += toLowerCase(chr);\n            state = SCHEME;\n          } else if (!stateOverride) {\n            state = NO_SCHEME;\n            continue;\n          } else return INVALID_SCHEME;\n          break;\n\n        case SCHEME:\n          if (chr && (exec(ALPHANUMERIC, chr) || chr == '+' || chr == '-' || chr == '.')) {\n            buffer += toLowerCase(chr);\n          } else if (chr == ':') {\n            if (stateOverride && (\n              (url.isSpecial() != hasOwn(specialSchemes, buffer)) ||\n              (buffer == 'file' && (url.includesCredentials() || url.port !== null)) ||\n              (url.scheme == 'file' && !url.host)\n            )) return;\n            url.scheme = buffer;\n            if (stateOverride) {\n              if (url.isSpecial() && specialSchemes[url.scheme] == url.port) url.port = null;\n              return;\n            }\n            buffer = '';\n            if (url.scheme == 'file') {\n              state = FILE;\n            } else if (url.isSpecial() && base && base.scheme == url.scheme) {\n              state = SPECIAL_RELATIVE_OR_AUTHORITY;\n            } else if (url.isSpecial()) {\n              state = SPECIAL_AUTHORITY_SLASHES;\n            } else if (codePoints[pointer + 1] == '/') {\n              state = PATH_OR_AUTHORITY;\n              pointer++;\n            } else {\n              url.cannotBeABaseURL = true;\n              push(url.path, '');\n              state = CANNOT_BE_A_BASE_URL_PATH;\n            }\n          } else if (!stateOverride) {\n            buffer = '';\n            state = NO_SCHEME;\n            pointer = 0;\n            continue;\n          } else return INVALID_SCHEME;\n          break;\n\n        case NO_SCHEME:\n          if (!base || (base.cannotBeABaseURL && chr != '#')) return INVALID_SCHEME;\n          if (base.cannotBeABaseURL && chr == '#') {\n            url.scheme = base.scheme;\n            url.path = arraySlice(base.path);\n            url.query = base.query;\n            url.fragment = '';\n            url.cannotBeABaseURL = true;\n            state = FRAGMENT;\n            break;\n          }\n          state = base.scheme == 'file' ? FILE : RELATIVE;\n          continue;\n\n        case SPECIAL_RELATIVE_OR_AUTHORITY:\n          if (chr == '/' && codePoints[pointer + 1] == '/') {\n            state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n            pointer++;\n          } else {\n            state = RELATIVE;\n            continue;\n          } break;\n\n        case PATH_OR_AUTHORITY:\n          if (chr == '/') {\n            state = AUTHORITY;\n            break;\n          } else {\n            state = PATH;\n            continue;\n          }\n\n        case RELATIVE:\n          url.scheme = base.scheme;\n          if (chr == EOF) {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            url.path = arraySlice(base.path);\n            url.query = base.query;\n          } else if (chr == '/' || (chr == '\\\\' && url.isSpecial())) {\n            state = RELATIVE_SLASH;\n          } else if (chr == '?') {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            url.path = arraySlice(base.path);\n            url.query = '';\n            state = QUERY;\n          } else if (chr == '#') {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            url.path = arraySlice(base.path);\n            url.query = base.query;\n            url.fragment = '';\n            state = FRAGMENT;\n          } else {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            url.path = arraySlice(base.path);\n            url.path.length--;\n            state = PATH;\n            continue;\n          } break;\n\n        case RELATIVE_SLASH:\n          if (url.isSpecial() && (chr == '/' || chr == '\\\\')) {\n            state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n          } else if (chr == '/') {\n            state = AUTHORITY;\n          } else {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            state = PATH;\n            continue;\n          } break;\n\n        case SPECIAL_AUTHORITY_SLASHES:\n          state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n          if (chr != '/' || charAt(buffer, pointer + 1) != '/') continue;\n          pointer++;\n          break;\n\n        case SPECIAL_AUTHORITY_IGNORE_SLASHES:\n          if (chr != '/' && chr != '\\\\') {\n            state = AUTHORITY;\n            continue;\n          } break;\n\n        case AUTHORITY:\n          if (chr == '@') {\n            if (seenAt) buffer = '%40' + buffer;\n            seenAt = true;\n            bufferCodePoints = arrayFrom(buffer);\n            for (var i = 0; i < bufferCodePoints.length; i++) {\n              var codePoint = bufferCodePoints[i];\n              if (codePoint == ':' && !seenPasswordToken) {\n                seenPasswordToken = true;\n                continue;\n              }\n              var encodedCodePoints = percentEncode(codePoint, userinfoPercentEncodeSet);\n              if (seenPasswordToken) url.password += encodedCodePoints;\n              else url.username += encodedCodePoints;\n            }\n            buffer = '';\n          } else if (\n            chr == EOF || chr == '/' || chr == '?' || chr == '#' ||\n            (chr == '\\\\' && url.isSpecial())\n          ) {\n            if (seenAt && buffer == '') return INVALID_AUTHORITY;\n            pointer -= arrayFrom(buffer).length + 1;\n            buffer = '';\n            state = HOST;\n          } else buffer += chr;\n          break;\n\n        case HOST:\n        case HOSTNAME:\n          if (stateOverride && url.scheme == 'file') {\n            state = FILE_HOST;\n            continue;\n          } else if (chr == ':' && !seenBracket) {\n            if (buffer == '') return INVALID_HOST;\n            failure = url.parseHost(buffer);\n            if (failure) return failure;\n            buffer = '';\n            state = PORT;\n            if (stateOverride == HOSTNAME) return;\n          } else if (\n            chr == EOF || chr == '/' || chr == '?' || chr == '#' ||\n            (chr == '\\\\' && url.isSpecial())\n          ) {\n            if (url.isSpecial() && buffer == '') return INVALID_HOST;\n            if (stateOverride && buffer == '' && (url.includesCredentials() || url.port !== null)) return;\n            failure = url.parseHost(buffer);\n            if (failure) return failure;\n            buffer = '';\n            state = PATH_START;\n            if (stateOverride) return;\n            continue;\n          } else {\n            if (chr == '[') seenBracket = true;\n            else if (chr == ']') seenBracket = false;\n            buffer += chr;\n          } break;\n\n        case PORT:\n          if (exec(DIGIT, chr)) {\n            buffer += chr;\n          } else if (\n            chr == EOF || chr == '/' || chr == '?' || chr == '#' ||\n            (chr == '\\\\' && url.isSpecial()) ||\n            stateOverride\n          ) {\n            if (buffer != '') {\n              var port = parseInt(buffer, 10);\n              if (port > 0xFFFF) return INVALID_PORT;\n              url.port = (url.isSpecial() && port === specialSchemes[url.scheme]) ? null : port;\n              buffer = '';\n            }\n            if (stateOverride) return;\n            state = PATH_START;\n            continue;\n          } else return INVALID_PORT;\n          break;\n\n        case FILE:\n          url.scheme = 'file';\n          if (chr == '/' || chr == '\\\\') state = FILE_SLASH;\n          else if (base && base.scheme == 'file') {\n            if (chr == EOF) {\n              url.host = base.host;\n              url.path = arraySlice(base.path);\n              url.query = base.query;\n            } else if (chr == '?') {\n              url.host = base.host;\n              url.path = arraySlice(base.path);\n              url.query = '';\n              state = QUERY;\n            } else if (chr == '#') {\n              url.host = base.host;\n              url.path = arraySlice(base.path);\n              url.query = base.query;\n              url.fragment = '';\n              state = FRAGMENT;\n            } else {\n              if (!startsWithWindowsDriveLetter(join(arraySlice(codePoints, pointer), ''))) {\n                url.host = base.host;\n                url.path = arraySlice(base.path);\n                url.shortenPath();\n              }\n              state = PATH;\n              continue;\n            }\n          } else {\n            state = PATH;\n            continue;\n          } break;\n\n        case FILE_SLASH:\n          if (chr == '/' || chr == '\\\\') {\n            state = FILE_HOST;\n            break;\n          }\n          if (base && base.scheme == 'file' && !startsWithWindowsDriveLetter(join(arraySlice(codePoints, pointer), ''))) {\n            if (isWindowsDriveLetter(base.path[0], true)) push(url.path, base.path[0]);\n            else url.host = base.host;\n          }\n          state = PATH;\n          continue;\n\n        case FILE_HOST:\n          if (chr == EOF || chr == '/' || chr == '\\\\' || chr == '?' || chr == '#') {\n            if (!stateOverride && isWindowsDriveLetter(buffer)) {\n              state = PATH;\n            } else if (buffer == '') {\n              url.host = '';\n              if (stateOverride) return;\n              state = PATH_START;\n            } else {\n              failure = url.parseHost(buffer);\n              if (failure) return failure;\n              if (url.host == 'localhost') url.host = '';\n              if (stateOverride) return;\n              buffer = '';\n              state = PATH_START;\n            } continue;\n          } else buffer += chr;\n          break;\n\n        case PATH_START:\n          if (url.isSpecial()) {\n            state = PATH;\n            if (chr != '/' && chr != '\\\\') continue;\n          } else if (!stateOverride && chr == '?') {\n            url.query = '';\n            state = QUERY;\n          } else if (!stateOverride && chr == '#') {\n            url.fragment = '';\n            state = FRAGMENT;\n          } else if (chr != EOF) {\n            state = PATH;\n            if (chr != '/') continue;\n          } break;\n\n        case PATH:\n          if (\n            chr == EOF || chr == '/' ||\n            (chr == '\\\\' && url.isSpecial()) ||\n            (!stateOverride && (chr == '?' || chr == '#'))\n          ) {\n            if (isDoubleDot(buffer)) {\n              url.shortenPath();\n              if (chr != '/' && !(chr == '\\\\' && url.isSpecial())) {\n                push(url.path, '');\n              }\n            } else if (isSingleDot(buffer)) {\n              if (chr != '/' && !(chr == '\\\\' && url.isSpecial())) {\n                push(url.path, '');\n              }\n            } else {\n              if (url.scheme == 'file' && !url.path.length && isWindowsDriveLetter(buffer)) {\n                if (url.host) url.host = '';\n                buffer = charAt(buffer, 0) + ':'; // normalize windows drive letter\n              }\n              push(url.path, buffer);\n            }\n            buffer = '';\n            if (url.scheme == 'file' && (chr == EOF || chr == '?' || chr == '#')) {\n              while (url.path.length > 1 && url.path[0] === '') {\n                shift(url.path);\n              }\n            }\n            if (chr == '?') {\n              url.query = '';\n              state = QUERY;\n            } else if (chr == '#') {\n              url.fragment = '';\n              state = FRAGMENT;\n            }\n          } else {\n            buffer += percentEncode(chr, pathPercentEncodeSet);\n          } break;\n\n        case CANNOT_BE_A_BASE_URL_PATH:\n          if (chr == '?') {\n            url.query = '';\n            state = QUERY;\n          } else if (chr == '#') {\n            url.fragment = '';\n            state = FRAGMENT;\n          } else if (chr != EOF) {\n            url.path[0] += percentEncode(chr, C0ControlPercentEncodeSet);\n          } break;\n\n        case QUERY:\n          if (!stateOverride && chr == '#') {\n            url.fragment = '';\n            state = FRAGMENT;\n          } else if (chr != EOF) {\n            if (chr == \"'\" && url.isSpecial()) url.query += '%27';\n            else if (chr == '#') url.query += '%23';\n            else url.query += percentEncode(chr, C0ControlPercentEncodeSet);\n          } break;\n\n        case FRAGMENT:\n          if (chr != EOF) url.fragment += percentEncode(chr, fragmentPercentEncodeSet);\n          break;\n      }\n\n      pointer++;\n    }\n  },\n  // https://url.spec.whatwg.org/#host-parsing\n  parseHost: function (input) {\n    var result, codePoints, index;\n    if (charAt(input, 0) == '[') {\n      if (charAt(input, input.length - 1) != ']') return INVALID_HOST;\n      result = parseIPv6(stringSlice(input, 1, -1));\n      if (!result) return INVALID_HOST;\n      this.host = result;\n    // opaque host\n    } else if (!this.isSpecial()) {\n      if (exec(FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT, input)) return INVALID_HOST;\n      result = '';\n      codePoints = arrayFrom(input);\n      for (index = 0; index < codePoints.length; index++) {\n        result += percentEncode(codePoints[index], C0ControlPercentEncodeSet);\n      }\n      this.host = result;\n    } else {\n      input = toASCII(input);\n      if (exec(FORBIDDEN_HOST_CODE_POINT, input)) return INVALID_HOST;\n      result = parseIPv4(input);\n      if (result === null) return INVALID_HOST;\n      this.host = result;\n    }\n  },\n  // https://url.spec.whatwg.org/#cannot-have-a-username-password-port\n  cannotHaveUsernamePasswordPort: function () {\n    return !this.host || this.cannotBeABaseURL || this.scheme == 'file';\n  },\n  // https://url.spec.whatwg.org/#include-credentials\n  includesCredentials: function () {\n    return this.username != '' || this.password != '';\n  },\n  // https://url.spec.whatwg.org/#is-special\n  isSpecial: function () {\n    return hasOwn(specialSchemes, this.scheme);\n  },\n  // https://url.spec.whatwg.org/#shorten-a-urls-path\n  shortenPath: function () {\n    var path = this.path;\n    var pathSize = path.length;\n    if (pathSize && (this.scheme != 'file' || pathSize != 1 || !isWindowsDriveLetter(path[0], true))) {\n      path.length--;\n    }\n  },\n  // https://url.spec.whatwg.org/#concept-url-serializer\n  serialize: function () {\n    var url = this;\n    var scheme = url.scheme;\n    var username = url.username;\n    var password = url.password;\n    var host = url.host;\n    var port = url.port;\n    var path = url.path;\n    var query = url.query;\n    var fragment = url.fragment;\n    var output = scheme + ':';\n    if (host !== null) {\n      output += '//';\n      if (url.includesCredentials()) {\n        output += username + (password ? ':' + password : '') + '@';\n      }\n      output += serializeHost(host);\n      if (port !== null) output += ':' + port;\n    } else if (scheme == 'file') output += '//';\n    output += url.cannotBeABaseURL ? path[0] : path.length ? '/' + join(path, '/') : '';\n    if (query !== null) output += '?' + query;\n    if (fragment !== null) output += '#' + fragment;\n    return output;\n  },\n  // https://url.spec.whatwg.org/#dom-url-href\n  setHref: function (href) {\n    var failure = this.parse(href);\n    if (failure) throw TypeError(failure);\n    this.searchParams.update();\n  },\n  // https://url.spec.whatwg.org/#dom-url-origin\n  getOrigin: function () {\n    var scheme = this.scheme;\n    var port = this.port;\n    if (scheme == 'blob') try {\n      return new URLConstructor(scheme.path[0]).origin;\n    } catch (error) {\n      return 'null';\n    }\n    if (scheme == 'file' || !this.isSpecial()) return 'null';\n    return scheme + '://' + serializeHost(this.host) + (port !== null ? ':' + port : '');\n  },\n  // https://url.spec.whatwg.org/#dom-url-protocol\n  getProtocol: function () {\n    return this.scheme + ':';\n  },\n  setProtocol: function (protocol) {\n    this.parse($toString(protocol) + ':', SCHEME_START);\n  },\n  // https://url.spec.whatwg.org/#dom-url-username\n  getUsername: function () {\n    return this.username;\n  },\n  setUsername: function (username) {\n    var codePoints = arrayFrom($toString(username));\n    if (this.cannotHaveUsernamePasswordPort()) return;\n    this.username = '';\n    for (var i = 0; i < codePoints.length; i++) {\n      this.username += percentEncode(codePoints[i], userinfoPercentEncodeSet);\n    }\n  },\n  // https://url.spec.whatwg.org/#dom-url-password\n  getPassword: function () {\n    return this.password;\n  },\n  setPassword: function (password) {\n    var codePoints = arrayFrom($toString(password));\n    if (this.cannotHaveUsernamePasswordPort()) return;\n    this.password = '';\n    for (var i = 0; i < codePoints.length; i++) {\n      this.password += percentEncode(codePoints[i], userinfoPercentEncodeSet);\n    }\n  },\n  // https://url.spec.whatwg.org/#dom-url-host\n  getHost: function () {\n    var host = this.host;\n    var port = this.port;\n    return host === null ? ''\n      : port === null ? serializeHost(host)\n      : serializeHost(host) + ':' + port;\n  },\n  setHost: function (host) {\n    if (this.cannotBeABaseURL) return;\n    this.parse(host, HOST);\n  },\n  // https://url.spec.whatwg.org/#dom-url-hostname\n  getHostname: function () {\n    var host = this.host;\n    return host === null ? '' : serializeHost(host);\n  },\n  setHostname: function (hostname) {\n    if (this.cannotBeABaseURL) return;\n    this.parse(hostname, HOSTNAME);\n  },\n  // https://url.spec.whatwg.org/#dom-url-port\n  getPort: function () {\n    var port = this.port;\n    return port === null ? '' : $toString(port);\n  },\n  setPort: function (port) {\n    if (this.cannotHaveUsernamePasswordPort()) return;\n    port = $toString(port);\n    if (port == '') this.port = null;\n    else this.parse(port, PORT);\n  },\n  // https://url.spec.whatwg.org/#dom-url-pathname\n  getPathname: function () {\n    var path = this.path;\n    return this.cannotBeABaseURL ? path[0] : path.length ? '/' + join(path, '/') : '';\n  },\n  setPathname: function (pathname) {\n    if (this.cannotBeABaseURL) return;\n    this.path = [];\n    this.parse(pathname, PATH_START);\n  },\n  // https://url.spec.whatwg.org/#dom-url-search\n  getSearch: function () {\n    var query = this.query;\n    return query ? '?' + query : '';\n  },\n  setSearch: function (search) {\n    search = $toString(search);\n    if (search == '') {\n      this.query = null;\n    } else {\n      if ('?' == charAt(search, 0)) search = stringSlice(search, 1);\n      this.query = '';\n      this.parse(search, QUERY);\n    }\n    this.searchParams.update();\n  },\n  // https://url.spec.whatwg.org/#dom-url-searchparams\n  getSearchParams: function () {\n    return this.searchParams.facade;\n  },\n  // https://url.spec.whatwg.org/#dom-url-hash\n  getHash: function () {\n    var fragment = this.fragment;\n    return fragment ? '#' + fragment : '';\n  },\n  setHash: function (hash) {\n    hash = $toString(hash);\n    if (hash == '') {\n      this.fragment = null;\n      return;\n    }\n    if ('#' == charAt(hash, 0)) hash = stringSlice(hash, 1);\n    this.fragment = '';\n    this.parse(hash, FRAGMENT);\n  },\n  update: function () {\n    this.query = this.searchParams.serialize() || null;\n  }\n};\n\n// `URL` constructor\n// https://url.spec.whatwg.org/#url-class\nvar URLConstructor = function URL(url /* , base */) {\n  var that = anInstance(this, URLPrototype);\n  var base = arguments.length > 1 ? arguments[1] : undefined;\n  var state = setInternalState(that, new URLState(url, false, base));\n  if (!DESCRIPTORS) {\n    that.href = state.serialize();\n    that.origin = state.getOrigin();\n    that.protocol = state.getProtocol();\n    that.username = state.getUsername();\n    that.password = state.getPassword();\n    that.host = state.getHost();\n    that.hostname = state.getHostname();\n    that.port = state.getPort();\n    that.pathname = state.getPathname();\n    that.search = state.getSearch();\n    that.searchParams = state.getSearchParams();\n    that.hash = state.getHash();\n  }\n};\n\nvar URLPrototype = URLConstructor.prototype;\n\nvar accessorDescriptor = function (getter, setter) {\n  return {\n    get: function () {\n      return getInternalURLState(this)[getter]();\n    },\n    set: setter && function (value) {\n      return getInternalURLState(this)[setter](value);\n    },\n    configurable: true,\n    enumerable: true\n  };\n};\n\nif (DESCRIPTORS) {\n  defineProperties(URLPrototype, {\n    // `URL.prototype.href` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-href\n    href: accessorDescriptor('serialize', 'setHref'),\n    // `URL.prototype.origin` getter\n    // https://url.spec.whatwg.org/#dom-url-origin\n    origin: accessorDescriptor('getOrigin'),\n    // `URL.prototype.protocol` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-protocol\n    protocol: accessorDescriptor('getProtocol', 'setProtocol'),\n    // `URL.prototype.username` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-username\n    username: accessorDescriptor('getUsername', 'setUsername'),\n    // `URL.prototype.password` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-password\n    password: accessorDescriptor('getPassword', 'setPassword'),\n    // `URL.prototype.host` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-host\n    host: accessorDescriptor('getHost', 'setHost'),\n    // `URL.prototype.hostname` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-hostname\n    hostname: accessorDescriptor('getHostname', 'setHostname'),\n    // `URL.prototype.port` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-port\n    port: accessorDescriptor('getPort', 'setPort'),\n    // `URL.prototype.pathname` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-pathname\n    pathname: accessorDescriptor('getPathname', 'setPathname'),\n    // `URL.prototype.search` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-search\n    search: accessorDescriptor('getSearch', 'setSearch'),\n    // `URL.prototype.searchParams` getter\n    // https://url.spec.whatwg.org/#dom-url-searchparams\n    searchParams: accessorDescriptor('getSearchParams'),\n    // `URL.prototype.hash` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-hash\n    hash: accessorDescriptor('getHash', 'setHash')\n  });\n}\n\n// `URL.prototype.toJSON` method\n// https://url.spec.whatwg.org/#dom-url-tojson\nredefine(URLPrototype, 'toJSON', function toJSON() {\n  return getInternalURLState(this).serialize();\n}, { enumerable: true });\n\n// `URL.prototype.toString` method\n// https://url.spec.whatwg.org/#URL-stringification-behavior\nredefine(URLPrototype, 'toString', function toString() {\n  return getInternalURLState(this).serialize();\n}, { enumerable: true });\n\nif (NativeURL) {\n  var nativeCreateObjectURL = NativeURL.createObjectURL;\n  var nativeRevokeObjectURL = NativeURL.revokeObjectURL;\n  // `URL.createObjectURL` method\n  // https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL\n  if (nativeCreateObjectURL) redefine(URLConstructor, 'createObjectURL', bind(nativeCreateObjectURL, NativeURL));\n  // `URL.revokeObjectURL` method\n  // https://developer.mozilla.org/en-US/docs/Web/API/URL/revokeObjectURL\n  if (nativeRevokeObjectURL) redefine(URLConstructor, 'revokeObjectURL', bind(nativeRevokeObjectURL, NativeURL));\n}\n\nsetToStringTag(URLConstructor, 'URL');\n\n$({ global: true, forced: !USE_NATIVE_URL, sham: !DESCRIPTORS }, {\n  URL: URLConstructor\n});\n","var fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar ITERATOR = wellKnownSymbol('iterator');\n\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line unicorn/relative-url-style -- required for testing\n  var url = new URL('b?a=1&b=2&c=3', 'http://a');\n  var searchParams = url.searchParams;\n  var result = '';\n  url.pathname = 'c%20d';\n  searchParams.forEach(function (value, key) {\n    searchParams['delete']('b');\n    result += key + value;\n  });\n  return (IS_PURE && !url.toJSON)\n    || !searchParams.sort\n    || url.href !== 'http://a/c%20d?a=1&c=3'\n    || searchParams.get('c') !== '3'\n    || String(new URLSearchParams('?a=1')) !== 'a=1'\n    || !searchParams[ITERATOR]\n    // throws in Edge\n    || new URL('https://a@b').username !== 'a'\n    || new URLSearchParams(new URLSearchParams('a=b')).get('a') !== 'b'\n    // not punycoded in Edge\n    || new URL('http://тест').host !== 'xn--e1aybc'\n    // not escaped in Chrome 62-\n    || new URL('http://a#б').hash !== '#%D0%B1'\n    // fails in Chrome 66-\n    || result !== 'a1c3'\n    // throws in Safari\n    || new URL('http://x', undefined).host !== 'x';\n});\n","'use strict';\n// based on https://github.com/bestiejs/punycode.js/blob/master/punycode.js\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nvar maxInt = 2147483647; // aka. 0x7FFFFFFF or 2^31-1\nvar base = 36;\nvar tMin = 1;\nvar tMax = 26;\nvar skew = 38;\nvar damp = 700;\nvar initialBias = 72;\nvar initialN = 128; // 0x80\nvar delimiter = '-'; // '\\x2D'\nvar regexNonASCII = /[^\\0-\\u007E]/; // non-ASCII chars\nvar regexSeparators = /[.\\u3002\\uFF0E\\uFF61]/g; // RFC 3490 separators\nvar OVERFLOW_ERROR = 'Overflow: input needs wider integers to process';\nvar baseMinusTMin = base - tMin;\n\nvar RangeError = global.RangeError;\nvar exec = uncurryThis(regexSeparators.exec);\nvar floor = Math.floor;\nvar fromCharCode = String.fromCharCode;\nvar charCodeAt = uncurryThis(''.charCodeAt);\nvar join = uncurryThis([].join);\nvar push = uncurryThis([].push);\nvar replace = uncurryThis(''.replace);\nvar split = uncurryThis(''.split);\nvar toLowerCase = uncurryThis(''.toLowerCase);\n\n/**\n * Creates an array containing the numeric code points of each Unicode\n * character in the string. While JavaScript uses UCS-2 internally,\n * this function will convert a pair of surrogate halves (each of which\n * UCS-2 exposes as separate characters) into a single code point,\n * matching UTF-16.\n */\nvar ucs2decode = function (string) {\n  var output = [];\n  var counter = 0;\n  var length = string.length;\n  while (counter < length) {\n    var value = charCodeAt(string, counter++);\n    if (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n      // It's a high surrogate, and there is a next character.\n      var extra = charCodeAt(string, counter++);\n      if ((extra & 0xFC00) == 0xDC00) { // Low surrogate.\n        push(output, ((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n      } else {\n        // It's an unmatched surrogate; only append this code unit, in case the\n        // next code unit is the high surrogate of a surrogate pair.\n        push(output, value);\n        counter--;\n      }\n    } else {\n      push(output, value);\n    }\n  }\n  return output;\n};\n\n/**\n * Converts a digit/integer into a basic code point.\n */\nvar digitToBasic = function (digit) {\n  //  0..25 map to ASCII a..z or A..Z\n  // 26..35 map to ASCII 0..9\n  return digit + 22 + 75 * (digit < 26);\n};\n\n/**\n * Bias adaptation function as per section 3.4 of RFC 3492.\n * https://tools.ietf.org/html/rfc3492#section-3.4\n */\nvar adapt = function (delta, numPoints, firstTime) {\n  var k = 0;\n  delta = firstTime ? floor(delta / damp) : delta >> 1;\n  delta += floor(delta / numPoints);\n  while (delta > baseMinusTMin * tMax >> 1) {\n    delta = floor(delta / baseMinusTMin);\n    k += base;\n  }\n  return floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n};\n\n/**\n * Converts a string of Unicode symbols (e.g. a domain name label) to a\n * Punycode string of ASCII-only symbols.\n */\nvar encode = function (input) {\n  var output = [];\n\n  // Convert the input in UCS-2 to an array of Unicode code points.\n  input = ucs2decode(input);\n\n  // Cache the length.\n  var inputLength = input.length;\n\n  // Initialize the state.\n  var n = initialN;\n  var delta = 0;\n  var bias = initialBias;\n  var i, currentValue;\n\n  // Handle the basic code points.\n  for (i = 0; i < input.length; i++) {\n    currentValue = input[i];\n    if (currentValue < 0x80) {\n      push(output, fromCharCode(currentValue));\n    }\n  }\n\n  var basicLength = output.length; // number of basic code points.\n  var handledCPCount = basicLength; // number of code points that have been handled;\n\n  // Finish the basic string with a delimiter unless it's empty.\n  if (basicLength) {\n    push(output, delimiter);\n  }\n\n  // Main encoding loop:\n  while (handledCPCount < inputLength) {\n    // All non-basic code points < n have been handled already. Find the next larger one:\n    var m = maxInt;\n    for (i = 0; i < input.length; i++) {\n      currentValue = input[i];\n      if (currentValue >= n && currentValue < m) {\n        m = currentValue;\n      }\n    }\n\n    // Increase `delta` enough to advance the decoder's <n,i> state to <m,0>, but guard against overflow.\n    var handledCPCountPlusOne = handledCPCount + 1;\n    if (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n      throw RangeError(OVERFLOW_ERROR);\n    }\n\n    delta += (m - n) * handledCPCountPlusOne;\n    n = m;\n\n    for (i = 0; i < input.length; i++) {\n      currentValue = input[i];\n      if (currentValue < n && ++delta > maxInt) {\n        throw RangeError(OVERFLOW_ERROR);\n      }\n      if (currentValue == n) {\n        // Represent delta as a generalized variable-length integer.\n        var q = delta;\n        var k = base;\n        while (true) {\n          var t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n          if (q < t) break;\n          var qMinusT = q - t;\n          var baseMinusT = base - t;\n          push(output, fromCharCode(digitToBasic(t + qMinusT % baseMinusT)));\n          q = floor(qMinusT / baseMinusT);\n          k += base;\n        }\n\n        push(output, fromCharCode(digitToBasic(q)));\n        bias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n        delta = 0;\n        handledCPCount++;\n      }\n    }\n\n    delta++;\n    n++;\n  }\n  return join(output, '');\n};\n\nmodule.exports = function (input) {\n  var encoded = [];\n  var labels = split(replace(toLowerCase(input), regexSeparators, '\\u002E'), '.');\n  var i, label;\n  for (i = 0; i < labels.length; i++) {\n    label = labels[i];\n    push(encoded, exec(regexNonASCII, label) ? 'xn--' + encode(label) : label);\n  }\n  return join(encoded, '.');\n};\n","'use strict';\n// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.array.iterator');\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar USE_NATIVE_URL = require('../internals/native-url');\nvar redefine = require('../internals/redefine');\nvar redefineAll = require('../internals/redefine-all');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar InternalStateModule = require('../internals/internal-state');\nvar anInstance = require('../internals/an-instance');\nvar isCallable = require('../internals/is-callable');\nvar hasOwn = require('../internals/has-own-property');\nvar bind = require('../internals/function-bind-context');\nvar classof = require('../internals/classof');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar $toString = require('../internals/to-string');\nvar create = require('../internals/object-create');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar validateArgumentsLength = require('../internals/validate-arguments-length');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar arraySort = require('../internals/array-sort');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar URL_SEARCH_PARAMS = 'URLSearchParams';\nvar URL_SEARCH_PARAMS_ITERATOR = URL_SEARCH_PARAMS + 'Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalParamsState = InternalStateModule.getterFor(URL_SEARCH_PARAMS);\nvar getInternalIteratorState = InternalStateModule.getterFor(URL_SEARCH_PARAMS_ITERATOR);\n\nvar n$Fetch = getBuiltIn('fetch');\nvar N$Request = getBuiltIn('Request');\nvar Headers = getBuiltIn('Headers');\nvar RequestPrototype = N$Request && N$Request.prototype;\nvar HeadersPrototype = Headers && Headers.prototype;\nvar RegExp = global.RegExp;\nvar TypeError = global.TypeError;\nvar decodeURIComponent = global.decodeURIComponent;\nvar encodeURIComponent = global.encodeURIComponent;\nvar charAt = uncurryThis(''.charAt);\nvar join = uncurryThis([].join);\nvar push = uncurryThis([].push);\nvar replace = uncurryThis(''.replace);\nvar shift = uncurryThis([].shift);\nvar splice = uncurryThis([].splice);\nvar split = uncurryThis(''.split);\nvar stringSlice = uncurryThis(''.slice);\n\nvar plus = /\\+/g;\nvar sequences = Array(4);\n\nvar percentSequence = function (bytes) {\n  return sequences[bytes - 1] || (sequences[bytes - 1] = RegExp('((?:%[\\\\da-f]{2}){' + bytes + '})', 'gi'));\n};\n\nvar percentDecode = function (sequence) {\n  try {\n    return decodeURIComponent(sequence);\n  } catch (error) {\n    return sequence;\n  }\n};\n\nvar deserialize = function (it) {\n  var result = replace(it, plus, ' ');\n  var bytes = 4;\n  try {\n    return decodeURIComponent(result);\n  } catch (error) {\n    while (bytes) {\n      result = replace(result, percentSequence(bytes--), percentDecode);\n    }\n    return result;\n  }\n};\n\nvar find = /[!'()~]|%20/g;\n\nvar replacements = {\n  '!': '%21',\n  \"'\": '%27',\n  '(': '%28',\n  ')': '%29',\n  '~': '%7E',\n  '%20': '+'\n};\n\nvar replacer = function (match) {\n  return replacements[match];\n};\n\nvar serialize = function (it) {\n  return replace(encodeURIComponent(it), find, replacer);\n};\n\nvar URLSearchParamsIterator = createIteratorConstructor(function Iterator(params, kind) {\n  setInternalState(this, {\n    type: URL_SEARCH_PARAMS_ITERATOR,\n    iterator: getIterator(getInternalParamsState(params).entries),\n    kind: kind\n  });\n}, 'Iterator', function next() {\n  var state = getInternalIteratorState(this);\n  var kind = state.kind;\n  var step = state.iterator.next();\n  var entry = step.value;\n  if (!step.done) {\n    step.value = kind === 'keys' ? entry.key : kind === 'values' ? entry.value : [entry.key, entry.value];\n  } return step;\n}, true);\n\nvar URLSearchParamsState = function (init) {\n  this.entries = [];\n  this.url = null;\n\n  if (init !== undefined) {\n    if (isObject(init)) this.parseObject(init);\n    else this.parseQuery(typeof init == 'string' ? charAt(init, 0) === '?' ? stringSlice(init, 1) : init : $toString(init));\n  }\n};\n\nURLSearchParamsState.prototype = {\n  type: URL_SEARCH_PARAMS,\n  bindURL: function (url) {\n    this.url = url;\n    this.update();\n  },\n  parseObject: function (object) {\n    var iteratorMethod = getIteratorMethod(object);\n    var iterator, next, step, entryIterator, entryNext, first, second;\n\n    if (iteratorMethod) {\n      iterator = getIterator(object, iteratorMethod);\n      next = iterator.next;\n      while (!(step = call(next, iterator)).done) {\n        entryIterator = getIterator(anObject(step.value));\n        entryNext = entryIterator.next;\n        if (\n          (first = call(entryNext, entryIterator)).done ||\n          (second = call(entryNext, entryIterator)).done ||\n          !call(entryNext, entryIterator).done\n        ) throw TypeError('Expected sequence with length 2');\n        push(this.entries, { key: $toString(first.value), value: $toString(second.value) });\n      }\n    } else for (var key in object) if (hasOwn(object, key)) {\n      push(this.entries, { key: key, value: $toString(object[key]) });\n    }\n  },\n  parseQuery: function (query) {\n    if (query) {\n      var attributes = split(query, '&');\n      var index = 0;\n      var attribute, entry;\n      while (index < attributes.length) {\n        attribute = attributes[index++];\n        if (attribute.length) {\n          entry = split(attribute, '=');\n          push(this.entries, {\n            key: deserialize(shift(entry)),\n            value: deserialize(join(entry, '='))\n          });\n        }\n      }\n    }\n  },\n  serialize: function () {\n    var entries = this.entries;\n    var result = [];\n    var index = 0;\n    var entry;\n    while (index < entries.length) {\n      entry = entries[index++];\n      push(result, serialize(entry.key) + '=' + serialize(entry.value));\n    } return join(result, '&');\n  },\n  update: function () {\n    this.entries.length = 0;\n    this.parseQuery(this.url.query);\n  },\n  updateURL: function () {\n    if (this.url) this.url.update();\n  }\n};\n\n// `URLSearchParams` constructor\n// https://url.spec.whatwg.org/#interface-urlsearchparams\nvar URLSearchParamsConstructor = function URLSearchParams(/* init */) {\n  anInstance(this, URLSearchParamsPrototype);\n  var init = arguments.length > 0 ? arguments[0] : undefined;\n  setInternalState(this, new URLSearchParamsState(init));\n};\n\nvar URLSearchParamsPrototype = URLSearchParamsConstructor.prototype;\n\nredefineAll(URLSearchParamsPrototype, {\n  // `URLSearchParams.prototype.append` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-append\n  append: function append(name, value) {\n    validateArgumentsLength(arguments.length, 2);\n    var state = getInternalParamsState(this);\n    push(state.entries, { key: $toString(name), value: $toString(value) });\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.delete` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-delete\n  'delete': function (name) {\n    validateArgumentsLength(arguments.length, 1);\n    var state = getInternalParamsState(this);\n    var entries = state.entries;\n    var key = $toString(name);\n    var index = 0;\n    while (index < entries.length) {\n      if (entries[index].key === key) splice(entries, index, 1);\n      else index++;\n    }\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.get` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-get\n  get: function get(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = $toString(name);\n    var index = 0;\n    for (; index < entries.length; index++) {\n      if (entries[index].key === key) return entries[index].value;\n    }\n    return null;\n  },\n  // `URLSearchParams.prototype.getAll` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-getall\n  getAll: function getAll(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = $toString(name);\n    var result = [];\n    var index = 0;\n    for (; index < entries.length; index++) {\n      if (entries[index].key === key) push(result, entries[index].value);\n    }\n    return result;\n  },\n  // `URLSearchParams.prototype.has` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-has\n  has: function has(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = $toString(name);\n    var index = 0;\n    while (index < entries.length) {\n      if (entries[index++].key === key) return true;\n    }\n    return false;\n  },\n  // `URLSearchParams.prototype.set` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-set\n  set: function set(name, value) {\n    validateArgumentsLength(arguments.length, 1);\n    var state = getInternalParamsState(this);\n    var entries = state.entries;\n    var found = false;\n    var key = $toString(name);\n    var val = $toString(value);\n    var index = 0;\n    var entry;\n    for (; index < entries.length; index++) {\n      entry = entries[index];\n      if (entry.key === key) {\n        if (found) splice(entries, index--, 1);\n        else {\n          found = true;\n          entry.value = val;\n        }\n      }\n    }\n    if (!found) push(entries, { key: key, value: val });\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.sort` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-sort\n  sort: function sort() {\n    var state = getInternalParamsState(this);\n    arraySort(state.entries, function (a, b) {\n      return a.key > b.key ? 1 : -1;\n    });\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.forEach` method\n  forEach: function forEach(callback /* , thisArg */) {\n    var entries = getInternalParamsState(this).entries;\n    var boundFunction = bind(callback, arguments.length > 1 ? arguments[1] : undefined);\n    var index = 0;\n    var entry;\n    while (index < entries.length) {\n      entry = entries[index++];\n      boundFunction(entry.value, entry.key, this);\n    }\n  },\n  // `URLSearchParams.prototype.keys` method\n  keys: function keys() {\n    return new URLSearchParamsIterator(this, 'keys');\n  },\n  // `URLSearchParams.prototype.values` method\n  values: function values() {\n    return new URLSearchParamsIterator(this, 'values');\n  },\n  // `URLSearchParams.prototype.entries` method\n  entries: function entries() {\n    return new URLSearchParamsIterator(this, 'entries');\n  }\n}, { enumerable: true });\n\n// `URLSearchParams.prototype[@@iterator]` method\nredefine(URLSearchParamsPrototype, ITERATOR, URLSearchParamsPrototype.entries, { name: 'entries' });\n\n// `URLSearchParams.prototype.toString` method\n// https://url.spec.whatwg.org/#urlsearchparams-stringification-behavior\nredefine(URLSearchParamsPrototype, 'toString', function toString() {\n  return getInternalParamsState(this).serialize();\n}, { enumerable: true });\n\nsetToStringTag(URLSearchParamsConstructor, URL_SEARCH_PARAMS);\n\n$({ global: true, forced: !USE_NATIVE_URL }, {\n  URLSearchParams: URLSearchParamsConstructor\n});\n\n// Wrap `fetch` and `Request` for correct work with polyfilled `URLSearchParams`\nif (!USE_NATIVE_URL && isCallable(Headers)) {\n  var headersHas = uncurryThis(HeadersPrototype.has);\n  var headersSet = uncurryThis(HeadersPrototype.set);\n\n  var wrapRequestOptions = function (init) {\n    if (isObject(init)) {\n      var body = init.body;\n      var headers;\n      if (classof(body) === URL_SEARCH_PARAMS) {\n        headers = init.headers ? new Headers(init.headers) : new Headers();\n        if (!headersHas(headers, 'content-type')) {\n          headersSet(headers, 'content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n        }\n        return create(init, {\n          body: createPropertyDescriptor(0, $toString(body)),\n          headers: createPropertyDescriptor(0, headers)\n        });\n      }\n    } return init;\n  };\n\n  if (isCallable(n$Fetch)) {\n    $({ global: true, enumerable: true, forced: true }, {\n      fetch: function fetch(input /* , init */) {\n        return n$Fetch(input, arguments.length > 1 ? wrapRequestOptions(arguments[1]) : {});\n      }\n    });\n  }\n\n  if (isCallable(N$Request)) {\n    var RequestConstructor = function Request(input /* , init */) {\n      anInstance(this, RequestPrototype);\n      return new N$Request(input, arguments.length > 1 ? wrapRequestOptions(arguments[1]) : {});\n    };\n\n    RequestPrototype.constructor = RequestConstructor;\n    RequestConstructor.prototype = RequestPrototype;\n\n    $({ global: true, forced: true }, {\n      Request: RequestConstructor\n    });\n  }\n}\n\nmodule.exports = {\n  URLSearchParams: URLSearchParamsConstructor,\n  getState: getInternalParamsState\n};\n","var global = require('../internals/global');\n\nvar TypeError = global.TypeError;\n\nmodule.exports = function (passed, required) {\n  if (passed < required) throw TypeError('Not enough arguments');\n  return passed;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\n\n// `URL.prototype.toJSON` method\n// https://url.spec.whatwg.org/#dom-url-tojson\n$({ target: 'URL', proto: true, enumerable: true }, {\n  toJSON: function toJSON() {\n    return call(URL.prototype.toString, this);\n  }\n});\n","!function(){function t(){var e=Array.prototype.slice.call(arguments),n=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;n.appendChild(t?e:document.createTextNode(String(e)))}),this.appendChild(n)}[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty(\"append\")||Object.defineProperty(e,\"append\",{configurable:!0,enumerable:!0,writable:!0,value:t})})}();\n","import {KL} from '../klecks/kl';\r\nimport {klHistory} from '../klecks/history/kl-history';\r\nimport {BB} from '../bb/bb';\r\nimport {showIframePopup} from '../klecks/ui/modals/show-iframe-popup';\r\n// @ts-ignore\r\nimport newImageImg from 'url:~/src/app/img/ui/new-image.svg';\r\n// @ts-ignore\r\nimport exportImg from 'url:~/src/app/img/ui/export.svg';\r\n// @ts-ignore\r\nimport shareImg from 'url:~/src/app/img/ui/share.svg';\r\n// @ts-ignore\r\nimport uploadImg from 'url:~/src/app/img/ui/upload.svg';\r\n// @ts-ignore\r\nimport importImg from 'url:~/src/app/img/ui/import.svg';\r\nimport {exportType} from '../klecks/ui/tool-tabs/file-tab';\r\nimport {ToolspaceTopRow} from \"../embed/toolspace-top-row\";\r\nimport {IKlProject} from '../klecks/kl.types';\r\nimport {importFilters} from '../klecks/filters/filters-lazy';\r\nimport {base64ToBlob} from '../klecks/storage/base-64-to-blob';\r\nimport {klCanvasToPsdBlob} from '../klecks/storage/kl-canvas-to-psd-blob';\r\nimport {ProjectStore} from '../klecks/storage/project-store';\r\nimport {SaveReminder} from \"../klecks/ui/components/save-reminder\";\r\n\r\ninterface IKlAppOptions {\r\n    saveReminder?: SaveReminder;\r\n    projectStore?: ProjectStore;\r\n    logoImg?: any; // app logo\r\n    bottomBar?: HTMLElement; // row at bottom of toolspace\r\n    embed?: {\r\n        url: string;\r\n        onSubmit: (onSuccess: () => void, onError: () => void) => void;\r\n    };\r\n    app?: {\r\n        filenameBase?: string; // part of filename when downloading drawing\r\n        imgurKey?: string; // for imgur uploads\r\n    };\r\n}\r\n\r\nimportFilters();\r\n\r\nexport function KlApp(pProject: IKlProject | null, pOptions: IKlAppOptions) {\r\n    // default 2048, unless your screen is bigger than that (that computer then probably has the horsepower for that)\r\n    // but not larger than 4096 - a fairly arbitrary decision\r\n    let klMaxCanvasSize = Math.min(4096, Math.max(2048, Math.max(window.screen.width, window.screen.height)));\r\n    let collapseThreshold = 820;\r\n    let uiState: 'left' | 'right' = (pOptions.embed ? 'left' : (localStorage.getItem('uiState') ? localStorage.getItem('uiState') : 'right')) as any;\r\n    const filenameBase = (pOptions.app && pOptions.app.filenameBase) ? pOptions.app.filenameBase : 'Klecks';\r\n    //private Element\r\n    //containing methods etc\r\n    let pEl = {\r\n        fillLayer: function (ctx) {\r\n            ctx.fillStyle = \"#fff\";\r\n            ctx.fillRect(0, 0, klCanvas.width, klCanvas.height);\r\n        }\r\n    };\r\n    const projectStore = pOptions.projectStore;\r\n    let klRootEl = document.createElement(\"div\");\r\n    klRootEl.className = 'g-root kl-initialized';\r\n    let uiWidth: number = Math.max(0, window.innerWidth);\r\n    let uiHeight: number = Math.max(0, window.innerHeight);\r\n    const toolWidth = 271;\r\n    let exportType: exportType = 'png';\r\n    let klCanvas = new KL.KlCanvas(\r\n        pProject ? {\r\n            projectObj: pProject\r\n        } : {\r\n            width: Math.min(klMaxCanvasSize, window.innerWidth < collapseThreshold ? uiWidth : uiWidth - toolWidth),\r\n            height: Math.min(klMaxCanvasSize, uiHeight)\r\n        }, pOptions.embed ? -1 : 0);\r\n    klCanvas.setHistory(klHistory);\r\n    let initState: any = {};\r\n    let mainTabRow;\r\n\r\n    if (!pOptions.saveReminder) {\r\n        pOptions.saveReminder = {init: () => {}, reset: () => {}} as SaveReminder;\r\n    }\r\n\r\n    function translateSmoothing(s) {\r\n        if(s == 1) {\r\n            return 1 - 0.5;\r\n        }\r\n        if(s == 2) {\r\n            return 1 - 0.16;\r\n        }\r\n        if(s == 3) {\r\n            return 1 - 0.035;\r\n        }\r\n        if(s == 4) {\r\n            return 1 - 0.0175;\r\n        }\r\n        if(s == 5) {\r\n            return 1 - 0.00875;\r\n        }\r\n        return s;\r\n    }\r\n\r\n    let isFirstImage = true;\r\n\r\n    if(pProject) {\r\n        pProject = null;\r\n    } else {\r\n        klHistory.pause();\r\n        klCanvas.addLayer();\r\n        pEl.fillLayer(klCanvas.getLayerContext(0));\r\n        klHistory.pause(false);\r\n    }\r\n    initState = {\r\n        canvas: new KL.KlCanvas({copy: klCanvas}, pOptions.embed ? -1 : 0),\r\n        focus: klCanvas.getLayerCount() - 1\r\n    };\r\n\r\n    initState.initBrushes = function () {\r\n        initState.brushes = {};\r\n        for (let b in KL.brushes) {\r\n            if (KL.brushes.hasOwnProperty(b)) {\r\n                initState.brushes[b] = new KL.brushes[b]();\r\n                if (initState.canvas) {\r\n                    initState.brushes[b].setContext(initState.canvas.getLayerContext(initState.focus));\r\n                }\r\n            }\r\n        }\r\n    };\r\n    initState.initBrushes();\r\n\r\n\r\n    let currentColor = new BB.RGB(0, 0, 0);\r\n    let currentBrush, currentBrushId;\r\n    let lastNonEraserBrushId = 0;\r\n    let currentLayerCtx = klCanvas.getLayerContext(klCanvas.getLayerCount() - 1);\r\n\r\n    function sizeWatcher(val) {\r\n        brushSettingService.emitSize(val);\r\n        if (klCanvasWorkspace) {\r\n            klCanvasWorkspace.setCursorSize(val * 2);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Central place to update brush settings, and to subscribe to changes.\r\n     *\r\n     * subscribers receive in this format:\r\n     * BrushSettingEvent\r\n     * {\r\n     *     type: 'color',\r\n     *     value: rgb obj\r\n     * } | {\r\n     *     type: 'size',\r\n     *     value: number\r\n     * } | {\r\n     *     type: 'opacity',\r\n     *     value: number 0-1\r\n     * } | {\r\n     *     type: 'sliderConfig',\r\n     *     value: {\r\n     *         sizeSlider: {min: number, max: number, curve: []} // curve optional\r\n     *         opacitySlider: {min: number, max: number, curve: []} // curve optional\r\n     *     }\r\n     * }\r\n     *\r\n     * interface in the return.\r\n     *\r\n     * @type obj\r\n     */\r\n    let brushSettingService = (function() {\r\n        let subscriberArr = [];\r\n\r\n        /**\r\n         * sends obj to all subscribers. except the skipSubscriber\r\n         * @param obj\r\n         * @param skipSubscriberr - optional - subscriber function not to emit to\r\n         */\r\n        function emit(obj, skipSubscriber?) {\r\n            for (let i = 0; i < subscriberArr.length; i++) {\r\n                if (subscriberArr[i] === skipSubscriber) {\r\n                    continue;\r\n                }\r\n                subscriberArr[i](obj);\r\n            }\r\n        }\r\n\r\n        function emitColor(rgbObj, skipSubscriber?) {\r\n            emit({\r\n                type: 'color',\r\n                value: rgbObj\r\n            }, skipSubscriber);\r\n        }\r\n\r\n        function emitSize(size, skipSubscriber?) {\r\n            emit({\r\n                type: 'size',\r\n                value: size\r\n            }, skipSubscriber);\r\n        }\r\n\r\n        /**\r\n         * @param opacity 0-1\r\n         * @param skipSubscriber\r\n         */\r\n        function emitOpacity(opacity, skipSubscriber?) {\r\n            emit({\r\n                type: 'opacity',\r\n                value: opacity\r\n            }, skipSubscriber);\r\n        }\r\n\r\n        /**\r\n         * @param config\r\n         * @param skipSubscriber\r\n         */\r\n        function emitSliderConfig(config, skipSubscriber?) {\r\n            emit({\r\n                type: 'sliderConfig',\r\n                value: config\r\n            }, skipSubscriber);\r\n        }\r\n\r\n\r\n        return {\r\n            emitColor: emitColor,\r\n            emitSize: emitSize,\r\n            emitOpacity: emitOpacity,\r\n            emitSliderConfig: emitSliderConfig,\r\n            /**\r\n             * set current brush color\r\n             * @param rgbObj\r\n             * @param skipSubscriber\r\n             */\r\n            setColor: function(rgbObj, skipSubscriber?) { //for a subscriber\r\n                pcColorSlider.setColor(rgbObj);\r\n                currentBrush.setColor(rgbObj);\r\n                currentColor = rgbObj;\r\n                emitColor(rgbObj, skipSubscriber);\r\n            },\r\n\r\n            /**\r\n             * set current brush size\r\n             * @param size\r\n             * @param skipSubscriber\r\n             */\r\n            setSize: function(size, skipSubscriber?) {\r\n                currentBrush.setSize(size);\r\n                klCanvasWorkspace.setCursorSize(size * 2);\r\n            },\r\n\r\n            /**\r\n             * set current opacity\r\n             * @param opacity 0-1\r\n             * @param skipSubscriber\r\n             */\r\n            setOpacity: function(opacity, skipSubscriber?) {\r\n                currentBrush.setOpacity(opacity);\r\n            },\r\n\r\n            /**\r\n             * get current brush color\r\n             * @returns rgbObj\r\n             */\r\n            getColor: function() {\r\n                return pcColorSlider.getColor();\r\n            },\r\n            /**\r\n             * @returns number\r\n             */\r\n            getSize: function() {\r\n                return brushUiObj[currentBrushId].getSize();\r\n            },\r\n            /**\r\n             * @returns number 0-1\r\n             */\r\n            getOpacity: function() {\r\n                return brushUiObj[currentBrushId].getOpacity();\r\n            },\r\n            /**\r\n             * @returns config\r\n             */\r\n            getSliderConfig: function() {\r\n                return {\r\n                    sizeSlider: KL.brushesUI[currentBrushId].sizeSlider,\r\n                    opacitySlider: KL.brushesUI[currentBrushId].opacitySlider\r\n                };\r\n            },\r\n            /**\r\n             * subscribe to changes\r\n             * @param func(BrushSettingEvent) - this function gets called on change\r\n             */\r\n            subscribe: function(func) {\r\n                subscriberArr.push(func);\r\n            },\r\n            unsubscribe: function(func) {\r\n                for(let i = 0; i < subscriberArr.length; i++) {\r\n                    if(func === subscriberArr[i]) {\r\n                        subscriberArr.splice(i, 1);\r\n                        i--;\r\n                    }\r\n                }\r\n            }\r\n        };\r\n    })();\r\n\r\n    let lineSmoothing = new BB.EventChain.LineSmoothing({\r\n        smoothing: translateSmoothing(1)\r\n    });\r\n    let lineSanitizer = new BB.EventChain.LineSanitizer();\r\n\r\n    let drawEventChain = new BB.EventChain.EventChain({\r\n        chainArr: [\r\n            lineSanitizer,\r\n            lineSmoothing\r\n        ]\r\n    });\r\n    //window.line = [];\r\n    drawEventChain.setChainOut(function(event) {\r\n        if(event.type === 'down') {\r\n            toolspace.style.pointerEvents = 'none';\r\n            currentBrush.startLine(event.x, event.y, event.pressure);\r\n            //window.line.push(['start', event.x, event.y, event.pressure]);\r\n            klCanvasWorkspace.requestFrame();\r\n        }\r\n        if(event.type === 'move') {\r\n            currentBrush.goLine(event.x, event.y, event.pressure, false, event.isCoalesced)\r\n            //window.line.push(['goLine', event.x, event.y, event.pressure, false, event.isCoalesced]);\r\n            klCanvasWorkspace.setLastDrawEvent(event.x, event.y, event.pressure);\r\n            klCanvasWorkspace.requestFrame();\r\n        }\r\n        if(event.type === 'up') {\r\n            toolspace.style.pointerEvents = '';\r\n            currentBrush.endLine();\r\n            //window.line.push(['endLine']);\r\n            klCanvasWorkspace.requestFrame();\r\n        }\r\n        if(event.type === 'line') {\r\n            //window.line.push(['lineSegment', event.x0, event.y0, event.x1, event.y1]);\r\n            currentBrush.getBrush().drawLineSegment(event.x0, event.y0, event.x1, event.y1);\r\n            klCanvasWorkspace.requestFrame();\r\n        }\r\n    });\r\n\r\n    // <- debug drawing goes here\r\n\r\n    let textToolSettings = {\r\n        size: 20,\r\n        align: 'left',\r\n        isBold: false,\r\n        isItalic: false,\r\n        font: 'sans-serif',\r\n        opacity: 1\r\n    };\r\n\r\n    const klCanvasWorkspace = new KL.KlCanvasWorkspace({\r\n        klCanvas: klCanvas,\r\n        width: Math.max(0, uiWidth - toolWidth),\r\n        height: uiHeight,\r\n        onDraw: drawEventChain.chainIn,\r\n        onPick: function(rgbObj, isDragDone) {\r\n            brushSettingService.setColor(rgbObj);\r\n            if(isDragDone) {\r\n                pcColorSlider.pickingDone();\r\n                klCanvasWorkspace.setMode(toolspaceToolRow.getActive());\r\n            }\r\n        },\r\n        onFill: function(canvasX, canvasY) {\r\n            let layerIndex = klCanvas.getLayerIndex(currentLayerCtx.canvas);\r\n            klCanvas.floodFill(layerIndex, canvasX, canvasY, pcColorSlider.getColor(), fillUi.getOpacity(), fillUi.getTolerance(), fillUi.getSample(), fillUi.getGrow(), fillUi.getContiguous());\r\n            klCanvasWorkspace.requestFrame();\r\n        },\r\n        onText: function(canvasX, canvasY, angleRad) {\r\n            if (KL.dialogCounter.count > 0) {\r\n                return;\r\n            }\r\n\r\n            KL.textToolDialog({\r\n                klCanvas: klCanvas,\r\n                layerIndex: klCanvas.getLayerIndex(currentLayerCtx.canvas),\r\n                x: canvasX,\r\n                y: canvasY,\r\n                angleRad: angleRad,\r\n                color: pcColorSlider.getColor(),\r\n                secondaryColor: pcColorSlider.getSecondaryRGB(),\r\n                size: textToolSettings.size,\r\n                align: textToolSettings.align,\r\n                isBold: textToolSettings.isBold,\r\n                isItalic: textToolSettings.isItalic,\r\n                font: textToolSettings.font,\r\n                opacity: textToolSettings.opacity,\r\n                onConfirm: function(val) {\r\n\r\n                    let colorRGBA = val.color;\r\n                    colorRGBA.a = val.opacity;\r\n\r\n                    textToolSettings.size = val.size;\r\n                    textToolSettings.align = val.align;\r\n                    textToolSettings.isBold = val.isBold;\r\n                    textToolSettings.isItalic = val.isItalic;\r\n                    textToolSettings.font = val.font;\r\n                    textToolSettings.opacity = val.opacity;\r\n\r\n                    let layerIndex = klCanvas.getLayerIndex(currentLayerCtx.canvas);\r\n                    klCanvas.text(layerIndex, {\r\n                        textStr: val.textStr,\r\n                        x: val.x,\r\n                        y: val.y,\r\n                        angleRad: angleRad,\r\n                        color: BB.ColorConverter.toRgbaStr(colorRGBA),\r\n                        size: val.size,\r\n                        align: val.align,\r\n                        isBold: val.isBold,\r\n                        isItalic: val.isItalic,\r\n                        font: val.font\r\n                    });\r\n                    klCanvasWorkspace.requestFrame();\r\n                }\r\n            });\r\n\r\n        },\r\n        onShape: function(typeStr, canvasX, canvasY, angleRad) {\r\n            if (typeStr === 'down') {\r\n                shapeTool.onDown(canvasX, canvasY, angleRad);\r\n            }\r\n            if (typeStr === 'move') {\r\n                shapeTool.onMove(canvasX, canvasY);\r\n            }\r\n            if (typeStr === 'up') {\r\n                shapeTool.onUp(canvasX, canvasY);\r\n            }\r\n        },\r\n\r\n        onViewChange: function(viewChangeObj) {\r\n\r\n            if(viewChangeObj.changed.includes('scale')) {\r\n                statusOverlay.out({\r\n                    type: 'transform',\r\n                    scale: viewChangeObj.scale,\r\n                    angleDeg: viewChangeObj.angle * 180 / Math.PI\r\n                });\r\n            }\r\n\r\n            toolspaceToolRow.setEnableZoomIn(viewChangeObj.scale !== klCanvasWorkspace.getMaxScale());\r\n            toolspaceToolRow.setEnableZoomOut(viewChangeObj.scale !== klCanvasWorkspace.getMinScale());\r\n\r\n            handUi.update(viewChangeObj.scale, viewChangeObj.angle * 180 / Math.PI);\r\n        },\r\n        onUndo: function() {\r\n            if(klHistory.canUndo()) {\r\n                if (undoRedoCatchup.undo()) {\r\n                    statusOverlay.out('Undo', true);\r\n                }\r\n            }\r\n        },\r\n        onRedo: function() {\r\n            if(klHistory.canRedo()) {\r\n                if (undoRedoCatchup.redo()) {\r\n                    statusOverlay.out('Redo', true);\r\n                }\r\n            }\r\n        },\r\n    });\r\n    let keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, event, comboStr) {\r\n            if (KL.dialogCounter.count > 0) {\r\n                return;\r\n            }\r\n            if (BB.isInputFocused(true)) {\r\n                return;\r\n            }\r\n\r\n            let isDrawing = lineSanitizer.getIsDrawing() || klCanvasWorkspace.getIsDrawing();\r\n            if (isDrawing) {\r\n                return;\r\n            }\r\n\r\n            if(comboStr === 'plus') {\r\n                klCanvasWorkspace.zoomByStep(keyListener.isPressed('shift') ? 1/8 : 1/2);\r\n            }\r\n            if(comboStr === 'minus') {\r\n                klCanvasWorkspace.zoomByStep(keyListener.isPressed('shift') ? -1/8 : -1/2);\r\n            }\r\n            if(comboStr === 'home') {\r\n                klCanvasWorkspace.fitView();\r\n            }\r\n            if(comboStr === 'end') {\r\n                klCanvasWorkspace.resetView(true);\r\n            }\r\n            if (['ctrl+z', 'cmd+z'].includes(comboStr)) {\r\n                event.preventDefault();\r\n                event.returnValue = false;\r\n                undoRedoCatchup.undo();\r\n            }\r\n            if (['ctrl+y', 'cmd+y'].includes(comboStr)) {\r\n                event.preventDefault();\r\n                event.returnValue = false;\r\n                undoRedoCatchup.redo();\r\n            }\r\n            if (!pOptions.embed) {\r\n                if (['ctrl+s', 'cmd+s'].includes(comboStr)) {\r\n                    event.preventDefault();\r\n                    event.returnValue = false;\r\n                    saveToComputer.save();\r\n                }\r\n                if (['ctrl+shift+s', 'cmd+shift+s'].includes(comboStr)) {\r\n                    event.preventDefault();\r\n                    event.returnValue = false;\r\n\r\n                    (async () => {\r\n                        let success = true;\r\n                        try {\r\n                            await projectStore.store(klCanvas.getProject());\r\n                        } catch (e) {\r\n                            success = false;\r\n                            setTimeout(() => {\r\n                                throw new Error('keyboard-shortcut: failed to store browser storage, ' + e);\r\n                            }, 0);\r\n                            statusOverlay.out('❌ Failed to store to Browser Storage', true);\r\n                        }\r\n                        if (success) {\r\n                            pOptions.saveReminder.reset();\r\n                            statusOverlay.out('Stored to Browser Storage', true);\r\n                        }\r\n                    })();\r\n                }\r\n                if (['ctrl+c', 'cmd+c'].includes(comboStr)) {\r\n                    event.preventDefault();\r\n                    event.returnValue = false;\r\n                    copyToClipboard(true);\r\n                }\r\n            }\r\n            if (['ctrl+a', 'cmd+a'].includes(comboStr)) {\r\n                event.preventDefault();\r\n                event.returnValue = false;\r\n            }\r\n\r\n\r\n            if(keyListener.comboOnlyContains(['left', 'right', 'up', 'down'])) {\r\n                if (keyStr === 'left') {\r\n                    klCanvasWorkspace.translateView(1, 0);\r\n                }\r\n                if (keyStr === 'right') {\r\n                    klCanvasWorkspace.translateView(-1, 0);\r\n                }\r\n                if (keyStr === 'up') {\r\n                    klCanvasWorkspace.translateView(0, 1);\r\n                }\r\n                if (keyStr === 'down') {\r\n                    klCanvasWorkspace.translateView(0, -1);\r\n                }\r\n            }\r\n\r\n\r\n            if(['r+left','r+right'].includes(comboStr)) {\r\n                if (keyStr === 'left') {\r\n                    klCanvasWorkspace.setAngle(-15, true);\r\n                    handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n                }\r\n                if (keyStr === 'right') {\r\n                    klCanvasWorkspace.setAngle(15, true);\r\n                    handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n                }\r\n            }\r\n            if(['r+up'].includes(comboStr)) {\r\n                klCanvasWorkspace.setAngle(0);\r\n                handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n            }\r\n\r\n\r\n            if (comboStr === 'sqbr_open') {\r\n                currentBrush.decreaseSize(0.03 / klCanvasWorkspace.getScale());\r\n            }\r\n            if (comboStr === 'sqbr_close') {\r\n                currentBrush.increaseSize(0.03 / klCanvasWorkspace.getScale());\r\n            }\r\n            if (comboStr === 'enter') {\r\n                klCanvas.layerFill(klCanvas.getLayerIndex(currentLayerCtx.canvas), pcColorSlider.getColor());\r\n                statusOverlay.out('Filled', true);\r\n            }\r\n            if (['delete', 'backspace'].includes(comboStr)) {\r\n                let layerIndex = klCanvas.getLayerIndex(currentLayerCtx.canvas);\r\n                if (layerIndex === 0 && !brushUiObj.eraser.getIsTransparentBg()) {\r\n                    klCanvas.layerFill(layerIndex, {r: 255, g: 255, b: 255}, 'source-in');\r\n                } else {\r\n                    klCanvas.clearLayer(layerIndex);\r\n                }\r\n                statusOverlay.out('Cleared layer', true);\r\n            }\r\n            if (comboStr === 'e') {\r\n                event.preventDefault();\r\n                klCanvasWorkspace.setMode('draw');\r\n                toolspaceToolRow.setActive('draw');\r\n                mainTabRow.open('draw');\r\n                updateMainTabVisibility();\r\n                brushTabRow.open('eraser');\r\n            }\r\n            if (comboStr === 'b') {\r\n                event.preventDefault();\r\n                klCanvasWorkspace.setMode('draw');\r\n                toolspaceToolRow.setActive('draw');\r\n                mainTabRow.open('draw');\r\n                updateMainTabVisibility();\r\n                brushTabRow.open(lastNonEraserBrushId);\r\n            }\r\n            if (comboStr === 'g') {\r\n                event.preventDefault();\r\n                klCanvasWorkspace.setMode('fill');\r\n                toolspaceToolRow.setActive('fill');\r\n                mainTabRow.open('fill');\r\n                updateMainTabVisibility();\r\n            }\r\n            if (comboStr === 't') {\r\n                event.preventDefault();\r\n                klCanvasWorkspace.setMode('text');\r\n                toolspaceToolRow.setActive('text');\r\n                mainTabRow.open('text');\r\n                updateMainTabVisibility();\r\n            }\r\n            if (comboStr === 'u') {\r\n                event.preventDefault();\r\n                klCanvasWorkspace.setMode('shape');\r\n                toolspaceToolRow.setActive('shape');\r\n                mainTabRow.open('shape');\r\n                updateMainTabVisibility();\r\n            }\r\n            if (comboStr === 'x') {\r\n                event.preventDefault();\r\n                pcColorSlider.swapColors();\r\n            }\r\n\r\n\r\n        },\r\n        onUp: function(keyStr) {\r\n        }\r\n    });\r\n\r\n    /**\r\n     *\r\n     * @param importedImage - convertedPsd | {type: 'image', width: number, height: number, canvas: image | canvas}\r\n     * @param filename - string e.g. 'drawing.psd'\r\n     * @param optionStr? - 'default' | 'layer' | 'image'\r\n     */\r\n    function importFinishedLoading(importedImage, filename, optionStr) {\r\n        if (!importedImage || isNaN(importedImage.width) || isNaN(importedImage.height) || importedImage.width <= 0 || importedImage.height <= 0) {\r\n            KL.popup({\r\n                target: klRootEl,\r\n                type: \"error\",\r\n                message: \"Couldn't load image. File might be corrupted.\",\r\n                buttons: [\"Ok\"],\r\n            });\r\n            return;\r\n        }\r\n\r\n        function getResizedDimensions(width, height) {\r\n            let w = parseInt(width);\r\n            let h = parseInt(height);\r\n            if (w > klMaxCanvasSize) {\r\n                h = klMaxCanvasSize / w * h;\r\n                w = klMaxCanvasSize;\r\n            }\r\n            if (h > klMaxCanvasSize) {\r\n                w = klMaxCanvasSize / h * w;\r\n                h = klMaxCanvasSize;\r\n            }\r\n            w = parseInt('' + w);\r\n            h = parseInt('' + h);\r\n            return {\r\n                width: w,\r\n                height: h\r\n            }\r\n        }\r\n\r\n        function importAsImage(canvas) {\r\n            let resizedDimensions = getResizedDimensions(canvas.width, canvas.height);\r\n\r\n            //resize first\r\n            let tempCanvas = BB.canvas(canvas.width, canvas.height);\r\n            let tempCanvasCtx = tempCanvas.getContext('2d');\r\n            tempCanvasCtx.drawImage(canvas, 0, 0);\r\n\r\n            BB.resizeCanvas(tempCanvas, resizedDimensions.width, resizedDimensions.height);\r\n\r\n            klCanvas.reset({\r\n                width: resizedDimensions.width,\r\n                height: resizedDimensions.height,\r\n                image: tempCanvas,\r\n                layerName: filename\r\n            });\r\n\r\n            layerManager.update(0);\r\n            setCurrentLayer(klCanvas.getLayer(0));\r\n            klCanvasWorkspace.resetView();\r\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n\r\n            isFirstImage = false;\r\n        }\r\n\r\n        /**\r\n         *\r\n         * @param convertedPsdObj - if flattened then without layerArr\r\n         * @param cropObj? - {x: number, y: number, width: number, height: number}\r\n         */\r\n        function importAsImagePsd(convertedPsdObj, cropObj?) {\r\n\r\n            // crop\r\n            function crop(targetCanvas, cropCanvas, cropObj) {\r\n                cropCanvas.width = cropCanvas.width;\r\n                cropCanvas.getContext('2d').drawImage(targetCanvas, -cropObj.x, -cropObj.y);\r\n                targetCanvas.width = cropObj.width;\r\n                targetCanvas.height = cropObj.height;\r\n                targetCanvas.getContext('2d').drawImage(cropCanvas, 0, 0);\r\n            }\r\n            if (cropObj && (cropObj.width !== convertedPsdObj.width ||cropObj.height !== convertedPsdObj.height)) {\r\n                let cropCanvas = BB.canvas(cropObj.width, cropObj.height);\r\n                convertedPsdObj.width = cropObj.width;\r\n                convertedPsdObj.height = cropObj.height;\r\n\r\n                if (!convertedPsdObj.layerArr) {\r\n                    crop(convertedPsdObj.canvas, cropCanvas, cropObj);\r\n                }\r\n                if (convertedPsdObj.layerArr) {\r\n                    for (let i = 0; i < convertedPsdObj.layerArr.length; i++) {\r\n                        let item = convertedPsdObj.layerArr[i];\r\n                        crop(item.canvas, cropCanvas, cropObj);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // resize\r\n            let resizedDimensions = getResizedDimensions(convertedPsdObj.width, convertedPsdObj.height);\r\n            convertedPsdObj.width = resizedDimensions.width;\r\n            convertedPsdObj.height = resizedDimensions.height;\r\n            if (!convertedPsdObj.layerArr) {\r\n                BB.resizeCanvas(convertedPsdObj.canvas, convertedPsdObj.width, convertedPsdObj.height);\r\n            }\r\n            if (convertedPsdObj.layerArr) {\r\n                for (let i = 0; i < convertedPsdObj.layerArr.length; i++) {\r\n                    let item = convertedPsdObj.layerArr[i];\r\n                    BB.resizeCanvas(item.canvas, convertedPsdObj.width, convertedPsdObj.height);\r\n                }\r\n            }\r\n\r\n            let layerIndex;\r\n            if (convertedPsdObj.layerArr) {\r\n                layerIndex = klCanvas.reset({\r\n                    width: convertedPsdObj.width,\r\n                    height: convertedPsdObj.height,\r\n                    layerArr: convertedPsdObj.layerArr\r\n                });\r\n            } else {\r\n                layerIndex = klCanvas.reset({\r\n                    width: convertedPsdObj.width,\r\n                    height: convertedPsdObj.height,\r\n                    image: convertedPsdObj.canvas\r\n                });\r\n            }\r\n            layerManager.update(layerIndex);\r\n            setCurrentLayer(klCanvas.getLayer(layerIndex));\r\n            klCanvasWorkspace.resetView();\r\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n\r\n            isFirstImage = false;\r\n        }\r\n\r\n        function importAsLayer(canvas) {\r\n            KL.showImportAsLayerDialog({\r\n                target: klRootEl,\r\n                klCanvas: klCanvas,\r\n                importImage: canvas,\r\n                callback: function(transformObj, isPixelated: boolean) {\r\n                    if (!transformObj) {\r\n                        return;\r\n                    }\r\n\r\n                    klHistory.pause();\r\n                    klCanvas.addLayer();\r\n                    let layers = klCanvas.getLayers();\r\n                    let activeLayerIndex = layers.length - 1;\r\n                    if (filename) {\r\n                        klCanvas.renameLayer(activeLayerIndex, filename);\r\n                    }\r\n                    let activeLayerContext = klCanvas.getLayerContext(activeLayerIndex);\r\n                    BB.drawTransformedImageWithBounds(activeLayerContext, canvas, transformObj, null, isPixelated);\r\n                    setCurrentLayer(klCanvas.getLayer(activeLayerIndex));\r\n                    layerManager.update(activeLayerIndex);\r\n\r\n                    klHistory.pause(false);\r\n\r\n                    klHistory.add({\r\n                        tool: [\"misc\"],\r\n                        action: \"importImage\",\r\n                        params: [BB.copyCanvas(activeLayerContext.canvas), filename]\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n\r\n        if(optionStr === 'default' || !optionStr) {\r\n            KL.showImportImageDialog({\r\n                image: importedImage,\r\n                target: klRootEl,\r\n                maxSize: klMaxCanvasSize,\r\n                callback: function(res) {\r\n                    if (res.type === 'as-image') {\r\n                        importAsImage(res.image);\r\n                    } else if (res.type === 'as-image-psd') {\r\n                        importAsImagePsd(res.image, res.cropObj);\r\n                    } else if (res.type === 'as-layer') {\r\n                        importAsLayer(res.image);\r\n                    } else if (res.type === 'cancel') {\r\n                        // nothing to do\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        if(optionStr === 'layer') {\r\n            importAsLayer(importedImage.canvas);\r\n        }\r\n        if(optionStr === 'image') {\r\n            if (importedImage.type === 'psd') {\r\n                importAsImagePsd(importedImage);\r\n            } else {\r\n                importAsImage(importedImage.canvas);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    function onPaste(e) {\r\n        if (KL.dialogCounter.count > 0) {\r\n            return;\r\n        }\r\n\r\n        function retrieveImageFromClipboardAsBlob(pasteEvent, callback) {\r\n            if (pasteEvent.clipboardData == false) {\r\n                if (typeof (callback) == \"function\") {\r\n                    callback(undefined);\r\n                }\r\n            }\r\n\r\n            let items = pasteEvent.clipboardData.items;\r\n\r\n            if (items == undefined) {\r\n                if (typeof (callback) == \"function\") {\r\n                    callback(undefined);\r\n                }\r\n            }\r\n\r\n            for (let i = 0; i < items.length; i++) {\r\n                if (items[i].type.indexOf(\"image\") == -1) {\r\n                    continue;\r\n                }\r\n                let blob = items[i].getAsFile();\r\n\r\n                if (typeof (callback) == \"function\") {\r\n                    callback(blob);\r\n                }\r\n            }\r\n        }\r\n\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n\r\n        if (e.clipboardData.files[0]) {\r\n            retrieveImageFromClipboardAsBlob(e, function (imageBlob) {\r\n                // If there's an image, display it in the canvas\r\n                if (imageBlob) {\r\n                    let img = new Image();\r\n                    img.onload = function () {\r\n                        importFinishedLoading({\r\n                            type: 'image',\r\n                            width: img.width,\r\n                            height: img.height,\r\n                            canvas: img\r\n                        }, null, 'default');\r\n                    };\r\n                    let URLObj = window.URL || window.webkitURL;\r\n                    img.src = URLObj.createObjectURL(imageBlob);\r\n                }\r\n            });\r\n        } else if (e.clipboardData.items[0]) {\r\n            e.clipboardData.items[0].getAsString(function(pasteStr) {\r\n                pasteStr = pasteStr.trim();\r\n                if (pasteStr.match(/^https?/)) {\r\n                    // url\r\n                    let img = new Image();\r\n                    img.onload = function () {\r\n                        importFinishedLoading({\r\n                            type: 'image',\r\n                            width: img.width,\r\n                            height: img.height,\r\n                            canvas: img\r\n                        }, null, 'default');\r\n                    };\r\n                    img.onerror = function (e) {\r\n                        console.log('error loading', e);\r\n                    };\r\n                    img.crossOrigin = 'Anonymous';\r\n                    img.src = pasteStr;\r\n\r\n                } else if (pasteStr.match(/^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/)) {\r\n                    // url\r\n                    let rgbObj = BB.ColorConverter.hexToRGB(pasteStr.replace('#', ''));\r\n                    brushSettingService.setColor(rgbObj);\r\n                }\r\n            });\r\n\r\n        }\r\n    }\r\n\r\n    function handleFileSelect(files, optionStr) {\r\n\r\n        function showWarningPsdFlattened() {\r\n            KL.popup({\r\n                target: klRootEl,\r\n                type: \"warning\",\r\n                message: \"Unsupported features. PSD had to be flattened.<br /><br />\",\r\n                buttons: [\"Ok\"],\r\n            });\r\n        }\r\n\r\n        let hasUnsupportedFile = false;\r\n        for (let i = 0, file; file = files[i]; i++) {\r\n            let extension = file.name.split(\".\");\r\n            extension = extension[extension.length - 1].toLowerCase();\r\n            if (extension === \"psd\") {\r\n\r\n                (function(f) {\r\n                    let loaderSizeBytes = 1024 * 1024 * 25; // 25mb\r\n                    let maxSizeBytes = 1024 * 1024 * 1024; // 1gb\r\n                    let maxResolution = 4096;\r\n\r\n                    if (f.size >= maxSizeBytes) { // pretty likely to break stuff\r\n                        KL.popup({\r\n                            target: klRootEl,\r\n                            type: \"error\",\r\n                            message: \"File too big. Unable to import.<br /><br />\",\r\n                            buttons: [\"Ok\"],\r\n                        });\r\n                        return;\r\n                    }\r\n\r\n                    let doShowLoader = files.length === 1 && f.size >= loaderSizeBytes;\r\n                    let loaderIsOpen = true;\r\n                    let closeLoader;\r\n\r\n                    if (doShowLoader) {\r\n                        KL.popup({\r\n                            target: klRootEl,\r\n                            message: \"Opening file...\",\r\n                            callback: function (result) {\r\n                                loaderIsOpen = false;\r\n                                closeLoader = null;\r\n                            },\r\n                            closefunc: function (f) {\r\n                                closeLoader = f;\r\n                            }\r\n                        });\r\n                    }\r\n\r\n\r\n                    let reader = new FileReader();\r\n                    reader.onload = function (readerResult) {\r\n\r\n                        KL.loadAgPsd().then(function(agPsdLazy) {\r\n\r\n                            if (doShowLoader && !loaderIsOpen) {\r\n                                return;\r\n                            }\r\n\r\n                            try {\r\n                                //let psd = agPsdLazy.readPsd(readerResult.target.result, { skipLayerImageData: true, skipThumbnail: true });\r\n                                let psd;\r\n\r\n                                // first pass, only read metadata\r\n                                psd = agPsdLazy.readPsd(\r\n                                    (readerResult.target.result as any),\r\n                                    {\r\n                                        skipLayerImageData: true,\r\n                                        skipThumbnail: true,\r\n                                        skipCompositeImageData: true\r\n                                    });\r\n                                if (psd.width > maxResolution || psd.height > maxResolution) {\r\n                                    if (closeLoader) {\r\n                                        closeLoader();\r\n                                    }\r\n                                    KL.popup({\r\n                                        target: klRootEl,\r\n                                        type: \"error\",\r\n                                        message: \"Image exceeds maximum dimensions of \"+maxResolution+\" x \"+maxResolution+\" pixels. Unable to import.\"\r\n                                            + \"<br /><br />\"\r\n                                            + \"Image size: \" + psd.width + \" x \" + psd.height + ' pixels'\r\n                                            + \"<br /><br />\"\r\n                                        ,\r\n                                        buttons: [\"Ok\"],\r\n                                    });\r\n                                    return;\r\n                                }\r\n\r\n\r\n                                // second pass, now load actual data.\r\n                                psd = null;\r\n\r\n                                try {\r\n                                    psd = agPsdLazy.readPsd((readerResult.target.result as any));\r\n                                } catch (e) {\r\n                                    //console.log('failed regular psd import', e);\r\n                                }\r\n                                if (psd) {\r\n                                    //console.log('psd', psd);\r\n                                    let convertedPsd = KL.PSD.readPsd(psd);\r\n                                    //console.log('converted', convertedPsd);\r\n                                    if (optionStr === 'image' && convertedPsd.error) {\r\n                                        showWarningPsdFlattened();\r\n                                    }\r\n\r\n                                    if (closeLoader) {\r\n                                        closeLoader();\r\n                                    }\r\n                                    importFinishedLoading(convertedPsd, f.name, optionStr);\r\n                                } else {\r\n                                    psd = agPsdLazy.readPsd((readerResult.target.result as any), { skipLayerImageData: true, skipThumbnail: true });\r\n                                    if (optionStr === 'image') {\r\n                                        showWarningPsdFlattened();\r\n                                    }\r\n\r\n                                    if (closeLoader) {\r\n                                        closeLoader();\r\n                                    }\r\n                                    importFinishedLoading({\r\n                                        type: 'psd',\r\n                                        width: psd.width,\r\n                                        height: psd.height,\r\n                                        canvas: psd.canvas,\r\n                                        error: true\r\n                                    }, f.name, optionStr);\r\n                                }\r\n\r\n\r\n                            } catch (e) {\r\n                                if (closeLoader) {\r\n                                    closeLoader();\r\n                                }\r\n                                console.log(e);\r\n                                KL.popup({\r\n                                    target: klRootEl,\r\n                                    type: \"error\",\r\n                                    message: \"Failed to load PSD.<br /><br />\",\r\n                                    buttons: [\"Ok\"],\r\n                                });\r\n                            }\r\n                        }).catch(() => {\r\n                            closeLoader();\r\n                            alert('Error: failed to load PSD library');\r\n                        });\r\n\r\n                    };\r\n                    reader.readAsArrayBuffer(f);\r\n                })(file);\r\n\r\n            } else if (file.type.match('image.*')) {\r\n                (function (f) {\r\n                    window.URL = window.URL || window.webkitURL;\r\n                    let url = window.URL.createObjectURL(f);\r\n                    let im = new Image();\r\n                    im.src = url;\r\n                    BB.loadImage(im, function () {\r\n                        importFinishedLoading({\r\n                            type: 'image',\r\n                            width: im.width,\r\n                            height: im.height,\r\n                            canvas: im\r\n                        }, f.name, optionStr);\r\n                    });\r\n                })(file);\r\n            } else {\r\n                hasUnsupportedFile = true;\r\n            }\r\n        }\r\n        if (hasUnsupportedFile) {\r\n            KL.popup({\r\n                target: klRootEl,\r\n                message: 'Unsupported file type. See Help for supported types.',\r\n                type: 'error',\r\n                buttons: ['OK'],\r\n            });\r\n        }\r\n    }\r\n\r\n    if (!pOptions.embed) {\r\n        let pcImageDropper = new KL.PcImageDropper({\r\n            target: document.body,\r\n            onDrop: function(files, optionStr) {\r\n                if (KL.dialogCounter.count > 0) {\r\n                    return;\r\n                }\r\n                handleFileSelect(files, optionStr);\r\n            },\r\n            enabledTest: function() {\r\n                return !KL.dialogCounter.count;\r\n            }\r\n        });\r\n\r\n        BB.addEventListener(window, 'paste', onPaste, false);\r\n    }\r\n\r\n    const brushUiObj: any = {};\r\n\r\n    // create brush UIs\r\n    for (let b in KL.brushesUI) {\r\n        if (KL.brushesUI.hasOwnProperty(b)) {\r\n            let ui = new KL.brushesUI[b].Ui({\r\n                onSizeChange: sizeWatcher,\r\n                onOpacityChange: function(opacity) {\r\n                    brushSettingService.emitOpacity(opacity);\r\n                }\r\n            });\r\n            brushUiObj[b] = ui;\r\n            ui.getElement().style.padding = 10 + 'px';\r\n        }\r\n    }\r\n\r\n\r\n    BB.css(klRootEl, {\r\n        position: 'absolute',\r\n        left: '0',\r\n        top: '0',\r\n        right: '0',\r\n        bottom: '0'\r\n    });\r\n\r\n    let statusOverlay = new KL.StatusOverlay();\r\n\r\n    let toolspace = document.createElement(\"div\");\r\n    toolspace.oncontextmenu = function () {\r\n        return false;\r\n    };\r\n    toolspace.onclick = BB.handleClick;\r\n\r\n\r\n    let toolspaceCollapser = new KL.ToolspaceCollapser({\r\n        onChange: function() {\r\n            updateCollapse();\r\n        }\r\n    });\r\n    function updateCollapse() {\r\n\r\n        //collapser\r\n        if (uiWidth < collapseThreshold) {\r\n            toolspaceCollapser.getElement().style.display = 'block';\r\n\r\n            toolspaceCollapser.setDirection(uiState);\r\n            if (toolspaceCollapser.isOpen()) {\r\n                if (uiState === 'left') {\r\n                    BB.css(toolspaceCollapser.getElement(), {\r\n                        left: '271px',\r\n                        right: '',\r\n                    });\r\n                    BB.css(klCanvasWorkspace.getElement(), {\r\n                        left: '271px'\r\n                    });\r\n                } else {\r\n                    BB.css(toolspaceCollapser.getElement(), {\r\n                        left: '',\r\n                        right: '271px'\r\n                    });\r\n                    BB.css(klCanvasWorkspace.getElement(), {\r\n                        left: '0'\r\n                    });\r\n                }\r\n                toolspace.style.display = 'block';\r\n                klCanvasWorkspace.setSize(Math.max(0, uiWidth - toolWidth), uiHeight);\r\n                statusOverlay.setWide(false);\r\n\r\n            } else {\r\n                if (uiState === 'left') {\r\n                    BB.css(toolspaceCollapser.getElement(), {\r\n                        left: '0',\r\n                        right: '',\r\n                    });\r\n                    BB.css(klCanvasWorkspace.getElement(), {\r\n                        left: '0'\r\n                    });\r\n                } else {\r\n                    BB.css(toolspaceCollapser.getElement(), {\r\n                        left: '',\r\n                        right: '0'\r\n                    });\r\n                    BB.css(klCanvasWorkspace.getElement(), {\r\n                        left: '0'\r\n                    });\r\n                }\r\n                toolspace.style.display = 'none';\r\n                klCanvasWorkspace.setSize(Math.max(0, uiWidth), uiHeight);\r\n                statusOverlay.setWide(true);\r\n\r\n            }\r\n\r\n        } else {\r\n            toolspaceCollapser.getElement().style.display = 'none';\r\n            if (uiState === 'left') {\r\n                BB.css(klCanvasWorkspace.getElement(), {\r\n                    left: '271px'\r\n                });\r\n            } else {\r\n                BB.css(klCanvasWorkspace.getElement(), {\r\n                    left: '0'\r\n                });\r\n            }\r\n            toolspace.style.display = 'block';\r\n            klCanvasWorkspace.setSize(Math.max(0, uiWidth - toolWidth), uiHeight);\r\n            statusOverlay.setWide(false);\r\n\r\n        }\r\n    }\r\n    updateCollapse();\r\n\r\n    function updateUi() {\r\n        if (uiState === 'left') {\r\n            BB.css(toolspace, {\r\n                left: '0',\r\n                right: '',\r\n                borderLeft: 'none',\r\n                borderRight: '1px solid rgb(135, 135, 135)'\r\n            });\r\n            BB.css(klCanvasWorkspace.getElement(), {\r\n                left: '271px'\r\n            });\r\n        } else {\r\n            BB.css(toolspace, {\r\n                left: '',\r\n                right: '0',\r\n                borderLeft: '1px solid rgb(135, 135, 135)',\r\n                borderRight: 'none'\r\n            });\r\n            BB.css(klCanvasWorkspace.getElement(), {\r\n                left: '0'\r\n            });\r\n        }\r\n        statusOverlay.setUiState(uiState);\r\n        layerPreview.setUiState('' + uiState);\r\n        layerManager.setUiState('' + uiState);\r\n        updateCollapse();\r\n    }\r\n\r\n\r\n\r\n    let overlayToolspace;\r\n    setTimeout(function() {\r\n        overlayToolspace = new KL.OverlayToolspace({\r\n            enabledTest: function() {\r\n                return !KL.dialogCounter.count && !lineSanitizer.getIsDrawing();\r\n            },\r\n            brushSettingService: brushSettingService\r\n        });\r\n        klRootEl.appendChild(overlayToolspace.getElement());\r\n    }, 0);\r\n\r\n    BB.append(klRootEl, [klCanvasWorkspace.getElement(), toolspace, toolspaceCollapser.getElement()]);\r\n\r\n    BB.css(toolspace, {\r\n        position: \"absolute\",\r\n        right: '0',\r\n        top: '0',\r\n        bottom: '0',\r\n        width: (toolWidth - 1) + \"px\",\r\n\r\n        overflow: \"hidden\",\r\n        backgroundColor: \"#ddd\",\r\n        borderLeft: \"1px solid rgb(135, 135, 135)\",\r\n        userSelect: 'none',\r\n        touchAction: 'none'\r\n    });\r\n\r\n    let toolspaceTopRow;\r\n    if (pOptions.embed) {\r\n        toolspaceTopRow = new ToolspaceTopRow({\r\n            onHelp: () => {\r\n                showIframePopup(pOptions.embed.url + '/help.html', !!pOptions.embed);\r\n            },\r\n            onSubmit: () => {\r\n                KL.popup({\r\n                    target: klRootEl,\r\n                    message: \"Submit drawing?\",\r\n                    buttons: ['Submit', 'Cancel'],\r\n                    callback: async (result) => {\r\n                        if (result !== 'Submit') {\r\n                            return;\r\n                        }\r\n\r\n                        let overlay = BB.el({\r\n                            parent: klRootEl,\r\n                            className: 'upload-overlay',\r\n                            content: '<div class=\"spinner\"></div> Submitting'\r\n                        });\r\n\r\n                        pOptions.embed.onSubmit(\r\n                            () => {\r\n                                pOptions.saveReminder.reset();\r\n                                klRootEl.removeChild(overlay);\r\n                            },\r\n                            () => {\r\n                                klRootEl.removeChild(overlay);\r\n                            });\r\n                    }\r\n                });\r\n            },\r\n            onLeftRight: () => {\r\n                uiState = uiState === 'left' ? 'right' : 'left';\r\n                updateUi();\r\n            },\r\n        });\r\n    } else {\r\n        toolspaceTopRow = new KL.ToolspaceTopRow({\r\n            logoImg: pOptions.logoImg,\r\n            onLogo: function() {\r\n                showIframePopup('./home/', !!pOptions.embed);\r\n            },\r\n            onNew: function() {\r\n                showNewImageDialog();\r\n            },\r\n            onImport: function() {\r\n                fileTab.triggerImport();\r\n            },\r\n            onSave: function() {\r\n                saveToComputer.save();\r\n            },\r\n            onShare: function() {\r\n                shareImage();\r\n            },\r\n            onHelp: function() {\r\n                showIframePopup('./help/', !!pOptions.embed);\r\n            },\r\n        });\r\n    }\r\n    BB.addClassName(toolspaceTopRow.getElement(), 'toolspace-row-shadow');\r\n    toolspaceTopRow.getElement().style.marginBottom = '10px';\r\n    toolspace.appendChild(toolspaceTopRow.getElement());\r\n\r\n    let toolspaceToolRow = new KL.ToolspaceToolRow({\r\n        onActivate: function(activeStr) {\r\n            if(activeStr === 'draw') {\r\n                klCanvasWorkspace.setMode('draw');\r\n            } else if(activeStr === 'hand') {\r\n                klCanvasWorkspace.setMode('hand');\r\n            } else if(activeStr === 'fill') {\r\n                klCanvasWorkspace.setMode('fill');\r\n            } else if(activeStr === 'text') {\r\n                klCanvasWorkspace.setMode('text');\r\n            } else if(activeStr === 'shape') {\r\n                klCanvasWorkspace.setMode('shape');\r\n            } else {\r\n                throw new Error('unknown activeStr');\r\n            }\r\n            mainTabRow.open(activeStr);\r\n            updateMainTabVisibility();\r\n            pcColorSlider.pickingDone();\r\n        },\r\n        onZoomIn: function() {\r\n            klCanvasWorkspace.zoomByStep(keyListener.isPressed('shift') ? 1/8 : 1/2);\r\n        },\r\n        onZoomOut: function() {\r\n            klCanvasWorkspace.zoomByStep(keyListener.isPressed('shift') ? -1/8 : -1/2);\r\n        },\r\n        onUndo: function() {\r\n            undoRedoCatchup.undo();\r\n        },\r\n        onRedo: function() {\r\n            undoRedoCatchup.redo();\r\n        }\r\n    });\r\n    klHistory.addListener(function() {\r\n        toolspaceToolRow.setEnableUndo(klHistory.canUndo());\r\n        toolspaceToolRow.setEnableRedo(klHistory.canRedo());\r\n    });\r\n    BB.addClassName(toolspaceToolRow.getElement(), 'toolspace-row-shadow');\r\n    toolspace.appendChild(toolspaceToolRow.getElement());\r\n\r\n    let pcColorSlider;\r\n\r\n    function setCurrentBrush(brushId) {\r\n        if (brushId !== 'eraser') {\r\n            lastNonEraserBrushId = brushId;\r\n        }\r\n\r\n        if(pcColorSlider) {\r\n            if (brushId === 'eraser') {\r\n                pcColorSlider.enable(false);\r\n            } else {\r\n                pcColorSlider.enable(true);\r\n            }\r\n        }\r\n\r\n        currentBrushId = brushId;\r\n        currentBrush = brushUiObj[brushId];\r\n        currentBrush.setColor(currentColor);\r\n        currentBrush.setContext(currentLayerCtx);\r\n        klCanvasWorkspace.setMode('draw');\r\n        toolspaceToolRow.setActive('draw');\r\n        updateMainTabVisibility();\r\n    }\r\n\r\n    function setCurrentLayer(layer) { //BrushContext(p_context) {\r\n        currentLayerCtx = layer.context;\r\n        currentBrush.setContext(layer.context);\r\n        layerPreview.setLayer(layer);\r\n    }\r\n\r\n    function setBrushColor(p_color) {\r\n        currentColor = p_color;\r\n        currentBrush.setColor(p_color);\r\n        //klCanvasWorkspace.setMode('draw')\r\n        //toolspaceToolRow.setActive('draw');\r\n        //updateMainTabVisibility();\r\n        brushSettingService.emitColor(p_color);\r\n        pcColorSlider.pickingDone();\r\n    }\r\n\r\n    setCurrentBrush('defaultBrush');\r\n\r\n    pcColorSlider = new KL.PcColorSlider({\r\n        width: 250,\r\n        height: 30,\r\n        svHeight: 100,\r\n        startValue: new BB.RGB(0, 0, 0),\r\n        onPick: setBrushColor\r\n    });\r\n    pcColorSlider.setHeight(Math.max(163, Math.min(400, uiHeight - 505)));\r\n    pcColorSlider.setPickCallback(function (doPick) {\r\n\r\n        if(doPick) {\r\n            klCanvasWorkspace.setMode('pick');\r\n        } else {\r\n            klCanvasWorkspace.setMode(toolspaceToolRow.getActive());\r\n            updateMainTabVisibility();\r\n        }\r\n\r\n    });\r\n    let brushDiv = document.createElement(\"div\");\r\n    let colorDiv = document.createElement(\"div\");\r\n    BB.css(colorDiv, {\r\n        margin: '10px',\r\n        display: 'flex',\r\n        flexWrap: 'wrap',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'flex-end'\r\n    });\r\n    let toolspaceStabilizerRow = new KL.ToolspaceStabilizerRow({\r\n        smoothing: 1,\r\n        onSelect: function(v) {\r\n            lineSmoothing.setSmoothing(translateSmoothing(v));\r\n        }\r\n    });\r\n\r\n\r\n    brushDiv.appendChild(colorDiv);\r\n    BB.append(\r\n        colorDiv,\r\n        [pcColorSlider.getElement(), pcColorSlider.getOutputElement(), toolspaceStabilizerRow.getElement()]\r\n    );\r\n\r\n    let brushTabRow = new KL.TabRow({\r\n        initialId: 'defaultBrush',\r\n        useAccent: true,\r\n        tabArr: (function () {\r\n            let result = [];\r\n            let counter = 0;\r\n\r\n            function createTab(keyStr) {\r\n                let result = {\r\n                    id: keyStr,\r\n                    image: KL.brushesUI[keyStr].image,\r\n                    title: KL.brushesUI[keyStr].tooltip,\r\n                    onOpen: function() {\r\n                        brushUiObj[keyStr].getElement().style.display = 'block';\r\n                        setCurrentBrush(keyStr);\r\n                        pcColorSlider.pickingDone();\r\n                        brushSettingService.emitSliderConfig({\r\n                            sizeSlider: KL.brushesUI[keyStr].sizeSlider,\r\n                            opacitySlider: KL.brushesUI[keyStr].opacitySlider\r\n                        });\r\n                        sizeWatcher(brushUiObj[keyStr].getSize());\r\n                        brushSettingService.emitOpacity(brushUiObj[keyStr].getOpacity());\r\n                    },\r\n                    onClose: function() {\r\n                        brushUiObj[keyStr].getElement().style.display = 'none';\r\n                    }\r\n                };\r\n                return result;\r\n            }\r\n\r\n            let keyArr = Object.keys(brushUiObj);\r\n            for(let i = 0; i < keyArr.length; i++) {\r\n                result.push(createTab(keyArr[i]));\r\n            }\r\n            return result;\r\n        })()\r\n    });\r\n    brushDiv.appendChild(brushTabRow.getElement());\r\n    for (let b in KL.brushesUI) {\r\n        if (KL.brushesUI.hasOwnProperty(b)) {\r\n            brushDiv.appendChild(brushUiObj[b].getElement());\r\n        }\r\n    }\r\n\r\n    const handUi = new KL.HandUi({\r\n        scale: 1,\r\n        angleDeg: 0,\r\n        onReset: function() {\r\n            klCanvasWorkspace.resetView(true);\r\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n        },\r\n        onFit: function() {\r\n            klCanvasWorkspace.fitView();\r\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n        },\r\n        onAngleChange: function(angleDeg, isRelative) {\r\n            klCanvasWorkspace.setAngle(angleDeg, isRelative);\r\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n        },\r\n    });\r\n\r\n    let fillUi = new KL.FillUi({\r\n        colorSlider: pcColorSlider\r\n    });\r\n\r\n    let textUi = new KL.TextUi({\r\n        colorSlider: pcColorSlider\r\n    });\r\n\r\n    let shapeUi = new KL.ShapeUi({\r\n        colorSlider: pcColorSlider\r\n    });\r\n\r\n    let shapeTool = new KL.ShapeTool({\r\n        onShape: function(isDone, x1, y1, x2, y2, angleRad) {\r\n\r\n            let layerIndex = klCanvas.getLayerIndex(currentLayerCtx.canvas);\r\n\r\n            let shapeObj: any = {\r\n                type: shapeUi.getShape(),\r\n                x1: x1,\r\n                y1: y1,\r\n                x2: x2,\r\n                y2: y2,\r\n                angleRad: angleRad,\r\n                isOutwards: shapeUi.getIsOutwards(),\r\n                opacity: shapeUi.getOpacity(),\r\n                isEraser: shapeUi.getIsEraser()\r\n            };\r\n            if (shapeUi.getShape() === 'line') {\r\n                shapeObj.strokeRgb = pcColorSlider.getColor();\r\n                shapeObj.lineWidth = shapeUi.getLineWidth();\r\n                shapeObj.isAngleSnap = shapeUi.getIsSnap() || keyListener.isPressed('shift');\r\n            } else {\r\n                shapeObj.isFixedRatio = shapeUi.getIsFixed() || keyListener.isPressed('shift');\r\n                if (shapeUi.getMode() === 'stroke') {\r\n                    shapeObj.strokeRgb = pcColorSlider.getColor();\r\n                    shapeObj.lineWidth = shapeUi.getLineWidth();\r\n                } else {\r\n                    shapeObj.fillRgb = pcColorSlider.getColor();\r\n                }\r\n            }\r\n\r\n            if (isDone) {\r\n                klCanvas.setComposite(layerIndex, null);\r\n                klCanvas.drawShape(layerIndex, shapeObj);\r\n            } else {\r\n                klCanvas.setComposite(layerIndex, {\r\n                    draw: function(ctx) {\r\n                        KL.drawShape(ctx, shapeObj);\r\n                    }\r\n                });\r\n            }\r\n            klCanvasWorkspace.requestFrame();\r\n\r\n        }\r\n    });\r\n\r\n    const layerManager = KL.pcLayerManager(klCanvas, function (val) {\r\n        setCurrentLayer(klCanvas.getLayer(val));\r\n        klHistory.add({\r\n            tool: [\"misc\"],\r\n            action: \"focusLayer\",\r\n            params: [val]\r\n        });\r\n    }, klRootEl) as any;\r\n    const layerPreview = new KL.LayerPreview({\r\n        klRootEl: klRootEl,\r\n        onClick: function () {\r\n            mainTabRow.open('layers');\r\n        }\r\n    });\r\n    layerPreview.setLayer(klCanvas.getLayer(klCanvas.getLayerIndex(currentLayerCtx.canvas)));\r\n\r\n    const filterTab = new KL.FilterTab(\r\n        klRootEl,\r\n        pcColorSlider,\r\n        layerManager,\r\n        setCurrentLayer,\r\n        klCanvasWorkspace,\r\n        handUi,\r\n        () => { //get current color\r\n            return currentColor;\r\n        },\r\n        () => { // get max canvas size\r\n            return klMaxCanvasSize;\r\n        },\r\n        () => { // get kl canvas\r\n            return klCanvas;\r\n        },\r\n        () => { // get current layer ctx\r\n            return currentLayerCtx;\r\n        },\r\n        !!pOptions.embed,\r\n        statusOverlay,\r\n    );\r\n\r\n    const undoRedoCatchup = new KL.UndoRedoCatchup(\r\n        brushUiObj,\r\n        layerPreview,\r\n        layerManager,\r\n        handUi,\r\n        klCanvasWorkspace,\r\n        () => {\r\n            return initState;\r\n        },\r\n        () => klCanvas,\r\n        () => currentLayerCtx,\r\n        (clctx) => {\r\n            currentLayerCtx = clctx;\r\n        },\r\n        () => currentBrush,\r\n    );\r\n    klHistory.addListener((p) => {\r\n        undoRedoCatchup.catchup(p);\r\n    });\r\n\r\n    function showNewImageDialog() {\r\n        KL.newImageDialog({\r\n            currentColor: currentColor,\r\n            secondaryColor: pcColorSlider.getSecondaryRGB(),\r\n            maxCanvasSize: klMaxCanvasSize,\r\n            canvasWidth: klCanvas.width,\r\n            canvasHeight: klCanvas.height,\r\n            workspaceWidth: window.innerWidth < collapseThreshold ? uiWidth : uiWidth - toolWidth,\r\n            workspaceHeight: uiHeight,\r\n            onConfirm: function(width, height, color) {\r\n                klCanvas.reset({\r\n                    width: width,\r\n                    height: height,\r\n                    color: color.a === 1 ? color : null\r\n                });\r\n\r\n                layerManager.update(0);\r\n                setCurrentLayer(klCanvas.getLayer(0));\r\n                klCanvasWorkspace.resetView();\r\n                handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n\r\n                isFirstImage = false;\r\n            },\r\n            onCancel: function() {}\r\n        });\r\n    }\r\n\r\n    function shareImage(callback?) {\r\n        BB.shareCanvas({\r\n            canvas: klCanvas.getCompleteCanvas(1),\r\n            fileName: BB.getDate() + filenameBase + '.png',\r\n            title: BB.getDate() + filenameBase + '.png',\r\n            callback: callback ? callback : function() {}\r\n        });\r\n    }\r\n\r\n    const saveToComputer = new KL.SaveToComputer(\r\n        pOptions.saveReminder,\r\n        klRootEl,\r\n        () => exportType,\r\n        () => klCanvas,\r\n        filenameBase,\r\n    );\r\n\r\n    const fileTab = pOptions.embed ? null : new KL.FileTab(\r\n        klRootEl,\r\n        projectStore,\r\n        () => klCanvas.getProject(),\r\n        exportType,\r\n        (type) => {\r\n            exportType = type;\r\n        },\r\n        handleFileSelect,\r\n        () => {\r\n            saveToComputer.save();\r\n        },\r\n        showNewImageDialog,\r\n        shareImage,\r\n        () => { // on upload\r\n            KL.imgurUpload(klCanvas, klRootEl, pOptions.saveReminder, pOptions.app && pOptions.app.imgurKey ? pOptions.app.imgurKey : null, );\r\n        },\r\n        copyToClipboard,\r\n        pOptions.saveReminder,\r\n    );\r\n\r\n    mainTabRow = new KL.TabRow({\r\n        initialId: 'draw',\r\n        tabArr: [\r\n            {\r\n                id: 'draw',\r\n                label: 'Brush',\r\n                onOpen: function() {\r\n                    if (currentBrushId === 'eraser') {\r\n                        pcColorSlider.enable(false);\r\n                    }\r\n                    BB.append(\r\n                        colorDiv,\r\n                        [pcColorSlider.getElement(), pcColorSlider.getOutputElement(), toolspaceStabilizerRow.getElement()]\r\n                    );\r\n                    brushDiv.style.display = 'block';\r\n                },\r\n                onClose: function() {\r\n                    brushDiv.style.display = 'none';\r\n                }\r\n            },\r\n            {\r\n                id: 'hand',\r\n                label: 'Hand',\r\n                isVisible: false,\r\n                onOpen: function() {\r\n                    handUi.setIsVisible(true);\r\n                },\r\n                onClose: function() {\r\n                    handUi.setIsVisible(false);\r\n                }\r\n            },\r\n            {\r\n                id: 'fill',\r\n                label: 'Fill',\r\n                isVisible: false,\r\n                onOpen: function() {\r\n                    pcColorSlider.enable(true);\r\n                    fillUi.setIsVisible(true);\r\n                },\r\n                onClose: function() {\r\n                    fillUi.setIsVisible(false);\r\n                }\r\n            },\r\n            {\r\n                id: 'text',\r\n                label: 'Text',\r\n                isVisible: false,\r\n                onOpen: function() {\r\n                    pcColorSlider.enable(true);\r\n                    textUi.setIsVisible(true);\r\n                },\r\n                onClose: function() {\r\n                    textUi.setIsVisible(false);\r\n                }\r\n            },\r\n            {\r\n                id: 'shape',\r\n                label: 'Shape',\r\n                isVisible: false,\r\n                onOpen: function() {\r\n                    pcColorSlider.enable(true);\r\n                    shapeUi.setIsVisible(true);\r\n                },\r\n                onClose: function() {\r\n                    shapeUi.setIsVisible(false);\r\n                }\r\n            },\r\n            {\r\n                id: 'layers',\r\n                label: 'Layers',\r\n                onOpen: function() {\r\n                    layerManager.update();\r\n                    layerManager.style.display = 'block';\r\n                },\r\n                onClose: function() {\r\n                    layerManager.style.display = 'none';\r\n                }\r\n            },\r\n            {\r\n                id: 'edit',\r\n                label: 'Edit',\r\n                onOpen: function() {\r\n                    filterTab.show();\r\n                },\r\n                onClose: function() {\r\n                    filterTab.hide();\r\n                }\r\n            },\r\n            {\r\n                id: 'file',\r\n                label: 'File',\r\n                isVisible: !!fileTab,\r\n                onOpen: function() {\r\n                    if (!fileTab) {\r\n                        return;\r\n                    }\r\n                    fileTab.getElement().style.display = 'block';\r\n                    fileTab.setIsVisible(true);\r\n                },\r\n                onClose: function() {\r\n                    if (!fileTab) {\r\n                        return;\r\n                    }\r\n                    fileTab.getElement().style.display = 'none';\r\n                    fileTab.setIsVisible(false);\r\n                }\r\n            }\r\n        ]\r\n    });\r\n    function updateMainTabVisibility() {\r\n        if(!mainTabRow) {\r\n            return;\r\n        }\r\n\r\n        let toolObj = {\r\n            'draw': {},\r\n            'hand': {},\r\n            'fill': {},\r\n            'text': {},\r\n            'shape': {}\r\n        };\r\n\r\n        let activeStr = toolspaceToolRow.getActive();\r\n        let oldTabId = mainTabRow.getOpenedTabId();\r\n\r\n        let keysArr = Object.keys(toolObj);\r\n        for (let i = 0; i < keysArr.length; i++) {\r\n            if (activeStr === keysArr[i]) {\r\n                mainTabRow.setIsVisible(keysArr[i], true);\r\n            } else {\r\n                mainTabRow.setIsVisible(keysArr[i], false);\r\n                if (oldTabId === keysArr[i]) {\r\n                    mainTabRow.open(activeStr);\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    function copyToClipboard(showCrop?) {\r\n        KL.clipboardDialog(klRootEl, klCanvas.getCompleteCanvas(1), function (inputObj) {\r\n            if (inputObj.left === 0 && inputObj.right === 0 && inputObj.top === 0 && inputObj.bottom === 0) {\r\n                return;\r\n            }\r\n            //do a crop\r\n            let p = {\r\n                context: currentLayerCtx,\r\n                canvas: klCanvas,\r\n                input: inputObj, //{left,right,top,bottom}\r\n                history: klHistory\r\n            };\r\n            KL.filterLib.cropExtend.apply(p);\r\n            layerManager.update();\r\n            klCanvasWorkspace.resetView();\r\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\r\n        }, statusOverlay, showCrop);\r\n    }\r\n\r\n    const bottomBarWrapper = BB.el({\r\n        css: {\r\n            width: \"270px\",\r\n            position: \"absolute\",\r\n            bottom: '0',\r\n            left: '0'\r\n        },\r\n    });\r\n    if (pOptions.bottomBar) {\r\n        bottomBarWrapper.append(pOptions.bottomBar);\r\n    } else {\r\n        BB.el({\r\n            parent: bottomBarWrapper,\r\n            content: 'powered by Klecks - <a href=\"https://kleki.com/donate\" target=\"_blank\">Donate</a>',\r\n            css: {\r\n                width: '100%',\r\n                textAlign: 'center',\r\n                paddingBottom: '3px',\r\n            }\r\n        });\r\n    }\r\n\r\n    BB.append(toolspace, [\r\n        layerPreview.getElement(),\r\n        mainTabRow.getElement(),\r\n        brushDiv,\r\n        handUi.getElement(),\r\n        fillUi.getElement(),\r\n        textUi.getElement(),\r\n        shapeUi.getElement(),\r\n        layerManager,\r\n        filterTab.getElement(),\r\n        fileTab ? fileTab.getElement() : null,\r\n        bottomBarWrapper ? bottomBarWrapper : null\r\n    ]);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.getEl = () => {\r\n        return klRootEl;\r\n    };\r\n\r\n    this.resize = (w, h) => {\r\n        uiWidth = Math.max(0, w);\r\n        uiHeight = Math.max(0, h);\r\n\r\n        updateCollapse();\r\n\r\n        if (bottomBarWrapper) {\r\n            let threshold = 617; //590\r\n            bottomBarWrapper.style.display = uiHeight >= threshold ? '' : 'none';\r\n        }\r\n        layerPreview.setIsVisible(uiHeight >= 579);\r\n        pcColorSlider.setHeight(Math.max(163, Math.min(400, uiHeight - 505)));\r\n        toolspaceToolRow.setIsSmall(uiHeight < 540);\r\n    };\r\n\r\n    this.out = (msg) => {\r\n        statusOverlay.out(msg);\r\n    };\r\n\r\n    this.getPNG = function(): Blob {\r\n        return base64ToBlob(klCanvas.getCompleteCanvas(1).toDataURL('image/png'));\r\n    };\r\n\r\n    this.getPSD = async function() {\r\n        return await klCanvasToPsdBlob(klCanvas);\r\n    };\r\n\r\n    this.swapUiLeftRight = () => {\r\n        uiState = uiState === 'left' ? 'right' : 'left';\r\n        if (!pOptions.embed) {\r\n            localStorage.setItem('uiState', uiState);\r\n        }\r\n        updateUi();\r\n    };\r\n\r\n    // --- end interface ---\r\n\r\n    this.resize(uiWidth, uiHeight);\r\n    updateUi();\r\n\r\n    {\r\n        BB.addEventListener(window, 'resize', () => {\r\n            this.resize(window.innerWidth, window.innerHeight);\r\n        });\r\n        BB.addEventListener(window, 'orientationchange', () => {\r\n            this.resize(window.innerWidth, window.innerHeight);\r\n        });\r\n        // prevent ctrl scroll -> zooming page\r\n        BB.addEventListener(this.getEl(), 'wheel', (event) => {\r\n            event.preventDefault();\r\n        });\r\n        //maybe prevent zooming on safari mac os - I can't test it\r\n        const prevent = (e) => {\r\n            e.preventDefault();\r\n        }\r\n        window.addEventListener('gesturestart', prevent);\r\n        window.addEventListener('gesturechange', prevent);\r\n        window.addEventListener('gestureend', prevent);\r\n    }\r\n}","import {klHistory} from './history/kl-history';\r\nimport {Popup, popup} from './ui/modals/popup';\r\nimport {dialogCounter} from './ui/modals/modal-count';\r\nimport {Checkbox} from './ui/base-components/checkbox';\r\nimport {input} from './ui/base-components/input';\r\nimport {Select} from './ui/base-components/select';\r\nimport {ImageToggle} from './ui/base-components/image-toggle';\r\nimport {ImageRadioList} from './ui/base-components/image-radio-list';\r\nimport {penPressureToggle} from './ui/base-components/pen-pressure-toggle';\r\nimport {PcSlider} from './ui/base-components/slider';\r\nimport {calcSliderFalloffFactor} from './ui/base-components/slider-falloff';\r\nimport {HexColorDialog} from './ui/modals/color-slider-hex-dialog';\r\nimport {PcColorSlider} from './ui/base-components/color-slider';\r\nimport {PcSmallColorSlider} from './ui/base-components/color-slider-small';\r\nimport {PointSlider} from './ui/base-components/point-slider';\r\nimport {ColorOptions} from './ui/base-components/color-options';\r\nimport {Options} from './ui/base-components/options';\r\nimport {StatusOverlay} from './ui/components/status-overlay';\r\nimport {exportDialog} from './ui/modals/export-dialog-deprecated';\r\nimport {CropCopy} from './ui/components/crop-copy';\r\nimport {clipboardDialog} from './ui/modals/clipboard-dialog';\r\nimport {TabMenu} from './ui/components/tab-menu-deprecated';\r\nimport {pcLayerManager} from './ui/components/layer-manager';\r\nimport {WorkspaceSvgOverlay} from './canvas-ui/workspace-svg-overlay';\r\nimport {KlCanvasWorkspace} from './canvas-ui/canvas-workspace';\r\nimport {KlCanvasPreview} from './canvas-ui/canvas-preview';\r\nimport {FreeTransform} from './ui/components/free-transform';\r\nimport {FreeTransformCanvas} from './ui/components/free-transform-canvas';\r\nimport {Cropper} from './ui/components/cropper';\r\nimport {ProgressPopup} from './ui/modals/progress-popup';\r\nimport {LayerPreview} from './ui/components/layer-preview';\r\nimport {showSaveReminderToast} from './ui/components/show-reminder-toast';\r\nimport {FittedImage} from './ui/components/fitted-image';\r\nimport {showImportAsLayerDialog} from './ui/modals/show-import-as-layer-dialog';\r\nimport {PcImageDropper} from './ui/components/image-dropper';\r\nimport {OverlayToolspace} from './ui/components/overlay-toolspace';\r\nimport {ToolspaceTopRow} from './ui/components/toolspace-top-row';\r\nimport {ToolDropdown} from './ui/components/tool-dropdown';\r\nimport {ToolspaceToolRow} from './ui/components/toolspace-tool-row';\r\nimport {ToolspaceStabilizerRow} from './ui/components/toolspace-stabilizer-row';\r\nimport {TabRow} from './ui/components/tab-row';\r\nimport {HandUi} from './ui/tool-tabs/hand-ui';\r\nimport {FillUi} from './ui/tool-tabs/fill-ui';\r\nimport {TextUi} from './ui/tool-tabs/text-ui';\r\nimport {ShapeUi} from './ui/tool-tabs/shape-ui';\r\nimport {newImageDialog} from './ui/modals/new-image-dialog';\r\nimport {ToolspaceCollapser} from './ui/components/toolspace-collapser';\r\nimport {renderText} from './image-operations/render-text';\r\nimport {textToolDialog} from './ui/modals/text-tool-dialog';\r\nimport {showImportImageDialog} from './ui/modals/show-import-image-dialog';\r\nimport {floodFillBits} from './image-operations/flood-fill';\r\nimport * as PSD from './storage/psd';\r\nimport {drawShape, ShapeTool} from './image-operations/shape-tool';\r\nimport {KlCanvas} from './canvas/kl-canvas';\r\nimport * as indexedDb from './storage/indexed-db';\r\nimport {filterLib, filterLibStatus} from './filters/filters';\r\nimport {brushes} from './brushes/brushes';\r\nimport {brushesUI} from './brushes-ui/brushes-ui';\r\nimport {showIframePopup} from './ui/modals/show-iframe-popup';\r\nimport {RadioList} from './ui/base-components/radio-list';\r\nimport {BrowserStorageUi} from './ui/components/browser-storage-ui';\r\nimport {drawProject} from './canvas/draw-project';\r\nimport {ProjectStore} from './storage/project-store';\r\nimport {FileTab} from \"./ui/tool-tabs/file-tab\";\r\nimport {FilterTab} from \"./ui/tool-tabs/filter-tab\";\r\nimport {imgurUpload} from \"./ui/components/imgur-upload\";\r\nimport {loadAgPsd} from \"./storage/ag-psd-wrapper\";\r\nimport {SaveReminder} from \"./ui/components/save-reminder\";\r\nimport {SaveToComputer} from \"./storage/save-to-computer\";\r\nimport {UndoRedoCatchup} from \"./history/undo-redo-catchup\";\r\nimport {setDbName} from './storage/indexed-db';\r\n\r\n/**\r\n * paint tool functionality\r\n */\r\nexport const KL = {\r\n\r\n    // --- brushes ---\r\n    brushes,\r\n    brushesUI,\r\n\r\n    // --- canvas ---\r\n    KlCanvas,\r\n    drawProject,\r\n\r\n    // --- canvas ui ---\r\n    WorkspaceSvgOverlay,\r\n    KlCanvasWorkspace,\r\n    KlCanvasPreview,\r\n\r\n    // --- filters ---\r\n    filterLibStatus,\r\n    filterLib,\r\n\r\n    // --- history ---\r\n    UndoRedoCatchup,\r\n\r\n    // --- image operations ---\r\n    renderText,\r\n    floodFillBits,\r\n    ShapeTool,\r\n    drawShape,\r\n\r\n    // --- storage ---\r\n    PSD,\r\n    setDbName,\r\n    indexedDb,\r\n    ProjectStore,\r\n    loadAgPsd,\r\n    SaveToComputer,\r\n\r\n    // --- ui - base components ---\r\n    calcSliderFalloffFactor,\r\n    CheckBox: Checkbox,\r\n    input,\r\n    Select,\r\n    ImageToggle,\r\n    ImageRadioList,\r\n    RadioList,\r\n    penPressureToggle,\r\n    PcSlider,\r\n    HexColorDialog,\r\n    PcColorSlider,\r\n    PcSmallColorSlider,\r\n    PointSlider,\r\n    ColorOptions,\r\n    Options,\r\n\r\n    // --- ui - components ---\r\n    StatusOverlay,\r\n    CropCopy,\r\n    TabMenu,\r\n    pcLayerManager,\r\n    FreeTransform,\r\n    FreeTransformCanvas,\r\n    Cropper,\r\n    LayerPreview,\r\n    showSaveReminderToast,\r\n    FittedImage,\r\n    PcImageDropper,\r\n    OverlayToolspace,\r\n    ToolspaceTopRow,\r\n    ToolDropdown,\r\n    ToolspaceToolRow,\r\n    ToolspaceStabilizerRow,\r\n    TabRow,\r\n    ToolspaceCollapser,\r\n    BrowserStorageUi,\r\n    imgurUpload,\r\n    SaveReminder,\r\n\r\n    // --- ui - modals ---\r\n    dialogCounter,\r\n    popup,\r\n    Popup,\r\n    exportDialog,\r\n    clipboardDialog,\r\n    ProgressPopup,\r\n    showImportAsLayerDialog,\r\n    newImageDialog,\r\n    textToolDialog,\r\n    showImportImageDialog,\r\n    showIframePopup,\r\n\r\n    // --- ui - tool tabs ---\r\n    HandUi,\r\n    FillUi,\r\n    TextUi,\r\n    ShapeUi,\r\n    FileTab,\r\n    FilterTab,\r\n\r\n\r\n    klHistory,\r\n};","\r\n\r\nexport const klHistory = (function () {\r\n    let clearCount = 0;\r\n    let state = 0; //a number incrementing up with every clear, add, undo, redo\r\n    const hInterface: any = {};\r\n    let dataArr = [];\r\n    const listeners = [];\r\n    let pauseStack = 0;\r\n    const max = 14; //max amount of undo steps\r\n    let maxState = -1; //can't go backwards -> max state is the buffer image(klCanvas)\r\n\r\n    let currentIndex = -1; // current action the user is on. untouched document = -1 because dataArr.length is 0\r\n\r\n    hInterface.clear = function () {\r\n        dataArr = [];\r\n        pauseStack = 0;\r\n        currentIndex = -1;\r\n        maxState = -1;\r\n        clearCount++;\r\n        broadcast();\r\n    };\r\n    //you need pause because there are sometimes actions that would cause other\r\n    // undo steps\r\n    // for example a filter that does something crazy with two layers and then merges them\r\n    // you want that to be one undo step, and prevent merging from causing its undo step.\r\n    // so while that filter is doing its magic you should pause possible undo steps that\r\n    // that are caused by a part of its code(in this example: merging layers)\r\n    hInterface.pause = function (b) {\r\n        if (b === false) {\r\n            pauseStack = Math.max(0, pauseStack - 1);\r\n        } else {\r\n            pauseStack++;\r\n        }\r\n    };\r\n\r\n    hInterface.addListener = function (l) {\r\n        listeners.push(l);\r\n    };\r\n\r\n    function broadcast(p?) {\r\n        setTimeout(function () {\r\n            for (let i = 0; i < listeners.length; i++) {\r\n                listeners[i](p);\r\n            }\r\n            state++;\r\n        }, 1);\r\n    }\r\n\r\n    hInterface.add = function (e) {\r\n        if (pauseStack > 0) {\r\n            return;\r\n        }\r\n        while (currentIndex < dataArr.length - 1) {\r\n            dataArr.pop();\r\n        }\r\n\r\n        //taking care of actions that shouldn't cause a new undo step\r\n        const top = dataArr[dataArr.length - 1];\r\n        if (e.action === 'layerOpacity' && top && top.action === 'layerOpacity' && top.params[0] === e.params[0]) {\r\n            dataArr[dataArr.length - 1] = e;\r\n            state++; //still needs to increment because something changed\r\n            return;\r\n        }\r\n        if (e.action === 'focusLayer' && top && top.action === 'focusLayer') {\r\n            dataArr[dataArr.length - 1] = e;\r\n            state++;\r\n            return;\r\n        }\r\n\r\n\r\n        dataArr[dataArr.length] = e;\r\n        currentIndex = dataArr.length - 1;\r\n        const maxBefore = maxState;\r\n        maxState = Math.max(maxState, currentIndex - max);\r\n        if (maxBefore < maxState) {\r\n            broadcast({bufferUpdate: dataArr[maxState]});\r\n        } else {\r\n            broadcast();\r\n        }\r\n        dataArr[maxState] = {}; //to free some memory...imported images take a lot of space\r\n    };\r\n    hInterface.undo = function () {\r\n        let result;\r\n        if (hInterface.canUndo()) {\r\n            result = [];\r\n            for (let i = maxState + 1; i < currentIndex; i++) {\r\n                result.push(dataArr[i]);\r\n            }\r\n            currentIndex--;\r\n            broadcast();\r\n        }\r\n\r\n        return result;\r\n    };\r\n    hInterface.redo = function () {\r\n        const result = [];\r\n        if (hInterface.canRedo()) {\r\n            currentIndex++;\r\n            result.push(dataArr[currentIndex]);\r\n            broadcast();\r\n        }\r\n        return result;\r\n    };\r\n    hInterface.getAll = function () {\r\n        const result = [];\r\n        for (let i = 0; i < dataArr.length; i++) {\r\n            result[i] = dataArr[i];\r\n        }\r\n        return result;\r\n    };\r\n    hInterface.canRedo = function () {\r\n        return currentIndex < dataArr.length - 1;\r\n    };\r\n    hInterface.canUndo = function () {\r\n        return currentIndex > maxState;\r\n    };\r\n    hInterface.getState = function () {\r\n        return parseInt('' + state, 10);\r\n    };\r\n\r\n    /**\r\n     * clearCount - how often clear was called\r\n     * actionNumber - number of undo-able actions a user has done (e.g. if drawn 5 lines total -> 5)\r\n     * @returns [clearCount int, actionNumber int]\r\n     */\r\n    hInterface.getActionNumber = function() {\r\n        return [clearCount, currentIndex + 1];\r\n    };\r\n    return hInterface;\r\n})();\r\n","import {dialogCounter} from './modal-count';\r\nimport {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport checkImg from 'url:~/src/app/img/ui/check.svg';\r\n// @ts-ignore\r\nimport cancelImg from 'url:~/src/app/img/ui/cancel.svg';\r\n\r\n/**\r\n *\r\n * params:\r\n * {\r\n *      target: DOM Element\r\n *      div: node with content\r\n *      message:\r\n *      callback?:\r\n *      buttons: [string, ...]\r\n *      primaries: [string, ...]\r\n *      type:\r\n *      closefunc:\r\n *      style:\r\n *      clickOnEnter: string //name of button\r\n *      autoFocus: string //name of button - default 'Ok' || 'Yes' || 'Upload' - false -> none\r\n * }\r\n *\r\n * @param params\r\n */\r\nexport const popup = function (params) {\r\n    dialogCounter.count++;\r\n\r\n    const target = params.target;\r\n    const callback = params.callback ? params.callback : () => {};\r\n    const buttons = params.buttons;\r\n    const type = params.type;\r\n    const div = document.createElement('div');\r\n    div.className = 'g-root';\r\n    div.id = 'popup';\r\n    div.style.cursor = 'default';\r\n    let destructed = false;\r\n    BB.css(div, {\r\n        width: '100%',\r\n        height: '100%',\r\n        position: 'absolute',\r\n        left: '0',\r\n        top: '0'\r\n    });\r\n    div.onclick = BB.handleClick;\r\n    // prevent ctrl scroll -> zooming page\r\n    const wheelPrevent = (event) => {\r\n        event.preventDefault();\r\n    }\r\n    BB.addEventListener(div, 'wheel', wheelPrevent);\r\n\r\n    let autoFocusArr = [];\r\n    if(params.autoFocus) {\r\n        autoFocusArr = [params.autoFocus];\r\n    } else if(params.autoFocus === false) {\r\n        autoFocusArr = [];\r\n    } else {\r\n        autoFocusArr = ['Ok', 'Yes', 'Upload'];\r\n    }\r\n\r\n    //for closing dialog when clicking outside of it\r\n    const closingLayer = document.createElement('div');\r\n    BB.css(closingLayer, {\r\n        width: '100%',\r\n        height: '100%',\r\n        position: 'fixed',\r\n        left: '0',\r\n        top: '0'\r\n    });\r\n    div.appendChild(closingLayer);\r\n\r\n    const cell = document.createElement('div');\r\n    cell.id = 'cell';\r\n    div.appendChild(cell);\r\n    const content = document.createElement('div');\r\n    content.style.position = 'relative';\r\n    content.className = 'popup-content';\r\n\r\n    function closePopup(result) {\r\n        if(destructed) {\r\n            return;\r\n        }\r\n        dialogCounter.count--;\r\n        BB.clearSelection();\r\n        target.removeChild(div);\r\n        callback(result);\r\n        keyListener.destroy();\r\n        BB.removeEventListener(closingLayer, 'click', onClosingLayerClick);\r\n        document.body.style.overflow = '';\r\n\r\n        xButton.onclick = null;\r\n        buttonArr.forEach(item => {\r\n            item.onclick = null;\r\n        });\r\n        buttonArr.splice(0, buttonArr.length);\r\n        BB.removeEventListener(div, 'wheel', wheelPrevent);\r\n        div.onclick = null;\r\n\r\n        destructed = true;\r\n    }\r\n\r\n    function onClosingLayerClick() {\r\n        closePopup('Cancel');\r\n    }\r\n    BB.addEventListener(closingLayer, 'click', onClosingLayerClick);\r\n\r\n\r\n    const xButton = document.createElement('div');\r\n    xButton.className = 'dialog-closebtn';\r\n    if (navigator.appName === 'Microsoft Internet Explorer') {\r\n        xButton.textContent = 'X';\r\n    } else {\r\n        xButton.textContent = '╳';\r\n    }\r\n    xButton.title = 'Close';\r\n    xButton.onclick = function () {\r\n        closePopup('Cancel');\r\n    };\r\n    content.appendChild(xButton);\r\n\r\n\r\n    cell.appendChild(content);\r\n    target.appendChild(div);\r\n    const message = document.createElement('div');\r\n    content.appendChild(message);\r\n    if (params.div) {\r\n        content.appendChild(params.div);\r\n        if(params.buttons) {\r\n            params.div.style.marginBottom = '20px';\r\n        }\r\n    }\r\n    if (!params.message) {\r\n    } else if (typeof params.message === 'string') {\r\n        message.innerHTML = params.message;\r\n    } else {\r\n        message.appendChild(params.message);\r\n    }\r\n    message.style.marginRight = '15px';\r\n    message.style.marginBottom = '10px';\r\n    const buttonWrapper = document.createElement('div');\r\n    buttonWrapper.style.textAlign = 'right';\r\n    let clickOnEnterButton = null;\r\n    const buttonArr = [];\r\n    const addbutton = function (label, i) {\r\n        const button = document.createElement('button');\r\n        //button.style.cssFloat = \"right\";\r\n        button.style.minWidth = '80px';\r\n        button.style.display = 'inline-block';\r\n        button.style.marginLeft = '8px';\r\n\r\n        if (label === 'Ok' || (params.primaries && params.primaries.includes(label))) {\r\n            button.className = 'kl-button-primary';\r\n        }\r\n        if (label === 'Ok') {\r\n            button.innerHTML = '<img height=\"17\" src=\"' + checkImg + '\"/>' + label;\r\n        } else if (label === 'Cancel') {\r\n            button.innerHTML = '<img height=\"17\" src=\"' + cancelImg + '\"/>' + label;\r\n        } else {\r\n            button.innerHTML = label;\r\n        }\r\n        buttonWrapper.appendChild(button);\r\n        //button.tabIndex = i + 1000;\r\n        button.onclick = function () {\r\n            closePopup(label);\r\n        };\r\n\r\n        if(autoFocusArr.includes(label)) {\r\n            setTimeout(function () {\r\n                button.focus();\r\n            }, 10);\r\n        }\r\n\r\n        if(label === params.clickOnEnter) {\r\n            clickOnEnterButton = button;\r\n        }\r\n\r\n        buttonArr.push(button);\r\n    };\r\n    /*for (let i = params.buttons.length - 1; i >= 0; i--) {\r\n        addbutton(params.buttons[i], i);\r\n    }*/\r\n    if(params.buttons) {\r\n        for (let i = 0; i < params.buttons.length; i++) {\r\n            addbutton(params.buttons[i], i);\r\n        }\r\n        content.appendChild(buttonWrapper);\r\n    }\r\n\r\n    content.appendChild(BB.el({\r\n        css: {\r\n            clear: 'both'\r\n        }\r\n    }));\r\n\r\n    const keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, e, comboStr) {\r\n            if (destructed) {\r\n                return;\r\n            }\r\n            if(clickOnEnterButton !== null && comboStr === 'enter' && !BB.isInputFocused()) {\r\n                e.stopPropagation();\r\n                setTimeout(function() {\r\n                    clickOnEnterButton.click();\r\n                }, 10);\r\n            }\r\n            if (comboStr === 'esc') {\r\n                e.stopPropagation();\r\n                closePopup('Cancel');\r\n            }\r\n        }\r\n    });\r\n\r\n    if (type === 'error') {\r\n        BB.addClassName(content, 'poperror');\r\n    }\r\n    if (type === 'ok') {\r\n        BB.addClassName(content, 'popok');\r\n    }\r\n    if (type === 'warning') {\r\n        BB.addClassName(content, 'popwarning');\r\n    }\r\n    if (type === 'upload') {\r\n        BB.addClassName(content, 'popupload');\r\n    }\r\n    if (type === 'trash') {\r\n        BB.addClassName(content, 'poptrash');\r\n    }\r\n    if (!type) {\r\n        BB.addClassName(content, 'popdefault');\r\n    }\r\n    if (params.style) {\r\n        BB.css(content, params.style);\r\n    }\r\n    /*content.onclick = function() {\r\n    target.removeChild(div);\r\n}*/\r\n    if (params.closefunc) {\r\n        params.closefunc(function () {\r\n            closePopup('Cancel');\r\n        });\r\n    }\r\n\r\n};\r\n\r\n\r\n/**\r\n * popups that fill whole height, with some padding.\r\n * currently only used for iframe popups.\r\n *\r\n * p = {\r\n *      title: DOM Element | string, // optional (todo allow string)\r\n *      icon: 'ok', // optional todo\r\n *      content: DOM Element, // optional\r\n *      buttonArr: [ // optional todo\r\n *          'Ok',\r\n *          'Cancel'\r\n *      ],\r\n *      autoFocus: string | false, //todo\r\n *      clickOnEnter: string, //todo\r\n *      onClose: function(result: string), // optional (todo result)\r\n *\r\n *      //size and position\r\n *      width: 500,\r\n *      isMaxHeight: boolean //todo, currently always true\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const Popup = function(p) {\r\n    dialogCounter.count++;\r\n    const parent = document.body;\r\n    const div = BB.el({\r\n        parent: parent,\r\n        className: 'g-root',\r\n        css: {\r\n            position: 'fixed',\r\n            left: '0',\r\n            top: '0',\r\n            bottom: '0',\r\n            right: '0',\r\n            background: 'rgba(0, 0, 0, 0.45)',\r\n            overflow: 'auto',\r\n            animationName: 'consoleIn',\r\n            animationDuration: '0.3s',\r\n            animationTimingFunction: 'ease-out'\r\n        }\r\n    });\r\n    div.onclick = BB.handleClick;\r\n\r\n    let updateInterval;\r\n\r\n    function close() {\r\n        dialogCounter.count--;\r\n        div.onclick = null;\r\n        parent.removeChild(div);\r\n        clearInterval(updateInterval);\r\n        window.removeEventListener('resize', updatePos);\r\n        keyListener.destroy();\r\n        BB.destroyEl(xButton);\r\n        BB.destroyEl(bgEl);\r\n        if(p.onClose) {\r\n            p.onClose();\r\n        }\r\n    }\r\n\r\n    //background element registering clicks\r\n    const bgEl = BB.el({\r\n        parent: div,\r\n        css: {\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0',\r\n            bottom: '0',\r\n            right: '0'\r\n        },\r\n        onClick: close\r\n    });\r\n\r\n    //the actual popup box\r\n    const popupEl = BB.el({\r\n        parent: div,\r\n        css: {\r\n            position: 'absolute',\r\n            width: (BB.isCssMinMaxSupported() ?\r\n                'min(calc(100% - 40px), ' + (p.width ? p.width : 400) + 'px)' :\r\n                (p.width ? p.width : 400) + 'px'),\r\n            height: 'calc(100% - 40px)',\r\n            background: '#eee',\r\n            borderRadius: '10px',\r\n            overflow: 'hidden',\r\n            boxShadow: 'rgba(0, 0, 0, 0.25) 0px 5px 60px'\r\n        }\r\n    });\r\n\r\n    //x and y position via script. flex not powerful enough imo\r\n    function updatePos() {\r\n        const elW = popupEl.offsetWidth;\r\n        const elH = popupEl.offsetHeight;\r\n\r\n        BB.css(popupEl, {\r\n            left: Math.max(0, (window.innerWidth - elW) / 2) + 'px',\r\n            top: Math.max(20, (window.innerHeight - elH) / 2 - (elH * 0.20)) + 'px'\r\n        });\r\n    }\r\n    //todo also update when popup changes size - resizeobserver and fallback\r\n    //updateInterval = setInterval(updatePos, 100);\r\n    updatePos();\r\n    window.addEventListener('resize', updatePos);\r\n\r\n    //title row in popup\r\n    const titleHeight = 40;\r\n    const titleEl = BB.el({\r\n        parent: popupEl,\r\n        css: {\r\n            height: titleHeight + 'px',\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            paddingLeft: (titleHeight / 2) + 'px'\r\n        }\r\n    });\r\n    if(p.title) {\r\n        titleEl.appendChild(p.title);\r\n    }\r\n    const xButton = BB.el({\r\n        parent: titleEl,\r\n        className: 'popup-x',\r\n        content: '╳',\r\n        title: 'Close',\r\n        onClick: close,\r\n        css: {\r\n            width: titleHeight + 'px',\r\n            height: titleHeight + 'px',\r\n            lineHeight: titleHeight + 'px'\r\n        }\r\n    });\r\n\r\n    const contentEl = BB.el({\r\n        parent: popupEl,\r\n        css: {\r\n            height: 'calc(100% - ' + titleHeight + 'px)'\r\n        }\r\n    });\r\n    if(p.content) {\r\n        contentEl.appendChild(p.content);\r\n    }\r\n\r\n    const keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, e) {\r\n            if (keyStr === 'esc') {\r\n                e.stopPropagation();\r\n                close();\r\n            }\r\n        }\r\n    });\r\n\r\n\r\n    // --- interface ---\r\n    this.close = function() {\r\n        close();\r\n    };\r\n};","\r\n// not the best\r\n\r\n/**\r\n * how many modals are open\r\n */\r\n\r\nexport class DialogCounter {\r\n    count = 0;\r\n}\r\n\r\nexport const dialogCounter = new DialogCounter();\r\n","import * as BBEventListener from './input/event-listener';\r\nimport {\r\n    addClassName, append, centerWithin, copyObj, createSvg,\r\n    css, dateDayDifference, decToFraction,\r\n    fitInto, gcd, getDate,\r\n    getPageOffset, handleClick, imageBlobToUrl,\r\n    insertAfter, loadImage,\r\n    reduce,\r\n    removeClassName, setAttributes, shareCanvas\r\n} from './base/base';\r\nimport {\r\n    canShareFiles,\r\n    eventUsesHighResTimeStamp,\r\n    getVisitor,\r\n    hasPointerEvents,\r\n    hasWebGl,\r\n    isCssMinMaxSupported,\r\n    mouseEventHasMovement\r\n} from './base/browser';\r\nimport {KeyListener} from './input/key-listener';\r\nimport {PointerListener} from './input/pointer-listener';\r\nimport * as EventChain from './input/event-chain';\r\nimport {\r\n    convertToAlphaChannelCanvas,\r\n    copyCanvas,\r\n    createCheckerCanvas, createCheckerDataUrl,\r\n    drawTransformedImageOnCanvas,\r\n    drawTransformedImageWithBounds, resizeCanvas, testShouldPixelate\r\n} from './base/canvas';\r\nimport {Matrix} from './math/matrix';\r\nimport {Vec2} from './math/vec2';\r\nimport {BezierLine, PointLine, projectPointOnLine, quadraticSplineInput, SplineInterpolator} from './math/line';\r\nimport {CMYK, ColorConverter, HSV, RGB, testIsWhiteBestContrast} from './color/color';\r\nimport {appendTextDiv, clearSelection, destroyEl, el, isInputFocused, makeUnfocusable} from './base/ui';\r\nimport {\r\n    pointsToAngleDeg,\r\n    clamp,\r\n    dist,\r\n    mix,\r\n    pointsToAngleRad,\r\n    rotate,\r\n    rotateAround,\r\n    intDxy,\r\n    roundEven, roundUneven, distSquared, lenSquared, updateBounds\r\n} from './math/math';\r\nimport {createCanvas} from './base/create-canvas';\r\nimport {BbLog} from './base/bb-log';\r\n\r\nexport const BB = {\r\n\r\n    // ---- browser ----\r\n    eventUsesHighResTimeStamp,\r\n    mouseEventHasMovement,\r\n    hasPointerEvents,\r\n    hasWebGl,\r\n    getVisitor,\r\n    isCssMinMaxSupported,\r\n    canShareFiles,\r\n\r\n    // ---- base ----\r\n    getPageOffset,\r\n    insertAfter,\r\n    loadImage,\r\n    css,\r\n    setAttributes,\r\n    addClassName,\r\n    removeClassName,\r\n    append,\r\n    fitInto,\r\n    centerWithin,\r\n    getDate,\r\n    gcd,\r\n    reduce,\r\n    decToFraction,\r\n    imageBlobToUrl,\r\n    dateDayDifference,\r\n    copyObj,\r\n    shareCanvas,\r\n    handleClick,\r\n    createSvg,\r\n    BbLog,\r\n\r\n    // ---- math ----\r\n    mix,\r\n    dist,\r\n    distSquared,\r\n    lenSquared,\r\n    pointsToAngleRad,\r\n    pointsToAngleDeg,\r\n    clamp,\r\n    rotate,\r\n    rotateAround,\r\n    Matrix,\r\n    Vec2,\r\n    intDxy,\r\n    roundEven,\r\n    roundUneven,\r\n    updateBounds,\r\n\r\n    // ---- line ----\r\n    projectPointOnLine,\r\n    PointLine,\r\n    BezierLine,\r\n    SplineInterpolator,\r\n    quadraticSplineInput,\r\n\r\n    // ---- canvas ----\r\n    canvas: createCanvas,\r\n    copyCanvas,\r\n    testShouldPixelate,\r\n    drawTransformedImageWithBounds,\r\n    drawTransformedImageOnCanvas,\r\n    createCheckerCanvas,\r\n    createCheckerDataUrl,\r\n    resizeCanvas,\r\n    convertToAlphaChannelCanvas,\r\n\r\n    // ---- color ----\r\n    HSV,\r\n    RGB,\r\n    CMYK,\r\n    ColorConverter,\r\n    testIsWhiteBestContrast,\r\n\r\n    // ---- UI ----\r\n    appendTextDiv,\r\n    clearSelection,\r\n    makeUnfocusable,\r\n    el,\r\n    destroyEl,\r\n    isInputFocused: isInputFocused,\r\n\r\n\r\n    // ---- events / input ----\r\n\r\n    addEventListener: BBEventListener.addEventListener,\r\n    removeEventListener: BBEventListener.removeEventListener,\r\n    setEventListener: BBEventListener.setEventListener,\r\n\r\n    KeyListener,\r\n    PointerListener,\r\n\r\n    EventChain,\r\n\r\n};\r\n","import {hasPointerEvents} from '../base/browser';\r\n\r\nconst listenerFuncObj = {};\r\n\r\nexport const setEventListener = function (DomEl, type, listener) {\r\n    if (!hasPointerEvents) {\r\n        type = type.replace('pointer', 'mouse');\r\n    }\r\n    DomEl[type] = listener;\r\n};\r\n\r\nexport const addEventListener = function (DomEl, type, listener, options?) {\r\n    if (!hasPointerEvents) {\r\n        type = type.replace('pointer', 'mouse');\r\n    }\r\n    if (!(type in listenerFuncObj)) {\r\n        listenerFuncObj[type] = [];\r\n    }\r\n    listenerFuncObj[type].push(listener);\r\n    DomEl.addEventListener(type, listener, options);\r\n};\r\n\r\nexport const removeEventListener = function (DomEl, type, listener, options?) {\r\n    if (!hasPointerEvents) {\r\n        type = type.replace('pointer', 'mouse');\r\n    }\r\n    if (type in listenerFuncObj) {\r\n        for (let i = 0; i < listenerFuncObj[type].length; i++) {\r\n            if (listenerFuncObj[type][i] === listener) {\r\n                listenerFuncObj[type].splice(i, 1);\r\n                i--;\r\n            }\r\n        }\r\n    }\r\n    DomEl.removeEventListener(type, listener, options);\r\n};","import {createCanvas} from './create-canvas';\r\n\r\nexport const isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\r\nexport const isEdge = window.navigator.userAgent.indexOf('Edge') > -1;\r\n\r\nexport const eventUsesHighResTimeStamp = (function() {\r\n\r\n    let eventUsesHighResTimeStamp: boolean | null = null;\r\n    if (document.body) {\r\n        (function() {\r\n            const event = new Event('');\r\n            eventUsesHighResTimeStamp = event.timeStamp < 1000 * 60 * 60;\r\n        })();\r\n    } else {\r\n        window.addEventListener('DOMContentLoaded', function(event) {\r\n            eventUsesHighResTimeStamp = event.timeStamp < 1000 * 60 * 60;\r\n        });\r\n    }\r\n\r\n    return function(): boolean {\r\n        if(eventUsesHighResTimeStamp === null) {\r\n            throw 'eventUsesHighResTimeStamp not initialized';\r\n        }\r\n        return eventUsesHighResTimeStamp;\r\n    }\r\n})();\r\n\r\nexport const mouseEventHasMovement = (() => {\r\n\r\n    // no support: IE, Safari, Safari iOS\r\n    // supported but broken: Firefox\r\n\r\n    if (!('MouseEvent' in window)) {\r\n        return false;\r\n    }\r\n    let mouseEvent;\r\n    try {\r\n        mouseEvent = new MouseEvent('mousemove'); // browsers not supporting the constructor don't have it\r\n    } catch (e) {\r\n        return false;\r\n    }\r\n    if (!('movementX' in mouseEvent)) {\r\n        return false; // likely safari\r\n    }\r\n    return !isFirefox;\r\n})();\r\n\r\nexport const hasPointerEvents = !!window.PointerEvent;\r\n\r\nexport const hasWebGl = (function() {\r\n\r\n    const hasWebgl = (function() {\r\n        const canvas = createCanvas();\r\n        try {\r\n            canvas.getContext('experimental-webgl', { premultipliedAlpha: false });\r\n            return true;\r\n        } catch (e) {\r\n            return false;\r\n        }\r\n    })();\r\n\r\n    return function() {\r\n        return hasWebgl;\r\n    }\r\n})();\r\n\r\nexport const getVisitor = (function () {\r\n    const visitor = {\r\n        chrome: false,\r\n        gl: false\r\n    };\r\n    //Chrome\r\n    if ((window as any).chrome && (window as any).chrome.app) {\r\n        visitor.chrome = true;\r\n    }\r\n    //WebGL\r\n    visitor.gl = hasWebGl();\r\n    return function () {\r\n        return JSON.parse(JSON.stringify(visitor));\r\n    }\r\n})();\r\n\r\nexport const isCssMinMaxSupported = (function() {\r\n    let result: boolean | null = null;\r\n\r\n    function test() {\r\n        const div = document.createElement('div');\r\n        div.style.position = 'absolute';\r\n        div.style.top = '0';\r\n        div.style.left = 'max(0px, 25px)';\r\n        document.body.appendChild(div);\r\n        setTimeout(function() {\r\n            result = div.offsetLeft === 25;\r\n            document.body.removeChild(div);\r\n        }, 25);\r\n    }\r\n\r\n    if (document.body) {\r\n        test();\r\n    } else {\r\n        window.addEventListener('DOMContentLoaded', function() {\r\n            test();\r\n        });\r\n    }\r\n\r\n    return function(): boolean {\r\n        if (result === null) {\r\n            throw new Error('isCssMinMaxSupported not initialized');\r\n        }\r\n        return result;\r\n    };\r\n})();\r\n\r\nexport const canShareFiles = function(): boolean {\r\n    return 'share' in navigator && 'canShare' in navigator;\r\n};","export function createCanvas(w?: number, h?: number): HTMLCanvasElement {\r\n    const result = document.createElement('canvas');\r\n    if (w && h) {\r\n        result.width = w;\r\n        result.height = h;\r\n    }\r\n    return result;\r\n}","import {IKeyString, ISize2D, ISVG, IVector2D} from '../BB.types';\r\n\r\nexport function getPageOffset (element: HTMLElement): IVector2D {\r\n    const result = {\r\n        x: 0,\r\n        y: 0\r\n    };\r\n    while (element != null) {\r\n        result.x += element.offsetLeft;\r\n        result.y += element.offsetTop;\r\n        element = element.offsetParent as HTMLElement;\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function insertAfter (referenceNode: Element, newNode: Element): void {\r\n    if (referenceNode.parentNode) {\r\n        referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\r\n    }\r\n}\r\n\r\nexport function loadImage (im: HTMLImageElement, callback: () => void): void {\r\n    let counter = 0;\r\n\r\n    function check() {\r\n        if (counter === 1000) {\r\n            alert(\"couldn't load\");\r\n            return;\r\n        }\r\n        if (im.complete) {\r\n            counter++;\r\n            callback();\r\n        } else {\r\n            setTimeout(check, 1);\r\n        }\r\n    }\r\n\r\n    check();\r\n}\r\n\r\nexport function css (el: HTMLElement | SVGElement, styleObj: IKeyString): void {\r\n    const keyArr = Object.keys(styleObj);\r\n    let keyStr: string;\r\n    const style = (el.style as unknown) as IKeyString;\r\n    for(let i = 0; i < keyArr.length; i++) {\r\n        keyStr = keyArr[i];\r\n        style[keyStr] = styleObj[keyStr];\r\n        style.alignContent = 'true';\r\n        if (keyStr === 'userSelect') {\r\n            style.webkitUserSelect = styleObj[keyStr]; // safari\r\n        }\r\n    }\r\n}\r\n\r\nexport function setAttributes (el: HTMLElement, attrObj: IKeyString): void {\r\n    const keyArr = Object.keys(attrObj);\r\n    let keyStr;\r\n    for(let i = 0; i < keyArr.length; i++) {\r\n        keyStr = keyArr[i];\r\n        el.setAttribute(keyStr, attrObj[keyStr]);\r\n    }\r\n}\r\n\r\nexport function addClassName (el: HTMLElement | SVGElement, classStr: string): void {\r\n    const classAttr = el.getAttribute('class');\r\n    const splitArr = classAttr === null ? [] : classAttr.split(' ');\r\n    if(splitArr.includes(classStr)) {\r\n        return;\r\n    }\r\n    splitArr.push(classStr);\r\n    el.setAttribute('class', splitArr.join(' '));\r\n}\r\n\r\nexport function removeClassName (el: HTMLElement | SVGElement, classStr: string): void {\r\n    const classAttr = el.getAttribute('class');\r\n    const splitArr = classAttr === null ? [] : classAttr.split(' ');\r\n    if(!splitArr.includes(classStr)) {\r\n        return;\r\n    }\r\n    for(let i = 0; i < splitArr.length; i++) {\r\n        if(splitArr[i] === classStr) {\r\n            splitArr.splice(i, 1);\r\n            i--;\r\n        }\r\n    }\r\n    el.setAttribute('class', splitArr.join(' '));\r\n}\r\n\r\n/**\r\n * appendChild with an array\r\n * @param target\r\n * @param els\r\n */\r\nexport function append(target: HTMLElement, els: (HTMLElement | null)[]) {\r\n    const fragment = document.createDocumentFragment();\r\n    els.forEach(item => item ? fragment.appendChild(item) : null);\r\n    target.appendChild(fragment);\r\n}\r\n\r\n/**\r\n * a needs to fit into b\r\n * @param aw\r\n * @param ah\r\n * @param bw\r\n * @param bh\r\n * @param min\r\n */\r\nexport function fitInto (aw: number, ah: number, bw: number, bh: number, min?: number): ISize2D {\r\n    let width = aw * bw, height = ah * bw;\r\n    if (width > bw) {\r\n        height = bw / width * height;\r\n        width = bw;\r\n    }\r\n    if (height > bh) {\r\n        width = bh / height * width;\r\n        height = bh;\r\n    }\r\n    if(min) {\r\n        width = Math.max(min, width);\r\n        height = Math.max(min, height);\r\n    }\r\n    return {width, height};\r\n}\r\n\r\n/**\r\n * center b in a\r\n * @param aw\r\n * @param ah\r\n * @param bw\r\n * @param bh\r\n */\r\nexport function centerWithin (aw: number, ah: number, bw: number, bh: number): IVector2D {\r\n    return {\r\n        x: aw / 2 - bw / 2,\r\n        y: ah / 2 - bh / 2\r\n    };\r\n}\r\n\r\nexport function getDate (): string {\r\n    const date = new Date();\r\n    const year = date.getFullYear();\r\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\r\n    const day = date.getDate().toString().padStart(2, '0');\r\n    const minutes = (date.getHours() * 60 + date.getMinutes()).toString(36).padStart(3, '0');\r\n\r\n    return year + '_' + month + '_' + day + '_' + minutes + '_';\r\n}\r\n\r\nexport function gcd (a: number, b: number): number {\r\n    return b ? gcd(b, a % b) : a;\r\n}\r\n\r\nexport function reduce (numerator: number, denominator: number): [number, number] {\r\n    const g = gcd(numerator, denominator);\r\n    return [numerator / g, denominator / g];\r\n}\r\n\r\nexport function decToFraction (decimalNumber: number): [number, number] {\r\n    const len = decimalNumber.toString().length - 2;\r\n    const denominator = Math.pow(10, len);\r\n    const numerator = decimalNumber * denominator;\r\n    return reduce(numerator, denominator);\r\n}\r\n\r\n/**\r\n * blobObj isn't always a Blob, but rather an object, because Blob doesn't exist.\r\n * @param blobObj\r\n * @returns {string}\r\n */\r\nexport function imageBlobToUrl(blobObj: Blob): string {\r\n    if (!blobObj) {\r\n        throw new Error('blobObj is undefined or null');\r\n    }\r\n    if (window.Blob && blobObj instanceof Blob) {\r\n        return URL.createObjectURL(blobObj); // object url\r\n    } else if(blobObj.constructor.name === 'Object') {\r\n        const fauxBlob = (blobObj as unknown) as {type: string, encoding: string, data: string};\r\n        return 'data:' + fauxBlob.type + ';' + fauxBlob.encoding + ',' + fauxBlob.data; // data url\r\n    } else {\r\n        throw new Error('unknown blob format');\r\n    }\r\n}\r\n\r\nexport function dateDayDifference (dateA: string | Date, dateB: string | Date): number {\r\n    dateA = new Date(dateA);\r\n    dateB = new Date(dateB);\r\n    dateA.setHours(0, 0, 0, 0);\r\n    dateB.setHours(0, 0, 0, 0);\r\n    return (dateB.getTime() - dateA.getTime()) / (1000 * 60 * 60 * 24);\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\r\nexport function copyObj (obj: any): any {\r\n    return JSON.parse(JSON.stringify(obj));\r\n}\r\n\r\n/**\r\n * triggers Web Share API - share feature on mobile devices\r\n * Only works if they support file sharing - e.g. Safari can't do this yet\r\n * only call if BB.canShareFiles() -> true\r\n *\r\n * p = {\r\n *     canvas: Canvas,\r\n *     fileName: string,\r\n *     title: string\r\n * }\r\n *\r\n * @param p\r\n */\r\nexport function shareCanvas (p: {canvas: HTMLCanvasElement, fileName:string, title: string, callback: () => void}): void {\r\n    const mimetype = 'image/png';\r\n    p.canvas.toBlob(function(blob) {\r\n        if (blob === null) {\r\n            alert('sharing not supported');\r\n            p.callback();\r\n            return;\r\n        }\r\n        try {\r\n            const filesArray = [new File([blob], p.fileName, {type: mimetype})];\r\n            navigator.share({\r\n                title: p.title,\r\n                files: filesArray,\r\n            } as any);\r\n        } catch(e) {\r\n            alert('sharing not supported');\r\n        }\r\n        p.callback();\r\n    }, mimetype);\r\n}\r\n\r\n/**\r\n * Prevent ipad from zooming in when double tapping. iPadOS 13 bug.\r\n * Give it your click event\r\n *\r\n * @param clickEvent\r\n * @returns {boolean}\r\n */\r\nexport function handleClick (clickEvent: MouseEvent): boolean {\r\n    const target: HTMLElement | null = clickEvent.target as HTMLElement;\r\n    if (!target) {\r\n        return false;\r\n    }\r\n    if(['A', 'LABEL', 'INPUT'].includes(target.tagName) || (target as any).allowClick) {\r\n        return true;\r\n    }\r\n    clickEvent.preventDefault();\r\n    return false;\r\n}\r\n\r\n\r\n/**\r\n * @param el {elementType: string, childrenArr: []el, ...svg attributes...}\r\n * @returns svg element tree\r\n */\r\nexport function createSvg (el: ISVG): SVGElement {\r\n    const result = document.createElementNS('http://www.w3.org/2000/svg', el.elementType);\r\n    const keyArr = Object.keys(el);\r\n    let keyStr;\r\n    for(let i = 0; i < keyArr.length; i++) {\r\n        keyStr = keyArr[i];\r\n        if(keyStr === 'childrenArr') {\r\n            for(let e = 0; e < el.childrenArr.length; e++) {\r\n                result.appendChild(createSvg(el.childrenArr[e]));\r\n            }\r\n        } else if(keyStr !== 'elementType') {\r\n            result.setAttribute(keyStr, el[keyStr] as string);\r\n        }\r\n    }\r\n    return result;\r\n}","import {addEventListener, removeEventListener} from './event-listener';\r\n\r\n\r\nconst globalKey = (() => {\r\n\r\n    const keyStrToKeyObj = { // keyStr not to contain a '+', because that's used for the comboStr\r\n        'space': [' ', 'Spacebar'], // Spacebar in IE\r\n        'alt': ['Alt', 'AltGraph'],\r\n        'shift': 'Shift',\r\n        'ctrl': 'Control',\r\n        'cmd': ['Meta', 'MetaLeft', 'MetaRight'],\r\n        'enter': 'Enter',\r\n        'esc': 'Escape',\r\n        'backspace': 'Backspace',\r\n        'delete': 'Delete',\r\n        'sqbr_open': '[',\r\n        'sqbr_close': ']',\r\n        'a': ['a', 'A'],\r\n        'b': ['b', 'B'],\r\n        'c': ['c', 'C'],\r\n        'e': ['e', 'E'],\r\n        'f': ['f', 'F'],\r\n        'g': ['g', 'G'],\r\n        'r': ['r', 'R'], // when holding shift\r\n        's': ['s', 'S'],\r\n        't': ['t', 'T'],\r\n        'u': ['u', 'U'],\r\n        'x': ['x', 'X'],\r\n        'y': ['y', 'Y'],\r\n        'z': ['z', 'Z'],\r\n        'plus': '+',\r\n        'minus': '-',\r\n        'left': 'ArrowLeft',\r\n        'right': 'ArrowRight',\r\n        'up': 'ArrowUp',\r\n        'down': 'ArrowDown',\r\n        'home': 'Home',\r\n        'end': 'End'\r\n    };\r\n    const keyToKeyStrArr = Object.keys(keyStrToKeyObj);\r\n    const isDownObj = {};\r\n    const keyToKeyStrObj = {}; // event.key to keyStr { ArrowLeft: 'left', ... }\r\n    let comboArr = [];\r\n    //a physical key's \"key\" can change as other keys get pressed. to keep track, need to also track the code\r\n    let codeIsDownObj = {}; // { KeyE: 'e', KeyF: null } - null not down, string, the associated keyStr\r\n    const listenerArr = [];\r\n\r\n    for (let i = 0; i < keyToKeyStrArr.length; i++) {\r\n        isDownObj[keyToKeyStrArr[i]] = false;\r\n\r\n        const code = keyStrToKeyObj[keyToKeyStrArr[i]];\r\n        if (typeof code === 'string') {\r\n            keyToKeyStrObj[keyStrToKeyObj[keyToKeyStrArr[i]]] = keyToKeyStrArr[i];\r\n        } else {\r\n            for (let e = 0; e < code.length; e++) {\r\n                keyToKeyStrObj[code[e]] = keyToKeyStrArr[i];\r\n            }\r\n        }\r\n    }\r\n\r\n    function emitDown(a, b, c, d?) {\r\n        listenerArr.forEach(item => {\r\n            if (!item[0]) {\r\n                return;\r\n            }\r\n            item[0](a, b, c, d);\r\n        });\r\n    }\r\n\r\n    function emitUp(a, b, c) {\r\n        listenerArr.forEach(item => {\r\n            if (!item[1]) {\r\n                return;\r\n            }\r\n            item[1](a, b, c);\r\n        });\r\n    }\r\n\r\n    function emitBlur() {\r\n        listenerArr.forEach(item => {\r\n            if (!item[2]) {\r\n                return;\r\n            }\r\n            item[2]();\r\n        });\r\n    }\r\n\r\n    function keyDown(e) {\r\n        const key = e.key;\r\n        const code = 'code' in e ? e.code : e.keyCode; // ie doesn't have code\r\n\r\n        if (key in keyToKeyStrObj) {\r\n            const keyStr = keyToKeyStrObj[key];\r\n            if (isDownObj[keyStr]) {\r\n                emitDown(keyStr, e, comboArr.join('+'), true);\r\n                return;\r\n            }\r\n            isDownObj[keyStr] = true;\r\n            codeIsDownObj[code] = keyStr;\r\n\r\n            //add to combo\r\n            comboArr.push(keyStr);\r\n\r\n            emitDown(keyStr, e, comboArr.join('+'));\r\n        }\r\n    }\r\n\r\n\r\n    function keyUp(e) {\r\n        const key = e.key;\r\n        const code = 'code' in e ? e.code : e.keyCode; // ie doesn't have code\r\n        const oldComboStr = comboArr.join('+');\r\n\r\n        // because of a safari bug: when meta key is down, keyup of over keys does not fire.\r\n        if (['Meta', 'MetaLeft'].includes(code)) {\r\n            blur(null);\r\n            return;\r\n        }\r\n\r\n        if (code in codeIsDownObj && codeIsDownObj[code] !== null) {\r\n            const keyStr = codeIsDownObj[code];\r\n            isDownObj[keyStr] = false;\r\n            codeIsDownObj[code] = null;\r\n\r\n            //remove from combo\r\n            for (let i = 0; i < comboArr.length; i++) {\r\n                if (comboArr[i] == keyStr) {\r\n                    comboArr.splice(i, 1);\r\n                    i--;\r\n                }\r\n            }\r\n\r\n            emitUp(keyStr, e, oldComboStr);\r\n        }\r\n    }\r\n\r\n    function blur(event) {\r\n        const oldComboStr = comboArr.join('+');\r\n        comboArr = [];\r\n        codeIsDownObj = {};\r\n\r\n        const eventArr = [];\r\n        for (let i = 0; i < keyToKeyStrArr.length; i++) {\r\n            isDownObj[keyToKeyStrArr[i]] = false;\r\n            eventArr.push(keyToKeyStrArr[i]);\r\n        }\r\n        for (let i = 0; i < eventArr.length; i++) {\r\n            emitUp(eventArr[i], {\r\n                preventDefault: function () {\r\n                }, stopPropagation: function () {\r\n                }\r\n            }, oldComboStr);\r\n        }\r\n        emitBlur();\r\n    }\r\n\r\n\r\n\r\n    return {\r\n        add: (keyListener) => {\r\n            if (listenerArr.includes(keyListener)) {\r\n                return;\r\n            }\r\n            const first = listenerArr.length === 0;\r\n            listenerArr.push(keyListener);\r\n\r\n            if (first) {\r\n                addEventListener(document, 'keydown', keyDown);\r\n                addEventListener(document, 'keyup', keyUp);\r\n                addEventListener(window, 'blur', blur);\r\n            }\r\n        },\r\n        remove: (keyListener) => {\r\n            if (!listenerArr.includes(keyListener)) {\r\n                return;\r\n            }\r\n            const last = listenerArr.length === 1;\r\n            for (let i = 0; i < listenerArr.length; i++) {\r\n                if (listenerArr[i] === keyListener) {\r\n                    listenerArr.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n            if (last) {\r\n                removeEventListener(document, 'keydown', keyDown);\r\n                removeEventListener(document, 'keyup', keyUp);\r\n                removeEventListener(window, 'blur', blur);\r\n            }\r\n        },\r\n        getIsDown: () => {\r\n            return isDownObj;\r\n        },\r\n        getCombo: () => {\r\n            return comboArr;\r\n        },\r\n    };\r\n})();\r\n\r\n\r\n\r\n/**\r\n * Listens to key events in window. Makes combos easier - e.g. ctrl + z\r\n *\r\n * keyStr - see in implementation - my representation of a key. e.g. 'r' can be 'r' and 'R'\r\n * comboStr - string joins currently pressed keyStr with a +\r\n *              e.g. 'ctrl+z'\r\n *\r\n */\r\nexport class KeyListener {\r\n\r\n    private readonly onDown;\r\n    private readonly onUp;\r\n    private readonly onBlur;\r\n    private readonly ref;\r\n\r\n    /**\r\n     * onDown: function(keyStr, KeyEvent, comboStr, isRepeat), // optional - when key down\r\n     * onUp: function(keyStr, KeyEvent, oldComboStr), // optional - when key up\r\n     * onBlur: function(), // optional - when window blur - yes, no params\r\n     *\r\n     * @param p\r\n     */\r\n    constructor (\r\n        p: {onDown?: any, onUp?: any, onBlur?: any},\r\n    ) {\r\n        this.onDown = p.onDown;\r\n        this.onUp = p.onUp;\r\n        this.onBlur = p.onBlur;\r\n        this.ref = [this.onDown, this.onUp, this.onBlur];\r\n        globalKey.add(this.ref);\r\n    }\r\n\r\n    isPressed (keyStr) {\r\n        if (!(keyStr in globalKey.getIsDown())) {\r\n            throw 'key \"' + keyStr + '\" not found';\r\n        }\r\n        return globalKey.getIsDown()[keyStr];\r\n    }\r\n\r\n    getComboStr () {\r\n        return globalKey.getCombo().join('+');\r\n    }\r\n\r\n    comboOnlyContains (keyStrArr) {\r\n        for (let i = 0; i < globalKey.getCombo().length; i++) {\r\n            if (!keyStrArr.includes(globalKey.getCombo()[i])) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    destroy () {\r\n        globalKey.remove(this.ref);\r\n    }\r\n}\r\n","import {addEventListener, removeEventListener} from './event-listener';\r\n\r\n\r\n/**\r\n * Filters wheel events. removes swipe scrolling and pinch scrolling that trackpads do. (as best as it can)\r\n * Normalizes regular scrolls.\r\n *\r\n * Why:\r\n * - trackpad scrolling is different from old school mouse scrolling\r\n * - but there is not way to learn from the browser if it's trackpad scrolling\r\n * - browsers don't even give access to the raw swiping or pinching movement, but some abstraction on top, making the scrolling\r\n *      continue an arbitrary amount, at an arbitrary scale\r\n * - each browser does this differently. So you can't offer a coherent experience\r\n *\r\n * - also trackpads are painful to draw with. So supporting a trackpad-based workflow makes not much sense.\r\n *\r\n * @param callback - func({deltaY: number, pageX: number, pageY: number}\r\n * @constructor\r\n */\r\nimport {eventUsesHighResTimeStamp, hasPointerEvents, isFirefox} from '../base/browser';\r\nimport {getPageOffset} from '../base/base';\r\nimport {mix} from '../math/math';\r\n\r\nconst WheelCleaner = function (callback) {\r\n    const sequenceTimeoutMs = 200;\r\n\r\n    const knownUnitArr = [100];\r\n    let sequenceLength = 0;\r\n    let sequenceUnit = null;\r\n    let endSequenceTimeout;\r\n    let toEmitDelta = null;\r\n    let position = null;\r\n\r\n\r\n    function emit(delta) {\r\n        callback({\r\n            deltaY: Math.round(delta / sequenceUnit),\r\n            pageX: position.pageX,\r\n            pageY: position.pageY\r\n        });\r\n    }\r\n\r\n    function endSequence() {\r\n        if (toEmitDelta !== null) {\r\n            emit(toEmitDelta);\r\n            toEmitDelta = null;\r\n        }\r\n        if (sequenceUnit !== null && !(knownUnitArr.includes(sequenceUnit))) {\r\n            knownUnitArr.push(sequenceUnit);\r\n        }\r\n        sequenceLength = 0;\r\n        sequenceUnit = null;\r\n    }\r\n\r\n    // --- interface ---\r\n    this.process = function (event) {\r\n\r\n        position = {\r\n            pageX: event.pageX,\r\n            pageY: event.pageY,\r\n        };\r\n\r\n        clearTimeout(endSequenceTimeout);\r\n        endSequenceTimeout = setTimeout(endSequence, sequenceTimeoutMs);\r\n\r\n        //prep delta\r\n        let delta = event.deltaY;\r\n        if ('deltaMode' in event && event.deltaMode === 1) {\r\n            delta *= 100 / 3;\r\n        }\r\n        const absDelta = Math.abs(delta);\r\n\r\n\r\n        if (sequenceLength > 0 && sequenceUnit === null) {\r\n            //previously determined dirty sequence\r\n            toEmitDelta = null;\r\n            return;\r\n        }\r\n\r\n        //sequence begins\r\n        if (sequenceLength === 0) {\r\n            sequenceLength++;\r\n            if (absDelta < 50) {\r\n                //dirty - probably a swipe scroll or pinch scroll on trackpad\r\n                return;\r\n            }\r\n\r\n            sequenceUnit = absDelta;\r\n            if (knownUnitArr.includes(sequenceUnit)) {\r\n                //we know this unit - emit right away\r\n                emit(delta);\r\n            } else {\r\n                //unknown unit - wait until next event or sequence end, to have more certainty that it's clean\r\n                toEmitDelta = delta;\r\n            }\r\n            return;\r\n        }\r\n\r\n        //sequence continues\r\n        if (absDelta === 0) {\r\n            //ignore zero scroll\r\n            return;\r\n        }\r\n        if (\r\n            absDelta === sequenceUnit ||\r\n            (absDelta / sequenceUnit) % 1 < 0.0001// a multiple\r\n        ) {\r\n            //fine\r\n        } else if ((sequenceUnit / absDelta) % 1 < 0.0001) {\r\n            //unit was actually a multiple - update it\r\n            sequenceUnit = absDelta;\r\n\r\n        } else if (absDelta !== sequenceUnit) {\r\n            //not clean - delta is varying - probably a swipe scroll or pinch scroll on trackpad\r\n            sequenceUnit = null;\r\n            toEmitDelta = null;\r\n            return;\r\n        }\r\n\r\n\r\n        if (toEmitDelta !== null) {\r\n            emit(toEmitDelta);\r\n            toEmitDelta = null;\r\n        }\r\n        emit(delta);\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * PointerListener - for pointer events, wheel events. uses fallbacks. ideally consistent behavior across browsers\r\n * Has some workarounds for browser specific bugs. As browsers get better, this constructor should get smaller\r\n *\r\n * p = {\r\n *     target: DOM element,\r\n *     onPointer: func (pointerEvent), //optional\r\n *     onWheel: func (wheelEvent), //optional\r\n *     onEnterLeave: func (isOver: boolean), //optional\r\n *     maxPointers: int (1 - n), //default is 1\r\n *     fixScribble: boolean, // fix ipad scribble issue\r\n * }\r\n *\r\n * pointerEvent = {\r\n *     type: 'pointerdown'|'pointermove'|'pointerup',\r\n *     pointerId: long,\r\n *     pointerType: 'touch'|'mouse'|'pen',\r\n *     pageX: number,\r\n *     pageY: number,\r\n *     relX: number, //position relative to top left of target\r\n *     relY: number,\r\n *     dX: number, //movementX not supported by safari on iOS, so need my own\r\n *     dY: number,\r\n *     downPageX: number, //where was pointer when down-event occurred - set for down|move|up\r\n *     downPageY: number,\r\n *     coalescedArr: Array of {\r\n *         pageX: number,\r\n *         pageY: number,\r\n *         relX: number, //position relative to top left of target\r\n *         relY: number,\r\n *         dX: number,\r\n *         dY: number,\r\n *         time: number// same timescale as performance.now() - might be exact same number as in parent\r\n *     },\r\n *     time: number, // same timescale as performance.now()\r\n *     button: 'left'|'middle'|'right',\r\n *     pressure: number (0-1), // always 1 for touch and mouse\r\n *     eventPreventDefault: function(),\r\n *     eventStopPropagation: function(),\r\n * }\r\n *\r\n * wheelEvent = {\r\n *     deltaY: number, // increments of 1\r\n *     pageX: number,\r\n *     pageY: number,\r\n *     relX: number,\r\n *     relY: number\r\n * }\r\n *\r\n * isOver(): boolean - if pointer over the target\r\n *\r\n * @param p\r\n */\r\nexport const PointerListener = (function () {\r\n\r\n    //keeping track of pointers for movement fallback\r\n    const pointerArr = [];\r\n\r\n    function addPointer(event) {\r\n        const pointerObj = {\r\n            pointerId: event.pointerId,\r\n            lastPageX: null,\r\n            lastPageY: null\r\n        };\r\n        pointerArr.push(pointerObj);\r\n\r\n        if (pointerArr.length > 15) {\r\n            pointerArr.shift();\r\n        }\r\n\r\n        return pointerObj;\r\n    }\r\n\r\n    function getPointer(event) {\r\n        for (let i = pointerArr.length - 1; i >= 0; i--) {\r\n            if (event.pointerId === pointerArr[i].pointerId) {\r\n                return pointerArr[i];\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n\r\n    let pressureNormalizeAvgCount = 0;\r\n    let pressureNormalizeAvgPressure = null;\r\n    let pressureNormalizeIsComplete = false;\r\n    let pressureNormalizeFactor = 1;\r\n\r\n    return function (p) {\r\n        const targetElement = p.target;\r\n        const onPointerCallback = p.onPointer;\r\n        const onWheelCallback = p.onWheel;\r\n        const onEnterLeaveCallback = p.onEnterLeave;\r\n        const maxPointers = 'maxPointers' in p ? p.maxPointers : 1;\r\n        const buttonsToStr = { // translation\r\n            '1': 'left',\r\n            '2': 'right',\r\n            '4': 'middle'\r\n        };\r\n        const wheelCleaner = new WheelCleaner(function (wheelEvent) {\r\n            if (isDestroyed) {\r\n                return;\r\n            }\r\n            if (onWheelCallback) {\r\n                updateOffset();\r\n                wheelEvent.relX = wheelEvent.pageX - offsetObj.x;\r\n                wheelEvent.relY = wheelEvent.pageY - offsetObj.y;\r\n                onWheelCallback(wheelEvent);\r\n            }\r\n        });\r\n        let isDestroyed = false;\r\n\r\n        let offsetObj = {x: 0, y: 0};\r\n\r\n        function updateOffset() {\r\n            if (targetElement === window) {\r\n                return;\r\n            }\r\n            offsetObj = getPageOffset(targetElement);\r\n        }\r\n\r\n        updateOffset();\r\n        const timeStampOffset = eventUsesHighResTimeStamp() ? 0 : -performance.timing.navigationStart;\r\n\r\n\r\n        //to circumvent a chrome input glitch\r\n        let lastPointerType = '';\r\n        let didSkip = false;\r\n\r\n\r\n        /*\r\n        pointers that are pressing a button\r\n        dragObj = {\r\n            pointerId: long,\r\n            pointerType: 'mouse'|'pen'|'touch',\r\n            downPageX: number, //where was pointer when down-event occurred\r\n            downPageY: number,\r\n            button: long,\r\n            lastPageX: number, //pageX in previous event - only for touch events, because they don't have movementX/Y\r\n            lastPageY: number,\r\n            lastTimeStamp: number\r\n        }\r\n         */\r\n        const dragObjArr = [];\r\n        const dragPointerIdArr = [];\r\n\r\n        function getDragObj(pointerId) {\r\n            for (let i = 0; i < dragObjArr.length; i++) {\r\n                if (pointerId === dragObjArr[i].pointerId) {\r\n                    return dragObjArr[i];\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n\r\n        function removeDragObj(pointerId) {\r\n            let removedDragObj = null;\r\n            for (let i = 0; i < dragPointerIdArr.length; i++) {\r\n                if (dragPointerIdArr[i] === pointerId) {\r\n                    removedDragObj = dragObjArr[i];\r\n                    dragObjArr.splice(i, 1);\r\n                    dragPointerIdArr.splice(i, 1);\r\n                    i--;\r\n                }\r\n            }\r\n            return removedDragObj;\r\n        }\r\n\r\n\r\n        function normalizePressure(pressure, type?) {\r\n            if (pressure === 0 || pressure === 1) {\r\n                return pressure;\r\n            }\r\n\r\n            // was this there to prevent some glitch?\r\n            /*if (pressureNormalizeIsComplete && type === 'pointerdown' && pressure !== 1) {\r\n                pressure *= 0.004;\r\n            }*/\r\n\r\n            if (pressureNormalizeAvgCount < 60) {\r\n                if (pressureNormalizeAvgCount === 0) {\r\n                    pressureNormalizeAvgPressure = pressure;\r\n                } else {\r\n                    pressureNormalizeAvgPressure = mix(pressure, pressureNormalizeAvgPressure, 0.95);\r\n                }\r\n                pressureNormalizeAvgCount++;\r\n            } else if (!pressureNormalizeIsComplete) {\r\n                pressureNormalizeIsComplete = true;\r\n                //BB.throwOut('avg pressure decision!' + pressureNormalizeAvgPressure);\r\n                if (pressureNormalizeAvgPressure < 0.13) { // absurd pressure needed\r\n                    pressureNormalizeFactor = 2.3;\r\n                }\r\n            }\r\n\r\n\r\n            return Math.pow(pressure, 1 / pressureNormalizeFactor);\r\n        }\r\n\r\n\r\n        /**\r\n         *\r\n         * More trustworthy pointer attributes. that behave the same across browsers.\r\n         * returns a new object. this object also gets attached to the orig event. -> event.corrected\r\n         *\r\n         * @param event\r\n         * @returns {{pointerId: number, timeStamp: number, button, buttons, pointerType: (string|string|any), movementY: number, movementX: number, pressure, coalescedArr: [], pageY, pageX, eventPreventDefault: func, eventStopPropagation: func}\r\n         */\r\n        function correctPointerEvent(event) {\r\n            if (event.corrected) {\r\n                return event.corrected;\r\n            }\r\n\r\n            /*if(event.type === 'pointermove' && !window.hidePressureOut) {\r\n                if(event.type === 'pointermove') {\r\n                    BB.throwOut(event.pressure + ' ' + event.pointerType);\r\n                }\r\n            }*/\r\n\r\n            const correctedObj = {\r\n                pointerId: event.pointerId,\r\n                pointerType: event.pointerType,\r\n                pageX: event.pageX,\r\n                pageY: event.pageY,\r\n                movementX: event.movementX,\r\n                movementY: event.movementY,\r\n                timeStamp: event.timeStamp + timeStampOffset,\r\n                pressure: normalizePressure(event.pressure, event.type),\r\n                buttons: event.buttons,\r\n                button: event.button,\r\n                coalescedArr: [],\r\n                eventPreventDefault: function () {\r\n                    event.preventDefault();\r\n                },\r\n                eventStopPropagation: function () {\r\n                    event.stopPropagation();\r\n                }\r\n            };\r\n            event.corrected = correctedObj;\r\n\r\n            let customPressure = null;\r\n            if ('pointerId' in event) {\r\n                if (isFirefox) {\r\n                    correctedObj.pressure = 1;\r\n                    customPressure = 1;\r\n                    //correctedObj.pointerId = 0; // commented -> make multi touch work on mobile\r\n                } else if ('pressure' in event && event.buttons !== 0 && (['mouse'].includes(event.pointerType) || (event.pointerType === 'touch' && event.pressure === 0))) {\r\n                    correctedObj.pressure = 1;\r\n                    customPressure = 1;\r\n                }\r\n            } else {\r\n                correctedObj.pointerId = 0;\r\n                correctedObj.pointerType = 'mouse';\r\n                correctedObj.pressure = event.buttons !== 0 ? 1 : 0;\r\n                customPressure = correctedObj.pressure;\r\n            }\r\n\r\n            if (isFirefox && event.pointerType != 'mouse' && event.type === 'pointermove' && event.buttons === 0) { // once again firefox\r\n                correctedObj.buttons = 1; //todo wrong if no buttons actually pressed\r\n            }\r\n\r\n            let coalescedEventArr = [];\r\n            if ('getCoalescedEvents' in event) {\r\n                coalescedEventArr = event.getCoalescedEvents();\r\n            }\r\n\r\n            // chrome somehow movementX not same scale as pageX. todo: only chrome?\r\n            // so make my own\r\n\r\n            let pointerObj = getPointer(correctedObj);\r\n            if (pointerObj === null) {\r\n                pointerObj = addPointer(correctedObj);\r\n            }\r\n\r\n            const totalLastX = pointerObj.lastPageX;\r\n            const totalLastY = pointerObj.lastPageY;\r\n\r\n            for (let i = 0; i < coalescedEventArr.length; i++) {\r\n                const eventItem = coalescedEventArr[i];\r\n\r\n                correctedObj.coalescedArr.push({\r\n                    pageX: eventItem.pageX,\r\n                    pageY: eventItem.pageY,\r\n                    movementX: pointerObj.lastPageX === null ? 0 : eventItem.pageX - pointerObj.lastPageX,\r\n                    movementY: pointerObj.lastPageY === null ? 0 : eventItem.pageY - pointerObj.lastPageY,\r\n                    timeStamp: eventItem.timeStamp === 0 ? correctedObj.timeStamp : (eventItem.timeStamp + timeStampOffset), // 0 in firefox\r\n                    pressure: customPressure === null ? normalizePressure(eventItem.pressure) : customPressure\r\n                });\r\n\r\n                pointerObj.lastPageX = eventItem.pageX;\r\n                pointerObj.lastPageY = eventItem.pageY;\r\n            }\r\n\r\n            pointerObj.lastPageX = correctedObj.pageX;\r\n            pointerObj.lastPageY = correctedObj.pageY;\r\n            correctedObj.movementX = totalLastX === null ? 0 : pointerObj.lastPageX - totalLastX;\r\n            correctedObj.movementY = totalLastY === null ? 0 : pointerObj.lastPageY - totalLastY;\r\n\r\n            return correctedObj;\r\n\r\n        }\r\n\r\n        /**\r\n         * creates a value for onPointer, from a pointer event handler\r\n         *\r\n         * @param typeStr string - 'pointerdown'|'pointermove'|'pointerup'\r\n         * @param correctedEvent - corrected pointer event from correctPointerEvent()\r\n         * @param custom - object for setting custom attributes\r\n         * @returns {{pointerId: number, pointerType: *, dX: (*), relY: number, dY: (*), relX: number, type: *, event: *, pageY: *, pageX: *}}\r\n         */\r\n        function createPointerOutEvent(typeStr, correctedEvent, custom?) {\r\n            const result: any = {\r\n                type: typeStr,\r\n                pointerId: correctedEvent.pointerId,\r\n                pointerType: correctedEvent.pointerType,\r\n                pageX: correctedEvent.pageX,\r\n                pageY: correctedEvent.pageY,\r\n                relX: correctedEvent.pageX - offsetObj.x,\r\n                relY: correctedEvent.pageY - offsetObj.y,\r\n                dX: correctedEvent.movementX,\r\n                dY: correctedEvent.movementY,\r\n                time: correctedEvent.timeStamp,\r\n                eventPreventDefault: correctedEvent.eventPreventDefault,\r\n                eventStopPropagation: correctedEvent.eventStopPropagation\r\n            };\r\n\r\n            if (typeStr === 'pointermove') {\r\n                result.coalescedArr = [];\r\n                if (correctedEvent.coalescedArr.length > 1) {\r\n                    let coalescedItem;\r\n                    for (let i = 0; i < correctedEvent.coalescedArr.length; i++) {\r\n                        coalescedItem = correctedEvent.coalescedArr[i];\r\n                        result.coalescedArr.push({\r\n                            pageX: coalescedItem.pageX,\r\n                            pageY: coalescedItem.pageY,\r\n                            relX: coalescedItem.pageX - offsetObj.x,\r\n                            relY: coalescedItem.pageY - offsetObj.y,\r\n                            dX: coalescedItem.movementX,\r\n                            dY: coalescedItem.movementY,\r\n                            time: coalescedItem.timeStamp\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (custom) {\r\n                const keyArr = Object.keys(custom);\r\n                for (let i = 0; i < keyArr.length; i++) {\r\n                    result[keyArr[i]] = custom[keyArr[i]];\r\n                }\r\n            }\r\n\r\n            return result;\r\n        }\r\n\r\n        /**\r\n         * creates a value for onPointer, from a fallback touch event handler\r\n         *\r\n         * @param typeStr string - 'pointerdown'|'pointermove'|'pointerup'\r\n         * @param touchListItem - element from changed touch list\r\n         * @param touchEvent - touch event\r\n         * @param custom - object for setting custom attributes\r\n         * @returns {{pointerId: number, pointerType: string, relY: number, relX: number, type: *, event: *, pageY: *, pageX: *}}\r\n         */\r\n        function createTouchOutEvent(typeStr, touchListItem, touchEvent, custom) {\r\n            const result: any = {\r\n                type: typeStr,\r\n                pointerId: touchListItem.identifier,\r\n                pointerType: 'touch',\r\n                pageX: touchListItem.pageX,\r\n                pageY: touchListItem.pageY,\r\n                relX: touchListItem.pageX - offsetObj.x,\r\n                relY: touchListItem.pageY - offsetObj.y,\r\n                time: touchEvent.timeStamp + timeStampOffset,\r\n                eventPreventDefault: function() { touchEvent.preventDefault(); },\r\n                eventStopPropagation: function() { touchEvent.stopPropagation(); }\r\n            };\r\n\r\n            if (typeStr === 'pointermove') {\r\n                result.coalescedArr = [];\r\n            }\r\n\r\n            const keyArr = Object.keys(custom);\r\n            for (let i = 0; i < keyArr.length; i++) {\r\n                result[keyArr[i]] = custom[keyArr[i]];\r\n            }\r\n\r\n            return result;\r\n        }\r\n\r\n        function setupDocumentListeners() {\r\n            addEventListener(document, 'pointermove', onGlobalPointerMove);\r\n            addEventListener(document, 'pointerup', onGlobalPointerUp);\r\n            addEventListener(document, 'pointerleave', onGlobalPointerLeave);\r\n        }\r\n\r\n        function destroyDocumentListeners() {\r\n            removeEventListener(document, 'pointermove', onGlobalPointerMove);\r\n            removeEventListener(document, 'pointerup', onGlobalPointerUp);\r\n            removeEventListener(document, 'pointerleave', onGlobalPointerLeave);\r\n        }\r\n\r\n        let isOverCounter = 0; // might be multiple pointers\r\n        function onPointerEnter() {\r\n            isOverCounter++;\r\n            if (onEnterLeaveCallback) {\r\n                onEnterLeaveCallback(true);\r\n            }\r\n        }\r\n\r\n        function onPointerLeave() {\r\n            isOverCounter--;\r\n            if (onEnterLeaveCallback) {\r\n                onEnterLeaveCallback(false);\r\n            }\r\n        }\r\n\r\n        function onPointermove(event) {\r\n            event = correctPointerEvent(event);\r\n\r\n            const tempLastPointerType = lastPointerType;\r\n            lastPointerType = event.pointerType;\r\n\r\n            if (dragPointerIdArr.includes(event.pointerId) || dragPointerIdArr.length === maxPointers || event.pointerType === 'touch') {\r\n                didSkip = false;\r\n                return;\r\n            }\r\n            updateOffset();\r\n\r\n            // chrome input glitch workaround - throws in a random mouse event with the wrong position when using a stylus\r\n            if (!didSkip && event.pointerType === 'mouse' && tempLastPointerType === 'pen') {\r\n                didSkip = true;\r\n                return;\r\n            }\r\n            didSkip = false;\r\n\r\n            const outEvent = createPointerOutEvent('pointermove', event);\r\n            onPointerCallback(outEvent);\r\n\r\n        }\r\n\r\n        function onPointerdown(event) {\r\n            //BB.throwOut('pointerdown ' + event.pointerId + ' | ' + dragPointerIdArr.length);\r\n            event = correctPointerEvent(event);\r\n            ////console.log('debug: ' + event.pointerId + ' pointerdown');\r\n            if (dragPointerIdArr.includes(event.pointerId) || dragPointerIdArr.length === maxPointers || !([1, 2, 4].includes(event.buttons))) {\r\n                //BB.throwOut('pointerdown ignored');\r\n                return;\r\n            }\r\n            updateOffset();\r\n\r\n\r\n            //set up global listeners\r\n            if (dragObjArr.length === 0) {\r\n                setupDocumentListeners();\r\n            }\r\n            const dragObj = {\r\n                pointerId: event.pointerId,\r\n                pointerType: event.pointerType,\r\n                downPageX: event.pageX,\r\n                downPageY: event.pageY,\r\n                buttons: event.buttons,\r\n                lastPageX: event.pageX,\r\n                lastPageY: event.pageY,\r\n                lastTimeStamp: event.timeStamp\r\n            };\r\n            dragObjArr.push(dragObj);\r\n            setTouchTimeout(dragObj);\r\n            dragPointerIdArr.push(event.pointerId);\r\n\r\n            const outEvent = createPointerOutEvent('pointerdown', event, {\r\n                downPageX: event.pageX,\r\n                downPageY: event.pageY,\r\n                button: buttonsToStr[event.buttons],\r\n                pressure: event.pressure\r\n            });\r\n\r\n            onPointerCallback(outEvent);\r\n        }\r\n\r\n\r\n        function onGlobalPointerMove(event) {\r\n            //BB.throwOut('pointermove ' + event.pointerId);\r\n            event = correctPointerEvent(event);\r\n            ////console.log('debug: ' + event.pointerId + ' GLOBALpointermove');\r\n            if (!(dragPointerIdArr.includes(event.pointerId))) {\r\n                return;\r\n            }\r\n            updateOffset();\r\n\r\n            const dragObj = getDragObj(event.pointerId);\r\n            clearTouchTimeout(dragObj);\r\n\r\n            //if pointer changes button its pressing -> turn into pointerup\r\n            if (event.buttons !== dragObj.buttons) {\r\n                //pointer up\r\n\r\n                //remove listener\r\n                if (dragObjArr.length === 1) {\r\n                    destroyDocumentListeners();\r\n                }\r\n                removeDragObj(event.pointerId);\r\n\r\n                const outEvent = createPointerOutEvent('pointerup', event, {\r\n                    downPageX: dragObj.downPageX,\r\n                    downPageY: dragObj.downPageY\r\n                });\r\n                onPointerCallback(outEvent);\r\n                return;\r\n\r\n            }\r\n\r\n            setTouchTimeout(dragObj);\r\n\r\n            // ipad likes to do this\r\n            if (\r\n                event.pointerType === 'pen' &&\r\n                event.pageX === dragObj.lastPageX &&\r\n                event.pageY === dragObj.lastPageY &&\r\n                event.timeStamp === dragObj.lastTimeStamp\r\n            ) {\r\n                //ignore\r\n                return;\r\n            }\r\n\r\n            const outEvent = createPointerOutEvent('pointermove', event, {\r\n                downPageX: dragObj.downPageX,\r\n                downPageY: dragObj.downPageY,\r\n                button: buttonsToStr[event.buttons],\r\n                pressure: event.pressure\r\n            });\r\n\r\n            dragObj.lastPageX = event.pageX;\r\n            dragObj.lastPageY = event.pageY;\r\n            dragObj.lastTimeStamp = event.timeStamp;\r\n\r\n            onPointerCallback(outEvent);\r\n\r\n        }\r\n\r\n        function onGlobalPointerUp(event) {\r\n            //BB.throwOut('pointerup ' + event.pointerId);\r\n            event = correctPointerEvent(event);\r\n            ////console.log('debug: ' + event.pointerId + ' GLOBALpointerup');\r\n            if (!(dragPointerIdArr.includes(event.pointerId))) {\r\n                return;\r\n            }\r\n            updateOffset();\r\n\r\n            //remove listener\r\n            if (dragObjArr.length === 1) {\r\n                destroyDocumentListeners();\r\n            }\r\n            const dragObj = removeDragObj(event.pointerId);\r\n            clearTouchTimeout(dragObj);\r\n\r\n            const outEvent = createPointerOutEvent('pointerup', event, {\r\n                downPageX: dragObj.downPageX,\r\n                downPageY: dragObj.downPageY\r\n            });\r\n            onPointerCallback(outEvent);\r\n\r\n        }\r\n\r\n        function onGlobalPointerLeave(event) {\r\n            //BB.throwOut('pointerleave ' + event.pointerId);\r\n            event = correctPointerEvent(event);\r\n            ////console.log('debug: ' + event.pointerId + ' onGlobalPointerLeave', event);\r\n            if (!(dragPointerIdArr.includes(event.pointerId))) { //} || event.target !== document) {\r\n                return;\r\n            }\r\n            updateOffset();\r\n\r\n            //remove listener\r\n            if (dragObjArr.length === 1) {\r\n                destroyDocumentListeners();\r\n            }\r\n            const dragObj = removeDragObj(event.pointerId);\r\n            clearTouchTimeout(dragObj);\r\n\r\n            const outEvent = createPointerOutEvent('pointerup', event, {\r\n                downPageX: dragObj.downPageX,\r\n                downPageY: dragObj.downPageY\r\n            });\r\n            onPointerCallback(outEvent);\r\n        }\r\n\r\n\r\n        /*\r\n        --- ipad pointer event glitch damage control ---\r\n\r\n        ipad pointer events are glitchy. doesn't always fire pointerup.\r\n        - when two fingers get really close to each other\r\n        - when finger moves out and back in bottom\r\n\r\n        This artificially fires a pointerup\r\n        */\r\n        function onTouchTimeout(dragObj) {\r\n\r\n            //create fake event\r\n            const fakeEvent = {\r\n                pointerId: dragObj.pointerId,\r\n                pointerType: dragObj.pointerType,\r\n                type: 'pointerup',\r\n                timeStamp: performance.now(),\r\n                pageX: 0,\r\n                pageY: 0,\r\n                preventDefault: function () {\r\n                },\r\n                stopPropagation: function () {\r\n                }\r\n            };\r\n\r\n            //call onGlobalPointerUp with it\r\n            onGlobalPointerUp(fakeEvent);\r\n        }\r\n\r\n        function setTouchTimeout(dragObj) {\r\n            if (dragObj.pointerType !== 'touch') {\r\n                return;\r\n            }\r\n            dragObj.touchTimeout = setTimeout(function () {\r\n                onTouchTimeout(dragObj);\r\n            }, 2500); // 2.5 seconds\r\n        }\r\n\r\n        function clearTouchTimeout(dragObj) {\r\n            if (!dragObj.touchTimeout) {\r\n                return;\r\n            }\r\n            clearTimeout(dragObj.touchTimeout);\r\n            dragObj.touchTimeout = null;\r\n        }\r\n\r\n\r\n        if (onEnterLeaveCallback) {\r\n            addEventListener(targetElement, 'pointerenter', onPointerEnter);\r\n            addEventListener(targetElement, 'pointerleave', onPointerLeave);\r\n        }\r\n        if (onPointerCallback) {\r\n            addEventListener(targetElement, 'pointermove', onPointermove);\r\n            addEventListener(targetElement, 'pointerdown', onPointerdown);\r\n        }\r\n        if (onWheelCallback) {\r\n            addEventListener(targetElement, 'wheel', wheelCleaner.process);\r\n        }\r\n\r\n\r\n        let onTouchstart;\r\n        let onTouchmove;\r\n        let onTouchend;\r\n\r\n        // --- touch fallback ---\r\n        if (!(hasPointerEvents)) {\r\n\r\n            onTouchstart = function (event) {\r\n                ////console.log('onTouchstart', event, event.changedTouches.length);\r\n                event.preventDefault(); // needs to stay, otherwise page scrolls on iOS12\r\n                updateOffset();\r\n\r\n                const touchArr = event.changedTouches;\r\n                for (let i = 0; i < touchArr.length && dragObjArr.length < maxPointers; i++) {\r\n                    const touchObj = touchArr[i];\r\n\r\n                    //set up global listeners\r\n                    if (dragObjArr.length === 0) {\r\n                        addEventListener(document, 'touchmove', onTouchmove);\r\n                        addEventListener(document, 'touchend', onTouchend);\r\n                        addEventListener(document, 'touchcancel', onTouchend);\r\n                    }\r\n                    dragObjArr.push({\r\n                        pointerId: touchObj.identifier,\r\n                        downPageX: touchObj.pageX,\r\n                        downPageY: touchObj.pageY,\r\n                        buttons: 1,\r\n                        lastPageX: touchObj.pageX,\r\n                        lastPageY: touchObj.pageY,\r\n                    });\r\n                    dragPointerIdArr.push(touchObj.identifier);\r\n\r\n                    const outEvent = createTouchOutEvent('pointerdown', touchObj, event, {\r\n                        dX: 0,\r\n                        dY: 0,\r\n                        downPageX: touchObj.downPageX,\r\n                        downPageY: touchObj.downPageY,\r\n                        button: 'left',\r\n                        pressure: 1\r\n                    });\r\n                    onPointerCallback(outEvent);\r\n                }\r\n\r\n            }\r\n\r\n            onTouchmove = function (event) {\r\n                event.preventDefault(); // needs to stay, otherwise page scrolls on iOS12\r\n                updateOffset();\r\n\r\n\r\n                const touchArr = event.changedTouches;\r\n                for (let i = 0; i < touchArr.length; i++) {\r\n                    const touchObj = touchArr[i];\r\n\r\n                    if (!(dragPointerIdArr.includes(touchObj.identifier))) {\r\n                        continue;\r\n                    }\r\n                    const dragObj = getDragObj(touchObj.identifier);\r\n\r\n                    const outEvent = createTouchOutEvent('pointermove', touchObj, event, {\r\n                        dX: touchObj.pageX - dragObj.lastPageX,\r\n                        dY: touchObj.pageY - dragObj.lastPageY,\r\n                        downPageX: dragObj.downPageX,\r\n                        downPageY: dragObj.downPageY,\r\n                        button: 'left',\r\n                        isCoalesced: false,\r\n                        pressure: 1\r\n                    });\r\n                    dragObj.lastPageX = touchObj.pageX;\r\n                    dragObj.lastPageY = touchObj.pageY;\r\n                    onPointerCallback(outEvent);\r\n\r\n                }\r\n\r\n            }\r\n\r\n            onTouchend = function (event) {\r\n                if (event.type !== 'touchcancel') {\r\n                    event.preventDefault(); // needs to stay, otherwise page scrolls on iOS12\r\n                }\r\n                updateOffset();\r\n\r\n\r\n                const touchArr = event.changedTouches;\r\n                for (let i = 0; i < touchArr.length; i++) {\r\n                    const touchObj = touchArr[i];\r\n\r\n                    if (!(dragPointerIdArr.includes(touchObj.identifier))) {\r\n                        continue;\r\n                    }\r\n\r\n                    //remove listener\r\n                    if (dragObjArr.length === 1) {\r\n                        removeEventListener(document, 'touchmove', onTouchmove);\r\n                        removeEventListener(document, 'touchend', onTouchend);\r\n                        removeEventListener(document, 'touchcancel', onTouchend);\r\n                    }\r\n                    const dragObj = removeDragObj(touchObj.identifier);\r\n\r\n                    const outEvent = createTouchOutEvent('pointerup', touchObj, event, {\r\n                        dX: touchObj.pageX - dragObj.lastPageX,\r\n                        dY: touchObj.pageY - dragObj.lastPageY,\r\n                        downPageX: dragObj.downPageX,\r\n                        downPageY: dragObj.downPageY,\r\n                    });\r\n\r\n                    onPointerCallback(outEvent);\r\n                }\r\n\r\n            }\r\n\r\n            if (onPointerCallback) {\r\n                addEventListener(targetElement, 'touchstart', onTouchstart);\r\n            }\r\n\r\n        } else if(p.fixScribble) {\r\n            //ipad scribble workaround https://developer.apple.com/forums/thread/662874\r\n            onTouchmove = function(e) {\r\n                e.preventDefault();\r\n            }\r\n            addEventListener(targetElement, 'touchmove', onTouchmove);\r\n\r\n        }\r\n\r\n\r\n        // --- interface ---\r\n\r\n        this.isOver = function () {\r\n            return isOverCounter > 0;\r\n        };\r\n\r\n        this.destroy = function () {\r\n            if (isDestroyed) {\r\n                return;\r\n            }\r\n            isDestroyed = true;\r\n            removeEventListener(targetElement, 'pointerenter', onPointerEnter);\r\n            removeEventListener(targetElement, 'pointerleave', onPointerLeave);\r\n            removeEventListener(targetElement, 'pointermove', onPointermove);\r\n            removeEventListener(targetElement, 'pointerdown', onPointerdown);\r\n            removeEventListener(targetElement, 'wheel', wheelCleaner.process);\r\n            if (dragObjArr.length > 0) {\r\n                destroyDocumentListeners();\r\n            }\r\n\r\n            if (!(hasPointerEvents)) {\r\n                removeEventListener(targetElement, 'touchstart', onTouchstart);\r\n                if (dragObjArr.length > 0) {\r\n                    removeEventListener(document, 'touchmove', onTouchmove);\r\n                    removeEventListener(document, 'touchend', onTouchend);\r\n                    removeEventListener(document, 'touchcancel', onTouchend);\r\n                }\r\n            } else {\r\n                removeEventListener(targetElement, 'touchmove', onTouchmove);\r\n            }\r\n        };\r\n\r\n    }\r\n})();","import {IBounds, IVector2D} from '../BB.types';\r\n\r\nexport function mix (x: number, y: number, a: number): number {\r\n    return x * (1 - a) + y * a;\r\n}\r\n\r\nexport function dist (ax: number, ay: number, bx: number, by: number): number {\r\n    return Math.sqrt(Math.pow(ax - bx, 2) + Math.pow(ay - by, 2));\r\n}\r\n\r\nexport function distSquared (ax: number, ay: number, bx: number, by: number): number {\r\n    // faster because no square-root\r\n    return Math.pow(ax - bx, 2) + Math.pow(ay - by, 2);\r\n}\r\n\r\nexport function lenSquared (x: number, y: number): number {\r\n    // faster because no square-root\r\n    return x * x + y * y;\r\n}\r\n\r\nexport function pointsToAngleRad (p1: IVector2D, p2: IVector2D): number {\r\n    return Math.atan2(p2.y - p1.y, p2.x - p1.x);\r\n}\r\n\r\nexport function pointsToAngleDeg (p1: IVector2D, p2: IVector2D): number {\r\n    return pointsToAngleRad(p1, p2) * 180 / Math.PI;\r\n}\r\n\r\nexport function clamp (num: number, min: number, max: number): number {\r\n    return num <= min\r\n        ? min\r\n        : num >= max\r\n            ? max\r\n            : num;\r\n}\r\n\r\nexport function rotate (x: number, y: number, deg: number): IVector2D {\r\n    const theta = deg * (Math.PI / 180);\r\n    const cs = Math.cos(theta);\r\n    const sn = Math.sin(theta);\r\n\r\n    return {\r\n        x: x * cs - y * sn,\r\n        y: x * sn + y * cs\r\n    };\r\n}\r\n\r\nexport function rotateAround (center: IVector2D, point: IVector2D, deg: number): IVector2D {\r\n    const rot = rotate(point.x - center.x, point.y - center.y, deg);\r\n    rot.x += center.x;\r\n    rot.y += center.y;\r\n    return rot;\r\n}\r\n\r\nexport function intDxy(remainder: IVector2D, fDx: number, fDy: number) {\r\n    remainder.x += fDx;\r\n    remainder.y += fDy;\r\n    const dX = Math.round(remainder.x);\r\n    const dY = Math.round(remainder.y);\r\n    remainder.x -= dX;\r\n    remainder.y -= dY;\r\n    return {\r\n        dX,\r\n        dY,\r\n    };\r\n}\r\n\r\n/**\r\n * return closest even number\r\n * @param f\r\n */\r\nexport function roundEven(f: number) {\r\n    if (f % 1 === 0) {\r\n        if (f % 2 === 0) {\r\n            return f;\r\n        }\r\n        return f + 1;\r\n    }\r\n    const above = Math.ceil(f);\r\n    const below = Math.floor(f);\r\n    if (above % 2 === 0) {\r\n        return above;\r\n    } else {\r\n        return below;\r\n    }\r\n}\r\n\r\n/**\r\n * return closest uneven number\r\n * @param f\r\n */\r\nexport function roundUneven(f: number) {\r\n    if (f % 1 === 0) {\r\n        if (f % 2 === 0) {\r\n            return f + 1;\r\n        }\r\n        return f;\r\n    }\r\n    const above = Math.ceil(f);\r\n    const below = Math.floor(f);\r\n    if (above % 2 === 1) {\r\n        return above;\r\n    } else {\r\n        return below;\r\n    }\r\n}\r\n\r\n/**\r\n * update target so it includes bounds\r\n * @param target\r\n * @param bounds\r\n */\r\nexport function updateBounds(target: IBounds, bounds: IBounds): IBounds {\r\n    if (!bounds) {\r\n        return target;\r\n    }\r\n    if (!target) {\r\n        target = { x1: bounds.x1, y1: bounds.y1, x2: bounds.x2, y2: bounds.y2 };\r\n    } else {\r\n        target.x1 = Math.min(target.x1, bounds.x1);\r\n        target.y1 = Math.min(target.y1, bounds.y1);\r\n        target.x2 = Math.max(target.x2, bounds.x2);\r\n        target.y2 = Math.max(target.y2, bounds.y2);\r\n    }\r\n    return target;\r\n}","import {clamp, dist, mix, pointsToAngleRad} from '../math/math';\r\n\r\n\r\ntype ChainOutFunc = (event?) => void;\r\n\r\n/**\r\n * for chaining event processing. useful for gestures (double tap, pinch zoom, max pointer filter).\r\n * each element in the chain might hold back the events, swallow them, or transform them\r\n *\r\n * p = {\r\n *     chainArr: ChainElement[]\r\n * }\r\n *\r\n * chainIn(event): null - feed an event into the chain\r\n * setChainOut(func): void - func(event) <- called when passed through chain\r\n * ^ each ChainElement needs these methods too\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const EventChain = function (p) {\r\n\r\n    const chainArr = p.chainArr;\r\n    let chainOut: ChainOutFunc = () => undefined;\r\n\r\n    function continueChain(i, event) {\r\n        for (; i < chainArr.length; i++) {\r\n            event = chainArr[i].chainIn(event);\r\n            if (event === null) {\r\n                return null;\r\n            }\r\n        }\r\n        chainOut(event);\r\n        return null;\r\n    }\r\n\r\n    for (let i = 0; i < chainArr.length; i++) {\r\n        (function (i) {\r\n            chainArr[i].setChainOut(function (event) {\r\n                continueChain(i + 1, event);\r\n            });\r\n        })(i);\r\n    }\r\n\r\n    // --- interface ---\r\n\r\n    this.chainIn = function (event) {\r\n        return continueChain(0, event);\r\n    };\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * A ChainElement. Detects double taps.\r\n *\r\n * p = {\r\n *     onDoubleTap: function({pageX: number, pageY: number}) - fires when double tap occurs\r\n * }\r\n *\r\n * chainIn\r\n * setChainOut\r\n * setAllowedPointerTypeArr(string[]): void - which pointer types are allowed\r\n * setAllowedButtonArr(string[]): void - which buttons are allowed\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const DoubleTapper = function (p) {\r\n\r\n    let chainOut: ChainOutFunc = function () {\r\n    };\r\n    const minSilenceBeforeDurationMs = 400;\r\n    const maxPressedDurationMs = 300;\r\n    const maxPressedDistancePx = 10;\r\n    const maxInbetweenDistancePx = 19;\r\n    const maxUpToUpDurationMs = 500;\r\n    const maxUntilSecondDownDurationMs = 300;\r\n    const minSilenceAfterMs = 250;\r\n\r\n    let allowedPointerTypeArr = ['touch', 'mouse', 'pen'];\r\n    let allowedButtonArr = ['left'];\r\n\r\n    let sequenceArr = [];\r\n    const pointersDownIdArr = [];\r\n    let lastUpTime = 0;\r\n    let nowTime = 0;\r\n\r\n    let eventQueueArr = [];\r\n\r\n\r\n    function fail() {\r\n        if (sequenceArr.length === 0) { // no gesture started -> can be ignored\r\n            return;\r\n        }\r\n        clearTimeout(timeoutObj.fail);\r\n        clearTimeout(timeoutObj.maxUntilSecondDown);\r\n        clearTimeout(timeoutObj.success);\r\n        timeoutObj.fail = null;\r\n        timeoutObj.maxUntilSecondDown = null;\r\n        timeoutObj.success = null;\r\n\r\n\r\n        for (let i = 0; i < eventQueueArr.length; i++) {\r\n            chainOut(eventQueueArr[i]);\r\n        }\r\n        eventQueueArr = [];\r\n\r\n        sequenceArr = [];\r\n    }\r\n\r\n    // double tap achieved\r\n    function success() {\r\n        timeoutObj.fail = null;\r\n        timeoutObj.success = null;\r\n        eventQueueArr = []; // events get swallowed\r\n        const lastSequenceItem = sequenceArr[sequenceArr.length - 1];\r\n        sequenceArr = [];\r\n        p.onDoubleTap({pageX: lastSequenceItem.pageX, pageY: lastSequenceItem.pageY});\r\n    }\r\n\r\n\r\n    const timeoutObj = {\r\n        fail: null,\r\n        maxUntilSecondDown: null,\r\n        success: null\r\n    };\r\n\r\n    //returns false if time already up. otherwise sets up timeout\r\n    function setupTimeout(timeoutStr, targetFunc, timeMS) {\r\n        const diff = timeMS - nowTime;\r\n        //console.log(fingers + ': ' + timeoutStr + ' diff', diff);\r\n        if (diff <= 0) { // time already up\r\n            return false;\r\n        }\r\n        timeoutObj[timeoutStr] = setTimeout(targetFunc, diff);\r\n        return true;\r\n    }\r\n\r\n\r\n    /**\r\n     * @param event object - a pointer event from BB.PointerListener\r\n     */\r\n    function processEvent(event) {\r\n\r\n        if (event.type === 'pointerdown') {\r\n            pointersDownIdArr.push(event.pointerId);\r\n        } else if (event.type === 'pointerup') {\r\n            for (let i = 0; i < pointersDownIdArr.length; i++) {\r\n                if (pointersDownIdArr[i] === event.pointerId) {\r\n                    pointersDownIdArr.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!allowedPointerTypeArr.includes(event.pointerType)) { //wrong input type -> fail\r\n            //console.log('wrong input type -> fail');\r\n            fail();\r\n            return;\r\n        }\r\n\r\n        nowTime = performance.now();\r\n        const lastSequenceItem = sequenceArr.length > 0 ? sequenceArr[sequenceArr.length - 1] : null;\r\n        if (event.type === 'pointerup') {\r\n            lastUpTime = event.time;\r\n        }\r\n\r\n        if (event.type === 'pointerdown') {\r\n            if (pointersDownIdArr.length > 1) { // more than one pointer down -> fail\r\n                //console.log('more than one pointer down -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n            if (timeoutObj.success !== null) { // silence-after not achieved -> fail\r\n                //console.log('silence-after not achieved -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n            if (sequenceArr.length === 0 && nowTime - lastUpTime < minSilenceBeforeDurationMs) { // silence before not achieved -> fail\r\n                //console.log('silence before not achieved -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n            if (!allowedButtonArr.includes(event.button)) { // wrong button -> fail\r\n                //console.log('wrong button -> fail', event.button, allowedButtonArr);\r\n                fail();\r\n                return;\r\n            }\r\n            if (lastSequenceItem && lastSequenceItem.isDown || sequenceArr.length > 2) { // jumbled -> fail\r\n                //console.log('jumbled -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n            if (lastSequenceItem) {\r\n                const distance = dist(lastSequenceItem.position[0], lastSequenceItem.position[1], event.pageX, event.pageY);\r\n                if (distance > maxInbetweenDistancePx) { //moved too much -> reset\r\n                    //console.log('maxInbetweenDistancePx -> reset');\r\n                    fail();\r\n\r\n                    if (nowTime - lastSequenceItem.time < minSilenceBeforeDurationMs) { //silence before not achieved -> fail\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n            sequenceArr.push({\r\n                isDown: true,\r\n                time: nowTime,\r\n                position: [event.pageX, event.pageY],\r\n                pointerId: event.pointerId\r\n            });\r\n            //maxUntilSecondDown\r\n\r\n            if (sequenceArr.length > 1) {\r\n                clearTimeout(timeoutObj.maxUntilSecondDown);\r\n            } else if (!setupTimeout('maxUntilSecondDown', fail, event.time + maxUntilSecondDownDurationMs)) {\r\n                //console.log('event.time + maxPressedDurationMs -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n\r\n\r\n            clearTimeout(timeoutObj.fail);\r\n            if (!setupTimeout('fail', fail, event.time + maxPressedDurationMs)) {\r\n                //console.log('event.time + maxPressedDurationMs -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n        }\r\n        if (lastSequenceItem && event.type === 'pointermove' && lastSequenceItem.pointerId === event.pointerId) {\r\n            /*if(lastSequenceItem.pointerId !== event.pointerId) { //another pointer mixing in -> fail\r\n                console.log('another pointer mixing in -> fail');\r\n                fail();\r\n                return;\r\n            }*/\r\n            const distance = dist(lastSequenceItem.position[0], lastSequenceItem.position[1], event.pageX, event.pageY);\r\n            if (distance > maxPressedDistancePx) { //moved too much -> fail\r\n                //console.log('maxPressedDistancePx -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n        }\r\n        if (lastSequenceItem && event.type === 'pointerup') {\r\n            if (lastSequenceItem.pointerId !== event.pointerId) { //another pointer mixing in -> fail\r\n                fail();\r\n                return;\r\n            }\r\n            if (nowTime >= lastSequenceItem.time + maxPressedDurationMs) { //pressed too long -> fail\r\n                fail();\r\n                return;\r\n            }\r\n            clearTimeout(timeoutObj.fail);\r\n\r\n            if (sequenceArr.length < 3) {\r\n                if (!setupTimeout('fail', fail, event.time + maxUpToUpDurationMs)) {\r\n                    fail();\r\n                    return;\r\n                }\r\n\r\n                sequenceArr = [\r\n                    lastSequenceItem,\r\n                    {\r\n                        isUp: true,\r\n                        time: nowTime,\r\n                        position: [event.pageX, event.pageY]\r\n                    }\r\n                ];\r\n                return;\r\n            }\r\n\r\n            if (nowTime < sequenceArr[1].time + maxUpToUpDurationMs) {\r\n                // double tap almost success\r\n                // only needs silence\r\n                sequenceArr.push({\r\n                    pageX: event.pageX,\r\n                    pageY: event.pageY\r\n                });\r\n                if (!setupTimeout('success', success, event.time + minSilenceAfterMs)) {\r\n                    fail();\r\n                }\r\n            } else { // time up -> fail\r\n                fail();\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.chainIn = function (event) {\r\n\r\n        processEvent(event);\r\n\r\n        if (sequenceArr.length === 0) { //existing events can not become a double tap\r\n            fail();\r\n            return event;\r\n        }\r\n        // events might become a double tap -> queue\r\n        eventQueueArr.push(event);\r\n        return null;\r\n    };\r\n\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n\r\n    this.setAllowedPointerTypeArr = function (arr) {\r\n        allowedPointerTypeArr = arr;\r\n    };\r\n\r\n    this.setAllowedButtonArr = function (arr) {\r\n        allowedButtonArr = arr;\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * A ChainElement. Detects a single tap, done with N 'touch' pointers\r\n *\r\n * p = {\r\n *      fingers: number - number of fingers\r\n *      onTap: function() - fires when tap occurs\r\n * }\r\n *\r\n * chainIn\r\n * setChainOut\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const NFingerTapper = function (p) {\r\n\r\n    const fingers = p.fingers;\r\n    let chainOut: ChainOutFunc = function () {\r\n    };\r\n\r\n    const minSilenceBeforeDurationMs = 50; //250;\r\n    const maxTapMs = 500;\r\n    const maxFirstLastFingerDownMs = 250;\r\n    const maxPressedDistancePx = 12; //5 + fingers * 5;\r\n    const silenceAfterDurationMs = 250;\r\n\r\n\r\n    /*\r\n        fingerObj = {\r\n            pointerId: number,\r\n            downTime: number,\r\n            downPageX: number,\r\n            downPageY: number,\r\n            isUp: boolean\r\n        }\r\n     */\r\n    let fingerArr = [];\r\n    let firstDownTime;\r\n    let eventQueueArr = [];\r\n    let lastEventTime = 0;\r\n    const pointersDownIdArr = [];\r\n\r\n    function fail() {\r\n        if (eventQueueArr.length === 0) {\r\n            return;\r\n        }\r\n        clearTimeout(timeoutObj.firstLastDownTimeout);\r\n        clearTimeout(timeoutObj.tapTimeout);\r\n        for (let i = 0; i < eventQueueArr.length; i++) {\r\n            chainOut(eventQueueArr[i]);\r\n        }\r\n        eventQueueArr = [];\r\n        fingerArr = [];\r\n    }\r\n\r\n    function success() {\r\n        clearTimeout(timeoutObj.firstLastDownTimeout);\r\n        clearTimeout(timeoutObj.tapTimeout);\r\n        eventQueueArr = []; // events get swallowed\r\n        fingerArr = [];\r\n        p.onTap();\r\n    }\r\n\r\n    let nowTime;\r\n    const timeoutObj = {\r\n        firstLastDownTimeout: null,\r\n        tapTimeout: null\r\n    };\r\n\r\n    function setupTimeout(timeoutStr, timeMS) {\r\n        const diff = timeMS - nowTime;\r\n        //console.log(fingers + ': ' + timeoutStr + ' diff', diff);\r\n        if (diff <= 0) { // time already up\r\n            return false;\r\n        }\r\n        timeoutObj[timeoutStr] = setTimeout(fail, diff);\r\n        return true;\r\n    }\r\n\r\n    function processEvent(event) {\r\n\r\n        const tempLastEventTime = lastEventTime;\r\n        lastEventTime = event.time;\r\n\r\n        if (event.type === 'pointerdown') {\r\n            pointersDownIdArr.push(event.pointerId);\r\n        } else if (event.type === 'pointerup') {\r\n            for (let i = 0; i < pointersDownIdArr.length; i++) {\r\n                if (pointersDownIdArr[i] === event.pointerId) {\r\n                    pointersDownIdArr.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (event.pointerType !== 'touch') {\r\n            if (fingerArr.length > 0) { // already in gesture -> fail\r\n                fail();\r\n            }\r\n            return;\r\n        }\r\n\r\n        nowTime = performance.now();\r\n\r\n        if (event.type === 'pointerdown') {\r\n            //console.log('down');\r\n            if (fingerArr.length + 1 !== pointersDownIdArr.length) { // failed before, and some fingers are still down -> fail\r\n                fail();\r\n                return;\r\n            }\r\n            if (fingerArr.length === fingers) { // too many fingers down -> fail\r\n                //console.log(fingers + ': too many fingers down -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n            if (fingerArr.length > 0 && event.time - maxFirstLastFingerDownMs > fingerArr[0].downTime) { // took too long to touch with all fingers -> fail\r\n                //console.log(fingers + ': took too long to touch with all fingers -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n            if (fingerArr.length === 0 && event.time - minSilenceBeforeDurationMs < tempLastEventTime) { // not enough silence before -> fail\r\n                //console.log(fingers + ': not enough silence before -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n\r\n            if (fingerArr.length === 0) {\r\n                firstDownTime = event.time;\r\n\r\n                if (!setupTimeout('firstLastDownTimeout', event.time + maxFirstLastFingerDownMs) || !setupTimeout('tapTimeout', event.time + maxTapMs)) { // timeouts already up -> fail\r\n                    fail();\r\n                    return;\r\n                }\r\n\r\n            }\r\n            fingerArr.push({\r\n                pointerId: event.pointerId,\r\n                downTime: event.time,\r\n                downPageX: event.pageX,\r\n                downPageY: event.pageY\r\n            });\r\n            return;\r\n\r\n        }\r\n\r\n        if (event.type === 'pointermove') {\r\n\r\n            if (fingerArr.length === 0) {\r\n                //not in a gesture -> ignore\r\n                return;\r\n            }\r\n\r\n            let fingerObj = null;\r\n            for (let i = 0; i < fingerArr.length; i++) {\r\n                if (fingerArr[i].pointerId === event.pointerId) {\r\n                    fingerObj = fingerArr[i];\r\n                    break;\r\n                }\r\n            }\r\n            if (fingerObj === null) { // finger not part of the tap is on screen -> fail\r\n                fail();\r\n                return;\r\n            }\r\n\r\n            if (event.time - maxTapMs > firstDownTime) { // tap took too long -> fail\r\n                //console.log(fingers + ': tap took too long -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n\r\n            const distance = dist(event.pageX, event.pageY, fingerObj.downPageX, fingerObj.downPageY);\r\n            if (distance > maxPressedDistancePx) { // finger moved too much -> fail\r\n                //console.log(fingers + ': a finger moved too much -> fail', distance);\r\n                fail();\r\n                return;\r\n            }\r\n\r\n        }\r\n\r\n        if (event.type === 'pointerup') {\r\n\r\n            if (fingerArr.length === 0) {\r\n                //not in a gesture -> ignore\r\n                return;\r\n            }\r\n\r\n            //console.log('up', event.pageX, event.pageY);\r\n            if (fingerArr.length !== fingers) { // not enough fingers -> fail\r\n                //console.log(fingers + ': not enough fingers -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n\r\n            let fingerObj = null;\r\n            let i = 0;\r\n            for (; i < fingerArr.length; i++) {\r\n                if (fingerArr[i].pointerId === event.pointerId) {\r\n                    fingerObj = fingerArr[i];\r\n                    break;\r\n                }\r\n            }\r\n            if (fingerObj === null) {\r\n                //do nothing\r\n                return;\r\n            }\r\n\r\n            if (event.time - maxTapMs > firstDownTime) { // tap took too long -> fail\r\n                //console.log(fingers + ': tap took too long -> fail');\r\n                fail();\r\n                return;\r\n            }\r\n\r\n            const distance = dist(event.pageX, event.pageY, fingerObj.downPageX, fingerObj.downPageY);\r\n            if (distance > maxPressedDistancePx) { // finger moved too much -> fail\r\n                //console.log(fingers + ': b finger moved too much -> fail', distance, event.pageX, event.pageY);\r\n                //console.log(fingerArr);\r\n                fail();\r\n                return;\r\n            }\r\n\r\n            fingerObj.isUp = true;\r\n\r\n            let allAreUp = true;\r\n            for (let i = 0; i < fingerArr.length; i++) {\r\n                if (!fingerArr[i].isUp) {\r\n                    allAreUp = false;\r\n                    break;\r\n                }\r\n            }\r\n            //console.log('fingerArr', fingerArr);\r\n\r\n            if (allAreUp) { // success\r\n                success();\r\n                return true;\r\n            }\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.chainIn = function (event) {\r\n\r\n        const result = processEvent(event);\r\n\r\n        //console.log(fingerArr.length);\r\n\r\n        if (result === true) {\r\n            //tap success -> event gets swallowed\r\n            return null;\r\n        }\r\n        if (fingerArr.length === 0) {\r\n            return event;\r\n        } else {\r\n            eventQueueArr.push(event);\r\n        }\r\n\r\n        return null;\r\n\r\n    };\r\n\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * A ChainElement. Detects a pinch zooming (2 touch pointers). If one finger lifts, then will use the remaining.\r\n * Further pointers are ignored, but their events get swallowed during the pinching.\r\n * pinching ends when ALL pointers are lifted.\r\n * Events passed through if no pinching.\r\n *\r\n * p = {\r\n *      onPinch: function({type: 'end'} | {\r\n *          type: 'move',\r\n *          relX: number,\r\n *          relY: number,\r\n *          downRelX: number,\r\n *          downRelY: number,\r\n *          angleDeg: number,\r\n *          scale: number\r\n *      }) - fires when pinching occurs\r\n * }\r\n *\r\n * chainIn\r\n * setChainOut\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const PinchZoomer = function (p) {\r\n\r\n    const firstFingerMaxDistancePx = 10;\r\n    const untilSecondFingerDurationMs = 250;\r\n\r\n    let chainOut: ChainOutFunc = function () {\r\n    };\r\n    const pointersDownIdArr = [];\r\n    /*\r\n    gestureObj = {\r\n        touchPointerArr: Array of {\r\n            pointerId: number,\r\n            relX: number,\r\n            relY: number,\r\n            downRelX: number, // only for first\r\n            downRelY: number\r\n        },\r\n        otherPointerIdArr: number[],\r\n        isInProgress: boolean\r\n    }\r\n    */\r\n    let gestureObj = null;\r\n    let eventQueueArr = [];\r\n\r\n\r\n    function end() {\r\n        gestureObj = null;\r\n        eventQueueArr = [];\r\n    }\r\n\r\n    function fail(doSwallow?) {\r\n        if (!gestureObj) { // no gesture happening -> ignore\r\n            return;\r\n        }\r\n\r\n        clearTimeout(timeoutObj.secondFingerTimeout);\r\n        if (!doSwallow) {\r\n            for (let i = 0; i < eventQueueArr.length; i++) {\r\n                chainOut(eventQueueArr[i]);\r\n            }\r\n        }\r\n        end();\r\n    }\r\n\r\n\r\n    let nowTime;\r\n    const timeoutObj = {\r\n        secondFingerTimeout: null\r\n    };\r\n\r\n    function setupTimeout(timeoutStr, targetFunc, timeMS) {\r\n        const diff = timeMS - nowTime;\r\n        if (diff <= 0) { // time already up\r\n            return false;\r\n        }\r\n        timeoutObj[timeoutStr] = setTimeout(targetFunc, diff);\r\n        return true;\r\n    }\r\n\r\n\r\n    function processEvent(event) {\r\n\r\n        if (event.type === 'pointerdown') {\r\n            pointersDownIdArr.push(event.pointerId);\r\n\r\n        } else if (event.type === 'pointerup') {\r\n            for (let i = 0; i < pointersDownIdArr.length; i++) {\r\n                if (pointersDownIdArr[i] === event.pointerId) {\r\n                    pointersDownIdArr.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        //pass through scenarios\r\n        if (\r\n            !gestureObj && (\r\n                event.pointerType !== 'touch' || // wrong pointer type\r\n                (event.type === 'pointermove' && pointersDownIdArr.length > 0) || // failed before\r\n                pointersDownIdArr.length > 1 || // failed before\r\n                event.type === 'pointerup' // failed before\r\n            )\r\n        ) {\r\n            return;\r\n        }\r\n\r\n        nowTime = performance.now();\r\n\r\n\r\n        //pointer down\r\n        if (event.type === 'pointerdown') {\r\n\r\n            if (gestureObj) {\r\n                if (event.pointerType === 'touch') { // touch finger down - as nth pointer\r\n\r\n                    gestureObj.touchPointerArr.push({\r\n                        pointerId: event.pointerId,\r\n                        relX: event.relX,\r\n                        relY: event.relY\r\n                    });\r\n\r\n                    if (gestureObj.isInProgress) {\r\n                        continuePinch(gestureObj, {\r\n                            type: 'down',\r\n                            index: gestureObj.touchPointerArr.length - 1\r\n                        });\r\n                    } else {\r\n                        clearTimeout(timeoutObj.secondFingerTimeout);\r\n                        gestureObj.isInProgress = true;\r\n                        beginPinch(gestureObj);\r\n                    }\r\n                    return;\r\n\r\n                } else { // non-touch finger down - as nth pointer\r\n\r\n                    if (gestureObj.isInProgress) {\r\n                        gestureObj.otherPointerIdArr.push(event.pointerId);\r\n                    } else { // second pointer wrong type -> fail\r\n                        fail();\r\n                    }\r\n                    return;\r\n                }\r\n\r\n\r\n            } else {\r\n                // first finger down - can only be touch if no gestureObj\r\n                gestureObj = {\r\n                    touchPointerArr: [{\r\n                        pointerId: event.pointerId,\r\n                        relX: event.relX,\r\n                        relY: event.relY,\r\n                        downRelX: event.relX,\r\n                        downRelY: event.relY\r\n                    }],\r\n                    otherPointerIdArr: [],\r\n                    isInProgress: false\r\n                };\r\n                if (!setupTimeout('secondFingerTimeout', function () {\r\n                    fail();\r\n                }, event.time + untilSecondFingerDurationMs)) { // time ran out -> fail\r\n                    fail();\r\n                    return;\r\n                }\r\n                return;\r\n            }\r\n\r\n        }\r\n\r\n\r\n        //pointer move\r\n        if (event.type === 'pointermove' && event.pointerType === 'touch') {\r\n            //gesture object should always exist here\r\n\r\n            let touchPointerObj = null;\r\n            let i = 0;\r\n            for (; i < gestureObj.touchPointerArr.length; i++) {\r\n                if (event.pointerId === gestureObj.touchPointerArr[i].pointerId) {\r\n                    touchPointerObj = gestureObj.touchPointerArr[i];\r\n                    break;\r\n                }\r\n            }\r\n\r\n            //null should not be possible\r\n\r\n            touchPointerObj.relX = event.relX;\r\n            touchPointerObj.relY = event.relY;\r\n\r\n            if (!gestureObj.isInProgress) { // only one finger down & pinching hasn't started\r\n                const distance = dist(touchPointerObj.downRelX, touchPointerObj.downRelY, touchPointerObj.relX, touchPointerObj.relY);\r\n                if (distance > firstFingerMaxDistancePx) { // moved too much -> fail\r\n                    fail();\r\n                    return;\r\n                }\r\n\r\n            } else {\r\n                if (i < 2) { // only first two touches can affect pinching\r\n                    continuePinch(gestureObj, {\r\n                        type: 'move',\r\n                        index: i\r\n                    });\r\n                }\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n\r\n        //pointer up\r\n        if (event.type === 'pointerup') {\r\n            //gesture object should always exist here\r\n\r\n            if (event.pointerType === 'touch') {\r\n                let i = 0;\r\n                for (; i < gestureObj.touchPointerArr.length; i++) {\r\n                    if (gestureObj.touchPointerArr[i].pointerId === event.pointerId) {\r\n                        gestureObj.touchPointerArr.splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n                if (gestureObj.touchPointerArr.length > 0) {\r\n                    continuePinch(gestureObj, {\r\n                        type: 'up',\r\n                        index: i\r\n                    });\r\n                }\r\n\r\n            } else { // non-touch\r\n                for (let i = 0; i < gestureObj.otherPointerIdArr.length; i++) {\r\n                    if (gestureObj.otherPointerIdArr[i] === event.pointerId) {\r\n                        gestureObj.otherPointerIdArr.splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            //all fingers lifted?\r\n            if (gestureObj.touchPointerArr.length === 0 && gestureObj.otherPointerIdArr.length === 0) {\r\n                if (gestureObj.isInProgress) { // lifted last finger -> end of pinching\r\n                    end();\r\n                    endPinch();\r\n                } else { // lifted finger again before pinching started -> fail\r\n                    fail();\r\n                }\r\n                return;\r\n            }\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    // --- actual pinch transform logic ---\r\n\r\n    let pincherArr = [];\r\n\r\n    function beginPinch(gestureObj) {\r\n\r\n        for (let i = 0; i < gestureObj.touchPointerArr.length; i++) {\r\n            const pointerObj = gestureObj.touchPointerArr[i];\r\n            pincherArr.push({\r\n                pointerId: pointerObj.pointerId,\r\n                relX: pointerObj.relX,\r\n                relY: pointerObj.relY,\r\n                downRelX: pointerObj.relX,\r\n                downRelY: pointerObj.relY\r\n            });\r\n        }\r\n\r\n        const event: any = {\r\n            type: 'move',\r\n            angleRad: 0,\r\n            scale: 1\r\n        };\r\n\r\n        if (pincherArr.length === 1) {\r\n            event.relX = pincherArr[0].downRelX;\r\n            event.relY = pincherArr[0].downRelY;\r\n        } else {\r\n            event.relX = 0.5 * (pincherArr[0].downRelX + pincherArr[1].downRelX);\r\n            event.relY = 0.5 * (pincherArr[0].downRelY + pincherArr[1].downRelY);\r\n        }\r\n        event.downRelX = event.relX;\r\n        event.downRelY = event.relY;\r\n\r\n        p.onPinch(event);\r\n\r\n    }\r\n\r\n    //actionObj = {type: 'down'|'move'|'up', index: number}\r\n    function continuePinch(gestureObj, actionObj) {\r\n\r\n        if (actionObj.index > 1) { // only first two pointers matter\r\n            return;\r\n        }\r\n\r\n        if (actionObj.type === 'move') {\r\n\r\n            let event;\r\n            pincherArr[actionObj.index].relX = gestureObj.touchPointerArr[actionObj.index].relX;\r\n            pincherArr[actionObj.index].relY = gestureObj.touchPointerArr[actionObj.index].relY;\r\n\r\n            if (pincherArr.length === 1) {\r\n\r\n                event = {\r\n                    type: 'move',\r\n                    downRelX: pincherArr[0].downRelX,\r\n                    downRelY: pincherArr[0].downRelY,\r\n                    relX: pincherArr[0].relX,\r\n                    relY: pincherArr[0].relY,\r\n                    angleRad: 0,\r\n                    scale: 1\r\n                };\r\n\r\n            } else {\r\n\r\n                const startDist = dist(pincherArr[0].downRelX, pincherArr[0].downRelY, pincherArr[1].downRelX, pincherArr[1].downRelY);\r\n                const distance = dist(pincherArr[0].relX, pincherArr[0].relY, pincherArr[1].relX, pincherArr[1].relY);\r\n\r\n                const startAngle = pointsToAngleRad({\r\n                    x: pincherArr[0].downRelX,\r\n                    y: pincherArr[0].downRelY\r\n                }, {x: pincherArr[1].downRelX, y: pincherArr[1].downRelY});\r\n                const angle = pointsToAngleRad({\r\n                    x: pincherArr[0].relX,\r\n                    y: pincherArr[0].relY\r\n                }, {x: pincherArr[1].relX, y: pincherArr[1].relY});\r\n\r\n                event = {\r\n                    type: 'move',\r\n                    downRelX: 0.5 * (pincherArr[0].downRelX + pincherArr[1].downRelX),\r\n                    downRelY: 0.5 * (pincherArr[0].downRelY + pincherArr[1].downRelY),\r\n                    relX: 0.5 * (pincherArr[0].relX + pincherArr[1].relX),\r\n                    relY: 0.5 * (pincherArr[0].relY + pincherArr[1].relY),\r\n                    angleRad: angle - startAngle,\r\n                    scale: distance / startDist\r\n                };\r\n\r\n            }\r\n\r\n            p.onPinch(event);\r\n\r\n        } else if (actionObj.type === 'down' || actionObj.type === 'up') {\r\n            endPinch();\r\n            beginPinch(gestureObj);\r\n        }\r\n\r\n    }\r\n\r\n    function endPinch() {\r\n        pincherArr = [];\r\n        p.onPinch({\r\n            type: 'end'\r\n        });\r\n    }\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.chainIn = function (event) {\r\n        processEvent(event);\r\n        if (gestureObj) {\r\n            if (!gestureObj.isInProgress) { // might still fail -> into queue\r\n                eventQueueArr.push(event);\r\n            }\r\n        } else {\r\n            return event;\r\n        }\r\n        return null;\r\n    };\r\n\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * A ChainElement. Splits up coalesced events into their own pointermove events. Otherwise regular pass through.\r\n *\r\n * @constructor\r\n */\r\nexport const CoalescedExploder = function () {\r\n\r\n    let chainOut: ChainOutFunc = function () {\r\n    };\r\n\r\n    // --- interface ---\r\n\r\n    this.chainIn = function (event) {\r\n\r\n        if (event.type === 'pointermove') {\r\n\r\n            if (event.coalescedArr.length > 0) {\r\n\r\n                let eventCopy = JSON.parse(JSON.stringify(event));\r\n                eventCopy.coalescedArr = [];\r\n                let coalescedItem;\r\n\r\n                for (let i = 0; i < event.coalescedArr.length; i++) {\r\n\r\n                    if (i > 0) {\r\n                        eventCopy = JSON.parse(JSON.stringify(event));\r\n                    }\r\n                    coalescedItem = event.coalescedArr[i];\r\n\r\n                    eventCopy.pageX = coalescedItem.pageX;\r\n                    eventCopy.pageY = coalescedItem.pageY;\r\n                    eventCopy.relX = coalescedItem.relX;\r\n                    eventCopy.relY = coalescedItem.relY;\r\n                    eventCopy.dX = coalescedItem.dX;\r\n                    eventCopy.dY = coalescedItem.dY;\r\n                    eventCopy.time = coalescedItem.time;\r\n                    if (i < event.coalescedArr.length - 1) {\r\n                        eventCopy.isCoalesced = true;\r\n                    }\r\n\r\n                    chainOut(eventCopy);\r\n                }\r\n\r\n            } else {\r\n                return event;\r\n            }\r\n        } else {\r\n            return event;\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n};\r\n\r\nexport const OnePointerLimiter = function (pointers?) {\r\n\r\n    let chainOut: ChainOutFunc = function () {\r\n    };\r\n\r\n    let downPointerId = null;\r\n    const ignorePointerIdArr = [];\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.chainIn = function (event) {\r\n\r\n        if (ignorePointerIdArr.includes(event.pointerId)) {\r\n            if (event.type === 'pointerup') {\r\n                for (let i = 0; i < ignorePointerIdArr.length; i++) {\r\n                    if (ignorePointerIdArr[i] === event.pointerId) {\r\n                        ignorePointerIdArr.splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n\r\n        if (downPointerId === null) {\r\n            if (event.type === 'pointerdown') {\r\n                downPointerId = event.pointerId;\r\n            }\r\n            return event;\r\n\r\n        } else {\r\n            if (event.pointerId !== downPointerId) {\r\n                if (event.type === 'pointerdown') {\r\n                    ignorePointerIdArr.push(event.pointerId);\r\n                }\r\n                return null;\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                downPointerId = null;\r\n            }\r\n            return event;\r\n        }\r\n\r\n        return null;\r\n\r\n    };\r\n\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n\r\n};\r\n\r\n\r\n/**\r\n * Not really and event chain element. but pretty similar.\r\n *\r\n * Processes draw input events. When shift held -> linetool\r\n * line events - what KlCanvasWorkspace passes onDraw(e)\r\n *\r\n * p = {\r\n *     onDraw: function(drawEvent)\r\n * }\r\n *\r\n * pass input in with process(drawEvent)\r\n *\r\n * modifies draw event to include such events:\r\n * {\r\n *     type: 'line',\r\n *     x0: null, // you have to fill that in\r\n *     y0: null, // you have to fill that in\r\n *     pressure0: null, // you have to fill that in\r\n *     x1: number,\r\n *     y1: number,\r\n *     pressure1: number\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const LinetoolProcessor = function (p) {\r\n\r\n    let downEvent = null;\r\n    let eventQueue = [];\r\n    let direction = null;\r\n    const DIR_X = 0, DIR_Y = 1;\r\n\r\n    this.process = function (event) {\r\n        if (event.type === 'down') {\r\n            downEvent = event;\r\n            direction = null;\r\n\r\n            if (event.shiftIsPressed) {\r\n\r\n                p.onDraw({\r\n                    type: 'line',\r\n                    x0: null,\r\n                    y0: null,\r\n                    pressure0: null,\r\n                    x1: event.x,\r\n                    y1: event.y,\r\n                    pressure1: event.pressure\r\n                });\r\n\r\n                eventQueue.push(event);\r\n                return;\r\n            }\r\n\r\n        }\r\n\r\n        if (event.type === 'move') {\r\n\r\n            if (event.shiftIsPressed) {\r\n\r\n                if (direction === null) {\r\n                    const dX = Math.abs(event.x - downEvent.x);\r\n                    const dY = Math.abs(event.y - downEvent.y);\r\n\r\n                    if (dX > 5 || dY > 5) {\r\n                        direction = dX > dY ? DIR_X : DIR_Y;\r\n\r\n                        for (let i = 0; i < eventQueue.length; i++) {\r\n                            const e = eventQueue[i];\r\n                            if (direction === DIR_X) {\r\n                                e.y = downEvent.y;\r\n                            } else {\r\n                                e.x = downEvent.x;\r\n                            }\r\n                            p.onDraw(JSON.parse(JSON.stringify(e)));\r\n                        }\r\n                        eventQueue = [];\r\n                    }\r\n                }\r\n\r\n                if (direction === null) {\r\n                    eventQueue.push(event);\r\n                    return;\r\n                }\r\n\r\n                if (direction === DIR_X) {\r\n                    event.y = downEvent.y;\r\n                } else {\r\n                    event.x = downEvent.x;\r\n                }\r\n\r\n            } else {\r\n                if (eventQueue.length > 0) {\r\n                    for (let i = 0; i < eventQueue.length; i++) {\r\n                        p.onDraw(JSON.parse(JSON.stringify(eventQueue[i])));\r\n                    }\r\n                    eventQueue = [];\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        if (event.type === 'up') {\r\n            eventQueue = [];\r\n        }\r\n\r\n        p.onDraw(JSON.parse(JSON.stringify(event)));\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * cleans up DrawEvents. More trustworthy events. EventChain element\r\n *\r\n * that events can only go line this: down -> n x move -> up\r\n * so, sanitizes this: down, down, down. becomes only one down. the other downs are ignored/swallowed\r\n * @constructor\r\n */\r\nexport const LineSanitizer = function () {\r\n\r\n    let chainOut: ChainOutFunc = function () {\r\n    };\r\n\r\n    let isDrawing = false;\r\n\r\n    // --- interface ---\r\n    this.chainIn = function (event) {\r\n\r\n        if (event.type === 'down') {\r\n            if (isDrawing) {\r\n                //console.log('line sanitizer - down, but already drawing');\r\n                chainOut({\r\n                    type: 'up',\r\n                    scale: event.scale,\r\n                    shiftIsPressed: event.shiftIsPressed,\r\n                    isCoalesced: false\r\n                });\r\n            } else {\r\n                isDrawing = true;\r\n            }\r\n        }\r\n        if (!isDrawing && (event.type === 'move' || event.type === 'up')) {\r\n            //console.log('line sanitizer - ' + event.type + ' but not drawing');\r\n            return null;\r\n        }\r\n\r\n        if (event.type === 'up' && isDrawing) {\r\n            isDrawing = false;\r\n        }\r\n\r\n        return event;\r\n    };\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n    this.getIsDrawing = function () {\r\n        return isDrawing;\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * Line smoothing. EventChain element. Smoothing via blending new position with old position.\r\n * for onDraw events from KlCanvasWorkspace.\r\n *\r\n * p = {\r\n *     smoothing: number, // 0-1, 0: no smoothing, 1: 100% smoothing -> would never catch up\r\n * }\r\n *\r\n * smoothing > 0: will fire DrawEvents in interval when no new move events\r\n *\r\n * type: 'line' Events are just passed through.\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const LineSmoothing = function (p) {\r\n\r\n    let chainOut: ChainOutFunc = function () {\r\n    };\r\n    let smoothing = clamp(p.smoothing, 0, 1);\r\n    let lastMixedInput;\r\n    let interval;\r\n    let timeout;\r\n\r\n    // --- interface ---\r\n\r\n    this.chainIn = function (event) {\r\n        event = JSON.parse(JSON.stringify(event));\r\n        clearTimeout(timeout);\r\n        clearInterval(interval);\r\n\r\n        if (event.type === 'down') {\r\n            lastMixedInput = {\r\n                x: event.x,\r\n                y: event.y,\r\n                pressure: event.pressure\r\n            };\r\n        }\r\n\r\n        if (event.type === 'move') {\r\n\r\n            const inputX = event.x;\r\n            const inputY = event.y;\r\n            const inputPressure = event.pressure;\r\n\r\n            event.x = mix(event.x, lastMixedInput.x, smoothing);\r\n            event.y = mix(event.y, lastMixedInput.y, smoothing);\r\n            event.pressure = mix(event.pressure, lastMixedInput.pressure, smoothing);\r\n            lastMixedInput = {\r\n                x: event.x,\r\n                y: event.y,\r\n                pressure: event.pressure\r\n            };\r\n\r\n            if (smoothing > 0) {\r\n                timeout = setTimeout(function () {\r\n                    interval = setInterval(function () {\r\n                        event = JSON.parse(JSON.stringify(event));\r\n\r\n                        event.x = mix(inputX, lastMixedInput.x, smoothing);\r\n                        event.y = mix(inputY, lastMixedInput.y, smoothing);\r\n                        event.pressure = mix(inputPressure, lastMixedInput.pressure, smoothing);\r\n                        lastMixedInput = {\r\n                            x: event.x,\r\n                            y: event.y,\r\n                            pressure: event.pressure\r\n                        };\r\n\r\n                        chainOut(event);\r\n                    }, 35);\r\n                }, 80);\r\n            }\r\n\r\n        }\r\n\r\n        return event;\r\n    };\r\n\r\n    this.setChainOut = function (func) {\r\n        chainOut = func;\r\n    };\r\n\r\n    this.setSmoothing = function (s) {\r\n        smoothing = clamp(s, 0, 1);\r\n    };\r\n};\r\n","import {IKeyString} from '../BB.types';\r\nimport {createCanvas} from './create-canvas';\r\n\r\nexport function copyCanvas(canvas: HTMLCanvasElement): HTMLCanvasElement {\r\n    const resultCanvas = createCanvas(canvas.width, canvas.height);\r\n    const ctx = resultCanvas.getContext('2d');\r\n    if (!ctx) {\r\n        throw new Error('2d context not supported or canvas already initialized');\r\n    }\r\n    ctx.drawImage(canvas, 0, 0);\r\n    return resultCanvas;\r\n}\r\n\r\n/**\r\n * Determine if should disable imageSmoothing for transformation.\r\n * ImageSmoothing can make images blurry even when they're in the original scale and aligned with the pixelgrid.\r\n */\r\nexport function testShouldPixelate(\r\n    transform: {x: number, y: number, width:number, height: number, angleDeg: number},\r\n    scaleX: number,\r\n    scaleY: number,\r\n): boolean {\r\n    if (\r\n        ![1, -1].includes(scaleX) || ![1, -1].includes(scaleY) ||\r\n        transform.width % 1 !== 0 || transform.height % 1 !== 0 ||\r\n        Math.abs(transform.angleDeg) % 90 !== 0\r\n    ) {\r\n        return false;\r\n    }\r\n    const whSwapped = Math.abs(transform.angleDeg - 90) % 180 === 0;\r\n    const width = whSwapped ? transform.height : transform.width;\r\n    const height = whSwapped ? transform.width : transform.height;\r\n    return (\r\n            (Math.abs(width) % 2 === 0 && transform.x % 1 === 0) ||\r\n            (Math.abs(width) % 2 === 1 && transform.x % 1 === 0.5)\r\n        ) &&\r\n        (\r\n            (Math.abs(height) % 2 === 0 && transform.y % 1 === 0) ||\r\n            (Math.abs(height) % 2 === 1 && transform.y % 1 === 0.5)\r\n        );\r\n}\r\n\r\n\r\n/**\r\n * @param destCtx - the canvas that will be drawn on\r\n * @param transformImage - image that will be drawn on canvas\r\n * @param transform - {x, y, width, height, angle} - x and y are center of transformImage\r\n * @param bounds object - optional {x, y, width, height} - crop of transformImage in transformImage image space\r\n * @param pixelated\r\n */\r\nexport function drawTransformedImageWithBounds(\r\n    destCtx: CanvasRenderingContext2D,\r\n    transformImage: HTMLImageElement | HTMLCanvasElement,\r\n    transform: {x: number, y: number, width:number, height: number, angleDeg: number},\r\n    bounds?: {x: number, y: number, width: number, height: number},\r\n    pixelated?: boolean,\r\n): void {\r\n    if (!bounds) {\r\n        bounds = {\r\n            x: 0,\r\n            y: 0,\r\n            width: transformImage.width,\r\n            height: transformImage.height\r\n        };\r\n    }\r\n\r\n    destCtx.save();\r\n    if (pixelated) {\r\n        destCtx.imageSmoothingEnabled = false;\r\n    } else {\r\n        destCtx.imageSmoothingEnabled = true;\r\n        destCtx.imageSmoothingQuality = 'high';\r\n    }\r\n\r\n    destCtx.translate(transform.x, transform.y);\r\n    destCtx.rotate(transform.angleDeg / 180 * Math.PI);\r\n    destCtx.scale(transform.width > 0 ? 1 : -1, transform.height > 0 ? 1 : -1);\r\n    destCtx.drawImage(\r\n        transformImage,\r\n        bounds.x, bounds.y, bounds.width, bounds.height,\r\n        -Math.abs(transform.width) / 2, -Math.abs(transform.height) / 2, Math.abs(transform.width), Math.abs(transform.height));\r\n\r\n    destCtx.restore();\r\n}\r\n\r\n/**\r\n * all transformations are optional\r\n * center is the point around which will be scaled and rotated\r\n *\r\n * @param baseCanvas canvas - the canvas that will be drawn on\r\n * @param transformImage image|canvas - image that will be drawn on canvas\r\n * @param transformObj {center: {x, y}, scale: {x, y}, translate: {x, y}, angleDegree}\r\n */\r\nexport function drawTransformedImageOnCanvas(\r\n    baseCanvas: HTMLCanvasElement,\r\n    transformImage: HTMLImageElement | HTMLCanvasElement,\r\n    transformObj: {\r\n        center: {x: number, y: number},\r\n        scale: {x: number, y: number},\r\n        translate: {x: number, y: number},\r\n        angleDegree: number,\r\n    },\r\n): void {\r\n    transformObj = JSON.parse(JSON.stringify(transformObj));\r\n    if (!transformObj.center) {\r\n        transformObj.center = {\r\n            x: transformImage.width / 2,\r\n            y: transformImage.height / 2\r\n        }\r\n    }\r\n    if (!transformObj.scale) {\r\n        transformObj.scale = {\r\n            x: 1,\r\n            y: 1\r\n        };\r\n    }\r\n    if (!transformObj.angleDegree) {\r\n        transformObj.angleDegree = 0;\r\n    }\r\n    if (!transformObj.translate) {\r\n        transformObj.translate = {\r\n            x: 0,\r\n            y: 0\r\n        };\r\n    }\r\n\r\n    const ctx = baseCanvas.getContext('2d');\r\n    if (!ctx) {\r\n        throw new Error('2d context not supported or canvas already initialized');\r\n    }\r\n    ctx.save();\r\n    if (\r\n        Math.abs(transformObj.scale.x - 1) >  0.000001 ||\r\n        Math.abs(transformObj.scale.y - 1) > 0.000001 ||\r\n        Math.abs(transformObj.angleDegree % 90) > 0.000001\r\n    ) {\r\n        ctx.imageSmoothingEnabled = true;\r\n        ctx.imageSmoothingQuality = 'high';\r\n    } else {\r\n        ctx.imageSmoothingEnabled = false;\r\n    }\r\n\r\n    ctx.translate(transformObj.translate.x, transformObj.translate.y);\r\n    ctx.translate(transformObj.center.x, transformObj.center.y);\r\n    ctx.rotate(transformObj.angleDegree / 180 * Math.PI);\r\n    ctx.scale(transformObj.scale.x, transformObj.scale.y);\r\n    ctx.translate(-transformObj.center.x, -transformObj.center.y);\r\n    ctx.drawImage(transformImage, 0, 0, transformImage.width, transformImage.height);\r\n\r\n    ctx.restore();\r\n}\r\n\r\nexport const createCheckerCanvas = function(size: number): HTMLCanvasElement {\r\n    const canvas = createCanvas();\r\n    let ctx;\r\n    if (size < 1) {\r\n        canvas.width = 1;\r\n        canvas.height = 1;\r\n        ctx = canvas.getContext('2d');\r\n        if (!ctx) {\r\n            throw new Error('2d context not supported or canvas already initialized');\r\n        }\r\n        ctx.fillStyle = 'rgb(128, 128, 128)';\r\n        ctx.fillRect(0, 0, 1, 1);\r\n    } else if (size > 200) {\r\n        canvas.width = 401;\r\n        canvas.height = 401;\r\n    } else {\r\n        canvas.width = size * 2;\r\n        canvas.height = size * 2;\r\n        ctx = canvas.getContext('2d');\r\n        if (!ctx) {\r\n            throw new Error('2d context not supported or canvas already initialized');\r\n        }\r\n        ctx.fillStyle = 'rgb(255, 255, 255)';\r\n        ctx.fillRect(0, 0, size * 2, size * 2);\r\n        ctx.fillStyle = 'rgb(200, 200, 200)';\r\n        ctx.fillRect(0, 0, size, size);\r\n        ctx.fillRect(size, size, size * 2, size * 2);\r\n    }\r\n    return canvas;\r\n};\r\n\r\nexport const createCheckerDataUrl = (function () {\r\n    const cache: IKeyString = { // previously created dataUrls\r\n        '8': 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMElEQVQ4T2M8ceLEfwY8wNzcHJ80A+OoAcMiDP7//483HZw8eRJ/Ohg1gIFx6IcBAIhJUqnarXQ1AAAAAElFTkSuQmCC',\r\n        '4': 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAJ0lEQVQoU2M8ceLEfwYkYG5ujsxlYKSDgv///6O44eTJk6huoL0CAGsOKVVu8UYvAAAAAElFTkSuQmCC'\r\n    };\r\n\r\n    return function (size: number, callback?: (s: string) => void) {\r\n        function create(size: number): string {\r\n            size = parseInt('' + size);\r\n            if (cache['' + size]) {\r\n                return cache['' + size];\r\n            }\r\n            const canvas = createCheckerCanvas(size);\r\n            const result = canvas.toDataURL('image/png');\r\n            cache['' + size] = result;\r\n            return result;\r\n        }\r\n\r\n        if (callback) { //async\r\n            setTimeout(function () {\r\n                callback(create(size));\r\n            }, 1);\r\n        } else { //sync\r\n            return create(size);\r\n        }\r\n    };\r\n})();\r\n\r\n/**\r\n * smooth resize image\r\n * @param canvas canvas - will be resized (modified)\r\n * @param w\r\n * @param h\r\n * @param tmp1 canvas - optional, provide to save resources\r\n * @param tmp2 canvas - optional, provide to save resources\r\n */\r\nexport function resizeCanvas(\r\n    canvas: HTMLCanvasElement,\r\n    w: number,\r\n    h: number,\r\n    tmp1?: HTMLCanvasElement,\r\n    tmp2?: HTMLCanvasElement,\r\n): void {\r\n\r\n    //determine base 2 exponents of old and new size\r\n    function getBase2Obj(oldW: number, oldH: number, newW: number, newH: number) {\r\n        const result = {\r\n            oldWidthEx: Math.round(Math.log2(oldW)),\r\n            oldHeightEx: Math.round(Math.log2(oldH)),\r\n            newWidthEx: Math.ceil(Math.log2(newW)),\r\n            newHeightEx: Math.ceil(Math.log2(newH))\r\n        };\r\n        result.oldWidthEx = Math.max(result.oldWidthEx, result.newWidthEx);\r\n        result.oldHeightEx = Math.max(result.oldHeightEx, result.newHeightEx);\r\n        return result;\r\n    }\r\n\r\n    if (!w || !h || (w === canvas.width && h === canvas.height)) {\r\n        return;\r\n    }\r\n    w = Math.max(w, 1);\r\n    h = Math.max(h, 1);\r\n    if (w <= canvas.width && h <= canvas.height) {\r\n\r\n        tmp1 = !tmp1 ? createCanvas() : tmp1;\r\n        tmp2 = !tmp2 ? createCanvas() : tmp2;\r\n\r\n        const base2 = getBase2Obj(canvas.width, canvas.height, w, h);\r\n\r\n        //initially scale to a base of 2. unless new size is too close to old. e.g. sizing from 900 to 600\r\n        tmp2.width = base2.oldWidthEx > base2.newWidthEx ? Math.pow(2, base2.oldWidthEx) : w;\r\n        tmp2.height = base2.oldHeightEx > base2.newHeightEx ? Math.pow(2, base2.oldHeightEx) : h;\r\n        tmp1.getContext('2d')!.save();\r\n        tmp2.getContext('2d')!.save();\r\n\r\n        let ew, eh;\r\n        let buffer1 = tmp1, buffer2 = tmp2;\r\n\r\n        ew = base2.oldWidthEx;\r\n        eh = base2.oldHeightEx;\r\n\r\n        let bufferCtx = buffer2.getContext('2d')!;\r\n        bufferCtx.imageSmoothingEnabled = true;\r\n        bufferCtx.imageSmoothingQuality  = 'high';\r\n        bufferCtx.globalCompositeOperation  = 'copy';\r\n        bufferCtx.drawImage(canvas, 0, 0, buffer2.width, buffer2.height);\r\n\r\n        let currentWidth = buffer2.width;\r\n        let currentHeight = buffer2.height;\r\n\r\n        //stepwise half the size\r\n        for (; ew > base2.newWidthEx || eh > base2.newHeightEx; ew--, eh--) {\r\n            bufferCtx = buffer1.getContext('2d')!;\r\n            bufferCtx.imageSmoothingEnabled = true;\r\n            bufferCtx.imageSmoothingQuality  = 'high';\r\n            bufferCtx.globalCompositeOperation  = 'copy';\r\n\r\n            const newWidth = (ew > base2.newWidthEx) ? currentWidth / 2 : currentWidth;\r\n            const newHeight = (eh > base2.newHeightEx) ? currentHeight / 2 : currentHeight;\r\n\r\n            //buffer also needs to be properly sized, unfortunately\r\n            buffer1.width = newWidth;\r\n            buffer1.height = newHeight;\r\n\r\n            bufferCtx.drawImage(\r\n                buffer2,\r\n                0, 0,\r\n                currentWidth, currentHeight,\r\n                0, 0,\r\n                newWidth, newHeight\r\n            );\r\n            currentWidth = newWidth;\r\n            currentHeight = newHeight;\r\n\r\n            //swap\r\n            const tmp = buffer1;\r\n            buffer1 = buffer2;\r\n            buffer2 = tmp;\r\n        }\r\n\r\n        //when no longer can be halved, bring to target size\r\n        canvas.width = w;\r\n        canvas.height = h;\r\n        const canvasCtx = canvas.getContext('2d')!;\r\n        canvasCtx.save();\r\n        canvasCtx.imageSmoothingEnabled = true;\r\n        canvasCtx.imageSmoothingQuality  = 'high';\r\n        canvasCtx.drawImage(\r\n            buffer2,\r\n            0, 0,\r\n            currentWidth, currentHeight,\r\n            0, 0,\r\n            w, h\r\n        );\r\n        canvasCtx.restore();\r\n        tmp1.getContext('2d')!.restore();\r\n        tmp2.getContext('2d')!.restore();\r\n\r\n    } else if (w >= canvas.width && h >= canvas.height) {\r\n\r\n        tmp1 = !tmp1 ? createCanvas() : tmp1;\r\n        tmp1.width = w;\r\n        tmp1.height = h;\r\n        const tmp1Ctx = tmp1.getContext('2d')!;\r\n        tmp1Ctx.save();\r\n        tmp1Ctx.imageSmoothingEnabled = true;\r\n        tmp1Ctx.imageSmoothingQuality  = 'high';\r\n        tmp1Ctx.drawImage(canvas, 0, 0, w, h);\r\n        tmp1Ctx.restore();\r\n\r\n        canvas.width = w;\r\n        canvas.height = h;\r\n        canvas.getContext('2d')!.drawImage(tmp1, 0, 0);\r\n\r\n    } else {\r\n        resizeCanvas(canvas, w, canvas.height, tmp1, tmp2);\r\n        resizeCanvas(canvas, w, h, tmp1, tmp2);\r\n    }\r\n}\r\n\r\n/**\r\n * puts naive greyscale version of image into alpha channel.\r\n * only writes a, doesn't write rgb\r\n * @param canvas\r\n */\r\nexport function convertToAlphaChannelCanvas(canvas: HTMLCanvasElement): void {\r\n    const imdat = canvas.getContext('2d')!.getImageData(0, 0, canvas.width, canvas.height);\r\n    for (let i = 0; i < imdat.data.length; i += 4) {\r\n        if (imdat.data[i + 3] === 0) {\r\n            continue;\r\n        }\r\n        imdat.data[i + 3] = (imdat.data[i] + imdat.data[i + 1] + imdat.data[i + 2]) / 3 * (imdat.data[i + 3] / 255);\r\n    }\r\n    canvas.getContext('2d')!.putImageData(imdat, 0, 0);\r\n}\r\n","export const Matrix = (function () {\r\n\r\n    // https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Matrix_math_for_the_web\r\n    // yes not optimized - but it's not used for physics simulations.\r\n\r\n    // const perfTotal = 0;\r\n\r\n    // point • matrix\r\n    function multiplyMatrixAndPoint(matrix, point) {\r\n        const result = [\r\n            (point[0] * matrix[0]) + (point[1] * matrix[4]) + (point[2] * matrix[8]) + (point[3] * matrix[12]), // x\r\n            (point[0] * matrix[1]) + (point[1] * matrix[5]) + (point[2] * matrix[9]) + (point[3] * matrix[13]), // y\r\n            (point[0] * matrix[2]) + (point[1] * matrix[6]) + (point[2] * matrix[10]) + (point[3] * matrix[14]), // z\r\n            (point[0] * matrix[3]) + (point[1] * matrix[7]) + (point[2] * matrix[11]) + (point[3] * matrix[15]) // w\r\n        ];\r\n        return result;\r\n    }\r\n\r\n    //matrixB • matrixA\r\n    function multiplyMatrices(matrixA, matrixB) {\r\n\r\n        // Slice the second matrix up into rows\r\n        const row0 = [matrixB[0], matrixB[1], matrixB[2], matrixB[3]];\r\n        const row1 = [matrixB[4], matrixB[5], matrixB[6], matrixB[7]];\r\n        const row2 = [matrixB[8], matrixB[9], matrixB[10], matrixB[11]];\r\n        const row3 = [matrixB[12], matrixB[13], matrixB[14], matrixB[15]];\r\n\r\n        // Multiply each row by matrixA\r\n        const result0 = multiplyMatrixAndPoint(matrixA, row0);\r\n        const result1 = multiplyMatrixAndPoint(matrixA, row1);\r\n        const result2 = multiplyMatrixAndPoint(matrixA, row2);\r\n        const result3 = multiplyMatrixAndPoint(matrixA, row3);\r\n\r\n        // Turn the result rows back into a single matrix\r\n        return [\r\n            result0[0], result0[1], result0[2], result0[3],\r\n            result1[0], result1[1], result1[2], result1[3],\r\n            result2[0], result2[1], result2[2], result2[3],\r\n            result3[0], result3[1], result3[2], result3[3]\r\n        ];\r\n    }\r\n\r\n    function createTranslationMatrix(x, y) {\r\n        return [\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, 0,\r\n            x, y, 0, 1\r\n        ];\r\n    }\r\n\r\n    function createRotationMatrix(angleRad) {\r\n        //let angleRad = angleDeg / 360 * 2 * Math.PI;\r\n        return [\r\n            Math.cos(-angleRad), -Math.sin(-angleRad), 0, 0,\r\n            Math.sin(-angleRad), Math.cos(-angleRad), 0, 0,\r\n            0, 0, 1, 0,\r\n            0, 0, 0, 1\r\n        ];\r\n    }\r\n\r\n    function createScaleMatrix(f) {\r\n        return [\r\n            f, 0, 0, 0,\r\n            0, f, 0, 0,\r\n            0, 0, 1, 0,\r\n            0, 0, 0, 1\r\n        ];\r\n    }\r\n\r\n    return {\r\n        getIdentity: function () {\r\n            return [\r\n                1, 0, 0, 0,\r\n                0, 1, 0, 0,\r\n                0, 0, 1, 0,\r\n                0, 0, 0, 1\r\n            ];\r\n        },\r\n        multiplyMatrixAndPoint: multiplyMatrixAndPoint,\r\n        multiplyMatrices: multiplyMatrices,\r\n        createTranslationMatrix: createTranslationMatrix,\r\n        createRotationMatrix: createRotationMatrix,\r\n        createScaleMatrix: createScaleMatrix\r\n    };\r\n})();","import {IVector2D} from '../BB.types';\r\n\r\nexport const Vec2 = {\r\n    add: function (p1: IVector2D, p2: IVector2D): IVector2D {\r\n        return {x: p1.x + p2.x, y: p1.y + p2.y};\r\n    },\r\n    sub: function (p1: IVector2D, p2: IVector2D): IVector2D {\r\n        return {x: p1.x - p2.x, y: p1.y - p2.y};\r\n    },\r\n    nor: function (p: IVector2D): IVector2D {\r\n        const len = Math.sqrt(Math.pow(p.x, 2) + Math.pow(p.y, 2));\r\n        return {x: p.x / len, y: p.y / len};\r\n    },\r\n    len: function (p: IVector2D): number {\r\n        return Math.sqrt(Math.pow(p.x, 2) + Math.pow(p.y, 2));\r\n    },\r\n    dist: function (p1: IVector2D, p2: IVector2D): number {\r\n        return Vec2.len(Vec2.sub(p1, p2));\r\n    },\r\n    mul: function (p: IVector2D, s: number): IVector2D {\r\n        return {x: p.x * s, y: p.y * s};\r\n    },\r\n    angle: function (p1: IVector2D, p2: IVector2D): number {\r\n        return Math.atan2(p2.y - p1.y, p2.x - p1.x);\r\n    },\r\n    dot: function(a: IVector2D, b: IVector2D): number {\r\n        const aArr = [a.x, a.y];\r\n        const bArr = [b.x, b.y];\r\n        return aArr.map((x, i) => aArr[i] * bArr[i]).reduce((m, n) => m + n);\r\n    }\r\n};","import {Vec2} from './vec2';\r\nimport {pointsToAngleDeg, clamp, dist, mix} from './math';\r\nimport {IVector2D} from \"../bb.types\";\r\n\r\n/**\r\n * project p onto line\r\n * @param lineStart\r\n * @param lineEnd\r\n * @param p\r\n */\r\nexport const projectPointOnLine = function (lineStart: IVector2D, lineEnd: IVector2D, p: IVector2D): IVector2D {\r\n    let x, y;\r\n    if (lineStart.x === lineEnd.x) {\r\n        x = lineStart.x;\r\n        y = p.y;\r\n\r\n        return {\r\n            x: x,\r\n            y: y\r\n        };\r\n    }\r\n    const m = (lineEnd.y - lineStart.y) / (lineEnd.x - lineStart.x);\r\n    const b = lineStart.y - (m * lineStart.x);\r\n\r\n    x = (m * p.y + p.x - m * b) / (m * m + 1);\r\n    y = (m * m * p.y + m * p.x + b) / (m * m + 1);\r\n\r\n    return {\r\n        x: x,\r\n        y: y\r\n    };\r\n};\r\n\r\n\r\n\r\n/**\r\n * Operations on a line made up of points\r\n *\r\n * getAtDist(dist) - point when traveling *dist* along the line\r\n * getLength - gives you total length of line\r\n *\r\n * @param params object - {points: [{x:float, y:float}, ...]}\r\n * @constructor\r\n */\r\nexport const PointLine = function (params) {\r\n    const segmentArr = [];\r\n    const _this = this;\r\n\r\n    for (let i = 0; i < params.points.length; i++) {\r\n        (function (i) {\r\n            let length = undefined;\r\n            if (i < params.points.length - 1) {\r\n                length = dist(params.points[i].x, params.points[i].y, params.points[i + 1].x, params.points[i + 1].y);\r\n            }\r\n            segmentArr[i] = {\r\n                x: params.points[i].x,\r\n                y: params.points[i].y,\r\n                length: length\r\n            };\r\n        })(i);\r\n    }\r\n\r\n    /**\r\n     * @param dist number - distance in pixels, > 0\r\n     * @returns {{x: number, y: number}}\r\n     */\r\n    this.getAtDist = function (dist) {\r\n        let remainder = Math.min(_this.getLength(), dist);\r\n        let i = 0;\r\n\r\n        for (; remainder > segmentArr[i].length && i < segmentArr.length - 2; i++) {\r\n            remainder -= segmentArr[i].length;\r\n        }\r\n\r\n        const fac = Math.min(1, Math.max(0, remainder / segmentArr[i].length));\r\n\r\n        return {\r\n            x: (segmentArr[i].x * (1 - fac) + segmentArr[i + 1].x * fac),\r\n            y: (segmentArr[i].y * (1 - fac) + segmentArr[i + 1].y * fac)\r\n        };\r\n    };\r\n    this.getLength = function () {\r\n        let result = 0;\r\n        for (let i = 0; i < segmentArr.length - 1; i++) {\r\n            result += segmentArr[i].length;\r\n        }\r\n        return result;\r\n    };\r\n};\r\n\r\n/**\r\n * Each instance is one line made up of bezier interpolated segments.\r\n * You feed it points. It calculates control points on its own, and the resulting curve.\r\n *\r\n * @constructor\r\n */\r\nexport const BezierLine = function () {\r\n    const _this = this;\r\n    const pointArr = [];\r\n    let lastDot = 0;\r\n    let lastPoint;\r\n    let lastCallbackPoint;\r\n    let lastAngle;\r\n    let lastSpacing = null;\r\n\r\n    /**\r\n     * creates bezier curve from control points\r\n     *\r\n     * @param p1 - control point 1 {x: float, y: float}\r\n     * @param p2 - control point 2 {x: float, y: float}\r\n     * @param p3 - control point 3 {x: float, y: float}\r\n     * @param p4 - control point 4 {x: float, y: float}\r\n     * @param resolution - int\r\n     * @returns {Array} - bezier curve made up of points {x: float, y: float}\r\n     */\r\n    function getBezierPoints(p1, p2, p3, p4, resolution) {\r\n        const curvePoints = [];\r\n        let t, result;\r\n        for (let i = 0; i <= resolution; i++) {\r\n            t = i / resolution;\r\n            result = {};\r\n            result.x = Math.pow(1 - t, 3) * p1.x + 3 * Math.pow(1 - t, 2) * t * p2.x + 3 * (1 - t) * Math.pow(t, 2) * p3.x + Math.pow(t, 3) * p4.x;\r\n            result.y = Math.pow(1 - t, 3) * p1.y + 3 * Math.pow(1 - t, 2) * t * p2.y + 3 * (1 - t) * Math.pow(t, 2) * p3.y + Math.pow(t, 3) * p4.y;\r\n            curvePoints[curvePoints.length] = result;\r\n        }\r\n        return curvePoints;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * add now point to line\r\n     * line will go until the previous point\r\n     *\r\n     * @param x - coord of new point\r\n     * @param y - coord of new point\r\n     * @param spacing - space between each step\r\n     * @param callback - calls for each step - x, y, t - t is 0-1 how far along\r\n     * @param controlsCallback - calls that callback with the bezier control points p1, p2, p3, p4 - each {x: float, y: float}\r\n     */\r\n    this.add = function (x, y, spacing, callback, controlsCallback) {\r\n        if (lastPoint && x === lastPoint.x && y === lastPoint.y) {\r\n            return;\r\n        }\r\n        lastPoint = {x: x, y: y};\r\n        pointArr[pointArr.length] = {\r\n            x: x,\r\n            y: y,\r\n            spacing: spacing\r\n        };\r\n\r\n        //calculate directions\r\n        if (pointArr.length === 1) {\r\n            lastSpacing = spacing;\r\n            return;\r\n        } else if (pointArr.length === 2) {\r\n            pointArr[0].dir = Vec2.nor(Vec2.sub(pointArr[1], pointArr[0]));\r\n            lastDot = spacing;\r\n            lastSpacing = spacing;\r\n            return;\r\n        } else {\r\n            const pointM1 = pointArr[pointArr.length - 1];\r\n            const pointM2 = pointArr[pointArr.length - 2];\r\n            const pointM3 = pointArr[pointArr.length - 3];\r\n            pointM2.dir = Vec2.nor(Vec2.sub(pointM1, pointM3));\r\n            if(isNaN(pointM2.dir.x) || isNaN(pointM2.dir.y)) {\r\n                //when xy -3 == -1\r\n                pointM2.dir = JSON.parse(JSON.stringify(pointM3.dir));\r\n            }\r\n        }\r\n\r\n        //get bezier curve\r\n        const a = pointArr[pointArr.length - 3];\r\n        const b = pointArr[pointArr.length - 2];\r\n        const p1 = a;\r\n        const p2 = Vec2.add(a, Vec2.mul(a.dir, Vec2.dist(a, b) / 4));\r\n        const p3 = Vec2.sub(b, Vec2.mul(b.dir, Vec2.dist(a, b) / 4));\r\n        const p4 = b;\r\n\r\n\r\n        let pointLine;\r\n        if(callback) {\r\n            let curvePoints;\r\n            curvePoints = getBezierPoints(p1, p2, p3, p4, 20);\r\n            pointLine = new PointLine({points: curvePoints});\r\n        } else {\r\n            pointLine = new PointLine({points: [p1, p4]});\r\n        }\r\n\r\n        //interate over curve with spacing and callback\r\n        const len = pointLine.getLength();\r\n        let tempSpacing = mix(lastSpacing, spacing, clamp(lastDot / len, 0, 1));\r\n        let d = lastDot;\r\n        for (; d <= len; d += tempSpacing) {\r\n            tempSpacing = mix(lastSpacing, spacing, clamp(d / len, 0, 1));\r\n            const point = pointLine.getAtDist(d);\r\n            const angle = lastCallbackPoint ? pointsToAngleDeg(lastCallbackPoint, point) : undefined;\r\n            if (callback) {\r\n                callback({\r\n                    x: point.x,\r\n                    y: point.y,\r\n                    t: d / len,\r\n                    angle: angle,\r\n                    dAngle: lastCallbackPoint ? angle - lastAngle : 0\r\n                });\r\n            }\r\n            lastCallbackPoint = point;\r\n            lastAngle = angle;\r\n        }\r\n\r\n        if (callback) {\r\n            lastDot = d - len;\r\n        } else {\r\n            lastDot = 0;\r\n            controlsCallback({p1: p1, p2: p2, p3: p3, p4: p4});\r\n        }\r\n\r\n        lastSpacing = spacing;\r\n    };\r\n\r\n    this.addFinal = function(spacing, callback, controlsCallback) {\r\n        if(pointArr.length < 2) {\r\n            return;\r\n        }\r\n\r\n        const p1 = pointArr[pointArr.length - 2];\r\n        const p2 = pointArr[pointArr.length - 1];\r\n\r\n        const newP = Vec2.add(p2, Vec2.sub(p2, p1));\r\n\r\n        _this.add(newP.x, newP.y, spacing, callback, controlsCallback);\r\n    };\r\n\r\n};\r\n\r\n/**\r\n * from glfx.script by evanW:\r\n * from SplineInterpolator.cs in the Paint.NET source code\r\n *\r\n * points go 0 - 1. I think.\r\n *\r\n * @param points\r\n * @constructor\r\n */\r\nexport const SplineInterpolator = function (points) {\r\n    const n = points.length;\r\n    this.xa = [];\r\n    this.ya = [];\r\n    this.u = [];\r\n    this.y2 = [];\r\n    let i;\r\n\r\n    const first = points[0][0];\r\n    const last = points[points.length - 1][0];\r\n\r\n    points.sort(function (a, b) {\r\n        return a[0] - b[0];\r\n    });\r\n    for (i = 0; i < n; i++) {\r\n        this.xa.push(points[i][0]);\r\n        this.ya.push(points[i][1]);\r\n    }\r\n\r\n    this.u[0] = 0;\r\n    this.y2[0] = 0;\r\n\r\n    for (i = 1; i < n - 1; ++i) {\r\n        // This is the decomposition loop of the tridiagonal algorithm.\r\n        // y2 and u are used for temporary storage of the decomposed factors.\r\n        const wx = this.xa[i + 1] - this.xa[i - 1];\r\n        const sig = (this.xa[i] - this.xa[i - 1]) / wx;\r\n        const p = sig * this.y2[i - 1] + 2.0;\r\n\r\n        this.y2[i] = (sig - 1.0) / p;\r\n\r\n        const ddydx =\r\n            (this.ya[i + 1] - this.ya[i]) / (this.xa[i + 1] - this.xa[i]) -\r\n            (this.ya[i] - this.ya[i - 1]) / (this.xa[i] - this.xa[i - 1]);\r\n\r\n        this.u[i] = (6.0 * ddydx / wx - sig * this.u[i - 1]) / p;\r\n    }\r\n\r\n    this.y2[n - 1] = 0;\r\n\r\n    // This is the backsubstitution loop of the tridiagonal algorithm\r\n    for (i = n - 2; i >= 0; --i) {\r\n        this.y2[i] = this.y2[i] * this.y2[i + 1] + this.u[i];\r\n    }\r\n\r\n    this.getFirstX = function () {\r\n        return first;\r\n    };\r\n    this.getLastX = function () {\r\n        return last;\r\n    };\r\n};\r\n\r\nSplineInterpolator.prototype.interpolate = function (x) {\r\n    const n = this.ya.length;\r\n    let klo = 0;\r\n    let khi = n - 1;\r\n\r\n    // We will find the right place in the table by means of\r\n    // bisection. This is optimal if sequential calls to this\r\n    // routine are at random values of x. If sequential calls\r\n    // are in order, and closely spaced, one would do better\r\n    // to store previous values of klo and khi.\r\n    while (khi - klo > 1) {\r\n        const k = (khi + klo) >> 1;\r\n\r\n        if (this.xa[k] > x) {\r\n            khi = k;\r\n        } else {\r\n            klo = k;\r\n        }\r\n    }\r\n\r\n    const h = this.xa[khi] - this.xa[klo];\r\n    const a = (this.xa[khi] - x) / h;\r\n    const b = (x - this.xa[klo]) / h;\r\n\r\n    // Cubic spline polynomial is now evaluated.\r\n    return a * this.ya[klo] + b * this.ya[khi] +\r\n        ((a * a * a - a) * this.y2[klo] + (b * b * b - b) * this.y2[khi]) * (h * h) / 6.0;\r\n};\r\n\r\n/**\r\n * find x to y. simply by stepping through. suboptimal, so don't call often.\r\n * searches in x 0-1 range\r\n *\r\n * @param y\r\n * @param resolution\r\n */\r\nSplineInterpolator.prototype.findX = function (y, resolution) {\r\n    let x = null;\r\n    let dist = null;\r\n    for(let i = 0; i <= resolution; i++) {\r\n        const tempX = i / resolution;\r\n        const tempY = this.interpolate(tempX);\r\n        if (x === null) {\r\n            x = tempX;\r\n            dist = Math.abs(tempY - y);\r\n            continue;\r\n        }\r\n\r\n        const tempDist = Math.abs(tempY - y);\r\n\r\n        if(tempDist < dist) {\r\n            x = tempX;\r\n            dist = tempDist;\r\n        } else {\r\n            //distance increasing\r\n            break;\r\n        }\r\n    }\r\n    return x;\r\n};\r\n\r\n/**\r\n * input for a spline, following curve of quadratic function x^2 [0 - 1]\r\n * returns [[0, startVal], ..., [1, endVal]]\r\n * @param startVal\r\n * @param endVal\r\n * @param stepSize\r\n * @returns {[]}\r\n */\r\nexport const quadraticSplineInput = function (startVal, endVal, stepSize) {\r\n    function round(v, dec) {\r\n        return Math.round(v * Math.pow(10, dec)) / Math.pow(10, dec);\r\n    }\r\n\r\n    const resultArr = [];\r\n    for (let i = 0; i <= 1; i += stepSize) {\r\n        resultArr.push([round(i, 4), round(startVal + Math.pow(i, 2) * (endVal - startVal), 4)]);\r\n    }\r\n    return resultArr;\r\n};","\r\n\r\n\r\n// based on js color conversion http://www.webtoolkit.info/\r\n\r\n\r\nexport class HSV {\r\n    h: number;\r\n    s: number;\r\n    v: number;\r\n    constructor(h: number, s: number, v: number) {\r\n        this.h = Math.max(0, Math.min(360, h));\r\n        this.s = Math.max(0.001, Math.min(100, s)); //bug when 0\r\n        this.v = Math.max(0, Math.min(100, v));\r\n    }\r\n}\r\n\r\nexport class RGB {\r\n    r : number;\r\n    g: number;\r\n    b: number;\r\n    constructor(r: number, g: number, b: number) {\r\n        this.r = Math.max(0, Math.min(255, r));\r\n        this.g = Math.max(0, Math.min(255, g));\r\n        this.b = Math.max(0, Math.min(255, b));\r\n    }\r\n}\r\n\r\nexport class CMYK {\r\n    c: number;\r\n    m: number;\r\n    y: number;\r\n    k: number;\r\n    constructor(c: number, m: number, y: number, k: number) {\r\n        this.c = Math.max(0, Math.min(100, c));\r\n        this.m = Math.max(0, Math.min(100, m));\r\n        this.y = Math.max(0, Math.min(100, y));\r\n        this.k = Math.max(0, Math.min(100, k));\r\n    }\r\n}\r\n\r\nexport const ColorConverter = {\r\n\r\n    _RGBtoHSV: function (RGB: RGB): HSV {\r\n        const result = new HSV(0, 0, 0);\r\n\r\n        const r = RGB.r / 255;\r\n        const g = RGB.g / 255;\r\n        const b = RGB.b / 255;\r\n\r\n        const minVal = Math.min(r, g, b);\r\n        const maxVal = Math.max(r, g, b);\r\n        const delta = maxVal - minVal;\r\n\r\n        result.v = maxVal;\r\n\r\n        if (delta == 0) {\r\n            result.h = 0;\r\n            result.s = 0;\r\n        } else {\r\n            result.s = delta / maxVal;\r\n            const del_R = (((maxVal - r) / 6) + (delta / 2)) / delta;\r\n            const del_G = (((maxVal - g) / 6) + (delta / 2)) / delta;\r\n            const del_B = (((maxVal - b) / 6) + (delta / 2)) / delta;\r\n\r\n            if (r == maxVal) {\r\n                result.h = del_B - del_G;\r\n            } else if (g == maxVal) {\r\n                result.h = (1 / 3) + del_R - del_B;\r\n            } else if (b == maxVal) {\r\n                result.h = (2 / 3) + del_G - del_R;\r\n            }\r\n\r\n            if (result.h < 0) {\r\n                result.h += 1;\r\n            }\r\n            if (result.h > 1) {\r\n                result.h -= 1;\r\n            }\r\n        }\r\n\r\n        result.h = Math.round(result.h * 360);\r\n        result.s = Math.round(result.s * 100);\r\n        result.v = Math.round(result.v * 100);\r\n\r\n        return result;\r\n    },\r\n\r\n    _HSVtoRGB: function (HSV: HSV): RGB {\r\n        const result = new RGB(0, 0, 0);\r\n\r\n        let var_h, var_i, var_1, var_2, var_3, var_r, var_g, var_b;\r\n\r\n        const h = (HSV.h / 360) % 1;\r\n        const s = HSV.s / 100;\r\n        const v = HSV.v / 100;\r\n\r\n        if (s == 0) {\r\n            result.r = v * 255;\r\n            result.g = v * 255;\r\n            result.b = v * 255;\r\n        } else {\r\n            var_h = h * 6;\r\n            var_i = Math.floor(var_h);\r\n            var_1 = v * (1 - s);\r\n            var_2 = v * (1 - s * (var_h - var_i));\r\n            var_3 = v * (1 - s * (1 - (var_h - var_i)));\r\n\r\n            if (var_i == 0) {\r\n                var_r = v;\r\n                var_g = var_3;\r\n                var_b = var_1\r\n            } else if (var_i == 1) {\r\n                var_r = var_2;\r\n                var_g = v;\r\n                var_b = var_1\r\n            } else if (var_i == 2) {\r\n                var_r = var_1;\r\n                var_g = v;\r\n                var_b = var_3\r\n            } else if (var_i == 3) {\r\n                var_r = var_1;\r\n                var_g = var_2;\r\n                var_b = v\r\n            } else if (var_i == 4) {\r\n                var_r = var_3;\r\n                var_g = var_1;\r\n                var_b = v\r\n            } else {\r\n                var_r = v;\r\n                var_g = var_1;\r\n                var_b = var_2\r\n            }\r\n\r\n            result.r = var_r * 255;\r\n            result.g = var_g * 255;\r\n            result.b = var_b * 255;\r\n\r\n            result.r = Math.round(result.r);\r\n            result.g = Math.round(result.g);\r\n            result.b = Math.round(result.b);\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    _CMYKtoRGB: function (CMYK: CMYK): RGB {\r\n        const result = new RGB(0, 0, 0);\r\n\r\n        const c = CMYK.c / 100;\r\n        const m = CMYK.m / 100;\r\n        const y = CMYK.y / 100;\r\n        const k = CMYK.k / 100;\r\n\r\n        result.r = 1 - Math.min(1, c * (1 - k) + k);\r\n        result.g = 1 - Math.min(1, m * (1 - k) + k);\r\n        result.b = 1 - Math.min(1, y * (1 - k) + k);\r\n\r\n        result.r = Math.round(result.r * 255);\r\n        result.g = Math.round(result.g * 255);\r\n        result.b = Math.round(result.b * 255);\r\n\r\n        return result;\r\n    },\r\n\r\n    _RGBtoCMYK: function (RGB: RGB): CMYK {\r\n        const result = new CMYK(0, 0, 0, 0);\r\n\r\n        const r = RGB.r / 255;\r\n        const g = RGB.g / 255;\r\n        const b = RGB.b / 255;\r\n\r\n        result.k = Math.min(1 - r, 1 - g, 1 - b);\r\n        result.c = (1 - r - result.k) / (1 - result.k);\r\n        result.m = (1 - g - result.k) / (1 - result.k);\r\n        result.y = (1 - b - result.k) / (1 - result.k);\r\n\r\n        result.c = Math.round(result.c * 100);\r\n        result.m = Math.round(result.m * 100);\r\n        result.y = Math.round(result.y * 100);\r\n        result.k = Math.round(result.k * 100);\r\n\r\n        return result;\r\n    },\r\n\r\n    toRGB: function (o: RGB | HSV | CMYK): RGB {\r\n        if (o instanceof RGB) {\r\n            return o;\r\n        }\r\n        if (o instanceof HSV) {\r\n            return this._HSVtoRGB(o);\r\n        }\r\n        if (o instanceof CMYK) {\r\n            return this._CMYKtoRGB(o);\r\n        }\r\n    },\r\n\r\n    toHSV: function (o: RGB | HSV | CMYK): HSV {\r\n        if (o instanceof HSV) {\r\n            return o;\r\n        }\r\n        if (o instanceof RGB) {\r\n            return this._RGBtoHSV(o);\r\n        }\r\n        if (o instanceof CMYK) {\r\n            return this._RGBtoHSV(this._CMYKtoRGB(o));\r\n        }\r\n    },\r\n\r\n    toCMYK: function (o: RGB | HSV | CMYK): CMYK {\r\n        if (o instanceof CMYK) {\r\n            return o;\r\n        }\r\n        if (o instanceof RGB) {\r\n            return this._RGBtoCMYK(o);\r\n        }\r\n        if (o instanceof HSV) {\r\n            return this._RGBtoCMYK(this._HSVtoRGB(o));\r\n        }\r\n    },\r\n    toHexString: function (o: RGB): string {\r\n        if (o instanceof RGB) {\r\n            let ha = (parseInt('' + o.r)).toString(16);\r\n            let hb = (parseInt('' + o.g)).toString(16);\r\n            let hc = (parseInt('' + o.b)).toString(16);\r\n            if (ha.length == 1)\r\n                ha = '0' + ha;\r\n            if (hb.length == 1)\r\n                hb = '0' + hb;\r\n            if (hc.length == 1)\r\n                hc = '0' + hc;\r\n            return ha + hb + hc;\r\n        }\r\n    },\r\n    toRgbStr: function(rgbObj: {r: number, g: number, b: number}): string {\r\n        return 'rgb(' + Math.round(rgbObj.r) + ', ' + Math.round(rgbObj.g) + ', ' + Math.round(rgbObj.b) + ')';\r\n    },\r\n    toRgbaStr: function(rgbaObj: {r: number, g: number, b: number, a: number}): string {\r\n        return 'rgba(' + Math.round(rgbaObj.r) + ', ' + Math.round(rgbaObj.g) + ', ' + Math.round(rgbaObj.b) + ', ' + rgbaObj.a + ')';\r\n    },\r\n    hexToRGB: function(hexStr: string): RGB | null {\r\n        hexStr = hexStr.trim();\r\n        // Expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\r\n        const shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\r\n        hexStr = hexStr.replace(shorthandRegex, function(m, r, g, b) {\r\n            return r + r + g + g + b + b;\r\n        });\r\n\r\n        const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hexStr);\r\n        return result ? new RGB(\r\n            parseInt(result[1], 16),\r\n            parseInt(result[2], 16),\r\n            parseInt(result[3], 16)\r\n        ) : null;\r\n    }\r\n\r\n};\r\n\r\nexport function testIsWhiteBestContrast(rgbObj: {r: number, g: number, b: number}): boolean {\r\n    return (rgbObj.r * 0.299 + rgbObj.g * 0.587 + rgbObj.b * 0.114) < 125;\r\n}","import {addEventListener} from '../input/event-listener';\r\nimport {css} from './base';\r\n\r\n\r\nexport function appendTextDiv(target: HTMLElement, text: string): HTMLDivElement {\r\n    const div = document.createElement('div');\r\n    div.innerHTML = text;\r\n    target.appendChild(div);\r\n    return div;\r\n}\r\n\r\n/**\r\n * Is an input element focused.\r\n * Set attribute \"data-ignore-focus\" to \"true\" if its focus should be ignored.\r\n *\r\n * @param getAll - check all, even those with \"data-ignore-focus\" = \"true\"\r\n */\r\nexport function isInputFocused(getAll: boolean = false): boolean {\r\n    let result = document.activeElement && ['INPUT', 'TEXTAREA'].includes(document.activeElement.tagName);\r\n    if (getAll) {\r\n        return result;\r\n    } else {\r\n        return result && !document.activeElement.getAttribute('data-ignore-focus');\r\n    }\r\n}\r\n\r\n/**\r\n * clears text selection in window\r\n */\r\nexport function clearSelection(): void {\r\n    if (window.getSelection) {\r\n        const sel = window.getSelection();\r\n        if (sel) {\r\n            if (sel.empty) {\r\n                sel.empty();\r\n            } else if (sel.removeAllRanges) {\r\n                sel.removeAllRanges();\r\n            }\r\n        }\r\n    } else if ('selection' in document) {\r\n        (document as any).selection.empty();\r\n    }\r\n}\r\n\r\n/**\r\n * prevents being able to focus element.\r\n * warning: it creates a listener\r\n *\r\n * @param el - dom element\r\n */\r\nexport const makeUnfocusable = (function() {\r\n\r\n    function preventFocus(event: MouseEvent) {\r\n        event.preventDefault();\r\n        let didFocusRelated = false;\r\n        if (event.relatedTarget) {\r\n            try {\r\n                (event.relatedTarget as HTMLElement).focus();\r\n                didFocusRelated = true;\r\n            } catch(e) {\r\n                console.error('failed to focus');\r\n            }\r\n        }\r\n        if(!didFocusRelated) {\r\n            (event.currentTarget as HTMLElement).blur();\r\n        }\r\n    }\r\n\r\n    return function(el) {\r\n        el.setAttribute('tabindex', '-1');\r\n        addEventListener(el, 'focus', preventFocus);\r\n    };\r\n})();\r\n\r\n\r\nconst els: {\r\n    el: HTMLElement;\r\n    listeners: [string, any][];\r\n}[] = [];\r\n// window['els'] = els;\r\n\r\n/**\r\n *\r\n * Create DOM element - div by default\r\n * params = {\r\n * \t    parent: someOtherDiv,\r\n * \t    css: {\r\n * \t\t    width: \"500px\",\r\n * \t\t    backgroundColor: \"#fff\"\r\n * \t    },\r\n * \t    content: \"test\", //or  content: [divA, divB, divC]   or content: someDiv\r\n * \t    className: \"bla\",\r\n *      id: \"bla\"\r\n * }\r\n *\r\n * @param params\r\n */\r\nexport function el(\r\n    params: {\r\n        parent?: HTMLElement,\r\n        css?: { [key: string]: string },\r\n        custom?: { [key: string]: any },\r\n        content?: string | HTMLElement[] | HTMLElement,\r\n        textContent?: string,\r\n        className?: string,\r\n        title?: string,\r\n        id?: string,\r\n        tagName?: string,\r\n        onClick?: (e: Event) => void,\r\n        onChange?: (e: Event) => void,\r\n    }\r\n): HTMLElement {\r\n    const div = document.createElement(params.tagName ? params.tagName : 'div');\r\n    const arr = [];\r\n    if (params.css) {\r\n        css(div, params.css);\r\n    }\r\n\r\n    if (params.content) {\r\n        if (typeof params.content === typeof 'aa') {\r\n            div.innerHTML = params.content as string;\r\n\r\n        } else if (!params.content[0]) {\r\n            div.appendChild(params.content as HTMLElement);\r\n\r\n        } else if (typeof params.content === typeof arr) {\r\n            for (let i = 0; i < (params.content as HTMLElement[]).length; i++) {\r\n                div.appendChild(params.content[i]);\r\n            }\r\n        }\r\n    }\r\n    if(params.textContent) {\r\n        div.textContent = params.textContent;\r\n    }\r\n    if (params.className) {\r\n        div.className = params.className;\r\n    }\r\n    if(params.id) {\r\n        div.id = params.id;\r\n    }\r\n    if(params.parent) {\r\n        params.parent.appendChild(div);\r\n    }\r\n    if('title' in params && params.title !== undefined) {\r\n        div.title = params.title;\r\n    }\r\n    const listeners = [];\r\n    if('onClick' in params) {\r\n        addEventListener(div, 'click', params.onClick);\r\n        listeners.push(['click', params.onClick]);\r\n    }\r\n    if('onChange' in params) {\r\n        addEventListener(div, 'change', params.onChange);\r\n        listeners.push(['change', params.onChange]);\r\n    }\r\n    if (listeners.length > 0) {\r\n        els.push({\r\n            el: div,\r\n            listeners: listeners,\r\n        })\r\n        /*div.style.backgroundColor = '#ff0';\r\n        div.style.border = '1px solid #ff0';*/\r\n    }\r\n    if('custom' in params) {\r\n        const customKeyArr = Object.keys(params.custom);\r\n        for(let i = 0; i < customKeyArr.length; i++) {\r\n            div.setAttribute(customKeyArr[i], params.custom[customKeyArr[i]]);\r\n        }\r\n    }\r\n    return div;\r\n}\r\n\r\n/**\r\n * removes event listeners for Elements created via el()\r\n * @param el\r\n */\r\nexport function destroyEl(el: HTMLElement) {\r\n    for (let i = 0; i < els.length; i++) {\r\n        const item = els[i];\r\n        if (item.el === el) {\r\n            item.listeners.forEach(item => {\r\n                el.removeEventListener(item[0], item[1]);\r\n            });\r\n            els.splice(i, 1);\r\n            return;\r\n        }\r\n    }\r\n    // not found\r\n    return;\r\n}\r\n","\r\nexport class BbLog {\r\n\r\n    private static listeners: any[] = [];\r\n\r\n    constructor() {\r\n    }\r\n\r\n    static subscribe(listener) {\r\n        if (BbLog.listeners.includes(listener)) {\r\n            return;\r\n        }\r\n        BbLog.listeners.push(listener);\r\n    }\r\n\r\n    static unsubscribe(listener) {\r\n        for (let i = 0; i < BbLog.listeners.length; i++) {\r\n            if (listener === BbLog.listeners[i]) {\r\n                BbLog.listeners.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    static emit (msg) {\r\n        BbLog.listeners.forEach(item => {\r\n            item(msg);\r\n        });\r\n    }\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"l7FYj\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"kbyFQ\");","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * Checkbox - with label\r\n */\r\nexport class Checkbox {\r\n\r\n    private element: HTMLElement;\r\n    private check: HTMLInputElement;\r\n\r\n    // --- public ---\r\n\r\n    constructor (params: {\r\n        init?: boolean; // default false\r\n        label: string;\r\n        callback: (boolean) => void;\r\n        allowTab?: boolean; // default false\r\n        title?: string;\r\n        doHighlight?: boolean; // default false\r\n        css?: any;\r\n    }) {\r\n        this.element = BB.el({\r\n            className: 'kl-checkbox'\r\n        });\r\n\r\n        const innerEl = BB.el({\r\n            parent: this.element,\r\n            tagName: 'label',\r\n            className: 'kl-checkbox__inner'\r\n        });\r\n\r\n        this.check = BB.el({\r\n            parent: innerEl,\r\n            tagName: 'input',\r\n            css: {\r\n                marginLeft: '0',\r\n                display: 'inline-block'\r\n            },\r\n            custom: {\r\n                type: 'checkbox'\r\n            }\r\n        }) as HTMLInputElement;\r\n        this.check.checked = params.init;\r\n        if (params.doHighlight && this.check.checked) {\r\n            BB.addClassName(this.element, 'kl-checkbox--highlight');\r\n        }\r\n        if(!params.allowTab) {\r\n            this.check.tabIndex = -1;\r\n        }\r\n\r\n        if (params.title) {\r\n            innerEl.title = params.title;\r\n        }\r\n\r\n        const label = document.createElement('div');\r\n        label.style.display = 'inline-block';\r\n        label.innerHTML = params.label;\r\n        (label as any).allowClick = true;\r\n        innerEl.appendChild(label);\r\n\r\n        this.check.onchange = () => {\r\n            if (params.doHighlight) {\r\n                if (this.check.checked) {\r\n                    BB.addClassName(this.element, 'kl-checkbox--highlight');\r\n                } else {\r\n                    BB.removeClassName(this.element, 'kl-checkbox--highlight');\r\n                }\r\n            }\r\n            params.callback(this.check.checked);\r\n            setTimeout(() => {\r\n                this.check.blur();\r\n            }, 0);\r\n        };\r\n        if(params.css) {\r\n            BB.css(this.element, params.css);\r\n        }\r\n    }\r\n\r\n    getValue(): boolean {\r\n        return this.check.checked;\r\n    }\r\n\r\n    getElement(): HTMLElement {\r\n        return this.element;\r\n    }\r\n\r\n    destroy() {\r\n        this.check.onchange = null;\r\n    }\r\n\r\n}\r\n","import {BB} from '../../../bb/bb';\r\n\r\nexport const input = function (params) {\r\n    const result = document.createElement('input');\r\n    if(params.type) {\r\n        try {\r\n            result.type = params.type;\r\n        } catch(e) {} // ie can't deal with number\r\n    }\r\n    if(params.min !== undefined) {\r\n        result.min = params.min;\r\n    }\r\n    if(params.max !== undefined) {\r\n        result.max = params.max;\r\n    }\r\n    result.value = params.init;\r\n    if(params.callback) {\r\n        result.onchange = function() {\r\n            params.callback(result.value);\r\n        };\r\n    }\r\n    if(params.css) {\r\n        BB.css(result, params.css);\r\n    }\r\n\r\n    return result;\r\n};","import {BB} from '../../../bb/bb';\r\nimport {IKeyString} from '../../../bb/bb.types';\r\n\r\n/**\r\n * A select dropdown\r\n */\r\nexport class Select {\r\n\r\n    private selectEl: HTMLSelectElement;\r\n    private optionArr: ([string, string] | null)[]; // [value, label]\r\n    private changeListener: (event) => void;\r\n    private onChange: (val: string) => void;\r\n\r\n    \r\n    // --- public ---\r\n    constructor (p: {\r\n        isFocusable?: boolean; // default false\r\n        optionArr: ([string, string] | null)[],\r\n        initValue?: string; // default null\r\n        onChange: (val: string) => void;\r\n        css?: IKeyString;\r\n        title?: string;\r\n    }) {\r\n        this.selectEl = BB.el({\r\n            tagName: 'select',\r\n            title: p.title,\r\n            css: {\r\n                cursor: 'pointer',\r\n                fontSize: '15px',\r\n                padding: '3px',\r\n                background: '#fff', // makes safari pay attention to font-size\r\n                //webkitAppearance: 'none'\r\n                colorScheme: 'only light', // chrome doesn't properly invert the text color\r\n            }\r\n        }) as HTMLSelectElement;\r\n        if (p.css) {\r\n            BB.css(this.selectEl, p.css);\r\n        }\r\n\r\n        const isFocusable = p.isFocusable;\r\n        if (!isFocusable) {\r\n            this.selectEl.tabIndex = -1;\r\n        }\r\n        this.optionArr = p.optionArr;\r\n        for(let i = 0; i < this.optionArr.length; i++) {\r\n            if (this.optionArr[i] === null) {\r\n                continue;\r\n            }\r\n            const option = document.createElement('option');\r\n            option.value = this.optionArr[i][0];\r\n            option.textContent = this.optionArr[i][1];\r\n            this.selectEl.append(option);\r\n        }\r\n        this.onChange = p.onChange;\r\n        this.changeListener = (e) => {\r\n            if (!isFocusable) {\r\n                this.selectEl.blur();\r\n            }\r\n            this.onChange(this.selectEl.value);\r\n        };\r\n        this.selectEl.addEventListener('change', this.changeListener);\r\n        this.selectEl.value = 'initValue' in p ? p.initValue : null;\r\n    }\r\n\r\n    setValue (val) {\r\n        this.selectEl.value = val;\r\n    }\r\n\r\n    getValue () {\r\n        return this.selectEl.value;\r\n    }\r\n\r\n    setDeltaValue (delta) {\r\n        let index = 0;\r\n        for (let i = 0; i < this.optionArr.length; i++) {\r\n            if ('' + this.optionArr[i][0] === this.selectEl.value) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n        index = Math.max(0, Math.min(this.optionArr.length -1, index + delta));\r\n        this.selectEl.value = this.optionArr[index][0];\r\n        this.onChange(this.selectEl.value);\r\n    }\r\n\r\n    getElement () {\r\n        return this.selectEl;\r\n    }\r\n\r\n    destroy = () => {\r\n        this.selectEl.removeEventListener('change', this.changeListener);\r\n    }\r\n    \r\n}\r\n","import {BB} from '../../../bb/bb';\r\n\r\n\r\n/**\r\n * Toggle button with an image\r\n *\r\n * p = {\r\n *     initValue: boolean,\r\n *     title: string,\r\n *     isRadio: boolean, // if true, can't click when active\r\n *     onChange: function(boolean)\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const ImageToggle = function(p) {\r\n    let isActive = !!p.initValue;\r\n    const div = BB.el({\r\n        className: 'image-toggle',\r\n        title: p.title,\r\n        css: {\r\n            backgroundImage: \"url('\" + p.image + \"')\"\r\n        },\r\n        onClick: function(e) {\r\n            e.preventDefault();\r\n            if (p.isRadio && isActive) {\r\n                return;\r\n            }\r\n            isActive = !isActive;\r\n            update();\r\n            p.onChange(isActive);\r\n        },\r\n    });\r\n\r\n    function update() {\r\n        if (isActive) {\r\n            BB.addClassName(div, 'image-toggle-active');\r\n        } else {\r\n            BB.removeClassName(div, 'image-toggle-active');\r\n        }\r\n    }\r\n\r\n    update();\r\n\r\n    // --- interface ---\r\n    this.setValue = function(b) {\r\n        isActive = !!b;\r\n        update();\r\n    };\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n    this.getValue = function() {\r\n        return isActive;\r\n    }\r\n\r\n};","import {BB} from '../../../bb/bb';\r\nimport {ImageToggle} from './image-toggle';\r\n\r\n/**\r\n * Radio input group. each one has an image\r\n *\r\n * p = {\r\n *     optionArr: {\r\n *         id: string,\r\n *         title: string,\r\n *         image: string,\r\n *     }[],\r\n *     initId: string,\r\n *     sizePx: number,\r\n *     onChange: function(id: string): void\r\n * }\r\n *\r\n * @param p\r\n */\r\nexport const ImageRadioList = function(p) {\r\n\r\n    const div = BB.el({\r\n        className: 'image-radio-wrapper',\r\n        css: {\r\n            display: 'flex'\r\n        }\r\n    });\r\n\r\n    let activeIndex;\r\n    const optionArr = [];\r\n\r\n    function select(index, id) {\r\n        activeIndex = index;\r\n        for (let i = 0; i < optionArr.length; i++) {\r\n            optionArr[i].setValue(i === activeIndex);\r\n        }\r\n        p.onChange(id);\r\n    }\r\n\r\n    function createOption(index, o) {\r\n        if (o.id === p.initId) {\r\n            activeIndex = index;\r\n        }\r\n        const radioEl = new ImageToggle({\r\n            image: o.image,\r\n            title: o.title,\r\n            initValue: o.id === p.initId,\r\n            isRadio: true,\r\n            onChange: function() {\r\n                select(index, o.id);\r\n            }\r\n        });\r\n        div.appendChild(radioEl.getElement());\r\n\r\n        return radioEl;\r\n\r\n    }\r\n\r\n    for (let i = 0; i < p.optionArr.length; i++) {\r\n        optionArr.push(createOption(i, p.optionArr[i]));\r\n    }\r\n\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n    this.getValue = function() {\r\n        return p.optionArr[activeIndex].id;\r\n    };\r\n};","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport iconImg from 'url:~/src/app/img/ui/brush-pressure.svg';\r\n\r\n\r\n/**\r\n * small toggle button with a pen icon - representing toggling pressure sensitivity\r\n * @param isChecked - boolean - initial value\r\n * @param changeCallback - function(isChecked boolean) - called on change\r\n * @returns {HTMLElement} - the toggle button\r\n */\r\nexport const penPressureToggle = function(isChecked, changeCallback) {\r\n\r\n    const toggleDiv = BB.el({\r\n        css: {\r\n            cssFloat: 'right',\r\n            marginTop: '8px',\r\n            borderRadius: '3px',\r\n            width: '15px',\r\n            height: '15px',\r\n            backgroundImage: 'url(\"' + iconImg + '\")',\r\n            backgroundSize: 'contain',\r\n            backgroundRepeat: 'no-repeat',\r\n            cursor: 'pointer',\r\n            boxSizing: 'border-box',\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n\r\n    if(!BB.hasPointerEvents) {\r\n        toggleDiv.style.display = 'none';\r\n    }\r\n\r\n    function redraw() {\r\n        if(isChecked) {\r\n            BB.css(toggleDiv, {\r\n                backgroundColor: '#fff',\r\n                opacity: '0.9',\r\n                border: '1px solid var(--active-highlight-color)'\r\n            });\r\n        } else {\r\n            BB.css(toggleDiv, {\r\n                backgroundColor: 'transparent',\r\n                opacity: '0.5',\r\n                border: '1px solid #666'\r\n            });\r\n        }\r\n    }\r\n\r\n    toggleDiv.title = 'Toggle Pressure Sensitivity';\r\n    toggleDiv.onclick = function() {\r\n        isChecked = !isChecked;\r\n        redraw();\r\n        changeCallback(isChecked);\r\n    };\r\n\r\n    redraw();\r\n    changeCallback(isChecked);\r\n\r\n    return toggleDiv;\r\n};","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"5H9IS\");","import {BB} from '../../../bb/bb';\r\nimport {calcSliderFalloffFactor} from './slider-falloff';\r\n\r\n\r\n\r\n/**\r\n * big slider, e.g. used for brush size\r\n *\r\n * p = {\r\n *      label: 'Size',\r\n *      width: 500,\r\n *      height: 20,\r\n *      theme: 'compact-light',\r\n *      min: 0,\r\n *      max: 100,\r\n *      initValue: 10,\r\n *      resolution: 600, // if you want spline.find to use a different resolution\r\n *      curve: 'quadratic' | [...], // optional. array is BB.SplineInterpolator points. 0-1\r\n *      formatFunc: function(value) { // optional\r\n *          return Math.round(value);\r\n *      },\r\n *      onChange: function(value) {},\r\n *      isChangeOnFinal: true,\r\n *      eventResMs: 123\r\n * }\r\n *\r\n * Values can be spline interpolated\r\n * On change callback can be debounced\r\n *\r\n * @param p - obj\r\n * @constructor\r\n */\r\nexport const PcSlider = function (p) {\r\n    let isDisabled = false;\r\n    let useSpline = !!p.curve;\r\n    let splineInterpolator;\r\n\r\n    if (!p.label || !p.onChange) {\r\n        throw 'PcSlider missing params';\r\n    }\r\n    if (p.min != 0 && p.max != 0 && p.initValue != 0) {\r\n        if (!p.min || !p.max || !p.initValue) {\r\n            throw 'PcSlider broken params';\r\n        }\r\n    }\r\n    if (p.min >= p.max) {\r\n        throw 'PcSlider broken params';\r\n    }\r\n\r\n    const elementWidth = p.width;\r\n    const elementHeight = p.height;\r\n    const resolution = p.resolution ? p.resolution : elementWidth;\r\n    let min = p.min;\r\n    let max = p.max;\r\n    const onChange = p.onChange;\r\n    const isChangeOnFinal = !!p.isChangeOnFinal;\r\n    const formatFunc = p.formatFunc;\r\n    const eventResMs = p.eventResMs;\r\n\r\n    if (useSpline) {\r\n        const curveArr = p.curve === 'quadratic' ? BB.quadraticSplineInput(min, max, 0.1) : p.curve;\r\n        splineInterpolator = new BB.SplineInterpolator(curveArr);\r\n    }\r\n\r\n    function toLinearValue(value) {\r\n        if (useSpline) {\r\n            return splineInterpolator.findX(value, Math.floor(resolution * 1.5));\r\n        }\r\n        return (value - min) / (max - min);\r\n    }\r\n\r\n    function toValue(pLinearValue) {\r\n        let result = min + pLinearValue * (max - min);\r\n        if (useSpline) {\r\n            result = splineInterpolator.interpolate(pLinearValue);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    const div = BB.el({\r\n        className: 'sliderWrapper',\r\n        css: {\r\n            overflow: 'hidden',\r\n            position: 'relative',\r\n            width: elementWidth + 'px',\r\n            height: elementHeight + 'px',\r\n            userSelect: 'none'\r\n        }\r\n    });\r\n    const labelCaption = p.label;\r\n    const label = document.createElement('div');\r\n    const control = document.createElement('div');\r\n    const controlInner = document.createElement('div');\r\n    let linearValue = toLinearValue(p.initValue); //0 - 1\r\n\r\n    div.appendChild(control);\r\n    div.appendChild(label);\r\n    control.appendChild(controlInner);\r\n    control.className = 'sliderInner';\r\n\r\n\r\n    div.oncontextmenu = function () {\r\n        return false;\r\n    };\r\n    //control.style.backgroundColor = \"#aaa\";\r\n    label.innerHTML = labelCaption;\r\n\r\n    control.style.position = 'absolute';\r\n    control.style.left = '0';\r\n    control.style.top = '0';\r\n    control.style.width = (linearValue * elementWidth) + 'px';\r\n    control.style.height = elementHeight + 'px';\r\n\r\n    const labelFontSize = elementHeight - 14;\r\n    BB.css(label, {\r\n        position: 'absolute',\r\n        left: '7px',\r\n        top: (elementHeight / 2 - labelFontSize / 2 + 1) + 'px',\r\n        lineHeight: labelFontSize + 'px',\r\n        fontSize: labelFontSize + 'px',\r\n        pointerEvents: 'none'\r\n    });\r\n\r\n    function getOutsideVal() {\r\n        let result = min + linearValue * (max - min);\r\n        if (useSpline) {\r\n            result = splineInterpolator.interpolate(linearValue);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function updateLabel() {\r\n        let outVal = toValue(linearValue);\r\n        outVal = formatFunc ? formatFunc(outVal) : parseInt(outVal);\r\n        label.innerHTML = labelCaption + '&nbsp;&nbsp;<span style=\"font-weight:bold\">' + outVal + '</span>';\r\n        control.style.width = (linearValue * elementWidth) + 'px';\r\n    }\r\n\r\n    let lastCallbackTime = 0;\r\n    function emit(isFinal) {\r\n        if(!isFinal && isChangeOnFinal) {\r\n            return;\r\n        }\r\n        if(eventResMs && !isFinal) {\r\n            const now = performance.now();\r\n            if(now - lastCallbackTime >= eventResMs) {\r\n                lastCallbackTime = now;\r\n                onChange(getOutsideVal());\r\n            }\r\n        } else {\r\n            onChange(getOutsideVal());\r\n        }\r\n    }\r\n\r\n    let virtualVal;\r\n    function onPointer(event) {\r\n        event.eventPreventDefault();\r\n\r\n        if (isDisabled) {\r\n            return;\r\n        }\r\n\r\n        if(event.type === 'pointerdown') {\r\n            div.className = 'sliderWrapper sliderWrapperActive';\r\n\r\n            if(event.button === 'left') {\r\n                linearValue = event.relX / elementWidth;\r\n                linearValue = Math.max(0, Math.min(1, linearValue));\r\n                updateLabel();\r\n                emit(false);\r\n            }\r\n            virtualVal = linearValue;\r\n        }\r\n\r\n        if(event.type === 'pointermove' && ['left', 'right'].includes(event.button)) {\r\n\r\n            let deltaX = event.dX;\r\n            const deltaY = Math.abs(event.pageY - event.downPageY);\r\n            const factor = calcSliderFalloffFactor(deltaY, event.button === 'right');\r\n            deltaX *= factor;\r\n            deltaX /= elementWidth;\r\n\r\n            virtualVal += deltaX;\r\n            linearValue = Math.max(0, Math.min(1, virtualVal));\r\n\r\n            updateLabel();\r\n            emit(false);\r\n        }\r\n\r\n        if(event.type === 'pointerup') {\r\n            div.className = 'sliderWrapper';\r\n            emit(true);\r\n        }\r\n\r\n    }\r\n\r\n    let pointerListener;\r\n    setTimeout(function() {\r\n        pointerListener = new BB.PointerListener({\r\n            target: div,\r\n            maxPointers: 1,\r\n            fixScribble: true,\r\n            onPointer: onPointer,\r\n            onWheel: function(event) {\r\n                if (useSpline) {\r\n                    linearValue += -event.deltaY * (splineInterpolator.getLastX() - splineInterpolator.getFirstX()) / 40;\r\n                    linearValue = Math.max(splineInterpolator.getFirstX(), Math.min(splineInterpolator.getLastX(), linearValue));\r\n                } else {\r\n                    linearValue += -event.deltaY / 40;\r\n                    linearValue = Math.max(0, Math.min(1, linearValue));\r\n                }\r\n                updateLabel();\r\n                onChange(getOutsideVal());\r\n            }\r\n        });\r\n        updateLabel();\r\n    }, 1);\r\n\r\n\r\n    // --- interface ---\r\n    this.increaseValue = function (f) {\r\n        linearValue = Math.min(1, linearValue + Math.abs(f));\r\n        updateLabel();\r\n        onChange(getOutsideVal());\r\n    };\r\n    this.decreaseValue = function (f) {\r\n        linearValue = Math.max(0, linearValue - Math.abs(f));\r\n        updateLabel();\r\n        onChange(getOutsideVal());\r\n    };\r\n    this.setValue = function(v) {\r\n        linearValue = toLinearValue(v);\r\n        updateLabel();\r\n    };\r\n    this.getValue = function () {\r\n        return getOutsideVal();\r\n    };\r\n    /**\r\n     * @param config {min: number, max: number, curve: []} curve optional\r\n     */\r\n    this.update = function(config) {\r\n        min = config.min;\r\n        max = config.max;\r\n        useSpline = !!config.curve;\r\n        if (useSpline) {\r\n            const curveArr = config.curve === 'quadratic' ? BB.quadraticSplineInput(min, max, 0.1) : config.curve;\r\n            splineInterpolator = new BB.SplineInterpolator(curveArr);\r\n        } else {\r\n            splineInterpolator = null;\r\n        }\r\n    };\r\n    this.disable = function () {\r\n        isDisabled = true;\r\n    };\r\n\r\n    this.destroy = function() {\r\n        pointerListener.destroy();\r\n    };\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    }\r\n\r\n};","\r\n\r\n/**\r\n * to make sliders more finegrained.\r\n * @param deltaY number - how far pointer moved away vertically since down\r\n * @returns {number} the factor 0-1. 0 -> infinite movement for change of 1. 1 -> 1px for change of 1\r\n */\r\nexport const calcSliderFalloffFactor = function(deltaY, isRightButton) {\r\n    let result = Math.min(10, 1 + Math.pow(Math.floor(deltaY / 50), 2));\r\n    if(isRightButton) {\r\n        result *= 2;\r\n    }\r\n    return 1 / result;\r\n};\r\n","import {BB} from '../../../bb/bb';\r\nimport {input} from '../base-components/input';\r\nimport {popup} from './popup';\r\n\r\n\r\n/**\r\n * dialog for manually inputting the color\r\n * @param p {color: rgbObj, onClose: function(rgbObj | null)}\r\n * @constructor\r\n */\r\nexport const HexColorDialog = function (p) {\r\n\r\n    let lastValidRgb = new BB.RGB(p.color.r, p.color.g, p.color.b);\r\n\r\n    const div = BB.el({});\r\n\r\n    const previewEl = BB.el({\r\n        css: {\r\n            width: '20px',\r\n            height: '20px',\r\n            marginBottom: '10px',\r\n            boxShadow: 'inset 0 0 0 1px #fff, 0 0 0 1px #000',\r\n            background: '#' + BB.ColorConverter.toHexString(lastValidRgb),\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n    div.appendChild(previewEl);\r\n\r\n\r\n    // --- Hex ---\r\n    const hexRowEl = BB.el({\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            marginBottom: '15px'\r\n        }\r\n    });\r\n    const hexLabel = BB.el({\r\n        content: 'Hex',\r\n        css: {\r\n            width: '50px'\r\n        }\r\n    });\r\n    const hexInput = input({\r\n        init: '#' + BB.ColorConverter.toHexString(lastValidRgb),\r\n        css: {\r\n            width: '80px'\r\n        },\r\n        callback: function() {\r\n            let rgbObj = BB.ColorConverter.hexToRGB(hexInput.value);\r\n            if(rgbObj === null) {\r\n                rgbObj = lastValidRgb;\r\n                hexInput.value = '#' + BB.ColorConverter.toHexString(lastValidRgb);\r\n            } else {\r\n                lastValidRgb = rgbObj;\r\n            }\r\n            previewEl.style.background = '#' + BB.ColorConverter.toHexString(rgbObj);\r\n\r\n            for(let i = 0; i < rgbArr.length; i++) {\r\n                rgbArr[i].update();\r\n            }\r\n        }\r\n    });\r\n    const copyButton = BB.el({\r\n        tagName: 'button',\r\n        content: 'Copy',\r\n        css: {\r\n            marginLeft: '10px'\r\n        },\r\n        onClick: function() {\r\n            hexInput.select();\r\n            document.execCommand('copy');\r\n        }\r\n    });\r\n    hexRowEl.appendChild(hexLabel);\r\n    hexRowEl.appendChild(hexInput);\r\n    hexRowEl.appendChild(copyButton);\r\n    div.appendChild(hexRowEl);\r\n    setTimeout(function () {\r\n        hexInput.focus();\r\n        hexInput.select();\r\n    }, 0);\r\n\r\n\r\n    // --- R G B ---\r\n    function createRgbInputRow(labelStr, attributeStr) {\r\n        const result: any = {};\r\n\r\n        const rowEl = BB.el({\r\n            css: {\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                marginTop: '5px',\r\n            }\r\n        });\r\n        const labelEl = BB.el({\r\n            content: labelStr,\r\n            css: {\r\n                width: '50px'\r\n            }\r\n        });\r\n\r\n        const inputEl = input({\r\n            init: lastValidRgb[attributeStr],\r\n            min: 0,\r\n            max: 255,\r\n            type: 'number',\r\n            css: {\r\n                width: '80px'\r\n            },\r\n            callback: function() {\r\n                if(inputEl.value === '' || parseFloat(inputEl.value) < 0 || parseFloat(inputEl.value) > 255) {\r\n                    result.update();\r\n                    return;\r\n                }\r\n                inputEl.value = '' + Math.round(parseFloat(inputEl.value));\r\n                lastValidRgb[attributeStr] = inputEl.value;\r\n                previewEl.style.background = '#' + BB.ColorConverter.toHexString(lastValidRgb);\r\n                hexInput.value = '#' + BB.ColorConverter.toHexString(lastValidRgb);\r\n            }\r\n        });\r\n\r\n        rowEl.appendChild(labelEl);\r\n        rowEl.appendChild(inputEl);\r\n        div.appendChild(rowEl);\r\n\r\n\r\n        result.update = function() {\r\n            inputEl.value = lastValidRgb[attributeStr];\r\n        };\r\n        return result;\r\n    }\r\n    const rgbArr = [];\r\n    rgbArr.push(createRgbInputRow('Red', 'r'));\r\n    rgbArr.push(createRgbInputRow('Green', 'g'));\r\n    rgbArr.push(createRgbInputRow('Blue', 'b'));\r\n\r\n\r\n    const pop = popup({\r\n        target: document.body,\r\n        message: '<b>Manual Color Input</b>',\r\n        div: div,\r\n        autoFocus: false,\r\n        clickOnEnter: 'Ok',\r\n        buttons: ['Ok', 'Cancel'],\r\n        callback: function (resultStr) {\r\n            let rgbObj = null;\r\n            if (resultStr === 'Ok') {\r\n                rgbObj = BB.ColorConverter.hexToRGB(hexInput.value);\r\n            }\r\n            p.onClose(rgbObj);\r\n        }\r\n    });\r\n\r\n};","import {BB} from '../../../bb/bb';\r\nimport {HexColorDialog} from '../modals/color-slider-hex-dialog';\r\nimport {calcSliderFalloffFactor} from './slider-falloff';\r\n// @ts-ignore\r\nimport eyedropperImg from 'url:~/src/app/img/ui/tool-picker.svg';\r\n\r\n/**\r\n * big main HS+V color slider\r\n * 2 elements: slider, and colorpreview(output) + eyedropper\r\n *\r\n * p = {\r\n *     width: number,\r\n *     height: number, // hue slider and output height\r\n *     svHeight: number,\r\n *     startValue: rgb, // 0-255\r\n *     onPick: function(rgb)\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const PcColorSlider = function (p) {\r\n\r\n    const _this = this;\r\n    let pickCallback = function(result?) {};\r\n    const div = document.createElement('div');\r\n    div.style.position = 'relative';\r\n    div.className = 'colorSlider';\r\n    const outputDiv = BB.el({\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center'\r\n        }\r\n    });\r\n    const width = p.width;\r\n    let svHeight = p.svHeight;\r\n    const height = p.height;\r\n    const emitColor = p.onPick;\r\n\r\n    let primaryColorRGB = {\r\n        r: parseInt(p.startValue.r, 10),\r\n        g: parseInt(p.startValue.g, 10),\r\n        b: parseInt(p.startValue.b, 10)\r\n    };\r\n    let primaryColorHSV = BB.ColorConverter.toHSV(p.startValue); // BB.HSV\r\n    let secondaryColorRGB = {r: 255, g: 255, b: 255};\r\n    let secondaryColorHSV = BB.ColorConverter._RGBtoHSV(secondaryColorRGB); // BB.HSV\r\n\r\n    const svWrapper = BB.el({});\r\n    const svSvg = new DOMParser().parseFromString('<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\" preserveAspectRatio=\"none\"> <defs> <linearGradient id=\"value\" gradientTransform=\"rotate(90)\"> <stop offset=\"0\" stop-color=\"rgba(0,0,0,0)\"/> <stop offset=\"100%\" stop-color=\"rgba(0,0,0,1)\"/> </linearGradient> <linearGradient id=\"hue\" gradientTransform=\"rotate(0)\"> <stop offset=\"0\" stop-color=\"#fff\"/> <stop id=\"hue-stop\" offset=\"100%\" stop-color=\"#f00\"/> </linearGradient> </defs> <rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" fill=\"url(\\'#hue\\')\"/> <rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" fill=\"url(\\'#value\\')\"/></svg>', 'image/svg+xml').documentElement;\r\n    const hueStop = (svSvg as any).getElementById('hue-stop');\r\n    BB.setAttributes(hueStop, {\r\n        'stop-color': '#f0f'\r\n    });\r\n    BB.css(svSvg, {\r\n        width: width + 'px',\r\n        height: svHeight + 'px'\r\n    });\r\n    svWrapper.appendChild(svSvg);\r\n\r\n    const divH = document.createElement('div');\r\n    BB.css(divH, {\r\n        position: 'relative',\r\n        height: height + 'px'\r\n    });\r\n    const divPreview = document.createElement('div');\r\n    const controlH = document.createElement('div');\r\n\r\n    const enabled = true;\r\n\r\n    function updatePrimaryHSV(hsv) {\r\n        if (hsv.s === 0) {\r\n            primaryColorHSV = new BB.HSV(primaryColorHSV.h, hsv.s, hsv.v);\r\n        } else {\r\n            primaryColorHSV = new BB.HSV(hsv.h, hsv.s, hsv.v);\r\n        }\r\n    }\r\n\r\n    function createHueBg(targetEl) {\r\n        const im = new Image();\r\n        BB.css(im, {\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0',\r\n            display: 'none',\r\n            pointerEvents: 'none'\r\n        });\r\n        const cv = BB.canvas();\r\n        cv.width = width;\r\n        cv.height = height;\r\n        const ctx = cv.getContext('2d');\r\n        const gradH = ctx.createLinearGradient(0, 0, width, 0);\r\n        for (let i = 0; i < 1; i += 0.01) {\r\n            const col = BB.ColorConverter.toRGB(new BB.HSV(i * 360, 100, 100));\r\n            let ha = (parseInt('' + col.r)).toString(16);\r\n            let hb = (parseInt('' + col.g)).toString(16);\r\n            let hc = (parseInt('' + col.b)).toString(16);\r\n            if (ha.length === 1)\r\n                ha = '0' + ha;\r\n            if (hb.length === 1)\r\n                hb = '0' + hb;\r\n            if (hc.length === 1)\r\n                hc = '0' + hc;\r\n            gradH.addColorStop(i, '#' + ha + hb + hc);\r\n        }\r\n        ctx.fillStyle = gradH;\r\n        ctx.fillRect(0, 0, width, height);\r\n\r\n        targetEl.appendChild(im);\r\n        im.alt = 'hue';\r\n        im.src = cv.toDataURL('image/png');\r\n        im.style.display = 'block';\r\n    }\r\n\r\n\r\n    function updateSVCanvas() {\r\n        const rgb = BB.ColorConverter.toRGB(new BB.HSV(primaryColorHSV.h, 100, 100));\r\n        BB.setAttributes(hueStop, {\r\n            'stop-color': '#' + BB.ColorConverter.toHexString(rgb)\r\n        });\r\n    }\r\n\r\n    function updateSVPointer() {\r\n\r\n        const left = primaryColorHSV.s / 100 * width - 7;\r\n        const top = (1 - primaryColorHSV.v / 100) * svHeight - 6;\r\n        BB.css(pointerSV, {\r\n            left: left + 'px',\r\n            top: top + 'px'\r\n        });\r\n    }\r\n\r\n    function setColPreview() {\r\n        divPreview.style.backgroundColor = 'rgb(' + primaryColorRGB.r + ',' + primaryColorRGB.g + ',' + primaryColorRGB.b + ')';\r\n\r\n        if (BB.testIsWhiteBestContrast(primaryColorRGB)) {\r\n            BB.css(pickerButton, {\r\n                filter: 'invert(1)'\r\n            });\r\n            BB.css(hexButton, {\r\n                filter: 'invert(1)'\r\n            });\r\n        } else{\r\n            BB.css(pickerButton, {\r\n                filter: ''\r\n            });\r\n            BB.css(hexButton, {\r\n                filter: ''\r\n            });\r\n        }\r\n\r\n    }\r\n\r\n    updateSVCanvas();\r\n    div.style.width = width + 'px';\r\n    div.oncontextmenu = function () {\r\n        return false;\r\n    };\r\n\r\n    const SVContainer = document.createElement('div');\r\n    BB.css(SVContainer, {\r\n        width: width + 'px',\r\n        height: svHeight + 'px',\r\n        overflow: 'hidden',\r\n        display: 'block',\r\n        position: 'relative',\r\n        cursor: 'crosshair',\r\n        boxShadow: 'rgb(188, 188, 188) 0 0 0 1px'\r\n    });\r\n\r\n    const pointerSV = document.createElement('div');\r\n    BB.css(pointerSV, {\r\n        width: '12px',\r\n        height: '12px',\r\n        borderRadius: '6px',\r\n        position: 'absolute',\r\n        pointerEvents: 'none',\r\n        boxShadow: '0px 0px 0 1px #000, inset 0px 0px 0 1px #fff'\r\n    });\r\n\r\n    SVContainer.appendChild(svWrapper);\r\n    SVContainer.appendChild(pointerSV);\r\n    updateSVPointer();\r\n    div.appendChild(SVContainer);\r\n    div.appendChild(divH);\r\n    outputDiv.appendChild(divPreview);\r\n    BB.css(divPreview, {\r\n        display: 'flex',\r\n        justifyContent: 'space-between',\r\n        width: (height * 2.5) + 'px',\r\n        height: height + 'px',\r\n        //position: \"relative\",\r\n        boxShadow: 'rgb(188, 188, 188) 0 0 0 1px',\r\n        colorScheme: 'only light',\r\n    });\r\n\r\n    BB.css(divH, {\r\n        overflow: 'hidden',\r\n        position: 'relative',\r\n        width: width + 'px',\r\n        height: height + 'px',\r\n        cursor: 'ew-resize',\r\n        boxShadow: 'rgb(188, 188, 188) 0 0 0 1px',\r\n        marginTop: '1px',\r\n        marginBottom: '1px'\r\n    });\r\n\r\n    //divH.className = \"svSlider\";\r\n    BB.css(controlH, {\r\n        width: '1px',\r\n        height: height + 'px',\r\n        background: '#000',\r\n        borderLeft: '1px solid #fff',\r\n        position: 'absolute',\r\n        top: '0',\r\n        left: parseInt('' + (primaryColorHSV.h / 360 * width - 1)) + 'px'\r\n    });\r\n\r\n\r\n    const virtualHSV = {\r\n        h: 0,\r\n        s: 0,\r\n        v: 0\r\n    };\r\n    let svPointerListener;\r\n    let hPointerListener;\r\n\r\n\r\n    const pickerButton = BB.el({\r\n        title: 'Eyedropper [Alt]',\r\n        className: 'color-picker-preview-button',\r\n        css: {\r\n            width: '30px',\r\n            height: '30px',\r\n            backgroundImage: 'url(' + eyedropperImg + ')',\r\n            backgroundRepeat:  'no-repeat',\r\n            backgroundSize: '70%',\r\n            backgroundPosition: 'center'\r\n        }\r\n    });\r\n    let isPicking = false;\r\n\r\n\r\n    pickerButton.onclick = function () {\r\n        if (isPicking === false) {\r\n            BB.removeClassName(pickerButton, 'color-picker-preview-button-hover');\r\n            BB.addClassName(pickerButton, 'color-picker-preview-button-active');\r\n            isPicking = true;\r\n            pickCallback(true);\r\n        } else {\r\n            pickCallback(false);\r\n            _this.pickingDone();\r\n        }\r\n    };\r\n    const pickerButtonPointerListener = new BB.PointerListener({\r\n        target: pickerButton,\r\n        onEnterLeave: function(isOver) {\r\n            if(isPicking) {\r\n                return;\r\n            }\r\n            if(isOver) {\r\n                BB.addClassName(pickerButton, 'color-picker-preview-button-hover');\r\n            } else {\r\n                BB.removeClassName(pickerButton, 'color-picker-preview-button-hover');\r\n            }\r\n        }\r\n    });\r\n    divPreview.appendChild(pickerButton);\r\n\r\n\r\n    const hexButton = BB.el({\r\n        content: '#',\r\n        className: 'color-picker-preview-button',\r\n        title: 'Manual Color Input',\r\n        css: {\r\n            height: '100%',\r\n            width: height + 'px',\r\n            lineHeight: height + 'px',\r\n            fontSize: (height * 0.65) + 'px'\r\n        },\r\n        onClick: function() {\r\n            HexColorDialog({\r\n                color: new BB.RGB(primaryColorRGB.r, primaryColorRGB.g, primaryColorRGB.b),\r\n                onClose: function(rgbObj) {\r\n                    if(!rgbObj) {\r\n                        return;\r\n                    }\r\n                    _this.setColor(rgbObj);\r\n                    emitColor(new BB.RGB(primaryColorRGB.r, primaryColorRGB.g, primaryColorRGB.b));\r\n                }\r\n            });\r\n        }\r\n    });\r\n    const hexButtonPointerListener = new BB.PointerListener({\r\n        target: hexButton,\r\n        onEnterLeave: function(isOver) {\r\n            if(isOver) {\r\n                BB.addClassName(hexButton, 'color-picker-preview-button-hover');\r\n            } else {\r\n                BB.removeClassName(hexButton, 'color-picker-preview-button-hover');\r\n            }\r\n        }\r\n    });\r\n    divPreview.appendChild(hexButton);\r\n\r\n    setColPreview();\r\n\r\n\r\n    setTimeout(function() {\r\n        createHueBg(divH);\r\n        divH.appendChild(controlH);\r\n        svPointerListener = new BB.PointerListener({\r\n            target: svWrapper,\r\n            maxPointers: 1,\r\n            fixScribble: true,\r\n            onPointer: function(event) {\r\n                if(event.type === 'pointerdown') {\r\n                    BB.css(SVContainer, {\r\n                        boxShadow: '0px 0px 0px 1px rgb(255,255,255)',\r\n                        zIndex: '1'\r\n                    });\r\n\r\n                    if(event.button === 'left') {\r\n\r\n                        virtualHSV.s = event.relX / width * 100;\r\n                        virtualHSV.v = 100 - event.relY / svHeight * 100;\r\n\r\n                        primaryColorHSV = new BB.HSV(primaryColorHSV.h, virtualHSV.s, virtualHSV.v);\r\n                        primaryColorRGB = BB.ColorConverter.toRGB(primaryColorHSV);\r\n\r\n                        updateSVPointer();\r\n                        setColPreview();\r\n                        emitColor(BB.ColorConverter.toRGB(primaryColorHSV));\r\n                    } else {\r\n                        virtualHSV.s = primaryColorHSV.s;\r\n                        virtualHSV.v = primaryColorHSV.v;\r\n                    }\r\n                }\r\n\r\n                if(event.type === 'pointermove' && ['left', 'right'].includes(event.button)) {\r\n\r\n                    let factor = 1;\r\n                    if(event.button === 'right') {\r\n                        factor = 0.5;\r\n                    }\r\n\r\n                    virtualHSV.s += event.dX / width * 100 * factor;\r\n                    virtualHSV.v -= event.dY / svHeight * 100 * factor;\r\n\r\n                    primaryColorHSV = new BB.HSV(primaryColorHSV.h, virtualHSV.s, virtualHSV.v);\r\n                    primaryColorRGB = BB.ColorConverter.toRGB(primaryColorHSV);\r\n                    updateSVPointer();\r\n                    setColPreview();\r\n                    emitColor(BB.ColorConverter.toRGB(primaryColorHSV));\r\n\r\n                }\r\n\r\n                if(event.type === 'pointerup') {\r\n                    BB.css(SVContainer, {\r\n                        boxShadow: '0 0 0 1px rgb(188, 188, 188)',\r\n                        zIndex: '0'\r\n                    });\r\n                }\r\n\r\n            }\r\n        });\r\n        hPointerListener = new BB.PointerListener({\r\n            target: divH,\r\n            maxPointers: 1,\r\n            fixScribble: true,\r\n            onPointer: function(event) {\r\n\r\n                if(event.type === 'pointerdown') {\r\n                    BB.css(divH, {\r\n                        boxShadow: '0px 0px 0px 1px rgba(255,255,255,1)'\r\n                    });\r\n\r\n                    if(event.button === 'left') {\r\n\r\n                        virtualHSV.h = event.relX / width * 359.99;\r\n\r\n                        primaryColorHSV = new BB.HSV(virtualHSV.h, primaryColorHSV.s, primaryColorHSV.v);\r\n                        primaryColorRGB = BB.ColorConverter.toRGB(primaryColorHSV);\r\n                        controlH.style.left = (Math.round(primaryColorHSV.h / 359.99 * width) - 1) + 'px';\r\n                        updateSVCanvas();\r\n                        setColPreview();\r\n                        emitColor(BB.ColorConverter.toRGB(primaryColorHSV));\r\n                    } else {\r\n                        virtualHSV.h = primaryColorHSV.h;\r\n                    }\r\n                }\r\n\r\n                if(event.type === 'pointermove' && ['left', 'right'].includes(event.button)) {\r\n\r\n                    const deltaY = Math.abs(event.pageY - event.downPageY);\r\n                    const factor = calcSliderFalloffFactor(deltaY, event.button === 'right');\r\n\r\n                    virtualHSV.h += event.dX / width * 359.99 * factor;\r\n\r\n                    if(event.button === 'right') {\r\n                        virtualHSV.h = virtualHSV.h % 359.99;\r\n                        if (virtualHSV.h < 0) {\r\n                            virtualHSV.h += 359.99;\r\n                        }\r\n                    }\r\n                    virtualHSV.h = Math.min(359.99, virtualHSV.h);\r\n                    primaryColorHSV = new BB.HSV(virtualHSV.h, primaryColorHSV.s, primaryColorHSV.v);\r\n                    primaryColorRGB = BB.ColorConverter.toRGB(primaryColorHSV);\r\n                    controlH.style.left = (Math.round(primaryColorHSV.h / 359.99 * width) - 1) + 'px';\r\n                    updateSVCanvas();\r\n                    setColPreview();\r\n                    emitColor(BB.ColorConverter.toRGB(primaryColorHSV));\r\n\r\n                }\r\n\r\n                if(event.type === 'pointerup') {\r\n                    BB.css(divH, {\r\n                        boxShadow: 'rgb(188, 188, 188) 0 0 0 1px'\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    }, 1);\r\n\r\n\r\n    // --- second color ---\r\n\r\n    const secondaryColorBtn = BB.el({\r\n        parent: outputDiv,\r\n        title: 'Secondary Color [X]',\r\n        css: {\r\n            cursor: 'pointer',\r\n            marginLeft: '5px',\r\n            width: '22px',\r\n            height: '22px',\r\n            boxShadow: 'rgb(188, 188, 188) 0px 0px 0px 1px',\r\n            colorScheme: 'only light',\r\n        },\r\n        onClick: function(e) {\r\n            e.preventDefault();\r\n            swapColors();\r\n        }\r\n    });\r\n    function updateSecondaryColor() {\r\n        secondaryColorBtn.style.backgroundColor = BB.ColorConverter.toRgbStr(secondaryColorRGB);\r\n    }\r\n    function swapColors() {\r\n        // swap hsv\r\n        let tmp: any = secondaryColorHSV;\r\n        secondaryColorHSV = primaryColorHSV;\r\n        updatePrimaryHSV(tmp);\r\n        // swap rgb\r\n        tmp = secondaryColorRGB;\r\n        secondaryColorRGB = primaryColorRGB;\r\n        primaryColorRGB = tmp;\r\n\r\n        controlH.style.left = parseInt('' + (primaryColorHSV.h / 359 * width - 1)) + 'px';\r\n        updateSVCanvas();\r\n        updateSVPointer();\r\n        setColPreview();\r\n        updateSecondaryColor();\r\n\r\n        emitColor(new BB.RGB(primaryColorRGB.r, primaryColorRGB.g, primaryColorRGB.b));\r\n    }\r\n    updateSecondaryColor();\r\n\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.setColor = function (c) {\r\n        primaryColorRGB = {r: parseInt(c.r, 10), g: parseInt(c.g, 10), b: parseInt(c.b, 10)};\r\n        updatePrimaryHSV(BB.ColorConverter.toHSV(c));\r\n        controlH.style.left = parseInt('' + (primaryColorHSV.h / 359 * width - 1)) + 'px';\r\n        updateSVCanvas();\r\n        updateSVPointer();\r\n        setColPreview();\r\n    };\r\n\r\n    this.getColor = function () {\r\n        return new BB.RGB(primaryColorRGB.r, primaryColorRGB.g, primaryColorRGB.b);\r\n    };\r\n\r\n    this.getSecondaryRGB = function() {\r\n        return new BB.RGB(secondaryColorRGB.r, secondaryColorRGB.g, secondaryColorRGB.b);\r\n    };\r\n\r\n    this.setPickCallback = function (func) {\r\n        pickCallback = func;\r\n    };\r\n\r\n    this.pickingDone = function () {\r\n        if(!isPicking) {\r\n            return;\r\n        }\r\n        isPicking = false;\r\n        BB.removeClassName(pickerButton, 'color-picker-preview-button-active');\r\n    };\r\n\r\n    this.enable = function (e) {\r\n        if (e) {\r\n            div.style.pointerEvents = '';\r\n            div.style.opacity = '1';\r\n            outputDiv.style.pointerEvents = '';\r\n            outputDiv.style.opacity = '1';\r\n        } else {\r\n            div.style.pointerEvents = 'none';\r\n            div.style.opacity = '0.5';\r\n            outputDiv.style.pointerEvents = 'none';\r\n            outputDiv.style.opacity = '0.5';\r\n        }\r\n    };\r\n\r\n    this.setHeight = function (h) {\r\n        h = parseInt('' +(h - height * 2 - 3), 10);\r\n        if (h === svHeight) {\r\n            return;\r\n        }\r\n        svHeight = h;\r\n        BB.css(svSvg, {\r\n            width: width + 'px',\r\n            height: svHeight + 'px'\r\n        });\r\n        SVContainer.style.height = svHeight + 'px';\r\n        updateSVPointer();\r\n    };\r\n\r\n    this.swapColors = function() {\r\n        swapColors();\r\n    };\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.getOutputElement = function() {\r\n        return outputDiv;\r\n    }\r\n\r\n};","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"cTtMO\");","import {BB} from '../../../bb/bb';\r\nimport {calcSliderFalloffFactor} from './slider-falloff';\r\n\r\n\r\n/**\r\n * a small color slider\r\n *\r\n * params {\r\n * \t width: 200,\r\n * \t heightSV: 200,\r\n * \t heightH: 10,\r\n * \t color: {r,g,b}\r\n * \t callback: function(c){}\r\n * }\r\n *\r\n * @param params\r\n * @constructor\r\n */\r\nexport const PcSmallColorSlider = function (params) {\r\n    const div = document.createElement('div');\r\n    div.oncontextmenu = function(e) {\r\n        e.preventDefault();\r\n    };\r\n    let color = BB.ColorConverter.toHSV(new BB.RGB(params.color.r, params.color.g, params.color.b));\r\n    BB.css(div, {\r\n        width: params.width + 'px',\r\n        position: 'relative',\r\n        overflow: 'hidden',\r\n        userSelect: 'none'\r\n    });\r\n\r\n    const canvasSV = BB.canvas();\r\n    canvasSV.width = 10;\r\n    canvasSV.height = 10;\r\n    canvasSV.style.width = params.width + 'px';\r\n    canvasSV.style.height = params.heightSV + 'px';\r\n    canvasSV.style.cursor = 'crosshair';\r\n\r\n    function updateSV() {\r\n        const ctx = canvasSV.getContext('2d');\r\n        for (let i = 0; i < canvasSV.height; i += 1) {\r\n            const gradient1 = ctx.createLinearGradient(0, 0, canvasSV.width, 0);\r\n\r\n            const colleft = BB.ColorConverter.toRGB(new BB.HSV(color.h, 1, 100 - (i / canvasSV.height * 100.0)));\r\n            const colright = BB.ColorConverter.toRGB(new BB.HSV(color.h, 100, 100 - (i / canvasSV.height * 100.0)));\r\n            gradient1.addColorStop(0, '#' + BB.ColorConverter.toHexString(colleft));\r\n            gradient1.addColorStop(1, '#' + BB.ColorConverter.toHexString(colright));\r\n            ctx.fillStyle = '#ff0000'; //needed for chrome...otherwise alpha problem\r\n            ctx.fillStyle = gradient1;\r\n            ctx.fillRect(0, i, canvasSV.width, 1);\r\n        }\r\n    }\r\n\r\n    updateSV();\r\n\r\n    const canvasH = BB.canvas();\r\n    canvasH.width = params.width;\r\n    canvasH.height = params.heightH;\r\n    canvasH.style.cursor = 'ew-resize';\r\n    (function () {\r\n        const ctx = canvasH.getContext('2d');\r\n\r\n        const gradH = ctx.createLinearGradient(0, 0, params.width, 0);\r\n        for (let i = 0; i < 1; i += 0.01) {\r\n            const col = BB.ColorConverter.toRGB(new BB.HSV(i * 360, 100, 100));\r\n            gradH.addColorStop(i, 'rgba(' + parseInt('' + col.r) + ', ' + parseInt('' + col.g) + ', ' + parseInt('' + col.b) + ', 1)');\r\n        }\r\n        ctx.fillStyle = gradH;\r\n        ctx.fillRect(0, 0, params.width, params.heightH);\r\n\r\n    })();\r\n    BB.css(canvasSV, {\r\n        width: params.width + 'px',\r\n        height: params.heightSV + 'px',\r\n        overflow: 'hidden',\r\n        position: 'relative'\r\n    });\r\n    canvasSV.style.cssFloat = 'left';\r\n    canvasH.style.cssFloat = 'left';\r\n\r\n    div.appendChild(canvasSV);\r\n    div.appendChild(canvasH);\r\n\r\n    const pointerSV = document.createElement('div');\r\n    BB.css(pointerSV, {\r\n        width: '8px',\r\n        height: '8px',\r\n        borderRadius: '8px',\r\n        position: 'absolute',\r\n        pointerEvents: 'none',\r\n        boxShadow: '0 0 0 1px #000, inset 0 0 0 1px #fff'\r\n    });\r\n    div.appendChild(pointerSV);\r\n\r\n    const pointerH = document.createElement('div');\r\n    BB.css(pointerH, {\r\n        width: '0',\r\n        height: params.heightH + 'px',\r\n        borderLeft: '1px solid #fff',\r\n        borderRight: '1px solid #000',\r\n        position: 'absolute',\r\n        top: params.heightSV + 'px',\r\n        pointerEvents: 'none'\r\n    });\r\n    div.appendChild(pointerH);\r\n\r\n\r\n    function updateSVPointer() {\r\n        const left = color.s / 100 * params.width - 4;\r\n        const top = (1 - color.v / 100) * params.heightSV - 4;\r\n        BB.css(pointerSV, {\r\n            left: left + 'px',\r\n            top: top + 'px'\r\n        });\r\n        /*if(top < params.heightSV/3) {\r\n        pointerSV.style.border = \"1px solid rgba(0,0,0,1)\";\r\n    } else {\r\n        pointerSV.style.border = \"1px solid rgba(255,255,255,1)\";\r\n    }*/\r\n    }\r\n\r\n    function updateHPointer() {\r\n        pointerH.style.left = (color.h / 359.999 * params.width - 1) + 'px';\r\n    }\r\n\r\n    updateSVPointer();\r\n    updateHPointer();\r\n\r\n    const virtualHSV = {\r\n        h: 0,\r\n        s: 0,\r\n        v: 0\r\n    };\r\n\r\n    let svPointerId = null;\r\n    const svPointerListener = new BB.PointerListener({\r\n        target: canvasSV,\r\n        maxPointers: 1,\r\n        fixScribble: true,\r\n        onPointer: function(event) {\r\n\r\n            if(event.type === 'pointerdown') {\r\n                svPointerId = event.pointerId;\r\n                if(event.button === 'left') {\r\n\r\n                    virtualHSV.s = event.relX / params.width * 100;\r\n                    virtualHSV.v = 100 - event.relY / params.heightSV * 100;\r\n\r\n                    color = new BB.HSV(color.h, virtualHSV.s, virtualHSV.v);\r\n\r\n                    updateSVPointer();\r\n                    params.callback(BB.ColorConverter.toRGB(color));\r\n                } else {\r\n                    virtualHSV.s = color.s;\r\n                    virtualHSV.v = color.v;\r\n                }\r\n            }\r\n\r\n            if(event.type === 'pointermove' && ['left', 'right'].includes(event.button) && svPointerId === event.pointerId) {\r\n\r\n                let factor = 1;\r\n                if(event.button === 'right') {\r\n                    factor = 0.5;\r\n                }\r\n\r\n                virtualHSV.s += event.dX / params.width * 100 * factor;\r\n                virtualHSV.v -= event.dY / params.heightSV * 100 * factor;\r\n\r\n                color = new BB.HSV(color.h, virtualHSV.s, virtualHSV.v);\r\n                updateSVPointer();\r\n                params.callback(BB.ColorConverter.toRGB(color));\r\n\r\n            }\r\n            if(event.type === 'pointerup') {\r\n                svPointerId = null;\r\n            }\r\n\r\n        }\r\n    });\r\n\r\n    let hPointerId = null;\r\n    const hPointerListener = new BB.PointerListener({\r\n        target: canvasH,\r\n        maxPointers: 1,\r\n        fixScribble: true,\r\n        onPointer: function(event) {\r\n\r\n            if(event.type === 'pointerdown') {\r\n                hPointerId = event.pointerId;\r\n                if(event.button === 'left') {\r\n\r\n                    virtualHSV.h = event.relX / params.width * 359.99;\r\n\r\n                    color = new BB.HSV(virtualHSV.h, color.s, color.v);\r\n                    updateSV();\r\n                    updateHPointer();\r\n                    params.callback(BB.ColorConverter.toRGB(color));\r\n                } else {\r\n                    virtualHSV.h = color.h;\r\n                }\r\n            }\r\n\r\n            if(event.type === 'pointermove' && ['left', 'right'].includes(event.button) && hPointerId === event.pointerId) {\r\n\r\n                const deltaY = Math.abs(event.pageY - event.downPageY);\r\n                const factor = calcSliderFalloffFactor(deltaY, event.button === 'right');\r\n\r\n                virtualHSV.h += event.dX / params.width * 359.99 * factor;\r\n\r\n                if(event.button === 'right') {\r\n                    virtualHSV.h = virtualHSV.h % 359.99;\r\n                    if (virtualHSV.h < 0) {\r\n                        virtualHSV.h += 359.99;\r\n                    }\r\n                }\r\n                virtualHSV.h = Math.min(359.99, virtualHSV.h);\r\n                color = new BB.HSV(virtualHSV.h, color.s, color.v);\r\n                updateSV();\r\n                updateHPointer();\r\n                params.callback(BB.ColorConverter.toRGB(color));\r\n\r\n            }\r\n            if(event.type === 'pointerup') {\r\n                hPointerId = null;\r\n            }\r\n        }\r\n    });\r\n\r\n\r\n    const cleardiv = document.createElement('div');\r\n    cleardiv.style.clear = 'both';\r\n    div.appendChild(cleardiv);\r\n\r\n    // --- interface ---\r\n    this.setColor = function (c) {\r\n        color = BB.ColorConverter.toHSV(new BB.RGB(c.r, c.g, c.b));\r\n        updateSV();\r\n        updateSVPointer();\r\n        updateHPointer();\r\n    };\r\n    this.getColor = function () {\r\n        return BB.ColorConverter.toRGB(color);\r\n    };\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n    this.destroy = function() {\r\n        svPointerListener.destroy();\r\n        hPointerListener.destroy();\r\n    };\r\n    this.end = function() {\r\n        svPointerId = null;\r\n        hPointerId = null;\r\n    };\r\n\r\n};","import {BB} from '../../../bb/bb';\r\n\r\n\r\n/**\r\n * a slider that looks like this\r\n * ------O----\r\n *\r\n * param: {init, width, pointSize, callback(value, isFirst, isLast)}\r\n *\r\n * @param param\r\n * @constructor\r\n */\r\nexport const PointSlider = function(param) {\r\n\r\n    const div = document.createElement('div');\r\n    div.style.position = 'relative';\r\n    const sliderLine = BB.el({});\r\n    const sliderPoint = BB.el({\r\n        css: {\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n    div.appendChild(sliderLine);\r\n    div.appendChild(sliderPoint);\r\n    let sliderPos;\r\n    let isDragging = false;\r\n\r\n    //sliderLine\r\n    {\r\n        BB.css(sliderLine, {\r\n            marginTop: parseInt('' + (param.pointSize / 2 - 1)) + 'px',\r\n            height: '2px',\r\n            background: '#aaa',\r\n            width: param.width + 'px'\r\n        });\r\n    }\r\n    //sliderPoint\r\n    const touchAreaEl = BB.el({ // expand clickable area\r\n        parent: sliderPoint,\r\n        css: {\r\n            // background: 'rgba(255,0,0,0.4)',\r\n            margin: '-7px 0 0 -7px',\r\n            width: 'calc(100% + 14px)',\r\n            height: 'calc(100% + 7px)',\r\n        }\r\n    });\r\n\r\n    function redrawPoint() {\r\n        sliderPoint.style.left = sliderPos + 'px';\r\n        if(isDragging) {\r\n            sliderPoint.style.boxShadow = '0 0 6px rgba(0,0,0,1)';\r\n        } else {\r\n            sliderPoint.style.boxShadow = '0 0 3px rgba(0,0,0,0.8)';\r\n        }\r\n    }\r\n    function getValue() {\r\n        return sliderPos /  (param.width - param.pointSize);\r\n    }\r\n\r\n    let pointerListener;\r\n    {\r\n        let isFirst;\r\n        sliderPos = BB.clamp(param.init * (param.width - param.pointSize), 0, param.width - param.pointSize);\r\n        BB.css(sliderPoint, {\r\n            position: 'absolute',\r\n            top: '0px',\r\n            backgroundColor: '#eaeaea',\r\n            boxShadow: '0 0 3px rgba(0,0,0,0.8)',\r\n            width: param.pointSize + 'px',\r\n            height: param.pointSize + 'px',\r\n            borderRadius: param.pointSize + 'px',\r\n            cursor: 'ew-resize',\r\n            transition: 'box-shadow 0.2s ease-in-out'\r\n        });\r\n        redrawPoint();\r\n        let imaginaryPos;\r\n        pointerListener = new BB.PointerListener({\r\n            target: sliderPoint,\r\n            fixScribble: true,\r\n            onPointer: function(event) {\r\n                if (event.type === 'pointerdown' && event.button === 'left') {\r\n                    isFirst = true;\r\n                    isDragging = true;\r\n                    imaginaryPos = sliderPos;\r\n                    redrawPoint();\r\n                    event.eventStopPropagation();\r\n                } else if (event.type === 'pointermove' && event.button === 'left') {\r\n                    event.eventStopPropagation();\r\n                    imaginaryPos = imaginaryPos + event.dX;\r\n                    sliderPos = parseInt('' + BB.clamp(imaginaryPos, 0, param.width - param.pointSize));\r\n                    redrawPoint();\r\n                    param.callback(getValue(), isFirst, false);\r\n                    isFirst = false;\r\n                }\r\n                if (event.type === 'pointerup') {\r\n                    event.eventStopPropagation();\r\n                    isDragging = false;\r\n                    redrawPoint();\r\n                    param.callback(getValue(), false, true);\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    // --- interface ---\r\n    this.getEl = function() {\r\n        return div;\r\n    };\r\n    this.setActive = function(isActive) {\r\n        if(isActive) {\r\n            sliderPoint.style.backgroundColor = '#fff';\r\n        } else {\r\n            sliderPoint.style.backgroundColor = '#eaeaea';\r\n        }\r\n    };\r\n    this.destroy = function() {\r\n        pointerListener.destroy();\r\n    };\r\n};","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * UI to pick between colors in colorArr. can display full transparent (checkerboard).\r\n * Can't deal with 0.5 alpha.\r\n * Rectangular buttons.\r\n *\r\n * p = {\r\n *     colorArr: rgba[], // duplicates are removed\r\n *     onChange: func(rgbaObj),\r\n *     label: string,\r\n *     initialIndex: int// optional, index before duplicates were removed\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const ColorOptions = function(p) {\r\n    const div = BB.el({\r\n        content: p.label ? p.label : '',\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n\r\n    let selectedIndex = 0;\r\n    const colorArr = [];\r\n    const buttonArr = [];\r\n    const buttonSize = 22;\r\n    const checkerUrl = BB.createCheckerDataUrl(5);\r\n\r\n    // build colorArr while removing duplicates\r\n    for (let i = 0; i < p.colorArr.length; i++) {\r\n        const item = p.colorArr[i];\r\n        let found = false;\r\n        for (let e = 0; e < colorArr.length; e++) {\r\n            const sItem = colorArr[e];\r\n            if (sItem === null || item === null) {\r\n                continue;\r\n            }\r\n            if (sItem.r === item.r && sItem.g === item.g && sItem.b === item.b && sItem.a === item.a) {\r\n                found = true;\r\n                break;\r\n            }\r\n        }\r\n        if (found) {\r\n            continue;\r\n        }\r\n        colorArr.push(item);\r\n        if ('initialIndex' in p && p.initialIndex === i) {\r\n            selectedIndex = colorArr.length - 1;\r\n        }\r\n    }\r\n\r\n    for(let i = 0; i < colorArr.length; i++) {\r\n        (function(i) {\r\n\r\n            const colorButton = BB.el({\r\n                content: colorArr[i] ? '' : 'X',\r\n                css: {\r\n                    width: buttonSize + 'px',\r\n                    height: buttonSize + 'px',\r\n                    backgroundColor: colorArr[i] ? BB.ColorConverter.toRgbaStr(colorArr[i]) : 'transparent',\r\n                    marginLeft: '7px',\r\n                    boxShadow: '0 0 0 1px #aaa',\r\n                    cursor: 'pointer',\r\n                    userSelect: 'none',\r\n                    textAlign: 'center',\r\n                    lineHeight: (buttonSize + 1) + 'px',\r\n                    color: '#aaa'\r\n                }\r\n            });\r\n            if(colorArr[i] && colorArr[i].a === 0) {\r\n                colorButton.style.backgroundImage = 'url(' + checkerUrl + ')';\r\n            }\r\n\r\n            colorButton.onclick = function(e) {\r\n                e.preventDefault();\r\n                selectedIndex = i;\r\n                update();\r\n                p.onChange(colorArr[i]);\r\n            };\r\n\r\n            (colorButton as any).setIsSelected = function(b) {\r\n                if(b) {\r\n                    BB.css(colorButton, {\r\n                        boxShadow: '0 0 0 2px var(--active-highlight-color), 0 0 5px 0 var(--active-highlight-color)',\r\n                        pointerEvents: 'none'\r\n                    });\r\n                } else {\r\n                    BB.css(colorButton, {\r\n                        boxShadow: '0 0 0 1px #aaa',\r\n                        pointerEvents: ''\r\n                    });\r\n                }\r\n            };\r\n\r\n\r\n            div.appendChild(colorButton);\r\n            buttonArr.push(colorButton);\r\n        })(i);\r\n    }\r\n\r\n\r\n    function update() {\r\n        for(let i = 0; i < buttonArr.length; i++) {\r\n            buttonArr[i].setIsSelected(i === selectedIndex);\r\n        }\r\n    }\r\n    update();\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.destroy = () => {\r\n        buttonArr.forEach(item => {\r\n            item.onclick = null;\r\n        });\r\n        buttonArr.splice(0, buttonArr.length);\r\n    };\r\n};","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * selectable options\r\n * p = {\r\n *     optionArr: {\r\n *          id: string,\r\n *          label: string | HTMLElement\r\n *     }[],\r\n *     initialId?: string,\r\n *     onChange: function(id string): void,\r\n *     changeOnInit?: boolean, // trigger change on creation\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport const Options = function(p) {\r\n    const div = BB.el({});\r\n\r\n    const wrapperEl = BB.el({\r\n        parent: div,\r\n        className: 'kl-option-wrapper',\r\n        css: {\r\n            display: 'flex'\r\n        }\r\n    });\r\n\r\n    const optionArr: {\r\n        id: string;\r\n        el: HTMLElement;\r\n    }[] = [];\r\n    let selectedId = 'initialId' in p ? p.initialId : p.optionArr[0].id;\r\n\r\n    function createOption(o) {\r\n        const optionObj = {\r\n            id: o.id,\r\n            el: null,\r\n        };\r\n\r\n        const classArr = ['kl-option'];\r\n        if (p.isSmall) {\r\n            classArr.push('kl-option--small');\r\n        }\r\n        if (typeof '' !== typeof o.label) {\r\n            classArr.push('kl-option--custom-el');\r\n            o.label.style.pointerEvents = 'none';\r\n        }\r\n\r\n        optionObj.el = BB.el({\r\n            parent: wrapperEl,\r\n            content: o.label,\r\n            className: classArr.join(' '),\r\n            onClick: function() {\r\n                if(selectedId !== optionObj.id) {\r\n                    selectedId = optionObj.id;\r\n                    update();\r\n                    p.onChange(selectedId);\r\n                }\r\n            }\r\n        });\r\n\r\n        if (o.title) {\r\n            optionObj.el.title = o.title;\r\n        }\r\n\r\n        optionArr.push(optionObj);\r\n    }\r\n\r\n    function update() {\r\n        for(let i = 0; i < optionArr.length; i++) {\r\n            if(optionArr[i].id === selectedId) {\r\n                BB.addClassName(optionArr[i].el, 'kl-option-selected');\r\n            } else {\r\n                BB.removeClassName(optionArr[i].el, 'kl-option-selected');\r\n            }\r\n        }\r\n    }\r\n\r\n    for(let i = 0; i < p.optionArr.length; i++) {\r\n        createOption(p.optionArr[i]);\r\n    }\r\n\r\n    update();\r\n\r\n    if (p.changeOnInit) {\r\n        setTimeout(function() {\r\n            p.onChange(selectedId);\r\n        }, 0);\r\n    }\r\n\r\n    function getIndex() {\r\n        for (let i = 0; i < optionArr.length; i++) {\r\n            if (optionArr[i].id === selectedId) {\r\n                return i;\r\n            }\r\n        }\r\n    }\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n    this.getValue = function() {\r\n        return selectedId;\r\n    }\r\n    this.next = function() {\r\n        selectedId = optionArr[(getIndex() + 1) % optionArr.length].id;\r\n        update();\r\n        p.onChange(selectedId);\r\n    };\r\n    this.previous = function() {\r\n        selectedId = optionArr[(optionArr.length + getIndex() - 1) % optionArr.length].id;\r\n        update();\r\n        p.onChange(selectedId);\r\n    };\r\n    this.destroy = () => {\r\n        optionArr.forEach(item => {\r\n            BB.destroyEl(item.el);\r\n        });\r\n        optionArr.splice(0, optionArr.length);\r\n    };\r\n};","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport angleSvg from 'url:~/src/app/img/ui/angle.svg';\r\n\r\n\r\ntype TUiState = 'left' | 'right';\r\n\r\n/**\r\n * display little messages at the top of KlWorkspace\r\n */\r\nexport class StatusOverlay {\r\n\r\n    private el: HTMLDivElement;\r\n    private innerEl: HTMLDivElement;\r\n    private angleIm: HTMLImageElement;\r\n    private innerInnerEl: HTMLDivElement;\r\n    private isWide: boolean;\r\n    private uiState: TUiState;\r\n\r\n    private timeout: number;\r\n    private timeout2: number;\r\n    private timeout3: number;\r\n\r\n    private updateUiState() {\r\n        if (!this.el) {\r\n            return;\r\n        }\r\n        setTimeout(()=>{}, 100);\r\n        if (this.uiState === 'left') {\r\n            this.el.style.left = '271px';\r\n        } else {\r\n            this.el.style.removeProperty('left');\r\n        }\r\n    }\r\n\r\n    private init() {\r\n        this.el = BB.el({\r\n            className: \"top-overlay g-root\",\r\n            onClick: BB.handleClick,\r\n        }) as HTMLDivElement;\r\n\r\n        if (this.isWide) {\r\n            this.el.style.width = '100%';\r\n        }\r\n\r\n        this.updateUiState();\r\n\r\n        this.innerEl = BB.el({\r\n            className: 'top-overlay-inner',\r\n        }) as HTMLDivElement\r\n\r\n\r\n        this.angleIm = new Image();\r\n        this.angleIm.src = angleSvg;\r\n        BB.css(this.angleIm, {\r\n            verticalAlign: 'bottom',\r\n            width: '20px',\r\n            height: '20px',\r\n            marginLeft: '5px',\r\n            borderRadius: '10px'\r\n        });\r\n\r\n        this.innerInnerEl = document.createElement('div');\r\n        this.innerInnerEl.style.display = 'inline-block';\r\n\r\n        this.innerEl.appendChild(this.innerInnerEl);\r\n        this.innerEl.appendChild(this.angleIm);\r\n        this.el.appendChild(this.innerEl);\r\n        document.body.appendChild(this.el);\r\n    }\r\n\r\n\r\n    // --- public ---\r\n\r\n    constructor () {\r\n\r\n    }\r\n\r\n    setWide(b: boolean) {\r\n        this.isWide = !!b;\r\n\r\n        if (!this.el) {\r\n            return;\r\n        }\r\n\r\n        if (this.isWide) {\r\n            this.el.style.width = '100%';\r\n            this.el.style.left = '';\r\n        } else {\r\n            this.el.style.removeProperty('width');\r\n            this.el.style.left = this.uiState === 'left' ? '271px' : '';\r\n        }\r\n    }\r\n\r\n    setUiState(state: TUiState) {\r\n        this.uiState = state;\r\n        this.updateUiState();\r\n    }\r\n\r\n    out(msg: string | {type: 'transform', angleDeg: number, scale: number}, doPulse?: boolean) {\r\n        if (!this.el) {\r\n            this.init();\r\n        }\r\n\r\n        if(msg && typeof msg === 'object') {\r\n\r\n            if(msg.type === 'transform') {\r\n                this.angleIm.style.display = 'inline-block';\r\n                this.angleIm.style.transform = 'rotate(' + msg.angleDeg + 'deg)';\r\n\r\n                if(msg.angleDeg % 90 === 0) {\r\n                    this.angleIm.style.boxShadow = 'inset 0 0 0 1px rgba(255, 255, 255, 0.7)';\r\n                } else {\r\n                    this.angleIm.style.boxShadow = '';\r\n                }\r\n\r\n                this.innerInnerEl.innerHTML = Math.round(msg.scale * 100) + \"%\";\r\n\r\n\r\n            } else {\r\n                this.angleIm.style.display = 'none';\r\n            }\r\n\r\n\r\n\r\n        } else if (typeof msg === 'string') {\r\n            this.angleIm.style.display = 'none';\r\n            this.innerInnerEl.innerHTML = msg;\r\n        }\r\n\r\n        if(doPulse) {\r\n            this.innerEl.style.animation = '';\r\n            setTimeout(\r\n                () => this.innerEl.style.animation = 'top-overlay-pulse 0.5s ease-out',\r\n                20\r\n            );\r\n            if (this.timeout3) {\r\n                clearTimeout(this.timeout3);\r\n            }\r\n            this.timeout3 = window.setTimeout(\r\n                () => this.innerEl.style.animation = '',\r\n                520\r\n            );\r\n        }\r\n\r\n\r\n\r\n        if (this.timeout) {\r\n            clearTimeout(this.timeout);\r\n        }\r\n        if (this.timeout2) {\r\n            clearTimeout(this.timeout2);\r\n        }\r\n        this.el.style.animationName = doPulse ? 'consoleInFast' : \"consoleIn\";\r\n        this.el.style.opacity = \"1\";\r\n        this.timeout = window.setTimeout(() => {\r\n            this.el.style.opacity = \"0\";\r\n            this.el.style.animationName = \"consoleOut\";\r\n            this.timeout2 = window.setTimeout(() => {\r\n                this.el.style.display = \"none\";\r\n                this.timeout2 = 0;\r\n            }, 450);\r\n            this.timeout = 0;\r\n        }, 1200);\r\n        this.el.style.display = \"flex\";\r\n    }\r\n\r\n\r\n}\r\n","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"iQ1f0\");","import {BB} from '../../../bb/bb';\r\nimport {popup} from './popup';\r\n\r\nexport function exportDialog(parent, image) {\r\n    let boxSize, aboutCloseFunc, aboutDiv, closed, aniToggle, imageContainer, coverImage, coverSize,\r\n        text, holding, aniTimeout, halfBoxSize;\r\n    boxSize = 22 * 2;\r\n    halfBoxSize = 22;\r\n    aboutCloseFunc = function () {\r\n    };\r\n    closed = false;\r\n    aniToggle = false;\r\n    aboutDiv = document.createElement(\"div\");\r\n    BB.css(aboutDiv, {\r\n        width: (7 * boxSize) + \"px\"\r\n    });\r\n\r\n    imageContainer = document.createElement(\"div\");\r\n    coverImage = new Image();\r\n    coverImage.src = image.src;\r\n\r\n    imageContainer.appendChild(coverImage);\r\n    imageContainer.appendChild(image);\r\n\r\n    BB.css(imageContainer, {\r\n        width: (6 * boxSize) + \"px\",\r\n        height: (4 * boxSize) + \"px\",\r\n        marginTop: (boxSize / 2 - 1) + \"px\",\r\n        marginLeft: (boxSize / 2 - 1) + \"px\",\r\n        position: \"relative\",\r\n        overflow: \"hidden\",\r\n        boxShadow: \"0 0 10px 4px rgba(255,255,255, 0)\",\r\n        border: \"1px solid rgba(255, 255, 255, 1)\",\r\n        transition: \"box-shadow 0.7s linear\"\r\n    });\r\n    BB.css(image, {\r\n        position: \"absolute\",\r\n        left: '0',\r\n        top: '0',\r\n        width: (6 * boxSize) + \"px\",\r\n        height: (4 * boxSize) + \"px\",\r\n        opacity: '0'\r\n    });\r\n    coverSize = {\r\n        width: (6 * boxSize),\r\n        height: (6 * boxSize / image.width) * image.height\r\n    };\r\n    if (coverSize.height < (4 * boxSize)) {\r\n        coverSize.height = (4 * boxSize);\r\n        coverSize.width = (coverSize.height / image.height) * image.width;\r\n    }\r\n    BB.css(coverImage, {\r\n        position: \"absolute\",\r\n        top: (2 * boxSize) + \"px\",\r\n        left: (3 * boxSize) + \"px\",\r\n        width: coverSize.width + \"px\",\r\n        height: coverSize.height + \"px\",\r\n        marginLeft: (-coverSize.width / 2) + \"px\",\r\n        marginTop: (-coverSize.height / 2) + \"px\"\r\n    });\r\n\r\n    function animation() {\r\n        if (closed) {\r\n            return;\r\n        }\r\n        aniToggle = !aniToggle;\r\n        if (aniToggle) {\r\n            BB.css(imageContainer, {\r\n                border: \"1px solid rgba(0, 0, 0, 1)\"\r\n            });\r\n        } else {\r\n            BB.css(imageContainer, {\r\n                border: \"1px solid rgba(200, 200, 200, 1)\"\r\n            });\r\n        }\r\n        setTimeout(animation, 510);\r\n    }\r\n\r\n    animation();\r\n\r\n    text = document.createElement(\"div\");\r\n    text.innerHTML = \"Right-Click or Press-Hold on the image, then save.\";\r\n    text.ontouchstart = function () {\r\n        return false;\r\n    };\r\n    BB.css(text, {\r\n        fontSize: (boxSize / 2.5) + \"px\",\r\n        color: \"#666\",\r\n        padding: \"10px\",\r\n        textAlign: \"center\"\r\n    });\r\n\r\n    aboutDiv.appendChild(imageContainer);\r\n    aboutDiv.appendChild(text);\r\n\r\n    holding = false;\r\n    image.ontouchstart = function () {\r\n        BB.css(imageContainer, {\r\n            boxShadow: \"0 0 10px 8px rgba(0,255,255, 1)\"\r\n        });\r\n        holding = true;\r\n        aniTimeout = setTimeout(function () {\r\n            holding = false;\r\n            BB.css(imageContainer, {\r\n                boxShadow: \"0 0 10px 4px rgba(0,255,255, 0)\"\r\n            });\r\n        }, 1500);\r\n    };\r\n    image.ontouchmove = function () {\r\n        BB.css(imageContainer, {\r\n            boxShadow: \"0 0 10px 4px rgba(0,255,255, 0)\"\r\n        });\r\n        holding = false;\r\n        clearTimeout(aniTimeout);\r\n    };\r\n    image.ontouchend = function () {\r\n        BB.css(imageContainer, {\r\n            boxShadow: \"0 0 10px 4px rgba(0,255,255, 0)\"\r\n        });\r\n        holding = false;\r\n        clearTimeout(aniTimeout);\r\n    };\r\n\r\n    popup({\r\n        target: parent,\r\n        message: \"<b>Save Image</b>\",\r\n        div: aboutDiv,\r\n        buttons: [\"Close\"],\r\n        callback: function (result) {\r\n            closed = true;\r\n        }\r\n    });\r\n}","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * element that lets you crop an image and copy it via right click\r\n *\r\n * param = {\r\n *     width: number,\r\n *     height: number,\r\n *     canvas: image | canvas,\r\n *     isNotCopy: boolean,\r\n *     onChange: function(width, height)\r\n * }\r\n *\r\n * @param param object\r\n * @constructor\r\n */\r\nexport function CropCopy(param) {\r\n    const div = document.createElement('div');\r\n    BB.css(div, {\r\n        position: 'relative',\r\n        height: param.height + 'px',\r\n        width: param.width + 'px',\r\n        overflow: 'hidden',\r\n        colorScheme: 'only light',\r\n    });\r\n    div.style.position = 'relative';\r\n\r\n    let crop;\r\n    function resetCrop() {\r\n        crop = {\r\n            x: 0,\r\n            y: 0,\r\n            width: param.canvas.width,\r\n            height: param.canvas.height\r\n        };\r\n    }\r\n    resetCrop();\r\n\r\n\r\n    function updateCroppedCanvas() {\r\n        croppedCanvas.width = Math.round(crop.width);\r\n        croppedCanvas.height = Math.round(crop.height);\r\n        let ctx = croppedCanvas.getContext('2d');\r\n        ctx.drawImage(param.canvas, Math.round(-crop.x), Math.round(-crop.y));\r\n        if(croppedImage) {\r\n            croppedImage.src = croppedCanvas.toDataURL('image/png');\r\n        }\r\n\r\n        if (param.onChange) {\r\n            param.onChange(croppedCanvas.width, croppedCanvas.height);\r\n        }\r\n    }\r\n    function updateSelectionRect() {\r\n        BB.css(selectionRect, {\r\n            left: (thumbX + crop.x * scaleW) + 'px',\r\n            top: (thumbY + crop.y * scaleH) + 'px',\r\n            width: (crop.width * scaleW) + 'px',\r\n            height: (crop.height * scaleH) + 'px'\r\n        });\r\n        if (param.onChange) {\r\n            param.onChange(Math.round(crop.width), Math.round(crop.height));\r\n        }\r\n    }\r\n    function isInsideSelectionRect(p) {\r\n        let rect = {\r\n            x: Math.round(thumbX + crop.x * scaleW),\r\n            y: Math.round(thumbY + crop.y * scaleH),\r\n            width: Math.round(crop.width * scaleW),\r\n            height: Math.round(crop.height * scaleH)\r\n        };\r\n        return rect.x <= p.x && p.x <= rect.x + rect.width &&\r\n            rect.y <= p.y && p.y <= rect.y + rect.height;\r\n    }\r\n\r\n    const croppedCanvas = BB.canvas();\r\n    let eventTarget = croppedCanvas;\r\n    let croppedImage = null;\r\n    if(!param.isNotCopy) { //navigator.appName === 'Microsoft Internet Explorer') { //i would prefer not using an image\r\n        croppedImage = new Image();\r\n        eventTarget = croppedImage;\r\n    }\r\n    BB.css(eventTarget, {\r\n        height: param.height + 'px',\r\n        width: param.width + 'px'\r\n    });\r\n    div.appendChild(eventTarget);\r\n    updateCroppedCanvas();\r\n\r\n    const padding = 20;\r\n    const previewWrapper = BB.el({\r\n        css: {\r\n            width: param.width + 'px',\r\n            height: param.height + 'px',\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0',\r\n            pointerEvents: 'none'\r\n        }\r\n    });\r\n    div.appendChild(previewWrapper);\r\n    BB.createCheckerDataUrl(4, function(v) {\r\n        previewWrapper.style.backgroundImage = 'url('+v+')';\r\n    });\r\n\r\n    const thumbCanvas = BB.canvas();\r\n    const thumbSize = BB.fitInto(param.canvas.width, param.canvas.height, param.width - padding * 2, param.height - padding * 2, 1);\r\n    thumbCanvas.width = parseInt('' + thumbSize.width);\r\n    thumbCanvas.height = parseInt('' + thumbSize.height);\r\n    thumbCanvas.style.imageRendering = 'pixelated';\r\n    const scaleW = thumbCanvas.width / param.canvas.width;\r\n    const scaleH = thumbCanvas.height / param.canvas.height;\r\n    const thumbCtx = thumbCanvas.getContext('2d');\r\n    thumbCtx.imageSmoothingEnabled = false;\r\n    thumbCtx.drawImage(param.canvas, 0, 0, thumbCanvas.width, thumbCanvas.height);\r\n    previewWrapper.appendChild(thumbCanvas);\r\n    const thumbX = parseInt('' + ((param.width - thumbCanvas.width) / 2));\r\n    const thumbY = parseInt('' + ((param.height - thumbCanvas.height) / 2));\r\n    BB.css(thumbCanvas, {\r\n        position: 'absolute',\r\n        left: thumbX + \"px\",\r\n        top: thumbY + \"px\"\r\n    });\r\n\r\n    const selectionRect = BB.el({\r\n        css: {\r\n            position: 'absolute',\r\n            boxShadow: '0 0 0 1px #fff, 0 0 0 2px #000, 0 0 40px 1px #000',\r\n        }\r\n    });\r\n    previewWrapper.appendChild(selectionRect);\r\n    updateSelectionRect();\r\n\r\n\r\n    function toOriginalSpace(p) {\r\n        return {\r\n            x: BB.clamp((p.x - thumbX) / scaleW, 0, param.canvas.width),\r\n            y: BB.clamp((p.y - thumbY) / scaleH, 0, param.canvas.height),\r\n        };\r\n    }\r\n    //gen crop from thumb-space points\r\n    function genCrop(p1, p2) {\r\n        let topLeftP = {\r\n            x: Math.min(p1.x, p2.x),\r\n            y: Math.min(p1.y, p2.y)\r\n        };\r\n        let bottomRightP = {\r\n            x: Math.max(p1.x, p2.x),\r\n            y: Math.max(p1.y, p2.y)\r\n        };\r\n        let origTopLeftP = toOriginalSpace(topLeftP);\r\n        let origBottomRightP = toOriginalSpace(bottomRightP);\r\n        origTopLeftP.x = Math.floor(origTopLeftP.x);\r\n        origTopLeftP.y = Math.floor(origTopLeftP.y);\r\n        origBottomRightP.x = Math.ceil(origBottomRightP.x);\r\n        origBottomRightP.y = Math.ceil(origBottomRightP.y);\r\n        return {\r\n            x: origTopLeftP.x,\r\n            y: origTopLeftP.y,\r\n            width: origBottomRightP.x - origTopLeftP.x,\r\n            height: origBottomRightP.y - origTopLeftP.y\r\n        };\r\n    }\r\n\r\n    function isReset() {\r\n        return crop.x === 0 && crop.y === 0 && crop.width === param.canvas.width && crop.height === param.canvas.height;\r\n    }\r\n\r\n    let startP;\r\n    let startCrop = null;\r\n    let isDragging = false;\r\n    let didMove = false;\r\n    let updateCropTimeout;\r\n    const pointerListener = new BB.PointerListener({\r\n        target: eventTarget,\r\n        fixScribble: true,\r\n        onPointer: function(event) {\r\n            let fullPos;\r\n            if (event.type === 'pointerdown' && event.button === 'left') {\r\n                event.eventPreventDefault();\r\n                isDragging = true;\r\n                startP = {\r\n                    x: event.relX,\r\n                    y: event.relY\r\n                };\r\n                if(!isReset() && isInsideSelectionRect(startP)) {\r\n                    startCrop = {\r\n                        x: crop.x,\r\n                        y: crop.y,\r\n                        width: crop.width,\r\n                        height: crop.height\r\n                    };\r\n                } else {\r\n                    crop = genCrop(startP, startP);\r\n                }\r\n            } else if (event.type === 'pointermove' && event.button === 'left') {\r\n                event.eventPreventDefault();\r\n                didMove = true;\r\n                if(startCrop) {\r\n                    crop.x = startCrop.x + Math.round((event.relX - startP.x) / scaleW);\r\n                    crop.y = startCrop.y + Math.round((event.relY - startP.y) / scaleH);\r\n                    crop.x = BB.clamp(crop.x, 0, param.canvas.width - crop.width);\r\n                    crop.y = BB.clamp(crop.y, 0, param.canvas.height - crop.height);\r\n                } else {\r\n                    crop = genCrop(startP, {x: event.relX, y: event.relY});\r\n                }\r\n                updateSelectionRect();\r\n            } else if (event.type === 'pointerup' && startP) {\r\n                event.eventPreventDefault();\r\n                isDragging = false;\r\n                startCrop = null;\r\n                startP = null;\r\n                if(crop.width === 0 || crop.height === 0 || !didMove) {\r\n                    resetCrop();\r\n                    updateSelectionRect();\r\n                }\r\n                didMove = false;\r\n                updateCropTimeout = setTimeout(updateCroppedCanvas, 1);\r\n            }\r\n        }\r\n    });\r\n\r\n    const keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, e, comboStr) {\r\n            if(isDragging) {\r\n                return;\r\n            }\r\n            let doUpdate = false;\r\n\r\n            let stepSize = Math.max(1, 1 / scaleW);\r\n            let shiftIsPressed = keyListener.isPressed('shift');\r\n\r\n            if(keyStr === 'left') {\r\n                if(shiftIsPressed) {\r\n                    crop.width = BB.clamp(crop.width - stepSize, 1, param.canvas.width - crop.x);\r\n                } else {\r\n                    crop.x = BB.clamp(crop.x - stepSize, 0, param.canvas.width - crop.width);\r\n                }\r\n                doUpdate = true;\r\n            }\r\n            if(keyStr === 'right') {\r\n                if(shiftIsPressed) {\r\n                    crop.width = BB.clamp(crop.width + stepSize, 1, param.canvas.width - crop.x);\r\n                } else {\r\n                    crop.x = BB.clamp(crop.x + stepSize, 0, param.canvas.width - crop.width);\r\n                }\r\n                doUpdate = true;\r\n            }\r\n            if(keyStr === 'up') {\r\n                if(shiftIsPressed) {\r\n                    crop.height = BB.clamp(crop.height - stepSize, 1, param.canvas.height - crop.y);\r\n                } else {\r\n                    crop.y = BB.clamp(crop.y - stepSize, 0, param.canvas.height - crop.height);\r\n                }\r\n                doUpdate = true;\r\n            }\r\n            if(keyStr === 'down') {\r\n                if(shiftIsPressed) {\r\n                    crop.height = BB.clamp(crop.height + stepSize, 1, param.canvas.height - crop.y);\r\n                } else {\r\n                    crop.y = BB.clamp(crop.y + stepSize, 0, param.canvas.height - crop.height);\r\n                }\r\n                doUpdate = true;\r\n            }\r\n\r\n            if(doUpdate) {\r\n                e.preventDefault();\r\n                updateSelectionRect();\r\n                clearTimeout(updateCropTimeout);\r\n                updateCropTimeout = setTimeout(updateCroppedCanvas, 100);\r\n            }\r\n        }\r\n    });\r\n\r\n    this.getEl = function() {\r\n        return div;\r\n    };\r\n    this.reset = function() {\r\n        resetCrop();\r\n        updateCroppedCanvas();\r\n        updateSelectionRect();\r\n    };\r\n    this.destroy = function() {\r\n        eventTarget.style.removeProperty('width');\r\n        eventTarget.style.removeProperty('height');\r\n        keyListener.destroy();\r\n        pointerListener.destroy();\r\n    };\r\n    this.isReset = function() {\r\n        return isReset();\r\n    };\r\n    this.getRect = function() {\r\n        return JSON.parse(JSON.stringify(crop));\r\n    };\r\n    this.getCroppedImage = function() {\r\n        return croppedCanvas;\r\n    };\r\n}\r\n","import {BB} from '../../../bb/bb';\r\nimport {popup} from './popup';\r\nimport {CropCopy} from '../components/crop-copy';\r\n\r\n/// <reference path=\"./types.d.ts\" />\r\n\r\n/**\r\n *\r\n * @param parent\r\n * @param fullCanvas\r\n * @param cropCallback\r\n * @param output - BB.Output\r\n * @param showCrop - boolean - show crop button\r\n */\r\nexport function clipboardDialog(parent, fullCanvas, cropCallback, output, showCrop) {\r\n    const div = document.createElement(\"div\");\r\n    const isSmall = window.innerWidth < 550 || window.innerHeight < 550;\r\n\r\n    let topWrapper = BB.el({\r\n        content:'Drag to crop',\r\n        css: {\r\n            textAlign: 'center'\r\n        }\r\n    });\r\n    div.appendChild(topWrapper);\r\n\r\n\r\n    let cropCopy = new CropCopy({\r\n        width: isSmall ? 340 : 540,\r\n        height: isSmall ? 300 : 350,\r\n        canvas: fullCanvas\r\n    });\r\n    BB.css(cropCopy.getEl(), {\r\n        marginTop: '10px',\r\n        marginLeft: '-20px',\r\n        borderTop: '1px solid #bbb',\r\n        borderBottom: '1px solid #bbb'\r\n    });\r\n    div.appendChild(cropCopy.getEl());\r\n\r\n    function toClipboard() {\r\n        const imgURL = cropCopy.getCroppedImage().toDataURL('image/png');\r\n        setTimeout(async function() {\r\n            try {\r\n                const data = await fetch(imgURL);\r\n                const blob = await data.blob();\r\n                await (navigator.clipboard as any).write([\r\n                    new ClipboardItem({\r\n                        [blob.type]: blob\r\n                    } as any) // todo check is possible?\r\n                ]);\r\n                setTimeout(function() {\r\n                    output.out('Copied', true);\r\n                }, 200);\r\n            } catch (err) {\r\n                console.error(err.name, err.message);\r\n            }\r\n        }, 0);\r\n    }\r\n\r\n    let keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, KeyEvent, comboStr) {\r\n            if (comboStr === 'ctrl+c') {\r\n                toClipboard();\r\n                closefunc();\r\n            }\r\n        }\r\n    });\r\n\r\n    let closefunc;\r\n    function blur() {\r\n        closefunc();\r\n    }\r\n    BB.addEventListener(window, \"blur\", blur);\r\n    popup({\r\n        target: parent,\r\n        message: showCrop ? \"<b>Copy To Clipboard / Crop</b>\" : '<b>Copy To Clipboard</b>',\r\n        div: div,\r\n        style: isSmall ? {} : {\r\n            width: \"500px\"\r\n        },\r\n        buttons: showCrop ? ['To Clipboard', 'Apply Crop', 'Cancel'] : ['To Clipboard', 'Cancel'],\r\n        primaries: ['To Clipboard'],\r\n        callback: function (result) {\r\n            if (result === 'To Clipboard') {\r\n                toClipboard();\r\n            } else if (result === 'Apply Crop') {\r\n                let rectObj = cropCopy.getRect();\r\n                cropCallback({\r\n                    left: Math.round(-rectObj.x),\r\n                    right: Math.round(rectObj.x + rectObj.width - fullCanvas.width),\r\n                    top: Math.round(-rectObj.y),\r\n                    bottom: Math.round(rectObj.y + rectObj.height - fullCanvas.height)\r\n                });\r\n            }\r\n            BB.removeEventListener(window, \"blur\", blur);\r\n            cropCopy.destroy();\r\n            keyListener.destroy();\r\n        },\r\n        clickOnEnter: 'To Clipboard',\r\n        closefunc: function (func) {\r\n            closefunc = func;\r\n        }\r\n    });\r\n}","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * TabMenu deprecated - soon removed\r\n * @param params\r\n * @returns {HTMLDivElement}\r\n * @constructor\r\n */\r\nexport function TabMenu(params) {\r\n    let div = document.createElement(\"div\");\r\n    let width = params.width;\r\n    div.className = params.cssContainer;\r\n    BB.css(div, {\r\n        width: width + \"px\",\r\n        webkitTapHighlightColor:  'rgba(255, 255, 255, 0)'\r\n    });\r\n    let currentTabId = 0;\r\n    if (params.init) {\r\n        currentTabId = params.init;\r\n    }\r\n\r\n    let entries = [];\r\n\r\n    function updateEntries() {\r\n        for (let i = 0; i < entries.length; i++) {\r\n            if (params.entries[i].custom) {\r\n                continue;\r\n            }\r\n            if (i === currentTabId) {\r\n                entries[i].className = params.cssSelected;\r\n                BB.css(entries[i], {\r\n                    cursor: \"default\"\r\n                });\r\n            } else {\r\n                entries[i].className = params.css;\r\n                BB.css(entries[i], {\r\n                    cursor: \"pointer\"\r\n                });\r\n            }\r\n        }\r\n    }\r\n    //init entries\r\n    let widthSum = 0;\r\n    for (let i = 0; i < params.entries.length; i++) {\r\n        (function (i) {\r\n            if (params.entries[i].custom) {\r\n                entries[i] = params.entries[i].content;\r\n                entries[i].style.cssFloat = \"left\";\r\n                div.appendChild(entries[i]);\r\n            } else {\r\n                entries[i] = document.createElement(\"div\");\r\n                BB.setEventListener(entries[i], 'onpointerdown', function (e) {\r\n                    return false;\r\n                });\r\n                BB.css(entries[i], {\r\n                    width: (parseInt('' + (width / params.entries.length))) + \"px\",\r\n                    textAlign: \"center\",\r\n                    cssFloat: \"left\",\r\n                    overflow: \"hidden\",\r\n                    borderTopLeftRadius: '4px',\r\n                    borderTopRightRadius: '4px'\r\n                });\r\n                if(i === params.entries.length - 1) {\r\n                    entries[i].style.width = width - widthSum + 'px';\r\n                } else {\r\n                    widthSum += parseInt('' + (width / params.entries.length));\r\n                }\r\n                if (params.entries[i].tooltip) {\r\n                    entries[i].title = params.entries[i].tooltip;\r\n                }\r\n                if (params.custom) {\r\n                    entries[i].style.width = params.entries[i].width + \"px\";\r\n                }\r\n                if (params.height) {\r\n                    entries[i].style.height = params.height + \"px\";\r\n                }\r\n                entries[i].innerHTML = params.entries[i].content;\r\n                if (params.entries[i].name) {\r\n                    div.title = params.entries[i].name;\r\n                }\r\n                entries[i].onclick = function () {\r\n                    (div as any).show(i);\r\n                };\r\n                if (i === currentTabId) {\r\n                    params.entries[i].show();\r\n                } else {\r\n                    params.entries[i].hide();\r\n                }\r\n                div.appendChild(entries[i]);\r\n            }\r\n        })(i);\r\n    }\r\n\r\n    (div as any).show = function (i) {\r\n        if (i === currentTabId) {\r\n            return;\r\n        }\r\n        if (params.entries[i].keepState) {\r\n            params.entries[i].show();\r\n        } else {\r\n            params.entries[currentTabId].hide();\r\n            params.entries[i].show();\r\n            currentTabId = i;\r\n            updateEntries();\r\n        }\r\n    };\r\n\r\n    let clearDiv = document.createElement(\"div\");\r\n    clearDiv.style.clear = \"both\";\r\n    updateEntries();\r\n    div.appendChild(clearDiv);\r\n\r\n    return div;\r\n}\r\n","import {BB} from '../../../bb/bb';\r\nimport {popup} from '../modals/popup';\r\nimport {klHistory} from '../../history/kl-history';\r\nimport {Options} from '../base-components/options';\r\nimport {Select} from '../base-components/select';\r\nimport {PointSlider} from '../base-components/point-slider';\r\n// @ts-ignore\r\nimport addLayerImg from 'url:~/src/app/img/ui/add-layer.svg';\r\n// @ts-ignore\r\nimport duplicateLayerImg from 'url:~/src/app/img/ui/duplicate-layer.svg';\r\n// @ts-ignore\r\nimport mergeLayerImg from 'url:~/src/app/img/ui/merge-layers.svg';\r\n// @ts-ignore\r\nimport removeLayerImg from 'url:~/src/app/img/ui/remove-layer.svg';\r\n\r\n\r\nexport function pcLayerManager(p_canvas, p_func, p_rootDiv) {\r\n    let klCanvas = p_canvas;\r\n    let layerElArr = [];\r\n    let layerHeight = 35;\r\n    let layerSpacing = 0;\r\n    let width = 250;\r\n    let oldHistoryState;\r\n    let updatefunc = p_func;\r\n    let uiState = 'right'; // 'left | 'right'\r\n\r\n\r\n    let largeThumbDiv = BB.el({\r\n        onClick: BB.handleClick,\r\n        css: {\r\n            position: \"absolute\",\r\n            right: \"280px\",\r\n            top: \"500px\",\r\n            background: \"#aaa\",\r\n            boxShadow: \"1px 1px 3px rgba(0,0,0,0.3)\",\r\n            pointerEvents: \"none\",\r\n            padding: '0',\r\n            border: \"1px solid #aaa\",\r\n            transition: \"opacity 0.3s ease-out\",\r\n            userSelect: 'none',\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n    BB.createCheckerDataUrl(4, function(url) {\r\n        largeThumbDiv.style.backgroundImage = \"url(\" + url + \")\";\r\n    });\r\n    let largeThumbCanvas = document.createElement(\"canvas\");\r\n    largeThumbCanvas.style.display = \"block\";\r\n    largeThumbCanvas.width = 200;\r\n    largeThumbCanvas.height = 200;\r\n    largeThumbDiv.appendChild(largeThumbCanvas);\r\n    let largeThumbTimeout, largeThumbInTimeout;\r\n    let largeThumbInDocument = false;\r\n\r\n\r\n    let klCanvasLayerArr = klCanvas.getLayers();\r\n    let selectedSpotIndex = klCanvasLayerArr.length - 1;\r\n    let div = document.createElement(\"div\");\r\n    div.style.marginRight = \"10px\";\r\n    div.style.marginBottom = \"10px\";\r\n    div.style.marginLeft = \"10px\";\r\n    div.style.marginTop = \"10px\";\r\n    div.style.cursor = \"default\";\r\n\r\n    let listdiv = document.createElement(\"div\");\r\n    BB.css(listdiv, {\r\n        width: width + \"px\",\r\n        height: \"500px\",\r\n        position: \"relative\"\r\n\r\n    });\r\n\r\n\r\n    function renameLayer(layer) {\r\n        let div = document.createElement('div');\r\n\r\n        let label = BB.el({\r\n            content: 'Name:',\r\n            css: {\r\n                marginRight: '5px'\r\n            }\r\n        });\r\n\r\n        const row = BB.el({\r\n            css: {\r\n                display: 'flex',\r\n            }\r\n        });\r\n        let input = document.createElement('input');\r\n        input.value = klCanvas.getLayer(layer).name;\r\n        const clearBtn = BB.el({\r\n            tagName: 'Button',\r\n            content: '<img src=\"' + removeLayerImg + '\" height=\"20\"/>',\r\n            title: 'Clear Name',\r\n            css: {\r\n                marginLeft: '10px',\r\n            },\r\n            onClick: () => {\r\n                input.value = '';\r\n                input.focus();\r\n            }\r\n        });\r\n        const suggestions = ['Sketch', 'Colors', 'Lines', 'Background', 'Foreground'];\r\n        const suggestionBtns = [];\r\n        const row2 = BB.el({\r\n            css: {\r\n                display: 'flex',\r\n                flexWrap: 'wrap',\r\n                marginTop: '5px',\r\n                marginLeft: '-5px',\r\n            }\r\n        }) as HTMLDivElement;\r\n        suggestions.forEach(item => {\r\n            const btn = BB.el({\r\n                parent: row2,\r\n                tagName: 'Button',\r\n                content: item,\r\n                onClick: () => {\r\n                    input.value = btn.textContent;\r\n                },\r\n                css: {\r\n                    margin: '5px 0 0 5px',\r\n                }\r\n            });\r\n            suggestionBtns.push(btn);\r\n        });\r\n\r\n        div.appendChild(label);\r\n        label.append(row, row2);\r\n        row.append(input, clearBtn);\r\n\r\n        setTimeout(function() {\r\n            input.focus();\r\n            input.select();\r\n        }, 10);\r\n\r\n        popup({\r\n            target: p_rootDiv,\r\n            message: \"<b>Rename Layer</b>\",\r\n            div: div,\r\n            buttons: ['Rename', 'Cancel'],\r\n            primaries: ['Rename'],\r\n            callback: function (val) {\r\n                BB.destroyEl(clearBtn);\r\n                suggestionBtns.forEach(item => {\r\n                    BB.destroyEl(item);\r\n                });\r\n                suggestionBtns.splice(0, suggestionBtns.length);\r\n                if (val === \"Rename\") {\r\n                    if(input.value === klCanvas.getLayer(layer).name) {\r\n                        return;\r\n                    }\r\n                    klCanvas.renameLayer(layer, input.value.replace(/[^\\w\\s]/gi, ''));\r\n                    createLayerList();\r\n                    klHistory.pause();\r\n                    updatefunc(layer);\r\n                    klHistory.pause(false);\r\n                }\r\n            },\r\n            clickOnEnter: 'Rename'\r\n        });\r\n    }\r\n\r\n\r\n    let regularContainer = document.createElement(\"div\");\r\n\r\n    (div as any).disableButtons = function(){}; //probably remove\r\n    (div as any).enableButtons = function(){}; //probably remove\r\n    let addnewBtn = document.createElement(\"button\");\r\n    let duplicateBtn = document.createElement(\"button\");\r\n    let mergeBtn = document.createElement(\"button\");\r\n    let removeBtn = document.createElement(\"button\");\r\n    let renameBtn = document.createElement(\"button\");\r\n\r\n    function createButtons() {\r\n        let div = document.createElement(\"div\");\r\n        function async() {\r\n            BB.makeUnfocusable(addnewBtn);\r\n            BB.makeUnfocusable(duplicateBtn);\r\n            BB.makeUnfocusable(mergeBtn);\r\n            BB.makeUnfocusable(removeBtn);\r\n            BB.makeUnfocusable(renameBtn);\r\n\r\n            addnewBtn.style.cssFloat = 'left';\r\n            duplicateBtn.style.cssFloat = 'left';\r\n            mergeBtn.style.cssFloat = 'left';\r\n            removeBtn.style.cssFloat = 'left';\r\n            renameBtn.style.cssFloat = 'left';\r\n\r\n            addnewBtn.title = \"New Layer\";\r\n            duplicateBtn.title = \"Duplicate Layer\";\r\n            removeBtn.title = \"Remove Layer\";\r\n            mergeBtn.title = \"Merge with layer below\";\r\n            renameBtn.title = \"Rename layer\";\r\n\r\n            addnewBtn.style.paddingLeft = \"5px\";\r\n            addnewBtn.style.paddingRight = \"3px\";\r\n\r\n            removeBtn.style.paddingLeft = \"5px\";\r\n            removeBtn.style.paddingRight = \"3px\";\r\n\r\n            duplicateBtn.style.paddingLeft = \"5px\";\r\n            duplicateBtn.style.paddingRight = \"3px\";\r\n\r\n            mergeBtn.style.paddingLeft = \"5px\";\r\n            mergeBtn.style.paddingRight = \"3px\";\r\n\r\n            renameBtn.style.height = \"30px\";\r\n            renameBtn.style.lineHeight = \"20px\";\r\n\r\n            addnewBtn.innerHTML = \"<img src='\" + addLayerImg + \"' height='20'/> \";\r\n            duplicateBtn.innerHTML = \"<img src='\" + duplicateLayerImg + \"' height='20'/> \";\r\n            mergeBtn.innerHTML = \"<img src='\" + mergeLayerImg + \"' height='20'/>\";\r\n            removeBtn.innerHTML = \"<img src='\" + removeLayerImg + \"' height='20'/> \";\r\n            renameBtn.textContent = \"Rename\";\r\n            addnewBtn.style.marginRight = \"5px\";\r\n            removeBtn.style.marginRight = \"5px\";\r\n            duplicateBtn.style.marginRight = \"5px\";\r\n            mergeBtn.style.marginRight = \"5px\";\r\n            div.appendChild(addnewBtn);\r\n            div.appendChild(removeBtn);\r\n            div.appendChild(duplicateBtn);\r\n            div.appendChild(mergeBtn);\r\n            div.appendChild(renameBtn);\r\n            div.appendChild(BB.el({\r\n                css: {\r\n                    clear: 'both'\r\n                }\r\n            }));\r\n\r\n            let clearboth = document.createElement(\"div\");\r\n            clearboth.style.clear = \"both\";\r\n            clearboth.style.height = \"10px\";\r\n            div.appendChild(clearboth);\r\n\r\n\r\n            addnewBtn.onclick = function () {\r\n                if (klCanvas.addLayer(selectedSpotIndex) === false) {\r\n                    return;\r\n                }\r\n                klCanvasLayerArr = klCanvas.getLayers();\r\n\r\n                if (klCanvasLayerArr.length === 8) {\r\n                    addnewBtn.disabled = true;\r\n                    duplicateBtn.disabled = true;\r\n                }\r\n                removeBtn.disabled = false;\r\n                selectedSpotIndex = selectedSpotIndex + 1;\r\n                createLayerList();\r\n                klHistory.pause();\r\n                updatefunc(selectedSpotIndex);\r\n                klHistory.pause(false);\r\n            };\r\n            duplicateBtn.onclick = function () {\r\n                if (klCanvas.duplicateLayer(selectedSpotIndex) === false) {\r\n                    return;\r\n                }\r\n                klCanvasLayerArr = klCanvas.getLayers();\r\n                if (klCanvasLayerArr.length === 8) {\r\n                    addnewBtn.disabled = true;\r\n                    duplicateBtn.disabled = true;\r\n                }\r\n                removeBtn.disabled = false;\r\n                selectedSpotIndex++;\r\n                createLayerList();\r\n                klHistory.pause();\r\n                updatefunc(selectedSpotIndex);\r\n                klHistory.pause(false);\r\n            };\r\n            removeBtn.onclick = function () {\r\n                if (layerElArr.length <= 1) {\r\n                    return;\r\n                }\r\n\r\n                klCanvas.removeLayer(selectedSpotIndex);\r\n                if (selectedSpotIndex > 0) {\r\n                    selectedSpotIndex--;\r\n                }\r\n                klCanvasLayerArr = klCanvas.getLayers();\r\n                createLayerList();\r\n                klHistory.pause();\r\n                updatefunc(selectedSpotIndex);\r\n                klHistory.pause(false);\r\n                if (klCanvasLayerArr.length === 1) {\r\n                    removeBtn.disabled = true;\r\n                }\r\n                if (klCanvasLayerArr.length < 8) {\r\n                    addnewBtn.disabled = false;\r\n                    duplicateBtn.disabled = false;\r\n                }\r\n            };\r\n            mergeBtn.onclick = function () {\r\n                if (selectedSpotIndex <= 0) {\r\n                    return;\r\n                }\r\n\r\n                function mergeDialog(p) {\r\n                    let div = document.createElement(\"div\");\r\n                    div.innerHTML = \"Merges the selected layer with the one underneath. Select the mix mode:\";\r\n\r\n                    let options = new Options({\r\n                        optionArr: [\r\n                            {id: p.mixModeStr, label: p.mixModeStr === 'source-over' ? 'normal' : p.mixModeStr},\r\n                            {id: 'source-in', label: 'source-in'},\r\n                            {id: 'source-out', label: 'source-out'},\r\n                            {id: 'source-atop', label: 'source-atop'},\r\n                            {id: 'destination-in', label: 'destination-in'},\r\n                            {id: 'destination-out', label: 'destination-out'},\r\n                            {id: 'destination-atop', label: 'destination-atop'},\r\n                            {id: 'xor', label: 'xor'}\r\n                        ],\r\n                        initId: p.mixModeStr,\r\n                        onChange: function(id) {\r\n                            update();\r\n                        },\r\n                        isSmall: true\r\n                    });\r\n                    options.getElement().style.marginTop = '5px';\r\n                    div.appendChild(options.getElement());\r\n\r\n                    let preview = document.createElement(\"canvas\");\r\n                    let spacer = document.createElement(\"div\");\r\n                    spacer.innerHTML = \"<br/>\";\r\n                    spacer.style.clear = \"both\";\r\n                    div.appendChild(spacer);\r\n                    div.appendChild(preview);\r\n                    let thumbDimensions = BB.fitInto(p.topCanvas.width, p.topCanvas.height, 200, 200, 1);\r\n                    preview.width = thumbDimensions.width;\r\n                    preview.height = thumbDimensions.height;\r\n                    BB.css(preview, {\r\n                        display: \"block\",\r\n                        marginLeft: \"auto\",\r\n                        marginRight: \"auto\",\r\n                        colorScheme: 'only light',\r\n                    });\r\n                    preview.style.boxShadow = \"0 0 3px rgba(0,0,0,0.5)\";\r\n                    BB.createCheckerDataUrl(4, function(url) {\r\n                        preview.style.backgroundImage = \"url(\" + url + \")\";\r\n                    });\r\n\r\n                    let alphaCanvas = BB.copyCanvas(preview);\r\n                    alphaCanvas.getContext(\"2d\").drawImage(p.topCanvas, 0, 0, alphaCanvas.width, alphaCanvas.height);\r\n                    BB.convertToAlphaChannelCanvas(alphaCanvas);\r\n\r\n                    function update() {\r\n                        let ctx = preview.getContext(\"2d\");\r\n                        ctx.save();\r\n                        ctx.clearRect(0, 0, preview.width, preview.height);\r\n                        if (preview.width > p.topCanvas.width) {\r\n                            ctx.imageSmoothingEnabled = false;\r\n                        }\r\n                        ctx.drawImage(p.bottomCanvas, 0, 0, preview.width, preview.height);\r\n\r\n                        if(options.getValue() === 'as-alpha') {\r\n                            ctx.globalCompositeOperation = 'destination-in';\r\n                            ctx.globalAlpha = p.topOpacity;\r\n                            ctx.drawImage(alphaCanvas, 0, 0, preview.width, preview.height);\r\n                        } else {\r\n                            ctx.globalCompositeOperation = options.getValue();\r\n                            ctx.globalAlpha = p.topOpacity;\r\n                            ctx.drawImage(p.topCanvas, 0, 0, preview.width, preview.height);\r\n                        }\r\n                        ctx.restore();\r\n                    }\r\n\r\n                    update();\r\n\r\n\r\n                    let keyListener = new BB.KeyListener({\r\n                        onDown: function(keyStr) {\r\n                            if (keyStr === 'right') {\r\n                                options.next();\r\n                            }\r\n                            if (keyStr === 'left') {\r\n                                options.previous();\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    popup({\r\n                        target: p_rootDiv,\r\n                        message: \"<b>Merge/Mix Layers</b>\",\r\n                        div: div,\r\n                        buttons: [\"Ok\", \"Cancel\"],\r\n                        clickOnEnter: 'Ok',\r\n                        callback: function (val) {\r\n                            keyListener.destroy();\r\n                            options.destroy();\r\n                            if (val === \"Ok\") {\r\n                                p.callback(options.getValue());\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n                mergeDialog({\r\n                    topCanvas: klCanvasLayerArr[selectedSpotIndex].context.canvas,\r\n                    bottomCanvas: klCanvasLayerArr[selectedSpotIndex - 1].context.canvas,\r\n                    topOpacity: parseFloat(klCanvas.getLayer(selectedSpotIndex).opacity),\r\n                    mixModeStr: klCanvasLayerArr[selectedSpotIndex].mixModeStr,\r\n                    callback: function (mode) {\r\n                        klCanvas.mergeLayers(selectedSpotIndex, selectedSpotIndex - 1, mode);\r\n                        klCanvasLayerArr = klCanvas.getLayers();\r\n                        selectedSpotIndex--;\r\n                        if (klCanvasLayerArr.length === 1) {\r\n                            removeBtn.disabled = true;\r\n                        }\r\n                        if (klCanvasLayerArr.length < 8) {\r\n                            addnewBtn.disabled = false;\r\n                            duplicateBtn.disabled = false;\r\n                        }\r\n                        createLayerList();\r\n                        klHistory.pause();\r\n                        updatefunc(selectedSpotIndex);\r\n                        klHistory.pause(false);\r\n                    }\r\n                });\r\n            };\r\n\r\n            renameBtn.onclick = function () {\r\n                renameLayer(selectedSpotIndex);\r\n            };\r\n        }\r\n        setTimeout(async, 1);\r\n        return div;\r\n    }\r\n    div.appendChild(createButtons());\r\n\r\n    let modeWrapper;\r\n    let modeSelect;\r\n    {\r\n        modeWrapper = BB.el({\r\n            content: 'Blending&nbsp;',\r\n            css: {\r\n                fontSize: '15px'\r\n            }\r\n        });\r\n\r\n        modeSelect = new Select({\r\n            optionArr: [\r\n                ['source-over', 'normal'],\r\n                null,\r\n                ['darken', 'darken'],\r\n                ['multiply', 'multiply'],\r\n                ['color-burn', 'color burn'],\r\n                null,\r\n                ['lighten', 'lighten'],\r\n                ['screen', 'screen'],\r\n                ['color-dodge', 'color dodge'],\r\n                null,\r\n                ['overlay', 'overlay'],\r\n                ['soft-light', 'soft light'],\r\n                ['hard-light', 'hard light'],\r\n                null,\r\n                ['difference', 'difference'],\r\n                ['exclusion', 'exclusion'],\r\n                null,\r\n                ['hue', 'hue'],\r\n                ['saturation', 'saturation'],\r\n                ['color', 'color'],\r\n                ['luminosity', 'luminosity']\r\n            ],\r\n            onChange: function(val) {\r\n                klCanvas.setMixMode(selectedSpotIndex, val);\r\n                (div as any).update(selectedSpotIndex);\r\n            },\r\n            css: {\r\n                marginBottom: '10px'\r\n            }\r\n        });\r\n\r\n        modeWrapper.appendChild(modeSelect.getElement());\r\n        div.appendChild(modeWrapper);\r\n\r\n    }\r\n\r\n\r\n    function createLayerList() {\r\n        oldHistoryState = klHistory.getState();\r\n        function createLayerEntry(index) {\r\n            let layerName = klCanvas.getLayer(index).name;\r\n            let opacity = klCanvasLayerArr[index].opacity;\r\n            let layercanvas = klCanvasLayerArr[index].context.canvas;\r\n\r\n            let layer = document.createElement(\"div\");\r\n            layer.className = \"layerBox\";\r\n            layerElArr[index] = layer;\r\n            (layer as any).posY = ((klCanvasLayerArr.length - 1) * 35 - index * 35);\r\n            BB.css(layer, {\r\n                width: \"250px\",\r\n                height: \"34px\",\r\n                backgroundColor: \"rgb( 220, 220, 220)\",\r\n                border: \"1px solid #aaa\",\r\n                position: \"absolute\",\r\n                left: \"0 px\",\r\n                top: (layer as any).posY + \"px\",\r\n                transition: \"all 0.1s linear\",\r\n                borderRadius: \"5px\",\r\n                boxSizing: 'border-box'\r\n            });\r\n            let innerLayer = document.createElement(\"div\");\r\n            BB.css(innerLayer, {\r\n                position: \"relative\"\r\n            });\r\n\r\n            let container1 = document.createElement(\"div\");\r\n            BB.css(container1, {\r\n                width: \"250px\",\r\n                height: \"34px\"\r\n            });\r\n            let container2 = document.createElement(\"div\");\r\n            layer.appendChild(innerLayer);\r\n            innerLayer.appendChild(container1);\r\n            innerLayer.appendChild(container2);\r\n\r\n            (layer as any).spot = index;\r\n\r\n            //thumb\r\n            {\r\n                let thumbDimensions = BB.fitInto(layercanvas.width, layercanvas.height, 30, 30, 1);\r\n                let thumb = (layer as any).thumb = BB.canvas(thumbDimensions.width, thumbDimensions.height);\r\n\r\n                let thc = thumb.getContext(\"2d\");\r\n                thc.save();\r\n                if (thumb.width > layercanvas.width) {\r\n                    thc.imageSmoothingEnabled = false;\r\n                }\r\n                thc.drawImage(layercanvas, 0, 0, thumb.width, thumb.height);\r\n                thc.restore();\r\n                BB.css((layer as any).thumb, {\r\n                    position: \"absolute\",\r\n                    left: ((32 - (layer as any).thumb.width) / 2) + \"px\",\r\n                    top: ((32 - (layer as any).thumb.height) / 2) + \"px\",\r\n                    colorScheme: 'only light',\r\n                });\r\n                BB.createCheckerDataUrl(4, function(url) {\r\n                    thumb.style.backgroundImage = \"url(\" + url + \")\";\r\n                });\r\n            }\r\n\r\n            //layerlabel\r\n            {\r\n                (layer as any).label = document.createElement(\"div\");\r\n                (layer as any).lname = layerName;\r\n                (layer as any).label.append((layer as any).lname);\r\n\r\n                BB.css((layer as any).label, {\r\n                    position: \"absolute\",\r\n                    left: (1 + 32 + 5) + \"px\",\r\n                    top: 1 + \"px\",\r\n                    fontSize: \"13px\",\r\n                    width: \"170px\",\r\n                    height: \"20px\",\r\n                    overflow: \"hidden\",\r\n                    color: \"#666\",\r\n                    whiteSpace: 'nowrap'\r\n                });\r\n\r\n                (layer as any).label.ondblclick = function() {\r\n                    renameLayer(index);\r\n                };\r\n            }\r\n            //layerlabel\r\n            {\r\n                (layer as any).opacityLabel = document.createElement(\"div\");\r\n                (layer as any).opacity = opacity;\r\n                (layer as any).opacityLabel.append(parseInt('' + ((layer as any).opacity * 100)) + \"%\");\r\n\r\n                BB.css((layer as any).opacityLabel, {\r\n                    position: \"absolute\",\r\n                    left: (250 - 1 - 5 - 50) + \"px\",\r\n                    top: 1 + \"px\",\r\n                    fontSize: \"13px\",\r\n                    textAlign: \"right\",\r\n                    width: \"50px\",\r\n                    color: \"#666\",\r\n                    transition: \"color 0.2s ease-in-out\"\r\n                });\r\n            }\r\n\r\n            let oldOpacity;\r\n            let opacitySlider = new PointSlider({\r\n                init: (layer as any).opacity,\r\n                width: 204,\r\n                pointSize: 14,\r\n                callback: function(sliderValue, isFirst, isLast) {\r\n                    if(isFirst) {\r\n                        oldOpacity = klCanvas.getLayer((layer as any).spot).opacity;\r\n                        klHistory.pause();\r\n                        return;\r\n                    }\r\n                    if(isLast) {\r\n                        klHistory.pause(false);\r\n                        if (oldOpacity !== sliderValue) {\r\n                            klCanvas.layerOpacity((layer as any).spot, sliderValue);\r\n                        }\r\n                        return;\r\n                    }\r\n                    (layer as any).opacityLabel.innerHTML = Math.round(sliderValue * 100) + \"%\";\r\n                    klCanvas.layerOpacity((layer as any).spot, sliderValue);\r\n                }\r\n            });\r\n            BB.css(opacitySlider.getEl(), {\r\n                position: 'absolute',\r\n                left: '39px',\r\n                top: '17px'\r\n            });\r\n            (layer as any).opacitySlider = opacitySlider;\r\n\r\n            //larger layer preview - hover\r\n            BB.setEventListener((layer as any).thumb, 'onpointerover', function (e) {\r\n                if(e.buttons !== 0 && (!e.pointerType || e.pointerType !== 'touch')) { //shouldn't show while dragging\r\n                    return;\r\n                }\r\n\r\n                let thumbDimensions = BB.fitInto(layercanvas.width, layercanvas.height, 250, 250, 1);\r\n\r\n                if(largeThumbCanvas.width !== thumbDimensions.width || largeThumbCanvas.height !== thumbDimensions.height) {\r\n                    largeThumbCanvas.width = thumbDimensions.width;\r\n                    largeThumbCanvas.height = thumbDimensions.height;\r\n                }\r\n                let ctx = largeThumbCanvas.getContext(\"2d\");\r\n                ctx.save();\r\n                if (largeThumbCanvas.width > layercanvas.width) {\r\n                    ctx.imageSmoothingEnabled = false;\r\n                }\r\n                ctx.imageSmoothingQuality = 'high';\r\n                ctx.clearRect(0, 0, largeThumbCanvas.width, largeThumbCanvas.height);\r\n                ctx.drawImage(layercanvas, 0, 0, largeThumbCanvas.width, largeThumbCanvas.height);\r\n                ctx.restore();\r\n                BB.css(largeThumbDiv, {\r\n                    top: (e.clientY - largeThumbCanvas.height / 2) + \"px\",\r\n                    opacity: '0'\r\n                });\r\n                if (largeThumbInDocument === false) {\r\n                    document.body.appendChild(largeThumbDiv);\r\n                    largeThumbInDocument = true;\r\n                }\r\n                clearTimeout(largeThumbInTimeout);\r\n                largeThumbInTimeout = setTimeout(function () {\r\n                    BB.css(largeThumbDiv, {\r\n                        opacity: '1'\r\n                    });\r\n                }, 20);\r\n                clearTimeout(largeThumbTimeout);\r\n            });\r\n            BB.setEventListener((layer as any).thumb, 'onpointerout', function () {\r\n                clearTimeout(largeThumbInTimeout);\r\n                BB.css(largeThumbDiv, {\r\n                    opacity: '0'\r\n                });\r\n                clearTimeout(largeThumbTimeout);\r\n                largeThumbTimeout = setTimeout(function () {\r\n                    if (!largeThumbInDocument) {\r\n                        return;\r\n                    }\r\n                    document.body.removeChild(largeThumbDiv);\r\n                    largeThumbInDocument = false;\r\n                }, 300);\r\n            });\r\n\r\n            container1.appendChild((layer as any).thumb);\r\n            container1.appendChild((layer as any).label);\r\n            container1.appendChild((layer as any).opacityLabel);\r\n            container1.appendChild(opacitySlider.getEl());\r\n            let dragstart = false;\r\n            let freshSelection = false;\r\n\r\n            //events for moving layers up and down\r\n            function dragEventHandler(event) {\r\n                if (event.type === 'pointerdown' && event.button === 'left') {\r\n                    BB.css(layer, {\r\n                        transition: \"box-shadow 0.3s ease-in-out\"\r\n                    });\r\n                    //dragContainer.appendChild(layer);\r\n                    layer.style.zIndex = '1';\r\n                    lastpos = (layer as any).spot;\r\n                    freshSelection = false;\r\n                    if (!(layer as any).isSelected) {\r\n                        freshSelection = true;\r\n                        (div as any).activateLayer((layer as any).spot);\r\n                    }\r\n                    dragstart = true;\r\n\r\n                } else if (event.type === 'pointermove' && event.button === 'left') {\r\n\r\n                    if (dragstart) {\r\n                        dragstart = false;\r\n                        BB.css(layer, {\r\n                            boxShadow: \"1px 3px 5px rgba(0,0,0,0.4)\"\r\n                        });\r\n                    }\r\n                    (layer as any).posY += event.dY;\r\n                    let corrected = Math.max(0, Math.min((klCanvasLayerArr.length - 1) * (35), (layer as any).posY));\r\n                    layer.style.top = corrected + \"px\";\r\n                    updateLayersVerticalPosition((layer as any).spot, posToSpot((layer as any).posY));\r\n\r\n                }\r\n                if (event.type === 'pointerup') {\r\n                    BB.css(layer, {\r\n                        transition: \"all 0.1s linear\"\r\n                    });\r\n                    setTimeout(function () {\r\n                        BB.css(layer, {\r\n                            boxShadow: \"\"\r\n                        });\r\n                    }, 20);\r\n                    (layer as any).posY = Math.max(0, Math.min((klCanvasLayerArr.length - 1) * (35), (layer as any).posY));\r\n                    //regularContainer.appendChild(layer);\r\n                    layer.style.zIndex = \"\";\r\n                    let newSpot = posToSpot((layer as any).posY);\r\n                    let oldSpot = (layer as any).spot;\r\n                    move((layer as any).spot, newSpot);\r\n                    if (oldSpot != newSpot) {\r\n                        klHistory.pause();\r\n                        updatefunc(selectedSpotIndex);\r\n                        klHistory.pause(false);\r\n                    }\r\n                    if (oldSpot === newSpot && freshSelection) {\r\n                        updatefunc(selectedSpotIndex);\r\n                    }\r\n                    freshSelection = false;\r\n                }\r\n            }\r\n\r\n            (layer as any).pointerListener = new BB.PointerListener({\r\n                target: container1,\r\n                maxPointers: 1,\r\n                onPointer: dragEventHandler\r\n            });\r\n\r\n            regularContainer.appendChild(layer);\r\n        }\r\n        layerElArr = [];\r\n        while (regularContainer.firstChild) {\r\n            let child = regularContainer.firstChild;\r\n            (child as any).pointerListener.destroy();\r\n            (child as any).opacitySlider.destroy();\r\n            regularContainer.removeChild(child);\r\n        }\r\n        for (let i = 0; i < klCanvasLayerArr.length; i++) {\r\n            createLayerEntry(i);\r\n        }\r\n        (div as any).activateLayer(selectedSpotIndex);\r\n    }\r\n\r\n\r\n    listdiv.appendChild(regularContainer);\r\n    div.appendChild(listdiv);\r\n\r\n\r\n    function posToSpot(p) {\r\n        let result = parseInt('' + ((p) / (layerHeight + layerSpacing) + 0.5));\r\n        result = Math.min(klCanvasLayerArr.length - 1, Math.max(0, result));\r\n        result = klCanvasLayerArr.length - result - 1;\r\n        return result;\r\n    }\r\n\r\n    let lastpos = 0;\r\n\r\n    //update css position of all layers that are not being dragged, while dragging\r\n    function updateLayersVerticalPosition(id, newspot) {\r\n        newspot = Math.min(klCanvasLayerArr.length - 1, Math.max(0, newspot));\r\n        if(newspot === lastpos) {\r\n            return;\r\n        }\r\n        for (let i = 0; i < klCanvasLayerArr.length; i++) {\r\n            if (layerElArr[i].spot === id) { // <- here\r\n                continue;\r\n            }\r\n            let posy = layerElArr[i].spot;\r\n            if (layerElArr[i].spot > id) {\r\n                posy--;\r\n            }\r\n            if (posy >= newspot) {\r\n                posy++;\r\n            }\r\n            layerElArr[i].posY = (layerHeight + layerSpacing) * (klCanvasLayerArr.length - posy - 1);\r\n            layerElArr[i].style.top = layerElArr[i].posY + \"px\";\r\n        }\r\n        lastpos = newspot;\r\n    }\r\n\r\n    function move(oldSpotIndex, newSpotIndex) {\r\n        if(isNaN(oldSpotIndex) || isNaN(newSpotIndex)) {\r\n            throw 'layermanager - invalid move';\r\n        }\r\n        for (let i = 0; i < klCanvasLayerArr.length; i++) {\r\n            (function (i) {\r\n                let posy = layerElArr[i].spot; // <- here\r\n                if (layerElArr[i].spot === oldSpotIndex) {\r\n                    posy = newSpotIndex;\r\n                } else {\r\n                    if (layerElArr[i].spot > oldSpotIndex)\r\n                        posy--;\r\n                    if (posy >= newSpotIndex)\r\n                        posy++;\r\n                }\r\n                layerElArr[i].spot = posy;\r\n                layerElArr[i].posY = (layerHeight + layerSpacing) * (klCanvasLayerArr.length - posy - 1);\r\n                layerElArr[i].style.top = layerElArr[i].posY + \"px\";\r\n            }(i));\r\n        }\r\n        if (oldSpotIndex === newSpotIndex) {\r\n            return;\r\n        }\r\n        klCanvas.moveLayer(selectedSpotIndex, newSpotIndex - oldSpotIndex);\r\n        klCanvasLayerArr = klCanvas.getLayers();\r\n        selectedSpotIndex = newSpotIndex;\r\n        mergeBtn.disabled = selectedSpotIndex === 0;\r\n    }\r\n\r\n\r\n    //updating the thumbs in interval\r\n    //don't update when: manager not visible || layer didn't change || is drawing\r\n    let updateThumbsInterval = setInterval(function() {\r\n        if(div.style.display !== \"block\") {\r\n            return;\r\n        }\r\n\r\n        let historyState = klHistory.getState();\r\n        if (historyState === oldHistoryState) {\r\n            return;\r\n        }\r\n        oldHistoryState = historyState;\r\n\r\n        for(let i = 0; i < layerElArr.length; i++) {\r\n            if (selectedSpotIndex === layerElArr[i].spot && klCanvasLayerArr[layerElArr[i].spot]) { // second check, because might be out of date\r\n                let ctx = layerElArr[i].thumb.getContext(\"2d\");\r\n                ctx.save();\r\n                ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n                if (klCanvasLayerArr[layerElArr[i].spot].context.canvas.width < layerElArr[i].thumb.width) {\r\n                    ctx.imageSmoothingEnabled = false;\r\n                }\r\n                ctx.drawImage(klCanvasLayerArr[layerElArr[i].spot].context.canvas, 0, 0, layerElArr[i].thumb.width, layerElArr[i].thumb.height);\r\n                ctx.restore();\r\n            }\r\n        }\r\n\r\n    }, 1);\r\n\r\n\r\n\r\n    (div as any).update = function (activeLayerSpotIndex) {\r\n        klCanvasLayerArr = klCanvas.getLayers();\r\n        if(activeLayerSpotIndex || activeLayerSpotIndex === 0) {\r\n            selectedSpotIndex = activeLayerSpotIndex;\r\n        }\r\n        removeBtn.disabled = klCanvasLayerArr.length === 1;\r\n        if (klCanvasLayerArr.length === 8) {\r\n            addnewBtn.disabled = true;\r\n            duplicateBtn.disabled = true;\r\n        } else {\r\n            addnewBtn.disabled = false;\r\n            duplicateBtn.disabled = false;\r\n        }\r\n        setTimeout(function() {\r\n            createLayerList();\r\n        }, 1);\r\n    };\r\n    (div as any).getSelected = function () {\r\n        return selectedSpotIndex;\r\n    };\r\n    (div as any).activateLayer = function (spotIndex) {\r\n        if(spotIndex < 0 || spotIndex > layerElArr.length - 1) {\r\n            throw 'invalid spotIndex ' + spotIndex + ', layerElArr.length ' + layerElArr.length;\r\n        }\r\n        selectedSpotIndex = spotIndex;\r\n        modeSelect.setValue(klCanvasLayerArr[selectedSpotIndex].mixModeStr);\r\n        for (let i = 0; i < layerElArr.length; i++) {\r\n            if (selectedSpotIndex === layerElArr[i].spot) {\r\n                layerElArr[i].style.backgroundColor = \"rgb( 250, 250, 250)\";\r\n                layerElArr[i].label.style.color = \"#000\";\r\n                layerElArr[i].style.boxShadow = \"\";\r\n                layerElArr[i].style.border = \"1px solid var(--active-highlight-color)\";\r\n                layerElArr[i].opacitySlider.setActive(true);\r\n                layerElArr[i].isSelected = true;\r\n            } else {\r\n                layerElArr[i].style.backgroundColor = \"rgb( 220, 220, 220)\";\r\n                layerElArr[i].label.style.color = \"#666\";\r\n                layerElArr[i].style.boxShadow = \"\";\r\n                layerElArr[i].style.border = \"1px solid rgb(158, 158, 158)\";\r\n                layerElArr[i].opacitySlider.setActive(false);\r\n                layerElArr[i].isSelected = false;\r\n            }\r\n        }\r\n        mergeBtn.disabled = selectedSpotIndex === 0;\r\n    };\r\n    (div as any).setUiState = function(stateStr) {\r\n        uiState = '' + stateStr;\r\n\r\n        if (uiState === 'left') {\r\n            BB.css(largeThumbDiv, {\r\n                left: '280px',\r\n                right: ''\r\n            });\r\n        } else {\r\n            BB.css(largeThumbDiv, {\r\n                left: '',\r\n                right: '280px'\r\n            });\r\n        }\r\n    };\r\n\r\n    createLayerList();\r\n\r\n    return div;\r\n}\r\n","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"1mb1v\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"11KJK\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"floUo\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"kino6\");","import {BB} from '../../bb/bb';\r\n\r\n/**\r\n * Overlay for KlCanvasWorkspace.\r\n * - brush circle\r\n * - eyedropper circle\r\n * - compass needle (rotation hud)\r\n *\r\n * @param p - {width: number, height: number}\r\n * @constructor\r\n */\r\nexport function WorkspaceSvgOverlay(p) {\r\n\r\n    const namespaceStr = 'http://www.w3.org/2000/svg';\r\n    let rootElement = document.createElementNS(namespaceStr, 'svg');\r\n    BB.css(rootElement, {\r\n        position: 'absolute',\r\n        left: '0',\r\n        top: '0',\r\n        pointerEvents: 'none',\r\n        userSelect: 'none'\r\n    });\r\n    rootElement.setAttribute('width', p.width);\r\n    rootElement.setAttribute('height', p.height);\r\n\r\n    //brush circles\r\n    let brushCircleOuter = document.createElementNS(namespaceStr, 'circle');\r\n    brushCircleOuter.setAttribute('r', '10'); //temp\r\n    brushCircleOuter.setAttribute('stroke', 'rgba(0,0,0,0.7)');\r\n    brushCircleOuter.setAttribute('stroke-width', '1');\r\n    brushCircleOuter.setAttribute('fill', 'none');\r\n    //circleElement.setAttribute('shape-rendering', 'optimizeSpeed');\r\n    let brushCircleInner = document.createElementNS(namespaceStr, 'circle');\r\n    brushCircleInner.setAttribute('r', '9'); //temp\r\n    brushCircleInner.setAttribute('stroke', 'rgba(255,255,255,0.7)');\r\n    brushCircleInner.setAttribute('stroke-width', '1');\r\n    brushCircleInner.setAttribute('fill', 'none');\r\n    //brushCircleInner.setAttribute('shape-rendering', 'optimizeSpeed');\r\n    rootElement.appendChild(brushCircleOuter);\r\n    rootElement.appendChild(brushCircleInner);\r\n\r\n    //color picker preview circle\r\n    let pickerPreviewBorder = document.createElementNS(namespaceStr, 'circle');\r\n    pickerPreviewBorder.setAttribute('r', '47');\r\n    pickerPreviewBorder.setAttribute('stroke', 'black'); //temp\r\n    pickerPreviewBorder.setAttribute('stroke-width', '22');\r\n    pickerPreviewBorder.setAttribute('fill', 'none');\r\n    pickerPreviewBorder.style.opacity = '0';\r\n    let pickerPreviewCol = document.createElementNS(namespaceStr, 'circle');\r\n    pickerPreviewCol.setAttribute('r', '47');\r\n    pickerPreviewCol.setAttribute('stroke', 'black'); //temp\r\n    pickerPreviewCol.setAttribute('stroke-width', '20');\r\n    pickerPreviewCol.setAttribute('fill', 'none');\r\n    pickerPreviewCol.style.opacity = '0';\r\n    rootElement.appendChild(pickerPreviewBorder);\r\n    rootElement.appendChild(pickerPreviewCol);\r\n\r\n\r\n\r\n\r\n    //rotation compass\r\n    let compassSize = 30;\r\n    let compass = document.createElementNS(namespaceStr, 'g');\r\n    let compassInner = document.createElementNS(namespaceStr, 'g');\r\n    let compassBaseCircle = document.createElementNS(namespaceStr, 'circle');\r\n    let compassLineCircle = document.createElementNS(namespaceStr, 'circle');\r\n    let compassUpperTriangle = document.createElementNS(namespaceStr, 'path');\r\n    let compassLowerTriangle = document.createElementNS(namespaceStr, 'path');\r\n\r\n    compassInner.appendChild(compassBaseCircle);\r\n    compassInner.appendChild(compassLineCircle);\r\n    compassInner.appendChild(compassUpperTriangle);\r\n    compassInner.appendChild(compassLowerTriangle);\r\n    compass.appendChild(compassInner);\r\n    rootElement.appendChild(compass);\r\n\r\n    compass.style.transition = 'opacity 0.25s ease-in-out';\r\n    compass.style.opacity = '0';\r\n\r\n    compass.setAttribute('transform', 'translate(' + (p.width/2) + ', ' + (p.height/2) + ')');\r\n    compassInner.setAttribute('transform', 'rotate(45)');\r\n    compassBaseCircle.setAttribute('fill', 'rgba(0,0,0,0.9)');\r\n    compassBaseCircle.setAttribute('stroke', 'none');\r\n    compassLineCircle.setAttribute('fill', 'none');\r\n    compassLineCircle.setAttribute('stroke', 'rgba(255,255,255,0.75)');\r\n    compassLineCircle.setAttribute('stroke-width', '1');\r\n    compassUpperTriangle.setAttribute('fill', '#f00');\r\n    compassUpperTriangle.setAttribute('stroke', 'none');\r\n    compassLowerTriangle.setAttribute('fill', '#fff');\r\n    compassLowerTriangle.setAttribute('stroke', 'none');\r\n\r\n    compassBaseCircle.setAttribute('cx', '0');\r\n    compassBaseCircle.setAttribute('cy', '0');\r\n    compassBaseCircle.setAttribute('r', '' + compassSize);\r\n    compassLineCircle.setAttribute('cx', '0');\r\n    compassLineCircle.setAttribute('cy', '0');\r\n    compassLineCircle.setAttribute('r', '' + (compassSize * 0.9));\r\n    compassUpperTriangle.setAttribute('d', 'M -'+(compassSize * 0.25)+',0 '+(compassSize * 0.25)+',0 0,-'+(compassSize * 0.9)+' z');\r\n    compassLowerTriangle.setAttribute('d', 'M -'+(compassSize * 0.25)+',0 '+(compassSize * 0.25)+',0 0,'+(compassSize * 0.9)+' z');\r\n\r\n\r\n\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return rootElement;\r\n    }\r\n    this.setSize = function(width, height) {\r\n        rootElement.setAttribute('width', width);\r\n        rootElement.setAttribute('height', height);\r\n        compass.setAttribute('transform', 'translate(' + (width/2) + ', ' + (height/2) + ')');\r\n    };\r\n    this.updateCursor = function(p) {\r\n\r\n        if('x' in p) {\r\n            brushCircleOuter.setAttribute('cx', p.x);\r\n            brushCircleInner.setAttribute('cx', p.x);\r\n        }\r\n        if('y' in p) {\r\n            brushCircleOuter.setAttribute('cy', p.y);\r\n            brushCircleInner.setAttribute('cy', p.y);\r\n        }\r\n        if('radius' in p) {\r\n            brushCircleOuter.setAttribute('r', '' + Math.max(0, p.radius));\r\n            brushCircleInner.setAttribute('r', '' + Math.max(0, p.radius - 1));\r\n        }\r\n        if('isVisible' in p) {\r\n            brushCircleOuter.style.opacity = p.isVisible ? '1' : '0';\r\n            brushCircleInner.style.opacity = p.isVisible ? '1' : '0';\r\n        }\r\n\r\n    };\r\n    this.updateColorPreview = function(p) {\r\n\r\n        if('x' in p) {\r\n            pickerPreviewCol.setAttribute('cx', p.x);\r\n            pickerPreviewBorder.setAttribute('cx', p.x);\r\n        }\r\n        if('y' in p) {\r\n            pickerPreviewCol.setAttribute('cy', p.y);\r\n            pickerPreviewBorder.setAttribute('cy', p.y);\r\n        }\r\n        if('color' in p) {\r\n            pickerPreviewCol.setAttribute('stroke', \"rgb(\" + parseInt(p.color.r, 10) + \", \" + parseInt(p.color.g, 10) + \", \" + parseInt(p.color.b, 10) + \")\");\r\n            let borderColor = BB.testIsWhiteBestContrast(p.color) ? 'rgba(255,255,255,0.5)' : 'rgba(0,0,0,0.5)'\r\n            pickerPreviewBorder.setAttribute('stroke', borderColor);\r\n        }\r\n        if('isVisible' in p) {\r\n            pickerPreviewCol.style.opacity = p.isVisible ? '1' : '0';\r\n            pickerPreviewBorder.style.opacity = p.isVisible ? '1' : '0';\r\n        }\r\n\r\n    };\r\n    this.updateCompass = function(p) {\r\n\r\n        if('angleDeg' in p) {\r\n            compassInner.setAttribute('transform', 'rotate('+p.angleDeg+')');\r\n            compassLineCircle.style.opacity = p.angleDeg % 90 === 0 ? '1' : '0';\r\n        }\r\n        if('isVisible' in p) {\r\n            compass.style.opacity = p.isVisible ? '1' : '0';\r\n        }\r\n\r\n    };\r\n}","import {BB} from '../../bb/bb';\r\nimport {ITransform} from '../kl.types';\r\nimport {WorkspaceSvgOverlay} from './workspace-svg-overlay';\r\nimport {klHistory} from '../history/kl-history';\r\n// @ts-ignore\r\nimport pickerImg from 'url:~/src/app/img/ui/cursor-picker.png';\r\n// @ts-ignore\r\nimport zoomEwImg from 'url:~/src/app/img/ui/cursor-zoom-ew.png';\r\n// @ts-ignore\r\nimport fillImg from 'url:~/src/app/img/ui/cursor-fill.png';\r\n// @ts-ignore\r\nimport textImg from 'url:~/src/app/img/ui/cursor-text.png';\r\n\r\nexport interface IViewChangeEvent {\r\n    changed: ('scale' | 'angle')[];\r\n    angle: number;\r\n    scale: number;\r\n}\r\n\r\n/**\r\n * Work area that displays the KlCanvas.\r\n * - pan, zoom, rotate (also via multi-touch)\r\n * - input modes: drawing, hand, pick, fill, text // transform, select\r\n * - drawing input events\r\n * - view change events\r\n * - eyedropper input events (pick)\r\n * - draws cursor, eyedropper overlay\r\n *\r\n * subscribes to klCanvas changes\r\n * listens to kl history for changes\r\n * and you can manually trigger redraw\r\n *\r\n * p: {\r\n *      klCanvas: klCanvas,\r\n *      width: number,\r\n *      height: number,\r\n *      onDraw: func(val),\r\n *      onPick: func(rgb, isPointerup),\r\n *      onFill: func(canvasX, canvasY),\r\n *      onText: func(canvasX, canvasY, angleRad),\r\n *      onShape: func('down'|'up', canvasX, canvasY, angleRad),\r\n *      onViewChange: func(IViewChangeEvent),\r\n *      onUndo: func(),\r\n *      onRedo: func(),\r\n *      mode: 'draw' | 'pick' | 'hand' | 'fill' | 'text' // | 'transform' | 'select'\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function KlCanvasWorkspace(p: {\r\n    klCanvas: any; // todo\r\n    width: number;\r\n    height: number;\r\n    onDraw: (val) => any; // todo\r\n    onPick: (rgb, isPointerup) => any; // todo\r\n    onFill: (canvasX, canvasY) => any; // todo\r\n    onText: (canvasX, canvasY, angleRad) => any; // todo\r\n    onShape: (type: 'down' | 'up' | 'move', canvasX, canvasY, angleRad) => any; // todo\r\n    onViewChange: (e:  IViewChangeEvent) => void;\r\n    onUndo: () => void;\r\n    onRedo: () => void;\r\n}) {\r\n\r\n    let _this = this;\r\n    let div = document.createElement('div');\r\n    let klCanvas = p.klCanvas;\r\n    let renderTargetCanvas = BB.canvas(p.width, p.height);\r\n    let renderTargetCtx = renderTargetCanvas.getContext('2d');\r\n    let renderWidth = p.width;\r\n    let renderHeight = p.height;\r\n    let compositeCanvas = BB.canvas(1, 1); // for drawing klcanvas layer composite\r\n    let compositeCtx = compositeCanvas.getContext('2d');\r\n    let doResizeCanvas = false;\r\n    let oldTransformObj = null;\r\n    let targetTransformObj: ITransform = { // animation target\r\n        x: 0,\r\n        y: 0,\r\n        scale: 1,\r\n        angle: 0 // rad\r\n    };\r\n    let highResTransformObj: ITransform = { // animated, internal high res\r\n        x: 0,\r\n        y: 0,\r\n        scale: 1,\r\n        angle: 0 // rad\r\n    };\r\n    let renderedTransformObj: ITransform = {\r\n        x: null,\r\n        y: null,\r\n        scale: null,\r\n        angle: null\r\n    }; // same as animated, but rounded - what's actually displayed\r\n    let cursorPos = {\r\n        x: 0,\r\n        y: 0\r\n    };\r\n    let usesCssCursor = false;\r\n    let bgVisible = true;\r\n    let transformIsDirty = true;\r\n    let doAnimateTranslate = true;\r\n\r\n    //rounded x & y so canvas is less blurry.\r\n    function getRenderedTransform() {\r\n        let result = renderedTransformObj;\r\n        result.x = highResTransformObj.x;\r\n        result.y = highResTransformObj.y;\r\n        result.scale = highResTransformObj.scale;\r\n        result.angle = highResTransformObj.angle;\r\n\r\n        if(result.angle % (Math.PI / 2) === 0 && result.scale % 1 === 0) {\r\n            result.x = Math.round(result.x);\r\n            result.y = Math.round(result.y);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    let svgOverlay = new WorkspaceSvgOverlay({\r\n        width: p.width,\r\n        height: p.height\r\n    });\r\n\r\n    BB.css(renderTargetCanvas, {\r\n        userSelect: 'none',\r\n        pointerEvents: 'none' //,\r\n        //imageRendering: 'pixelated'\r\n    });\r\n    BB.createCheckerDataUrl(8, function(url) {\r\n        renderTargetCanvas.style.background = \"url(\" + url + \")\";\r\n    });\r\n    div.appendChild(renderTargetCanvas);\r\n    div.appendChild(svgOverlay.getElement());\r\n    BB.css(div, {\r\n        position: 'absolute',\r\n        left: '0',\r\n        right: '0',\r\n        top: '0',\r\n        bottom: '0',\r\n        cursor: 'crosshair',\r\n        userSelect: 'none',\r\n        colorScheme: 'only light',\r\n    });\r\n    BB.addEventListener(div, 'touchend', function(e) {\r\n        e.preventDefault();\r\n        return false;\r\n    });\r\n    BB.addEventListener(div, 'contextmenu', function(e) {\r\n        e.preventDefault();\r\n        return false;\r\n    });\r\n    BB.addEventListener(div, 'dragstart', function(e) {\r\n        e.preventDefault();\r\n        return false;\r\n    });\r\n\r\n    let emptyCanvas = BB.canvas(1, 1);\r\n    {\r\n        let ctx = emptyCanvas.getContext('2d');\r\n        ctx.fillRect(0, 0, 1, 1);\r\n    }\r\n    let MIN_SCALE = 1 / 16, MAX_SCALE = 64;\r\n\r\n    let keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, event, comboStr, isRepeat) {\r\n\r\n            if(keyStr === 'alt') {\r\n                event.preventDefault();\r\n            }\r\n            if(isRepeat) {\r\n                return;\r\n            }\r\n\r\n            if(currentInputProcessor) {\r\n                currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\r\n\r\n            } else {\r\n\r\n                if ([MODE_DRAW, MODE_PICK, MODE_FILL, MODE_TEXT, MODE_SHAPE].includes(globalMode) && comboStr === 'space') {\r\n                    currentInputProcessor = inputProcessorObj.spaceHand;\r\n                    currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\r\n                    return;\r\n                }\r\n\r\n                if ([MODE_DRAW, MODE_HAND, MODE_FILL, MODE_TEXT, MODE_SHAPE].includes(globalMode) && comboStr === 'alt') {\r\n                    currentInputProcessor = inputProcessorObj.altPicker;\r\n                    currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\r\n                    return;\r\n                }\r\n\r\n                if (['r', 'shift+r'].includes(comboStr)) {\r\n                    currentInputProcessor = inputProcessorObj.rotate;\r\n                    currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\r\n                    return;\r\n                }\r\n\r\n                if ('z' === comboStr) {\r\n                    currentInputProcessor = inputProcessorObj.zoom;\r\n                    currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\r\n                    return;\r\n                }\r\n\r\n            }\r\n\r\n        },\r\n        onUp: function(keyStr, event, oldComboStr) {\r\n\r\n            if(currentInputProcessor) {\r\n                currentInputProcessor.onKeyUp(keyStr, event, oldComboStr);\r\n            } else {\r\n            }\r\n\r\n        }\r\n    });\r\n\r\n    function updateChangeListener() {\r\n        klCanvas.addChangeListener(function() {\r\n            lastRenderedState = -1;\r\n            requestFrame();\r\n        });\r\n    }\r\n    updateChangeListener();\r\n\r\n\r\n    let MODE_DRAW = 0, MODE_HAND = 1, MODE_HAND_GRABBING = 2,\r\n        MODE_PICK = 3, MODE_ZOOM = 4, MODE_ROTATE = 5,\r\n        MODE_ROTATING = 6, MODE_FILL = 7, MODE_TEXT = 8, MODE_SHAPE = 9;\r\n    let currentMode = MODE_DRAW;\r\n    let globalMode = MODE_DRAW;\r\n\r\n    /**\r\n     *\r\n     * @param modeStr 'draw' | 'hand' | 'pick' | 'fill'\r\n     */\r\n    function updateCursor(modeInt, doForce?) {\r\n        if(modeInt === currentMode && !doForce) {\r\n            return;\r\n        }\r\n        let oldMode = currentMode;\r\n        currentMode = modeInt;\r\n        lastRenderedState = -1;\r\n        if(currentMode === MODE_DRAW) {\r\n            div.style.cursor = 'crosshair';\r\n        } else if (currentMode === MODE_HAND) {\r\n            div.style.cursor = 'grab';\r\n        } else if (currentMode === MODE_HAND_GRABBING) {\r\n            div.style.cursor = 'grabbing';\r\n        } else if (currentMode === MODE_PICK) {\r\n            div.style.cursor = \"url('\" + pickerImg + \"') 0 15, crosshair\";\r\n        } else if (currentMode === MODE_ZOOM) {\r\n            div.style.cursor = \"url('\" + zoomEwImg + \"') 7 7, zoom-in\";\r\n        } else if (currentMode === MODE_ROTATE) {\r\n            div.style.cursor = \"grab\";\r\n        } else if (currentMode === MODE_ROTATING) {\r\n            div.style.cursor = \"grabbing\";\r\n        } else if (currentMode === MODE_FILL) {\r\n            div.style.cursor = \"url('\" + fillImg + \"') 1 12, crosshair\";\r\n        } else if (currentMode === MODE_TEXT) {\r\n            div.style.cursor = \"url('\" + textImg + \"') 1 12, crosshair\";\r\n        } else if (currentMode === MODE_SHAPE) {\r\n            div.style.cursor = 'crosshair';\r\n        }\r\n\r\n        if([MODE_DRAW, MODE_PICK, MODE_FILL, MODE_TEXT, MODE_SHAPE].includes(globalMode)) {\r\n            let oldIsHand = [MODE_HAND, MODE_HAND_GRABBING].includes(oldMode);\r\n            let currentIsHand = [MODE_HAND, MODE_HAND_GRABBING].includes(currentMode);\r\n            if (!oldIsHand && currentIsHand) {\r\n                mainDoubleTapper.setAllowedPointerTypeArr(['mouse', 'pen', 'touch']);\r\n            }\r\n            if (oldIsHand && !currentIsHand) {\r\n                mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\r\n            }\r\n        }\r\n\r\n        if(currentMode !== MODE_PICK) {\r\n            svgOverlay.updateColorPreview({isVisible: false});\r\n        }\r\n    }\r\n\r\n    function internalZoomByStep(stepNum, centerX, centerY) {\r\n\r\n        let step = Math.log2(targetTransformObj.scale);\r\n\r\n        let newStep = step / Math.abs(stepNum);\r\n        newStep += stepNum > 0 ? 1 : -1;\r\n        newStep = Math.round(newStep);\r\n        newStep *= Math.abs(stepNum);\r\n        let newScale = Math.max(MIN_SCALE, Math.min(MAX_SCALE, Math.pow(2, newStep)));\r\n\r\n        //has zoomed?\r\n        if (newScale === targetTransformObj.scale) {\r\n            return false;\r\n        }\r\n\r\n\r\n        let effectiveFactor = newScale / targetTransformObj.scale;\r\n        targetTransformObj.scale = newScale;\r\n\r\n        let matrix = BB.Matrix.getIdentity();\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(centerX, centerY));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(effectiveFactor));\r\n        //matrix = multiplyMatrices(matrix, createRotationMatrix(val.angle));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-centerX, -centerY));\r\n        //matrix = multiplyMatrices(matrix, createTranslationMatrix(val.x - val.startX, val.y - val.startY));\r\n\r\n        let origin = [targetTransformObj.x, targetTransformObj.y, 0, 1];\r\n        origin = BB.Matrix.multiplyMatrixAndPoint(matrix, origin);\r\n        targetTransformObj.x = origin[0];\r\n        targetTransformObj.y = origin[1];\r\n\r\n        /*if(transform.scale === 1) {\r\n            transform.x = Math.round(transform.x);\r\n            transform.y = Math.round(transform.y);\r\n        }*/\r\n\r\n        transformIsDirty = true;\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * mixes two transform objects. modifies A\r\n     * @param transformA\r\n     * @param transformB\r\n     * @param blendFactor 0 -> A, 1 -> B\r\n     */\r\n    function mixTransformObj(transformA, transformB, blendFactor) {\r\n\r\n        if (transformA.angle === transformB.angle) {\r\n            transformA.scale = BB.mix(transformA.scale, transformB.scale, blendFactor);\r\n            transformA.x = BB.mix(transformA.x, transformB.x, blendFactor);\r\n            transformA.y = BB.mix(transformA.y, transformB.y, blendFactor);\r\n            transformA.angle = BB.mix(transformA.angle, transformB.angle, blendFactor);\r\n            return;\r\n        }\r\n\r\n        let w = klCanvas.getWidth();\r\n        let h = klCanvas.getHeight();\r\n\r\n        // --- determine centerPosA, centerPosB ---\r\n        let centerPosA = canvasToWorkspaceCoord({\r\n            x: w / 2,\r\n            y: h / 2\r\n        }, transformA);\r\n        let centerPosB = canvasToWorkspaceCoord({\r\n            x: w / 2,\r\n            y: h / 2\r\n        }, transformB);\r\n\r\n        // --- centerPosMixed ---\r\n        transformA.x = BB.mix(centerPosA.x , centerPosB.x, blendFactor);\r\n        transformA.y = BB.mix(centerPosA.y , centerPosB.y, blendFactor);\r\n\r\n        // --- scale and angle ---\r\n        transformA.scale = BB.mix(transformA.scale, transformB.scale, blendFactor);\r\n        transformA.angle = BB.mix(transformA.angle, transformB.angle, blendFactor);\r\n\r\n        // --- x and y ---\r\n        let mixedPos = canvasToWorkspaceCoord({\r\n            x: -w / 2,\r\n            y: -h / 2\r\n        }, transformA);\r\n        transformA.x = mixedPos.x;\r\n        transformA.y = mixedPos.y;\r\n\r\n    }\r\n\r\n    let renderTime = 0;\r\n    function render() {\r\n\r\n        if(doResizeCanvas) {\r\n            doResizeCanvas = false;\r\n            renderTargetCanvas.width = renderWidth;\r\n            renderTargetCanvas.height = renderHeight;\r\n        }\r\n\r\n        renderContext(renderTargetCtx);\r\n    }\r\n\r\n    //is the gray background that surrounds canvas visible?\r\n    function testBgVisible() {\r\n        //bring workspace points (corners of workspace) into canvas coordinate system\r\n        //then check if any corner point is outside of the canvas -> that means the bg is visible\r\n\r\n        let workspacePointArr = [\r\n            [0, 0], // top left\r\n            [renderWidth, 0], // top right\r\n            [renderWidth, renderHeight], // bottom right\r\n            [0, renderHeight], // bottom left\r\n        ];\r\n\r\n        let art = getRenderedTransform();\r\n\r\n        //setup transformation matrix\r\n        let matrix = BB.Matrix.getIdentity();\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(1/art.scale));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(-art.angle));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-art.x, -art.y));\r\n\r\n        //transform points, then test if outside of canvas\r\n        for(let i = 0; i < workspacePointArr.length; i++) {\r\n            let coords = [workspacePointArr[i][0], workspacePointArr[i][1], 0, 1];\r\n            coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\r\n\r\n            if ( !(0 <= coords[0] && coords[0] <= klCanvas.getWidth() && 0 <= coords[1] && coords[1] <= klCanvas.getHeight()) ){\r\n                //if not inside -> bg visible\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    function renderContext(ctx) {\r\n\r\n        let w = klCanvas.getWidth();\r\n        let h = klCanvas.getHeight();\r\n\r\n        let art = getRenderedTransform();\r\n\r\n        if(art.scale >= 4 || (art.scale === 1 && art.angle === 0)) {\r\n            ctx.imageSmoothingEnabled = false;\r\n        } else {\r\n            ctx.imageSmoothingEnabled = true;\r\n            ctx.imageSmoothingQuality  = 'low'; // art.scale >= 1 ? 'low' : 'medium';\r\n        }\r\n        //ctx.imageSmoothingEnabled = false;\r\n        //renderTargetCtx.globalCompositeOperation  = 'multiply';\r\n\r\n\r\n\r\n        ctx.save();\r\n        {\r\n            if(bgVisible) {\r\n                ctx.fillStyle = 'rgb(158,158,158)'; // 'rgb(185,185,185)';\r\n                ctx.fillRect(0, 0, renderWidth, renderHeight);\r\n            } else {\r\n                ctx.clearRect(0, 0, renderWidth, renderHeight);\r\n            }\r\n\r\n\r\n\r\n            if(bgVisible) {\r\n                ctx.save();\r\n\r\n                ctx.translate(art.x, art.y);\r\n                ctx.scale(art.scale, art.scale);\r\n                ctx.rotate(art.angle);\r\n\r\n                ctx.imageSmoothingEnabled = 'false';\r\n\r\n                //outline\r\n                let borderSize = 1;\r\n                ctx.globalAlpha = 0.2;\r\n                ctx.drawImage(emptyCanvas, -borderSize / art.scale, -borderSize / art.scale, w + borderSize * 2 / art.scale, h + borderSize * 2 / art.scale);\r\n                ctx.globalAlpha = 1;\r\n\r\n                //erase\r\n                ctx.globalCompositeOperation = 'destination-out';\r\n                ctx.drawImage(emptyCanvas, 0, 0, w, h);\r\n\r\n                ctx.restore();\r\n            }\r\n\r\n            /*let region = new Path2D();\r\n            region.rect(80, 10, 20, 130);\r\n            ctx.clip(region);*/\r\n\r\n            ctx.translate(art.x, art.y);\r\n            ctx.scale(art.scale, art.scale);\r\n            ctx.rotate(art.angle);\r\n\r\n            let layerArr = klCanvas.getLayersFast();\r\n            for (let i = 0; i < layerArr.length; i++) {\r\n                if(layerArr[i].opacity > 0) {\r\n                    ctx.globalAlpha = layerArr[i].opacity;\r\n                    ctx.globalCompositeOperation = layerArr[i].mixModeStr;\r\n\r\n                    if (layerArr[i].canvas.compositeObj) {\r\n                        if (compositeCanvas.width !== layerArr[i].canvas.width || compositeCanvas.height !== layerArr[i].canvas.height) {\r\n                            compositeCanvas.width = layerArr[i].canvas.width;\r\n                            compositeCanvas.height = layerArr[i].canvas.height;\r\n                        } else {\r\n                            compositeCtx.clearRect(0, 0, compositeCanvas.width, compositeCanvas.height);\r\n                        }\r\n                        compositeCtx.drawImage(layerArr[i].canvas, 0, 0);\r\n                        layerArr[i].canvas.compositeObj.draw(compositeCtx);\r\n                        ctx.drawImage(compositeCanvas, 0, 0, w, h);\r\n                    } else {\r\n                        ctx.drawImage(layerArr[i].canvas, 0, 0, w, h);\r\n                    }\r\n                }\r\n            }\r\n            ctx.globalAlpha = 1;\r\n\r\n\r\n\r\n        }\r\n        ctx.restore();\r\n\r\n        // rotation hud\r\n        if(MODE_ROTATE === currentMode || MODE_ROTATING === currentMode) {\r\n            svgOverlay.updateCompass({\r\n                isVisible: true,\r\n                angleDeg: art.angle / Math.PI * 180\r\n            });\r\n        } else {\r\n            svgOverlay.updateCompass({\r\n                isVisible: false\r\n            });\r\n        }\r\n\r\n    }\r\n\r\n    function workspaceToCanvasCoord(p) {\r\n        let art = getRenderedTransform();\r\n        let matrix = BB.Matrix.getIdentity();\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(1/art.scale));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(-art.angle));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-art.x, -art.y));\r\n\r\n        let coords = [p.x, p.y, 0, 1];\r\n        coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\r\n\r\n        return {\r\n            x: coords[0],\r\n            y: coords[1],\r\n        }\r\n    }\r\n\r\n    function canvasToWorkspaceCoord(p, transformObj) {\r\n        let matrix = BB.Matrix.getIdentity();\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(transformObj.x, transformObj.y));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(transformObj.angle));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(transformObj.scale));\r\n\r\n        let coords = [p.x, p.y, 0, 1];\r\n        coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\r\n\r\n        return {\r\n            x: coords[0],\r\n            y: coords[1],\r\n        }\r\n    }\r\n\r\n    function snapAngleRad(angleRad, snapDegIncrement, maxDistDeg) {\r\n\r\n        let angleDeg = angleRad * 180 / Math.PI;\r\n        let modDeg = Math.abs(angleDeg % snapDegIncrement);\r\n        let dist = Math.min(modDeg, snapDegIncrement - modDeg);\r\n\r\n        if(dist <= maxDistDeg) {\r\n            angleDeg = Math.round(angleDeg / snapDegIncrement) * snapDegIncrement;\r\n        }\r\n\r\n        return angleDeg / 180 * Math.PI;\r\n    }\r\n\r\n    /**\r\n     * angle always in range [-PI, PI]\r\n     *\r\n     * @param angleRad\r\n     * @returns {number} - angle in radians\r\n     */\r\n    function minimizeAngleRad(angleRad) {\r\n        angleRad = angleRad % (2 * Math.PI);\r\n        if(angleRad > Math.PI) {\r\n            angleRad -= 2 * Math.PI;\r\n        } else if (angleRad < -Math.PI) {\r\n            angleRad += 2 * Math.PI;\r\n        }\r\n        return angleRad;\r\n    }\r\n\r\n    let lastDrawEvent = null;\r\n    let linetoolProcessor = new BB.EventChain.LinetoolProcessor({\r\n        onDraw: function(event) {\r\n            function getMatrix() {\r\n                let art = getRenderedTransform();\r\n                let matrix = BB.Matrix.getIdentity();\r\n                matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(1/art.scale));\r\n                matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(-art.angle));\r\n                matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-art.x, -art.y));\r\n                return matrix;\r\n            }\r\n\r\n            if(event.type === 'line' && !lastDrawEvent) {\r\n                let matrix = getMatrix();\r\n                let coords = [event.x1, event.y1, 0, 1];\r\n                coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\r\n                lastDrawEvent = {\r\n                    x: coords[0],\r\n                    y: coords[1],\r\n                    pressure: event.pressure1\r\n                };\r\n                return;\r\n            }\r\n\r\n            if('x' in event || 'x0' in event) {\r\n\r\n                let matrix = getMatrix();\r\n\r\n                if('x' in event) { //down or move\r\n                    let coords = [event.x, event.y, 0, 1];\r\n                    coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\r\n                    event.x = coords[0];\r\n                    event.y = coords[1];\r\n                }\r\n                if('x0' in event) { //line\r\n                    event.x0 = lastDrawEvent.x;\r\n                    event.y0 = lastDrawEvent.y;\r\n                    event.pressure0 = lastDrawEvent.pressure;\r\n                    let coords = [event.x1, event.y1, 0, 1];\r\n                    coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\r\n                    event.x1 = coords[0];\r\n                    event.y1 = coords[1];\r\n\r\n                    lastDrawEvent = {\r\n                        x: event.x1,\r\n                        y: event.y1,\r\n                        pressure: event.pressure1,\r\n                    };\r\n                }\r\n            }\r\n\r\n\r\n            if(['down', 'move'].includes(event.type)) {\r\n                lastDrawEvent = event;\r\n            }\r\n            p.onDraw(event);\r\n        }\r\n    });\r\n\r\n\r\n    let pointer = null;\r\n    let isDrawing = false;\r\n\r\n\r\n\r\n    let inputProcessorObj = {\r\n        draw: {\r\n            onPointer: function(val) {\r\n\r\n                requestFrame();\r\n                updateCursor(MODE_DRAW);\r\n\r\n                let comboStr = keyListener.getComboStr();\r\n\r\n                let event: any = {\r\n                    scale: highResTransformObj.scale\r\n                };\r\n                event.shiftIsPressed = comboStr === 'shift';\r\n                event.pressure = val.pressure;\r\n                event.isCoalesced = !!val.isCoalesced;\r\n\r\n                if (val.type === 'pointerdown') {\r\n\r\n                    isDrawing = true;\r\n                    event.type = 'down';\r\n\r\n                } else if(val.button) {\r\n                    event.type = 'move';\r\n\r\n                } else if (val.type === 'pointerup') {\r\n\r\n                    isDrawing = false;\r\n                    event.type = 'up';\r\n\r\n                    linetoolProcessor.process(event);\r\n                    resetInputProcessor();\r\n                    return;\r\n                } else {\r\n                    return;\r\n                }\r\n\r\n                event.x = val.relX;\r\n                event.y = val.relY;\r\n\r\n                linetoolProcessor.process(event);\r\n            },\r\n            onKeyDown: function(keyStr, event, comboStr, isRepeat) {\r\n\r\n            },\r\n            onKeyUp: function(keyStr, event, oldComboStr) {\r\n\r\n            }\r\n        },\r\n        fill: {\r\n            onPointer: function(event) {\r\n\r\n                requestFrame();\r\n                updateCursor(MODE_FILL);\r\n\r\n                if (event.type === 'pointerdown') {\r\n                    let coord = workspaceToCanvasCoord({x: event.relX, y: event.relY});\r\n                    p.onFill(Math.floor(coord.x), Math.floor(coord.y));\r\n\r\n                } else if (event.type === 'pointerup') {\r\n                    resetInputProcessor();\r\n                    return;\r\n\r\n                }\r\n\r\n            },\r\n            onKeyDown: function(keyStr, event, comboStr, isRepeat) {\r\n\r\n            },\r\n            onKeyUp: function(keyStr, event, oldComboStr) {\r\n\r\n            }\r\n        },\r\n        text: {\r\n            onPointer: function(event) {\r\n\r\n                requestFrame();\r\n                updateCursor(MODE_TEXT);\r\n\r\n                if (event.type === 'pointerdown') {\r\n                    let coord = workspaceToCanvasCoord({x: event.relX, y: event.relY});\r\n                    p.onText(Math.floor(coord.x), Math.floor(coord.y), renderedTransformObj.angle);\r\n\r\n                } else if (event.type === 'pointerup') {\r\n                    resetInputProcessor();\r\n                    return;\r\n\r\n                }\r\n\r\n            },\r\n            onKeyDown: function(keyStr, event, comboStr, isRepeat) {\r\n\r\n            },\r\n            onKeyUp: function(keyStr, event, oldComboStr) {\r\n\r\n            }\r\n        },\r\n        shape: {\r\n            onPointer: function(event) {\r\n\r\n                requestFrame();\r\n                updateCursor(MODE_SHAPE);\r\n                let coord = workspaceToCanvasCoord({x: event.relX, y: event.relY});\r\n\r\n                if (event.type === 'pointerdown') {\r\n                    isDrawing = true;\r\n                    p.onShape('down', coord.x, coord.y, renderedTransformObj.angle);\r\n\r\n                } else if (event.type === 'pointermove') {\r\n                    p.onShape('move', coord.x, coord.y, renderedTransformObj.angle);\r\n\r\n                } else if (event.type === 'pointerup') {\r\n                    isDrawing = false;\r\n                    p.onShape('up', coord.x, coord.y, renderedTransformObj.angle);\r\n                    resetInputProcessor();\r\n\r\n                }\r\n            },\r\n            onKeyDown: function(keyStr, event, comboStr, isRepeat) {\r\n\r\n            },\r\n            onKeyUp: function(keyStr, event, oldComboStr) {\r\n\r\n            }\r\n        },\r\n        hand: {\r\n            onPointer: function(event) {\r\n                updateCursor(MODE_HAND);\r\n                if(['left', 'middle'].includes(event.button)) {\r\n                    updateCursor(MODE_HAND_GRABBING);\r\n                    targetTransformObj.x += event.dX;\r\n                    targetTransformObj.y += event.dY;\r\n                    highResTransformObj = JSON.parse(JSON.stringify(targetTransformObj));\r\n                    doAnimateTranslate = false;\r\n                    transformIsDirty = true;\r\n                    requestFrame(true);\r\n                } else if (event.type === 'pointerup') {\r\n                    resetInputProcessor();\r\n                }\r\n            },\r\n            onKeyDown: function(keyStr, event, comboStr, isRepeat) {\r\n\r\n            },\r\n            onKeyUp: function(keyStr, event, oldComboStr) {\r\n\r\n            }\r\n        },\r\n        spaceHand: {\r\n            onPointer: function(event) {\r\n                updateCursor(MODE_HAND);\r\n                if(['left', 'middle'].includes(event.button)) {\r\n                    updateCursor(MODE_HAND_GRABBING);\r\n                    targetTransformObj.x += event.dX;\r\n                    targetTransformObj.y += event.dY;\r\n                    highResTransformObj = JSON.parse(JSON.stringify(targetTransformObj));\r\n                    doAnimateTranslate = false;\r\n                    transformIsDirty = true;\r\n                    requestFrame(true);\r\n                }\r\n            },\r\n            onKeyDown: function(keyStr, event, comboStr, isRepeat) {\r\n                if(comboStr !== 'space') {\r\n                    resetInputProcessor();\r\n                } else {\r\n                    updateCursor(MODE_HAND);\r\n                }\r\n            },\r\n            onKeyUp: function(keyStr, event, oldComboStr) {\r\n                resetInputProcessor();\r\n            }\r\n        },\r\n        zoom: {\r\n            onPointer: function(event) {\r\n                updateCursor(MODE_ZOOM);\r\n\r\n                if(event.button === 'left' && !event.isCoalesced && event.dX != 0) {\r\n\r\n                    let offsetX = event.pageX - event.relX;\r\n                    let offsetY = event.pageY - event.relY;\r\n\r\n                    internalZoomByStep(event.dX / 175, event.downPageX - offsetX, event.downPageY - offsetY);\r\n                    highResTransformObj = JSON.parse(JSON.stringify(targetTransformObj));\r\n                    lastRenderedState = -1;\r\n                    requestFrame();\r\n\r\n                    p.onViewChange({\r\n                        changed: ['scale'],\r\n                        angle: targetTransformObj.angle,\r\n                        scale: targetTransformObj.scale\r\n                    });\r\n                }\r\n            },\r\n            onKeyDown: function(keyStr, event, comboStr, isRepeat) {\r\n                if(comboStr !== 'z') {\r\n                    resetInputProcessor();\r\n                } else {\r\n                    updateCursor(MODE_ZOOM);\r\n                }\r\n            },\r\n            onKeyUp: function(keyStr, event, oldComboStr) {\r\n                resetInputProcessor();\r\n            }\r\n        },\r\n        picker: {\r\n            onPointer: function(event) {\r\n                updateCursor(MODE_PICK);\r\n                if(\r\n                    (['left', 'right'].includes(event.button) && !event.isCoalesced) ||\r\n                    event.type === 'pointerup'\r\n                ) {\r\n                    let coord = workspaceToCanvasCoord({x: event.relX, y: event.relY});\r\n                    let pickedColor = klCanvas.getColorAt(coord.x, coord.y);\r\n                    p.onPick(pickedColor, event.type === 'pointerup');\r\n                    svgOverlay.updateColorPreview({\r\n                        x: event.relX,\r\n                        y: event.relY,\r\n                        color: pickedColor,\r\n                        isVisible: event.type !== 'pointerup'\r\n                    });\r\n\r\n                    if(event.type === 'pointerup') {\r\n                        resetInputProcessor();\r\n                    }\r\n                }\r\n            },\r\n            onKeyDown: function(keyStr, event, comboStr, isRepeat) {\r\n\r\n            },\r\n            onKeyUp: function(keyStr, event, oldComboStr) {\r\n\r\n            }\r\n        },\r\n        altPicker: {\r\n            onPointer: function(event) {\r\n                updateCursor(MODE_PICK);\r\n                if(\r\n                    (['left', 'right'].includes(event.button) && !event.isCoalesced) ||\r\n                    event.type === 'pointerup'\r\n                ) {\r\n                    let coord = workspaceToCanvasCoord({x: event.relX, y: event.relY});\r\n                    let pickedColor = klCanvas.getColorAt(coord.x, coord.y);\r\n                    p.onPick(pickedColor, event.type === 'pointerup');\r\n                    svgOverlay.updateColorPreview({\r\n                        x: event.relX,\r\n                        y: event.relY,\r\n                        color: pickedColor,\r\n                        isVisible: event.type !== 'pointerup'\r\n                    });\r\n                }\r\n            },\r\n            onKeyDown: function(keyStr, event, comboStr, isRepeat) {\r\n                if(comboStr !== 'alt') {\r\n                    resetInputProcessor();\r\n                } else {\r\n                    updateCursor(MODE_PICK);\r\n                }\r\n            },\r\n            onKeyUp: function(keyStr, event, oldComboStr) {\r\n                resetInputProcessor();\r\n            }\r\n        },\r\n        rotate: {\r\n            onPointer: function(event) {\r\n                updateCursor(event.button === 'left' ? MODE_ROTATING : MODE_ROTATE);\r\n\r\n                if (event.type === 'pointerdown' && event.button === 'left') {\r\n                    oldTransformObj = JSON.parse(JSON.stringify(targetTransformObj));\r\n                } else if (event.button === 'left' && !event.isCoalesced && oldTransformObj) {\r\n\r\n\r\n                    let offsetX = event.pageX - event.relX;\r\n                    let offsetY = event.pageY - event.relY;\r\n                    //rotation done around center\r\n                    let centerObj = {\r\n                        x: renderWidth / 2,\r\n                        y: renderHeight / 2\r\n                    };\r\n\r\n                    let startAngleRad = BB.Vec2.angle(centerObj, {x: event.downPageX - offsetX, y: event.downPageY - offsetY});\r\n                    let angleRad = BB.Vec2.angle(centerObj, {x: event.pageX - offsetX, y: event.pageY - offsetY});\r\n                    let dAngleRad = angleRad - startAngleRad;\r\n\r\n                    //apply angle\r\n                    targetTransformObj = JSON.parse(JSON.stringify(oldTransformObj));\r\n                    targetTransformObj.angle += dAngleRad;\r\n\r\n                    if(keyListener.isPressed('shift')) {\r\n                        targetTransformObj.angle = Math.round(targetTransformObj.angle / Math.PI * 8) * Math.PI / 8; //snap the angle to 45/2 degs\r\n                        dAngleRad = targetTransformObj.angle - oldTransformObj.angle;\r\n                    }\r\n\r\n                    targetTransformObj.angle = minimizeAngleRad(targetTransformObj.angle);\r\n\r\n                    //rotate transform.xy\r\n                    let matrix = BB.Matrix.getIdentity();\r\n                    matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(centerObj.x, centerObj.y));\r\n                    //matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(effectiveFactor));\r\n                    matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(dAngleRad));\r\n                    matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-centerObj.x, -centerObj.y));\r\n                    //matrix = multiplyMatrices(matrix, createTranslationMatrix(val.x - val.startX, val.y - val.startY));\r\n\r\n                    let origin = [targetTransformObj.x, targetTransformObj.y, 0, 1];\r\n                    origin = BB.Matrix.multiplyMatrixAndPoint(matrix, origin);\r\n                    targetTransformObj.x = origin[0];\r\n                    targetTransformObj.y = origin[1];\r\n\r\n                    highResTransformObj = JSON.parse(JSON.stringify(targetTransformObj));\r\n\r\n                    transformIsDirty = true;\r\n                    lastRenderedState = -1;\r\n                    requestFrame();\r\n\r\n                    p.onViewChange({\r\n                        changed: ['angle'],\r\n                        scale: targetTransformObj.scale,\r\n                        angle: targetTransformObj.angle\r\n                    });\r\n\r\n                }\r\n            },\r\n            onKeyDown: function(keyStr, event, comboStr, isRepeat) {\r\n                if(['r', 'r+shift', 'shift+r', 'r+left', 'r+right', 'r+left+right', 'r+right+left', 'r+up'].includes(comboStr)) {\r\n                    updateCursor(MODE_ROTATE);\r\n                } else {\r\n                    resetInputProcessor();\r\n                }\r\n            },\r\n            onKeyUp: function(keyStr, event, oldComboStr) {\r\n                let comboStr = keyListener.getComboStr();\r\n                if(['r', 'r+shift', 'shift+r', 'r+left', 'r+right', 'r+left+right', 'r+right+left', 'r+up'].includes(comboStr)) {\r\n                    updateCursor(MODE_ROTATE);\r\n                } else {\r\n                    resetInputProcessor();\r\n                }\r\n            }\r\n        }\r\n    };\r\n    let currentInputProcessor = null;\r\n\r\n    function resetInputProcessor() {\r\n        currentInputProcessor = null;\r\n        updateCursor(globalMode);\r\n        requestFrame(true);\r\n    }\r\n\r\n\r\n    let angleIsExtraSticky = false;\r\n    let pinchZoomer = new BB.EventChain.PinchZoomer({\r\n        onPinch: function(event) {\r\n\r\n            if (event.type === 'move') {\r\n\r\n                if(!oldTransformObj) {\r\n                    oldTransformObj = JSON.parse(JSON.stringify(targetTransformObj));\r\n                    angleIsExtraSticky = targetTransformObj.angle % (Math.PI / 2) === 0;\r\n                }\r\n\r\n                let oldAngle = targetTransformObj.angle;\r\n                targetTransformObj = JSON.parse(JSON.stringify(oldTransformObj));\r\n\r\n                event.scale = Math.max(MIN_SCALE, Math.min(MAX_SCALE, targetTransformObj.scale * event.scale)) / targetTransformObj.scale;\r\n\r\n                targetTransformObj.scale *= event.scale;\r\n                targetTransformObj.angle += event.angleRad;\r\n                targetTransformObj.angle = minimizeAngleRad(\r\n                    snapAngleRad(\r\n                        targetTransformObj.angle,\r\n                        90,\r\n                        angleIsExtraSticky ? 12 : 4\r\n                    )\r\n                );\r\n                if(targetTransformObj.angle % (Math.PI / 2) !== 0) {\r\n                    angleIsExtraSticky = false;\r\n                }\r\n                //targetTransformObj.angle = minimizeAngleRad(snapAngleRad(targetTransformObj.angle, 90, 7));\r\n                event.angleRad = targetTransformObj.angle - oldTransformObj.angle;\r\n\r\n                //calc translation\r\n                {\r\n                    let matrix = BB.Matrix.getIdentity();\r\n                    matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(event.relX, event.relY));\r\n                    matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(event.scale));\r\n                    matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(event.angleRad));\r\n                    matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-event.relX, -event.relY));\r\n                    matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(event.relX - event.downRelX, event.relY - event.downRelY));\r\n\r\n\r\n                    let origin = [targetTransformObj.x, targetTransformObj.y, 0, 1];\r\n                    origin = BB.Matrix.multiplyMatrixAndPoint(matrix, origin);\r\n\r\n                    targetTransformObj.x = origin[0];\r\n                    targetTransformObj.y = origin[1];\r\n\r\n                }\r\n\r\n                highResTransformObj = JSON.parse(JSON.stringify(targetTransformObj));\r\n\r\n                //if(event.scale !== 1) {\r\n                p.onViewChange({\r\n                    changed: ['scale', 'angle'],\r\n                    scale: targetTransformObj.scale,\r\n                    angle: targetTransformObj.angle\r\n                });\r\n                //}\r\n                requestFrame();\r\n                transformIsDirty = true;\r\n                lastRenderedState = -1;\r\n\r\n\r\n            } else if (event.type === 'end') {\r\n                oldTransformObj = null;\r\n            }\r\n\r\n\r\n        }\r\n    });\r\n\r\n    function onDoubleTap() {\r\n        let oldTransform = JSON.parse(JSON.stringify(targetTransformObj));\r\n        _this.fitView();\r\n        //_this.resetView(true);\r\n        lastRenderedState = -1;\r\n        requestFrame();\r\n\r\n        if(\r\n            oldTransform.scale !== targetTransformObj.scale ||\r\n            oldTransform.angle !== targetTransformObj.angle\r\n        ) {\r\n            p.onViewChange({\r\n                changed: ['scale', 'angle'],\r\n                angle: targetTransformObj.angle,\r\n                scale: targetTransformObj.scale\r\n            });\r\n        }\r\n    }\r\n\r\n    let mainDoubleTapper = new BB.EventChain.DoubleTapper({\r\n        onDoubleTap: onDoubleTap\r\n    });\r\n    let middleDoubleTapper = new BB.EventChain.DoubleTapper({\r\n        onDoubleTap: onDoubleTap\r\n    });\r\n    middleDoubleTapper.setAllowedButtonArr(['middle']);\r\n\r\n\r\n    let twoFingerTap = new BB.EventChain.NFingerTapper({\r\n        fingers: 2,\r\n        onTap: function() {\r\n            p.onUndo();\r\n        }\r\n    });\r\n    let threeFingerTap = new BB.EventChain.NFingerTapper({\r\n        fingers: 3,\r\n        onTap: function() {\r\n            p.onRedo();\r\n        }\r\n    });\r\n\r\n\r\n    let pointerEventChain = new BB.EventChain.EventChain({\r\n        chainArr: [\r\n            twoFingerTap,\r\n            threeFingerTap,\r\n            mainDoubleTapper,\r\n            middleDoubleTapper,\r\n            pinchZoomer,\r\n            new BB.EventChain.OnePointerLimiter(),\r\n            new BB.EventChain.CoalescedExploder()\r\n        ]\r\n    });\r\n    pointerEventChain.setChainOut(function(event) {\r\n\r\n        cursorPos.x = event.relX;\r\n        cursorPos.y = event.relY;\r\n        if(event.type === 'pointerup' && event.pointerType === 'touch') {\r\n            pointer = null;\r\n            lastRenderedState = -1;\r\n            requestFrame();\r\n        } else {\r\n            if(!pointer) {\r\n                pointer = {};\r\n            }\r\n            pointer.x = event.relX;\r\n            pointer.y = event.relY;\r\n        }\r\n\r\n        if(currentInputProcessor) {\r\n            currentInputProcessor.onPointer(event);\r\n\r\n        } else {\r\n\r\n            let comboStr = keyListener.getComboStr();\r\n\r\n            if (globalMode === MODE_DRAW) {\r\n\r\n                if (['', 'shift', 'ctrl'].includes(comboStr) && event.type === 'pointerdown' && event.button === 'left') {\r\n                    currentInputProcessor = inputProcessorObj.draw;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\r\n                    currentInputProcessor = inputProcessorObj.picker;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\r\n                    currentInputProcessor = inputProcessorObj.hand;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else {\r\n                    updateCursor(MODE_DRAW);\r\n                    requestFrame();\r\n                }\r\n\r\n            } else if (globalMode === MODE_HAND) {\r\n\r\n                if(event.type === 'pointerdown' && ['left', 'middle'].includes(event.button)) {\r\n                    currentInputProcessor = inputProcessorObj.hand;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\r\n                    currentInputProcessor = inputProcessorObj.picker;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else {\r\n                    updateCursor(MODE_HAND);\r\n                }\r\n\r\n            } else if (globalMode === MODE_PICK) {\r\n\r\n                if(event.type === 'pointerdown' && ['left', 'right'].includes(event.button)) {\r\n                    currentInputProcessor = inputProcessorObj.picker;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\r\n                    currentInputProcessor = inputProcessorObj.hand;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else {\r\n                    updateCursor(MODE_PICK);\r\n                }\r\n\r\n            } else if (globalMode === MODE_FILL) {\r\n\r\n                if (event.type === 'pointerdown' && event.button === 'left') {\r\n                    currentInputProcessor = inputProcessorObj.fill;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\r\n                    currentInputProcessor = inputProcessorObj.picker;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\r\n                    currentInputProcessor = inputProcessorObj.hand;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else {\r\n                    updateCursor(MODE_FILL);\r\n                    requestFrame();\r\n                }\r\n\r\n            } else if (globalMode === MODE_TEXT) {\r\n\r\n                if (event.type === 'pointerdown' && event.button === 'left') {\r\n                    currentInputProcessor = inputProcessorObj.text;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\r\n                    currentInputProcessor = inputProcessorObj.picker;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\r\n                    currentInputProcessor = inputProcessorObj.hand;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else {\r\n                    updateCursor(MODE_TEXT);\r\n                    requestFrame();\r\n                }\r\n\r\n            } else if (globalMode === MODE_SHAPE) {\r\n\r\n                if (['', 'shift', 'ctrl'].includes(comboStr) && event.type === 'pointerdown' && event.button === 'left') {\r\n                    currentInputProcessor = inputProcessorObj.shape;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\r\n                    currentInputProcessor = inputProcessorObj.picker;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\r\n                    currentInputProcessor = inputProcessorObj.hand;\r\n                    currentInputProcessor.onPointer(event);\r\n                } else {\r\n                    updateCursor(MODE_SHAPE);\r\n                    requestFrame();\r\n                }\r\n\r\n            }\r\n\r\n\r\n        }\r\n\r\n    });\r\n\r\n    //prevent ctrl scroll -> zooming page\r\n    BB.addEventListener(div, 'wheel', function(event) {\r\n        event.preventDefault();\r\n    });\r\n\r\n\r\n    let pointerListener;\r\n    setTimeout(function() {\r\n        pointerListener = new BB.PointerListener({\r\n            target: div,\r\n            fixScribble: true,\r\n            onPointer: function(e) {\r\n                if (e.type === 'pointerdown' && e.button === 'middle') {\r\n                    try {\r\n                        e.eventPreventDefault();\r\n                    } catch (e) {}\r\n                }\r\n                /*if(e.type === 'pointermove') {\r\n                    BB.throwOut(JSON.stringify(e));\r\n                }*/\r\n\r\n                pointerEventChain.chainIn(e)\r\n            },\r\n            onWheel: function(wheelEvent) {\r\n\r\n                if (isDrawing) {\r\n                    return;\r\n                }\r\n\r\n                requestFrame();\r\n                let didZoom = internalZoomByStep(-wheelEvent.deltaY / (keyListener.isPressed('shift') ? 8 : 2), wheelEvent.relX, wheelEvent.relY);\r\n                if(didZoom) {\r\n                    p.onViewChange({\r\n                        changed: ['scale'],\r\n                        angle: targetTransformObj.angle,\r\n                        scale: targetTransformObj.scale\r\n                    });\r\n                }\r\n\r\n                //updateCursor(MODE_DRAW, true);\r\n                lastRenderedState = -1;\r\n\r\n\r\n            },\r\n            onEnterLeave: function(isOver) {\r\n                if(!isOver) {\r\n                    if(!isDrawing) {\r\n                        pointer = null;\r\n                        lastRenderedState = -1;\r\n                    }\r\n                }\r\n            },\r\n            maxPointers: 4\r\n        });\r\n    }, 1);\r\n\r\n    let brushRadius = 1;\r\n\r\n    let animationFrameRequested = false;\r\n    function requestFrame(doRedrawCanvas?) {\r\n        animationFrameRequested = true;\r\n        if(doRedrawCanvas) {\r\n            lastRenderedState = -1;\r\n        }\r\n    }\r\n\r\n\r\n\r\n    //setup rendering\r\n    let lastRenderedState = -2;\r\n    let lastRenderTime = performance.now();\r\n    let debugtime = 0;\r\n    function updateLoop() {\r\n        window.requestAnimationFrame(updateLoop);\r\n\r\n        let newState = parseInt(klHistory.getState());\r\n        let doRender = lastRenderedState < newState;\r\n\r\n        //handle variable framerate\r\n        let nowTime = performance.now();\r\n        let elapsedFrames = (nowTime - lastRenderTime) * 60 / 1000; //how many frames elapsed since last render if fps were 60fps\r\n        lastRenderTime = nowTime;\r\n\r\n        if(animationFrameRequested || doRender) {\r\n            animationFrameRequested = false;\r\n            checkChange(elapsedFrames);\r\n        }\r\n\r\n\r\n\r\n    }\r\n    const animationSpeed = 0.3; //0.25;\r\n    function checkChange(elapsedFrames) {\r\n\r\n        let newState = parseInt(klHistory.getState());\r\n        let doRender = lastRenderedState < newState ||\r\n            highResTransformObj.scale !== targetTransformObj.scale ||\r\n            highResTransformObj.x !== targetTransformObj.x ||\r\n            highResTransformObj.y !== targetTransformObj.y;\r\n\r\n        //update transform\r\n        if(\r\n            !doAnimateTranslate &&\r\n            (highResTransformObj.scale === targetTransformObj.scale || Math.abs(highResTransformObj.scale - targetTransformObj.scale) < 0.008 * targetTransformObj.scale)\r\n        ) {\r\n            highResTransformObj.scale = targetTransformObj.scale;\r\n            highResTransformObj.x = targetTransformObj.x;\r\n            highResTransformObj.y = targetTransformObj.y;\r\n            highResTransformObj.angle = targetTransformObj.angle;\r\n            if(transformIsDirty) {\r\n                transformIsDirty = false;\r\n                bgVisible = testBgVisible();\r\n            }\r\n\r\n            svgOverlay.updateCursor({radius: brushRadius * highResTransformObj.scale});\r\n        } else if (\r\n            (highResTransformObj.x === targetTransformObj.x || Math.abs(highResTransformObj.x - targetTransformObj.x) < 0.5) &&\r\n            (highResTransformObj.y === targetTransformObj.y || Math.abs(highResTransformObj.y - targetTransformObj.y) < 0.5) &&\r\n            (highResTransformObj.scale === targetTransformObj.scale || Math.abs(highResTransformObj.scale - targetTransformObj.scale) < 0.008 * targetTransformObj.scale)\r\n        ) {\r\n            highResTransformObj.scale = targetTransformObj.scale;\r\n            highResTransformObj.x = targetTransformObj.x;\r\n            highResTransformObj.y = targetTransformObj.y;\r\n            highResTransformObj.angle = targetTransformObj.angle;\r\n            doAnimateTranslate = false;\r\n            if(transformIsDirty) {\r\n                transformIsDirty = false;\r\n                bgVisible = testBgVisible();\r\n            }\r\n\r\n            svgOverlay.updateCursor({radius: brushRadius * highResTransformObj.scale});\r\n        } else {\r\n            requestFrame(); //probably needs another frame\r\n            let blendFactor = Math.min(1, animationSpeed * elapsedFrames);\r\n            mixTransformObj(highResTransformObj, targetTransformObj, blendFactor);\r\n            bgVisible = true; // spare yourself the calculation\r\n            svgOverlay.updateCursor({radius: brushRadius * highResTransformObj.scale});\r\n        }\r\n\r\n        if(pointer && currentMode == MODE_DRAW && !usesCssCursor) {\r\n            svgOverlay.updateCursor({\r\n                x: pointer.x,\r\n                y: pointer.y,\r\n                isVisible: true\r\n            });\r\n        } else {\r\n            svgOverlay.updateCursor({isVisible: false});\r\n        }\r\n\r\n\r\n        if(doRender) {\r\n            //console.log('scale', renderedTransform.scale, 'x', renderedTransform.x, 'y', renderedTransform.y);\r\n            lastRenderedState = newState;\r\n            let start = performance.now();\r\n            render();\r\n            renderTime = BB.mix(renderTime, performance.now() - start, 0.05);\r\n        }\r\n        //setTimeout(checkChange, 100);\r\n\r\n\r\n\r\n        if(doRender) {\r\n\r\n            //console.log('rendertime ms: ', renderTime);\r\n        }\r\n\r\n\r\n    }\r\n    window.requestAnimationFrame(updateLoop);\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.setCanvas = function(c) {\r\n\r\n        klCanvas = c;\r\n        lastDrawEvent = null;\r\n        this.resetView();\r\n\r\n        updateChangeListener();\r\n\r\n        lastRenderedState = -1;\r\n        requestFrame();\r\n    };\r\n\r\n    this.setSize = function(width, height) {\r\n        let oldWidth = renderWidth;\r\n        let oldHeight = renderHeight;\r\n\r\n        if(width === oldWidth && height === oldHeight) {\r\n            return;\r\n        }\r\n\r\n        doResizeCanvas = true;\r\n        renderWidth = width;\r\n        renderHeight = height;\r\n\r\n        svgOverlay.setSize(width, height);\r\n\r\n        targetTransformObj.x += (width - oldWidth) / 2;\r\n        targetTransformObj.y += (height - oldHeight) / 2;\r\n\r\n        highResTransformObj.x = targetTransformObj.x;\r\n        highResTransformObj.y = targetTransformObj.y;\r\n\r\n        bgVisible = testBgVisible();\r\n\r\n        lastRenderedState = -1;\r\n        requestFrame();\r\n    };\r\n\r\n    this.setMode = function(modeStr) {\r\n        //only sets the base mode\r\n        if(modeStr === 'draw') {\r\n            globalMode = MODE_DRAW;\r\n            mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\r\n        }\r\n        if(modeStr === 'fill') {\r\n            globalMode = MODE_FILL;\r\n            mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\r\n        }\r\n        if(modeStr === 'text') {\r\n            globalMode = MODE_TEXT;\r\n            mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\r\n        }\r\n        if(modeStr === 'shape') {\r\n            globalMode = MODE_SHAPE;\r\n            mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\r\n        }\r\n        if(modeStr === 'hand') {\r\n            globalMode = MODE_HAND;\r\n            mainDoubleTapper.setAllowedPointerTypeArr(['mouse', 'pen', 'touch']);\r\n        }\r\n        if(modeStr === 'pick') {\r\n            globalMode = MODE_PICK;\r\n            mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\r\n        }\r\n    };\r\n\r\n    this.setEnabled = function(b) {\r\n        //todo\r\n    };\r\n\r\n    let disableRadiusPreviewTimeout;\r\n    this.setCursorSize = function(s) {\r\n        brushRadius = s / 2;\r\n\r\n        svgOverlay.updateCursor({radius: brushRadius * highResTransformObj.scale});\r\n\r\n        if(pointer === null) {\r\n            clearTimeout(disableRadiusPreviewTimeout);\r\n\r\n            svgOverlay.updateCursor({\r\n                x: renderWidth / 2,\r\n                y: renderHeight / 2,\r\n                isVisible: true\r\n            });\r\n\r\n            disableRadiusPreviewTimeout = setTimeout(function() {\r\n                if(pointer !== null) {\r\n                    return;\r\n                }\r\n                svgOverlay.updateCursor({isVisible: false});\r\n            }, 500);\r\n        }\r\n    };\r\n\r\n    this.zoomByStep = function(stepNum) {\r\n        let didZoom = internalZoomByStep(stepNum, renderWidth / 2, renderHeight / 2);\r\n        if(!didZoom) {\r\n            return;\r\n        }\r\n\r\n        lastRenderedState = -1;\r\n        requestFrame();\r\n\r\n        p.onViewChange({\r\n            changed: ['scale'],\r\n            angle: targetTransformObj.angle,\r\n            scale: targetTransformObj.scale\r\n        });\r\n    };\r\n\r\n    this.resetView = function(doAnimate) {\r\n\r\n        targetTransformObj.scale = 1;\r\n        targetTransformObj.angle = 0;\r\n\r\n        targetTransformObj.x = (renderWidth - klCanvas.getWidth()) / 2;\r\n        targetTransformObj.y = (renderHeight - klCanvas.getHeight()) / 2;\r\n\r\n        if(!doAnimate) {\r\n            highResTransformObj = JSON.parse(JSON.stringify(targetTransformObj));\r\n        } else {\r\n            doAnimateTranslate = true;\r\n            transformIsDirty = true;\r\n        }\r\n\r\n        bgVisible = testBgVisible();\r\n        requestFrame();\r\n\r\n        if (doAnimate) {\r\n            p.onViewChange({\r\n                changed: ['scale', 'angle'],\r\n                scale: targetTransformObj.scale,\r\n                angle: targetTransformObj.angle\r\n            });\r\n        }\r\n    };\r\n    this.resetView();\r\n\r\n    this.fitView = function() {\r\n        //fit into view. center. keep angle. margin of 10px\r\n\r\n        //calc width and height of bounds\r\n        let canvasPointsArr = [\r\n            [0, 0], // top left\r\n            [klCanvas.getWidth(), 0], // top right\r\n            [klCanvas.getWidth(), klCanvas.getHeight()], // bottom right\r\n            [0, klCanvas.getHeight()], // bottom left\r\n            [klCanvas.getWidth() / 2, klCanvas.getHeight() / 2], // center\r\n        ];\r\n\r\n        //setup transformation matrix\r\n        let matrix = BB.Matrix.getIdentity();\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(targetTransformObj.angle));\r\n\r\n        //rotate points\r\n        for(let i = 0; i < canvasPointsArr.length; i++) {\r\n            let coords = [canvasPointsArr[i][0], canvasPointsArr[i][1], 0, 1];\r\n            coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\r\n            canvasPointsArr[i][0] = coords[0];\r\n            canvasPointsArr[i][1] = coords[1];\r\n        }\r\n\r\n        let boundsObj = {\r\n            x0: null,\r\n            y0: null,\r\n            x1: null,\r\n            y1: null\r\n        };\r\n        for(let i = 0; i < canvasPointsArr.length; i++) {\r\n            if(boundsObj.x0 === null || canvasPointsArr[i][0] < boundsObj.x0) {\r\n                boundsObj.x0 = canvasPointsArr[i][0];\r\n            }\r\n            if(boundsObj.y0 === null || canvasPointsArr[i][1] < boundsObj.y0) {\r\n                boundsObj.y0 = canvasPointsArr[i][1];\r\n            }\r\n            if(boundsObj.x1 === null || canvasPointsArr[i][0] > boundsObj.x1) {\r\n                boundsObj.x1 = canvasPointsArr[i][0];\r\n            }\r\n            if(boundsObj.y1 === null || canvasPointsArr[i][1] > boundsObj.y1) {\r\n                boundsObj.y1 = canvasPointsArr[i][1];\r\n            }\r\n        }\r\n        let boundsWidth = boundsObj.x1 - boundsObj.x0;\r\n        let boundsHeight = boundsObj.y1 - boundsObj.y0;\r\n\r\n        //fit bounds\r\n        let padding = 40;\r\n        let fit = BB.fitInto(boundsWidth, boundsHeight, renderWidth - padding, renderHeight - padding, 1);\r\n\r\n        //determine scale\r\n        let factor = fit.width / boundsWidth;\r\n\r\n        //center\r\n        targetTransformObj.x = (renderWidth / 2) - (canvasPointsArr[4][0] - canvasPointsArr[0][0]) * factor;\r\n        targetTransformObj.y = (renderHeight / 2) - (canvasPointsArr[4][1] - canvasPointsArr[0][1]) * factor;\r\n\r\n        targetTransformObj.scale = factor;\r\n        doAnimateTranslate = true;\r\n        transformIsDirty = true;\r\n        requestFrame();\r\n\r\n        p.onViewChange({\r\n            changed: ['scale', 'angle'],\r\n            scale: targetTransformObj.scale,\r\n            angle: targetTransformObj.angle\r\n        });\r\n    };\r\n\r\n    this.setAngle = function(angleDeg, isRelative) {\r\n        //rotation done around center\r\n        let centerObj = {\r\n            x: renderWidth / 2,\r\n            y: renderHeight / 2\r\n        };\r\n\r\n        let oldAngleRad = targetTransformObj.angle;\r\n        let angleRad = angleDeg / 180 * Math.PI;\r\n\r\n        if(isRelative) {\r\n            targetTransformObj.angle += angleRad;\r\n        } else {\r\n            targetTransformObj.angle = angleRad;\r\n        }\r\n\r\n        targetTransformObj.angle = minimizeAngleRad(\r\n            snapAngleRad(\r\n                targetTransformObj.angle,\r\n                90,\r\n                4\r\n            )\r\n        );\r\n\r\n        //rotate transform.xy\r\n        let matrix = BB.Matrix.getIdentity();\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(centerObj.x, centerObj.y));\r\n        //matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(effectiveFactor));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(targetTransformObj.angle - oldAngleRad));\r\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-centerObj.x, -centerObj.y));\r\n        //matrix = multiplyMatrices(matrix, createTranslationMatrix(val.x - val.startX, val.y - val.startY));\r\n\r\n        let origin = [targetTransformObj.x, targetTransformObj.y, 0, 1];\r\n        origin = BB.Matrix.multiplyMatrixAndPoint(matrix, origin);\r\n        targetTransformObj.x = origin[0];\r\n        targetTransformObj.y = origin[1];\r\n\r\n        highResTransformObj = JSON.parse(JSON.stringify(targetTransformObj));\r\n        transformIsDirty = true;\r\n        requestFrame(true);\r\n    };\r\n\r\n    this.translateView = function(tx, ty) {\r\n        let scale = 40;\r\n\r\n        targetTransformObj.x += tx * scale;\r\n        targetTransformObj.y += ty * scale;\r\n\r\n        transformIsDirty = true;\r\n        doAnimateTranslate = true;\r\n        requestFrame(true);\r\n    };\r\n\r\n    this.getIsDrawing = function() {\r\n        return isDrawing;\r\n    };\r\n\r\n    this.getScale = function() {\r\n        return targetTransformObj.scale;\r\n    };\r\n\r\n    this.getAngleDeg = function() {\r\n        return targetTransformObj.angle * 180 / Math.PI;\r\n    };\r\n\r\n    this.getMaxScale = function() {\r\n        return MAX_SCALE;\r\n    };\r\n\r\n    this.getMinScale = function() {\r\n        return MIN_SCALE;\r\n    };\r\n\r\n    this.requestFrame = function() {\r\n        lastRenderedState = -1;\r\n        requestFrame();\r\n    };\r\n\r\n    this.setLastDrawEvent = function(x, y, pressure) {\r\n\r\n        if(x === null) {\r\n            lastDrawEvent = null;\r\n            return;\r\n        }\r\n\r\n        if(!lastDrawEvent) {\r\n            lastDrawEvent = {x: 0, y: 0, pressure: 0};\r\n        }\r\n        lastDrawEvent.x = x;\r\n        lastDrawEvent.y = y;\r\n        lastDrawEvent.pressure = pressure;\r\n    };\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"1dLwT\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"9wZxU\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"hQSEH\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"916ZI\");","import {BB} from '../../bb/bb';\r\n\r\n/**\r\n * preview of image with layers. can do mix modes and opacity.\r\n * creates a canvas.\r\n *\r\n * p = {\r\n *     width: 123,\r\n *     height: 123,\r\n *     layerArr: [// can be changed after the fact\r\n *         {\r\n *             canvas: Canvas,\r\n *             opacity: 1,\r\n *             mixModeStr: 'source-over'\r\n *         }\r\n *     ]\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function KlCanvasPreview(p) {\r\n    const scale = p.width / p.layerArr[0].canvas.width;\r\n    const width = scale > 1 ? p.layerArr[0].canvas.width : p.width;\r\n    const height = scale > 1 ? p.layerArr[0].canvas.height : p.height;\r\n\r\n    let canvas = BB.canvas(width, height);\r\n    canvas.style.backgroundImage = 'url(' + BB.createCheckerDataUrl(8) + ')';\r\n    let ctx = canvas.getContext('2d');\r\n\r\n    BB.css(canvas, {\r\n        width: '100%',\r\n        height: '100%',\r\n        imageRendering: scale > 1 ? 'pixelated' : null,\r\n    });\r\n\r\n    function render() {\r\n        ctx.save();\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n        for(let i = 0; i < p.layerArr.length; i++) {\r\n            ctx.globalAlpha = parseFloat(p.layerArr[i].opacity);\r\n            ctx.globalCompositeOperation = p.layerArr[i].mixModeStr;\r\n            if (canvas.width > p.layerArr[i].canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(p.layerArr[i].canvas, 0, 0, canvas.width, canvas.height);\r\n        }\r\n        ctx.restore();\r\n    }\r\n\r\n    setTimeout(render, 0);\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return canvas;\r\n    };\r\n\r\n    this.render = function() {\r\n        render();\r\n    };\r\n}","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport rotateImg from 'url:~/src/app/img/ui/cursor-rotate.png';\r\nimport {KeyListener} from '../../../bb/input/key-listener';\r\nimport {IVector2D} from '../../../bb/bb.types';\r\n\r\nexport interface ITransform {\r\n    x: number; // center of transform region. image space\r\n    y: number;\r\n    width: number; // size of transform region. image space\r\n    height: number;\r\n    angleDeg: number; // angle of transform region. degrees\r\n}\r\n\r\n\r\n/**\r\n * snap entire transform to pixel grid. changes transform\r\n *\r\n * for x y:\r\n * If a dimension has an even size, it be an integer.\r\n * If it's uneven, it's sits exactly half way between two pixels.\r\n *\r\n * @param transform\r\n */\r\nfunction snapToPixel(transform: ITransform): void {\r\n    if (Math.abs(transform.angleDeg) % 90 !== 0) {\r\n        return;\r\n    }\r\n\r\n    transform.width = Math.round(transform.width);\r\n    transform.height = Math.round(transform.height);\r\n    // 0° is original orientation.\r\n    // At 90° and 270° width and height become swapped due to different orientation.\r\n    const whSwapped = Math.abs(transform.angleDeg - 90) % 180 === 0;\r\n    transform.x = ((whSwapped ? transform.height : transform.width) % 2 === 0) ? Math.round(transform.x) : Math.round(transform.x - 0.5) + 0.5;\r\n    transform.y = ((whSwapped ? transform.width : transform.height) % 2 === 0)  ? Math.round(transform.y) : Math.round(transform.y - 0.5) + 0.5;\r\n}\r\n\r\nfunction copyTransform(transform: ITransform): ITransform {\r\n    return {\r\n        x: transform.x,\r\n        y: transform.y,\r\n        width: transform.width,\r\n        height: transform.height,\r\n        angleDeg: transform.angleDeg,\r\n    };\r\n}\r\n\r\n/**\r\n * image space to transform space\r\n * - origin of transform space is at center of transform bounds.\r\n * - same scale as image space. -> one unit is x: 1/width, y: 1/height\r\n * - up is where transform points up\r\n * - x goes right\r\n * - y goes down\r\n * @param x\r\n * @param y\r\n * @param transform\r\n */\r\nfunction toTransformSpace (x: number, y: number, transform: ITransform): IVector2D {\r\n    let px, py;\r\n    px = x - transform.x;\r\n    py = y - transform.y;\r\n\r\n    const rot = BB.rotateAround({x: 0, y: 0},\r\n        {x: px, y: py},\r\n        -transform.angleDeg);\r\n    px = rot.x;\r\n    py = rot.y;\r\n\r\n    return {\r\n        x: px,\r\n        y: py,\r\n    };\r\n}\r\n\r\n/**\r\n * transform space to image space\r\n * @param x\r\n * @param y\r\n * @param transform\r\n */\r\nfunction toImageSpace(x: number, y: number, transform: ITransform): IVector2D {\r\n    const rot = BB.rotateAround({x: 0, y: 0},\r\n        {x: x, y: y},\r\n        transform.angleDeg);\r\n    return {\r\n        x: rot.x + transform.x,\r\n        y: rot.y + transform.y,\r\n    };\r\n}\r\n\r\n\r\n\r\n/**\r\n * Free Transform UI\r\n * rotate, scale, translate\r\n *\r\n * - if rotation is multiple of 90° it will snap to pixels, to be more useful for pixel art\r\n * - when rotation goes from non-multiple of 90° to a multiple, it will snap position and width height to pixels\r\n * - transform.x, transform.y can sit between pixels (by 0.5) if width or height is odd number.\r\n *      - this is what complicates things\r\n * - if transform region small, corner grips move out of the way\r\n *\r\n * iX iY, iP.x, iP.y - i indicates image space\r\n * tX tY, tP.x, tP.y - t indicates transform space\r\n *\r\n * Not sure if can be used for navigable canvas. (especially if canvas rotates view)\r\n * Probably can't be extended for distort. Needs a different approach.\r\n *\r\n * --- DOM structure ---\r\n * rootEl {\r\n * \ttransEl [\r\n * \t\tboundsEl\r\n * \t\tedges[]\r\n * \t\tcorners[] - round grips in the corner of transform region\r\n * \t\tangleGrip\r\n * \t]\r\n * }\r\n *\r\n */\r\nexport class FreeTransform {\r\n\r\n    // --- private ---\r\n    private readonly transform: ITransform; // coordinates and dimensions of transformation\r\n    private isConstrained: boolean;\r\n    private ratio: number; // aspect ratio of transform\r\n    private readonly scale: number;\r\n    private readonly scaled = { // scaled coordinates and dimensions for screenspace\r\n        x: 0,\r\n        y: 0,\r\n        width: 0,\r\n        height: 0,\r\n        corners: [{x: 0, y: 0}], // in transform space\r\n    };\r\n    private readonly minSnapDist = 7; // minimal snapping distance in px screenspace\r\n    private snappingEnabled: boolean;\r\n    private readonly snapX: number[];\r\n    private readonly snapY: number[];\r\n    private readonly callback: (transform: ITransform) => void;\r\n\r\n\r\n    private readonly cornerCursors = ['nw', 'n', 'ne', 'e', 'se', 's', 'sw', 'w'];\r\n    private readonly gripSize = 14;\r\n    private readonly edgeSize = 10;\r\n\r\n    private readonly rootEl: HTMLElement; // sits at origin of image\r\n    private readonly transEl: HTMLElement; // at middle of transform. rotates\r\n    private readonly boundsEl: HTMLElement; // draggable bounds rectangle with outline\r\n    private readonly corners: {\r\n        i: number; // index in corners array\r\n        el: HTMLElement; // draggable corner circle in DOM\r\n        x: number; // unscaled position (transform space)\r\n        y: number;\r\n        virtualPos: IVector2D; // unscaled temporary position (image space)\r\n        updateDOM: () => void; // update styling in DOM\r\n        pointerListener: any;\r\n    }[] = [];\r\n    private keyListener: KeyListener;\r\n    private boundsPointerListener: any; // BB.PointerListener\r\n    private anglePointerListener: any; // BB.PointerListener\r\n    private readonly edges: { // derive position from corners\r\n        el: HTMLElement;\r\n        updateDOM: () => void;\r\n        pointerListener: any;\r\n    }[] = [];\r\n    private readonly angleGrip: {\r\n        el: HTMLElement,\r\n        x: number; // transform space\r\n        y: number;\r\n        snap: boolean,\r\n        updateDOM: () => void,\r\n    };\r\n\r\n    private updateScaled(): void {\r\n        this.scaled.x = this.transform.x * this.scale;\r\n        this.scaled.y = this.transform.y * this.scale;\r\n        this.scaled.width = this.transform.width * this.scale;\r\n        this.scaled.height = this.transform.height * this.scale;\r\n        this.scaled.corners = this.corners.map((item) => {\r\n            return {x: item.x * this.scale, y: item.y * this.scale};\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Returns snapped point, if ix, iy snaps. If no snapping, returns point unchanged.\r\n     * both in image space\r\n     *\r\n     * @param iX - image space\r\n     * @param iY - image space\r\n     * @private\r\n     */\r\n    private snapCorner (iX: number, iY: number): IVector2D {\r\n        if (!this.snappingEnabled) {\r\n            return {x: iX, y: iY};\r\n        }\r\n        let dist: number;\r\n        const snap: {\r\n            x: number;\r\n            y: number;\r\n            dist: {\r\n                x: number;\r\n                y: number;\r\n            }\r\n        } = {\r\n            x: null,\r\n            y: null,\r\n            dist: {\r\n                x: null,\r\n                y: null,\r\n            }\r\n        };\r\n        for (let e = 0; e < this.snapX.length; e++) {\r\n            dist = Math.abs(iX - this.snapX[e]);\r\n            if (dist < this.minSnapDist / this.scale) {\r\n                if (snap.x === null || dist < snap.dist.x) {\r\n                    snap.x = this.snapX[e];\r\n                    snap.dist.x = dist;\r\n                }\r\n            }\r\n        }\r\n        for (let e = 0; e < this.snapY.length; e++) {\r\n            dist = Math.abs(iY - this.snapY[e]);\r\n            if (dist < this.minSnapDist / this.scale) {\r\n                if (snap.y === null || dist < snap.dist.y) {\r\n                    snap.y = this.snapY[e];\r\n                    snap.dist.y = dist;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (snap.x === null && snap.y === null) {\r\n            return {\r\n                x: iX,\r\n                y: iY,\r\n            };\r\n        }\r\n        return {\r\n            x: snap.x === null ? iX : snap.x,\r\n            y: snap.y === null ? iY : snap.y,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * If constrained return nearest corner pos that fits aspect ratio\r\n     *\r\n     * @param cornerIndex\r\n     * @param iX\r\n     * @param iY\r\n     * @private\r\n     */\r\n    private constrainCorner (cornerIndex: number, iX: number, iY: number): IVector2D {\r\n        if (!this.isConstrained) {\r\n            return {\r\n                x: iX,\r\n                y: iY,\r\n            };\r\n        }\r\n        const flip = this.transform.width * this.transform.height < 0 ? -1 : 1;\r\n        return BB.projectPointOnLine(\r\n            {x: this.transform.x, y: this.transform.y},\r\n            toImageSpace(this.ratio, flip * ([0, 2].includes(cornerIndex) ? 1 : -1), this.transform),\r\n            {x: iX, y: iY}\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Update corners according to width height.\r\n     * Not their DOM.\r\n     */\r\n    private updateCornerPositions (): void {\r\n        this.corners[0].x = (-this.transform.width / 2); // top left\r\n        this.corners[0].y = (-this.transform.height / 2);\r\n\r\n        this.corners[1].x = (this.transform.width / 2); // top right\r\n        this.corners[1].y = (-this.transform.height / 2);\r\n\r\n        this.corners[2].x = (this.transform.width / 2); // bottom right\r\n        this.corners[2].y = (this.transform.height / 2);\r\n\r\n        this.corners[3].x = (-this.transform.width / 2); // bottom left\r\n        this.corners[3].y = (this.transform.height / 2);\r\n    }\r\n\r\n    /**\r\n     * If constrained and dragging an edge, restore aspect ratio\r\n     * Updates corner positions.\r\n     *\r\n     * @param widthChanged\r\n     * @param heightChanged\r\n     * @private\r\n     */\r\n    private restoreRatio (widthChanged: boolean, heightChanged: boolean): void {\r\n        if (!this.isConstrained) {\r\n            return;\r\n        }\r\n        const angle90 = Math.abs(this.transform.angleDeg) % 90 === 0;\r\n        const whSwapped = Math.abs(this.transform.angleDeg - 90) % 180 === 0;\r\n        if (heightChanged && !widthChanged) {\r\n            const newHeight = Math.abs(this.corners[3].y - this.corners[0].y);\r\n            let newWidth = this.ratio * newHeight;\r\n            if (angle90) {\r\n                newWidth = (whSwapped ? this.transform.y % 1 : this.transform.x % 1) === 0 ?\r\n                    BB.roundEven(newWidth) : BB.roundUneven(newWidth);\r\n            }\r\n            if (this.corners[1].x - this.corners[0].x < 0) {\r\n                newWidth *= -1;\r\n            }\r\n            this.corners[0].x = -newWidth / 2;\r\n            this.corners[3].x = -newWidth / 2;\r\n            this.corners[1].x = newWidth / 2;\r\n            this.corners[2].x = newWidth / 2;\r\n        }\r\n        if (!heightChanged && widthChanged) {\r\n            const newWidth = Math.abs(this.corners[0].x - this.corners[1].x);\r\n            let newHeight = newWidth / this.ratio;\r\n            if (angle90) {\r\n                newHeight = (whSwapped ? this.transform.x % 1 : this.transform.y % 1) === 0  ?\r\n                    BB.roundEven(newHeight) : BB.roundUneven(newHeight);\r\n            }\r\n            if (this.corners[3].y - this.corners[0].y < 0) {\r\n                newHeight *= -1;\r\n            }\r\n            this.corners[0].y = -newHeight / 2;\r\n            this.corners[1].y = -newHeight / 2;\r\n            this.corners[2].y = newHeight / 2;\r\n            this.corners[3].y = newHeight / 2;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * update transform based on corners\r\n     * @private\r\n     */\r\n    private updateTransformViaCorners (): void {\r\n\r\n        // calc transform center in image space\r\n        const rot = BB.rotateAround(\r\n            {x: 0, y: 0},\r\n            {\r\n                x: (this.corners[0].x + this.corners[1].x) / 2,\r\n                y: (this.corners[0].y + this.corners[3].y) / 2,\r\n            },\r\n            this.transform.angleDeg\r\n        );\r\n        this.transform.x = rot.x + this.transform.x;\r\n        this.transform.y = rot.y + this.transform.y;\r\n\r\n        // update size\r\n        this.transform.width = this.corners[1].x - this.corners[0].x;\r\n        this.transform.height = this.corners[3].y - this.corners[0].y;\r\n\r\n        // new center means corners changed their position\r\n        this.updateCornerPositions();\r\n\r\n        this.updateDOM();\r\n    }\r\n\r\n    /**\r\n     * updates DOM according to transform\r\n     * @param skipCallback\r\n     */\r\n    private updateDOM (skipCallback?: boolean) {\r\n        this.updateScaled();\r\n\r\n        BB.css(this.transEl, {\r\n            left: this.scaled.x + \"px\",\r\n            top: this.scaled.y + \"px\",\r\n            transformOrigin: \"0 0\",\r\n            transform: \"rotate(\" + this.transform.angleDeg + \"deg)\",\r\n        });\r\n\r\n        BB.css(this.boundsEl, {\r\n            width: Math.abs(this.scaled.width) + \"px\",\r\n            height: Math.abs(this.scaled.height) + \"px\",\r\n            left: Math.min(this.scaled.corners[0].x, this.scaled.corners[1].x) + \"px\",\r\n            top: Math.min(this.scaled.corners[0].y, this.scaled.corners[3].y) + \"px\"\r\n        });\r\n\r\n        this.corners[0].updateDOM();\r\n        this.corners[1].updateDOM();\r\n        this.corners[2].updateDOM();\r\n        this.corners[3].updateDOM();\r\n\r\n        this.edges[0].updateDOM();\r\n        this.edges[1].updateDOM();\r\n        this.edges[2].updateDOM();\r\n        this.edges[3].updateDOM();\r\n\r\n\r\n        this.angleGrip.x = 0;\r\n        this.angleGrip.y = (-Math.abs(this.transform.height * this.scale) / 2) - 20;\r\n        this.angleGrip.updateDOM();\r\n        if (!skipCallback) {\r\n            if (this.callback) { // why should updateDOM trigger the callback?\r\n                this.callback(copyTransform(this.transform));\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    // --- public ---\r\n    constructor (\r\n        params: {\r\n            x: number; // center of transform region. image space\r\n            y: number;\r\n            width: number; // size of transform region. image space\r\n            height: number;\r\n            angleDeg: number; // angle of transform region. degrees\r\n\r\n            isConstrained: boolean; // proportions constrained\r\n            snapX: number[]; // where snapping along X axis. image space\r\n            snapY: number[]; // where snapping along X axis. image space\r\n            scale: number; // ratio of screen-space / image-space\r\n            callback: (transform: ITransform) => void;\r\n        }\r\n    ) {\r\n        this.transform = { // coordinates and dimensions of transformation\r\n            x: params.x,\r\n            y: params.y,\r\n            width: params.width,\r\n            height: params.height,\r\n            angleDeg: params.angleDeg,\r\n        };\r\n\r\n        this.isConstrained = !!params.isConstrained;\r\n\r\n        this.snapX = params.snapX;\r\n        this.snapY = params.snapY;\r\n        this.callback = params.callback;\r\n        this.scale = params.scale;\r\n        this.snappingEnabled = true;\r\n        this.ratio = this.transform.width / this.transform.height;\r\n\r\n        this.rootEl = BB.el({\r\n            className: 'kl-free-transform',\r\n            css: {\r\n                userSelect: 'none',\r\n            }\r\n        });\r\n        this.transEl = BB.el({\r\n            parent: this.rootEl,\r\n            css: {\r\n                position: 'absolute',\r\n            }\r\n        });\r\n\r\n        this.boundsEl = BB.el({\r\n            css: {\r\n                position: 'absolute',\r\n                cursor: 'move',\r\n                boxShadow: 'rgba(255, 255, 255, 0.5) 0 0 0 1px inset, rgba(0, 0, 0, 0.5) 0 0 0 1px',\r\n            }\r\n        });\r\n\r\n        const pointerRemainder = {\r\n            x: 0,\r\n            y: 0,\r\n        };\r\n        function resetRemainder() {\r\n            pointerRemainder.x = 0;\r\n            pointerRemainder.y = 0;\r\n        }\r\n        this.keyListener = new BB.KeyListener({});\r\n\r\n        let boundsStartP = {\r\n            x: 0,\r\n            y: 0,\r\n        }\r\n        this.boundsPointerListener = new BB.PointerListener({\r\n            target: this.boundsEl,\r\n            fixScribble: true,\r\n            onPointer: (event) => {\r\n                event.eventPreventDefault();\r\n                if (event.type === 'pointerdown') {\r\n                    boundsStartP = {x: this.transform.x, y: this.transform.y};\r\n                }\r\n                if (event.type === 'pointermove' && event.button === 'left') {\r\n                    this.transform.x = boundsStartP.x + (event.pageX - event.downPageX) / this.scale;\r\n                    this.transform.y = boundsStartP.y + (event.pageY - event.downPageY) / this.scale;\r\n\r\n\r\n                    let dist;\r\n                    let snap: any = {};\r\n                    if (this.snappingEnabled) {\r\n                        let i;\r\n                        for (i = 0; i < this.snapX.length; i++) {\r\n                            dist = Math.abs(this.transform.x - this.snapX[i]);\r\n                            if (dist < this.minSnapDist / this.scale) {\r\n                                if (!snap.x || dist < snap.distX) {\r\n                                    snap.x = this.snapX[i];\r\n                                    snap.distX = dist;\r\n                                }\r\n                            }\r\n                        }\r\n                        for (i = 0; i < this.snapY.length; i++) {\r\n                            dist = Math.abs(this.transform.y - this.snapY[i]);\r\n                            if (dist < this.minSnapDist / this.scale) {\r\n                                if (!snap.y || dist < snap.distY) {\r\n                                    snap.y = this.snapY[i];\r\n                                    snap.distY = dist;\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        let iP;\r\n                        for (i = 0; i < 4; i++) {\r\n                            iP = toImageSpace(this.corners[i].x, this.corners[i].y, this.transform);\r\n                            let j;\r\n                            for (j = 0; j < this.snapX.length; j++) {\r\n                                dist = Math.abs(iP.x - this.snapX[j]);\r\n                                if (dist < this.minSnapDist / this.scale) {\r\n                                    if (!snap.x || dist < snap.distX) {\r\n                                        snap.x = this.snapX[j] - (iP.x - this.transform.x);\r\n                                        snap.distX = dist;\r\n                                    }\r\n                                }\r\n                            }\r\n                            for (j = 0; j < this.snapY.length; j++) {\r\n                                dist = Math.abs(iP.y - this.snapY[j]);\r\n                                if (dist < this.minSnapDist / this.scale) {\r\n                                    if (!snap.y || dist < snap.distY) {\r\n                                        snap.y = this.snapY[j] - (iP.y - this.transform.y);\r\n                                        snap.distY = dist;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    if (this.keyListener.getComboStr() === 'shift') {\r\n                        let projected = BB.projectPointOnLine(\r\n                            {x: 0, y: boundsStartP.y},\r\n                            {x: 10, y: boundsStartP.y},\r\n                            {x: this.transform.x, y: this.transform.y});\r\n                        let dist = BB.dist(projected.x, projected.y, this.transform.x, this.transform.y);\r\n                        snap = {};\r\n                        snap.x = projected.x;\r\n                        snap.y = projected.y;\r\n                        snap.distX = dist;\r\n                        snap.distY = dist;\r\n\r\n                        projected = BB.projectPointOnLine(\r\n                            {x: boundsStartP.x, y: 0},\r\n                            {x: boundsStartP.x, y: 10},\r\n                            {x: this.transform.x, y: this.transform.y});\r\n                        dist = BB.dist(projected.x, projected.y, this.transform.x, this.transform.y);\r\n                        if (dist < snap.distX) {\r\n                            snap.x = projected.x;\r\n                            snap.y = projected.y;\r\n                            snap.distX = dist;\r\n                            snap.distY = dist;\r\n                        }\r\n\r\n                        projected = BB.projectPointOnLine(\r\n                            {x: boundsStartP.x, y: boundsStartP.y},\r\n                            {x: boundsStartP.x + 1, y: boundsStartP.y + 1},\r\n                            {x: this.transform.x, y: this.transform.y});\r\n                        dist = BB.dist(projected.x, projected.y, this.transform.x, this.transform.y);\r\n                        if (dist < snap.distX) {\r\n                            snap.x = projected.x;\r\n                            snap.y = projected.y;\r\n                            snap.distX = dist;\r\n                            snap.distY = dist;\r\n                        }\r\n\r\n                        projected = BB.projectPointOnLine(\r\n                            {x: boundsStartP.x, y: boundsStartP.y},\r\n                            {x: boundsStartP.x + 1, y: boundsStartP.y - 1},\r\n                            {x: this.transform.x, y: this.transform.y});\r\n                        dist = BB.dist(projected.x, projected.y, this.transform.x, this.transform.y);\r\n                        if (dist < snap.distX) {\r\n                            snap.x = projected.x;\r\n                            snap.y = projected.y;\r\n                            snap.distX = dist;\r\n                            snap.distY = dist;\r\n                        }\r\n                    }\r\n                    if (snap.x != undefined) {\r\n                        this.transform.x = snap.x;\r\n                    }\r\n                    if (snap.y != undefined) {\r\n                        this.transform.y = snap.y;\r\n                    }\r\n\r\n                    // snap to pixels\r\n                    if (Math.abs(this.transform.angleDeg) % 90 === 0) {\r\n                        snapToPixel(this.transform);\r\n                        this.updateCornerPositions();\r\n                    }\r\n\r\n                    this.updateDOM();\r\n                }\r\n            }\r\n        })\r\n\r\n        for (let i = 0; i < 4; i++) {\r\n            ((i) => {\r\n                const g = this.corners[i] = {\r\n                    i: i,\r\n                    el: BB.el({\r\n                        css: {\r\n                            width: this.gripSize + 'px',\r\n                            height: this.gripSize + 'px',\r\n                            background: '#fff',\r\n                            /*background: [\r\n                                '#ff0000',\r\n                                '#00ff00',\r\n                                '#0000ff',\r\n                                '#ff00ff',\r\n                            ][i],*/\r\n                            borderRadius: this.gripSize + 'px',\r\n                            position: 'absolute',\r\n                            boxShadow: 'inset 0 0 0 2px #000'\r\n                        }\r\n                    }),\r\n                    x: 0,\r\n                    y: 0,\r\n                    virtualPos: {\r\n                        x: 0,\r\n                        y: 0,\r\n                    },\r\n                    updateDOM: null,\r\n                    pointerListener: null,\r\n                };\r\n                g.updateDOM = () => {\r\n\r\n                    // grip position\r\n                    // if gets small, offset grips, so easier to handle\r\n                    const offsetArr = [[-1, -1], [1, -1], [1, 1], [-1, 1]].map(item => {\r\n                        item[0] *= this.transform.width > 0 ? 1 : -1;\r\n                        item[1] *= this.transform.height > 0 ? 1 : -1;\r\n                        return item;\r\n                    });\r\n                    const tinyOffset = Math.abs(this.scaled.width) < 20 || Math.abs(this.scaled.height) < 20 ? 10 : 0;\r\n\r\n                    BB.css(g.el, {\r\n                        left: (this.scaled.corners[g.i].x - this.gripSize / 2 + offsetArr[i][0] * tinyOffset) + 'px',\r\n                        top: (this.scaled.corners[g.i].y - this.gripSize / 2 + offsetArr[i][1] * tinyOffset) + 'px'\r\n                    });\r\n\r\n\r\n                    // cursor\r\n                    let angle = BB.pointsToAngleDeg(\r\n                        {\r\n                            x: this.transform.x,\r\n                            y: this.transform.y,\r\n                        },\r\n                        toImageSpace(g.x, g.y, this.transform),\r\n                    ) + 135; // offset so nw is 0\r\n                    while (angle < 0) {\r\n                        angle += 360;\r\n                    }\r\n                    let index = Math.round(angle / 45) % this.cornerCursors.length;\r\n                    BB.css(g.el, {\r\n                        cursor: this.cornerCursors[index] + '-resize',\r\n                    });\r\n                };\r\n\r\n                g.pointerListener = new BB.PointerListener({\r\n                    target: this.corners[i].el,\r\n                    fixScribble: true,\r\n                    onPointer: (event) => {\r\n                        event.eventPreventDefault();\r\n                        if (event.type === 'pointerdown' && event.button === 'left') {\r\n                            this.corners[i].virtualPos = toImageSpace(this.corners[i].x, this.corners[i].y, this.transform);\r\n\r\n                        } else if (event.type === 'pointermove' && event.button === 'left') {\r\n                            this.corners[i].virtualPos.x += event.dX / this.scale;\r\n                            this.corners[i].virtualPos.y += event.dY / this.scale;\r\n\r\n                            let iP = {\r\n                                x: this.corners[i].virtualPos.x,\r\n                                y: this.corners[i].virtualPos.y,\r\n                            };\r\n                            iP = this.constrainCorner(i, iP.x, iP.y);\r\n                            if (!this.isConstrained) {\r\n                                iP = this.snapCorner(iP.x, iP.y);\r\n                            }\r\n\r\n                            if (Math.abs(this.transform.angleDeg) % 90 === 0) {\r\n                                iP.x = Math.round(iP.x);\r\n                                iP.y = Math.round(iP.y);\r\n                            }\r\n\r\n                            const tP = toTransformSpace(iP.x, iP.y, this.transform);\r\n\r\n                            const dX = tP.x - this.corners[i].x;\r\n                            const dY = tP.y - this.corners[i].y;\r\n                            this.corners[i].x = tP.x;\r\n                            this.corners[i].y = tP.y;\r\n\r\n                            let indexes = [];\r\n                            if (i === 0) { // top left\r\n                                indexes = [3, 1, 2];\r\n                            } else if (i === 1) { // top right\r\n                                indexes = [2, 0, 3];\r\n                            } else if (i === 2) { // bottom right\r\n                                indexes = [1, 3, 0];\r\n                            } else if (i === 3) { // bottom left\r\n                                indexes = [0, 2, 1];\r\n                            }\r\n\r\n                            this.corners[indexes[0]].x = this.corners[i].x;\r\n                            this.corners[indexes[1]].y = this.corners[i].y;\r\n                            if(this.keyListener.isPressed('shift')) {\r\n                                this.corners[indexes[2]].x -= dX;\r\n                                this.corners[indexes[2]].y -= dY;\r\n                                this.corners[indexes[1]].x = this.corners[indexes[2]].x;\r\n                                this.corners[indexes[0]].y = this.corners[indexes[2]].y;\r\n                            }\r\n\r\n                            this.updateTransformViaCorners();\r\n\r\n                        }\r\n                    }\r\n                });\r\n\r\n            })(i);\r\n        }\r\n\r\n        this.updateCornerPositions();\r\n        this.updateScaled();\r\n\r\n        let isInverted: boolean;\r\n        for (let i = 0; i < 4; i++) {\r\n            ((i) => {\r\n                this.edges[i] = {\r\n                    el: BB.el({\r\n                        css: {\r\n                            width: this.edgeSize + 'px',\r\n                            height: this.edgeSize + 'px',\r\n                            /*background: [\r\n                                '#ff000044',\r\n                                '#00ff0044',\r\n                                '#0000ff44',\r\n                                '#ff00ff44',\r\n                            ][i],*/\r\n                            position: 'absolute',\r\n                        },\r\n                    }),\r\n                    updateDOM: null,\r\n                    pointerListener: null,\r\n                };\r\n                const g = this.edges[i];\r\n                g.updateDOM = () => {\r\n                    if (i === 0) {\r\n                        BB.css(g.el, {\r\n                            left: Math.min(this.scaled.corners[0].x, this.scaled.corners[1].x) + 'px',\r\n                            top: (Math.min(this.scaled.corners[0].y, this.scaled.corners[3].y) - this.edgeSize) + 'px',\r\n                            width: Math.abs(this.scaled.width) + 'px',\r\n                            height: this.edgeSize + 'px',\r\n                        });\r\n                    } else if (i === 1) {\r\n                        BB.css(g.el, {\r\n                            left: Math.max(this.scaled.corners[0].x, this.scaled.corners[1].x) + 'px',\r\n                            top: Math.min(this.scaled.corners[1].y, this.scaled.corners[2].y) + 'px',\r\n                            width: this.edgeSize + 'px',\r\n                            height: Math.abs(this.scaled.height) + 'px',\r\n                        });\r\n                    } else if (i === 2) {\r\n                        BB.css(g.el, {\r\n                            left: Math.min(this.scaled.corners[3].x, this.scaled.corners[2].x) + 'px',\r\n                            top: Math.max(this.scaled.corners[0].y,this.scaled.corners[3].y) + 'px',\r\n                            width: Math.abs(this.scaled.width) + 'px',\r\n                            height: this.edgeSize + 'px',\r\n                        });\r\n                    } else if (i === 3) {\r\n                        BB.css(g.el, {\r\n                            left: (Math.min(this.scaled.corners[0].x, this.scaled.corners[1].x) - this.edgeSize) + 'px',\r\n                            top: Math.min(this.scaled.corners[0].y, this.scaled.corners[3].y) + 'px',\r\n                            width: this.edgeSize + 'px',\r\n                            height: Math.abs(this.scaled.height) + 'px',\r\n                        });\r\n                    }\r\n                    let angleOffset = Math.round(this.transform.angleDeg / 45);\r\n                    while (angleOffset < 0)\r\n                        angleOffset += 8;\r\n                    angleOffset = (i * 2 + 1 + angleOffset) % this.cornerCursors.length;\r\n                    g.el.style.cursor = this.cornerCursors[angleOffset] + '-resize';\r\n\r\n                };\r\n\r\n                const isVertical = [0, 2].includes(i);\r\n                g.pointerListener = new BB.PointerListener({\r\n                    target: this.edges[i].el,\r\n                    fixScribble: true,\r\n                    onPointer: (event) => {\r\n                        event.eventPreventDefault();\r\n                        if (event.type === 'pointerdown' && event.button === 'left') {\r\n                            if (isVertical) { // top bottom\r\n                                isInverted = this.corners[0].y >= this.corners[3].y;\r\n                            } else { // left right\r\n                                isInverted = this.corners[0].x >= this.corners[1].x;\r\n                            }\r\n                            resetRemainder();\r\n                        }\r\n                        if (event.type === 'pointermove' && event.button === 'left') {\r\n                            const tfD = BB.rotateAround({x: 0, y: 0},\r\n                                {x: event.dX / this.scale, y: event.dY / this.scale},\r\n                                -this.transform.angleDeg);\r\n                            let ti = {\r\n                                dX: tfD.x,\r\n                                dY: tfD.y,\r\n                            };\r\n                            if (Math.abs(this.transform.angleDeg) % 90 === 0) {\r\n                                ti = BB.intDxy(pointerRemainder, tfD.x, tfD.y);\r\n                            }\r\n\r\n                            let indexes = [];\r\n                            if (i === 0) { // top\r\n                                indexes = [2, 3, 0, 1];\r\n                            } else if (i === 1) { // right\r\n                                indexes = [0, 3, 1, 2];\r\n                            } else if (i === 2) { // bottom\r\n                                indexes = [0, 1, 2, 3];\r\n                            } else if (i === 3) { // left\r\n                                indexes = [1, 2, 0, 3];\r\n                            }\r\n\r\n                            let dimension = isVertical ? 'y' : 'x';\r\n                            let d = isVertical ? ti.dY : ti.dX;\r\n\r\n                            if (isInverted) {\r\n                                this.corners[indexes[0]][dimension] += d;\r\n                                this.corners[indexes[1]][dimension] += d;\r\n                            } else {\r\n                                this.corners[indexes[2]][dimension] += d;\r\n                                this.corners[indexes[3]][dimension] += d;\r\n                            }\r\n                            if (this.keyListener.isPressed('shift')) {\r\n                                if (isInverted) {\r\n                                    this.corners[indexes[2]][dimension] -= d;\r\n                                    this.corners[indexes[3]][dimension] -= d;\r\n                                } else {\r\n                                    this.corners[indexes[0]][dimension] -= d;\r\n                                    this.corners[indexes[1]][dimension] -= d;\r\n                                }\r\n                            }\r\n\r\n                            if (isVertical) { // top bottom\r\n                                this.restoreRatio(false, true);\r\n                            } else { // left right\r\n                                this.restoreRatio(true, false);\r\n                            }\r\n\r\n                            this.updateTransformViaCorners();\r\n\r\n                        }\r\n                    }\r\n                });\r\n\r\n            })(i);\r\n        }\r\n\r\n        this.angleGrip = {\r\n            el: BB.el({\r\n                css: {\r\n                    cursor: 'url(' + rotateImg + ') 10 10, move',\r\n                    width: this.gripSize + 'px',\r\n                    height: this.gripSize + 'px',\r\n                    background: '#0ff',\r\n                    borderRadius: this.gripSize + 'px',\r\n                    position: 'absolute',\r\n                    boxShadow: 'inset 0 0 0 2px #000',\r\n                },\r\n            }),\r\n            x: 0,\r\n            y: 0,\r\n            snap: false,\r\n            updateDOM: () => {\r\n                BB.css(this.angleGrip.el, {\r\n                    left: (this.angleGrip.x - this.gripSize / 2) + 'px',\r\n                    top: (this.angleGrip.y - this.gripSize / 2) + 'px',\r\n                });\r\n            },\r\n        };\r\n        BB.el({\r\n            parent: this.angleGrip.el,\r\n            css: {\r\n                width: '2px',\r\n                height: '13px',\r\n                left: (this.gripSize / 2 - 1) + 'px',\r\n                top: this.gripSize + 'px',\r\n                background: '#0ff',\r\n                position: 'absolute'\r\n            }\r\n        });\r\n\r\n        this.anglePointerListener = new BB.PointerListener({\r\n            target: this.angleGrip.el,\r\n            fixScribble: true,\r\n            onPointer: (event) => {\r\n                event.eventPreventDefault();\r\n                if (event.type === 'pointermove' && event.button === 'left') {\r\n\r\n                    const offset = BB.getPageOffset(this.rootEl);\r\n                    const iP = {x: (event.pageX - offset.x) / this.scale, y: (event.pageY - offset.y) / this.scale};\r\n\r\n                    const a = BB.pointsToAngleDeg({x: this.transform.x, y: this.transform.y}, iP) + 90;\r\n                    this.transform.angleDeg = a;\r\n                    const snapDeg = Math.round(a / 360 * 8) * 45;\r\n                    if (this.keyListener.getComboStr() === 'shift') {\r\n                        this.transform.angleDeg = snapDeg;\r\n                    } else if (this.snappingEnabled && Math.abs(snapDeg - a) < 8) {\r\n                        this.transform.angleDeg = snapDeg;\r\n                    }\r\n                    this.updateDOM();\r\n\r\n                }\r\n                if (event.type === 'pointerup') {\r\n                    if (Math.abs(this.transform.angleDeg) % 90 === 0) {\r\n                        snapToPixel(this.transform);\r\n                        this.updateCornerPositions();\r\n                        this.updateDOM();\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        snapToPixel(this.transform);\r\n        this.updateDOM(true);\r\n        BB.append(this.transEl, [\r\n            this.boundsEl,\r\n            this.edges[0].el,\r\n            this.edges[1].el,\r\n            this.edges[2].el,\r\n            this.edges[3].el,\r\n            this.corners[0].el,\r\n            this.corners[1].el,\r\n            this.corners[2].el,\r\n            this.corners[3].el,\r\n            this.angleGrip.el,\r\n        ]);\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    getTransform (): ITransform {\r\n        return copyTransform(this.transform);\r\n    }\r\n\r\n    setConstrained (b: boolean): void {\r\n        this.isConstrained = !!b;\r\n        if (b && this.transform.width !== 0 && this.transform.height !== 0) {\r\n            this.ratio = Math.abs(this.transform.width / this.transform.height);\r\n        }\r\n    }\r\n\r\n    setSnapping (s: boolean): void {\r\n        this.snappingEnabled = !!s;\r\n    }\r\n\r\n    setPos (p: IVector2D): void {\r\n        this.transform.x = p.x;\r\n        this.transform.y = p.y;\r\n        this.updateDOM(true);\r\n    }\r\n\r\n    move (dX: number, dY: number): void {\r\n        this.transform.x += dX;\r\n        this.transform.y += dY;\r\n        this.updateDOM(false);\r\n    }\r\n\r\n    setSize (w: number, h: number): void {\r\n        this.transform.width = w;\r\n        this.transform.height = h;\r\n        if (Math.abs(this.transform.angleDeg) % 90 === 0) {\r\n            snapToPixel(this.transform);\r\n        }\r\n        this.updateCornerPositions();\r\n        this.updateDOM(false);\r\n    }\r\n\r\n    setAngleDeg (a: number): void {\r\n        this.transform.angleDeg = a;\r\n        if (Math.abs(this.transform.angleDeg) % 90 === 0) {\r\n            snapToPixel(this.transform);\r\n            this.updateCornerPositions();\r\n        }\r\n        this.updateDOM(true);\r\n    }\r\n\r\n    getElement (): HTMLElement {\r\n        return this.rootEl;\r\n    }\r\n\r\n    getRatio (): number {\r\n        return this.ratio;\r\n    }\r\n\r\n    destroy (): void {\r\n        this.keyListener.destroy();\r\n        this.boundsPointerListener.destroy();\r\n        this.corners[0].pointerListener.destroy();\r\n        this.corners[1].pointerListener.destroy();\r\n        this.corners[2].pointerListener.destroy();\r\n        this.corners[3].pointerListener.destroy();\r\n        this.edges[0].pointerListener.destroy();\r\n        this.edges[1].pointerListener.destroy();\r\n        this.edges[2].pointerListener.destroy();\r\n        this.edges[3].pointerListener.destroy();\r\n        this.anglePointerListener.destroy();\r\n    }\r\n\r\n}\r\n","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"045N6\");","import {BB} from '../../../bb/bb';\r\nimport {KlCanvasPreview} from '../../canvas-ui/canvas-preview';\r\nimport {FreeTransform} from './free-transform';\r\n\r\n/**\r\n * a basic canvas where you can transform one layer(move around, rotate, scale)\r\n *\r\n * @param params\r\n * @returns {HTMLDivElement}\r\n * @constructor\r\n */\r\nexport function FreeTransformCanvas(params: {\r\n    elementWidth: number;\r\n    elementHeight: number;\r\n    imageWidth: number;\r\n    imageHeight: number;\r\n    layerArr: {\r\n            canvas: (HTMLCanvasElement | HTMLImageElement),\r\n            opacity: number; // 0-1\r\n            mixModeStr: string;\r\n    }[];\r\n    transformIndex: number;\r\n}) {\r\n    /*\r\n    div\r\n        innerWrapper\r\n            klCanvasPreview\r\n            transform.div\r\n    */\r\n\r\n    let previewFit = BB.fitInto(\r\n        params.imageWidth,\r\n        params.imageHeight,\r\n        params.elementWidth - 20,\r\n        params.elementHeight - 60,\r\n        1\r\n    );\r\n    let scale = previewFit.width / params.imageWidth;\r\n\r\n    let div = BB.el({\r\n        css: {\r\n            width: params.elementWidth + \"px\",\r\n            height: params.elementHeight + \"px\",\r\n            backgroundColor: \"#9e9e9e\",\r\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n            overflow: \"hidden\",\r\n            userSelect: \"none\",\r\n            position: \"relative\",\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n    div.oncontextmenu = function () {\r\n        return false;\r\n    };\r\n\r\n    let innerWrapper = BB.el({\r\n        css: {\r\n            position: 'relative',\r\n            boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n            width: previewFit.width + 'px',\r\n            height: previewFit.height + 'px'\r\n        }\r\n    });\r\n    div.appendChild(innerWrapper);\r\n\r\n    let previewLayerArr = params.layerArr.map(item => {\r\n        return {\r\n            canvas: item.canvas,\r\n            mixModeStr: item.mixModeStr,\r\n            opacity: item.opacity,\r\n        }\r\n    });\r\n    previewLayerArr[previewLayerArr.length - 1].canvas = BB.canvas(\r\n        scale > 1 ? params.imageWidth : previewFit.width,\r\n        scale > 1 ? params.imageHeight : previewFit.height,\r\n    );\r\n    let klCanvasPreview = new KlCanvasPreview({\r\n        width: previewFit.width,\r\n        height: previewFit.height,\r\n        layerArr: previewLayerArr\r\n    });\r\n    innerWrapper.appendChild(klCanvasPreview.getElement());\r\n\r\n    let freeTransform;\r\n    let initTransform;\r\n    function updatePreview() {\r\n        if(!freeTransform) {\r\n            return;\r\n        }\r\n\r\n        let transform = freeTransform.getTransform();\r\n        if (scale < 1) {\r\n            transform.x *= scale;\r\n            transform.y *= scale;\r\n            transform.width *= scale;\r\n            transform.height *= scale;\r\n        }\r\n\r\n        let destCanvas = previewLayerArr[params.transformIndex].canvas;\r\n        let ctx = (destCanvas as HTMLCanvasElement).getContext('2d');\r\n        ctx.save();\r\n        ctx.clearRect(0, 0, destCanvas.width, destCanvas.height);\r\n        BB.drawTransformedImageWithBounds(\r\n            ctx,\r\n            params.layerArr[params.transformIndex].canvas,\r\n            transform,\r\n            null,\r\n            BB.testShouldPixelate(transform, transform.width / initTransform.width, transform.height / initTransform.height),\r\n        );\r\n        ctx.restore();\r\n        klCanvasPreview.render();\r\n    }\r\n\r\n    {\r\n        let transformSize = {\r\n            width: params.layerArr[params.transformIndex].canvas.width * scale,\r\n            height: params.layerArr[params.transformIndex].canvas.height * scale\r\n        };\r\n        if(transformSize.width > previewFit.width || transformSize.height > previewFit.height) {\r\n            transformSize = BB.fitInto(\r\n                params.layerArr[params.transformIndex].canvas.width,\r\n                params.layerArr[params.transformIndex].canvas.height,\r\n                previewFit.width,\r\n                previewFit.height,\r\n                1\r\n            );\r\n        }\r\n        initTransform = {\r\n            x: params.imageWidth / 2,\r\n            y: params.imageHeight / 2,\r\n            width: params.layerArr[params.transformIndex].canvas.width,\r\n            height: params.layerArr[params.transformIndex].canvas.height,\r\n        };\r\n        freeTransform = new FreeTransform({\r\n            x: initTransform.x,\r\n            y: initTransform.y,\r\n            width: initTransform.width,\r\n            height: initTransform.height,\r\n            angleDeg: 0,\r\n            isConstrained: true,\r\n            snapX: [0, params.imageWidth],\r\n            snapY: [0, params.imageHeight],\r\n            scale: scale,\r\n            callback: (transform) => {\r\n                updatePreview();\r\n            },\r\n        });\r\n    }\r\n    BB.css(freeTransform.getElement(), {\r\n        position: 'absolute',\r\n        left: '0',\r\n        top: '0'\r\n    });\r\n    innerWrapper.appendChild(freeTransform.getElement());\r\n    setTimeout(updatePreview, 0);\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.move = function(dX, dY) {\r\n        freeTransform.move(dX, dY);\r\n    };\r\n    this.reset = function() {\r\n        let w = params.layerArr[params.transformIndex].canvas.width;\r\n        let h = params.layerArr[params.transformIndex].canvas.height;\r\n\r\n        freeTransform.setSize(w, h);\r\n        freeTransform.setPos({x: w / 2, y: h / 2});\r\n        freeTransform.setAngleDeg(0);\r\n        updatePreview();\r\n    };\r\n    this.setTransformFit = function() {\r\n\r\n        let fit = BB.fitInto(\r\n            params.layerArr[params.transformIndex].canvas.width,\r\n            params.layerArr[params.transformIndex].canvas.height,\r\n            params.imageWidth,\r\n            params.imageHeight,\r\n            1\r\n        );\r\n\r\n        freeTransform.setSize(fit.width, fit.height);\r\n        freeTransform.setPos({x: fit.width / 2, y: fit.height / 2});\r\n        freeTransform.setAngleDeg(0);\r\n        updatePreview();\r\n    };\r\n    this.setTransformCenter = function() {\r\n        freeTransform.setPos({x: params.imageWidth / 2, y: params.imageHeight / 2});\r\n        freeTransform.setAngleDeg(0);\r\n        updatePreview();\r\n    };\r\n    //gives you the transformation in the original scale\r\n    this.getTransformation = function () {\r\n        if (!freeTransform) {\r\n            return false;\r\n        }\r\n        return freeTransform.getTransform();\r\n    };\r\n    this.getIsPixelated = () => {\r\n        const transform = freeTransform.getTransform();\r\n        return BB.testShouldPixelate(transform, transform.width / initTransform.width, transform.height / initTransform.height);\r\n    };\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n    this.destroy = function() {\r\n        freeTransform.destroy();\r\n    };\r\n}","import {BB} from '../../../bb/bb';\r\n\r\n/*\r\n\tCropper params\r\n\t{\r\n\t\tx: int, //pos in relation zum bild\r\n\t\ty: int,\r\n\t\tw: int,\r\n\t\th: int,\r\n\t\tscale: float, //zoom\r\n\t\tcallback: function //wenn sich was ändert\r\n\t}\r\n\tthe div that you append this to must be relative\r\n*/\r\nexport function Cropper (params) {\r\n    let x = params.x,\r\n        y = params.y,\r\n        width = params.width,\r\n        height = params.height,\r\n        scale = params.scale,\r\n        callback = params.callback,\r\n        maxW = params.maxW,\r\n        maxH = params.maxH;\r\n    let div = document.createElement(\"div\");\r\n    let gripCursors = ['nw', 'n', 'ne', 'e', 'se', 's', 'sw', 'w'];\r\n\r\n    let keyListener = new BB.KeyListener({});\r\n\r\n    BB.css(div, {\r\n        position: \"absolute\",\r\n        left: (x * scale) + \"px\",\r\n        top: (y * scale) + \"px\"\r\n    });\r\n\r\n    let outline = document.createElement(\"div\");\r\n    BB.css(outline, {\r\n        position: \"absolute\",\r\n        border: \"1px dashed #fff\",\r\n        cursor: \"move\"\r\n    });\r\n    (outline as any).update = function () {\r\n        BB.css(outline, {\r\n            left: (grips[0].x * scale - 1) + \"px\",\r\n            top: (grips[0].y * scale - 1) + \"px\",\r\n            width: ((grips[2].x - grips[0].x) * scale) + \"px\",\r\n            height: ((grips[2].y - grips[0].y) * scale) + \"px\"\r\n        });\r\n    };\r\n    let pointerRemainder = { // needs to be reset after dragging complete\r\n        x: 0,\r\n        y: 0,\r\n    };\r\n    let outlinePointerListener = new BB.PointerListener({\r\n        target: outline,\r\n        onPointer: function(event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n\r\n                grips[0].x += dX;\r\n                grips[0].y += dY;\r\n                grips[1].x += dX;\r\n                grips[1].y += dY;\r\n                grips[2].x += dX;\r\n                grips[2].y += dY;\r\n                grips[3].x += dX;\r\n                grips[3].y += dY;\r\n\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n\r\n    let thirdsHorizontal = document.createElement(\"div\");\r\n    BB.css(thirdsHorizontal, {\r\n        position: \"absolute\",\r\n        borderTop: \"1px solid #0ff\",\r\n        borderBottom: \"1px solid #0ff\"\r\n    });\r\n    (thirdsHorizontal as any).update = function () {\r\n        BB.css(thirdsHorizontal, {\r\n            left: (grips[0].x * scale) + \"px\",\r\n            top: ((grips[0].y + (grips[2].y - grips[0].y) / 3) * scale) + \"px\",\r\n            width: ((grips[2].x - grips[0].x) * scale) + \"px\",\r\n            height: ((grips[2].y - grips[0].y) / 3 * scale) + \"px\"\r\n\r\n        });\r\n    };\r\n    let thirdsVertical = document.createElement(\"div\");\r\n    BB.css(thirdsVertical, {\r\n        position: \"absolute\",\r\n        borderLeft: \"1px solid #0ff\",\r\n        borderRight: \"1px solid #0ff\"\r\n    });\r\n    (thirdsVertical as any).update = function () {\r\n        BB.css(thirdsVertical, {\r\n            left: ((grips[0].x + (grips[2].x - grips[0].x) / 3) * scale) + \"px\",\r\n            top: (grips[0].y * scale) + \"px\",\r\n            width: ((grips[2].x - grips[0].x) / 3 * scale) + \"px\",\r\n            height: ((grips[2].y - grips[0].y) * scale) + \"px\"\r\n\r\n        });\r\n    };\r\n\r\n    const gripSize = 40;\r\n    const gripOverlay = 10;\r\n\r\n    let grips: {\r\n        x: number; // int\r\n        y: number;\r\n    }[] = [ // aka corner coordinates\r\n        {x: 0, y: 0}, // top left\r\n        {x: width, y: 0}, // top right\r\n        {x: width, y: height}, // bottom right\r\n        {x: 0, y: height}, //bottom left\r\n    ];\r\n\r\n    function transformTop(dY) {\r\n        grips[0].y += dY;\r\n        grips[0].y = Math.max(grips[3].y - maxH, Math.min(grips[3].y - 1, grips[0].y));\r\n        grips[1].y = grips[0].y;\r\n    }\r\n    function transformRight(dX) {\r\n        grips[1].x += dX;\r\n        grips[1].x = Math.min(grips[0].x + maxW, Math.max(grips[0].x + 1, grips[1].x));\r\n        grips[2].x = grips[1].x;\r\n    }\r\n    function transformBottom(dY) {\r\n        grips[2].y += dY;\r\n        grips[2].y = Math.min(grips[1].y + maxH, Math.max(grips[1].y + 1, grips[2].y));\r\n        grips[3].y = grips[2].y;\r\n    }\r\n    function transformLeft(dX) {\r\n        grips[0].x += dX;\r\n        grips[0].x = Math.max(grips[1].x - maxW, Math.min(grips[1].x - 1, grips[0].x));\r\n        grips[3].x = grips[0].x;\r\n    }\r\n\r\n    function commit() {\r\n        pointerRemainder.x = 0;\r\n        pointerRemainder.y = 0;\r\n        callback(getTransform());\r\n    }\r\n\r\n\r\n\r\n\r\n    let edges = [];\r\n    for (let i = 0; i < 4; i++) {\r\n        (function (i) {\r\n            edges[i] = document.createElement(\"div\");\r\n            let g = edges[i];\r\n            g.style.width = gripSize + \"px\";\r\n            g.style.height = gripSize + \"px\";\r\n            //g.style.background = \"#0f0\";\r\n            g.style.position = \"absolute\";\r\n            g.update = function () {\r\n                if (i === 0) { //top\r\n                    g.style.left = (grips[0].x * scale + gripOverlay) + \"px\";\r\n                    g.style.top = (grips[0].y * scale - gripSize * 2 + gripOverlay) + \"px\";\r\n                    g.style.width = ((grips[1].x - grips[0].x) * scale - gripOverlay * 2) + \"px\";\r\n                    g.style.height = (gripSize * 2) + \"px\";\r\n                } else if (i === 1) { //right\r\n                    g.style.left = (grips[1].x * scale - gripOverlay) + \"px\";\r\n                    g.style.top = (grips[1].y * scale + gripOverlay) + \"px\";\r\n                    g.style.width = (gripSize * 2) + \"px\";\r\n                    g.style.height = ((grips[2].y - grips[1].y) * scale - gripOverlay * 2) + \"px\";\r\n                } else if (i === 2) { //bottom\r\n                    g.style.left = (grips[3].x * scale + gripOverlay) + \"px\";\r\n                    g.style.top = (grips[3].y * scale - gripOverlay) + \"px\";\r\n                    g.style.width = ((grips[2].x - grips[3].x) * scale - gripOverlay * 2) + \"px\";\r\n                    g.style.height = (gripSize * 2) + \"px\";\r\n                } else if (i === 3) { //left\r\n                    g.style.left = (grips[0].x * scale - gripSize * 2 + gripOverlay) + \"px\";\r\n                    g.style.top = (grips[0].y * scale + gripOverlay) + \"px\";\r\n                    g.style.width = (gripSize * 2) + \"px\";\r\n                    g.style.height = ((grips[3].y - grips[0].y) * scale - gripOverlay * 2) + \"px\";\r\n                }\r\n                let angleOffset = i * 2 + 1;\r\n                g.style.cursor = gripCursors[angleOffset] + \"-resize\";\r\n\r\n            };\r\n        })(i);\r\n    }\r\n\r\n    let darken = [];\r\n    for (let i = 0; i < 4; i++) {\r\n        (function (i) {\r\n            darken[i] = document.createElement(\"div\");\r\n            let g = darken[i];\r\n            g.style.position = \"absolute\";\r\n            g.style.background = \"#000\";\r\n            g.style.opacity = \"0.5\";\r\n            g.update = function () {\r\n                if (i === 0) {\r\n                    g.style.left = (grips[0].x * scale) + \"px\";\r\n                    g.style.top = (grips[0].y * scale - 8000) + \"px\";\r\n                    g.style.width = ((grips[1].x - grips[0].x) * scale) + \"px\";\r\n                    g.style.height = \"8000px\";\r\n                } else if (i === 1) {\r\n                    g.style.left = (grips[1].x * scale) + \"px\";\r\n                    g.style.top = (grips[1].y * scale - 8000) + \"px\";\r\n                    g.style.width = \"8000px\";\r\n                    g.style.height = 16000 + \"px\";\r\n                } else if (i === 2) {\r\n                    g.style.left = (grips[3].x * scale) + \"px\";\r\n                    g.style.top = (grips[3].y * scale) + \"px\";\r\n                    g.style.width = ((grips[2].x - grips[3].x) * scale) + \"px\";\r\n                    g.style.height = \"8000px\";\r\n                } else if (i === 3) {\r\n                    g.style.left = (grips[0].x * scale - 8000) + \"px\";\r\n                    g.style.top = (grips[0].y * scale - 8000) + \"px\";\r\n                    g.style.width = \"8000px\";\r\n                    g.style.height = 16000 + \"px\";\r\n                }\r\n\r\n            };\r\n        })(i);\r\n    }\r\n\r\n    let edge0PointerListener = new BB.PointerListener({\r\n        target: edges[0],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformTop(dY);\r\n                if(keyListener.isPressed('shift')) {\r\n                    transformBottom(-dY);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n    let edge1PointerListener = new BB.PointerListener({\r\n        target: edges[1],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformRight(dX);\r\n                if(keyListener.isPressed('shift')) {\r\n                    transformLeft(-dX);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n    let edge2PointerListener = new BB.PointerListener({\r\n        target: edges[2],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformBottom(dY);\r\n                if(keyListener.isPressed('shift')) {\r\n                    transformTop(-dY);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n    let edge3PointerListener = new BB.PointerListener({\r\n        target: edges[3],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformLeft(dX);\r\n                if(keyListener.isPressed('shift')) {\r\n                    transformRight(-dX);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n\r\n\r\n    let cornerElArr = [];\r\n    (function() {\r\n        for (let i = 0; i < 4; i++) {\r\n            (function (i) {\r\n                cornerElArr[i] = document.createElement(\"div\");\r\n                let g = cornerElArr[i];\r\n                BB.css(g, {\r\n                    //background: '#f00',\r\n                    width: (gripSize * 2) + 'px',\r\n                    height: (gripSize * 2) + 'px',\r\n                    position: 'absolute'\r\n                });\r\n                g.style.cursor = ['nwse-resize', 'nesw-resize'][i % 2];\r\n                g.update = function () {\r\n                    if (i === 0) { //top left\r\n                        BB.css(g, {\r\n                            left: (grips[0].x * scale - gripSize * 2 + gripOverlay) + \"px\",\r\n                            top: (grips[0].y * scale - gripSize * 2 + gripOverlay) + \"px\"\r\n                        });\r\n                    } else if (i === 1) { //top right\r\n                        BB.css(g, {\r\n                            left: (grips[1].x * scale - gripOverlay) + \"px\",\r\n                            top: (grips[1].y * scale - gripSize * 2 + gripOverlay) + \"px\"\r\n                        });\r\n                    } else if (i === 2) { //bottom right\r\n                        BB.css(g, {\r\n                            left: (grips[1].x * scale - gripOverlay) + \"px\",\r\n                            top: (grips[2].y * scale - gripOverlay) + \"px\"\r\n                        });\r\n                    } else if (i === 3) { //bottom left\r\n                        BB.css(g, {\r\n                            left: (grips[0].x * scale - gripSize * 2 + gripOverlay) + \"px\",\r\n                            top: (grips[2].y * scale - gripOverlay) + \"px\"\r\n                        });\r\n                    }\r\n                };\r\n            })(i);\r\n        }\r\n    })();\r\n    //top left\r\n    let corner0PointerListener = new BB.PointerListener({\r\n        target: cornerElArr[0],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformLeft(dX);\r\n                transformTop(dY);\r\n                if(keyListener.isPressed('shift')) {\r\n                    transformRight(-dX);\r\n                    transformBottom(-dY);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n    //top right\r\n    let corner1PointerListener = new BB.PointerListener({\r\n        target: cornerElArr[1],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformRight(dX);\r\n                transformTop(dY);\r\n                if(keyListener.isPressed('shift')) {\r\n                    transformLeft(-dX);\r\n                    transformBottom(-dY);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n    //bottom right\r\n    let corner2PointerListener = new BB.PointerListener({\r\n        target: cornerElArr[2],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformRight(dX);\r\n                transformBottom(dY);\r\n                if(keyListener.isPressed('shift')) {\r\n                    transformLeft(-dX);\r\n                    transformTop(-dY);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n    //bottom left\r\n    let corner3PointerListener = new BB.PointerListener({\r\n        target: cornerElArr[3],\r\n        fixScribble: true,\r\n        onPointer: function (event) {\r\n            event.eventPreventDefault();\r\n            if (event.type === 'pointermove' && event.button === 'left') {\r\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\r\n                transformLeft(dX);\r\n                transformBottom(dY);\r\n                if(keyListener.isPressed('shift')) {\r\n                    transformRight(-dX);\r\n                    transformTop(-dY);\r\n                }\r\n                update();\r\n            }\r\n            if (event.type === 'pointerup') {\r\n                commit();\r\n            }\r\n        }\r\n    });\r\n\r\n\r\n\r\n\r\n    function getTransform() {\r\n        grips[1].x -= grips[0].x;\r\n        grips[1].y -= grips[0].y;\r\n        grips[2].x -= grips[0].x;\r\n        grips[2].y -= grips[0].y;\r\n        grips[3].x -= grips[0].x;\r\n        grips[3].y -= grips[0].y;\r\n        x += grips[0].x;\r\n        y += grips[0].y;\r\n        grips[0].x = 0;\r\n        grips[0].y = 0;\r\n        return {\r\n            x: x,\r\n            y: y,\r\n            width: grips[1].x,\r\n            height: grips[2].y\r\n        };\r\n    }\r\n\r\n\r\n    div.append(\r\n        darken[1],\r\n        darken[0],\r\n        darken[2],\r\n        darken[3],\r\n        thirdsHorizontal,\r\n        thirdsVertical,\r\n        outline,\r\n\r\n        edges[1],\r\n        edges[0],\r\n        edges[2],\r\n        edges[3],\r\n\r\n        cornerElArr[0],\r\n        cornerElArr[1],\r\n        cornerElArr[2],\r\n        cornerElArr[3],\r\n    );\r\n\r\n\r\n    function update() {\r\n\r\n        edges[0].update();\r\n        edges[1].update();\r\n        edges[2].update();\r\n        edges[3].update();\r\n        cornerElArr[0].update();\r\n        cornerElArr[1].update();\r\n        cornerElArr[2].update();\r\n        cornerElArr[3].update();\r\n        darken[0].update();\r\n        darken[1].update();\r\n        darken[2].update();\r\n        darken[3].update();\r\n        (outline as any).update();\r\n        (thirdsHorizontal as any).update();\r\n        (thirdsVertical as any).update();\r\n    }\r\n\r\n    update();\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.getTransform = getTransform;\r\n\r\n    this.setTransform = function (p) {\r\n        x = p.x;\r\n        y = p.y;\r\n        width = p.width;\r\n        height = p.height;\r\n\r\n        BB.css(div, {\r\n            left: (x * scale) + \"px\",\r\n            top: (y * scale) + \"px\"\r\n        });\r\n\r\n        grips[0].x = 0;\r\n        grips[0].y = 0;\r\n        grips[1].x = width;\r\n        grips[1].y = 0;\r\n        grips[2].x = width;\r\n        grips[2].y = height;\r\n        grips[3].x = 0;\r\n        grips[3].y = height;\r\n\r\n        update();\r\n        commit();\r\n    };\r\n\r\n    this.setScale = function (s) {\r\n        scale = s;\r\n        BB.css(div, {\r\n            left: (x * scale) + \"px\",\r\n            top: (y * scale) + \"px\"\r\n        });\r\n        update();\r\n    };\r\n\r\n    this.showThirds = function (b) {\r\n        if (b) {\r\n            thirdsHorizontal.style.display = \"block\";\r\n            thirdsVertical.style.display = \"block\";\r\n        } else {\r\n            thirdsHorizontal.style.display = \"none\";\r\n            thirdsVertical.style.display = \"none\";\r\n        }\r\n    };\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.destroy = function() {\r\n        keyListener.destroy();\r\n        outlinePointerListener.destroy();\r\n        corner0PointerListener.destroy();\r\n        corner1PointerListener.destroy();\r\n        corner2PointerListener.destroy();\r\n        corner3PointerListener.destroy();\r\n        edge0PointerListener.destroy();\r\n        edge1PointerListener.destroy();\r\n        edge2PointerListener.destroy();\r\n        edge3PointerListener.destroy();\r\n    };\r\n\r\n}","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport checkImg from 'url:~/src/app/img/ui/check.svg';\r\n// @ts-ignore\r\nimport loadingImg from 'url:~/src/app/img/ui/loading.gif';\r\n\r\nexport function ProgressPopup(p) {\r\n    let div = document.createElement(\"div\");\r\n\r\n    let bg = document.createElement(\"div\");\r\n    let box = document.createElement(\"div\");\r\n    let label = document.createElement(\"div\");\r\n    label.innerHTML = '<img src=\"' + loadingImg + '\"> Uploading...<b>' + 0 + \"%</b>\";\r\n    let button = document.createElement(\"button\");\r\n    button.innerHTML = '<img height=\"17\" src=\"' + checkImg + '\"> Cancel';\r\n    div.appendChild(bg);\r\n    div.appendChild(box);\r\n    box.appendChild(label);\r\n    box.appendChild(button);\r\n    BB.css(button, {\r\n        width: \"100px\",\r\n        position: \"absolute\",\r\n        right: \"20px\",\r\n        bottom: \"20px\"\r\n    });\r\n\r\n    BB.css(div, {\r\n        position: \"absolute\",\r\n        left: '0',\r\n        top: '0',\r\n        width: \"100%\",\r\n        height: \"100%\"\r\n    });\r\n    BB.css(bg, {\r\n        position: \"absolute\",\r\n        left: '0',\r\n        top: '0',\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        background: \"rgba(111,111,111,0.4)\"\r\n    });\r\n    BB.css(box, {\r\n        position: \"absolute\",\r\n        left: \"50%\",\r\n        top: \"45%\",\r\n        padding: \"20px\",\r\n        boxSizing: \"border-box\",\r\n        width: \"300px\",\r\n        height: \"100px\",\r\n        marginLeft: \"-150px\",\r\n        marginTop: \"-50px\",\r\n        background: \"#fff\",\r\n        boxShadow: \"2px 2px 2px rgba(0,0,0,0.5)\",\r\n        borderRadius: \"10px\"\r\n    });\r\n\r\n    button.onclick = function () {\r\n        p.callback();\r\n    };\r\n\r\n    this.update = function (v, done) {\r\n        if (v > -1 && !done) {\r\n            label.innerHTML = '<img src=\"' + loadingImg + '\"> Uploading...<b>' + v + \"%</b>\";\r\n        }\r\n        if (v === 100 && done === true) {\r\n            label.innerHTML = \"<b>Successful Upload</b>\";\r\n            button.innerHTML = '<img height=\"17\" src=\"' + checkImg + '\"> Ok';\r\n            button.focus();\r\n            box.style.background = \"rgb(223, 255, 194)\";\r\n        }\r\n        if (v === -1) {\r\n            label.innerHTML = \"<b>Error: Upload Failed</b>\";\r\n            button.innerHTML = '<img height=\"17\" src=\"' + checkImg + '\"> Ok';\r\n            box.style.background = \"rgb(255, 194, 194)\";\r\n        }\r\n    };\r\n    this.getDiv = function () {\r\n        return div;\r\n    };\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"iGeXe\");","import {BB} from '../../../bb/bb';\r\nimport {klHistory} from '../../history/kl-history';\r\n\r\n/**\r\n * Previews currently active layer\r\n * thumbnail (hover shows bigger preview), layername, opacity\r\n *\r\n * internally listens to kl history. updates when there's a change.\r\n * but you need to update it when the active layer changed. (different canvas object)\r\n *\r\n * update visibility for performance\r\n *\r\n * p = {\r\n *     onClick: function() // when clicking on layer name\r\n *     klRootEl: klRootEl,\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function LayerPreview(p) {\r\n\r\n    // internally redraws with in an interval. checks history is something changed\r\n    // this update will be animated\r\n    // it will not be animated if the resolution changed\r\n    // also redraws when you call updateLayer - not animated\r\n\r\n    // syncs via updateLayer, and internally updates layer opacity via a hack\r\n\r\n    let div = BB.el({});\r\n    let layerObj;\r\n    let isVisible = true;\r\n    const height = 40;\r\n    const canvasSize = height - 10;\r\n    const largeCanvasSize = 300;\r\n    let lastDrawnState = -2;\r\n    let lastDrawnSize = {\r\n        width: 0,\r\n        height: 0\r\n    };\r\n    let animationCanvas = BB.canvas(); // to help animate the transition\r\n    let animationCanvasCtx = animationCanvas.getContext('2d');\r\n    const animationLength = 30;\r\n    let animationCount = 0; // >0 means it's animating\r\n    let largeCanvasIsVisible = false;\r\n    let largeCanvasAnimationTimeout;\r\n    const largeCanvasAnimationDurationMs = 300;\r\n    let uiState = 'right'; // 'left' | 'right'\r\n\r\n\r\n    // --- setup dom ---\r\n    let contentWrapperEl = BB.el({\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            height: height + 'px',\r\n            color: '#666',\r\n        }\r\n    });\r\n    let canvasWrapperEl = BB.el({\r\n        css: {\r\n            //background: '#f00',\r\n            minWidth: height + 'px',\r\n            height: height + 'px',\r\n            display: 'flex',\r\n            justifyContent: 'center',\r\n            alignItems: 'center'\r\n        }\r\n    });\r\n    let canvas = BB.canvas(canvasSize, canvasSize);\r\n    let canvasCtx = canvas.getContext('2d');\r\n    canvas.title = 'Active Layer';\r\n    BB.css(canvas, {\r\n        boxShadow: '0 0 0 1px #9e9e9e',\r\n        colorScheme: 'only light',\r\n    });\r\n    let nameWrapper = BB.el({\r\n        css: {\r\n            //background: '#ff0',\r\n            flexGrow: '1',\r\n            paddingLeft: '10px',\r\n            fontSize: '13px',\r\n            overflow: 'hidden',\r\n            position: 'relative'\r\n        }\r\n    });\r\n    let nameLabelEl = BB.el({\r\n        content: '',\r\n        css: {\r\n            cssFloat: 'left',\r\n            whiteSpace: 'nowrap'\r\n        }\r\n    });\r\n    let nameFadeEl = BB.el({\r\n        css: {\r\n            backgroundImage: 'linear-gradient(to right, rgba(221,221,221,0) 0%, rgba(221,221,221,0.8) 100%)',\r\n            position: 'absolute',\r\n            right: \"0\",\r\n            top: \"0\",\r\n            width: \"50px\",\r\n            height: '100%'\r\n        }\r\n    });\r\n    let clickableEl = BB.el({\r\n        css: {\r\n            //background: 'rgba(0,255,0,0.6)',\r\n            position: 'absolute',\r\n            left: \"10px\",\r\n            top: \"0\",\r\n            width: \"90px\",\r\n            height: '100%'\r\n        }\r\n    });\r\n    if(p.onClick) {\r\n        BB.addEventListener(clickableEl,'click', function() {\r\n            p.onClick();\r\n        });\r\n        BB.addEventListener(canvas,'click', function() {\r\n            p.onClick();\r\n        });\r\n    }\r\n    let opacityEl = BB.el({\r\n        content: 'Opacity<br>100%',\r\n        css: {\r\n            minWidth: '60px',\r\n            fontSize: '12px',\r\n            textAlign: 'center',\r\n            background: '#dddddd',\r\n            color: '#555'\r\n        }\r\n    });\r\n\r\n    const largeCanvasWrapper = BB.el({\r\n        onClick: BB.handleClick,\r\n        css: {\r\n            pointerEvents: 'none',\r\n            background: '#fff',\r\n            position: 'absolute',\r\n            right: '280px',\r\n            top: '10px',\r\n            border: '1px solid #aaa',\r\n            boxShadow: '1px 1px 3px rgba(0,0,0,0.3)',\r\n            transition: 'opacity '+largeCanvasAnimationDurationMs+'ms ease-in-out',\r\n            userSelect: 'none',\r\n            display: 'block',\r\n            webkitTouchCallout: 'none',\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n    let largeCanvas = BB.canvas(largeCanvasSize, largeCanvasSize);\r\n    largeCanvasWrapper.append(largeCanvas);\r\n    let largeCanvasCtx = largeCanvas.getContext('2d');\r\n    BB.css(largeCanvas, {\r\n        display: 'block',\r\n    });\r\n\r\n    div.appendChild(contentWrapperEl);\r\n    contentWrapperEl.appendChild(canvasWrapperEl);\r\n    canvasWrapperEl.appendChild(canvas);\r\n    contentWrapperEl.appendChild(nameWrapper);\r\n    nameWrapper.appendChild(nameLabelEl);\r\n    nameWrapper.appendChild(nameFadeEl);\r\n    nameWrapper.appendChild(clickableEl);\r\n    contentWrapperEl.appendChild(opacityEl);\r\n\r\n\r\n    let animationCanvasCheckerPattern = animationCanvasCtx.createPattern(BB.createCheckerCanvas(4), 'repeat');\r\n    let largeCanvasCheckerPattern = canvasCtx.createPattern(BB.createCheckerCanvas(4), 'repeat');\r\n\r\n\r\n\r\n    // --- update logic ---\r\n\r\n    function animate() {\r\n        if(animationCount === 0) {\r\n            return;\r\n        }\r\n\r\n        animationCount--;\r\n\r\n        canvasCtx.save();\r\n        canvasCtx.globalAlpha = Math.pow((animationLength - animationCount) / animationLength, 2);\r\n        canvasCtx.drawImage(animationCanvas, 0, 0);\r\n        canvasCtx.restore();\r\n\r\n        if(animationCount > 0) {\r\n            requestAnimationFrame(animate);\r\n        }\r\n    }\r\n\r\n    function draw(isInstant) {\r\n\r\n        if(!isVisible) {\r\n            return;\r\n        }\r\n\r\n        nameLabelEl.textContent = layerObj.name;\r\n        opacityEl.innerHTML = 'Opacity<br>' + Math.round(layerObj.opacity * 100) + '%';\r\n\r\n        let layerCanvas = layerObj.context.canvas;\r\n\r\n        if(layerCanvas.width !== lastDrawnSize.width || layerCanvas.height !== lastDrawnSize.height) {\r\n            let canvasDimensions = BB.fitInto(layerCanvas.width, layerCanvas.height, canvasSize, canvasSize, 1);\r\n            canvas.width = Math.round(canvasDimensions.width);\r\n            canvas.height = Math.round(canvasDimensions.height);\r\n\r\n            isInstant = true;\r\n        }\r\n\r\n        animationCanvas.width = canvas.width;\r\n        animationCanvas.height = canvas.height;\r\n\r\n        animationCanvasCtx.save();\r\n        animationCanvasCtx.imageSmoothingEnabled = false;\r\n        animationCanvasCtx.fillStyle = animationCanvasCheckerPattern;\r\n        animationCanvasCtx.fillRect(0, 0, animationCanvas.width, animationCanvas.height);\r\n        animationCanvasCtx.drawImage(layerCanvas, 0, 0, animationCanvas.width, animationCanvas.height);\r\n        animationCanvasCtx.restore();\r\n\r\n        if(isInstant) {\r\n            animationCount = 0;\r\n            canvasCtx.save();\r\n            canvasCtx.drawImage(animationCanvas, 0, 0);\r\n            canvasCtx.restore();\r\n\r\n        } else {\r\n            animationCount = animationLength;\r\n            animate();\r\n\r\n        }\r\n\r\n        drawLargeCanvas();\r\n\r\n        lastDrawnState = klHistory.getState();\r\n        lastDrawnSize.width = layerCanvas.width;\r\n        lastDrawnSize.height = layerCanvas.height;\r\n    }\r\n\r\n    function update() {\r\n        draw(true);\r\n    }\r\n\r\n    setInterval(function() {\r\n\r\n        if(!layerObj) {\r\n            return;\r\n        }\r\n\r\n        let currentState = klHistory.getState();\r\n        if(currentState === lastDrawnState) {\r\n            return;\r\n        }\r\n\r\n        //update opacity w hack\r\n        layerObj.opacity = layerObj.context.canvas.opacity;\r\n\r\n        draw(false);\r\n\r\n    }, 2000);\r\n\r\n\r\n    //is always instant\r\n    function drawLargeCanvas() {\r\n\r\n        if(!largeCanvasIsVisible || !layerObj) {\r\n            return;\r\n        }\r\n\r\n        let layerCanvas = layerObj.context.canvas;\r\n\r\n        let canvasDimensions = BB.fitInto(layerCanvas.width, layerCanvas.height, largeCanvasSize, largeCanvasSize, 1);\r\n        largeCanvas.width = Math.round(canvasDimensions.width);\r\n        largeCanvas.height = Math.round(canvasDimensions.height);\r\n        largeCanvasCtx.save();\r\n        if (largeCanvas.width > layerCanvas.width) {\r\n            largeCanvasCtx.imageSmoothingEnabled = false;\r\n        } else {\r\n            largeCanvasCtx.imageSmoothingEnabled = true;\r\n            largeCanvasCtx.imageSmoothingQuality = 'high';\r\n        }\r\n        largeCanvasCtx.fillStyle = largeCanvasCheckerPattern;\r\n        largeCanvasCtx.fillRect(0, 0, largeCanvas.width, largeCanvas.height);\r\n        largeCanvasCtx.drawImage(layerCanvas, 0, 0, largeCanvas.width, largeCanvas.height);\r\n        largeCanvasCtx.restore();\r\n\r\n        let offset = BB.getPageOffset(div);\r\n        BB.css(largeCanvasWrapper, {\r\n            top: Math.max(10, (offset.y + height / 2 - largeCanvas.height / 2)) + \"px\"\r\n        });\r\n\r\n    }\r\n\r\n    function removeLargeCanvas() {\r\n        try {\r\n            p.klRootEl.removeChild(largeCanvasWrapper);\r\n        } catch(e) {\r\n\r\n        }\r\n    }\r\n\r\n    function showLargeCanvas(b) {\r\n        if (largeCanvasIsVisible === b) {\r\n            return;\r\n        }\r\n\r\n        clearTimeout(largeCanvasAnimationTimeout);\r\n        largeCanvasIsVisible = b;\r\n\r\n        if(b) {\r\n            largeCanvasAnimationTimeout = setTimeout(function() {\r\n                drawLargeCanvas();\r\n                largeCanvasWrapper.style.opacity = '0';\r\n                p.klRootEl.appendChild(largeCanvasWrapper);\r\n                setTimeout(function() {\r\n                    largeCanvasWrapper.style.opacity = '1';\r\n                }, 20);\r\n            }, 250);\r\n\r\n        } else {\r\n            largeCanvasWrapper.style.opacity = '0';\r\n            largeCanvasAnimationTimeout = setTimeout(removeLargeCanvas, largeCanvasAnimationDurationMs + 20);\r\n        }\r\n\r\n    }\r\n\r\n    let pointerListener = new BB.PointerListener({\r\n        target: canvas,\r\n        onEnterLeave: function(b) {\r\n            showLargeCanvas(b);\r\n        }\r\n    });\r\n\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.setIsVisible = function(b) {\r\n        if(isVisible === b) {\r\n            return;\r\n        }\r\n        isVisible = b;\r\n        contentWrapperEl.style.display = isVisible ? 'flex' : 'none';\r\n        div.style.marginBottom = isVisible ? '' : '10px';\r\n\r\n        let currentState = klHistory.getState();\r\n        if(b && lastDrawnState !== currentState) {\r\n            update();\r\n        }\r\n    };\r\n\r\n    //when the layer might have changed\r\n    this.setLayer = function(klCanvasLayerObj) {\r\n        layerObj = klCanvasLayerObj;\r\n        update();\r\n    };\r\n\r\n    this.setUiState = function(stateStr) {\r\n        uiState = '' + stateStr;\r\n\r\n        if (uiState === 'left') {\r\n            BB.css(largeCanvasWrapper, {\r\n                left: '280px',\r\n                right: ''\r\n            });\r\n        } else {\r\n            BB.css(largeCanvasWrapper, {\r\n                left: '',\r\n                right: '280px'\r\n            });\r\n        }\r\n    };\r\n\r\n}","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * fades in a little message that reminds user to save their draw\r\n * goes away by itself. stays a few seconds\r\n */\r\nexport function showSaveReminderToast(remindersShowed) {\r\n    let inner = BB.el({\r\n        content: 'Reminder to save<br>Unsaved work may get lost.'\r\n    });\r\n    let div = BB.el({\r\n        content: inner,\r\n        className: \"reminder-toast g-root\",\r\n        css: {\r\n            opacity: '0',\r\n            top: '-20px'\r\n        }\r\n    });\r\n\r\n    let transitionMs = 300;\r\n    let durationMs = 2500;\r\n\r\n    let mix = Math.min(1, remindersShowed / 5);\r\n    let colA = [0,0,0];\r\n    let colB = [50,0,0];\r\n    let col = [\r\n        Math.round(BB.mix(colA[0], colB[0], mix)),\r\n        Math.round(BB.mix(colA[1], colB[1], mix)),\r\n        Math.round(BB.mix(colA[2], colB[2], mix))\r\n    ];\r\n    inner.style.background = 'rgba(' + col[0] + ',' + col[1] + ',' + col[2] + ', 0.5)';\r\n\r\n    document.body.appendChild(div);\r\n    setTimeout(function() {\r\n        div.style.opacity = '1';\r\n        div.style.top = '10px';\r\n    }, 22);\r\n    setTimeout(function() {\r\n        div.style.opacity = '0';\r\n    }, durationMs + transitionMs);\r\n    setTimeout(function() {\r\n        document.body.removeChild(div);\r\n    }, durationMs + 2 * transitionMs);\r\n}","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * fits image into a size\r\n * params: {\r\n *    image: image,\r\n *    width: int,\r\n *    height: int\r\n * }\r\n *\r\n * methods:\r\n * getDiv()\r\n *\r\n * @param params\r\n * @constructor\r\n */\r\nexport function FittedImage(params) {\r\n    let fit = BB.fitInto(params.image.width, params.image.height, params.width, params.height, 1);\r\n    let w = parseInt('' + fit.width);\r\n    let h = parseInt('' + fit.height);\r\n\r\n    let canvas = BB.canvas();\r\n    canvas.width = w;\r\n    canvas.height = h;\r\n\r\n    canvas.getContext(\"2d\").drawImage(params.image, 0, 0, w, h);\r\n    BB.css(canvas, {\r\n        display: \"block\",\r\n        boxShadow: \"0 0 0 1px #aaa\"\r\n    });\r\n\r\n    this.getElement = function() {\r\n        return canvas;\r\n    };\r\n}","import {BB} from '../../../bb/bb';\r\nimport {FreeTransformCanvas} from '../components/free-transform-canvas';\r\nimport {popup} from './popup';\r\n\r\n/**\r\n * transformObj: {angleDegree: number, translate: {x: number, y: number}, scale: {x: number, y: number}}\r\n *\r\n * @param params object - {target, klCanvas, importImage, callback(transformObj | void, isPixelated: boolean)}\r\n */\r\nexport function showImportAsLayerDialog(params) {\r\n\r\n    let div = document.createElement(\"div\");\r\n    BB.appendTextDiv(div, \"Adjust the position of the imported image.\");\r\n    if(params.klCanvas.isLayerLimitReached()) {\r\n        let noteEl = BB.el({\r\n            content: 'Layer limit reached. Image will be placed on existing layer.',\r\n            css: {\r\n                background: '#ff0',\r\n                padding: '10px',\r\n                marginTop: '5px',\r\n                marginBottom: '5px',\r\n                border: '1px solid #e7d321',\r\n                borderRadius: '5px'\r\n            }\r\n        });\r\n        div.appendChild(noteEl);\r\n    }\r\n    let isSmall = window.innerWidth < 550;\r\n\r\n    let buttonRowEl = BB.el({\r\n        css: {\r\n            display: 'flex'\r\n        }\r\n    });\r\n    let originalSizeBtn = BB.el({\r\n        tagName: 'button',\r\n        content: '1:1',\r\n        css: {\r\n            marginRight: '10px'\r\n        },\r\n        onClick: function() {\r\n            freeTransformCanvas.reset();\r\n        }\r\n    });\r\n    let fitSizeBtn = BB.el({\r\n        tagName: 'button',\r\n        content: 'Fit',\r\n        css: {\r\n            marginRight: '10px'\r\n        },\r\n        onClick: function() {\r\n            freeTransformCanvas.setTransformFit();\r\n        }\r\n    });\r\n    let centerBtn = BB.el({\r\n        tagName: 'button',\r\n        content: 'Center',\r\n        css: {\r\n            marginRight: '10px'\r\n        },\r\n        onClick: function() {\r\n            freeTransformCanvas.setTransformCenter();\r\n        }\r\n    });\r\n    buttonRowEl.appendChild(originalSizeBtn);\r\n    buttonRowEl.appendChild(fitSizeBtn);\r\n    buttonRowEl.appendChild(centerBtn);\r\n    div.appendChild(buttonRowEl);\r\n\r\n\r\n\r\n    let layerArr = [];\r\n    {\r\n        let klCanvasLayerArr = params.klCanvas.getLayers();\r\n        for(let i = 0; i < klCanvasLayerArr.length; i++) {\r\n            layerArr.push({\r\n                canvas: klCanvasLayerArr[i].context.canvas,\r\n                opacity: klCanvasLayerArr[i].opacity,\r\n                mixModeStr: klCanvasLayerArr[i].mixModeStr\r\n            });\r\n        }\r\n    }\r\n    layerArr.push({\r\n        canvas: params.importImage,\r\n        opacity: 1,\r\n        mixModeStr: 'source-over'\r\n    });\r\n\r\n\r\n    let freeTransformCanvas = new FreeTransformCanvas({\r\n        elementWidth: isSmall ? 340 : 540,\r\n        elementHeight: isSmall ? 280 : 350,\r\n        imageWidth: params.klCanvas.getLayerContext(0).canvas.width,\r\n        imageHeight: params.klCanvas.getLayerContext(0).canvas.height,\r\n        layerArr: layerArr,\r\n        transformIndex: layerArr.length - 1,\r\n    });\r\n    BB.css(freeTransformCanvas.getElement(), {\r\n        marginTop: '10px',\r\n        marginLeft: '-20px',\r\n    });\r\n    div.appendChild(freeTransformCanvas.getElement());\r\n\r\n    function move(x, y) {\r\n        freeTransformCanvas.move(x, y);\r\n    }\r\n\r\n    let keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr) {\r\n            if (keyStr === 'left') {\r\n                move(-1, 0);\r\n            }\r\n            if (keyStr === 'right') {\r\n                move(1, 0);\r\n            }\r\n            if (keyStr === 'up') {\r\n                move(0, -1);\r\n            }\r\n            if (keyStr === 'down') {\r\n                move(0, 1);\r\n            }\r\n        }\r\n    });\r\n\r\n    popup({\r\n        target: params.target,\r\n        message: \"<b>Import Image as New Layer</b>\",\r\n        div: div,\r\n        style: isSmall ? {} : {\r\n            width: '500px'\r\n        },\r\n        buttons: [\"Ok\", \"Cancel\"],\r\n        clickOnEnter: 'Ok',\r\n        callback: function(buttonStr) {\r\n            keyListener.destroy();\r\n            freeTransformCanvas.destroy();\r\n            BB.destroyEl(originalSizeBtn);\r\n            BB.destroyEl(fitSizeBtn);\r\n            BB.destroyEl(centerBtn);\r\n            if(buttonStr === 'Ok') {\r\n                params.callback(freeTransformCanvas.getTransformation(), freeTransformCanvas.getIsPixelated());\r\n            } else {\r\n                params.callback();\r\n            }\r\n        }\r\n    });\r\n\r\n}","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * Not really generalized. UI when you drag/drop an image into window.\r\n * The moment you create it, it will listen.\r\n *\r\n * @param p object {onDrop: func(files, optionStr), target: DOM Element, enabledTest: func -> bool} - optionStr: 'default'|'layer'|'image'\r\n * @constructor\r\n */\r\nexport function PcImageDropper(p) {\r\n\r\n    //set up DOM\r\n    let rootEl = BB.el({\r\n        content: 'Drop to import',\r\n        css: {\r\n            paddingTop: '100px',\r\n            position: 'fixed',\r\n            left: '0',\r\n            top: '0',\r\n            width: '100%',\r\n            height: '100%',\r\n            background: 'rgba(50, 50, 50, 0.7)',\r\n            color: '#fff',\r\n            textShadow: '2px 2px #000',\r\n            textAlign: 'center',\r\n            fontSize: '25px'\r\n        }\r\n    });\r\n    let wrapperEl = BB.el({\r\n        css: {\r\n            'marginTop': '50px',\r\n            'display': 'flex',\r\n            'justifyContent': 'center'\r\n        }\r\n    });\r\n    let optionStyle = {\r\n        width: '200px',\r\n        padding: '50px',\r\n        margin: '10px',\r\n        //opacity: 0.5,\r\n        borderRadius: '20px',\r\n        border: '1px dashed #fff',\r\n        background: '#00aefe',\r\n        fontWeight: 'bold'\r\n    };\r\n    let optionLayerEl = BB.el({\r\n        content: 'As Layer',\r\n        css: optionStyle\r\n    });\r\n    let optionImageEl = BB.el({\r\n        content: 'As New Image',\r\n        css: optionStyle\r\n    });\r\n\r\n    rootEl.appendChild(wrapperEl);\r\n    wrapperEl.appendChild(optionLayerEl);\r\n    wrapperEl.appendChild(optionImageEl);\r\n\r\n\r\n    let rootCounter = 0;\r\n    let optionLayerCounter = 0;\r\n    let optionImageCounter = 0;\r\n\r\n    function destroy() {\r\n        rootCounter = 0;\r\n        optionLayerCounter = 0;\r\n        optionImageCounter = 0;\r\n        try {\r\n            p.target.removeChild(rootEl);\r\n        } catch (e) { }\r\n    }\r\n\r\n    function testAcceptType(event) {\r\n        try {\r\n            return !event.dataTransfer.types.includes('text/plain');\r\n        } catch(e) {\r\n\r\n        }\r\n        return false;\r\n    }\r\n\r\n    function updateOptions() {\r\n        let boxShadow = '0 0 20px 4px #fff';\r\n        if(optionLayerCounter > 0) {\r\n            optionLayerEl.style.boxShadow = boxShadow;\r\n            optionImageEl.style.boxShadow = '';\r\n        } else if(optionImageCounter > 0) {\r\n            optionLayerEl.style.boxShadow = '';\r\n            optionImageEl.style.boxShadow = boxShadow;\r\n        } else {\r\n            optionLayerEl.style.boxShadow = '';\r\n            optionImageEl.style.boxShadow = '';\r\n        }\r\n    }\r\n\r\n    BB.addEventListener(optionLayerEl,'dragenter', function() {\r\n        optionLayerCounter++;\r\n        updateOptions();\r\n    });\r\n    BB.addEventListener(optionLayerEl,'dragleave', function() {\r\n        optionLayerCounter--;\r\n        updateOptions();\r\n    });\r\n    BB.addEventListener(optionImageEl,'dragenter', function() {\r\n        optionImageCounter++;\r\n        updateOptions();\r\n    });\r\n    BB.addEventListener(optionImageEl,'dragleave', function() {\r\n        optionImageCounter--;\r\n        updateOptions();\r\n    });\r\n\r\n\r\n    function rootDragOver(event) {\r\n        if(!testAcceptType(event)) {\r\n            return;\r\n        }\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n    }\r\n    function rootDragEnter(event) {\r\n        if(!p.enabledTest() || !testAcceptType(event)) {\r\n            return;\r\n        }\r\n        if(rootCounter === 0) {\r\n            p.target.appendChild(rootEl);\r\n        }\r\n        rootCounter++;\r\n\r\n    }\r\n    function rootDragLeave(event) {\r\n        if(!testAcceptType(event) || rootCounter === 0) {\r\n            return;\r\n        }\r\n        rootCounter = Math.max(0, rootCounter - 1);\r\n        if(rootCounter === 0) {\r\n            p.target.removeChild(rootEl);\r\n        }\r\n\r\n    }\r\n    function rootDrop(event) {\r\n        if(!testAcceptType(event) || event.dataTransfer.files.length === 0) {\r\n            destroy();\r\n            return;\r\n        }\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n\r\n        let optionStr = 'default';\r\n        if(optionLayerCounter > 0) {\r\n            optionStr = 'layer';\r\n        } else if(optionImageCounter > 0) {\r\n            optionStr = 'image';\r\n        }\r\n\r\n        p.onDrop(event.dataTransfer.files, optionStr);\r\n\r\n\r\n        if(rootCounter > 0) {\r\n            p.target.removeChild(rootEl);\r\n        }\r\n        rootCounter = 0;\r\n        optionLayerCounter = 0;\r\n        optionImageCounter = 0;\r\n        updateOptions();\r\n    }\r\n\r\n    BB.addEventListener(window,'dragover', rootDragOver, false);\r\n    BB.addEventListener(window,'dragenter', rootDragEnter, false);\r\n    BB.addEventListener(window,'dragleave', rootDragLeave, false);\r\n    BB.addEventListener(window,'drop', rootDrop, false);\r\n\r\n    // if something goes wrong and you're stuck with overlay\r\n    BB.addEventListener(rootEl, 'pointerdown', function() {\r\n        destroy();\r\n    });\r\n    let keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr) {\r\n            if (rootCounter > 0 && keyStr === 'esc') {\r\n                destroy();\r\n            }\r\n        }\r\n    });\r\n\r\n}","import {BB} from '../../../bb/bb';\r\nimport {PcSmallColorSlider} from '../base-components/color-slider-small';\r\nimport {PcSlider} from '../base-components/slider';\r\nimport {HexColorDialog} from '../modals/color-slider-hex-dialog';\r\n\r\n/**\r\n * Compressed HUD toolspace. When you hold ctrl+alt.\r\n * small color picker. in future more ui elements (brushsize, opacity)\r\n *\r\n * p = {\r\n *     brushSettingService: BB.BrushSettingService, // to sync with outside\r\n *     enabledTest: func(): bool, // calls to see if it's allowed to show\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function OverlayToolspace(p) {\r\n\r\n    let sizeObj = {\r\n        width: 150,\r\n        svHeight: 90,\r\n        hHeight: 20,\r\n        sliderHeight: 25\r\n    }\r\n\r\n    let isEnabled = true;\r\n    let isVisible = false;\r\n    let div = BB.el({\r\n        css: {\r\n            position: 'absolute',\r\n            left: '500px',\r\n            top: '500px',\r\n            //width: '500px',\r\n            //height: '500px',\r\n            background: 'rgb(221, 221, 221)',\r\n            display: 'none',\r\n            border: '1px solid #fff',\r\n            boxShadow: '0 0 10px rgba(0,0,0,0.5)',\r\n            colorScheme: 'only light',\r\n        }\r\n    });\r\n    let queuedObj = {\r\n        color: null,\r\n        size: null,\r\n        opacity: null\r\n    };\r\n\r\n\r\n    // --- inputs ---\r\n\r\n    //color selection\r\n    let colorSlider = new PcSmallColorSlider({\r\n        width: sizeObj.width,\r\n        heightSV: sizeObj.svHeight,\r\n        heightH: sizeObj.hHeight,\r\n        color: p.brushSettingService.getColor(),\r\n        callback: function (rgbObj) {\r\n            selectedColorEl.style.backgroundColor = \"rgb(\" + rgbObj.r + \",\" + rgbObj.g + \",\" + rgbObj.b + \")\";\r\n            p.brushSettingService.setColor(rgbObj, subscriptionFunc);\r\n        }\r\n    });\r\n    let selectedColorEl = BB.el({\r\n        css: {\r\n            width: sizeObj.width + 'px',\r\n            height: sizeObj.hHeight + 'px',\r\n            pointerEvents: 'none'\r\n        }\r\n    });\r\n    {\r\n        let initialColor = p.brushSettingService.getColor();\r\n        selectedColorEl.style.backgroundColor = \"rgb(\" + initialColor.r + \",\" + initialColor.g + \",\" + initialColor.b + \")\";\r\n    }\r\n\r\n    div.appendChild(selectedColorEl);\r\n    div.appendChild(colorSlider.getElement());\r\n\r\n\r\n    function updateColor(rgbObj) {\r\n        colorSlider.setColor(rgbObj);\r\n        selectedColorEl.style.backgroundColor = \"rgb(\" + rgbObj.r + \",\" + rgbObj.g + \",\" + rgbObj.b + \")\";\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    //brushsize slider\r\n\r\n    let sizeSlider = new PcSlider({\r\n        label: 'Size',\r\n        width: sizeObj.width,\r\n        height: sizeObj.sliderHeight,\r\n        min: 0,\r\n        max: 500,\r\n        initValue: 50,\r\n        resolution: 225,\r\n        eventResMs: 1000 / 30,\r\n        onChange: function(v) {\r\n            p.brushSettingService.setSize(v);\r\n        },\r\n        formatFunc: function(v) {\r\n            if(v * 2 < 10) {\r\n                return Math.round(v * 2 * 10) / 10;\r\n            }\r\n            return Math.round(v * 2);\r\n        }\r\n    });\r\n    BB.css(sizeSlider.getElement(), {\r\n        marginTop: '2px'\r\n    });\r\n    div.appendChild(sizeSlider.getElement());\r\n\r\n    let opacitySlider = new PcSlider({\r\n        label: 'Opacity',\r\n        width: sizeObj.width,\r\n        height: sizeObj.sliderHeight,\r\n        min: 0,\r\n        max: 1,\r\n        initValue: 1,\r\n        resolution: 225,\r\n        eventResMs: 1000 / 30,\r\n        onChange: function(v) {\r\n            p.brushSettingService.setOpacity(v);\r\n        },\r\n        formatFunc: function(v) {\r\n            return Math.round(v * 100);\r\n        }\r\n    });\r\n    BB.css(opacitySlider.getElement(), {\r\n        margin: '2px 0'\r\n    });\r\n    div.appendChild(opacitySlider.getElement());\r\n\r\n\r\n\r\n    // --- general setup ---\r\n\r\n    let subscriptionFunc = function(event) {\r\n        if(event.type === 'color') {\r\n            if(!isVisible) {\r\n                queuedObj.color = event.value;\r\n            } else {\r\n                updateColor(event.value);\r\n            }\r\n        }\r\n        if(event.type === 'size') {\r\n            if(!isVisible) {\r\n                queuedObj.size = event.value;\r\n            } else {\r\n                sizeSlider.setValue(event.value);\r\n            }\r\n        }\r\n        if(event.type === 'opacity') {\r\n            if(!isVisible) {\r\n                queuedObj.opacity = event.value;\r\n            } else {\r\n                opacitySlider.setValue(event.value);\r\n            }\r\n        }\r\n        if(event.type === 'sliderConfig') {\r\n            sizeSlider.update(event.value.sizeSlider);\r\n            opacitySlider.update(event.value.opacitySlider);\r\n        }\r\n    };\r\n    p.brushSettingService.subscribe(subscriptionFunc);\r\n    {\r\n        let sliderConfig = p.brushSettingService.getSliderConfig();\r\n        sizeSlider.update(sliderConfig.sizeSlider);\r\n        opacitySlider.update(sliderConfig.opacitySlider);\r\n        sizeSlider.setValue(p.brushSettingService.getSize());\r\n        opacitySlider.setValue(p.brushSettingService.getOpacity());\r\n    }\r\n\r\n    function updateUI() {\r\n        div.style.display = isVisible ? 'block' : 'none';\r\n        if(isVisible && mousePos) {\r\n            div.style.left = (mousePos.x - Math.round(sizeObj.width / 2)) + 'px';\r\n            div.style.top = (mousePos.y - Math.round(sizeObj.svHeight + sizeObj.hHeight * 3 / 2)) + 'px';\r\n        }\r\n    }\r\n\r\n    let mousePos = null;\r\n    BB.addEventListener(document, 'pointermove', function(event) {\r\n        mousePos = {\r\n            x: event.pageX,\r\n            y: event.pageY,\r\n        };\r\n    });\r\n\r\n    let keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, event, comboStr, isRepeat) {\r\n            if(isRepeat) {\r\n                return;\r\n            }\r\n            if(isVisible) {\r\n                isVisible = false;\r\n                updateUI();\r\n                return;\r\n            }\r\n\r\n            if(!p.enabledTest() || !mousePos) {\r\n                return;\r\n            }\r\n\r\n            if(['ctrl+alt', 'cmd+alt', 'alt+ctrl', 'alt+cmd'].includes(comboStr)) {\r\n                event.preventDefault();\r\n                isVisible = true;\r\n\r\n                if(queuedObj.color !== null) {\r\n                    updateColor(queuedObj.color);\r\n                    queuedObj.color = null;\r\n                }\r\n                if(queuedObj.size !== null) {\r\n                    sizeSlider.setValue(queuedObj.size);\r\n                    queuedObj.size = null;\r\n                }\r\n                if(queuedObj.opacity !== null) {\r\n                    opacitySlider.setValue(queuedObj.opacity);\r\n                    queuedObj.opacity = null;\r\n                }\r\n\r\n                updateUI();\r\n            }\r\n\r\n        },\r\n        onUp: function(keyStr, event, oldComboStr) {\r\n            if(['ctrl+alt', 'cmd+alt', 'alt+ctrl', 'alt+cmd'].includes(oldComboStr) && isVisible) {\r\n                isVisible = false;\r\n                colorSlider.end();\r\n                updateUI();\r\n            }\r\n        },\r\n        onBlur: function() {\r\n            if(isVisible) {\r\n                isVisible = false;\r\n                colorSlider.end();\r\n                updateUI();\r\n            }\r\n        }\r\n    });\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n}","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport klecksLogoImg from 'url:~/src/app/img/klecks-logo.png';\r\n// @ts-ignore\r\nimport newImageImg from 'url:~/src/app/img/ui/new-image.svg';\r\n// @ts-ignore\r\nimport importImg from 'url:~/src/app/img/ui/import.svg';\r\n// @ts-ignore\r\nimport exportImg from 'url:~/src/app/img/ui/export.svg';\r\n// @ts-ignore\r\nimport shareImg from 'url:~/src/app/img/ui/share.svg';\r\n// @ts-ignore\r\nimport helpImg from 'url:~/src/app/img/ui/help.svg';\r\n\r\n\r\n/**\r\n * Topmost row of buttons in toolspace (with the app logo)\r\n *\r\n * p = { // button click callbacks\r\n *      logoImg: img,\r\n *     onLogo: function(),\r\n *     onNew: function(),\r\n *     onImport: function(),\r\n *     onSave: function(),\r\n *     onShare: function(),\r\n *     onHelp: function()\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function ToolspaceTopRow(p) {\r\n    let div = document.createElement('div');\r\n    BB.css(div, {\r\n        height: '36px',\r\n        //background: '#f00',\r\n        display: 'flex',\r\n        backgroundImage: 'linear-gradient(to top, rgba(255, 255, 255, 0) 20%, rgba(255, 255, 255, 0.6) 100%)'\r\n    });\r\n\r\n    function createButton(p) {\r\n        let padding = 6 + (p.extraPadding ? p.extraPadding : 0);\r\n        let result = BB.el({\r\n            className: 'toolspace-row-button nohighlight',\r\n            title: p.title,\r\n            onClick: p.onClick,\r\n            css: {\r\n                padding: p.contain ? padding + 'px 0' : ''\r\n            }\r\n        });\r\n        let im = BB.el({\r\n            css: {\r\n                backgroundImage: 'url(\\'' + p.image + '\\')',\r\n                backgroundRepeat: 'no-repeat',\r\n                backgroundPosition: 'center',\r\n                backgroundSize: p.contain ? 'contain' : '',\r\n                //filter: 'grayscale(1)',\r\n                height: '100%'\r\n            }\r\n        });\r\n        im.style.pointerEvents = 'none';\r\n        result.appendChild(im);\r\n        (result as any).pointerListener = new BB.PointerListener({ // because :hover causes problems w touch\r\n            target: result,\r\n            onEnterLeave: function(isOver) {\r\n                if(isOver) {\r\n                    BB.addClassName(result, 'toolspace-row-button-hover');\r\n                } else {\r\n                    BB.removeClassName(result, 'toolspace-row-button-hover');\r\n                }\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n\r\n    let logoButton = createButton({\r\n        onClick: p.onLogo,\r\n        title: 'Intro / Gallery / About',\r\n        image: p.logoImg ? p.logoImg : klecksLogoImg,\r\n        contain: true\r\n    });\r\n    logoButton.style.width = '45px';\r\n    logoButton.style.borderRight = '1px solid rgb(212, 212, 212)';\r\n    let newButton = createButton({\r\n        onClick: p.onNew,\r\n        title: 'New Image',\r\n        image: newImageImg,\r\n        extraPadding: 1,\r\n        contain: true\r\n    });\r\n    let importButton = createButton({\r\n        onClick: p.onImport,\r\n        title: 'Import Image',\r\n        image: importImg,\r\n        extraPadding: 1,\r\n        contain: true\r\n    });\r\n    let saveButton = createButton({\r\n        onClick: p.onSave,\r\n        title: 'Save Image',\r\n        image: exportImg,\r\n        extraPadding: 1,\r\n        contain: true\r\n    });\r\n\r\n    let shareButton = null;\r\n    if(BB.canShareFiles()) {\r\n        shareButton = createButton({\r\n            onClick: p.onShare,\r\n            title: 'Share',\r\n            image: shareImg,\r\n            contain: true\r\n        });\r\n    }\r\n    let helpButton = createButton({\r\n        onClick: p.onHelp,\r\n        title: 'Help',\r\n        image: helpImg,\r\n        contain: true\r\n    });\r\n\r\n    div.appendChild(logoButton);\r\n    div.appendChild(newButton);\r\n    div.appendChild(importButton);\r\n    div.appendChild(saveButton);\r\n    if(shareButton) {\r\n        div.appendChild(shareButton);\r\n    }\r\n    div.appendChild(helpButton);\r\n\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    }\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"eHdqz\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"3x5dR\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"hbDTd\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"16iGk\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"2ME3z\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"hZnSk\");","import {BB} from '../../../bb/bb';\r\nimport {dialogCounter} from '../modals/modal-count';\r\n// @ts-ignore\r\nimport toolPaintImg from 'url:~/src/app/img/ui/tool-paint.png';\r\n// @ts-ignore\r\nimport toolFillImg from 'url:~/src/app/img/ui/tool-fill.svg';\r\n// @ts-ignore\r\nimport toolTextImg from 'url:~/src/app/img/ui/tool-text.svg';\r\n// @ts-ignore\r\nimport toolShapeImg from 'url:~/src/app/img/ui/tool-shape.svg';\r\n// @ts-ignore\r\nimport caretDownImg from 'url:~/src/app/img/ui/caret-down.svg';\r\n\r\n/**\r\n * Toolrow Dropdown. The button where you select: brush, fill, select, transform, etc.\r\n *\r\n * p = {\r\n *     onChange: func(activeStr)\r\n * }\r\n *\r\n * activeStr = 'draw' | 'fill' | 'text'\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function ToolDropdown(p) {\r\n\r\n    let optionArr = ['draw', 'fill', 'text', 'shape'];\r\n    let imArr = [\r\n        toolPaintImg,\r\n        toolFillImg,\r\n        toolTextImg,\r\n        toolShapeImg\r\n    ];\r\n    let titleArr = ['Brush [B]', 'Paint Bucket [G]', 'Text [T]', 'Shape [U]'];\r\n    let currentActiveIndex = 0;\r\n    let isActive = true;\r\n    let isOpen = false;\r\n\r\n    //preload images\r\n    setTimeout(function() {\r\n        for(let i = 1; i < imArr.length; i++) {\r\n            let im = new Image();\r\n            im.src = imArr[i];\r\n        }\r\n    }, 100);\r\n\r\n    let smallMargin = '6px 0';\r\n    let div = BB.el({\r\n        css: {\r\n            position: 'relative',\r\n            flexGrow: '1'\r\n        }\r\n    });\r\n\r\n    let openTimeout;\r\n    let isDragging = false;\r\n    let startX, startY;\r\n    let pointerListener;\r\n    if (BB.hasPointerEvents) {\r\n        pointerListener = new BB.PointerListener({\r\n            target: div,\r\n            maxPointers: 1,\r\n            onPointer: function(event) {\r\n                if (event.type === 'pointerdown') {\r\n                    if (isOpen) {\r\n                        return;\r\n                    }\r\n\r\n                    openTimeout = setTimeout(function() {\r\n                        showDropdown();\r\n                    }, 400);\r\n                    isDragging = true;\r\n                    startX = event.pageX;\r\n                    startY = event.pageY;\r\n\r\n                } else if (event.type === 'pointermove') {\r\n                    if (isDragging && !isOpen && BB.dist(startX, startY, event.pageX, event.pageY) > 5) {\r\n                        clearTimeout(openTimeout);\r\n                        showDropdown();\r\n                    }\r\n\r\n                } else if (event.type === 'pointerup') {\r\n                    clearTimeout(openTimeout);\r\n                    if (isOpen && isDragging) {\r\n                        let target = document.elementFromPoint(event.pageX, event.pageY);\r\n                        for (let i = 0; i < dropdownBtnArr.length; i++) {\r\n                            if (target === dropdownBtnArr[i].wrapper) {\r\n                                closeDropdown();\r\n                                isActive = true;\r\n                                currentActiveIndex = i;\r\n                                updateImage();\r\n                                p.onChange(optionArr[currentActiveIndex]);\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                    isDragging = false;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    let activeButton = BB.el({\r\n        parent: div,\r\n        className: 'toolspace-row-button nohighlight toolspace-row-button-activated',\r\n        title: titleArr[currentActiveIndex],\r\n        onClick: function(e) {\r\n            if (isActive && !isOpen) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                showDropdown();\r\n                return;\r\n            }\r\n\r\n            isActive = true;\r\n            p.onChange(optionArr[currentActiveIndex]);\r\n            if (isOpen) {\r\n                closeDropdown();\r\n            }\r\n        },\r\n        css: {\r\n            padding: '10px 0',\r\n            pointerEvents: 'auto',\r\n            height: '100%',\r\n            boxSizing: 'border-box'\r\n        }\r\n    });\r\n\r\n    let activeButtonIm = BB.el({\r\n        parent: activeButton,\r\n        css: {\r\n            backgroundRepeat: 'no-repeat',\r\n            backgroundPosition: 'center',\r\n            backgroundSize: 'contain',\r\n            width: 'calc(100% - 7px)',\r\n            height: '100%',\r\n            pointerEvents: 'none',\r\n            opacity: '0.75',\r\n        }\r\n    });\r\n\r\n    let arrowButton = BB.el({\r\n        parent: activeButton,\r\n        css: {\r\n            position: 'absolute',\r\n            right: '1px',\r\n            bottom: '1px',\r\n            width: '18px',\r\n            height: '18px',\r\n            //background: '#aaa',\r\n            //borderRadius: '2px',\r\n            cursor: 'pointer',\r\n\r\n            backgroundImage: 'url(\\'' + caretDownImg + '\\')',\r\n            backgroundRepeat: 'no-repeat',\r\n            backgroundPosition: 'center',\r\n            backgroundSize: '60%'\r\n        },\r\n        title: 'More Tools',\r\n        onClick: function(e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            showDropdown();\r\n        }\r\n    });\r\n\r\n\r\n    let overlay = BB.el({\r\n        css: {\r\n            position: 'absolute',\r\n            //background: 'rgba(255,0,0,0.5)'\r\n            left: '0',\r\n            top: '0',\r\n            right: '0',\r\n            bottom: '0'\r\n        }\r\n    });\r\n    let overlayPointerListener = new BB.PointerListener({\r\n        target: overlay,\r\n        pointers: 1,\r\n        onPointer: function(e) {\r\n            if (e.type === 'pointerdown') {\r\n                e.eventPreventDefault();\r\n                closeDropdown();\r\n            }\r\n        }\r\n    });\r\n\r\n    let dropdownWrapper = BB.el({\r\n        className: 'tool-dropdown-wrapper',\r\n        css: {\r\n            position: 'absolute',\r\n            width: '100%',\r\n            height: (100 * (optionArr.length - 1)) + '%',\r\n            top: '100%',\r\n            left: '0',\r\n            zIndex: '1',\r\n            boxSizing: 'border-box',\r\n            cursor: 'pointer',\r\n            transition: 'height 0.1s ease-in-out, opacity 0.1s ease-in-out'\r\n        }\r\n    });\r\n\r\n    let dropdownBtnArr = [];\r\n\r\n    function createDropdownButton(p) {\r\n        let result = {};\r\n\r\n        let wrapper = BB.el({\r\n            parent: dropdownWrapper,\r\n            className: 'tool-dropdown-button',\r\n            title: p.title,\r\n            css: {\r\n                padding: '10px 0',\r\n                height: (100 / (optionArr.length - 1)) + '%',\r\n                boxSizing: 'border-box'\r\n            },\r\n            onClick: function(e) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                p.onClick(p.index, p.id);\r\n            }\r\n        });\r\n        (result as any).wrapper = wrapper;\r\n        let im = BB.el({\r\n            parent: wrapper,\r\n            css: {\r\n                backgroundImage: 'url(\\'' + p.image + '\\')',\r\n                backgroundRepeat: 'no-repeat',\r\n                backgroundPosition: 'center',\r\n                backgroundSize: 'contain',\r\n                height: '100%',\r\n                pointerEvents: 'none',\r\n                opacity: '0.75'\r\n            }\r\n        });\r\n\r\n        // --- interface ---\r\n        (result as any).show = function(b) {\r\n            wrapper.style.display = b ? 'block' : 'none';\r\n        };\r\n\r\n        (result as any).setIsSmall = function(b) {\r\n            wrapper.style.padding = b ? smallMargin : '10px 0';\r\n        };\r\n\r\n        return result;\r\n    }\r\n\r\n    function onClickDropdownBtn(index, id) {\r\n        closeDropdown();\r\n\r\n        isActive = true;\r\n        currentActiveIndex = index;\r\n        activeButton.title = titleArr[currentActiveIndex];\r\n\r\n        updateImage();\r\n\r\n        p.onChange(optionArr[currentActiveIndex]);\r\n    }\r\n\r\n    for (let i = 0; i < optionArr.length; i++) {\r\n        dropdownBtnArr.push(createDropdownButton({\r\n            index: i,\r\n            id: optionArr[i],\r\n            image: imArr[i],\r\n            title: titleArr[i],\r\n            onClick: onClickDropdownBtn\r\n        }));\r\n    }\r\n\r\n    function showDropdown() {\r\n        dialogCounter.count++;\r\n        isOpen = true;\r\n\r\n        for (let i = 0; i < optionArr.length; i++) {\r\n            dropdownBtnArr[i].show(currentActiveIndex !== i);\r\n        }\r\n\r\n        arrowButton.style.display = 'none';\r\n        div.style.zIndex = '1';\r\n        document.body.appendChild(overlay);\r\n        div.appendChild(dropdownWrapper);\r\n    }\r\n\r\n    function closeDropdown() {\r\n        dialogCounter.count--;\r\n        isOpen = false;\r\n        arrowButton.style.removeProperty('display');\r\n        div.style.removeProperty('z-index');\r\n        document.body.removeChild(overlay);\r\n\r\n        div.removeChild(dropdownWrapper);\r\n    }\r\n\r\n    function updateImage() {\r\n        activeButtonIm.style.backgroundImage = 'url(\\'' + imArr[currentActiveIndex] + '\\')';\r\n    }\r\n    updateImage();\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.setIsSmall = function(b) {\r\n        activeButton.style.padding = b ? smallMargin : '10px 0';\r\n        for (let i = 0; i < optionArr.length; i++) {\r\n            dropdownBtnArr[i].setIsSmall(b);\r\n        }\r\n        if (b) {\r\n            arrowButton.style.width = '14px';\r\n            arrowButton.style.height = '14px';\r\n        } else {\r\n            arrowButton.style.width = '18px';\r\n            arrowButton.style.height = '18px';\r\n        }\r\n    };\r\n\r\n    this.setActive = function(activeStr) {\r\n        if (optionArr.includes(activeStr)) {\r\n            isActive = true;\r\n            for (let i = 0; i < optionArr.length; i++) {\r\n                if (optionArr[i] === activeStr) {\r\n                    currentActiveIndex = i;\r\n                    break;\r\n                }\r\n            }\r\n            BB.addClassName(activeButton, 'toolspace-row-button-activated');\r\n            updateImage();\r\n        } else {\r\n            isActive = false;\r\n            BB.removeClassName(activeButton, 'toolspace-row-button-activated');\r\n        }\r\n    };\r\n\r\n    this.getActive = function() {\r\n        return optionArr[currentActiveIndex];\r\n    };\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"jArAq\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"hS5Hj\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"doX4v\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"7NqHO\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"dz3mY\");","import {BB} from '../../../bb/bb';\r\nimport {ToolDropdown} from './tool-dropdown';\r\n// @ts-ignore\r\nimport toolMoveImg from 'url:~/src/app/img/ui/tool-move.svg';\r\n// @ts-ignore\r\nimport toolZoomInImg from 'url:~/src/app/img/ui/tool-zoom-in.svg';\r\n// @ts-ignore\r\nimport toolZoomOutImg from 'url:~/src/app/img/ui/tool-zoom-out.svg';\r\n// @ts-ignore\r\nimport toolUndoImg from 'url:~/src/app/img/ui/tool-undo.svg';\r\n\r\n\r\n/**\r\n * Row of buttons in toolspace. image-operations (draw, hand), zoom, undo/redo\r\n * Need to do syncing. So tool is correct, and zoom/undo/redo buttons are properly enabled/disabled\r\n * heights: 54px tall, 36px small -> via setIsSmall\r\n *\r\n * p = {\r\n *     onActivate: function(activeStr), // clicking on tool button - activating it\r\n *     onZoomIn: function(),\r\n *     onZoomOut: function(),\r\n *     onUndo: function(),\r\n *     onRedo: function(),\r\n * }\r\n *\r\n * activeStr = 'draw' | 'hand' | 'fill' | 'text'\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function ToolspaceToolRow(p) {\r\n    let div = document.createElement('div');\r\n    BB.css(div, {\r\n        height: '54px',\r\n        //height: '36px',\r\n        display: 'flex',\r\n        backgroundImage: 'linear-gradient(to top, rgba(255, 255, 255, 0) 20%, rgba(255, 255, 255, 0.6) 100%)'\r\n    });\r\n\r\n    let currentActiveStr = 'draw'; // 'draw' | 'hand' | 'fill'\r\n    let zoomInIsEnabled = true;\r\n    let zoomInOutEnabled = true;\r\n    let undoIsEnabled = false;\r\n    let redoIsEnabled = false;\r\n\r\n    function setActive(activeStr, doEmit?) {\r\n        if(currentActiveStr === activeStr) {\r\n            return;\r\n        }\r\n\r\n        currentActiveStr = activeStr;\r\n\r\n        toolDropdown.setActive(currentActiveStr);\r\n        if(currentActiveStr === 'hand') {\r\n            BB.addClassName(handButton, 'toolspace-row-button-activated');\r\n        } else {\r\n            BB.removeClassName(handButton, 'toolspace-row-button-activated');\r\n        }\r\n\r\n        if(doEmit) {\r\n            p.onActivate(currentActiveStr);\r\n        }\r\n    }\r\n\r\n    function createButton(p) {\r\n\r\n        let smallMargin = p.doLighten ? '6px 0' : '8px 0';\r\n\r\n        let result = BB.el({\r\n            className: 'toolspace-row-button nohighlight',\r\n            //title: p.title,\r\n            onClick: p.onClick,\r\n            css: {\r\n                padding: p.contain ? '10px 0' : ''\r\n            }\r\n        });\r\n        let im = BB.el({\r\n            css: {\r\n                backgroundImage: 'url(\\'' + p.image + '\\')',\r\n                backgroundRepeat: 'no-repeat',\r\n                backgroundPosition: 'center',\r\n                backgroundSize: p.contain ? 'contain' : '',\r\n                //filter: 'grayscale(1)',\r\n                height: '100%',\r\n                transform: p.doMirror ? 'scale(-1, 1)' : '',\r\n                pointerEvents: 'none',\r\n                opacity: p.doLighten ? '0.75' : '1'\r\n            }\r\n        });\r\n        result.appendChild(im);\r\n        (result as any).pointerListener = new BB.PointerListener({ // because :hover causes problems w touch\r\n            target: result,\r\n            onEnterLeave: function(isOver) {\r\n                if(isOver) {\r\n                    BB.addClassName(result, 'toolspace-row-button-hover');\r\n                } else {\r\n                    BB.removeClassName(result, 'toolspace-row-button-hover');\r\n                }\r\n            }\r\n        });\r\n        (result as any).setIsSmall = function(b) {\r\n            result.style.padding = p.contain ? (b ? smallMargin : '10px 0') : '';\r\n        }\r\n        return result;\r\n    }\r\n\r\n\r\n    function createTriangleButton(p) { // because IE and Edge don't support clip path\r\n\r\n        let result = document.createElement('div');\r\n        BB.css(result, {\r\n            flexGrow: '1',\r\n            position: 'relative'\r\n        });\r\n\r\n        let svg = BB.createSvg({\r\n            elementType: 'svg',\r\n            width: '67px', // can't think of a way doing with percentage\r\n            height: '54px',\r\n            viewBox: '0 0 100 100',\r\n            preserveAspectRatio: 'none'\r\n        });\r\n        BB.css(svg, {\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0'\r\n        });\r\n\r\n        let blurRadius = 10;\r\n        let blurOffsetX = 2;\r\n        let blurOffsetY = 2;\r\n\r\n        let defs = BB.createSvg( { // inset shadow via svg\r\n            elementType: 'defs',\r\n            childrenArr: [\r\n                {\r\n                    elementType: 'filter',\r\n                    id: 'innershadow',\r\n                    x0: '-50%',\r\n                    y0: '-50%',\r\n                    width: '200%',\r\n                    height: '200%',\r\n                    childrenArr: [\r\n                        {\r\n                            elementType: 'feGaussianBlur',\r\n                            in: 'SourceAlpha',\r\n                            stdDeviation: '' + blurRadius,\r\n                            result: 'blur'\r\n                        }, {\r\n                            elementType: 'feOffset',\r\n                            dx: '' + blurOffsetX,\r\n                            dy: '' + blurOffsetY\r\n                        }, {\r\n                            elementType: 'feComposite',\r\n                            in2: 'SourceAlpha',\r\n                            operator: 'arithmetic',\r\n                            k2: '-1',\r\n                            k3: '1',\r\n                            result: 'shadowDiff'\r\n                        },\r\n\r\n                        {\r\n                            elementType: 'feFlood',\r\n                            'flood-color': '#000',\r\n                            'flood-opacity': '0.2'\r\n                        }, {\r\n                            elementType: 'feComposite',\r\n                            in2: 'shadowDiff',\r\n                            operator: 'in'\r\n                        }, {\r\n                            elementType: 'feComposite',\r\n                            in2: 'SourceGraphic',\r\n                            operator: 'over',\r\n                            result: 'firstfilter'\r\n                        },\r\n\r\n                        {\r\n                            elementType: 'feGaussianBlur',\r\n                            in: 'firstfilter',\r\n                            stdDeviation: '' + blurRadius,\r\n                            result: 'blur2'\r\n                        }, {\r\n                            elementType: 'feOffset',\r\n                            dx: '' + blurOffsetX,\r\n                            dy: '' + blurOffsetY\r\n                        }, {\r\n                            elementType: 'feComposite',\r\n                            in2: 'firstfilter',\r\n                            operator: 'arithmetic',\r\n                            k2: '-1',\r\n                            k3: '1',\r\n                            result: 'shadowDiff'\r\n                        },\r\n\r\n                        {\r\n                            elementType: 'feFlood',\r\n                            'flood-color': '#000',\r\n                            'flood-opacity': '0.2'\r\n                        }, {\r\n                            elementType: 'feComposite',\r\n                            in2: 'shadowDiff',\r\n                            operator: 'in'\r\n                        }, {\r\n                            elementType: 'feComposite',\r\n                            in2: 'firstfilter',\r\n                            operator: 'over'\r\n                        }\r\n                    ]\r\n                }\r\n            ]\r\n        });\r\n\r\n\r\n        let svgTriangleLeft = BB.createSvg({\r\n            elementType: 'path',\r\n            'vector-effect': 'non-scaling-stroke',\r\n            d: 'M0,0 L 100,0 0,100 z',\r\n            fill: 'rgba(0,0,0,0)',\r\n            class: 'toolspace-svg-triangle-button'\r\n        });\r\n        svgTriangleLeft.onclick = function() {\r\n            p.onLeft();\r\n            BB.removeClassName(svgTriangleLeft, 'toolspace-svg-triangle-button-hover');\r\n        };\r\n\r\n        let svgTriangleRight = BB.createSvg({\r\n            elementType: 'path',\r\n            'vector-effect': 'non-scaling-stroke',\r\n            d: 'M100,100 L 100,0 0,100 z',\r\n            fill: 'rgba(0,0,0,0)',\r\n            class: 'toolspace-svg-triangle-button'\r\n        });\r\n        svgTriangleRight.onclick = function() {\r\n            p.onRight();\r\n            BB.removeClassName(svgTriangleRight, 'toolspace-svg-triangle-button-hover');\r\n        };\r\n\r\n        // because :hover causes problems w touch\r\n        (result as any).leftPointerListener = new BB.PointerListener({\r\n            target: svgTriangleLeft,\r\n            onEnterLeave: function(isOver) {\r\n                if(isOver) {\r\n                    BB.addClassName(svgTriangleLeft, 'toolspace-svg-triangle-button-hover');\r\n                } else {\r\n                    BB.removeClassName(svgTriangleLeft, 'toolspace-svg-triangle-button-hover');\r\n                }\r\n            }\r\n        });\r\n        (result as any).rightPointerListener = new BB.PointerListener({\r\n            target: svgTriangleRight,\r\n            onEnterLeave: function(isOver) {\r\n                if(isOver) {\r\n                    BB.addClassName(svgTriangleRight, 'toolspace-svg-triangle-button-hover');\r\n                } else {\r\n                    BB.removeClassName(svgTriangleRight, 'toolspace-svg-triangle-button-hover');\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n        svg.appendChild(defs);\r\n        svg.appendChild(svgTriangleLeft);\r\n        svg.appendChild(svgTriangleRight);\r\n        result.appendChild(svg);\r\n\r\n\r\n        let leftIm = BB.el({\r\n            css: {\r\n                backgroundImage: 'url(\\'' + p.leftImage + '\\')',\r\n                backgroundRepeat: 'no-repeat',\r\n                backgroundSize: 'contain',\r\n                width: '20px',\r\n                height: '20px',\r\n                position: 'absolute',\r\n                left: '10px',\r\n                top: '8px',\r\n                //transform: p.doMirror ? 'scale(-1, 1)' : '',\r\n                pointerEvents: 'none'\r\n            }\r\n        });\r\n        result.appendChild(leftIm);\r\n\r\n\r\n        let rightIm = BB.el({\r\n            css: {\r\n                backgroundImage: 'url(\\'' + (p.rightImage ? p.rightImage : p.leftImage) + '\\')',\r\n                backgroundRepeat: 'no-repeat',\r\n                backgroundSize: 'contain',\r\n                width: '20px',\r\n                height: '20px',\r\n                position: 'absolute',\r\n                right: '10px',\r\n                bottom: '8px',\r\n                transform: p.rightImage ? '' : 'scale(-1, 1)',\r\n                pointerEvents: 'none'\r\n            }\r\n        });\r\n        result.appendChild(rightIm);\r\n\r\n\r\n\r\n\r\n\r\n        (result as any).setIsEnabledLeft = function(b) {\r\n            if(b) {\r\n                BB.removeClassName(svgTriangleLeft, 'toolspace-row-button-disabled');\r\n                BB.removeClassName(leftIm, 'toolspace-row-button-disabled');\r\n            } else {\r\n                BB.addClassName(svgTriangleLeft, 'toolspace-row-button-disabled');\r\n                BB.addClassName(leftIm, 'toolspace-row-button-disabled');\r\n            }\r\n        };\r\n        (result as any).setIsEnabledRight = function(b) {\r\n            if(b) {\r\n                BB.removeClassName(svgTriangleRight, 'toolspace-row-button-disabled');\r\n                BB.removeClassName(rightIm, 'toolspace-row-button-disabled');\r\n            } else {\r\n                BB.addClassName(svgTriangleRight, 'toolspace-row-button-disabled');\r\n                BB.addClassName(rightIm, 'toolspace-row-button-disabled');\r\n            }\r\n        };\r\n\r\n        return result;\r\n    }\r\n\r\n    function createTriangleButtonViaClipPath(p) {\r\n        let result = document.createElement('div');\r\n        BB.css(result, {\r\n            flexGrow: '1',\r\n            position: 'relative'\r\n        });\r\n\r\n\r\n        let leftButton = BB.el({\r\n            className: 'toolspace-triangle-button',\r\n            onClick: p.onLeft,\r\n            css: {\r\n                clipPath: 'polygon(0% 0%, 100% 0%, 100% 0%, 0% 100%)'\r\n            }\r\n        });\r\n\r\n        let leftIm = BB.el({\r\n            css: {\r\n                backgroundImage: 'url(\\'' + p.leftImage + '\\')',\r\n                backgroundRepeat: 'no-repeat',\r\n                backgroundSize: 'contain',\r\n                width: '20px',\r\n                height: '20px',\r\n                position: 'absolute',\r\n                left: '10px',\r\n                top: '8px',\r\n                //transform: p.doMirror ? 'scale(-1, 1)' : '',\r\n                pointerEvents: 'none'\r\n            }\r\n        });\r\n        leftButton.appendChild(leftIm);\r\n\r\n\r\n\r\n        let rightButton = BB.el({\r\n            className: 'toolspace-triangle-button',\r\n            onClick: p.onRight,\r\n            css: {\r\n                clipPath: 'polygon(0% 100%, 100% 0%, 100% 100%, 0% 100%)'\r\n            }\r\n        });\r\n\r\n        let rightIm = BB.el({\r\n            css: {\r\n                backgroundImage: 'url(\\'' + (p.rightImage ? p.rightImage : p.leftImage) + '\\')',\r\n                backgroundRepeat: 'no-repeat',\r\n                backgroundSize: 'contain',\r\n                width: '20px',\r\n                height: '20px',\r\n                position: 'absolute',\r\n                right: '10px',\r\n                bottom: '8px',\r\n                transform: p.rightImage ? '' : 'scale(-1, 1)',\r\n                pointerEvents: 'none'\r\n            }\r\n        });\r\n        rightButton.appendChild(rightIm);\r\n\r\n\r\n\r\n        result.appendChild(leftButton);\r\n        result.appendChild(rightButton);\r\n\r\n\r\n        // because :hover causes problems w touch\r\n        (result as any).leftPointerListener = new BB.PointerListener({\r\n            target: leftButton,\r\n            onEnterLeave: function(isOver) {\r\n                if(isOver) {\r\n                    BB.addClassName(leftButton, 'toolspace-row-button-hover');\r\n                } else {\r\n                    BB.removeClassName(leftButton, 'toolspace-row-button-hover');\r\n                }\r\n            }\r\n        });\r\n        (result as any).rightPointerListener = new BB.PointerListener({\r\n            target: rightButton,\r\n            onEnterLeave: function(isOver) {\r\n                if(isOver) {\r\n                    BB.addClassName(rightButton, 'toolspace-row-button-hover');\r\n                } else {\r\n                    BB.removeClassName(rightButton, 'toolspace-row-button-hover');\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n\r\n        (result as any).setIsEnabledLeft = function(b) {\r\n            if(b) {\r\n                BB.removeClassName(leftButton, 'toolspace-row-button-disabled');\r\n            } else {\r\n                BB.addClassName(leftButton, 'toolspace-row-button-disabled');\r\n            }\r\n        };\r\n        (result as any).setIsEnabledRight = function(b) {\r\n            if(b) {\r\n                BB.removeClassName(rightButton, 'toolspace-row-button-disabled');\r\n            } else {\r\n                BB.addClassName(rightButton, 'toolspace-row-button-disabled');\r\n            }\r\n        };\r\n        return result;\r\n    }\r\n\r\n    /*let brushButton = createButton({\r\n        onClick: function() {\r\n            setActive('draw', true);\r\n        },\r\n        image: 'app/img/ui/paint.png',\r\n        contain: true,\r\n        doLighten: true\r\n    });\r\n    BB.addClassName(brushButton, 'toolspace-row-button-activated');\r\n    div.appendChild(brushButton);*/\r\n\r\n    let toolDropdown = new ToolDropdown({\r\n        onChange: function(activeStr) {\r\n            setActive(activeStr, true);\r\n        }\r\n    });\r\n    div.appendChild(toolDropdown.getElement());\r\n\r\n    let handButton = createButton({\r\n        onClick: function() {\r\n            setActive('hand', true);\r\n        },\r\n        image: toolMoveImg,\r\n        contain: true,\r\n        doLighten: true\r\n    });\r\n    handButton.style.borderRight = '1px solid rgb(212, 212, 212)';\r\n    handButton.title = 'Hand Tool';\r\n    div.appendChild(handButton);\r\n\r\n    let zoomInNOutButton = createTriangleButton({\r\n        onLeft: p.onZoomIn,\r\n        onRight: p.onZoomOut,\r\n        leftImage: toolZoomInImg,\r\n        rightImage: toolZoomOutImg,\r\n    });\r\n    zoomInNOutButton.title = 'Zoom';\r\n    div.appendChild(zoomInNOutButton);\r\n\r\n    let zoomInButton = createButton({\r\n        onClick: p.onZoomIn,\r\n        image: toolZoomInImg,\r\n        contain: true\r\n    });\r\n    zoomInButton.title = 'Zoom In';\r\n    div.appendChild(zoomInButton);\r\n\r\n    let zoomOutButton = createButton({\r\n        onClick: p.onZoomOut,\r\n        image: toolZoomOutImg,\r\n        contain: true\r\n    });\r\n    zoomOutButton.title = 'Zoom Out';\r\n    div.appendChild(zoomOutButton);\r\n\r\n    let undoNRedoButton = createTriangleButton({\r\n        onLeft: p.onUndo,\r\n        onRight: p.onRedo,\r\n        leftImage: toolUndoImg,\r\n        rightImage: null,\r\n    });\r\n    undoNRedoButton.title = 'Undo/Redo';\r\n    (undoNRedoButton as any).setIsEnabledLeft(false);\r\n    (undoNRedoButton as any).setIsEnabledRight(false);\r\n    div.appendChild(undoNRedoButton);\r\n\r\n    let undoButton = createButton({\r\n        onClick: p.onUndo,\r\n        image: toolUndoImg,\r\n        contain: true\r\n    });\r\n    undoButton.title = 'Undo';\r\n    BB.addClassName(undoButton, 'toolspace-row-button-disabled');\r\n    div.appendChild(undoButton);\r\n\r\n    let redoButton = createButton({\r\n        onClick: p.onRedo,\r\n        image: toolUndoImg,\r\n        contain: true,\r\n        doMirror: true\r\n    });\r\n    redoButton.title = 'Redo';\r\n    BB.addClassName(redoButton, 'toolspace-row-button-disabled');\r\n    div.appendChild(redoButton);\r\n\r\n    zoomInButton.style.display = 'none';\r\n    zoomOutButton.style.display = 'none';\r\n    undoButton.style.display = 'none';\r\n    redoButton.style.display = 'none';\r\n\r\n\r\n\r\n\r\n\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n    this.setIsSmall = function(b) {\r\n        BB.css(div, {\r\n            height: b ? '36px' : '54px'\r\n        });\r\n\r\n        toolDropdown.setIsSmall(b);\r\n        (handButton as any).setIsSmall(b);\r\n        (zoomInButton as any).setIsSmall(b);\r\n        (zoomOutButton as any).setIsSmall(b);\r\n        (undoButton as any).setIsSmall(b);\r\n        (redoButton as any).setIsSmall(b);\r\n\r\n        if(b) {\r\n            zoomInNOutButton.style.display = 'none';\r\n            undoNRedoButton.style.display = 'none';\r\n            zoomInButton.style.display = 'block';\r\n            zoomOutButton.style.display = 'block';\r\n            undoButton.style.display = 'block';\r\n            redoButton.style.display = 'block';\r\n        } else {\r\n            zoomInNOutButton.style.display = 'block';\r\n            undoNRedoButton.style.display = 'block';\r\n            zoomInButton.style.display = 'none';\r\n            zoomOutButton.style.display = 'none';\r\n            undoButton.style.display = 'none';\r\n            redoButton.style.display = 'none';\r\n        }\r\n\r\n    };\r\n\r\n    this.setEnableZoomIn = function(b) {\r\n        if(b) {\r\n            BB.removeClassName(zoomInButton, 'toolspace-row-button-disabled');\r\n        } else {\r\n            BB.addClassName(zoomInButton, 'toolspace-row-button-disabled');\r\n        }\r\n        (zoomInNOutButton as any).setIsEnabledLeft(b);\r\n    };\r\n    this.setEnableZoomOut = function(b) {\r\n        if(b) {\r\n            BB.removeClassName(zoomOutButton, 'toolspace-row-button-disabled');\r\n        } else {\r\n            BB.addClassName(zoomOutButton, 'toolspace-row-button-disabled');\r\n        }\r\n        (zoomInNOutButton as any).setIsEnabledRight(b);\r\n    };\r\n    this.setEnableUndo = function(b) {\r\n        if(b) {\r\n            BB.removeClassName(undoButton, 'toolspace-row-button-disabled');\r\n        } else {\r\n            BB.addClassName(undoButton, 'toolspace-row-button-disabled');\r\n        }\r\n        (undoNRedoButton as any).setIsEnabledLeft(b);\r\n    };\r\n    this.setEnableRedo = function(b) {\r\n        if(b) {\r\n            BB.removeClassName(redoButton, 'toolspace-row-button-disabled');\r\n        } else {\r\n            BB.addClassName(redoButton, 'toolspace-row-button-disabled');\r\n        }\r\n        (undoNRedoButton as any).setIsEnabledRight(b);\r\n    };\r\n    this.setActive = function(activeStr) {\r\n        setActive(activeStr);\r\n    };\r\n    this.getActive = function() {\r\n        return currentActiveStr;\r\n    };\r\n\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"ldMMs\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"04ZZm\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"j9xio\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"AnO0a\");","import {BB} from '../../../bb/bb';\r\nimport {Select} from '../base-components/select';\r\n\r\n/**\r\n * Ui to select stabilizer level. 4 options. returned as 0-3\r\n *\r\n * p = {\r\n *     smoothing: number, // initial level 0-3\r\n *     onSelect: function(level number) // 0-3, when level changes\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function ToolspaceStabilizerRow(p) {\r\n\r\n    let div = BB.el({\r\n        tagName: 'label',\r\n        content: 'Stabilizer&nbsp;',\r\n        title: 'Line Stabilizer',\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            fontSize: '13px',\r\n            color: 'rgba(0,0,0,0.6)'\r\n        }\r\n    });\r\n\r\n    let strengthSelect = new Select({\r\n        optionArr: [\r\n            [0, '0'],\r\n            [1, '1'],\r\n            [2, '2'],\r\n            [3, '3'],\r\n            [4, '4'],\r\n            [5, '5']\r\n        ],\r\n        initValue: p.smoothing,\r\n        onChange: function(val) {\r\n            p.onSelect(val);\r\n        }\r\n    });\r\n    div.appendChild(strengthSelect.getElement());\r\n\r\n    let pointerListener = new BB.PointerListener({\r\n        target: div,\r\n        onWheel: function(e) {\r\n            strengthSelect.setDeltaValue(e.deltaY);\r\n        }\r\n    });\r\n\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n}","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * row of tabs. uses css class .tabrow-tab\r\n *\r\n * p = {\r\n *     initialId: string, // e.g. 'draw'\r\n *     useAccent: boolean,\r\n *     tabArr: [\r\n *         {\r\n *             id: string, // e.g. 'draw',\r\n *             label: string, // optional\r\n *             image: string, // optional background image\r\n *             title: string, // optional\r\n *             isVisible: boolean, // optional - default is true\r\n *             onOpen: function(),\r\n *             onClose: function()\r\n *         }\r\n *     ]\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function TabRow(p) {\r\n    let _this = this;\r\n    let height = 35;\r\n    let div = BB.el({\r\n        className: 'tabrow',\r\n        css: {\r\n            height: height + 'px'\r\n        }\r\n    });\r\n\r\n    let tabArr = []; //creates its own internal arr\r\n    let openedTabObj = null;\r\n\r\n    function createTab(pTabObj, initialId, useAccent) {\r\n        let result = {\r\n            id: pTabObj.id,\r\n            isVisible: 'isVisible' in pTabObj ? pTabObj.isVisible : true,\r\n            onOpen: pTabObj.onOpen,\r\n            onClose: pTabObj.onClose,\r\n            update: function(openedTabObj) {\r\n                tabDiv.className = openedTabObj === result ? (useAccent ? 'tabrow-tab tabrow-tab-opened-accented' : 'tabrow-tab tabrow-tab-opened') : 'tabrow-tab';\r\n                tabDiv.style.display = result.isVisible ? 'block' : 'none';\r\n            }\r\n        };\r\n        let tabDiv = BB.el({\r\n            content: 'label' in pTabObj ? pTabObj.label : '',\r\n            title: 'title' in pTabObj ? pTabObj.title : undefined,\r\n            className: initialId === result.id ? (useAccent ? 'tabrow-tab tabrow-tab-opened-accented' : 'tabrow-tab tabrow-tab-opened') : 'tabrow-tab',\r\n            css: {\r\n                lineHeight: height + 'px',\r\n                display: result.isVisible ? 'block' : 'none'\r\n            },\r\n            onClick: function() {\r\n                if (openedTabObj === result) {\r\n                    return;\r\n                }\r\n                _this.open(result.id);\r\n            }\r\n        });\r\n        if ('image' in pTabObj) {\r\n            BB.css(tabDiv, {\r\n                backgroundImage: 'url(\\'' + pTabObj.image + '\\')',\r\n                backgroundSize: (height - 7) + 'px'\r\n            });\r\n        }\r\n        div.appendChild(tabDiv);\r\n\r\n        let pointerListener = new BB.PointerListener({ // because :hover causes problems w touch\r\n            target: tabDiv,\r\n            onEnterLeave: function(isOver) {\r\n                if(isOver) {\r\n                    BB.addClassName(tabDiv, 'tabrow-tab-hover');\r\n                } else {\r\n                    BB.removeClassName(tabDiv, 'tabrow-tab-hover');\r\n                }\r\n            }\r\n        });\r\n\r\n        if(initialId === result.id) {\r\n            result.onOpen();\r\n        } else {\r\n            result.onClose();\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    for(let i = 0; i < p.tabArr.length; i++) {\r\n        tabArr.push(createTab(p.tabArr[i], p.initialId, p.useAccent));\r\n    }\r\n\r\n    for(let i = 0; i < tabArr.length; i++) {\r\n        if (tabArr[i].id === p.initialId) {\r\n            openedTabObj = tabArr[i];\r\n        }\r\n    }\r\n    if(openedTabObj === null) {\r\n        throw 'invalid initialId';\r\n    }\r\n\r\n    function update() {\r\n        for(let i = 0; i < tabArr.length; i++) {\r\n            tabArr[i].update(openedTabObj);\r\n        }\r\n    }\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.open = function(tabId) {\r\n        for(let i = 0; i < tabArr.length; i++) {\r\n            if(tabArr[i].id === tabId) {\r\n                if(openedTabObj === tabArr[i]) { // already open\r\n                    return;\r\n                }\r\n                openedTabObj.onClose();\r\n                openedTabObj = tabArr[i];\r\n                openedTabObj.onOpen();\r\n                update();\r\n                return;\r\n            }\r\n        }\r\n        throw 'TabRow.open - invalid tabId';\r\n    };\r\n\r\n    this.getOpenedTabId = function() {\r\n        return '' + openedTabObj.id;\r\n    };\r\n\r\n    this.setIsVisible = function(tabId, isVisible) {\r\n        for(let i = 0; i < tabArr.length; i++) {\r\n            if(tabArr[i].id === tabId) {\r\n                tabArr[i].isVisible = !!isVisible;\r\n                update();\r\n                return;\r\n            }\r\n        }\r\n        throw 'TabRow.setIsVisible - invalid tabId';\r\n    };\r\n}","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport angleImg from 'url:~/src/app/img/ui/angle.svg';\r\n// @ts-ignore\r\nimport rotateImg from 'url:~/src/app/img/ui/edit-rotate.svg';\r\n\r\n/**\r\n * Ui, when hand tool tab is open.\r\n *\r\n * p = {\r\n *     scale: number, // initial value\r\n *     angleDeg: number, // initial value\r\n *     onReset: function(),\r\n *     onFit: function(),\r\n *     onAngleChange: function(angleDeg number, isRelative number)\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function HandUi(p) {\r\n    let div = BB.el({\r\n        css: {\r\n            margin: '10px'\r\n        }\r\n    });\r\n    let isVisible = true;\r\n    let scale = p.scale;\r\n    let angleDeg = p.angleDeg;\r\n\r\n    let row1 = BB.el({\r\n        css: {\r\n            marginBottom: '10px',\r\n            display: 'flex'\r\n        }\r\n    });\r\n    div.appendChild(row1);\r\n    let row2 = BB.el({\r\n        css: {\r\n            display: 'flex'\r\n        }\r\n    });\r\n    div.appendChild(row2);\r\n\r\n\r\n    let scaleEl = BB.el({\r\n        css: {\r\n            width: '55px',\r\n            userSelect: 'none'\r\n        }\r\n    });\r\n    row1.appendChild(scaleEl);\r\n\r\n    let angleIm = new Image();\r\n    angleIm.src = angleImg;\r\n    BB.css(angleIm, {\r\n        verticalAlign: 'bottom',\r\n        width: '20px',\r\n        height: '20px',\r\n        marginRight: '5px',\r\n        borderRadius: '10px',\r\n        background: 'rgba(0,0,0,0.2)',\r\n        userSelect: 'none'\r\n    });\r\n    row1.appendChild(angleIm);\r\n\r\n    let angleEl = BB.el({\r\n        css: {\r\n            userSelect: 'none'\r\n        }\r\n    });\r\n    row1.appendChild(angleEl);\r\n\r\n\r\n    function update() {\r\n        scaleEl.innerHTML = Math.round(scale * 100) + '%';\r\n        angleEl.innerHTML =  Math.round(angleDeg) + '°';\r\n\r\n\r\n        angleIm.style.transform = 'rotate(' + angleDeg + 'deg)';\r\n        if(angleDeg % 90 === 0) {\r\n            angleIm.style.boxShadow = 'inset 0 0 0 1px rgba(255,255,255, 1), 0 0 0 1px rgba(0, 0, 0, 0.3)';\r\n        } else {\r\n            angleIm.style.boxShadow = '';\r\n        }\r\n    }\r\n    update();\r\n\r\n\r\n    let resetButton = BB.el({\r\n        tagName: 'button',\r\n        content: 'Reset',\r\n        onClick: p.onReset\r\n    });\r\n    BB.makeUnfocusable(resetButton);\r\n    row2.appendChild(resetButton);\r\n\r\n    let fitButton = BB.el({\r\n        tagName: 'button',\r\n        content: 'Fit',\r\n        css: {\r\n            marginLeft: '10px'\r\n        },\r\n        onClick: p.onFit\r\n    });\r\n    BB.makeUnfocusable(fitButton);\r\n    row2.appendChild(fitButton);\r\n\r\n    row2.appendChild(BB.el({css: {flexGrow: '1'}}));\r\n\r\n    let leftRotateButton = BB.el({\r\n        tagName: 'button',\r\n        content: '<img height=\"20\" src=\"' + rotateImg + '\" alt=\"Rotate\" style=\"transform: scale(-1, 1)\"/>',\r\n        css: {\r\n            marginLeft: '10px'\r\n        },\r\n        onClick: function() {\r\n            p.onAngleChange(-15, true);\r\n        }\r\n    });\r\n    BB.makeUnfocusable(leftRotateButton);\r\n    row2.appendChild(leftRotateButton);\r\n\r\n    let resetAngleButton = BB.el({\r\n        tagName: 'button',\r\n        content: '0°',\r\n        css: {\r\n            marginLeft: '10px'\r\n        },\r\n        onClick: function() {\r\n            p.onAngleChange(0);\r\n        }\r\n    });\r\n    BB.makeUnfocusable(resetAngleButton);\r\n    row2.appendChild(resetAngleButton);\r\n\r\n    let rightRotateButton = BB.el({\r\n        tagName: 'button',\r\n        content: '<img height=\"20\" src=\"' + rotateImg + '\" alt=\"Rotate\"/>',\r\n        css: {\r\n            marginLeft: '10px'\r\n        },\r\n        onClick: function() {\r\n            p.onAngleChange(15, true);\r\n        }\r\n    });\r\n    BB.makeUnfocusable(rightRotateButton);\r\n    row2.appendChild(rightRotateButton);\r\n\r\n\r\n\r\n    // --- interface ---\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n    this.setIsVisible = function(pIsVisible) {\r\n        isVisible = !!pIsVisible;\r\n        div.style.display = isVisible ? 'block' : 'none';\r\n        if(isVisible) {\r\n            update();\r\n        }\r\n    };\r\n    this.update = function(pScale, pAngleDeg) {\r\n        scale = pScale;\r\n        angleDeg = pAngleDeg;\r\n        if(isVisible) {\r\n            update();\r\n        }\r\n    };\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"6toXQ\");","import {BB} from '../../../bb/bb';\r\nimport {PcSlider} from '../base-components/slider';\r\nimport {Select} from '../base-components/select';\r\nimport {Checkbox} from '../base-components/checkbox';\r\n\r\n/**\r\n * Paint Bucket tab contents (color slider, opacity slider, etc)\r\n *\r\n * p = {\r\n *     colorSlider: PcColorSlider// when opening tab, inserts it (snatches it from where else it was)\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function FillUi(p) {\r\n    let div = BB.el({\r\n        css: {\r\n            margin: '10px'\r\n        }\r\n    });\r\n    let isVisible = true;\r\n\r\n    let colorDiv = BB.el({\r\n        parent: div,\r\n        css: {\r\n            marginBottom: '10px'\r\n        }\r\n    });\r\n\r\n    let opacitySlider = new PcSlider({\r\n        label: 'Opacity',\r\n        width: 250,\r\n        height: 30,\r\n        min: 0,\r\n        max: 1,\r\n        initValue: 1,\r\n        onChange: function (val) {\r\n        },\r\n        formatFunc: function(v) {\r\n            return Math.round(v * 100);\r\n        }\r\n    });\r\n    div.appendChild(opacitySlider.getElement());\r\n\r\n    let toleranceSlider = new PcSlider({\r\n        label: 'Tolerance',\r\n        width: 250,\r\n        height: 30,\r\n        min: 0,\r\n        max: 255,\r\n        initValue: 255 / 100 * 20,\r\n        onChange: function (val) {\r\n        },\r\n        formatFunc: function(v) {\r\n            return Math.round(v / 255 * 100);\r\n        }\r\n    });\r\n    BB.css(toleranceSlider.getElement(), {\r\n        marginTop: '10px'\r\n    });\r\n    div.appendChild(toleranceSlider.getElement());\r\n\r\n    let selectRow = BB.el({\r\n        parent: div,\r\n        css: {\r\n            display: 'flex',\r\n            marginTop: '10px'\r\n        }\r\n    });\r\n\r\n    let modeWrapper;\r\n    let modeSelect;\r\n    modeWrapper = BB.el({\r\n        content: 'Sample&nbsp;',\r\n        title: 'Which layers to sample color from',\r\n        css: {\r\n            fontSize: '15px'\r\n        }\r\n    });\r\n    modeSelect = new Select({\r\n        optionArr: [\r\n            ['all', 'All'],\r\n            ['current', 'Active'],\r\n            ['above', 'Above']\r\n        ],\r\n        initValue: 'all',\r\n        onChange: function(val) {}\r\n    });\r\n    let modePointerListener = new BB.PointerListener({\r\n        target: modeSelect.getElement(),\r\n        onWheel: function(e) {\r\n            modeSelect.setDeltaValue(e.deltaY);\r\n        }\r\n    });\r\n    modeWrapper.appendChild(modeSelect.getElement());\r\n    selectRow.appendChild(modeWrapper);\r\n\r\n    let growWrapper;\r\n    let growSelect;\r\n    growWrapper = BB.el({\r\n        content: 'Grow&nbsp;',\r\n        title: 'Grow filled area (in pixels)',\r\n        css: {\r\n            fontSize: '15px',\r\n            marginLeft: '10px'\r\n        }\r\n    });\r\n    growSelect = new Select({\r\n        optionArr: [\r\n            ['0', '0'],\r\n            ['1', '1'],\r\n            ['2', '2'],\r\n            ['3', '3'],\r\n            ['4', '4'],\r\n            ['5', '5'],\r\n            ['6', '6'],\r\n            ['7', '7'],\r\n        ],\r\n        initValue: '0',\r\n        onChange: function(val) {}\r\n    });\r\n    let growPointerListener = new BB.PointerListener({\r\n        target: growSelect.getElement(),\r\n        onWheel: function(e) {\r\n            growSelect.setDeltaValue(e.deltaY);\r\n        }\r\n    });\r\n    growWrapper.appendChild(growSelect.getElement());\r\n    selectRow.appendChild(growWrapper);\r\n\r\n\r\n    let isContiguous = true;\r\n    let contiguousToggle = new Checkbox({\r\n        init: true,\r\n        label: 'Contiguous',\r\n        title: 'Only fill connected areas',\r\n        callback: function (b) {\r\n            isContiguous = b;\r\n        },\r\n        css: {\r\n            marginTop: '10px',\r\n            paddingRight: '5px',\r\n            display: 'inline-block',\r\n        }\r\n    });\r\n    div.appendChild(contiguousToggle.getElement());\r\n\r\n\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.setIsVisible = function(pIsVisible) {\r\n        isVisible = !!pIsVisible;\r\n        div.style.display = isVisible ? 'block' : 'none';\r\n        if(isVisible) {\r\n            colorDiv.appendChild(p.colorSlider.getElement());\r\n            colorDiv.appendChild(p.colorSlider.getOutputElement());\r\n        }\r\n    };\r\n\r\n    this.getTolerance = function() {\r\n        return toleranceSlider.getValue();\r\n    };\r\n\r\n    this.getOpacity = function() {\r\n        return opacitySlider.getValue();\r\n    };\r\n\r\n    /**\r\n     * returns string 'current' | 'all' | 'above'\r\n     */\r\n    this.getSample = function() {\r\n        return modeSelect.getValue();\r\n    };\r\n\r\n    this.getGrow = function() {\r\n        return parseInt(growSelect.getValue(), 10);\r\n    }\r\n\r\n    this.getContiguous = function() {\r\n        return isContiguous;\r\n    };\r\n\r\n}","import {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * Text Tool tab contents (color slider)\r\n *\r\n * p = {\r\n *     colorSlider: PcColorSlider// when opening tab, inserts it (snatches it from where else it was)\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function TextUi(p) {\r\n    let div = BB.el({\r\n        css: {\r\n            margin: '10px'\r\n        }\r\n    });\r\n    let isVisible = true;\r\n\r\n    let colorDiv = BB.el({\r\n        parent: div,\r\n        css: {\r\n            marginBottom: '10px'\r\n        }\r\n    });\r\n\r\n    let hint = BB.el({\r\n        parent: div,\r\n        content: 'Click canvas to place text'\r\n    });\r\n\r\n\r\n    // --- interface ---\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.setIsVisible = function(pIsVisible) {\r\n        isVisible = !!pIsVisible;\r\n        div.style.display = isVisible ? 'block' : 'none';\r\n        if(isVisible) {\r\n            colorDiv.appendChild(p.colorSlider.getElement());\r\n            colorDiv.appendChild(p.colorSlider.getOutputElement());\r\n            //update();\r\n        }\r\n    };\r\n\r\n}","import {BB} from '../../../bb/bb';\r\nimport {Options} from '../base-components/options';\r\nimport {Checkbox} from '../base-components/checkbox';\r\nimport {PcSlider} from '../base-components/slider';\r\n\r\n/**\r\n * Shape Tool tab contents\r\n *\r\n * p = {\r\n *     colorSlider: PcColorSlider// when opening tab, inserts it (snatches it from where else it was)\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function ShapeUi(p) {\r\n    let div = BB.el({\r\n        css: {\r\n            margin: '10px'\r\n        }\r\n    });\r\n    let isVisible = true;\r\n\r\n    let colorDiv = BB.el({\r\n        parent: div,\r\n        css: {\r\n            marginBottom: '10px'\r\n        }\r\n    });\r\n\r\n    let previewSize = 35;\r\n    let previewPadding = 8;\r\n    let shape; // 'rect'|'ellipse'|'line'\r\n    let mode; // 'stroke'|'fill'\r\n\r\n\r\n    let rectStrokeSvgRect = BB.createSvg({\r\n        elementType: 'rect',\r\n        x: '' + previewPadding,\r\n        width: '' + (previewSize - previewPadding * 2)\r\n    });\r\n    let rectStrokeSvg = BB.createSvg({\r\n        elementType: 'svg',\r\n        width: '' + previewSize,\r\n        height: '' + previewSize\r\n    });\r\n    rectStrokeSvg.appendChild(rectStrokeSvgRect);\r\n    BB.css(rectStrokeSvg, {\r\n        display: 'block'\r\n    });\r\n\r\n    let rectFilledSvgRect = BB.createSvg({\r\n        elementType: 'rect',\r\n        x: '' + previewPadding,\r\n        width: '' + (previewSize - previewPadding * 2)\r\n    });\r\n    let rectFilledSvg = BB.createSvg({\r\n        elementType: 'svg',\r\n        width: '' + previewSize,\r\n        height: '' + previewSize\r\n    });\r\n    rectFilledSvg.appendChild(rectFilledSvgRect);\r\n    BB.css(rectFilledSvg, {\r\n        display: 'block'\r\n    });\r\n\r\n\r\n    let ellipseStrokeSvgEllipse = BB.createSvg({\r\n        elementType: 'ellipse',\r\n        cx: '' + (previewSize / 2),\r\n        cy: '' + (previewSize / 2),\r\n        rx: '' + (previewSize / 2 - previewPadding)\r\n    });\r\n    let ellipseStrokeSvg = BB.createSvg({\r\n        elementType: 'svg',\r\n        width: '' + previewSize,\r\n        height: '' + previewSize,\r\n    });\r\n    ellipseStrokeSvg.appendChild(ellipseStrokeSvgEllipse);\r\n    BB.css(ellipseStrokeSvg, {\r\n        display: 'block'\r\n    });\r\n\r\n    let ellipseFilledSvgEllipse = BB.createSvg({\r\n        elementType: 'ellipse',\r\n        cx: '' + (previewSize / 2),\r\n        cy: '' + (previewSize / 2),\r\n        rx: '' + (previewSize / 2 - previewPadding)\r\n    });\r\n    let ellipseFilledSvg = BB.createSvg({\r\n        elementType: 'svg',\r\n        width: '' + previewSize,\r\n        height: '' + previewSize,\r\n    });\r\n    ellipseFilledSvg.appendChild(ellipseFilledSvgEllipse);\r\n    BB.css(ellipseFilledSvg, {\r\n        display: 'block'\r\n    });\r\n\r\n\r\n    let lineSvgLine = BB.createSvg({\r\n        elementType: 'line',\r\n        x1: '' + previewPadding,\r\n        x2: '' + (previewSize - previewPadding)\r\n    });\r\n    let lineSvg = BB.createSvg({\r\n        elementType: 'svg',\r\n        width: '' + previewSize,\r\n        height: '' + previewSize\r\n    });\r\n    lineSvg.appendChild(lineSvgLine);\r\n    BB.css(lineSvg, {\r\n        display: 'block'\r\n    });\r\n\r\n    function updatePreviews() {\r\n        let strokeWidth = BB.clamp(Math.round(lineWidthSlider.getValue() / 10), 1, 10) + 'px';\r\n\r\n        let squish = 1.35;\r\n\r\n        BB.css(rectStrokeSvgRect, { fill: 'none', stroke: 'black', strokeWidth: strokeWidth });\r\n        BB.css(rectFilledSvgRect, { fill: 'black', stroke: 'none' });\r\n\r\n        BB.css(ellipseStrokeSvgEllipse, { fill: 'none', stroke: 'black', strokeWidth: strokeWidth });\r\n        BB.css(ellipseFilledSvgEllipse, { fill: 'black', stroke: 'none' });\r\n\r\n        BB.css(\r\n            lineSvgLine,\r\n            { fill: 'none', stroke: 'black', strokeWidth: strokeWidth }\r\n        );\r\n\r\n        if ((fixedToggle as any).getValue()) {\r\n            rectStrokeSvgRect.setAttribute('y', '' + previewPadding);\r\n            rectStrokeSvgRect.setAttribute('height', '' + (previewSize - previewPadding * 2));\r\n            rectFilledSvgRect.setAttribute('y', '' + previewPadding);\r\n            rectFilledSvgRect.setAttribute('height', '' + (previewSize - previewPadding * 2));\r\n\r\n            ellipseStrokeSvgEllipse.setAttribute('ry', '' + (previewSize / 2 - previewPadding));\r\n            ellipseFilledSvgEllipse.setAttribute('ry', '' + (previewSize / 2 - previewPadding));\r\n        } else {\r\n            rectStrokeSvgRect.setAttribute('y', '' + (previewPadding * squish));\r\n            rectStrokeSvgRect.setAttribute('height', '' + (previewSize - previewPadding * squish * 2));\r\n            rectFilledSvgRect.setAttribute('y', '' + (previewPadding * squish));\r\n            rectFilledSvgRect.setAttribute('height', '' + (previewSize - previewPadding * squish * 2));\r\n\r\n            ellipseStrokeSvgEllipse.setAttribute('ry', '' + (previewSize / 2 - previewPadding * squish));\r\n            ellipseFilledSvgEllipse.setAttribute('ry', '' + (previewSize / 2 - previewPadding * squish));\r\n        }\r\n\r\n        if ((snapToggle as any).getValue()) {\r\n            lineSvgLine.setAttribute('y1', '' + (previewSize - previewPadding));\r\n            lineSvgLine.setAttribute('y2', '' + previewPadding);\r\n        } else {\r\n            lineSvgLine.setAttribute('y1', '' + (previewSize - previewPadding * squish));\r\n            lineSvgLine.setAttribute('y2', '' + (previewPadding * squish));\r\n        }\r\n    }\r\n\r\n    let row1 = BB.el({\r\n        parent: div,\r\n        css: {\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'start'\r\n        }\r\n    });\r\n\r\n    let shapeOptions = new Options({\r\n        optionArr: [\r\n            {\r\n                id: 'rect-stroke',\r\n                label: rectStrokeSvg,\r\n                title: 'Rectangle Stroke'\r\n            },\r\n            {\r\n                id: 'ellipse-stroke',\r\n                label: ellipseStrokeSvg,\r\n                title: 'Ellipse Stroke'\r\n            },\r\n            {\r\n                id: 'line',\r\n                label: lineSvg,\r\n                title: 'Line'\r\n            },\r\n            {\r\n                id: 'rect-fill',\r\n                label: rectFilledSvg,\r\n                title: 'Rectangle Fill'\r\n            },\r\n            {\r\n                id: 'ellipse-fill',\r\n                label: ellipseFilledSvg,\r\n                title: 'Ellipse Fill'\r\n            },\r\n        ],\r\n        initId: 'rect',\r\n        onChange: function(id) {\r\n            let split = id.split('-');\r\n            shape = split[0];\r\n            mode = split[1];\r\n\r\n            BB.css(fixedToggle.getElement(), {\r\n                display: shape === 'line' ? 'none' : null\r\n            });\r\n            BB.css(snapToggle.getElement(), {\r\n                display: shape === 'line' ? null : 'none'\r\n            });\r\n            BB.css(lineWidthSlider.getElement(), {\r\n                display: (shape !== 'line' && mode === 'fill') ? 'none' : null\r\n            });\r\n        },\r\n        changeOnInit: true\r\n    });\r\n    shapeOptions.getElement().style.width = '120px';\r\n    row1.appendChild(shapeOptions.getElement());\r\n\r\n    let eraserToggle = new Checkbox({\r\n        init: false,\r\n        label: 'Eraser',\r\n        callback: function(b) {\r\n            updatePreviews();\r\n        }\r\n    });\r\n    row1.appendChild(eraserToggle.getElement());\r\n\r\n    let lineWidthSlider = new PcSlider({\r\n        label: 'Line Width',\r\n        width: 250,\r\n        height: 30,\r\n        min: 1,\r\n        max: 200,\r\n        initValue: 4,\r\n        curve: 'quadratic',\r\n        onChange: function (val) {\r\n            updatePreviews();\r\n        },\r\n        formatFunc: function (v) {\r\n            return Math.round(v);\r\n        }\r\n    });\r\n    BB.css(lineWidthSlider.getElement(), {\r\n        marginTop: '10px'\r\n    });\r\n    div.appendChild(lineWidthSlider.getElement());\r\n\r\n    let opacitySlider = new PcSlider({\r\n        label: 'Opacity',\r\n        width: 250,\r\n        height: 30,\r\n        min: 0,\r\n        max: 1,\r\n        initValue: 1,\r\n        onChange: function (val) {\r\n        },\r\n        formatFunc: function (v) {\r\n            return Math.round(v * 100);\r\n        }\r\n    });\r\n    BB.css(opacitySlider.getElement(), {\r\n        marginTop: '10px'\r\n    });\r\n    div.appendChild(opacitySlider.getElement());\r\n\r\n    let row2 = BB.el({\r\n        parent: div,\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            marginTop: '10px'\r\n        }\r\n    });\r\n\r\n    let outwardsToggle = new Checkbox({\r\n        init: false,\r\n        label: 'Outwards',\r\n        callback: function(b) {},\r\n        css: {\r\n            width: '50%',\r\n            marginRight: '10px',\r\n        }\r\n    });\r\n    row2.appendChild(outwardsToggle.getElement());\r\n\r\n    let fixedToggle = new Checkbox({\r\n        init: false,\r\n        label: 'Fixed 1:1',\r\n        callback: function(b) {\r\n            updatePreviews();\r\n        },\r\n        css: {\r\n            flexGrow: '1',\r\n        }\r\n    });\r\n    row2.appendChild(fixedToggle.getElement());\r\n\r\n    let snapToggle = new Checkbox({\r\n        init: false,\r\n        label: 'Snap',\r\n        title: '45° Angle Snapping',\r\n        callback: function(b) {\r\n            updatePreviews();\r\n        },\r\n        css: {\r\n            flexGrow: '1',\r\n        }\r\n    });\r\n    row2.appendChild(snapToggle.getElement());\r\n\r\n\r\n\r\n    updatePreviews();\r\n\r\n    // --- interface ---\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n\r\n    this.setIsVisible = function(pIsVisible) {\r\n        isVisible = !!pIsVisible;\r\n        div.style.display = isVisible ? 'block' : 'none';\r\n        if(isVisible) {\r\n            colorDiv.appendChild(p.colorSlider.getElement());\r\n            colorDiv.appendChild(p.colorSlider.getOutputElement());\r\n            //update();\r\n        }\r\n    };\r\n\r\n    this.getShape = function() {\r\n        return shape;\r\n    };\r\n\r\n    this.getMode = function() {\r\n        return mode;\r\n    };\r\n\r\n    this.getIsEraser = function() {\r\n        return (eraserToggle as any).getValue();\r\n    };\r\n\r\n    this.getOpacity = function() {\r\n        return opacitySlider.getValue();\r\n    };\r\n\r\n    this.getLineWidth = function() {\r\n        return lineWidthSlider.getValue();\r\n    };\r\n\r\n    this.getIsOutwards = function() {\r\n        return (outwardsToggle as any).getValue();\r\n    };\r\n\r\n    this.getIsFixed = function() {\r\n        return (fixedToggle as any).getValue();\r\n    };\r\n\r\n    this.getIsSnap = function() {\r\n        return (snapToggle as any).getValue();\r\n    };\r\n\r\n}","import {BB} from '../../../bb/bb';\r\nimport {Select} from '../base-components/select';\r\nimport {ColorOptions} from '../base-components/color-options';\r\nimport {popup} from './popup';\r\n\r\n/**\r\n * P = {\r\n *     currentColor: RGB, // current color\r\n *     secondaryColor: RGB,\r\n *     maxCanvasSize: number,\r\n *     canvasWidth: number, // current canvas size\r\n *     canvasHeight: number, // current canvas size\r\n *     workspaceWidth: number,\r\n *     workspaceHeight: number,\r\n *     onConfirm: function(width number, height number, color RGBA),\r\n *     onCancel: function()\r\n * }\r\n *\r\n * @param p\r\n */\r\nexport function newImageDialog(p) {\r\n\r\n    let currentColor = p.currentColor;\r\n    let secondaryColor = p.secondaryColor;\r\n    let maxCanvasSize = p.maxCanvasSize;\r\n    let canvasWidth = p.canvasWidth;\r\n    let canvasHeight = p.canvasHeight;\r\n    let workspaceWidth = p.workspaceWidth;\r\n    let workspaceHeight = p.workspaceHeight;\r\n    let onConfirm = p.onConfirm;\r\n    let onCancel = p.onCancel;\r\n\r\n\r\n    function createRatioSize(ratioX, ratioY, width, height, padding) {\r\n        return BB.fitInto(ratioX, ratioY, Math.min(maxCanvasSize, width - padding), Math.min(maxCanvasSize, height - padding), 1);\r\n    }\r\n\r\n    let newImDiv = document.createElement(\"div\");\r\n    let widthWrapper = document.createElement(\"div\");\r\n    let heightWrapper = document.createElement(\"div\");\r\n    let widthInput = document.createElement(\"input\");\r\n    let widthUnit = document.createElement(\"div\");\r\n    let heightInput = document.createElement(\"input\");\r\n    let heightUnit = document.createElement(\"div\");\r\n    widthWrapper.style.position = \"relative\";\r\n    widthWrapper.style.width = \"145px\";\r\n    widthWrapper.style.height = \"35px\";\r\n    widthWrapper.style.lineHeight = \"30px\";\r\n    heightWrapper.style.width = \"145px\";\r\n    heightWrapper.style.height = \"35px\";\r\n    heightWrapper.style.lineHeight = \"30px\";\r\n\r\n    widthUnit.innerText = 'px';\r\n    widthUnit.style.color = '#888';\r\n    widthUnit.style.fontSize = \"12px\";\r\n    widthUnit.style.marginLeft = \"5px\";\r\n    widthUnit.style.cssFloat = \"right\";\r\n\r\n    heightUnit.innerText = 'px';\r\n    heightUnit.style.color = '#888';\r\n    heightUnit.style.fontSize = \"12px\";\r\n    heightUnit.style.marginLeft = \"5px\";\r\n    heightUnit.style.cssFloat = \"right\";\r\n\r\n    widthInput.setAttribute('data-ignore-focus', 'true');\r\n    heightInput.setAttribute('data-ignore-focus', 'true');\r\n\r\n    widthInput.type = 'number';\r\n    widthInput.min = '1';\r\n    widthInput.max = maxCanvasSize;\r\n    widthInput.style.cssFloat = \"right\";\r\n    widthInput.style.width = \"70px\";\r\n\r\n    heightInput.type = 'number';\r\n    heightInput.min = '1';\r\n    heightInput.max = maxCanvasSize;\r\n    heightInput.style.cssFloat = \"right\";\r\n    heightInput.style.width = \"70px\";\r\n    widthInput.value = canvasWidth;\r\n    heightInput.value = canvasHeight;\r\n    widthInput.onclick = function () {\r\n        (this as any).focus();\r\n        updateRatio();\r\n    };\r\n    heightInput.onclick = function () {\r\n        (this as any).focus();\r\n        updateRatio();\r\n    };\r\n    widthWrapper.appendChild(widthUnit);\r\n    widthWrapper.appendChild(widthInput);\r\n    BB.appendTextDiv(widthWrapper, \"Width: \");\r\n    heightWrapper.appendChild(heightUnit);\r\n    heightWrapper.appendChild(heightInput);\r\n    BB.appendTextDiv(heightWrapper, \"Height: \");\r\n    let ratioWrapper = document.createElement(\"div\");\r\n    ratioWrapper.style.marginTop = '5px';\r\n    ratioWrapper.style.color = '#888';\r\n    ratioWrapper.innerText = \"Ratio: 23:12\";\r\n\r\n    // let swapButton = BB.div({\r\n    //     tagName: 'button',\r\n    //     title: 'Swap',\r\n    //     content: '<img src=\\'app/img/ui/swap-y.svg\\' alt=\\'Swap\\' style=\"width: 20px; height: 20px\"/>',\r\n    //     onClick: function() {\r\n    //         let temp = widthInput.value;\r\n    //         widthInput.value = heightInput.value;\r\n    //         heightInput.value = temp;\r\n    //         updateRatio();\r\n    //     },\r\n    //     css: {\r\n    //         position: 'absolute',\r\n    //         right: '-40px',\r\n    //         bottom: '-11px'\r\n    //     }\r\n    // });\r\n    //widthWrapper.appendChild(swapButton);\r\n\r\n    let templateWrapper = document.createElement(\"div\");\r\n    //BB.appendTextDiv(templateWrapper, \"Preset Resolutions: <br />\");\r\n    let presetFitBtn = document.createElement(\"button\");\r\n    templateWrapper.style.marginBottom = \"10px\";\r\n    let presetCurrentBtn = document.createElement(\"button\");\r\n    let presetSquareBtn = document.createElement(\"button\");\r\n    let presetLandscapeBtn = document.createElement(\"button\");\r\n    let presetPortraitBtn = document.createElement(\"button\");\r\n    let presetOversizeBtn = document.createElement(\"button\");\r\n\r\n    presetCurrentBtn.textContent = \"Current\";\r\n    presetFitBtn.textContent = \"Fit\";\r\n    presetOversizeBtn.textContent = \"Oversize\";\r\n    presetLandscapeBtn.textContent = \"Landscape\";\r\n    presetPortraitBtn.textContent = \"Portrait\";\r\n    presetSquareBtn.textContent = \"Square\";\r\n\r\n    presetCurrentBtn.style.marginRight = \"5px\";\r\n    presetFitBtn.style.marginRight = \"5px\";\r\n    presetOversizeBtn.style.marginRight = \"5px\";\r\n    presetLandscapeBtn.style.marginTop = \"5px\";\r\n    presetLandscapeBtn.style.marginRight = \"5px\";\r\n    presetPortraitBtn.style.marginTop = \"5px\";\r\n    presetPortraitBtn.style.marginRight = \"5px\";\r\n\r\n    templateWrapper.appendChild(presetCurrentBtn);\r\n    templateWrapper.appendChild(presetFitBtn);\r\n    templateWrapper.appendChild(presetOversizeBtn);\r\n    templateWrapper.appendChild(presetSquareBtn);\r\n    templateWrapper.appendChild(presetLandscapeBtn);\r\n    templateWrapper.appendChild(presetPortraitBtn);\r\n\r\n    let templatePadding = 50;\r\n\r\n    presetCurrentBtn.onclick = function () {\r\n        widthInput.value = canvasWidth;\r\n        heightInput.value = canvasHeight;\r\n        updateRatio();\r\n    };\r\n    presetFitBtn.onclick = function () {\r\n        widthInput.value = workspaceWidth;\r\n        heightInput.value = workspaceHeight;\r\n        updateRatio();\r\n    };\r\n    presetOversizeBtn.onclick = function () {\r\n        widthInput.value = workspaceWidth + 500;\r\n        heightInput.value = workspaceHeight + 500;\r\n        updateRatio();\r\n    };\r\n    presetSquareBtn.onclick = function () {\r\n        let sizeObj = createRatioSize(1, 1, workspaceWidth, workspaceHeight, templatePadding);\r\n        widthInput.value = '' + Math.round(sizeObj.width);\r\n        heightInput.value = '' + Math.round(sizeObj.height);\r\n        updateRatio();\r\n    };\r\n    presetLandscapeBtn.onclick = function () {\r\n        let sizeObj = createRatioSize(4, 3, workspaceWidth, workspaceHeight, templatePadding);\r\n        widthInput.value = '' + Math.round(sizeObj.width);\r\n        heightInput.value = '' + Math.round(sizeObj.height);\r\n        updateRatio();\r\n    };\r\n    presetPortraitBtn.onclick = function () {\r\n        let sizeObj = createRatioSize(3, 4, workspaceWidth, workspaceHeight, templatePadding);\r\n        widthInput.value = '' + Math.round(sizeObj.width);\r\n        heightInput.value = '' + Math.round(sizeObj.height);\r\n        updateRatio();\r\n    };\r\n\r\n    let select = new Select({\r\n        isFocusable: true,\r\n        optionArr: [\r\n            ['screen', 'Screen'],\r\n            ['16 9', 'Video 16:9'],\r\n            ['3 2', '3:2'],\r\n            ['5 3', '5:3'],\r\n            ['2 1', '2:1'],\r\n            ['paper', 'DIN Paper √2:1'],\r\n            ['9 16', '9:16'],\r\n            ['2 3', '2:3'],\r\n            ['3 5', '3:5'],\r\n            ['1 2', '1:2'],\r\n            ['1 1.4142135623730951', '1:√2']\r\n        ],\r\n        onChange: function(val) {\r\n            if (val === 'screen') {\r\n                widthInput.value = '' + window.screen.width;\r\n                heightInput.value = '' + window.screen.height;\r\n            } else if (val === 'paper') {\r\n                let sizeObj = createRatioSize(Math.sqrt(2), 1, workspaceWidth, workspaceHeight, templatePadding);\r\n                widthInput.value = '' + Math.round(sizeObj.width);\r\n                heightInput.value = '' + Math.round(sizeObj.height);\r\n            } else {\r\n                let split = val.split(' ');\r\n                let sizeObj = createRatioSize(parseFloat(split[0]), parseFloat(split[1]), workspaceWidth, workspaceHeight, templatePadding);\r\n                widthInput.value = '' + Math.round(sizeObj.width);\r\n                heightInput.value = '' + Math.round(sizeObj.height);\r\n            }\r\n            updateRatio();\r\n            select.setValue(null);\r\n        }\r\n    });\r\n    templateWrapper.appendChild(select.getElement());\r\n\r\n\r\n\r\n    let backgroundRGBA = {r: 255, g: 255, b: 255, a: 1};\r\n\r\n    let colorOptionsArr = [\r\n        {r: 255, g: 255, b: 255, a: 1},\r\n        {r: 0, g: 0, b: 0, a: 1},\r\n        {r: 0, g: 0, b: 0, a: 0}\r\n    ];\r\n    colorOptionsArr.push({\r\n        r: currentColor.r,\r\n        g: currentColor.g,\r\n        b: currentColor.b,\r\n        a: 1\r\n    });\r\n    colorOptionsArr.push({\r\n        r: secondaryColor.r,\r\n        g: secondaryColor.g,\r\n        b: secondaryColor.b,\r\n        a: 1\r\n    });\r\n\r\n    let colorOptions = new ColorOptions({\r\n        colorArr: colorOptionsArr,\r\n        onChange: function(rgbaObj) {\r\n            backgroundRGBA = rgbaObj;\r\n            preview.style.backgroundColor = \"rgba(\" + rgbaObj.r + \",\" + rgbaObj.g + \",\" + rgbaObj.b + \", \" + rgbaObj.a + \")\";\r\n        }\r\n    });\r\n\r\n    let previewWrapper = document.createElement(\"div\");\r\n    BB.css(previewWrapper, {\r\n        boxSizing: 'border-box',\r\n        width: '340px',\r\n        height: '140px',\r\n        display: 'table',\r\n        backgroundColor: '#9e9e9e',\r\n        padding: '10px',\r\n        marginTop: '10px',\r\n        boxShadow: 'rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset',\r\n        marginLeft: '-20px',\r\n        colorScheme: 'only light',\r\n    });\r\n    let preview = document.createElement(\"div\");\r\n    BB.css(preview, {\r\n        width: 200 + \"px\",\r\n        height: 100 + \"px\",\r\n        backgroundColor: \"#fff\",\r\n        marginLeft: \"auto\",\r\n        marginRight: \"auto\",\r\n        color: \"#aaa\",\r\n        fontSize: \"16px\",\r\n        fontWeight: \"bold\",\r\n        textAlign: \"center\",\r\n        verticalAlign: \"center\",\r\n        display: \"table\",\r\n        overflow: \"hidden\",\r\n        boxShadow: \"0px 0px 3px rgba(0,0,0,0.5)\"\r\n    });\r\n    let previewcell = document.createElement(\"div\");\r\n    previewcell.style.display = \"table-cell\";\r\n    previewcell.style.verticalAlign = \"middle\";\r\n    previewcell.appendChild(preview);\r\n    previewWrapper.appendChild(previewcell);\r\n    let cell = BB.appendTextDiv(preview, \"\");\r\n    //let ratio = BB.appendTextDiv(cell, \"1:2\");\r\n    cell.style.display = \"table-cell\";\r\n    cell.style.verticalAlign = \"middle\";\r\n    let prevW = parseInt(widthInput.value);\r\n    let prevH = parseInt(heightInput.value);\r\n\r\n    function updateRatio() {\r\n        widthInput.value = '' + Math.min(maxCanvasSize, parseInt(widthInput.value));\r\n        heightInput.value = '' + Math.min(maxCanvasSize, parseInt(heightInput.value));\r\n\r\n        function HCF(u, v) {\r\n            let U = u, V = v;\r\n            while (true) {\r\n                if (!(U %= V))\r\n                    return V;\r\n                if (!(V %= U))\r\n                    return U;\r\n            }\r\n        }\r\n\r\n        let w = parseInt(widthInput.value);\r\n        let h = parseInt(heightInput.value);\r\n        if (w < 1 || w > maxCanvasSize || h < 1 || h > maxCanvasSize) {\r\n            if (w > maxCanvasSize)\r\n                w = maxCanvasSize;\r\n            else if (h > maxCanvasSize)\r\n                h = maxCanvasSize;\r\n\r\n            widthInput.value = '' + w;\r\n            heightInput.value = '' + h;\r\n        }\r\n\r\n        //generated canvas size doesn't always match ratio. so check if a common ratio is very close\r\n        let commonRatios = [\r\n            [1, 2], [2, 1],\r\n            [2, 3], [3, 2],\r\n            [3, 4], [4, 3],\r\n            [4, 5], [5, 4],\r\n            [16, 9], [9, 16],\r\n            [3, 2], [2, 3],\r\n            [5, 3], [3, 5],\r\n            [2, 1], [1, 2],\r\n            [1.414, 1], [1, 1.414],\r\n        ];\r\n        let reducedArr = BB.reduce(w, h);\r\n        let closestRatio = null;\r\n        let closestDistance = null;\r\n        for (let i = 0; i < commonRatios.length; i++) {\r\n            if (i === 0 || Math.abs(commonRatios[i][0] / commonRatios[i][1] - reducedArr[0] / reducedArr[1]) < closestDistance) {\r\n                closestRatio = commonRatios[i];\r\n                closestDistance = Math.abs(commonRatios[i][0] / commonRatios[i][1] - reducedArr[0] / reducedArr[1]);\r\n            }\r\n        }\r\n        //display ratio\r\n        if (closestDistance > 0 && closestDistance < 0.005) {\r\n            ratioWrapper.innerText = 'Ratio: ~' + closestRatio[0] + ':' + closestRatio[1];\r\n        } else {\r\n            ratioWrapper.innerText = 'Ratio: ' + reducedArr[0] + ':' + reducedArr[1];\r\n        }\r\n\r\n        prevW = w;\r\n        prevH = h;\r\n        let realw = w;\r\n        let T = HCF(w, h);\r\n        w /= T;\r\n        h /= T;\r\n        w *= 260;\r\n        h *= 260;\r\n        if (w > 260) {\r\n            h = 260 / w * h;\r\n            w = 260;\r\n        }\r\n        if (h > 100) {\r\n            w = 100 / h * w;\r\n            h = 100;\r\n\r\n        }\r\n\r\n        preview.style.width = w + \"px\";\r\n        preview.style.height = h + \"px\";\r\n        BB.createCheckerDataUrl(parseInt('' + (30 * (w / realw))), function (url) {\r\n            previewWrapper.style.background = \"url(\" + url + \")\";\r\n        });\r\n    }\r\n\r\n    widthInput.onchange = function () {\r\n        if(widthInput.value === '' || parseInt(widthInput.value) < 0) {\r\n            widthInput.value = '1';\r\n        }\r\n        updateRatio();\r\n    };\r\n    widthInput.onkeyup = function () {\r\n        updateRatio();\r\n    };\r\n    heightInput.onchange = function () {\r\n        if(heightInput.value === '' || parseFloat(heightInput.value) < 0) {\r\n            heightInput.value = '1';\r\n        }\r\n        updateRatio();\r\n    };\r\n    heightInput.onkeyup = function () {\r\n        updateRatio();\r\n    };\r\n    updateRatio();\r\n\r\n    newImDiv.appendChild(templateWrapper);\r\n    let secondRow = BB.el({\r\n        parent: newImDiv,\r\n        css: {\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'flex-end'\r\n        }\r\n    });\r\n    let secondRowLeft = BB.el({\r\n        parent: secondRow\r\n    });\r\n    secondRowLeft.appendChild(widthWrapper);\r\n    secondRowLeft.appendChild(heightWrapper);\r\n    secondRowLeft.appendChild(ratioWrapper);\r\n    secondRow.appendChild(colorOptions.getElement());\r\n\r\n    newImDiv.appendChild(previewWrapper);\r\n\r\n    popup({\r\n        target: document.body,\r\n        message: \"<b>New Image</b>\",\r\n        div: newImDiv,\r\n        buttons: ['Ok', 'Cancel'],\r\n        callback: function (result) {\r\n            widthInput.onclick = null;\r\n            heightInput.onclick = null;\r\n            presetCurrentBtn.onclick = null;\r\n            presetFitBtn.onclick = null;\r\n            presetOversizeBtn.onclick = null;\r\n            presetSquareBtn.onclick = null;\r\n            presetLandscapeBtn.onclick = null;\r\n            presetPortraitBtn.onclick = null;\r\n            widthInput.onchange = null;\r\n            widthInput.onkeyup = null;\r\n            heightInput.onchange = null;\r\n            heightInput.onkeyup = null;\r\n            select.destroy();\r\n            colorOptions.destroy();\r\n\r\n            if (result === \"Cancel\" || parseInt(widthInput.value) <= 0 || parseInt(heightInput.value) <= 0 || isNaN(parseInt(widthInput.value)) || isNaN(parseInt(heightInput.value))) {\r\n                onCancel();\r\n                return;\r\n            }\r\n            onConfirm(parseInt(widthInput.value), parseInt(heightInput.value), backgroundRGBA);\r\n        },\r\n        clickOnEnter: 'Ok'\r\n    });\r\n\r\n}","import {BB} from '../../../bb/bb';\r\n// @ts-ignore\r\nimport collapseImg from 'url:~/src/app/img/ui/ui-collapse.svg';\r\n\r\n/**\r\n * button that allows to collapse toolspace (for mobile)\r\n *\r\n * p = {\r\n *     onChange: function()\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nexport function ToolspaceCollapser(p) {\r\n    let isOpen = true;\r\n    let directionStr = 'right'; // 'left' | 'right'\r\n\r\n    function update() {\r\n        if (directionStr === 'left') {\r\n            icon.style.transform = isOpen ? 'rotate(180deg)' : '';\r\n        } else {\r\n            icon.style.transform = isOpen ? '' : 'rotate(180deg)';\r\n        }\r\n    }\r\n\r\n    let div = BB.el({\r\n        css: {\r\n            width: '36px',\r\n            height: '36px',\r\n            background: 'rgba(100, 100, 100, 0.9)',\r\n            color: '#fff',\r\n            position: 'absolute',\r\n            top: '0',\r\n            textAlign: 'center',\r\n            lineHeight: '36px',\r\n            cursor: 'pointer',\r\n            userSelect: 'none',\r\n            padding: '6px',\r\n            boxSizing: 'border-box'\r\n        },\r\n        title: 'Show/hide tools',\r\n        onClick: function(e) {\r\n            e.preventDefault();\r\n            isOpen = !isOpen;\r\n            update();\r\n            p.onChange();\r\n        }\r\n    });\r\n\r\n    let icon = BB.el({\r\n        parent: div,\r\n        css: {\r\n            backgroundImage: `url(${collapseImg})`,\r\n            width: '100%',\r\n            height: '100%',\r\n            backgroundSize: 'contain',\r\n            backgroundRepeat: 'no-repeat',\r\n            backgroundPosition: 'center',\r\n            userSelect: 'none'\r\n        }\r\n    });\r\n    div.oncontextmenu = function () {\r\n        return false;\r\n    };\r\n\r\n    // --- interface ---\r\n    this.isOpen = function() {\r\n        return isOpen;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param dirStr\r\n     */\r\n    this.setDirection = function(dirStr) {\r\n        directionStr = dirStr;\r\n        update();\r\n    };\r\n\r\n    this.getElement = function() {\r\n        return div;\r\n    };\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"b1UMP\");","import {BB} from '../../bb/bb';\r\n\r\n/**\r\n * Draw text on a canvas.\r\n *\r\n * p = {\r\n *     canvas: canvas, // drawn on this canvas\r\n *     textStr: str, // text to be drawn. can contain newlines\r\n *     x: number,\r\n *     y: number,\r\n *     size: number,\r\n *     font: 'serif' | 'monospace' | 'sans-serif' | 'cursive' | 'fantasy', // default sans-serif\r\n *     align: 'left' | 'center' | 'right', // default 'left'\r\n *     isBold: boolean, // default false\r\n *     isItalic: boolean, // default false\r\n *     angleRad: number, // default 0 - rotates around x y\r\n * }\r\n *\r\n * @param p\r\n * @returns {{x: number, width: number, y: number, height: number}} - bounds. coords relative to p.x p.y\r\n */\r\nexport function renderText(p) {\r\n\r\n    // always at least a space. so bounds aren't just a dot\r\n    let textStr = p.textStr === '' ? ' ' : p.textStr;\r\n\r\n    // --- create el ---\r\n    // create an actual dom element. figure out where exactly each letter is positioned.\r\n    // that way multiline is feasible. canvas can't do multiline or text-align\r\n    let outer = BB.el({\r\n        css: {\r\n            position: 'fixed',\r\n            left: '0',\r\n            top: '0',\r\n            width: '100000px',\r\n            fontSize: p.size + 'px',\r\n            lineHeight: p.lineHeight ? p.lineHeight + 'px' : 'default',\r\n        }\r\n    });\r\n    let div = BB.el({\r\n        parent: outer,\r\n        css: {\r\n            display: 'inline-block',\r\n            textAlign: p.align ? p.align : 'left',\r\n            fontFamily: p.font ? p.font : 'sans-serif',\r\n            fontSize: p.size + 'px',\r\n            fontWeight: p.isBold ? 'bold' : 'normal',\r\n            fontStyle: p.isItalic ? 'italic' : 'normal',\r\n            lineHeight: p.lineHeight ? p.lineHeight + 'px' : 'default',\r\n\r\n\r\n            opacity: '0',\r\n            pointerEvents: 'none'\r\n        }\r\n    });\r\n    let spanStr = '';\r\n    let replaceObj = {\r\n        \"\\n\": '<br>',\r\n        \" \": '&nbsp;',\r\n        \"\t\": '&nbsp;&nbsp;&nbsp;&nbsp;',\r\n    };\r\n    for (let i = 0; i < textStr.length; i++) {\r\n        if (textStr[i] === \"\\n\") {\r\n            div.appendChild(BB.el({\r\n                tagName: 'span',\r\n                textContent: spanStr,\r\n                css: {\r\n                    whiteSpace: 'pre'\r\n                }\r\n            }));\r\n            spanStr = '';\r\n            div.appendChild(BB.el({\r\n                tagName: 'br'\r\n            }));\r\n            continue;\r\n        }\r\n        spanStr += textStr[i].replace(\"\\t\", '    ');\r\n    }\r\n    div.appendChild(BB.el({\r\n        tagName: 'span',\r\n        textContent: spanStr,\r\n        css: {\r\n            whiteSpace: 'pre'\r\n        }\r\n    }));\r\n    document.body.appendChild(outer);\r\n\r\n\r\n    // --- determine bounds ---\r\n    let bounds = {\r\n        x0: 99999999,\r\n        y0: 99999999,\r\n        x1: 0,\r\n        y1: 0\r\n    }\r\n    for (let i = 0; i < div.children.length; i++) {\r\n        let el = div.children[i] as HTMLElement;\r\n        bounds.x0 = Math.min(bounds.x0, el.offsetLeft);\r\n        bounds.y0 = Math.min(bounds.y0, el.offsetTop);\r\n        bounds.x1 = Math.max(bounds.x1, el.offsetLeft + el.offsetWidth);\r\n        bounds.y1 = Math.max(bounds.y1, el.offsetTop + el.offsetHeight);\r\n    }\r\n\r\n    // --- draw ---\r\n    let ctx = p.canvas.getContext('2d');\r\n    ctx.save();\r\n\r\n    let font = [];\r\n    if (p.isItalic) {\r\n        font.push('italic');\r\n    }\r\n    if (p.isBold) {\r\n        font.push('bold');\r\n    }\r\n    font.push(p.size + 'px ' + (p.font ? p.font : 'sans-serif'));\r\n    ctx.font = font.join(' ');\r\n    ctx.fillStyle = p.color ? p.color : '#000';\r\n\r\n    let x = p.x;\r\n    let y = p.y;\r\n    if (p.align === 'right') {\r\n        x += -bounds.x1 + bounds.x0;\r\n    }\r\n    if (p.align === 'center') {\r\n        x += (-bounds.x1 + bounds.x0) / 2;\r\n    }\r\n    ctx.translate(p.x, p.y);\r\n    ctx.rotate(p.angleRad ? -p.angleRad : 0);\r\n    ctx.translate(-p.x, -p.y);\r\n    ctx.translate(x, y);\r\n\r\n    // fill\r\n    for (let i = 0; i < div.children.length; i++) {\r\n        let el = div.children[i] as HTMLElement;\r\n\r\n        //ctx.fillText(el.innerText, 0, 0);\r\n        ctx.fillText(el.innerText, el.offsetLeft, el.offsetTop);\r\n    }\r\n\r\n    if (p.isDebug) {\r\n        ctx.lineWidth = 1;\r\n        ctx.strokeRect(0, -p.size * 0.85, bounds.x1, bounds.y1);\r\n        ctx.restore();\r\n        ctx.fillRect(p.x - 1, p.y - 1, 2, 2);\r\n    } else {\r\n        ctx.restore();\r\n    }\r\n\r\n    document.body.removeChild(outer);\r\n\r\n    return {\r\n        x: x - p.x,\r\n        y: y - p.y -p.size * 0.85,\r\n        width: bounds.x1 - bounds.x0,\r\n        height: bounds.y1 - bounds.y0\r\n    };\r\n}","import {BB} from '../../../bb/bb';\r\nimport {renderText} from '../../image-operations/render-text';\r\nimport {ColorOptions} from '../base-components/color-options';\r\nimport {Select} from '../base-components/select';\r\nimport {ImageRadioList} from '../base-components/image-radio-list';\r\nimport {ImageToggle} from '../base-components/image-toggle';\r\nimport {PcSlider} from '../base-components/slider';\r\nimport {popup} from './popup';\r\n// @ts-ignore\r\nimport alignLeftImg from 'url:~/src/app/img/ui/align-left.svg';\r\n// @ts-ignore\r\nimport alignCenterImg from 'url:~/src/app/img/ui/align-center.svg';\r\n// @ts-ignore\r\nimport alignRightImg from 'url:~/src/app/img/ui/align-right.svg';\r\n// @ts-ignore\r\nimport typoItalicImg from 'url:~/src/app/img/ui/typo-italic.svg';\r\n// @ts-ignore\r\nimport typoBoldImg from 'url:~/src/app/img/ui/typo-bold.svg';\r\n// @ts-ignore\r\nimport toolZoomInImg from 'url:~/src/app/img/ui/tool-zoom-in.svg';\r\n// @ts-ignore\r\nimport toolZoomOutImg from 'url:~/src/app/img/ui/tool-zoom-out.svg';\r\n\r\n/**\r\n * Text Tool dialog\r\n *\r\n * p = {\r\n *     klCanvas: klCanvas,\r\n *     layerIndex: number,\r\n *     x: number,\r\n *     y: number,\r\n *     angleRad: number,\r\n *     color: rgb,\r\n *     secondaryColor: rgb,\r\n *     size: number, // px\r\n *     align: 'left' | 'center' | 'right', // default 'left'\r\n *     isBold: boolean, // default false\r\n *     isItalic: boolean, // default false\r\n *     font: 'serif' | 'monospace' | 'sans-serif' | 'cursive' | 'fantasy', // default sans-serif\r\n *     opacity: number, // 0 - 1; default 1\r\n *     onConfirm: function(confirmP)\r\n * }\r\n *\r\n * confirmP = {\r\n *     x: number,\r\n *     y: number,\r\n *     textStr: string,\r\n *     align: 'left' | 'center' | 'right',\r\n *     isItalic: boolean,\r\n *     isBold: boolean,\r\n *     color: rgb,\r\n *     size: number, // px\r\n *     font: 'serif' | 'monospace' | 'sans-serif' | 'cursive' | 'fantasy',\r\n *     opacity: number, // 0 - 1\r\n * }\r\n *\r\n * @param p\r\n */\r\nexport function textToolDialog(p) {\r\n\r\n    let div = BB.el({});\r\n\r\n    let isSmallWidth = window.innerWidth < 550;\r\n    let isSmallHeight = window.innerHeight < 630;\r\n\r\n    // --- preview ---\r\n    // Text drawn on klCanvas-sized canvas: textCanvas\r\n    // LayerArr[target].canvas & textCanvas then drawn on targetCanvas\r\n    //      they are transformed. canvas size of final preview\r\n    // All layers and targetCanvas drawn on layersCanvas. transformed and size of final preview\r\n    // Checkerboard, layersCanvas, and outline then drawn on previewCanvas\r\n\r\n    let width = isSmallWidth ? 340 : 540;\r\n    let height = isSmallWidth ? (isSmallHeight ? 210 : 260) : (isSmallHeight ? 230 : 350);\r\n    let scale = 1;\r\n\r\n    let layerArr = p.klCanvas.getLayersFast();\r\n    let textCanvas = BB.canvas(p.klCanvas.getWidth(), p.klCanvas.getHeight());\r\n    let textCtx = textCanvas.getContext('2d');\r\n    let targetCanvas = BB.canvas(width, height);\r\n    let targetCtx = targetCanvas.getContext('2d');\r\n    let layersCanvas = BB.canvas(width, height);\r\n    let layersCtx = layersCanvas.getContext('2d');\r\n    let previewCanvas = BB.canvas(width, height); // the one that is visible\r\n    let previewCtx = previewCanvas.getContext('2d');\r\n    BB.css(previewCanvas, {\r\n        display: 'block'\r\n    });\r\n    let previewWrapper = BB.el({\r\n        parent: div,\r\n        css: {\r\n            position: 'relative',\r\n            width: width + 'px',\r\n            marginLeft: '-20px',\r\n            cursor: 'move',\r\n            colorScheme: 'only light',\r\n        },\r\n        onClick: function() {\r\n            textInput.focus();\r\n        }\r\n    });\r\n    BB.el({ // inset shadow on preview\r\n        parent: previewWrapper,\r\n        css: {\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0',\r\n            right: '0',\r\n            bottom: '0',\r\n            boxShadow: 'rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset',\r\n            pointerEvents: 'none',\r\n        }\r\n    });\r\n    previewWrapper.appendChild(previewCanvas);\r\n    let checkerPattern = previewCtx.createPattern(BB.createCheckerCanvas(8), 'repeat');\r\n    let emptyCanvas = BB.canvas(1, 1);\r\n    {\r\n        let ctx = emptyCanvas.getContext('2d');\r\n        ctx.fillRect(0, 0, 1, 1);\r\n    }\r\n\r\n    function updatePreview() {\r\n\r\n        // try to draw very much like klCanvasWorkspace\r\n\r\n        // --- draw text ---\r\n        textCtx.clearRect(0, 0, textCanvas.width, textCanvas.height);\r\n        let colorRGBA = p.color;\r\n        colorRGBA.a = opacitySlider.getValue();\r\n        let bounds = renderText({\r\n            canvas: textCanvas,\r\n            x: p.x,\r\n            y: p.y,\r\n            textStr: textInput.value,\r\n            align: alignRadioList.getValue(),\r\n            isItalic: italicToggle.getValue(),\r\n            isBold: boldToggle.getValue(),\r\n            size: sizeInput.value,\r\n            font: fontSelect.getValue(),\r\n            color: BB.ColorConverter.toRgbaStr(colorRGBA),\r\n            angleRad: p.angleRad\r\n        });\r\n\r\n\r\n        // --- determine transformation of viewport ---\r\n        // text should always be visible\r\n        bounds.width = Math.max(bounds.width, 1);\r\n        bounds.height = Math.max(bounds.height, 1);\r\n        let rotatedXY = BB.rotate(bounds.x, bounds.y, -p.angleRad / Math.PI * 180);\r\n        let rotatedWH = BB.rotate(bounds.width, bounds.height, -p.angleRad / Math.PI * 180);\r\n        let centerX = p.x + rotatedXY.x + rotatedWH.x / 2;\r\n        let centerY = p.y + rotatedXY.y + rotatedWH.y / 2;\r\n\r\n        let padding = 100;\r\n        let fitBounds = BB.fitInto(bounds.width, bounds.height, width - padding, height - padding);\r\n        scale = Math.min(1, fitBounds.width / bounds.width);\r\n        scale = Math.min(4, scale * Math.pow(2, zoomFac));\r\n\r\n\r\n        // --- compose text and target layer ---\r\n        targetCtx.save();\r\n\r\n        if(scale >= 4) {\r\n            targetCtx.imageSmoothingEnabled = false;\r\n        } else {\r\n            targetCtx.imageSmoothingEnabled = true;\r\n            targetCtx.imageSmoothingQuality  = scale >= 1 ? 'low' : 'medium';\r\n        }\r\n\r\n        targetCtx.clearRect(0, 0, previewCanvas.width, previewCanvas.height);\r\n        targetCtx.translate(width / 2, height / 2);\r\n        targetCtx.scale(scale, scale);\r\n        targetCtx.rotate(p.angleRad);\r\n        targetCtx.drawImage(layerArr[p.layerIndex].canvas, -centerX, -centerY);\r\n        targetCtx.drawImage(textCanvas, -centerX, -centerY);\r\n        targetCtx.restore();\r\n\r\n\r\n        // --- layers ---\r\n        layersCtx.save();\r\n\r\n        layersCtx.fillStyle = 'rgb(158,158,158)';\r\n        layersCtx.fillRect(0, 0, width, height);\r\n\r\n        { // bg\r\n            layersCtx.save();\r\n\r\n            layersCtx.translate(width / 2, height / 2);\r\n            layersCtx.scale(scale, scale);\r\n            layersCtx.rotate(p.angleRad);\r\n\r\n            layersCtx.imageSmoothingEnabled = false;\r\n\r\n            //outline\r\n            let borderSize = 1 / scale;\r\n            layersCtx.globalAlpha = 0.2;\r\n            layersCtx.drawImage(emptyCanvas, -centerX - borderSize, -centerY - borderSize, textCanvas.width + borderSize * 2, textCanvas.height + borderSize * 2);\r\n            layersCtx.globalAlpha = 1;\r\n\r\n            //erase\r\n            layersCtx.globalCompositeOperation = 'destination-out';\r\n            layersCtx.drawImage(emptyCanvas, -centerX, -centerY, textCanvas.width, textCanvas.height);\r\n\r\n            layersCtx.restore();\r\n        }\r\n\r\n        { // individual layers\r\n\r\n            if(scale >= 4) {\r\n                layersCtx.imageSmoothingEnabled = false;\r\n            } else {\r\n                layersCtx.imageSmoothingEnabled = true;\r\n                layersCtx.imageSmoothingQuality  = scale >= 1 ? 'low' : 'medium';\r\n            }\r\n\r\n            // layers below\r\n            layersCtx.save();\r\n            layersCtx.translate(width / 2, height / 2);\r\n            layersCtx.scale(scale, scale);\r\n            layersCtx.rotate(p.angleRad);\r\n            for (var i = 0; i < p.layerIndex; i++) {\r\n                if (layerArr[i].opacity > 0) {\r\n                    layersCtx.globalAlpha = layerArr[i].opacity;\r\n                    layersCtx.globalCompositeOperation = layerArr[i].mixModeStr;\r\n                    layersCtx.drawImage(layerArr[i].canvas, -centerX, -centerY);\r\n                }\r\n            }\r\n            layersCtx.restore();\r\n\r\n            // target layer\r\n            layersCtx.globalAlpha = layerArr[p.layerIndex].opacity;\r\n            layersCtx.globalCompositeOperation = layerArr[p.layerIndex].mixModeStr;\r\n            layersCtx.drawImage(targetCanvas, 0, 0);\r\n\r\n            // layers above\r\n            layersCtx.save();\r\n            layersCtx.translate(width / 2, height / 2);\r\n            layersCtx.scale(scale, scale);\r\n            layersCtx.rotate(p.angleRad);\r\n            for (let i = p.layerIndex + 1; i < layerArr.length; i++) {\r\n                if (layerArr[i].opacity > 0) {\r\n                    layersCtx.globalAlpha = layerArr[i].opacity;\r\n                    layersCtx.globalCompositeOperation = layerArr[i].mixModeStr;\r\n                    layersCtx.drawImage(layerArr[i].canvas, -centerX, -centerY);\r\n                }\r\n            }\r\n            layersCtx.restore();\r\n\r\n        }\r\n\r\n        layersCtx.restore();\r\n\r\n\r\n\r\n        // --- final composite ---\r\n        previewCtx.save();\r\n        previewCtx.fillStyle = checkerPattern;\r\n        previewCtx.fillRect(0, 0, previewCanvas.width, previewCanvas.height);\r\n        previewCtx.drawImage(layersCanvas, 0, 0);\r\n        previewCtx.restore();\r\n\r\n        // bounds\r\n        previewCtx.save();\r\n        previewCtx.globalCompositeOperation = 'difference';\r\n        previewCtx.strokeStyle = '#fff';\r\n        previewCtx.lineWidth = 1;\r\n        // centerX = p.x + bounds.x + bounds.width / 2;\r\n        // centerY = p.y + bounds.y + bounds.height / 2;\r\n        previewCtx.strokeRect(\r\n            Math.round(width / 2 - (bounds.width / 2) * scale),\r\n            Math.round(height / 2 - (bounds.height / 2) * scale),\r\n            Math.round(bounds.width * scale),\r\n            Math.round(bounds.height * scale)\r\n        );\r\n        previewCtx.restore();\r\n\r\n    }\r\n\r\n    function move(x, y) {\r\n        let rotated = BB.rotate(x, y, -p.angleRad / Math.PI * 180);\r\n        p.x += rotated.x / scale;\r\n        p.y += rotated.y / scale;\r\n        updatePreview();\r\n    }\r\n\r\n    let previewPointerListener = new BB.PointerListener({\r\n        target: previewCanvas,\r\n        pointers: 1,\r\n        onPointer: function(e) {\r\n            if (e.type === 'pointermove' && e.button) {\r\n                e.eventPreventDefault();\r\n                move(-e.dX, -e.dY);\r\n            }\r\n        },\r\n        onWheel: function(e) {\r\n            changeZoomFac(-e.deltaY);\r\n        }\r\n    });\r\n\r\n\r\n\r\n    let row1 = BB.el({\r\n        parent: div,\r\n        css: {\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            marginTop: '10px'\r\n        }\r\n    });\r\n    let row2n3Wrapper = BB.el({\r\n        parent: div,\r\n        css: isSmallWidth ? {} : {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'space-between'\r\n        }\r\n    });\r\n    let row2 = BB.el({\r\n        parent: row2n3Wrapper,\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            marginTop: '5px'\r\n        }\r\n    });\r\n    let row3 = BB.el({\r\n        parent: row2n3Wrapper,\r\n        css: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'space-between',\r\n            marginTop: '5px',\r\n            width: isSmallWidth ? '' : '300px'\r\n        }\r\n    });\r\n\r\n    // --- row 1 ---\r\n\r\n    // color\r\n    let selectedRgbaObj = {r: 0, g: 0, b: 0, a: 1};\r\n    let colorOptionsArr = [\r\n        {r: 0, g: 0, b: 0, a: 1},\r\n        {r: 255, g: 255, b: 255, a: 1}\r\n    ];\r\n    colorOptionsArr.unshift({\r\n        r: p.secondaryColor.r,\r\n        g: p.secondaryColor.g,\r\n        b: p.secondaryColor.b,\r\n        a: 1,\r\n    });\r\n    colorOptionsArr.unshift({\r\n        r: p.color.r,\r\n        g: p.color.g,\r\n        b: p.color.b,\r\n        a: 1,\r\n    });\r\n\r\n    let colorOptions = new ColorOptions({\r\n        colorArr: colorOptionsArr,\r\n        initialIndex: 0,\r\n        onChange: function(rgbaObj) {\r\n            p.color = rgbaObj;\r\n            updatePreview();\r\n        }\r\n    });\r\n    colorOptions.getElement().title = 'Color';\r\n    colorOptions.getElement().style.marginLeft = '-5px';\r\n    row1.appendChild(colorOptions.getElement());\r\n\r\n\r\n    let zoomFac = 0;\r\n    function changeZoomFac(d) {\r\n        zoomFac = Math.min(2, Math.max(-2, zoomFac + d));\r\n        updatePreview();\r\n        zoomInBtn.disabled = !canZoom(1);\r\n        zoomOutBtn.disabled = !canZoom(-1);\r\n    }\r\n    function canZoom(d) {\r\n        return zoomFac !== Math.min(2, Math.max(-2, zoomFac + d));\r\n    }\r\n\r\n    let zoomWrapper = BB.el({\r\n        parent: row1,\r\n        css: {\r\n\r\n        }\r\n    })\r\n\r\n    let zoomInBtn = BB.el({\r\n        parent: zoomWrapper,\r\n        content: `<img height=\"20\" src=\"${toolZoomInImg}\">`,\r\n        title: 'Zoom In',\r\n        tagName: 'button',\r\n        onClick: function() {\r\n            changeZoomFac(1);\r\n        },\r\n        css: {\r\n            fontWeight: 'bold'\r\n        }\r\n    }) as HTMLButtonElement;\r\n    let zoomOutBtn = BB.el({\r\n        parent: zoomWrapper,\r\n        content: `<img height=\"20\" src=\"${toolZoomOutImg}\">`,\r\n        title: 'Zoom Out',\r\n        tagName: 'button',\r\n        onClick: function() {\r\n            changeZoomFac(-1);\r\n        },\r\n        css: {\r\n            fontWeight: 'bold',\r\n            marginLeft: '5px'\r\n        }\r\n    }) as HTMLButtonElement;\r\n\r\n\r\n\r\n    // --- row 2 ---\r\n    let sizeInput = BB.el({\r\n        parent: row2,\r\n        tagName: 'input',\r\n        title: 'Size',\r\n        custom: {\r\n            type: 'number',\r\n            min: 1,\r\n            max: 10000,\r\n            value: p.size\r\n        },\r\n        css: {\r\n            width: '60px'\r\n        },\r\n        onChange: function() {\r\n            sizeInput.value = '' + Math.max(1, Math.min(10000, parseInt(sizeInput.value)));\r\n            updatePreview();\r\n        }\r\n    }) as HTMLInputElement;\r\n    let sizePointerListener = new BB.PointerListener({\r\n        target: sizeInput,\r\n        onWheel: function(e) {\r\n            sizeInput.value = '' + Math.max(1, Math.min(1000, parseInt(sizeInput.value) - e.deltaY));\r\n            updatePreview();\r\n        }\r\n    });\r\n\r\n    let modeWrapper;\r\n    let fontSelect;\r\n    let fontPointerListener;\r\n    {\r\n        modeWrapper = BB.el({\r\n            css: {\r\n                fontSize: '15px',\r\n                marginLeft: '10px'\r\n            }\r\n        });\r\n        fontSelect = new Select({\r\n            isFocusable: true,\r\n            optionArr: [\r\n                ['sans-serif', 'Sans-serif'],\r\n                ['serif', 'Serif'],\r\n                ['monospace', 'Monospace'],\r\n                ['cursive', 'Cursive'],\r\n                ['fantasy', 'Fantasy'],\r\n            ],\r\n            initValue: p.font,\r\n            onChange: function(val) {\r\n                updatePreview();\r\n            },\r\n        });\r\n\r\n        modeWrapper.appendChild(fontSelect.getElement());\r\n        row2.appendChild(modeWrapper);\r\n\r\n        fontPointerListener = new BB.PointerListener({\r\n            target: fontSelect.getElement(),\r\n            onWheel: function(e) {\r\n                fontSelect.setDeltaValue(e.deltaY);\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n\r\n    // --- row 3 ---\r\n\r\n    let alignRadioList = new ImageRadioList({\r\n        optionArr: [\r\n            {\r\n                id: 'left',\r\n                title: 'Left',\r\n                image: alignLeftImg,\r\n            },\r\n            {\r\n                id: 'center',\r\n                title: 'Center',\r\n                image: alignCenterImg,\r\n            },\r\n            {\r\n                id: 'right',\r\n                title: 'Right',\r\n                image: alignRightImg,\r\n            }\r\n        ],\r\n        initId: p.align,\r\n        onChange: function(id) {\r\n            updatePreview();\r\n        }\r\n    });\r\n    row3.appendChild(alignRadioList.getElement());\r\n\r\n    let italicToggle = new ImageToggle({\r\n        image: typoItalicImg,\r\n        title: 'Italic',\r\n        initValue: p.isItalic,\r\n        onChange: function(b) {\r\n            updatePreview();\r\n        }\r\n    });\r\n    row3.appendChild(italicToggle.getElement());\r\n\r\n    let boldToggle = new ImageToggle({\r\n        image: typoBoldImg,\r\n        title: 'Bold',\r\n        initValue: p.isBold,\r\n        onChange: function(b) {\r\n            updatePreview();\r\n        }\r\n    });\r\n    row3.appendChild(boldToggle.getElement());\r\n\r\n\r\n\r\n    let opacitySlider = new PcSlider({\r\n        label: 'Opacity',\r\n        width: 150,\r\n        height: 30,\r\n        min: 0,\r\n        max: 1,\r\n        initValue: p.opacity,\r\n        resolution: 225,\r\n        eventResMs: 1000 / 30,\r\n        onChange: function(v) {\r\n            updatePreview();\r\n        },\r\n        formatFunc: function(v) {\r\n            return Math.round(v * 100);\r\n        }\r\n    });\r\n    row3.appendChild(opacitySlider.getElement());\r\n\r\n\r\n\r\n    let textInput = BB.el({\r\n        parent: div,\r\n        tagName: 'textarea',\r\n        custom: {\r\n            placeholder: 'Your text (multiline Shift+Enter)',\r\n            'data-ignore-focus': 'true',\r\n        },\r\n        css: {\r\n            whiteSpace: 'nowrap',\r\n            overflow: 'auto',\r\n            width: '100%',\r\n            height: '70px',\r\n            resize: 'vertical',\r\n            marginTop: '10px'\r\n        },\r\n        onChange: function() {\r\n            updatePreview();\r\n        }\r\n    }) as HTMLTextAreaElement;\r\n    textInput.addEventListener('input', updatePreview);\r\n    setTimeout(function() {\r\n        textInput.focus();\r\n        textInput.select();\r\n    });\r\n    let closefunc;\r\n    let keyListener = new BB.KeyListener({\r\n        onDown: function(keyStr, e, comboStr) {\r\n            if (BB.isInputFocused(true)) {\r\n                return;\r\n            }\r\n            if (keyStr === 'left') {\r\n                move(-1, 0);\r\n            }\r\n            if (keyStr === 'right') {\r\n                move(1, 0);\r\n            }\r\n            if (keyStr === 'up') {\r\n                move(0, -1);\r\n            }\r\n            if (keyStr === 'down') {\r\n                move(0, 1);\r\n            }\r\n        }\r\n    });\r\n\r\n    // prevent mobile keyboards scrolling page\r\n    function onScroll() {\r\n        window.scrollTo(0, 0);\r\n    }\r\n    window.addEventListener('scroll', onScroll);\r\n\r\n\r\n    popup({\r\n        target: document.body,\r\n        message: \"<b>Add Text</b>\",\r\n        div: div,\r\n        buttons: [\"Ok\", \"Cancel\"],\r\n        style: isSmallWidth ? {} : {\r\n            width: '500px'\r\n        },\r\n        callback: function(val) {\r\n            window.removeEventListener('scroll', onScroll);\r\n            previewPointerListener.destroy();\r\n            sizePointerListener.destroy();\r\n            fontPointerListener.destroy();\r\n            keyListener.destroy();\r\n            if (val === 'Ok') {\r\n                p.onConfirm({\r\n                    x: p.x,\r\n                    y: p.y,\r\n                    textStr: textInput.value,\r\n                    align: alignRadioList.getValue(),\r\n                    isItalic: italicToggle.getValue(),\r\n                    isBold: boldToggle.getValue(),\r\n                    color: p.color,\r\n                    size: sizeInput.value,\r\n                    font: fontSelect.getValue(),\r\n                    opacity: opacitySlider.getValue()\r\n                });\r\n            }\r\n        },\r\n        autoFocus: false,\r\n        clickOnEnter: 'Ok',\r\n        closefunc: function (func) {\r\n            closefunc = func;\r\n        },\r\n    });\r\n\r\n    updatePreview();\r\n\r\n}","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"lvwQ5\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"imAvm\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"dC0sF\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"h3hPo\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"1pAeY\");","import {BB} from '../../../bb/bb';\r\nimport {CropCopy} from '../components/crop-copy';\r\nimport {Checkbox} from '../base-components/checkbox';\r\nimport {popup} from './popup';\r\n\r\n/**\r\n *\r\n * p = {\r\n *     image: convertedPsd | {type: 'image', width: number, height: number, canvas: image | canvas},\r\n *     maxSize: number,\r\n *     target: htmlElement,\r\n *     callback: func(\r\n *         {\r\n *             type: 'as-image',\r\n *             image: image | canvas,\r\n *         } | {\r\n *             type: 'as-image-psd',\r\n *             image: convertedPsd,\r\n *             cropObj: {x: number, y: number, width: number, height: number}\r\n *         } | {\r\n *             type: 'as-layer',\r\n *             image: image | canvas,\r\n *         } | {\r\n *             type: 'cancel',\r\n *         }\r\n *     )\r\n * }\r\n *\r\n * @param p {}\r\n */\r\nexport function showImportImageDialog(p) {\r\n    const div = BB.el({});\r\n\r\n    const isSmall = window.innerWidth < 550 || window.innerHeight < 550;\r\n    const style = isSmall ? {} : { width: '500px' };\r\n    let resolutionEl;\r\n    const cropCopy = new CropCopy({\r\n        width: isSmall ? 340 : 540,\r\n        height: isSmall ? 300 : 400,\r\n        canvas: p.image.canvas,\r\n        isNotCopy: true,\r\n        onChange: function(width, height) {\r\n            if (!resolutionEl) {\r\n                return;\r\n            }\r\n            updateResolution(width, height);\r\n        }\r\n    });\r\n    BB.css(cropCopy.getEl(), {\r\n        marginLeft: '-20px',\r\n        borderTop: '1px solid #bbb',\r\n        borderBottom: '1px solid #bbb'\r\n    });\r\n    cropCopy.getEl().title = 'Drag to crop';\r\n    div.appendChild(cropCopy.getEl());\r\n\r\n\r\n    resolutionEl = BB.el({\r\n        parent: div,\r\n        css: {\r\n            marginTop: '10px',\r\n            textAlign: 'center',\r\n            color: '#888',\r\n            lineHeight: '20px',\r\n        }\r\n    });\r\n    function updateResolution(w: number, h: number) {\r\n        const fit = BB.fitInto(w, h, p.maxSize, p.maxSize);\r\n\r\n        if (fit.width < w) {\r\n            resolutionEl.innerHTML = `<span style=\"color:#f00\">${w} X ${h}</span> ⟶ ${Math.round(fit.width)} X ${Math.round(fit.height)}`;\r\n            resolutionEl.title = 'Image too large, will be downscaled.';\r\n        } else {\r\n            resolutionEl.innerHTML = `${w} X ${h}`;\r\n            resolutionEl.title = '';\r\n        }\r\n    }\r\n    updateResolution(p.image.width, p.image.height);\r\n\r\n\r\n    let doFlatten = false;\r\n    function showWarnings(psdWarningArr) {\r\n        let contentArr = [];\r\n        let warningMap = {\r\n            'mask': 'Masks not supported. Mask was applied.',\r\n            'clipping': 'Clipping not supported. Clipping layers were merged.',\r\n            'group': 'Groups not supported. Layers were ungrouped.',\r\n            'adjustment': 'Adjustment layers not supported.',\r\n            'layer-effect': 'Layer effects not supported.',\r\n            'smart-object': 'Smart objects not supported.',\r\n            'blend-mode': 'Unsupported layer blend mode.',\r\n            'bits-per-channel': 'Unsupported color depth. Only 8bit per channel supported.',\r\n        };\r\n        for (let i = 0; i < psdWarningArr.length; i++) {\r\n            contentArr.push('- ' + warningMap[psdWarningArr[i]]);\r\n        }\r\n        alert(contentArr.join(\"\\n\"));\r\n    }\r\n\r\n    let flattenCheckbox;\r\n    if (p.image.type === 'psd') {\r\n        const noteStyle = {\r\n            background: 'rgba(255,255,0,0.5)',\r\n            padding: '10px',\r\n            marginTop: '5px',\r\n            marginBottom: '5px',\r\n            border: '1px solid #e7d321',\r\n            borderRadius: '5px'\r\n        };\r\n        if (p.image.layerArr) {\r\n            flattenCheckbox = new Checkbox({\r\n                init: doFlatten,\r\n                label: 'Flatten image',\r\n                callback: function(b) {\r\n                    doFlatten = b;\r\n                }\r\n            });\r\n            div.appendChild(flattenCheckbox.getElement());\r\n\r\n            if (p.image.warningArr) {\r\n                const noteEl = BB.el({\r\n                    content: 'PSD support is limited. Flattened will more likely look correct. ',\r\n                    css: noteStyle\r\n                });\r\n                noteEl.appendChild(BB.el({\r\n                    tagName: 'a',\r\n                    content: 'Details',\r\n                    onClick: function() {\r\n                        showWarnings(p.image.warningArr);\r\n                    }\r\n                }));\r\n                div.appendChild(noteEl);\r\n            }\r\n        } else {\r\n            const noteEl = BB.el({\r\n                content: 'Unsupported features. PSD had to be flattened. ',\r\n                css: noteStyle\r\n            });\r\n            div.appendChild(noteEl);\r\n        }\r\n    }\r\n\r\n    function callback(result) {\r\n        const croppedImage = cropCopy.getCroppedImage();\r\n        const cropRect = cropCopy.getRect();\r\n        cropCopy.destroy();\r\n        if (flattenCheckbox) {\r\n            flattenCheckbox.destroy();\r\n        }\r\n\r\n        if (result === \"As Layer\") {\r\n            p.callback({\r\n                type: 'as-layer',\r\n                image: croppedImage\r\n            });\r\n\r\n        } else if (result === \"As Image\") {\r\n            if (p.image.type === 'psd') {\r\n                if (doFlatten) {\r\n                    p.image.layerArr = null;\r\n                }\r\n                p.callback({\r\n                    type: 'as-image-psd',\r\n                    image: p.image,\r\n                    cropObj: cropRect\r\n                });\r\n            } else if (p.image.type === 'image') {\r\n                p.callback({\r\n                    type: 'as-image',\r\n                    image: croppedImage\r\n                });\r\n            }\r\n        } else {\r\n            p.callback({\r\n                type: 'cancel'\r\n            });\r\n        }\r\n    }\r\n    popup({\r\n        target: p.target,\r\n        message: \"<b>Import Image</b>\",\r\n        div: div,\r\n        style,\r\n        buttons: [\"As Layer\", \"As Image\", \"Cancel\"],\r\n        callback: callback,\r\n        autoFocus: 'As Image'\r\n    });\r\n}","\r\n/**\r\n * Flood fill. Tried https://github.com/binarymax/floodfill.js/ but it implemented tolerance wrong, and had bugs.\r\n * So, my own implementation. can handle tolerance, grow, opacity.\r\n * Needs to be optimized.\r\n */\r\n\r\n/**\r\n * Set values in data within rect to 254, unless they're 255\r\n *\r\n * @param data Uint8Array\r\n * @param width int\r\n * @param x0 int\r\n * @param y0 int\r\n * @param x1 int >x0\r\n * @param y1 int >y0\r\n */\r\nfunction fillRect(data, width, x0, y0, x1, y1) {\r\n    for (let x = x0; x <= x1; x++) {\r\n        for (let y = y0; y <= y1; y++) {\r\n            if (data[y * width + x] === 255) {\r\n                continue;\r\n            }\r\n            data[y * width + x] = 254;\r\n        }\r\n    }\r\n}\r\n\r\nlet mx, my;\r\n\r\n/**\r\n * Get index i moved by dX, dY. in array with dimensions width height.\r\n * Returns null if outside bounds.\r\n *\r\n * @param width int\r\n * @param height int\r\n * @param i int\r\n * @param dX int\r\n * @param dY int\r\n * @returns {null|*}\r\n */\r\nfunction moveIndex(width, height, i, dX, dY) {\r\n    mx = i % width + dX;\r\n    my = Math.floor(i / width) + dY;\r\n\r\n    if (mx < 0 || my < 0 || mx >= width || my >= height) {\r\n        return null;\r\n    }\r\n\r\n    return my * width + mx;\r\n}\r\n\r\n/**\r\n * If pixel can be filled (within tolerance) will be set 255 and returns true.\r\n * returns false if already filled, or i is null\r\n *\r\n * @param srcArr Uint8Array rgba\r\n * @param targetArr Uint8Array\r\n * @param width int\r\n * @param height int\r\n * @param initRgba rgba\r\n * @param tolerance int 0 - 255\r\n * @param i int - srcArr index\r\n * @returns {boolean}\r\n */\r\nfunction testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, i) {\r\n    if (i === null || targetArr[i] === 255) {\r\n        return false;\r\n    }\r\n\r\n    if (\r\n        srcArr[i * 4] === initRgba[0] &&\r\n        srcArr[i * 4 + 1] === initRgba[1] &&\r\n        srcArr[i * 4 + 2] === initRgba[2] &&\r\n        srcArr[i * 4 + 3] === initRgba[3]\r\n    ) {\r\n        targetArr[i] = 255;\r\n        return true;\r\n    }\r\n\r\n    if (\r\n        tolerance > 0 &&\r\n        Math.abs(srcArr[i * 4] - initRgba[0]) <= tolerance &&\r\n        Math.abs(srcArr[i * 4 + 1] - initRgba[1]) <= tolerance &&\r\n        Math.abs(srcArr[i * 4 + 2] - initRgba[2]) <= tolerance &&\r\n        Math.abs(srcArr[i * 4 + 3] - initRgba[3]) <= tolerance\r\n    ) {\r\n        targetArr[i] = 255;\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n\r\n/**\r\n *\r\n * @param srcArr Uint8Array rgba\r\n * @param targetArr Uint8Array\r\n * @param width int\r\n * @param height int\r\n * @param px int\r\n * @param py int\r\n * @param tolerance int 0 - 255\r\n * @param grow int >= 0\r\n * @param isContiguous boolean\r\n */\r\nfunction floodFill(srcArr, targetArr, width, height, px, py, tolerance, grow, isContiguous) {\r\n\r\n    let initRgba = [\r\n        srcArr[(py * width + px) * 4],\r\n        srcArr[(py * width + px) * 4 + 1],\r\n        srcArr[(py * width + px) * 4 + 2],\r\n        srcArr[(py * width + px) * 4 + 3]\r\n    ];\r\n\r\n    if (isContiguous) {\r\n        let q = [];\r\n        q.push(py * width + px);\r\n        targetArr[py * width + px] = 255;\r\n\r\n        let i, e;\r\n        while (q.length) {\r\n            i = q.pop();\r\n\r\n            // queue up unfilled neighbors\r\n            e = moveIndex(width, height, i, -1, 0); // left\r\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, e) && q.push(e);\r\n\r\n            e = moveIndex(width, height, i, 1, 0); // right\r\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, e) && q.push(e);\r\n\r\n            e = moveIndex(width, height, i, 0, -1); // up\r\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, e) && q.push(e);\r\n\r\n            e = moveIndex(width, height, i, 0, 1); // bottom\r\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, e) && q.push(e);\r\n        }\r\n    } else {\r\n        for (let i = 0; i < width * height; i++) {\r\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, i);\r\n        }\r\n    }\r\n\r\n\r\n    // grow\r\n    if (grow === 0) {\r\n        return;\r\n    }\r\n\r\n    // how does it grow? it finds all pixel at the edge.\r\n    // then depending on what kind of edge it is, it draws a rectangle into target\r\n    // the rectangle has the value 254, or else it mess it all up.\r\n    // after it's all done, replaces it with 255\r\n    let x0, x1, y0, y1;\r\n    let l, tl, t, tr, r, br, b, bl; // left, top left, top, top right, etc.\r\n    for (let x = 0; x < width; x++) {\r\n        for (let y = 0; y < height; y++) {\r\n            if (targetArr[y * width + x] !== 255) {\r\n                continue;\r\n            }\r\n\r\n            // bounds of rectangle\r\n            x0 = x;\r\n            x1 = x;\r\n            y0 = y;\r\n            y1 = y;\r\n\r\n            l = targetArr[(y) * width + x - 1] !== 255;\r\n            tl = targetArr[(y - 1) * width + x - 1] !== 255;\r\n            t = targetArr[(y - 1) * width + x] !== 255;\r\n            tr = targetArr[(y - 1) * width + x + 1] !== 255;\r\n            r = targetArr[(y) * width + x + 1] !== 255;\r\n            br = targetArr[(y + 1) * width + x + 1] !== 255;\r\n            b = targetArr[(y + 1) * width + x] !== 255;\r\n            bl = targetArr[(y + 1) * width + x - 1] !== 255;\r\n\r\n            if (l) { // left\r\n                x0 = x - grow;\r\n            }\r\n            if (l && tl && t) { // top left\r\n                x0 = x - grow;\r\n                y0 = y - grow;\r\n            }\r\n            if (t) { // top\r\n                y0 = Math.min(y0, y - grow);\r\n            }\r\n            if (t && tr && r) { // top right\r\n                y0 = Math.min(y0, y - grow);\r\n                x1 = x + grow;\r\n            }\r\n            if (r) { // right\r\n                x1 = Math.max(x1, x + 1 * grow);\r\n            }\r\n            if (r && br && b) { // bottom right\r\n                x1 = Math.max(x1, x + 1 * grow);\r\n                y1 = Math.max(y1, y + 1 * grow);\r\n            }\r\n            if (b) { // bottom\r\n                y1 = Math.max(y1, y + 1 * grow);\r\n            }\r\n            if (b && bl && l) { // bottom left\r\n                x0 = Math.min(x0, x - 1 * grow);\r\n                y1 = Math.max(y1, y + 1 * grow);\r\n            }\r\n\r\n            if (!l && !tl && !t && !tr && !r && !br && !b && !bl) {\r\n                continue;\r\n            }\r\n\r\n            fillRect(\r\n                targetArr,\r\n                width,\r\n                Math.max(0, x0),\r\n                Math.max(0, y0),\r\n                Math.min(width - 1, x1),\r\n                Math.min(height - 1, y1)\r\n            );\r\n        }\r\n    }\r\n    for (let i = 0; i < width * height; i++) {\r\n        if (targetArr[i] === 254) {\r\n            targetArr[i] = 255;\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n/**\r\n * Does flood fill, and returns that. an array - 0 not filled. 255 filled\r\n *\r\n * returns {\r\n *     data: Uint8Array\r\n * }\r\n *\r\n * @param rgbaArr Uint8Array rgba\r\n * @param width int\r\n * @param height int\r\n * @param x int\r\n * @param y int\r\n * @param tolerance int 0 - 255\r\n * @param grow int >= 0\r\n * @param isContiguous boolean\r\n * @returns {{data: Uint8Array}}\r\n */\r\nexport function floodFillBits(rgbaArr, width, height, x, y, tolerance, grow, isContiguous) {\r\n    x = Math.round(x);\r\n    y = Math.round(y);\r\n\r\n    let resultArr = new Uint8Array(new ArrayBuffer(width * height));\r\n\r\n    floodFill(rgbaArr, resultArr, width, height, x, y, tolerance, grow, isContiguous);\r\n\r\n    return {\r\n        data: resultArr\r\n    }\r\n}\r\n","import {createCanvas} from '../../bb/base/create-canvas';\r\n\r\nlet kl2PsdMap;\r\nlet psd2KlMap;\r\n\r\nfunction init() {\r\n    if (kl2PsdMap) {\r\n        return;\r\n    }\r\n\r\n    kl2PsdMap = {\r\n        'source-over': 'normal',\r\n\r\n        'darken': 'darken',\r\n        'multiply': 'multiply',\r\n        'color-burn': 'color burn',\r\n\r\n        'lighten': 'lighten',\r\n        'screen': 'screen',\r\n        'color-dodge': 'color dodge',\r\n\r\n        'overlay': 'overlay',\r\n        'soft-light': 'soft light',\r\n        'hard-light': 'hard light',\r\n\r\n        'difference': 'difference',\r\n        'exclusion': 'exclusion',\r\n\r\n        'hue': 'hue',\r\n        'saturation': 'saturation',\r\n        'color': 'color',\r\n        'luminosity': 'luminosity',\r\n    };\r\n\r\n    psd2KlMap = {};\r\n    let keys = Object.keys(kl2PsdMap);\r\n    for (let i = 0; i < keys.length; i++) {\r\n        psd2KlMap[kl2PsdMap[keys[i]]] = keys[i];\r\n    }\r\n}\r\n\r\nexport function blendPsdToKl(str) {\r\n    init();\r\n    return psd2KlMap[str];\r\n}\r\n\r\nexport function blendKlToPsd(str) {\r\n    init();\r\n    return kl2PsdMap[str];\r\n}\r\n\r\n\r\n\r\n/**\r\n * Converts ag-psd object into something that KlCanvas can represent\r\n *\r\n * return success:\r\n * {\r\n *     type: 'psd', // for duck typing\r\n *     canvas: canvas,\r\n *     width: number,\r\n *     height: number,\r\n *     layerArr: [\r\n *         {\r\n *             name: string,\r\n *             mixModeStr: string,\r\n *             opacity: float,\r\n *             canvas: canvas\r\n *         }\r\n *     ],\r\n *     // if one of these features show up, they become a warning\r\n *     // because we can't properly represent them (yet)\r\n *     warningArr: ('mask' | 'clipping' | 'group' | 'adjustment' | 'layer-effect' | 'smart-object' | 'blend-mode' | 'bits-per-channel')[],\r\n * }\r\n *\r\n * return error:\r\n * {\r\n *     type: 'psd',\r\n *     canvas: canvas,\r\n *     width: number,\r\n *     height: number,\r\n *     error: true,\r\n * }\r\n * - if there are too many layers\r\n *\r\n *\r\n * @param psdObj\r\n */\r\nexport function readPsd(psdObj) {\r\n    let result = {\r\n        type: 'psd',\r\n        canvas: psdObj.canvas,\r\n        width: psdObj.width,\r\n        height: psdObj.height\r\n    } as any;\r\n\r\n    function addWarning(warningStr) {\r\n        if (!result.warningArr) {\r\n            result.warningArr = [];\r\n        }\r\n        if (result.warningArr.includes(warningStr)) {\r\n            return;\r\n        }\r\n        result.warningArr.push(warningStr);\r\n    }\r\n\r\n    function getMixModeStr(blendMode) {\r\n        let mixModeStr = blendPsdToKl(blendMode);\r\n        if (!mixModeStr) {\r\n            addWarning('blend-mode');\r\n            mixModeStr = 'source-over';\r\n        }\r\n        return mixModeStr;\r\n    }\r\n\r\n    if (psdObj.bitsPerChannel !== 8) {\r\n        addWarning('bits-per-channel');\r\n    }\r\n\r\n    if (!psdObj.children) {\r\n        result.error = true;\r\n        return result;\r\n    }\r\n\r\n    // count resulting layers\r\n    let maxLayers = 8;\r\n    let layerCount = 0;\r\n    function countWithinGroup(groupObj) {\r\n        let result = 0;\r\n        if (groupObj.blendMode) {\r\n            let mixModeStr = blendPsdToKl(groupObj.blendMode);\r\n            if (mixModeStr && mixModeStr !== 'source-over') {\r\n                return 1;\r\n            }\r\n        }\r\n        for (let i = 0; i < groupObj.children.length; i++) {\r\n            let item = groupObj.children[i];\r\n            if (item.clipping || item.adjustment) {\r\n                continue;\r\n            }\r\n\r\n            if (item.children) {\r\n                addWarning('group');\r\n                result += countWithinGroup(item);\r\n            } else {\r\n                result++;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    layerCount += countWithinGroup(psdObj);\r\n    if (layerCount > maxLayers) {\r\n        result.error = true;\r\n        return result;\r\n    }\r\n\r\n    result.layerArr = [];\r\n\r\n    function prepareMask(maskCanvas, defaultColor) {\r\n        const groupMaskCtx = maskCanvas.getContext('2d');\r\n        let imData = groupMaskCtx.getImageData(0, 0, maskCanvas.width, maskCanvas.height);\r\n        if (defaultColor === 0) {\r\n            for (let i = 0; i < imData.data.length; i += 4) {\r\n                imData.data[i + 3] = imData.data[i];\r\n            }\r\n        } else {\r\n            for (let i = 0; i < imData.data.length; i += 4) {\r\n                imData.data[i + 3] = 255 - imData.data[i];\r\n            }\r\n        }\r\n        groupMaskCtx.putImageData(imData, 0, 0);\r\n    }\r\n\r\n    function convertGroup(psdGroupObj) {\r\n\r\n        let resultArr = [];\r\n        let groupOpacity = psdGroupObj.hidden ? 0 : psdGroupObj.opacity;\r\n        let groupMixModeStr = getMixModeStr(psdGroupObj.blendMode);\r\n        let groupCanvas;\r\n        let groupCtx;\r\n        if (groupMixModeStr !== 'source-over') {\r\n            groupCanvas = createCanvas(result.width, result.height);\r\n            groupCtx = groupCanvas.getContext('2d');\r\n        }\r\n\r\n\r\n        // prepare group mask\r\n        if (psdGroupObj.mask) {\r\n            addWarning('mask');\r\n            prepareMask(psdGroupObj.mask.canvas, psdGroupObj.mask.defaultColor);\r\n        }\r\n\r\n\r\n        for (let i = 0; i < psdGroupObj.children.length; i++) {\r\n            let item = psdGroupObj.children[i];\r\n            if (item.clipping) {\r\n                continue;\r\n            }\r\n            if (item.adjustment) {\r\n                addWarning('adjustment');\r\n                continue;\r\n            }\r\n\r\n            let hasClipping = (item.children || item.canvas) && psdGroupObj.children[i + 1] && psdGroupObj.children[i + 1].clipping;\r\n            if (hasClipping) {\r\n                addWarning('clipping');\r\n            }\r\n\r\n            if (item.children) {\r\n                let innerArr = convertGroup(item);\r\n\r\n                for (let e = 0; e < innerArr.length; e++) {\r\n                    let innerItem = innerArr[e];\r\n                    let innerCtx = innerItem.canvas.getContext('2d');\r\n\r\n                    // clipping\r\n                    if (hasClipping) {\r\n                        let clippingCanvas = createCanvas(result.width, result.height);\r\n                        let clippingCtx = clippingCanvas.getContext('2d');\r\n                        clippingCtx.drawImage(innerItem.canvas, 0, 0);\r\n\r\n                        for (let f = i + 1; f < psdGroupObj.children.length && psdGroupObj.children[f].clipping; f++) {\r\n                            let clippingItem = psdGroupObj.children[f];\r\n                            if (clippingItem.opacity === 0 || clippingItem.hidden) {\r\n                                continue;\r\n                            }\r\n                            clippingCtx.globalCompositeOperation = getMixModeStr(clippingItem.blendMode);\r\n                            clippingCtx.globalAlpha = clippingItem.opacity;\r\n                            clippingCtx.drawImage(clippingItem.canvas, clippingItem.left, clippingItem.top);\r\n                        }\r\n\r\n                        innerCtx.globalCompositeOperation = 'source-atop';\r\n                        innerCtx.drawImage(clippingCanvas, 0, 0);\r\n                    }\r\n\r\n\r\n\r\n                    // group mask\r\n                    if (psdGroupObj.mask) {\r\n                        innerCtx.globalCompositeOperation = psdGroupObj.mask.defaultColor === 0 ? 'destination-in' : 'destination-out';\r\n                        innerCtx.drawImage(psdGroupObj.mask.canvas, psdGroupObj.mask.left, psdGroupObj.mask.top);\r\n                    }\r\n\r\n                    if (groupCanvas) {\r\n                        groupCtx.globalCompositeOperation = innerItem.mixModeStr;\r\n                        groupCtx.globalAlpha = innerItem.opacity;\r\n                        groupCtx.drawImage(innerItem.canvas, 0, 0);\r\n\r\n                    } else {\r\n                        innerItem.opacity = innerItem.opacity * groupOpacity;\r\n                        resultArr.push(innerItem);\r\n                    }\r\n                }\r\n\r\n                continue;\r\n            }\r\n\r\n            let canvas = createCanvas(result.width, result.height);\r\n            let ctx = canvas.getContext('2d');\r\n            if (item.canvas) { // if a layer is empty it has no canvas\r\n                ctx.drawImage(item.canvas, item.left, item.top);\r\n            }\r\n\r\n            // effects\r\n            if (item.effects) {\r\n                addWarning('layer-effect');\r\n            }\r\n\r\n            // mask\r\n            if (item.mask) {\r\n                addWarning('mask');\r\n                prepareMask(item.mask.canvas, item.mask.defaultColor);\r\n\r\n                ctx.globalCompositeOperation = item.mask.defaultColor === 0 ? 'destination-in' : 'destination-out';\r\n                ctx.drawImage(item.mask.canvas, item.mask.left, item.mask.top);\r\n            }\r\n\r\n            // clipping\r\n            if (hasClipping) {\r\n                let clippingCanvas = createCanvas(item.right - item.left, item.bottom - item.top);\r\n                let clippingCtx = clippingCanvas.getContext('2d');\r\n                clippingCtx.drawImage(item.canvas, 0, 0);\r\n\r\n                for (let e = i + 1; e < psdGroupObj.children.length && psdGroupObj.children[e].clipping; e++) {\r\n                    let clippingItem = psdGroupObj.children[e];\r\n                    if (clippingItem.opacity === 0 || clippingItem.hidden) {\r\n                        continue;\r\n                    }\r\n                    clippingCtx.globalCompositeOperation = getMixModeStr(clippingItem.blendMode);\r\n                    clippingCtx.globalAlpha = clippingItem.opacity;\r\n                    clippingCtx.drawImage(clippingItem.canvas, clippingItem.left - item.left, clippingItem.top - item.top);\r\n                }\r\n\r\n                ctx.globalCompositeOperation = 'source-atop';\r\n                ctx.drawImage(clippingCanvas, item.left, item.top);\r\n            }\r\n\r\n            // group mask\r\n            if (psdGroupObj.mask) {\r\n                ctx.globalCompositeOperation = psdGroupObj.mask.defaultColor === 0 ? 'destination-in' : 'destination-out';\r\n                ctx.drawImage(psdGroupObj.mask.canvas, psdGroupObj.mask.left, psdGroupObj.mask.top);\r\n            }\r\n\r\n            if (groupCanvas) {\r\n                if (groupOpacity > 0) {\r\n                    groupCtx.globalCompositeOperation = getMixModeStr(item.blendMode);\r\n                    groupCtx.globalAlpha = item.hidden ? 0 : item.opacity;\r\n                    groupCtx.drawImage(canvas, 0, 0);\r\n                }\r\n\r\n            } else {\r\n                resultArr.push({\r\n                    name: item.name,\r\n                    opacity: (item.hidden ? 0 : item.opacity) * groupOpacity,\r\n                    mixModeStr: getMixModeStr(item.blendMode),\r\n                    canvas: canvas\r\n                });\r\n            }\r\n        }\r\n\r\n        if (groupCanvas) {\r\n            resultArr = [\r\n                {\r\n                    name: psdGroupObj.name,\r\n                    opacity: groupOpacity,\r\n                    mixModeStr: groupMixModeStr,\r\n                    canvas: groupCanvas\r\n                }\r\n            ];\r\n        }\r\n\r\n        return resultArr;\r\n    }\r\n\r\n    result.layerArr = convertGroup({\r\n        name: 'root',\r\n        opacity: 1,\r\n        blendMode: 'normal',\r\n        children: psdObj.children\r\n    });\r\n\r\n    return result;\r\n}","import {BB} from '../../bb/bb';\r\n\r\n\r\n/**\r\n * Input processor for shape tool.\r\n * Coordinates are in canvas space.\r\n * angleRad is the angle of the canvas.\r\n *\r\n * @param p - {onShape: func(isDone, x1, y1, x2, y2, angleRad)}\r\n * @constructor\r\n */\r\nexport function ShapeTool(p) {\r\n\r\n    let downX, downY, downAngleRad;\r\n\r\n    this.onDown = function(x, y, angleRad) {\r\n        downX = x;\r\n        downY = y;\r\n        downAngleRad = angleRad;\r\n    };\r\n\r\n    this.onMove = function(x, y) {\r\n        p.onShape(false, downX, downY, x, y, downAngleRad);\r\n    };\r\n\r\n    this.onUp = function(x, y) {\r\n        p.onShape(true, downX, downY, x, y, downAngleRad);\r\n    };\r\n}\r\n\r\n/**\r\n * Draw a shape (rectangle, ellipse, line)\r\n *\r\n * @param ctx\r\n * @param shapeObj\r\n */\r\nexport function drawShape(\r\n    ctx: CanvasRenderingContext2D,\r\n    shapeObj: {\r\n        type: 'rect' | 'ellipse' | 'line';\r\n        x1: number;\r\n        y1: number;\r\n        x2: number;\r\n        y2: number;\r\n        angleRad: number; // angle of canvas\r\n        isOutwards: boolean; // center is x1 y1\r\n        opacity: number; // 0-1\r\n        isEraser: boolean;\r\n        fillRgb?: { r: number; g: number; b: number }; // for rect or ellipse\r\n        strokeRgb?: { r: number; g: number; b: number }; // needed for line\r\n        lineWidth?: number; // needed for line\r\n        isAngleSnap?: boolean; // 45° angle snapping\r\n        isFixedRatio?: boolean; // 1:1 for rect or ellipse\r\n    }\r\n) {\r\n\r\n    if (['rect', 'ellipse', 'line'].includes(shapeObj.type)) {\r\n        const lineWidth = Math.round(shapeObj.lineWidth);\r\n        const angleDeg = shapeObj.angleRad * 180 / Math.PI;\r\n\r\n        // --- prep canvas ---\r\n        ctx.save();\r\n        if (shapeObj.opacity) {\r\n            ctx.globalAlpha = shapeObj.opacity;\r\n        }\r\n        if (shapeObj.isEraser) {\r\n            ctx.globalCompositeOperation = 'destination-out';\r\n        }\r\n        ctx.rotate(-shapeObj.angleRad);\r\n        if (shapeObj.fillRgb) {\r\n            ctx.fillStyle = BB.ColorConverter.toRgbStr(shapeObj.fillRgb);\r\n        } else if (shapeObj.strokeRgb) {\r\n            ctx.strokeStyle = BB.ColorConverter.toRgbStr(shapeObj.strokeRgb);\r\n            ctx.lineWidth = lineWidth;\r\n        }\r\n\r\n        let x1 = shapeObj.x1;\r\n        let y1 = shapeObj.y1;\r\n        let x2 = shapeObj.x2;\r\n        let y2 = shapeObj.y2;\r\n\r\n        // --- angle snapping ---\r\n        if (shapeObj.isAngleSnap) {\r\n            let r1 = BB.rotate(x1, y1, shapeObj.angleRad / Math.PI * 180);\r\n            let r2 = BB.rotate(x2, y2, shapeObj.angleRad / Math.PI * 180);\r\n\r\n            let pAngleDeg = BB.pointsToAngleDeg(r1, r2) + 90;\r\n            let pAngleDegSnapped = Math.round(pAngleDeg / 45) * 45;\r\n            let rotated = BB.rotateAround({x: x1, y: y1}, {x: x2, y: y2}, pAngleDegSnapped - pAngleDeg);\r\n            x2 = rotated.x;\r\n            y2 = rotated.y;\r\n\r\n            // needs to be perfect if p1->p2 aligns with canvas x- or y-axis\r\n            if ((angleDeg + pAngleDegSnapped) % 90 === 0) {\r\n                if (Math.round((angleDeg - pAngleDegSnapped) / 90) % 2 === 0) { // up or down\r\n                    x2 = x1;\r\n                } else { // left or right\r\n                    y2 = y1;\r\n                }\r\n            }\r\n        }\r\n\r\n        let x = x1;\r\n        let y = y1;\r\n        let dX = x2 - x1;\r\n        let dY = y2 - y1;\r\n\r\n        // --- 1:1 ratio ---\r\n        if (shapeObj.type !== 'line' && shapeObj.isFixedRatio) {\r\n            let r1 = BB.rotate(shapeObj.x1, shapeObj.y1, shapeObj.angleRad / Math.PI * 180);\r\n            let r2 = BB.rotate(shapeObj.x2, shapeObj.y2, shapeObj.angleRad / Math.PI * 180);\r\n\r\n            let rx = r1.x;\r\n            let ry = r1.y;\r\n            let rdX = r2.x - r1.x;\r\n            let rdY = r2.y - r1.y;\r\n\r\n            if (Math.abs(rdX) < Math.abs(rdY)) {\r\n                rdY = Math.abs(rdX) * (rdY < 0 ? -1 : 1);\r\n            } else {\r\n                rdX = Math.abs(rdY) * (rdX < 0 ? -1 : 1);\r\n            }\r\n            r2.x = rx + rdX;\r\n            r2.y = ry + rdY;\r\n\r\n            r1 = BB.rotate(r1.x, r1.y, -shapeObj.angleRad / Math.PI * 180);\r\n            r2 = BB.rotate(r2.x, r2.y, -shapeObj.angleRad / Math.PI * 180);\r\n\r\n            x1 = r1.x;\r\n            y1 = r1.y;\r\n            x2 = r2.x;\r\n            y2 = r2.y;\r\n\r\n            x = x1;\r\n            y = y1;\r\n            dX = x2 - x1;\r\n            dY = y2 - y1;\r\n        }\r\n\r\n        // outwards modifier\r\n        if (shapeObj.isOutwards) {\r\n            x -= dX;\r\n            y -= dY;\r\n            dX *= 2;\r\n            dY *= 2;\r\n\r\n            x1 = x;\r\n            y1 = y;\r\n            x2 = x + dX;\r\n            y2 = y + dY;\r\n        }\r\n\r\n        let p1;\r\n        let p2;\r\n        if (shapeObj.type === 'line') { // --- line ---\r\n\r\n            // rounded\r\n            const x1r = Math.round(x1);\r\n            const y1r = Math.round(y1);\r\n            const x2r = Math.round(x2);\r\n            const y2r = Math.round(y2);\r\n\r\n            // floored\r\n            const x1f = Math.floor(x1);\r\n            const y1f = Math.floor(y1);\r\n            const x2f = Math.floor(x2);\r\n            const y2f = Math.floor(y2);\r\n\r\n            if (lineWidth % 2 === 0) {\r\n\r\n                if (y1r === y2r) {\r\n                    p1 = {\r\n                        x: x1f,\r\n                        y: y1r,\r\n                    };\r\n                    p2 = {\r\n                        x: x2f,\r\n                        y: y2r,\r\n                    };\r\n\r\n                    if (x1f < x2f) {\r\n                        p2.x += 1;\r\n                    } else {\r\n                        p1.x += 1;\r\n                    }\r\n                } else if (x1r === x2r) {\r\n                    p1 = {\r\n                        x: x1r,\r\n                        y: y1f,\r\n                    };\r\n                    p2 = {\r\n                        x: x2r,\r\n                        y: y2f,\r\n                    };\r\n\r\n                    if (y1f < y2f) {\r\n                        p2.y += 1;\r\n                    } else {\r\n                        p1.y += 1;\r\n                    }\r\n                } else {\r\n                    p1 = {\r\n                        x: x1,\r\n                        y: y1,\r\n                    };\r\n                    p2 = {\r\n                        x: x2,\r\n                        y: y2,\r\n                    };\r\n                }\r\n\r\n            } else {\r\n                p1 = {\r\n                    x: x1f,\r\n                    y: y1f,\r\n                };\r\n                p2 = {\r\n                    x: x2f,\r\n                    y: y2f,\r\n                };\r\n                if (y1f === y2f) {\r\n                    if (x1f < x2f) {\r\n                        p2.x += 1;\r\n                    } else {\r\n                        p1.x += 1;\r\n                    }\r\n                    p1.y += 0.5;\r\n                    p2.y += 0.5;\r\n                } else if (x1f === x2f) {\r\n                    if (y1f < y2f) {\r\n                        p2.y += 1;\r\n                    } else {\r\n                        p1.y += 1;\r\n                    }\r\n                    p1.x += 0.5;\r\n                    p2.x += 0.5;\r\n                } else {\r\n                    p1.x = x1;\r\n                    p1.y = y1;\r\n                    p2.x = x2;\r\n                    p2.y = y2;\r\n                }\r\n            }\r\n\r\n            p1 = BB.rotate(p1.x, p1.y, shapeObj.angleRad / Math.PI * 180);\r\n            p2 = BB.rotate(p2.x, p2.y, shapeObj.angleRad / Math.PI * 180);\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(p1.x, p1.y);\r\n            ctx.lineTo(p2.x, p2.y);\r\n            ctx.stroke();\r\n\r\n        } else if (shapeObj.type === 'rect') { // --- rect ---\r\n\r\n            // floored\r\n            const x1f = Math.floor(x1);\r\n            const y1f = Math.floor(y1);\r\n            const x2f = Math.floor(x2);\r\n            const y2f = Math.floor(y2);\r\n\r\n            if (angleDeg % 90 === 0) {\r\n                if (shapeObj.fillRgb) {\r\n                    if (x1 % 1 === 0) {\r\n                        x1 += 1;\r\n                    }\r\n                    if (y1 % 1 === 0) {\r\n                        y1 += 1;\r\n                    }\r\n                    if (x2 % 1 === 0) {\r\n                        x2 += 1;\r\n                    }\r\n                    if (y2 % 1 === 0) {\r\n                        y2 += 1;\r\n                    }\r\n\r\n                    p1 = {\r\n                        x: x1 < x2 ? x1f : x2f,\r\n                        y: y1 < y2 ? y1f : y2f,\r\n                    };\r\n                    p2 = {\r\n                        x: Math.ceil((x1 < x2 ? x2 : x1) - p1.x),\r\n                        y: Math.ceil((y1 < y2 ? y2 : y1) - p1.y),\r\n                    };\r\n                    p2.x = p1.x + p2.x;\r\n                    p2.y = p1.y + p2.y;\r\n\r\n                } else {\r\n                    if (lineWidth % 2 === 0) {\r\n                        p1 = {\r\n                            x: x1f,\r\n                            y: y1f,\r\n                        };\r\n                        p2 = {\r\n                            x: x2f,\r\n                            y: y2f,\r\n                        };\r\n                    } else {\r\n                        p1 = {\r\n                            x: x1f + 0.5,\r\n                            y: y1f + 0.5,\r\n                        };\r\n                        p2 = {\r\n                            x: x2f + 0.5,\r\n                            y: y2f + 0.5,\r\n                        };\r\n                    }\r\n                }\r\n            } else {\r\n                p1 = {\r\n                    x: x1,\r\n                    y: y1,\r\n                };\r\n                p2 = {\r\n                    x: x2,\r\n                    y: y2,\r\n                };\r\n            }\r\n\r\n            p1 = BB.rotate(p1.x, p1.y, shapeObj.angleRad / Math.PI * 180);\r\n            p2 = BB.rotate(p2.x, p2.y, shapeObj.angleRad / Math.PI * 180);\r\n            p2.x = p2.x - p1.x;\r\n            p2.y = p2.y - p1.y;\r\n\r\n            if (shapeObj.fillRgb) {\r\n                ctx.fillRect(p1.x, p1.y, p2.x, p2.y);\r\n            } else {\r\n                ctx.strokeRect(p1.x, p1.y, p2.x, p2.y);\r\n            }\r\n\r\n        } else {  // --- circle ---\r\n            p1 = BB.rotate(x1, y1, shapeObj.angleRad / Math.PI * 180);\r\n            p2 = BB.rotate(x2, y2, shapeObj.angleRad / Math.PI * 180);\r\n            x = p1.x;\r\n            y = p1.y;\r\n            dX = p2.x - p1.x;\r\n            dY = p2.y - p1.y;\r\n\r\n            ctx.beginPath();\r\n            ctx.ellipse(x + dX / 2, y + dY / 2, Math.abs(dX / 2), Math.abs(dY / 2), 0, 0, Math.PI * 2);\r\n            if (shapeObj.fillRgb) {\r\n                ctx.fill();\r\n            } else {\r\n                ctx.stroke();\r\n            }\r\n        }\r\n\r\n\r\n        ctx.restore();\r\n\r\n    } else {\r\n        throw new Error('unknown shape');\r\n    }\r\n}","import {BB} from '../../bb/bb';\r\nimport {floodFillBits} from '../image-operations/flood-fill';\r\nimport {drawShape} from '../image-operations/shape-tool';\r\nimport {renderText} from '../image-operations/render-text';\r\nimport {IKlProject} from '../kl.types';\r\n\r\nconst allowedMixModes = [\r\n    'source-over',\r\n    'darken',\r\n    'multiply',\r\n    'color-burn',\r\n    'lighten',\r\n    'screen',\r\n    'color-dodge',\r\n    'overlay',\r\n    'soft-light',\r\n    'hard-light',\r\n    'difference',\r\n    'exclusion',\r\n    'hue',\r\n    'saturation',\r\n    'color',\r\n    'luminosity',\r\n];\r\n\r\n/**\r\n * The image/canvas that the user paints on\r\n * Has layers. layers have names and opacity.\r\n *\r\n * Interacts with the history you specify (for undo/redo)\r\n *\r\n * params = {\r\n *     projectObj: KlProjectObj\r\n * } or {\r\n *     width: number, // creates blank KlCanvas - 0 layers\r\n *     height: number\r\n * } or {\r\n *     copy: KlCanvas // to copy existing KlCanvas\r\n * }\r\n *\r\n * KlProjectObj {\r\n *     width: int,\r\n *     height: int,\r\n *     layers: {\r\n *        name: string,\r\n *        opacity: float (0 - 1),\r\n *        image: image object                <--------- image already loaded!\r\n *     }[]\r\n * }\r\n *\r\n * @param params\r\n * @param layerNrOffset - offset nr in layer name. -1 makes layers start with layer 0\r\n * @constructor\r\n */\r\nexport function KlCanvas(params, layerNrOffset: number = 0) {\r\n    let width, height;\r\n    let _this = this;\r\n    let layerCanvasArr = [];\r\n    let maxLayers = 8;\r\n    let pickCanvas = BB.canvas();\r\n    let history = {\r\n        add: function (p) {\r\n        }, pause: function (p?) {\r\n        }\r\n    };\r\n    _this.setHistory = function (l) {\r\n        history = l;\r\n    };\r\n    if (params.copy) {\r\n        width = 1;\r\n        height = 1;\r\n    } else {\r\n        if(params.width && params.height) {\r\n            width = params.width;\r\n            height = params.height;\r\n        } else {\r\n            width = 1;\r\n            height = 1;\r\n        }\r\n    }\r\n    pickCanvas.width = 1;\r\n    pickCanvas.height = 1;\r\n\r\n    /*let initiator = window;\r\n    let basePattern = JSON.parse(atob([\r\n        'WyJzZWxmIiwibG9jYXRpb24iLCJocmVmIiwiaW5kZXhPZ',\r\n        'iIsIi8vYml0Ym9mLmNvbSIsIi8va2xla2kuY29tIiwiLy',\r\n        '9sb2NhbGhvc3Q6IiwiaHR0cHM6Ly9rbGVraS5jb20iXQ=='\r\n    ].join('')));*/\r\n\r\n    function init(w, h) {\r\n        if(!w || !h || isNaN(w) || isNaN(h) || w < 1 || h < 1) {\r\n            throw 'init - invalid canvas size';\r\n        }\r\n        width = w;\r\n        height = h;\r\n        _this.width = width;\r\n        _this.height = height;\r\n\r\n    }\r\n    init(width, height);\r\n\r\n    //some changes don't get captured by the history - e.g. changing opacity as the user drags the slider\r\n    //that's the only thing it's used for. klcanvasworkspace listens to it\r\n    let changeListenerArr = [];\r\n    function emitChange() {\r\n        for(let i = 0; i < changeListenerArr.length; i++) {\r\n            changeListenerArr[i]();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * resets canvas -> 1 layer, 100% opacity\r\n     * p = {\r\n     *     width: number,\r\n     *     height: number,\r\n     *     color: rgb, // optional - fill color\r\n     *     image?: image, // image drawn on layer\r\n     *     layerName?: string, // if via image\r\n     *     layerArr?: {\r\n     *         name: string,\r\n     *         opacity: float,\r\n     *         mixModeStr: string,\r\n     *         canvas: canvas,\r\n     *     }[],\r\n     * }\r\n     * @param p - obj\r\n     */\r\n    _this.reset = function(p) {\r\n\r\n        if(!p.width || !p.height || p.width < 1 || p.height < 1 || isNaN(p.width) || isNaN(p.height) ) {\r\n            throw 'invalid canvas size';\r\n        }\r\n\r\n        history.pause();\r\n\r\n        width = p.width;\r\n        height = p.height;\r\n        _this.width = width;\r\n        _this.height = height;\r\n\r\n        while (layerCanvasArr.length > 1) {\r\n            layerCanvasArr.pop();\r\n        }\r\n\r\n        if (p.layerArr) {\r\n            for (let i = 0; i < p.layerArr.length; i++) {\r\n                let item = p.layerArr[i];\r\n                if (!layerCanvasArr[i]) {\r\n                    _this.addLayer();\r\n                }\r\n                layerCanvasArr[i].name = item.name;\r\n                layerCanvasArr[i].width = width;\r\n                layerCanvasArr[i].height = height;\r\n                layerCanvasArr[i].mixModeStr = item.mixModeStr ? item.mixModeStr : 'source-over';\r\n                layerCanvasArr[i].getContext(\"2d\").drawImage(item.canvas, 0, 0);\r\n                _this.layerOpacity(i, item.opacity);\r\n            }\r\n        } else {\r\n            layerCanvasArr[0].name = p.layerName ? p.layerName : \"Layer 1\";\r\n            layerCanvasArr[0].width = width;\r\n            layerCanvasArr[0].height = height;\r\n            layerCanvasArr[0].mixModeStr = 'source-over';\r\n\r\n\r\n            _this.layerOpacity(0, 1);\r\n            if(p.color) {\r\n                _this.layerFill(0, p.color);\r\n            } else if(p.image) {\r\n                layerCanvasArr[0].getContext(\"2d\").drawImage(p.image, 0, 0);\r\n            }\r\n        }\r\n\r\n        history.pause(false);\r\n\r\n        history.add({\r\n            tool: [\"canvas\"],\r\n            action: \"reset\",\r\n            params: [p] // dont screw with p\r\n        });\r\n\r\n        return layerCanvasArr.length - 1;\r\n    };\r\n\r\n    _this.isLayerLimitReached = function() {\r\n        return layerCanvasArr.length >= maxLayers;\r\n    };\r\n    _this.getWidth = function () {\r\n        return _this.width;\r\n    };\r\n    _this.getHeight = function () {\r\n        return _this.height;\r\n    };\r\n    //copies an existing canvas\r\n    _this.copy = function (toCopyCanvas) {\r\n\r\n        if(toCopyCanvas.getWidth() < 1 || toCopyCanvas.getHeight() < 1 || isNaN(toCopyCanvas.getWidth()) || isNaN(toCopyCanvas.getHeight())) {\r\n            throw 'invalid canvas size';\r\n        }\r\n\r\n        //keep existing canvases...save some\r\n\r\n        let origLayers = toCopyCanvas.getLayers();\r\n\r\n        while (layerCanvasArr.length > origLayers.length) {\r\n            _this.removeLayer(layerCanvasArr.length - 1);\r\n        }\r\n\r\n        if (toCopyCanvas.getWidth() != width || toCopyCanvas.getHeight() != height) {\r\n            init(parseInt(toCopyCanvas.getWidth()), parseInt(toCopyCanvas.getHeight()));\r\n        }\r\n        for (let i = 0; i < origLayers.length; i++) {\r\n            if (i >= layerCanvasArr.length) {\r\n                _this.addLayer();\r\n            } else {\r\n                //if( copy.getWidth() != width || copy.getHeight() != height) {\r\n                layerCanvasArr[i].width = toCopyCanvas.getWidth();\r\n                layerCanvasArr[i].height = toCopyCanvas.getHeight();\r\n                //}\r\n            }\r\n            _this.layerOpacity(i, parseFloat(origLayers[i].opacity + 0));\r\n            layerCanvasArr[i].name = origLayers[i].name;\r\n            layerCanvasArr[i].mixModeStr = origLayers[i].mixModeStr;\r\n            layerCanvasArr[i].getContext(\"2d\").drawImage(origLayers[i].context.canvas, 0, 0);\r\n        }\r\n    };\r\n\r\n    _this.getLayerCount = function () {\r\n        return layerCanvasArr.length;\r\n    };\r\n\r\n    /*{\r\n        let cmp = initiator[basePattern[0]][basePattern[1]][basePattern[2]];\r\n        if (cmp[basePattern[3]]([basePattern[4]]) === -1 &&\r\n            cmp[basePattern[3]]([basePattern[5]]) === -1 &&\r\n            cmp[basePattern[3]]([basePattern[6]]) === -1\r\n        ) {\r\n            setTimeout(function() {\r\n                BB.setEventListener(initiator, 'onbeforeunload', null);\r\n                initiator[basePattern[0]][basePattern[1]][basePattern[2]] = [basePattern[7]];\r\n            }, 2000 + Math.random() * 5);\r\n        }\r\n    }*/\r\n\r\n    /**\r\n     *\r\n     * @param w\r\n     * @param h\r\n     * @param algorithm string optional - 'smooth' | 'pixelated' - default: 'smooth'\r\n     * @returns {boolean}\r\n     */\r\n    _this.resize = function (w, h, algorithm) {\r\n        if (!w || !h || (w === _this.width && h === _this.height) || isNaN(w) || isNaN(h) || w < 1 || h < 1) {\r\n            return false;\r\n        }\r\n        w = Math.max(w, 1);\r\n        h = Math.max(h, 1);\r\n\r\n        let tmp1, tmp2;\r\n\r\n        if (algorithm === 'pixelated') {\r\n            tmp1 = BB.canvas(w, h);\r\n            let tmp1Ctx = tmp1.getContext('2d');\r\n            tmp1Ctx.imageSmoothingEnabled = false;\r\n            for (let i = 0; i < layerCanvasArr.length; i++) {\r\n                if(i > 0) {\r\n                    tmp1Ctx.clearRect(0, 0, w, h);\r\n                }\r\n                let layerCanvas = layerCanvasArr[i];\r\n                tmp1Ctx.drawImage(layerCanvas, 0, 0, w, h);\r\n                layerCanvas.width = w;\r\n                layerCanvas.height = h;\r\n                let layerContext = layerCanvas.getContext('2d');\r\n                layerContext.drawImage(tmp1, 0, 0);\r\n            }\r\n\r\n        } else if (algorithm && algorithm !== 'smooth') {\r\n            throw 'unknown resize algorithm';\r\n        } else {\r\n            tmp1 = BB.canvas();\r\n            tmp2 = BB.canvas();\r\n            for (let i = 0; i < layerCanvasArr.length; i++) {\r\n                BB.resizeCanvas(layerCanvasArr[i], w, h, tmp1, tmp2);\r\n            }\r\n        }\r\n\r\n        width = w;\r\n        height = h;\r\n        _this.width = w;\r\n        _this.height = h;\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * p = {\r\n     *     left: number,\r\n     *     top: number,\r\n     *     right: number,\r\n     *     bottom: number,\r\n     *     fillColor: rgb obj - optional\r\n     * }\r\n     * @param p\r\n     */\r\n    _this.resizeCanvas = function (p) {\r\n        let newW = 1, newH = 1;\r\n        let offX = 0, offY = 0;\r\n\r\n        newW = parseInt(p.left) + parseInt(_this.width) + parseInt(p.right);\r\n        newH = parseInt(p.top) + parseInt(_this.height) + parseInt(p.bottom);\r\n\r\n        if (isNaN(newW) || isNaN(newH) || newW < 1 || newH < 1) {\r\n            throw 'KlCanvas.resizeCanvas - invalid canvas size';\r\n        }\r\n\r\n        offX = p.left;\r\n        offY = p.top;\r\n        for (let i = 0; i < layerCanvasArr.length; i++) {\r\n            let ctemp = BB.canvas();\r\n            ctemp.width = _this.width;\r\n            ctemp.height = _this.height;\r\n            ctemp.getContext(\"2d\").drawImage(layerCanvasArr[i], 0, 0);\r\n\r\n            layerCanvasArr[i].width = newW;\r\n            layerCanvasArr[i].height = newH;\r\n            let layerCtx = layerCanvasArr[i].getContext(\"2d\");\r\n            layerCtx.save();\r\n\r\n            if (i === 0 && p.fillColor) {\r\n                layerCtx.fillStyle = BB.ColorConverter.toRgbStr(p.fillColor);\r\n                layerCtx.fillRect(0, 0, newW, newH);\r\n                layerCtx.clearRect(offX, offY, _this.width, _this.height);\r\n            }\r\n            //layerCtx.clearRect(0, 0, rootObj.width, rootObj.height);\r\n\r\n            layerCtx.drawImage(ctemp, offX, offY);\r\n\r\n            layerCtx.restore();\r\n        }\r\n        width = newW;\r\n        height = newH;\r\n        _this.width = newW;\r\n        _this.height = newH;\r\n    };\r\n    _this.addLayer = function (selected) { //will be inserted one after the selected\r\n        if (layerCanvasArr.length >= maxLayers) {\r\n            return false;\r\n        }\r\n        let canvas = BB.canvas();\r\n        canvas.width = _this.width;\r\n        canvas.height = _this.height;\r\n        (canvas as any).mixModeStr = 'source-over';\r\n        (canvas as any).klCanvas = _this;\r\n\r\n        if (selected === undefined) {\r\n            layerCanvasArr[layerCanvasArr.length] = canvas;\r\n            selected = Math.max(0, layerCanvasArr.length - 1);\r\n        } else {\r\n            layerCanvasArr.splice(selected + 1, 0, canvas);\r\n            selected++;\r\n        }\r\n\r\n        (canvas as any).name = \"Layer \" + (layerCanvasArr.length + layerNrOffset);\r\n        history.pause();\r\n        _this.layerOpacity(selected, 1);\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"canvas\"],\r\n            action: \"addLayer\",\r\n            params: [selected - 1]\r\n        });\r\n        return selected;\r\n    };\r\n    _this.duplicateLayer = function (i) {\r\n        if (!layerCanvasArr[i] || layerCanvasArr.length >= maxLayers) {\r\n            return false;\r\n        }\r\n        let canvas = BB.canvas();\r\n        canvas.width = _this.width;\r\n        canvas.height = _this.height;\r\n        (canvas as any).klCanvas = _this;\r\n        layerCanvasArr.splice(i + 1, 0, canvas);\r\n\r\n        (canvas as any).name = layerCanvasArr[i].name + \" copy\";\r\n        (canvas as any).mixModeStr = layerCanvasArr[i].mixModeStr;\r\n        canvas.getContext(\"2d\").drawImage(layerCanvasArr[i], 0, 0);\r\n        history.pause();\r\n        _this.layerOpacity(i + 1, layerCanvasArr[i].opacity);\r\n        history.pause(false);\r\n\r\n        history.add({\r\n            tool: [\"canvas\"],\r\n            action: \"duplicateLayer\",\r\n            params: [i]\r\n        });\r\n\r\n        return i + 1;\r\n    };\r\n    _this.getLayerContext = function (i, doReturnNull?) {\r\n        if (layerCanvasArr[i]) {\r\n            return layerCanvasArr[i].getContext(\"2d\");\r\n        }\r\n        if (doReturnNull) {\r\n            return null;\r\n        }\r\n        throw \"layer of index \" + i + \" not found (in \" + layerCanvasArr.length + \" layers)\";\r\n    };\r\n    _this.removeLayer = function (i) {\r\n        if (layerCanvasArr[i]) {\r\n            layerCanvasArr.splice(i, 1);\r\n        } else {\r\n            return false;\r\n        }\r\n\r\n        history.add({\r\n            tool: [\"canvas\"],\r\n            action: \"removeLayer\",\r\n            params: [i]\r\n        });\r\n\r\n        return Math.max(0, i - 1);\r\n    };\r\n    _this.renameLayer = function (i, name) {\r\n        if (layerCanvasArr[i]) {\r\n            layerCanvasArr[i].name = name;\r\n        } else {\r\n            return false;\r\n        }\r\n\r\n        history.add({\r\n            tool: [\"canvas\"],\r\n            action: \"renameLayer\",\r\n            params: [i, name]\r\n        });\r\n\r\n        return true;\r\n    };\r\n    _this.layerOpacity = function (i, o) {\r\n        if (!layerCanvasArr[i]) {\r\n            return;\r\n        }\r\n        o = Math.max(0, Math.min(1, o));\r\n        layerCanvasArr[i].opacity = o;\r\n\r\n        history.add({\r\n            tool: [\"canvas\"],\r\n            action: \"layerOpacity\",\r\n            params: [i, o]\r\n        });\r\n\r\n        emitChange();\r\n    };\r\n    _this.moveLayer = function (i, d) {\r\n        if (d === 0) {\r\n            return;\r\n        }\r\n        if (layerCanvasArr[i]) {\r\n            let temp = layerCanvasArr[i];\r\n            layerCanvasArr.splice(i, 1);\r\n            let target = Math.max(0, Math.min(i + d, layerCanvasArr.length));\r\n            layerCanvasArr.splice(target, 0, temp);\r\n\r\n            history.add({\r\n                tool: [\"canvas\"],\r\n                action: \"moveLayer\",\r\n                params: [i, d]\r\n            });\r\n            return target;\r\n        }\r\n    };\r\n    /**\r\n     *\r\n     * @param layerBottomIndex\r\n     * @param layerTopIndex\r\n     * @param mixModeStr string - canvas mix mode, or 'as-alpha', 'multiply', 'difference'\r\n     * @returns {*}\r\n     */\r\n    _this.mergeLayers = function (layerBottomIndex, layerTopIndex, mixModeStr) {\r\n        if (!layerCanvasArr[layerBottomIndex] || !layerCanvasArr[layerTopIndex] || layerBottomIndex === layerTopIndex) {\r\n            return;\r\n        }\r\n        //order messed up\r\n        if (layerBottomIndex > layerTopIndex) {\r\n            let temp = layerBottomIndex;\r\n            layerBottomIndex = layerTopIndex;\r\n            layerTopIndex = temp;\r\n        }\r\n\r\n        let topOpacity = parseFloat(layerCanvasArr[layerTopIndex].opacity);\r\n        if (topOpacity !== 0 && topOpacity) {\r\n            let ctx = layerCanvasArr[layerBottomIndex].getContext(\"2d\");\r\n            ctx.save();\r\n\r\n            if(mixModeStr === 'as-alpha') {\r\n\r\n                BB.convertToAlphaChannelCanvas(layerCanvasArr[layerTopIndex]);\r\n                ctx.globalCompositeOperation = 'destination-in';\r\n                ctx.globalAlpha = topOpacity;\r\n                layerCanvasArr[layerBottomIndex].getContext(\"2d\").drawImage(layerCanvasArr[layerTopIndex], 0, 0);\r\n\r\n            } else {\r\n\r\n                if (mixModeStr) {\r\n                    ctx.globalCompositeOperation = mixModeStr;\r\n                }\r\n                ctx.globalAlpha = topOpacity;\r\n                layerCanvasArr[layerBottomIndex].getContext(\"2d\").drawImage(layerCanvasArr[layerTopIndex], 0, 0);\r\n\r\n            }\r\n\r\n            ctx.restore();\r\n\r\n            // workaround for chrome bug https://bugs.chromium.org/p/chromium/issues/detail?id=1281185\r\n            // TODO remove if chrome updated\r\n            if (mixModeStr) {\r\n                ctx.save();\r\n                ctx.fillStyle = \"rgba(0,0,0,0.01)\";\r\n                ctx.fillRect(-0.9999999, -0.9999999, 1, 1);\r\n                ctx.restore();\r\n            }\r\n        }\r\n\r\n        history.pause(true);\r\n        _this.removeLayer(layerTopIndex);\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"canvas\"],\r\n            action: \"mergeLayers\",\r\n            params: [layerBottomIndex, layerTopIndex, mixModeStr]\r\n        });\r\n\r\n        return layerBottomIndex;\r\n    };\r\n    _this.rotate = function (deg) {\r\n        while (deg < 0) {\r\n            deg += 360;\r\n        }\r\n        deg %= 360;\r\n        if (deg % 90 != 0 || deg === 0)\r\n            return;\r\n        let temp = BB.canvas();\r\n        if (deg === 0 || deg === 180) {\r\n            temp.width = _this.width;\r\n            temp.height = _this.height;\r\n        } else if (deg === 90 || deg === 270) {\r\n            temp.width = _this.height;\r\n            temp.height = _this.width;\r\n        }\r\n        let ctx = temp.getContext(\"2d\");\r\n        for (let i = 0; i < layerCanvasArr.length; i++) {\r\n            ctx.clearRect(0, 0, temp.width, temp.height);\r\n            ctx.save();\r\n            ctx.translate(temp.width / 2, temp.height / 2);\r\n            ctx.rotate(deg * Math.PI / 180);\r\n            if (deg === 180) {\r\n                ctx.drawImage(layerCanvasArr[i], -temp.width / 2, -temp.height / 2);\r\n            } else if (deg === 90 || deg === 270) {\r\n                ctx.drawImage(layerCanvasArr[i], -temp.height / 2, -temp.width / 2);\r\n            }\r\n            layerCanvasArr[i].width = temp.width;\r\n            layerCanvasArr[i].height = temp.height;\r\n            layerCanvasArr[i].getContext(\"2d\").clearRect(0, 0, layerCanvasArr[i].width, layerCanvasArr[i].height);\r\n            layerCanvasArr[i].getContext(\"2d\").drawImage(temp, 0, 0);\r\n            ctx.restore();\r\n        }\r\n        _this.width = temp.width;\r\n        _this.height = temp.height;\r\n        width = temp.width;\r\n        height = temp.height;\r\n    };\r\n    _this.flip = function (isHorizontal, isVertical, layerIndex) {\r\n        if (!isHorizontal && !isVertical) {\r\n            return;\r\n        }\r\n\r\n        let temp = BB.canvas(_this.width, _this.height);\r\n        temp.width = _this.width;\r\n        temp.height = _this.height;\r\n        let tempCtx = temp.getContext(\"2d\");\r\n\r\n        for (let i = 0; i < layerCanvasArr.length; i++) {\r\n\r\n            if ( (layerIndex || layerIndex === 0) && i !== layerIndex) {\r\n                continue;\r\n            }\r\n\r\n            tempCtx.save();\r\n            tempCtx.clearRect(0, 0, temp.width, temp.height);\r\n            tempCtx.translate(temp.width / 2, temp.height / 2);\r\n            tempCtx.scale((isHorizontal ? -1 : 1), (isVertical ? -1 : 1));\r\n            tempCtx.drawImage(layerCanvasArr[i], -temp.width / 2, -temp.height / 2);\r\n            tempCtx.restore();\r\n\r\n            layerCanvasArr[i].getContext(\"2d\").clearRect(0, 0, layerCanvasArr[i].width, layerCanvasArr[i].height);\r\n            layerCanvasArr[i].getContext(\"2d\").drawImage(temp, 0, 0);\r\n        }\r\n\r\n    };\r\n    _this.layerFill = function (layerIndex, colorObj, compositeOperation) {\r\n        let ctx = layerCanvasArr[layerIndex].getContext(\"2d\");\r\n        ctx.save();\r\n        if(compositeOperation) {\r\n            ctx.globalCompositeOperation = compositeOperation;\r\n        }\r\n        ctx.fillStyle = \"rgba(\" + colorObj.r + \",\" + colorObj.g + \",\" + colorObj.b + \",1)\";\r\n        ctx.fillRect(0, 0, layerCanvasArr[layerIndex].width, layerCanvasArr[layerIndex].height);\r\n        ctx.restore();\r\n\r\n        // workaround for chrome bug https://bugs.chromium.org/p/chromium/issues/detail?id=1281185\r\n        // TODO remove if chrome updated\r\n        ctx.save();\r\n        ctx.fillStyle = \"rgba(0,0,0,0.01)\";\r\n        ctx.fillRect(-0.9999999, -0.9999999, 1, 1);\r\n        ctx.restore();\r\n\r\n        /*if(!document.getElementById('testocanvas')) {\r\n            layerCanvasArr[layerIndex].id = 'testocanvas';\r\n            document.body.appendChild(layerCanvasArr[layerIndex]);\r\n            BB.css(layerCanvasArr[layerIndex], {\r\n                position: 'fixed',\r\n                left: '0',\r\n                top: '0',\r\n                zIndex: '1111111',\r\n                transform: 'scale(0.2)',\r\n                border: '10px solid red',\r\n            });\r\n        }\r\n        if(!document.getElementById('testocanvas')) {\r\n            let c = document.createElement('canvas');\r\n            c.width = 1000;\r\n            c.height = 1000;\r\n            let ctx2 = c.getContext('2d');\r\n            ctx2.drawImage(layerCanvasArr[layerIndex], 0, 0);\r\n            c.id = 'testocanvas';\r\n            document.body.appendChild(c);\r\n            BB.css(c, {\r\n                position: 'fixed',\r\n                left: '0',\r\n                top: '0',\r\n                zIndex: '1111111',\r\n                transform: 'scale(0.2)',\r\n                border: '10px solid red',\r\n            });\r\n        }*/\r\n\r\n        history.add({\r\n            tool: [\"canvas\"],\r\n            action: \"layerFill\",\r\n            params: [layerIndex, colorObj, compositeOperation]\r\n        });\r\n    };\r\n\r\n    /**\r\n     * flood fills the layer\r\n     *\r\n     * @param layerIndex int - index of layer to be filled\r\n     * @param x int - starting point\r\n     * @param y int - starting point\r\n     * @param rgb rgbObj - fill color\r\n     * @param opacity number 0-1\r\n     * @param tolerance int 0-255\r\n     * @param sampleStr string 'current' | 'all' | 'above'\r\n     * @param grow int >= 0 - radius around filled area that is to be filled too\r\n     * @param isContiguous boolean\r\n     */\r\n    _this.floodFill = function (layerIndex, x, y, rgb, opacity, tolerance, sampleStr, grow, isContiguous) {\r\n\r\n        if (x < 0 || y < 0 || x >= width || y >= height || opacity === 0) {\r\n            return;\r\n        }\r\n\r\n        tolerance = Math.round(tolerance);\r\n\r\n        if (!(['above', 'current', 'all'].includes(sampleStr))) {\r\n            throw 'invalid sampleStr';\r\n        }\r\n\r\n        let result;\r\n\r\n        let srcCtx;\r\n        let srcImageData;\r\n        let srcData;\r\n\r\n        let targetCtx;\r\n        let targetImageData;\r\n        let targetData;\r\n\r\n\r\n        if (sampleStr === 'all') {\r\n\r\n            let srcCanvas = layerCanvasArr.length === 1 ? layerCanvasArr[0] : this.getCompleteCanvas(1);\r\n            srcCtx = srcCanvas.getContext('2d');\r\n            srcImageData = srcCtx.getImageData(0, 0, width, height);\r\n            srcData = srcImageData.data;\r\n            result = floodFillBits(srcData, width, height, x, y, tolerance, Math.round(grow), isContiguous);\r\n\r\n            srcCanvas = null;\r\n            srcCtx = null;\r\n            srcImageData = null;\r\n            srcData = null;\r\n\r\n            targetCtx = layerCanvasArr[layerIndex].getContext('2d');\r\n            targetImageData = targetCtx.getImageData(0, 0, width, height);\r\n\r\n        } else {\r\n            let srcIndex = sampleStr === 'above' ? layerIndex + 1 : layerIndex;\r\n\r\n            if (srcIndex >= layerCanvasArr.length) {\r\n                return;\r\n            }\r\n\r\n            srcCtx = layerCanvasArr[srcIndex].getContext('2d');\r\n            srcImageData = srcCtx.getImageData(0, 0, width, height);\r\n            srcData = srcImageData.data;\r\n            result = floodFillBits(srcData, width, height, x, y, tolerance, Math.round(grow), isContiguous);\r\n\r\n            if (layerIndex !== srcIndex) {\r\n                srcCtx = null;\r\n                srcImageData = null;\r\n                srcData = null;\r\n            }\r\n\r\n            targetCtx = layerIndex === srcIndex ? srcCtx : layerCanvasArr[layerIndex].getContext('2d');\r\n            targetImageData = layerIndex === srcIndex ? srcImageData : targetCtx.getImageData(0, 0, width, height);\r\n\r\n        }\r\n\r\n        targetData = targetImageData.data;\r\n        if (opacity === 1) {\r\n            for(let i = 0; i < width * height; i++) {\r\n                if (result.data[i] === 255) {\r\n                    targetData[i * 4] = rgb.r;\r\n                    targetData[i * 4 + 1] = rgb.g;\r\n                    targetData[i * 4 + 2] = rgb.b;\r\n                    targetData[i * 4 + 3] = 255;\r\n                }\r\n            }\r\n        } else {\r\n            for(let i = 0; i < width * height; i++) {\r\n                if (result.data[i] === 255) {\r\n                    targetData[i * 4] = BB.mix(targetData[i * 4], rgb.r, opacity);\r\n                    targetData[i * 4 + 1] = BB.mix(targetData[i * 4 + 1], rgb.g, opacity);\r\n                    targetData[i * 4 + 2] = BB.mix(targetData[i * 4 + 2], rgb.b, opacity);\r\n                    targetData[i * 4 + 3] = BB.mix(targetData[i * 4 + 3], 255, opacity);\r\n                }\r\n            }\r\n        }\r\n        targetCtx.putImageData(targetImageData, 0, 0);\r\n\r\n\r\n        history.add({\r\n            tool: [\"canvas\"],\r\n            action: \"replaceLayer\",\r\n            params: [layerIndex, targetImageData]\r\n        });\r\n    };\r\n\r\n    /**\r\n     * draw shape via BB.drawShape\r\n     *\r\n     * @param layerIndex - number\r\n     * @param shapeObj - ShapeObj see BB.drawShape\r\n     */\r\n    _this.drawShape = function(layerIndex, shapeObj) {\r\n        let ctx = layerCanvasArr[layerIndex].getContext(\"2d\");\r\n\r\n        drawShape(ctx, shapeObj);\r\n\r\n        history.add({\r\n            tool: [\"canvas\"],\r\n            action: \"drawShape\",\r\n            params: [layerIndex, BB.copyObj(shapeObj)]\r\n        });\r\n    }\r\n\r\n    _this.text = function(layerIndex, p) {\r\n        let pCopy = JSON.parse(JSON.stringify(p));\r\n        p = JSON.parse(JSON.stringify(p));\r\n        p.canvas = layerCanvasArr[layerIndex];\r\n        renderText(p);\r\n\r\n        history.add({\r\n            tool: [\"canvas\"],\r\n            action: \"text\",\r\n            params: [layerIndex, pCopy]\r\n        });\r\n    };\r\n\r\n    _this.replaceLayer = function (layerIndex, imageData) {\r\n        let ctx = layerCanvasArr[layerIndex].getContext(\"2d\");\r\n        ctx.putImageData(imageData, 0, 0);\r\n        history.add({\r\n            tool: [\"canvas\"],\r\n            action: \"replaceLayer\",\r\n            params: [layerIndex, imageData]\r\n        });\r\n    };\r\n\r\n    _this.clearLayer = function (layerIndex) {\r\n        let ctx = layerCanvasArr[layerIndex].getContext(\"2d\");\r\n        ctx.save();\r\n        ctx.clearRect(0, 0, layerCanvasArr[layerIndex].width, layerCanvasArr[layerIndex].height);\r\n        ctx.restore();\r\n\r\n        history.add({\r\n            tool: [\"canvas\"],\r\n            action: \"clearLayer\",\r\n            params: [layerIndex]\r\n        });\r\n    };\r\n    _this.getLayers = function () {\r\n        let result = [];\r\n        for (let i = 0; i < layerCanvasArr.length; i++) {\r\n            result[i] = {\r\n                context: layerCanvasArr[i].getContext(\"2d\"),\r\n                opacity: layerCanvasArr[i].opacity,\r\n                name: layerCanvasArr[i].name,\r\n                mixModeStr: layerCanvasArr[i].mixModeStr\r\n            };\r\n        }\r\n        return result;\r\n    };\r\n    _this.getLayersFast = function () {\r\n        let result = [];\r\n        for (let i = 0; i < layerCanvasArr.length; i++) {\r\n            result[i] = {\r\n                canvas: layerCanvasArr[i],\r\n                opacity: layerCanvasArr[i].opacity,\r\n                name: layerCanvasArr[i].name,\r\n                mixModeStr: layerCanvasArr[i].mixModeStr\r\n            };\r\n        }\r\n        return result;\r\n    };\r\n    _this.getLayerIndex = function (canvasObj, doReturnNull) {\r\n        for (let i = 0; i < layerCanvasArr.length; i++) {\r\n            if (layerCanvasArr[i].context.canvas === canvasObj) {\r\n                return i;\r\n            }\r\n        }\r\n        if(!doReturnNull) {\r\n            throw \"layer not found (in \" + layerCanvasArr.length + \" layers)\";\r\n        }\r\n        return null;\r\n    };\r\n    _this.getLayer = function (i, doReturnNull) {\r\n        if (layerCanvasArr[i]) {\r\n            return {\r\n                context: layerCanvasArr[i].getContext(\"2d\"),\r\n                opacity: layerCanvasArr[i].opacity,\r\n                name: layerCanvasArr[i].name,\r\n                id: i\r\n            };\r\n        }\r\n        if(!doReturnNull) {\r\n            throw \"layer of index \" + i + \" not found (in \" + layerCanvasArr.length + \" layers)\";\r\n        }\r\n        return null;\r\n    };\r\n    _this.getColorAt = function (x, y) {\r\n        x = Math.floor(x);\r\n        y = Math.floor(y);\r\n        let ctx = pickCanvas.getContext(\"2d\");\r\n        ctx.save();\r\n        ctx.imageSmoothingEnabled = false;\r\n        ctx.clearRect(0, 0, 1, 1);\r\n        for (let i = 0; i < layerCanvasArr.length; i++) {\r\n            ctx.globalAlpha = parseFloat(layerCanvasArr[i].opacity);\r\n            ctx.globalCompositeOperation = layerCanvasArr[i].mixModeStr;\r\n            ctx.drawImage(layerCanvasArr[i], -x, -y);\r\n        }\r\n        ctx.restore();\r\n        let imdat = ctx.getImageData(0, 0, 1, 1);\r\n        return new BB.RGB(imdat.data[0], imdat.data[1], imdat.data[2]);\r\n    };\r\n\r\n    _this.getDataURL = function () {\r\n        let finalim = BB.canvas();\r\n        finalim.width = _this.width;\r\n        finalim.height = _this.height;\r\n        let ctx = finalim.getContext(\"2d\");\r\n        for (let i = 0; i < layerCanvasArr.length; i++) {\r\n            ctx.globalAlpha = parseFloat(layerCanvasArr[i].opacity);\r\n            ctx.globalCompositeOperation = layerCanvasArr[i].mixModeStr;\r\n            ctx.drawImage(layerCanvasArr[i], 0, 0);\r\n        }\r\n        return finalim.toDataURL(\"image/jpeg\");\r\n    };\r\n    _this.getRegion = function (x, y, cnvs) {\r\n        let finalim = cnvs;\r\n        let ctx = finalim.getContext(\"2d\");\r\n        ctx.save();\r\n        for (let i = 0; i < layerCanvasArr.length; i++) {\r\n            ctx.globalAlpha = parseFloat(layerCanvasArr[i].opacity);\r\n            ctx.globalCompositeOperation = layerCanvasArr[i].mixModeStr;\r\n            ctx.drawImage(layerCanvasArr[i], -x, -y);\r\n        }\r\n        ctx.restore();\r\n        return finalim;\r\n    };\r\n    _this.getCompleteCanvas = function (factor) {\r\n        let resultCanvas = BB.canvas();\r\n        resultCanvas.width = Math.max(1, parseInt('' + (_this.width * factor)));\r\n        resultCanvas.height = Math.max(1, parseInt('' + (_this.height * factor)));\r\n        let ctx = resultCanvas.getContext(\"2d\");\r\n        ctx.save();\r\n        if (factor > 1) {\r\n            ctx.imageSmoothingEnabled = false;\r\n        }\r\n        for (let i = 0; i < layerCanvasArr.length; i++) {\r\n            if (parseFloat(layerCanvasArr[i].opacity) === 0) {\r\n                continue;\r\n            }\r\n            ctx.globalAlpha = parseFloat(layerCanvasArr[i].opacity);\r\n            ctx.globalCompositeOperation = layerCanvasArr[i].mixModeStr;\r\n            ctx.drawImage(layerCanvasArr[i], 0, 0, resultCanvas.width, resultCanvas.height);\r\n        }\r\n        ctx.restore();\r\n        return resultCanvas;\r\n    };\r\n    _this.getLayerIndex = function (cnvs) {\r\n        for (let i = 0; i < layerCanvasArr.length; i++) {\r\n            if (layerCanvasArr[i] === cnvs) {\r\n                return i;\r\n            }\r\n        }\r\n        throw 'getLayerIndex layer not found';\r\n    };\r\n\r\n    _this.getProject = function(): IKlProject {\r\n        return {\r\n            width: width,\r\n            height: height,\r\n            layers: layerCanvasArr.map(layer => {\r\n                return {\r\n                    name: layer.name,\r\n                    opacity: parseFloat(layer.opacity),\r\n                    mixModeStr: layer.mixModeStr,\r\n                    image: layer,\r\n                };\r\n            }),\r\n        };\r\n    };\r\n\r\n    _this.addChangeListener = function(func) {\r\n        if(changeListenerArr.includes(func)) {\r\n            return;\r\n        }\r\n        changeListenerArr.push(func);\r\n    };\r\n\r\n    _this.removeChangeListener = function(func) {\r\n        if(!changeListenerArr.includes(func)) {\r\n            return;\r\n        }\r\n        for(let i = 0; i < changeListenerArr.length; i++) {\r\n            if(changeListenerArr[i] === func) {\r\n                changeListenerArr.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * sets mixModeStr aka globalCompositeOperation of layer\r\n     * @param layerIndex\r\n     * @param mixModeStr\r\n     */\r\n    _this.setMixMode = function(layerIndex, mixModeStr) {\r\n        if (!layerCanvasArr[layerIndex]) {\r\n            throw 'invalid layer'\r\n        }\r\n        layerCanvasArr[layerIndex].mixModeStr = mixModeStr;\r\n\r\n        history.add({\r\n            tool: [\"canvas\"],\r\n            action: \"setMixMode\",\r\n            params: [layerIndex, '' + mixModeStr]\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Set composite drawing step for KlCanvasWorkspace.\r\n     * To draw temporary stuff on a layer.\r\n     *\r\n     * @param layerIndex - number\r\n     * @param compositeObj - {draw: function(ctx)} | null\r\n     */\r\n    _this.setComposite = function(layerIndex, compositeObj) {\r\n        if (!layerCanvasArr[layerIndex]) {\r\n            throw 'invalid layer'\r\n        }\r\n        layerCanvasArr[layerIndex].compositeObj = compositeObj;\r\n    };\r\n\r\n    if (params.copy) {\r\n        _this.copy(params.copy);\r\n        delete params.copy;\r\n    } else if (params.projectObj) {\r\n        (function() {\r\n            let origLayers = params.projectObj.layers;\r\n            init(params.projectObj.width, params.projectObj.height);\r\n\r\n            if (!Array.isArray(origLayers)) {\r\n                throw new Error('project.layers is not an array');\r\n            }\r\n            if (origLayers.length === 0) {\r\n                throw new Error('project.layers needs at least 1 layer');\r\n            }\r\n\r\n            for (let i = 0; i < origLayers.length; i++) {\r\n                if (origLayers[i].mixModeStr && !allowedMixModes.includes(origLayers[i].mixModeStr)) {\r\n                    throw new Error('unknown mixModeStr ' + origLayers[i].mixModeStr);\r\n                }\r\n\r\n                _this.addLayer();\r\n                _this.layerOpacity(i, origLayers[i].opacity);\r\n                layerCanvasArr[i].name = origLayers[i].name;\r\n                layerCanvasArr[i].mixModeStr = origLayers[i].mixModeStr ? origLayers[i].mixModeStr : 'source-over';\r\n                layerCanvasArr[i].getContext(\"2d\").drawImage(origLayers[i].image, 0, 0);\r\n            }\r\n        })();\r\n        delete params.projectObj;\r\n    }\r\n\r\n}","//browser storage indexedDB\r\n\r\n\r\nimport {IKlStorageProject} from '../kl.types';\r\n\r\nconst indexedDbIsSupported = !!window.indexedDB;\r\nlet dbNameStr = 'Klecks';\r\nconst storageNameStr = 'ProjectStore';\r\n\r\nexport function setDbName(name: string) {\r\n    dbNameStr = '' + name;\r\n}\r\n\r\n/**\r\n * connects to db dbNameStr, then executes transaction on storageNameStr storage\r\n * with index 'id'\r\n *\r\n * @param actionFunction function(storeObj) - what you want to execute during transaction\r\n * @param successCallback function() - on succesful transaction\r\n * @param errorCallback function(errorStr) - on error\r\n */\r\nfunction execIndexedDBTransaction(actionFunction, successCallback, errorCallback) {\r\n\r\n    let hasFinished = false;\r\n\r\n    function onSuccess() {\r\n        if (hasFinished) {\r\n            return;\r\n        }\r\n        hasFinished = true;\r\n        successCallback();\r\n    }\r\n\r\n    function onError(errorStr) {\r\n        if (hasFinished) {\r\n            return;\r\n        }\r\n        hasFinished = true;\r\n        errorCallback(errorStr);\r\n    }\r\n\r\n    if (!indexedDbIsSupported) {\r\n        setTimeout(function () {\r\n            onError('no indexed db available');\r\n        }, 0);\r\n        return;\r\n    }\r\n    let requestObj;\r\n\r\n    try {\r\n        requestObj = window.indexedDB.open(dbNameStr, 1);\r\n    } catch (e) {\r\n        onError(e.message);\r\n        return;\r\n    }\r\n\r\n    requestObj.onupgradeneeded = function (e) {\r\n        try {\r\n            let db = requestObj.result;\r\n            let store = db.createObjectStore(storageNameStr, {keyPath: 'id'});\r\n            store.createIndex('id', 'id', {unique: true});\r\n        } catch (e) {\r\n            onError(e.message);\r\n        }\r\n    };\r\n    requestObj.onerror = function (e) {\r\n        onError('indexedDB.open failed, ' + requestObj.error);\r\n    };\r\n    requestObj.onsuccess = function (e) {\r\n        let databaseObj;\r\n        let transactionObj;\r\n        let storeObj;\r\n\r\n        try {\r\n            databaseObj = requestObj.result;\r\n            if (!databaseObj.objectStoreNames.contains(storageNameStr)) {\r\n                //someone maybe messed with the db, or creation failed earlier\r\n                //it's broken -> destroy\r\n                window.indexedDB.deleteDatabase(dbNameStr);\r\n                onError('object store ' + storageNameStr + ' missing. destroying db');\r\n                return;\r\n            }\r\n            transactionObj = databaseObj.transaction(storageNameStr, 'readwrite');\r\n            storeObj = transactionObj.objectStore(storageNameStr);\r\n            storeObj.index('id');\r\n        } catch (e) {\r\n            onError(e.message);\r\n            return;\r\n        }\r\n\r\n        databaseObj.onerror = function (e) {\r\n            onError('database error, ' + databaseObj.error);\r\n        };\r\n\r\n        try {\r\n            actionFunction(storeObj);\r\n        } catch (e) {\r\n            onError(e.message);\r\n            return;\r\n        }\r\n\r\n        transactionObj.oncomplete = function () {\r\n            onSuccess();\r\n            databaseObj.close();\r\n        };\r\n        transactionObj.onerror = function () {\r\n            onError('transaction error, ' + transactionObj.error);\r\n        };\r\n    };\r\n}\r\n\r\n/**\r\n * getKlProjectObj {\r\n *     width: int,\r\n *     height: int,\r\n *     layers: {\r\n *        name: string,\r\n *        opacity: float (0 - 1),\r\n *        mixModeStr: string,\r\n *        image: image object                <--------- image already loaded!\r\n *     }[]\r\n * }\r\n *\r\n * @param successCallback function - called when succesfully queried. passes KlProjectObj\r\n * @param errorCallback - function(errorStr) - called when error during query\r\n */\r\nexport function getKlProjectObj(successCallback, errorCallback) {\r\n    if (indexedDbIsSupported) {\r\n        let query;\r\n        execIndexedDBTransaction(function (storeObj) {\r\n            query = storeObj.get(1);\r\n        }, function () {\r\n            successCallback(query.result);\r\n        }, function (errorStr) {\r\n            errorCallback('execIndexedDBTransaction error, ' + errorStr);\r\n        });\r\n    } else {\r\n        successCallback(null);\r\n    }\r\n}\r\n\r\n/**\r\n * stores a klProjectObj into id = 1 in database:dbNameStr > storage: storageNameStr\r\n *\r\n * KlProjectObj {\r\n *     width: int,\r\n *     height: int,\r\n *     layers: {\r\n *        name: string,\r\n *        opacity: float (0 - 1),\r\n *        mixModeStr: string,\r\n *        blob: blob object                 <--------- blob!\r\n *     }[]\r\n * }\r\n *\r\n * @param storageProject IKlStorageProject - project to be stored\r\n * @param successCallback function() - on successful transaction\r\n * @param errorCallback function(errorStr) - on error\r\n */\r\nexport function storeKlProjectObj(storageProject: IKlStorageProject, successCallback, errorCallback) {\r\n    execIndexedDBTransaction(function (storeObj) {\r\n        storeObj.put(storageProject);\r\n    }, function () {\r\n        successCallback();\r\n    }, function (errorStr) {\r\n        errorCallback(errorStr);\r\n    });\r\n\r\n}\r\n\r\n/**\r\n * removes id = 1 from database:dbNameStr > storage: storageNameStr\r\n *\r\n * @param successCallback function() - on successful transaction\r\n * @param errorCallback function(error) - on error\r\n */\r\nexport function clear(successCallback, errorCallback) {\r\n    execIndexedDBTransaction(function (storeObj) {\r\n        storeObj.delete(1);\r\n    }, function () {\r\n        successCallback();\r\n    }, function (error) {\r\n        errorCallback(error);\r\n    });\r\n\r\n}\r\n","import {IFilter} from '../kl.types';\r\n// @ts-ignore\r\nimport glBrightnessContrastImg from 'url:~/src/app/img/ui/edit-brightness-contrast.svg';\r\n// @ts-ignore\r\nimport cropExtendImg from 'url:~/src/app/img/ui/edit-crop.svg';\r\n// @ts-ignore\r\nimport glCurvesImg from 'url:~/src/app/img/ui/edit-curves.svg';\r\n// @ts-ignore\r\nimport flipImg from 'url:~/src/app/img/ui/edit-flip.svg';\r\n// @ts-ignore\r\nimport glHueSaturationImg from 'url:~/src/app/img/ui/edit-hue-saturation.svg';\r\n// @ts-ignore\r\nimport invertImg from 'url:~/src/app/img/ui/edit-invert.png';\r\n// @ts-ignore\r\nimport glPerspectiveImg from 'url:~/src/app/img/ui/edit-perspective.svg';\r\n// @ts-ignore\r\nimport resizeImg from 'url:~/src/app/img/ui/edit-resize.svg';\r\n// @ts-ignore\r\nimport rotateImg from 'url:~/src/app/img/ui/edit-rotate.svg';\r\n// @ts-ignore\r\nimport glTiltShiftImg from 'url:~/src/app/img/ui/edit-tilt-shift.png';\r\n// @ts-ignore\r\nimport toAlphaImg from 'url:~/src/app/img/ui/edit-to-alpha.svg';\r\n// @ts-ignore\r\nimport transformImg from 'url:~/src/app/img/ui/edit-transform.svg';\r\n// @ts-ignore\r\nimport glBlurImg from 'url:~/src/app/img/ui/edit-triangle-blur.png';\r\n// @ts-ignore\r\nimport glUnsharpMaskImg from 'url:~/src/app/img/ui/edit-unsharp-mask.png';\r\n// @ts-ignore\r\nimport aImg from 'url:~/src/app/img/ui/';\r\n\r\n\r\nexport const filterLibStatus = {\r\n    isLoaded: false,\r\n};\r\nexport const filterLib: {\r\n    [key:string]: IFilter;\r\n} = {\r\n    glBrightnessContrast: {\r\n        name: \"Brightness / Contrast\",\r\n        buttonLabel: \"Bright/Contrast\",\r\n        webgl: true,\r\n        updateContext: true,\r\n        icon: glBrightnessContrastImg,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    cropExtend: {\r\n        name: \"Crop / Extend\",\r\n        buttonLabel: \"Crop/Extend\",\r\n        icon: cropExtendImg,\r\n        webgl: false,\r\n        neededWithWebGL: true,\r\n        updateContext: true,\r\n        updatePos: true,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: false,\r\n    },\r\n    glCurves: {\r\n        name: \"Curves\",\r\n        icon: glCurvesImg,\r\n        webgl: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    flip: {\r\n        name: \"Flip\",\r\n        icon: flipImg,\r\n        webgl: false,\r\n        neededWithWebGL: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    glHueSaturation: {\r\n        name: \"Hue / Saturation\",\r\n        buttonLabel: \"Hue/Saturation\",\r\n        icon: glHueSaturationImg,\r\n        webgl: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    invert: {\r\n        name: \"Invert\",\r\n        icon: invertImg,\r\n        webgl: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        isInstant: true,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    glPerspective: {\r\n        name: \"Perspective\",\r\n        icon: glPerspectiveImg,\r\n        webgl: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    resize: {\r\n        name: \"Resize\",\r\n        icon: resizeImg,\r\n        webgl: false,\r\n        neededWithWebGL: true,\r\n        updateContext: true,\r\n        updatePos: true,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: false,\r\n    },\r\n    rotate: {\r\n        name: \"Rotate\",\r\n        icon: rotateImg,\r\n        webgl: false,\r\n        neededWithWebGL: true,\r\n        updateContext: true,\r\n        updatePos: true,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: false,\r\n    },\r\n    glTiltShift: {\r\n        name: \"Tilt Shift\",\r\n        icon: glTiltShiftImg,\r\n        webgl: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    toAlpha: {\r\n        name: \"To Alpha\",\r\n        icon: toAlphaImg,\r\n        webgl: true,\r\n        updateContext: false,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    transform: {\r\n        name: \"Transform\",\r\n        icon: transformImg,\r\n        webgl: false,\r\n        neededWithWebGL: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        ieFails: true,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    glBlur: {\r\n        name: \"Triangle Blur\",\r\n        icon: glBlurImg,\r\n        webgl: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    },\r\n    glUnsharpMask: {\r\n        name: \"Unsharp Mask\",\r\n        icon: glUnsharpMaskImg,\r\n        webgl: true,\r\n        updateContext: true,\r\n        updatePos: false,\r\n        getDialog: null,\r\n        apply: null,\r\n        inEmbed: true,\r\n    }\r\n};","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"5tPq3\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"cazOx\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"245NA\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"1hkCG\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"k2eFf\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"krKGd\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"ehfxY\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"beOjS\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"Gk9bV\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"csed7\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"equSE\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"h1dN3\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"LfAXI\");","import {defaultBrush} from './default-brush';\r\nimport {BlendBrush} from './blend-brush';\r\nimport {sketchyBrush} from './sketchy-brush';\r\nimport {pixelBrush} from './pixel-brush';\r\nimport {eraserBrush} from './eraser-brush';\r\nimport {smudgeBrush} from './smudge-brush';\r\n\r\nexport const brushes = {\r\n    defaultBrush: defaultBrush,\r\n    BlendBrush,\r\n    sketchy: sketchyBrush,\r\n    pixel: pixelBrush,\r\n    smudge: smudgeBrush,\r\n    eraser: eraserBrush,\r\n}","import {BB} from '../../bb/bb';\r\nimport {alphaImArr} from './brushes-common';\r\n\r\n\r\nexport function defaultBrush() {\r\n\r\n    let _this = this;\r\n    let debugStr = '';\r\n    let context;\r\n    let history = {\r\n        add: function (p?) {\r\n        },\r\n        isFake: true\r\n    }, historyEntry;\r\n\r\n    let settingColor, settingSize = 2, settingSpacing = 0.8489, settingOpacity = 1;\r\n    let settingColorStr;\r\n    let settingHasSizePressure = true, settingHasOpacityPressure = false;\r\n    let settingLockLayerAlpha = false;\r\n    let ALPHA_CIRCLE = 0, ALPHA_CHALK = 1, ALPHA_CAL = 2, ALPHA_SQUARE = 3;\r\n    let settingAlphaId = ALPHA_CIRCLE;\r\n\r\n    let lineToolLastDot;\r\n    let lastInput = {x: 0, y: 0, pressure: 0};\r\n    let lastInput2 = {x: 0, y: 0, pressure: 0};\r\n\r\n    let isDrawing = false;\r\n    let alphaOpacityArr = [1, 0.9, 1, 1];\r\n\r\n    //mipmapping\r\n    let alphaCanvas128 = document.createElement(\"canvas\");\r\n    alphaCanvas128.width = 128;\r\n    alphaCanvas128.height = 128;\r\n    let alphaCanvas64 = document.createElement(\"canvas\");\r\n    alphaCanvas64.width = 64;\r\n    alphaCanvas64.height = 64;\r\n    let alphaCanvas32 = document.createElement(\"canvas\");\r\n    alphaCanvas32.width = 32;\r\n    alphaCanvas32.height = 32;\r\n\r\n    let bezierLine = null;\r\n\r\n    let twoPI = Math.PI * 2;\r\n\r\n    function updateAlphaCanvas() {\r\n        if (settingAlphaId === ALPHA_CIRCLE || settingAlphaId === ALPHA_SQUARE) {\r\n            return;\r\n        }\r\n\r\n        let instructionArr = [\r\n            [alphaCanvas128, 128],\r\n            [alphaCanvas64, 64],\r\n            [alphaCanvas32, 32]\r\n        ];\r\n\r\n        let ctx;\r\n\r\n        for(let i = 0; i < instructionArr.length; i++) {\r\n            ctx = (instructionArr[i][0] as any).getContext(\"2d\");\r\n\r\n            ctx.save();\r\n            ctx.clearRect(0, 0, instructionArr[i][1], instructionArr[i][1]);\r\n\r\n            ctx.fillStyle = \"rgba(\" + settingColor.r + \", \" + settingColor.g + \", \" + settingColor.b + \", \" + alphaOpacityArr[settingAlphaId] + \")\";\r\n            ctx.fillRect(0, 0, instructionArr[i][1], instructionArr[i][1]);\r\n\r\n            ctx.globalCompositeOperation = \"destination-in\";\r\n            ctx.imageSmoothingQuality = 'high';\r\n            ctx.drawImage(alphaImArr[settingAlphaId], 0, 0, instructionArr[i][1], instructionArr[i][1]);\r\n\r\n            ctx.restore();\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     *\r\n     * @param x\r\n     * @param y\r\n     * @param size\r\n     * @param opacity\r\n     * @param angle\r\n     * @param before - [x, y, size, opacity, angle] the drawDot call before\r\n     */\r\n    function drawDot(x, y, size, opacity, angle?, before?) {\r\n        if(size <= 0) {\r\n            return;\r\n        }\r\n\r\n        if (settingLockLayerAlpha) {\r\n            context.globalCompositeOperation = \"source-atop\";\r\n        }\r\n\r\n        if (!before || before[3] !== opacity) {\r\n            context.globalAlpha = opacity;\r\n        }\r\n\r\n        if (!before && (settingAlphaId === ALPHA_CIRCLE || settingAlphaId === ALPHA_SQUARE)) {\r\n            context.fillStyle = settingColorStr;\r\n        }\r\n\r\n        if (settingAlphaId === ALPHA_CIRCLE) {\r\n            context.beginPath();\r\n            context.arc(x, y, size, 0, twoPI);\r\n            context.closePath();\r\n            context.fill();\r\n\r\n        } else if (settingAlphaId === ALPHA_SQUARE) {\r\n            if(angle !== undefined) {\r\n                context.save();\r\n                context.translate(x, y);\r\n                context.rotate(angle / 180 * Math.PI);\r\n                context.fillRect(-size, -size, size * 2, size * 2);\r\n                context.restore();\r\n            }\r\n\r\n        } else { // other brush alphas\r\n            context.save();\r\n            context.translate(x, y);\r\n            let targetMipmap = alphaCanvas128;\r\n            if (size <= 32 && size > 16) {\r\n                targetMipmap = alphaCanvas64;\r\n            } else if (size <= 16) {\r\n                targetMipmap = alphaCanvas32;\r\n            }\r\n            context.scale(size, size);\r\n            if (settingAlphaId === ALPHA_CHALK) {\r\n                context.rotate(((x + y) * 53123) % twoPI); // without mod it sometimes looks different\r\n            }\r\n            context.drawImage(targetMipmap, -1, -1, 2, 2);\r\n\r\n            context.restore();\r\n        }\r\n    }\r\n\r\n    function continueLine(x, y, size, pressure) {\r\n        if(bezierLine === null) {\r\n            bezierLine = new BB.BezierLine();\r\n            bezierLine.add(lastInput.x, lastInput.y, 0, function(){});\r\n        }\r\n\r\n        let drawArr = []; //draw instructions. will be all drawn at once\r\n\r\n        function dotCallback(val) {\r\n            let localPressure = BB.mix(lastInput2.pressure, pressure, val.t);\r\n            let localOpacity = settingOpacity * (settingHasOpacityPressure ? (localPressure * localPressure) : 1);\r\n            let localSize = Math.max(0.1, settingSize * (settingHasSizePressure ? localPressure : 1));\r\n            drawArr.push([val.x, val.y, localSize, localOpacity, val.angle]);\r\n        }\r\n\r\n        let localSpacing = size * settingSpacing;\r\n        if(x === null) {\r\n            bezierLine.addFinal(localSpacing, dotCallback);\r\n        } else {\r\n            bezierLine.add(x, y, localSpacing, dotCallback);\r\n        }\r\n\r\n        // execute draw instructions\r\n        context.save();\r\n        let before;\r\n        for (let i = 0; i < drawArr.length; i++) {\r\n            let item = drawArr[i];\r\n            drawDot(item[0], item[1], item[2], item[3], item[4], before);\r\n            before = item;\r\n        }\r\n        context.restore();\r\n    }\r\n\r\n    //------------------ interface ---------------------------------------------------\r\n\r\n\r\n    this.startLine = function (x, y, p) {\r\n        historyEntry = {\r\n            tool: [\"brush\", \"defaultBrush\"],\r\n            actions: []\r\n        };\r\n        historyEntry.actions.push({\r\n            action: \"opacityPressure\",\r\n            params: [settingHasOpacityPressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"sizePressure\",\r\n            params: [settingHasSizePressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSize\",\r\n            params: [settingSize]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSpacing\",\r\n            params: [settingSpacing]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setOpacity\",\r\n            params: [settingOpacity]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setColor\",\r\n            params: [settingColor]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setAlpha\",\r\n            params: [settingAlphaId]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setLockAlpha\",\r\n            params: [settingLockLayerAlpha]\r\n        });\r\n\r\n        p = BB.clamp(p, 0, 1);\r\n        let localOpacity = settingHasOpacityPressure ? (settingOpacity * p * p) : settingOpacity;\r\n        let localSize = settingHasSizePressure ? Math.max(0.1, p * settingSize) : Math.max(0.1, settingSize);\r\n\r\n        isDrawing = true;\r\n        context.save();\r\n        drawDot(x, y, localSize, localOpacity);\r\n        context.restore();\r\n\r\n        lineToolLastDot = localSize * settingSpacing;\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        lastInput.pressure = p;\r\n        lastInput2.pressure = p;\r\n\r\n        historyEntry.actions.push({\r\n            action: \"startLine\",\r\n            params: [x, y, p]\r\n        });\r\n    };\r\n\r\n    this.goLine = function (x, y, p) {\r\n        if (!isDrawing) {\r\n            return;\r\n        }\r\n        historyEntry.actions.push({\r\n            action: \"goLine\",\r\n            params: [x, y, p]\r\n        });\r\n\r\n        let pressure = BB.clamp(p, 0, 1);\r\n        let localSize = settingHasSizePressure ? Math.max(0.1, lastInput.pressure * settingSize) : Math.max(0.1, settingSize);\r\n\r\n        context.save();\r\n        continueLine(x, y, localSize, lastInput.pressure);\r\n\r\n        /*context.fillStyle = 'red';\r\n        context.fillRect(Math.floor(x), Math.floor(y - 10), 1, 20);\r\n        context.fillRect(Math.floor(x - 10), Math.floor(y), 20, 1);*/\r\n\r\n        context.restore();\r\n\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        lastInput2.pressure = lastInput.pressure;\r\n        lastInput.pressure = pressure;\r\n    };\r\n\r\n    this.endLine = function (x, y) {\r\n\r\n        let localSize = settingHasSizePressure ? Math.max(0.1, lastInput.pressure * settingSize) : Math.max(0.1, settingSize);\r\n        context.save();\r\n        continueLine(null, null, localSize, lastInput.pressure);\r\n        context.restore();\r\n\r\n        isDrawing = false;\r\n\r\n        bezierLine = null;\r\n\r\n        if (historyEntry) {\r\n            historyEntry.actions.push({\r\n                action: \"endLine\",\r\n                params: [x, y]\r\n            });\r\n            history.add(historyEntry);\r\n            historyEntry = undefined;\r\n        }\r\n    };\r\n    //cheap n' ugly\r\n    this.drawLineSegment = function (x1, y1, x2, y2) {\r\n        lastInput.x = x2;\r\n        lastInput.y = y2;\r\n        lastInput.pressure = 1;\r\n\r\n        if (isDrawing || x1 === undefined) {\r\n            return;\r\n        }\r\n\r\n        let angle = BB.pointsToAngleDeg({x:x1, y:y1}, {x:x2, y:y2});\r\n        let mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\r\n        let eX = (x2 - x1) / mouseDist;\r\n        let eY = (y2 - y1) / mouseDist;\r\n        let loopDist;\r\n        let bdist = settingSize * settingSpacing;\r\n        lineToolLastDot = settingSize * settingSpacing;\r\n        for (loopDist = lineToolLastDot; loopDist <= mouseDist; loopDist += bdist) {\r\n            drawDot(x1 + eX * loopDist, y1 + eY * loopDist, settingSize, settingOpacity, angle);\r\n        }\r\n\r\n\r\n        let historyEntry = {\r\n            tool: [\"brush\", \"defaultBrush\"],\r\n            actions: []\r\n        };\r\n        historyEntry.actions.push({\r\n            action: \"opacityPressure\",\r\n            params: [settingHasOpacityPressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"sizePressure\",\r\n            params: [settingHasSizePressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSize\",\r\n            params: [settingSize]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSpacing\",\r\n            params: [settingSpacing]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setOpacity\",\r\n            params: [settingOpacity]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setColor\",\r\n            params: [settingColor]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setAlpha\",\r\n            params: [settingAlphaId]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setLockAlpha\",\r\n            params: [settingLockLayerAlpha]\r\n        });\r\n\r\n        historyEntry.actions.push({\r\n            action: \"drawLineSegment\",\r\n            params: [x1, y1, x2, y2]\r\n        });\r\n        history.add(historyEntry);\r\n    };\r\n\r\n    //IS\r\n    this.isDrawing = function () {\r\n        return isDrawing;\r\n    };\r\n    //SET\r\n    this.setAlpha = function (a) {\r\n        if(settingAlphaId === a) {\r\n            return;\r\n        }\r\n        settingAlphaId = a;\r\n        updateAlphaCanvas();\r\n    };\r\n    this.setColor = function (c) {\r\n        if(settingColor === c) {\r\n            return;\r\n        }\r\n        settingColor = {r: c.r, g: c.g, b: c.b};\r\n        settingColorStr = \"rgb(\" + settingColor.r + \",\" + settingColor.g + \",\" + settingColor.b + \")\";\r\n        updateAlphaCanvas();\r\n    };\r\n    this.setContext = function (c) {\r\n        context = c;\r\n    };\r\n    this.setHistory = function (l) {\r\n        history = l;\r\n    };\r\n    this.setSize = function (s) {\r\n        settingSize = s;\r\n    };\r\n    this.setOpacity = function (o) {\r\n        settingOpacity = o;\r\n    };\r\n    this.setSpacing = function (s) {\r\n        settingSpacing = s;\r\n    };\r\n    this.sizePressure = function (b) {\r\n        settingHasSizePressure = b;\r\n    };\r\n    this.opacityPressure = function (b) {\r\n        settingHasOpacityPressure = b;\r\n    };\r\n    this.setLockAlpha = function (b) {\r\n        settingLockLayerAlpha = b;\r\n    };\r\n    //GET\r\n    this.getSpacing = function () {\r\n        return settingSpacing;\r\n    };\r\n    this.getSize = function () {\r\n        return settingSize;\r\n    };\r\n    this.getOpacity = function () {\r\n        return settingOpacity;\r\n    };\r\n    this.getLockAlpha = function (b) {\r\n        return settingLockLayerAlpha;\r\n    };\r\n    this.setDebug = function(str) {\r\n        debugStr = str;\r\n    };\r\n}","import {genBrushAlpha01, genBrushAlpha02} from './alphas/brush-alphas';\r\n\r\nexport const alphaImArr = []; //used by default brush\r\nalphaImArr[1] = genBrushAlpha01(128);\r\nalphaImArr[2] = genBrushAlpha02(128);","import {BB} from '../../../bb/bb';\r\nimport {noise} from '../../../bb/math/perlin';\r\nimport {IVector2D} from '../../../bb/bb.types';\r\n\r\n// chalk\r\nexport function genBrushAlpha01(w: number): HTMLCanvasElement {\r\n\r\n    const scaleFac = w / 500;\r\n    const h = w;\r\n    const canvas = BB.canvas(w, h);\r\n    const ctx = canvas.getContext('2d');\r\n    const imData = ctx.createImageData(w, h);\r\n    for (let x = 0; x < w; x++) {\r\n        for (let y = 0; y < h; y++) {\r\n            let i = (y * w + x) * 4;\r\n\r\n            // base noise\r\n            const sFac2 = scaleFac + noise.simplex2(x / 50 / scaleFac, y / 50 / scaleFac) * 0.04;\r\n            let noisePattern = 100 + (noise.simplex2(x / 50 / sFac2, y / 50 / sFac2) + 1) / 2 * 100;\r\n            noisePattern -= (noise.simplex2(x / 10 / scaleFac, y / 10 / scaleFac) + 1) / 2 * 100;\r\n\r\n            // fade out in circular shape\r\n            const centerDist = BB.dist(w / 2, h / 2, x, y);\r\n            let falloff = BB.clamp(\r\n                1 - ((centerDist - (w / 2.5)) / (w / 14) + noise.simplex2(x / 22 / sFac2, y / 22 / sFac2)),\r\n                0,\r\n                1);\r\n            noisePattern = noisePattern * falloff;\r\n\r\n            // make the middle darker\r\n            const falloff2 = BB.clamp(1 - centerDist / w, 0, 1) * 2;\r\n            noisePattern = noisePattern * falloff2;\r\n\r\n            imData.data[i] = 0;\r\n            imData.data[i + 1] = 0;\r\n            imData.data[i + 2] = 0;\r\n            imData.data[i + 3] = BB.clamp(noisePattern, 0, 255);\r\n        }\r\n    }\r\n\r\n    ctx.putImageData(imData, 0, 0);\r\n    return canvas;\r\n}\r\n\r\n// https://www.shadertoy.com/view/3tdSDj\r\nfunction udSegment( p: IVector2D, a: IVector2D, b: IVector2D ) {\r\n    let ba = BB.Vec2.sub(b, a);\r\n    let pa = BB.Vec2.sub(p, a);\r\n    let h = BB.clamp( BB.Vec2.dot(pa,ba) / BB.Vec2.dot(ba,ba), 0.0, 1.0 );\r\n    return BB.Vec2.len(BB.Vec2.sub(pa, BB.Vec2.mul(ba, h)));\r\n}\r\n\r\n// calligraphy\r\nexport function genBrushAlpha02(w: number): HTMLCanvasElement {\r\n\r\n    const pDist = 1 / 4;\r\n    let centerSize = 2 / 3;\r\n    let transitionSize = 1 / 3;\r\n    centerSize *= pDist;\r\n    transitionSize *= pDist;\r\n    const p1 = {x: pDist * w, y: w - (w * pDist)};\r\n    const p2 = {x: w - (w * pDist), y: pDist * w};\r\n\r\n    const h = w;\r\n    const canvas = BB.canvas();\r\n    canvas.width = w;\r\n    canvas.height = h;\r\n    let ctx = canvas.getContext('2d');\r\n    const imData = ctx.createImageData(w, h);\r\n    for (let x = 0; x < w; x++) {\r\n        for (let y = 0; y < h; y++) {\r\n            const i = (y * w + x) * 4;\r\n\r\n            let col = udSegment({x: x, y: y}, p1, p2);\r\n\r\n            col = BB.clamp(\r\n                255 - ((col - (w * centerSize)) / (w * transitionSize) * 255),\r\n                0,\r\n                255\r\n            );\r\n\r\n            imData.data[i] = 0;\r\n            imData.data[i + 1] = 0;\r\n            imData.data[i + 2] = 0;\r\n            imData.data[i + 3] = col;\r\n        }\r\n    }\r\n\r\n    ctx.putImageData(imData, 0, 0);\r\n    return canvas;\r\n}","/*\r\n * A speed-improved perlin and simplex noise algorithms for 2D.\r\n *\r\n * Based on example code by Stefan Gustavson (stegu@itn.liu.se).\r\n * Optimisations by Peter Eastman (peastman@drizzle.stanford.edu).\r\n * Better rank ordering method by Stefan Gustavson in 2012.\r\n * Converted to Javascript by Joseph Gentle.\r\n *\r\n * Version 2012-03-09\r\n *\r\n * This code was placed in the public domain by its original author,\r\n * Stefan Gustavson. You may use it as you see fit, but\r\n * attribution is appreciated.\r\n *\r\n */\r\n\r\nconst myModule = {} as any;\r\n\r\n\r\nfunction Grad(x, y, z) {\r\n    this.x = x; this.y = y; this.z = z;\r\n}\r\n\r\nGrad.prototype.dot2 = function(x, y) {\r\n    return this.x*x + this.y*y;\r\n};\r\n/*\r\nGrad.prototype.dot3 = function(x, y, z) {\r\n    return this.x*x + this.y*y + this.z*z;\r\n};*/\r\n\r\nlet grad3 = [new Grad(1,1,0),new Grad(-1,1,0),new Grad(1,-1,0),new Grad(-1,-1,0),\r\n    new Grad(1,0,1),new Grad(-1,0,1),new Grad(1,0,-1),new Grad(-1,0,-1),\r\n    new Grad(0,1,1),new Grad(0,-1,1),new Grad(0,1,-1),new Grad(0,-1,-1)];\r\n\r\nlet p = [151,160,137,91,90,15,\r\n    131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,\r\n    190, 6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,\r\n    88,237,149,56,87,174,20,125,136,171,168, 68,175,74,165,71,134,139,48,27,166,\r\n    77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,\r\n    102,143,54, 65,25,63,161, 1,216,80,73,209,76,132,187,208, 89,18,169,200,196,\r\n    135,130,116,188,159,86,164,100,109,198,173,186, 3,64,52,217,226,250,124,123,\r\n    5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,\r\n    223,183,170,213,119,248,152, 2,44,154,163, 70,221,153,101,155,167, 43,172,9,\r\n    129,22,39,253, 19,98,108,110,79,113,224,232,178,185, 112,104,218,246,97,228,\r\n    251,34,242,193,238,210,144,12,191,179,162,241, 81,51,145,235,249,14,239,107,\r\n    49,192,214, 31,181,199,106,157,184, 84,204,176,115,121,50,45,127, 4,150,254,\r\n    138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];\r\n// To remove the need for index wrapping, double the permutation table length\r\nlet perm = new Array(512);\r\nlet gradP = new Array(512);\r\n\r\n// This isn't a very good seeding function, but it works ok. It supports 2^16\r\n// different seed values. Write something better if you need more seeds.\r\nmyModule.seed = function(seed) {\r\n    if(seed > 0 && seed < 1) {\r\n        // Scale the seed out\r\n        seed *= 65536;\r\n    }\r\n\r\n    seed = Math.floor(seed);\r\n    if(seed < 256) {\r\n        seed |= seed << 8;\r\n    }\r\n\r\n    for(let i = 0; i < 256; i++) {\r\n        let v;\r\n        if (i & 1) {\r\n            v = p[i] ^ (seed & 255);\r\n        } else {\r\n            v = p[i] ^ ((seed>>8) & 255);\r\n        }\r\n\r\n        perm[i] = perm[i + 256] = v;\r\n        gradP[i] = gradP[i + 256] = grad3[v % 12];\r\n    }\r\n};\r\n\r\nmyModule.seed(0);\r\n\r\n/*\r\nfor(let i=0; i<256; i++) {\r\n  perm[i] = perm[i + 256] = p[i];\r\n  gradP[i] = gradP[i + 256] = grad3[perm[i] % 12];\r\n}*/\r\n\r\n// Skewing and unskewing factors for 2, 3, and 4 dimensions\r\nlet F2 = 0.5*(Math.sqrt(3)-1);\r\nlet G2 = (3-Math.sqrt(3))/6;\r\n\r\n/*let F3 = 1/3;\r\nlet G3 = 1/6;*/\r\n\r\n// 2D simplex noise\r\nmyModule.simplex2 = function(xin, yin) {\r\n    let n0, n1, n2; // Noise contributions from the three corners\r\n    // Skew the input space to determine which simplex cell we're in\r\n    let s = (xin+yin)*F2; // Hairy factor for 2D\r\n    let i = Math.floor(xin+s);\r\n    let j = Math.floor(yin+s);\r\n    let t = (i+j)*G2;\r\n    let x0 = xin-i+t; // The x,y distances from the cell origin, unskewed.\r\n    let y0 = yin-j+t;\r\n    // For the 2D case, the simplex shape is an equilateral triangle.\r\n    // Determine which simplex we are in.\r\n    let i1, j1; // Offsets for second (middle) corner of simplex in (i,j) coords\r\n    if(x0>y0) { // lower triangle, XY order: (0,0)->(1,0)->(1,1)\r\n        i1=1; j1=0;\r\n    } else {    // upper triangle, YX order: (0,0)->(0,1)->(1,1)\r\n        i1=0; j1=1;\r\n    }\r\n    // A step of (1,0) in (i,j) means a step of (1-c,-c) in (x,y), and\r\n    // a step of (0,1) in (i,j) means a step of (-c,1-c) in (x,y), where\r\n    // c = (3-sqrt(3))/6\r\n    let x1 = x0 - i1 + G2; // Offsets for middle corner in (x,y) unskewed coords\r\n    let y1 = y0 - j1 + G2;\r\n    let x2 = x0 - 1 + 2 * G2; // Offsets for last corner in (x,y) unskewed coords\r\n    let y2 = y0 - 1 + 2 * G2;\r\n    // Work out the hashed gradient indices of the three simplex corners\r\n    i &= 255;\r\n    j &= 255;\r\n    let gi0 = gradP[i+perm[j]];\r\n    let gi1 = gradP[i+i1+perm[j+j1]];\r\n    let gi2 = gradP[i+1+perm[j+1]];\r\n    // Calculate the contribution from the three corners\r\n    let t0 = 0.5 - x0*x0-y0*y0;\r\n    if(t0<0) {\r\n        n0 = 0;\r\n    } else {\r\n        t0 *= t0;\r\n        n0 = t0 * t0 * gi0.dot2(x0, y0);  // (x,y) of grad3 used for 2D gradient\r\n    }\r\n    let t1 = 0.5 - x1*x1-y1*y1;\r\n    if(t1<0) {\r\n        n1 = 0;\r\n    } else {\r\n        t1 *= t1;\r\n        n1 = t1 * t1 * gi1.dot2(x1, y1);\r\n    }\r\n    let t2 = 0.5 - x2*x2-y2*y2;\r\n    if(t2<0) {\r\n        n2 = 0;\r\n    } else {\r\n        t2 *= t2;\r\n        n2 = t2 * t2 * gi2.dot2(x2, y2);\r\n    }\r\n    // Add contributions from each corner to get the final noise value.\r\n    // The result is scaled to return values in the interval [-1,1].\r\n    return 70 * (n0 + n1 + n2);\r\n};\r\n/*\r\n// 3D simplex noise\r\nmyModule.simplex3 = function(xin, yin, zin) {\r\n    let n0, n1, n2, n3; // Noise contributions from the four corners\r\n\r\n    // Skew the input space to determine which simplex cell we're in\r\n    let s = (xin+yin+zin)*F3; // Hairy factor for 2D\r\n    let i = Math.floor(xin+s);\r\n    let j = Math.floor(yin+s);\r\n    let k = Math.floor(zin+s);\r\n\r\n    let t = (i+j+k)*G3;\r\n    let x0 = xin-i+t; // The x,y distances from the cell origin, unskewed.\r\n    let y0 = yin-j+t;\r\n    let z0 = zin-k+t;\r\n\r\n    // For the 3D case, the simplex shape is a slightly irregular tetrahedron.\r\n    // Determine which simplex we are in.\r\n    let i1, j1, k1; // Offsets for second corner of simplex in (i,j,k) coords\r\n    let i2, j2, k2; // Offsets for third corner of simplex in (i,j,k) coords\r\n    if(x0 >= y0) {\r\n        if(y0 >= z0)      { i1=1; j1=0; k1=0; i2=1; j2=1; k2=0; }\r\n        else if(x0 >= z0) { i1=1; j1=0; k1=0; i2=1; j2=0; k2=1; }\r\n        else              { i1=0; j1=0; k1=1; i2=1; j2=0; k2=1; }\r\n    } else {\r\n        if(y0 < z0)      { i1=0; j1=0; k1=1; i2=0; j2=1; k2=1; }\r\n        else if(x0 < z0) { i1=0; j1=1; k1=0; i2=0; j2=1; k2=1; }\r\n        else             { i1=0; j1=1; k1=0; i2=1; j2=1; k2=0; }\r\n    }\r\n    // A step of (1,0,0) in (i,j,k) means a step of (1-c,-c,-c) in (x,y,z),\r\n    // a step of (0,1,0) in (i,j,k) means a step of (-c,1-c,-c) in (x,y,z), and\r\n    // a step of (0,0,1) in (i,j,k) means a step of (-c,-c,1-c) in (x,y,z), where\r\n    // c = 1/6.\r\n    let x1 = x0 - i1 + G3; // Offsets for second corner\r\n    let y1 = y0 - j1 + G3;\r\n    let z1 = z0 - k1 + G3;\r\n\r\n    let x2 = x0 - i2 + 2 * G3; // Offsets for third corner\r\n    let y2 = y0 - j2 + 2 * G3;\r\n    let z2 = z0 - k2 + 2 * G3;\r\n\r\n    let x3 = x0 - 1 + 3 * G3; // Offsets for fourth corner\r\n    let y3 = y0 - 1 + 3 * G3;\r\n    let z3 = z0 - 1 + 3 * G3;\r\n\r\n    // Work out the hashed gradient indices of the four simplex corners\r\n    i &= 255;\r\n    j &= 255;\r\n    k &= 255;\r\n    let gi0 = gradP[i+   perm[j+   perm[k   ]]];\r\n    let gi1 = gradP[i+i1+perm[j+j1+perm[k+k1]]];\r\n    let gi2 = gradP[i+i2+perm[j+j2+perm[k+k2]]];\r\n    let gi3 = gradP[i+ 1+perm[j+ 1+perm[k+ 1]]];\r\n\r\n    // Calculate the contribution from the four corners\r\n    let t0 = 0.6 - x0*x0 - y0*y0 - z0*z0;\r\n    if(t0<0) {\r\n        n0 = 0;\r\n    } else {\r\n        t0 *= t0;\r\n        n0 = t0 * t0 * gi0.dot3(x0, y0, z0);  // (x,y) of grad3 used for 2D gradient\r\n    }\r\n    let t1 = 0.6 - x1*x1 - y1*y1 - z1*z1;\r\n    if(t1<0) {\r\n        n1 = 0;\r\n    } else {\r\n        t1 *= t1;\r\n        n1 = t1 * t1 * gi1.dot3(x1, y1, z1);\r\n    }\r\n    let t2 = 0.6 - x2*x2 - y2*y2 - z2*z2;\r\n    if(t2<0) {\r\n        n2 = 0;\r\n    } else {\r\n        t2 *= t2;\r\n        n2 = t2 * t2 * gi2.dot3(x2, y2, z2);\r\n    }\r\n    let t3 = 0.6 - x3*x3 - y3*y3 - z3*z3;\r\n    if(t3<0) {\r\n        n3 = 0;\r\n    } else {\r\n        t3 *= t3;\r\n        n3 = t3 * t3 * gi3.dot3(x3, y3, z3);\r\n    }\r\n    // Add contributions from each corner to get the final noise value.\r\n    // The result is scaled to return values in the interval [-1,1].\r\n    return 32 * (n0 + n1 + n2 + n3);\r\n\r\n};\r\n*/\r\n// ##### Perlin noise stuff\r\n/*\r\nfunction fade(t) {\r\n    return t*t*t*(t*(t*6-15)+10);\r\n}\r\n\r\nfunction lerp(a, b, t) {\r\n    return (1-t)*a + t*b;\r\n}\r\n\r\n// 2D Perlin Noise\r\nmyModule.perlin2 = function(x, y) {\r\n    // Find unit grid cell containing point\r\n    let X = Math.floor(x), Y = Math.floor(y);\r\n    // Get relative xy coordinates of point within that cell\r\n    x = x - X; y = y - Y;\r\n    // Wrap the integer cells at 255 (smaller integer period can be introduced here)\r\n    X = X & 255; Y = Y & 255;\r\n\r\n    // Calculate noise contributions from each of the four corners\r\n    let n00 = gradP[X+perm[Y]].dot2(x, y);\r\n    let n01 = gradP[X+perm[Y+1]].dot2(x, y-1);\r\n    let n10 = gradP[X+1+perm[Y]].dot2(x-1, y);\r\n    let n11 = gradP[X+1+perm[Y+1]].dot2(x-1, y-1);\r\n\r\n    // Compute the fade curve value for x\r\n    let u = fade(x);\r\n\r\n    // Interpolate the four results\r\n    return lerp(\r\n        lerp(n00, n10, u),\r\n        lerp(n01, n11, u),\r\n        fade(y));\r\n};*/\r\n/*\r\n// 3D Perlin Noise\r\nmyModule.perlin3 = function(x, y, z) {\r\n    // Find unit grid cell containing point\r\n    let X = Math.floor(x), Y = Math.floor(y), Z = Math.floor(z);\r\n    // Get relative xyz coordinates of point within that cell\r\n    x = x - X; y = y - Y; z = z - Z;\r\n    // Wrap the integer cells at 255 (smaller integer period can be introduced here)\r\n    X = X & 255; Y = Y & 255; Z = Z & 255;\r\n\r\n    // Calculate noise contributions from each of the eight corners\r\n    let n000 = gradP[X+  perm[Y+  perm[Z  ]]].dot3(x,   y,     z);\r\n    let n001 = gradP[X+  perm[Y+  perm[Z+1]]].dot3(x,   y,   z-1);\r\n    let n010 = gradP[X+  perm[Y+1+perm[Z  ]]].dot3(x,   y-1,   z);\r\n    let n011 = gradP[X+  perm[Y+1+perm[Z+1]]].dot3(x,   y-1, z-1);\r\n    let n100 = gradP[X+1+perm[Y+  perm[Z  ]]].dot3(x-1,   y,   z);\r\n    let n101 = gradP[X+1+perm[Y+  perm[Z+1]]].dot3(x-1,   y, z-1);\r\n    let n110 = gradP[X+1+perm[Y+1+perm[Z  ]]].dot3(x-1, y-1,   z);\r\n    let n111 = gradP[X+1+perm[Y+1+perm[Z+1]]].dot3(x-1, y-1, z-1);\r\n\r\n    // Compute the fade curve value for x, y, z\r\n    let u = fade(x);\r\n    let v = fade(y);\r\n    let w = fade(z);\r\n\r\n    // Interpolate\r\n    return lerp(\r\n        lerp(\r\n            lerp(n000, n100, u),\r\n            lerp(n001, n101, u), w),\r\n        lerp(\r\n            lerp(n010, n110, u),\r\n            lerp(n011, n111, u), w),\r\n        v);\r\n};*/\r\n\r\nexport const noise = myModule;","import {BB} from '../../bb/bb';\r\nimport {IRGB, IRGBA} from '../kl.types';\r\nimport {IBounds} from '../../bb/bb.types';\r\n\r\nconst cellSize = 256;\r\n\r\ninterface IPressureInput {\r\n    x: number;\r\n    y: number;\r\n    pressure: number; // 0-1\r\n}\r\n\r\ninterface IDrawBufferItem {\r\n    x: number;\r\n    y: number;\r\n    size: number;\r\n    opacity: number;\r\n    x1: number;\r\n    y1: number;\r\n    x2: number;\r\n    y2: number;\r\n    r: number;\r\n    g: number;\r\n    b: number;\r\n}\r\n\r\n// faster than using BB.clamp somehow (in chrome)\r\nfunction clamp(num, min, max) {\r\n    return num <= min\r\n        ? min\r\n        : num >= max\r\n            ? max\r\n            : num\r\n}\r\n\r\nexport class BlendBrush {\r\n\r\n    private isTesting: boolean = false; // testing mode - context only gets updated when line is finished\r\n\r\n    private context: CanvasRenderingContext2D;\r\n    private color: IRGB;\r\n    private size: number = 29; // radius - 0.5 - 99999\r\n    private opacity: number = 0.6; // 0-1\r\n    private blending: number = 0.65; // 0-1\r\n\r\n    private settingLockLayerAlpha: boolean = false;\r\n    private settingSizePressure: boolean = true;\r\n    private settingOpacityPressure: boolean = false;\r\n\r\n    private blendCol: IRGBA = {r: 0, g: 0, b: 0, a: 1}; // todo docs\r\n    private blendMix: number = 0.45; // todo docs\r\n    private mixr: number; // todo docs\r\n    private mixg: number; // todo docs\r\n    private mixb: number; // todo docs\r\n    private localColOld: IRGBA; // todo docs\r\n\r\n    private isDrawing: boolean = false;\r\n    private lastInput: IPressureInput = {x: 0, y: 0, pressure: 0}; // todo docs\r\n    private lastInput2: IPressureInput = {x: 0, y: 0, pressure: 0}; // todo docs\r\n    private bezierLine: any; // todo type\r\n\r\n    private history: any; // todo type\r\n    private historyEntry: {\r\n        tool: string[];\r\n        actions: {\r\n            action: string;\r\n            params: any[];\r\n        }[];\r\n    };\r\n    private redrawBounds: IBounds;\r\n    private cells: (ImageData | null)[];\r\n    private drawBuffer: IDrawBufferItem[];\r\n\r\n    private updateRedrawBounds (bounds: IBounds): void {\r\n        this.redrawBounds = BB.updateBounds(this.redrawBounds, bounds);\r\n    }\r\n\r\n    private getCellsWidth(): number {\r\n        return Math.ceil(this.context.canvas.width / cellSize);\r\n    }\r\n\r\n    /**\r\n     * draw changed cells (changed by brushstroke) onto context\r\n     * @private\r\n     */\r\n    private drawChangedCells(): void {\r\n        const cells = this.cells.map(item => null);\r\n        const touchedCells = this.getTouchedCells(this.redrawBounds);\r\n        touchedCells.forEach((isTouched, index) => {\r\n            if (isTouched) {\r\n                cells[index] = this.cells[index];\r\n            }\r\n        });\r\n        this.drawCells(cells);\r\n        this.redrawBounds = null;\r\n    }\r\n\r\n    private getTouchedCells(bounds: IBounds): boolean[] {\r\n        const touchedCells = this.cells.map(item => false);\r\n        const cellsW = this.getCellsWidth();\r\n        bounds = {\r\n            x1: Math.floor(bounds.x1 / cellSize),\r\n            y1: Math.floor(bounds.y1 / cellSize),\r\n            x2: Math.floor(bounds.x2 / cellSize),\r\n            y2: Math.floor(bounds.y2 / cellSize),\r\n        };\r\n        for (let i = bounds.x1; i <= bounds.x2; i++) {\r\n            for (let e = bounds.y1; e <= bounds.y2; e++) {\r\n                touchedCells[e * cellsW + i] = true;\r\n            }\r\n        }\r\n        return touchedCells;\r\n    }\r\n\r\n    /**\r\n     * Slice up bounds accordings to cells\r\n     * @param bounds\r\n     * @private\r\n     */\r\n    private sliceBounds(bounds: IBounds): {index: number; bounds: IBounds}[] {\r\n        const cellsW = this.getCellsWidth();\r\n        const result: {index: number; bounds: IBounds}[] = [];\r\n        const touchedCells = this.getTouchedCells(bounds);\r\n\r\n        touchedCells.forEach((cell, i) => {\r\n            if (!cell) {\r\n                return;\r\n            }\r\n\r\n            const cellOffsetX = (i % cellsW) * cellSize;\r\n            const cellOffsetY = Math.floor(i / cellsW) * cellSize;\r\n            const cellWidth = this.cells[i].width;\r\n            const cellHeight = this.cells[i].height;\r\n\r\n            const inCellBounds = {\r\n                x1: Math.max(0, bounds.x1 - cellOffsetX),\r\n                y1: Math.max(0, bounds.y1 - cellOffsetY),\r\n                x2: Math.min(cellWidth - 1, bounds.x2 - cellOffsetX),\r\n                y2: Math.min(cellHeight - 1, bounds.y2 - cellOffsetY),\r\n            }\r\n            if (inCellBounds.x1 > inCellBounds.x2 || inCellBounds.y1 > inCellBounds.y2) {\r\n                return;\r\n            }\r\n            result.push({\r\n                index: i,\r\n                bounds: inCellBounds,\r\n            });\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * update copyImageData. copy over new regions if needed\r\n     */\r\n    private copyFromCanvas(bounds: IBounds) {\r\n        if (!bounds) {\r\n            return;\r\n        }\r\n\r\n        const touchedCells = this.getTouchedCells(bounds);\r\n        const cellsW = this.getCellsWidth();\r\n\r\n        touchedCells.forEach((item, i) => {\r\n            if (!item || this.cells[i]) {\r\n                // not touched, or already copied\r\n                return;\r\n            }\r\n            const x = i % cellsW;\r\n            const y = Math.floor(i / cellsW);\r\n            const w = (Math.min(x * cellSize + cellSize, this.context.canvas.width) - 1) % cellSize + 1;\r\n            const h = (Math.min(y * cellSize + cellSize, this.context.canvas.height) - 1) % cellSize + 1;\r\n\r\n            // temp canvas to prevent main canvas from getting slowed down in chrome\r\n            const tmpCanvas = BB.canvas(w, h);\r\n            const tmpCtx = tmpCanvas.getContext('2d');\r\n            tmpCtx.drawImage(this.context.canvas, -x * cellSize, -y * cellSize);\r\n\r\n            this.cells[i] = tmpCtx.getImageData(0, 0, w, h);\r\n        });\r\n    }\r\n\r\n    private getAverage (x, y, size): IRGBA {\r\n\r\n        size = Math.max(0.5, size * 0.75);\r\n        const x1 = Math.max(0, Math.floor(x - size));\r\n        const y1 = Math.max(0, Math.floor(y - size));\r\n        const x2 = Math.min(this.context.canvas.width - 1, Math.ceil(x + size));\r\n        const y2 = Math.min(this.context.canvas.height - 1, Math.ceil(y + size));\r\n        if (x1 > x2 || y1 > y2) {\r\n            return {\r\n                r: 0,\r\n                g: 0,\r\n                b: 0,\r\n                a: 0,\r\n            };\r\n        }\r\n\r\n        let ar = 0, ag = 0, ab = 0, aa = 0, alpha;\r\n\r\n        const slicedBounds = this.sliceBounds({ x1, y1, x2, y2 });\r\n        slicedBounds.forEach(slice => {\r\n            const width = this.cells[slice.index].width;\r\n            const data = this.cells[slice.index].data;\r\n            const bounds = slice.bounds;\r\n\r\n            for (let i = bounds.y1; i <= bounds.y2; i += 4) {\r\n                for (let e = bounds.x1, e2 = i * width * 4 + bounds.x1 * 4; e <= bounds.x2; e += 4, e2 += 4 * 4) {\r\n                    alpha = data[e2 + 3];\r\n                    ar += data[e2] * alpha;\r\n                    ag += data[e2 + 1] * alpha;\r\n                    ab += data[e2 + 2] * alpha;\r\n                    aa += alpha;\r\n                }\r\n            }\r\n        });\r\n\r\n        if (aa !== 0) {\r\n            ar /= aa;\r\n            ag /= aa;\r\n            ab /= aa;\r\n            aa = Math.min(1, aa);\r\n        }\r\n        return {\r\n            r: ar,\r\n            g: ag,\r\n            b: ab,\r\n            a: aa\r\n        };\r\n    }\r\n\r\n    private prepDot (x: number, y: number, size: number): IBounds {\r\n        size = Math.max(0.5, size);\r\n        let x1 = Math.max(0, Math.floor(x - size));\r\n        let y1 = Math.max(0, Math.floor(y - size));\r\n        let x2 = Math.min(this.context.canvas.width - 1, Math.ceil(x + size));\r\n        let y2 = Math.min(this.context.canvas.height - 1, Math.ceil(y + size));\r\n        if (x1 > x2 || y1 > y2) {\r\n            return null;\r\n        }\r\n        return { x1, y1, x2, y2 };\r\n    }\r\n\r\n    private drawDot (params: IDrawBufferItem): void {\r\n        // array with random numbers. faster than Math.random()\r\n        let randI = 0;\r\n        const randLen = params.size > 30 ? 1024 : 512; // lower lengths lead to noticeable patterns\r\n        const randArr = [];\r\n        for (let i = 0; i < randLen; i++) {\r\n            randArr[i] = (Math.random() - 0.5) / 1.001 + 0.5;\r\n        }\r\n\r\n        // thin lines take more than just 1 sample\r\n        const sampleArr = [8,4,4,4,2,2,2,2,2,2]; // <0.5, 0.5, 1, 1.5, etc.\r\n        const samples = sampleArr[Math.floor(params.size * 2)];\r\n        const samplesSquared: number = samples ? samples * samples : 0;\r\n        const sampleOffsets = [];\r\n        if (samples) {\r\n            let i = 0;\r\n            for (let n = 0; n < samples; n++) {\r\n                for (let m = 0; m < samples; m++, i += 2) {\r\n                    sampleOffsets[i] = (n + 1) / samples; // x offset\r\n                    sampleOffsets[i + 1] = (m + 1) / samples; // y offset\r\n                }\r\n            }\r\n        }\r\n\r\n        const sharpness = Math.pow(params.opacity, 2) * 0.8;\r\n        // to optimize calculations\r\n        const invSharpness = 1 - sharpness;\r\n        const sharpnessSubtrahend = sharpness / invSharpness;\r\n        const sizeSquared = params.size * params.size;\r\n        const distDivisor = sizeSquared * invSharpness / params.opacity;\r\n        const alphaMinuend = (1 + sharpnessSubtrahend) * params.opacity;\r\n\r\n\r\n        const slicedBounds = this.sliceBounds({\r\n            x1: params.x1,\r\n            y1: params.y1,\r\n            x2: params.x2,\r\n            y2: params.y2,\r\n        });\r\n\r\n        const cellsW = this.getCellsWidth();\r\n        slicedBounds.forEach(slice => {\r\n            const cellOffsetX = (slice.index % cellsW) * cellSize;\r\n            const cellOffsetY = Math.floor(slice.index / cellsW) * cellSize;\r\n            const cellWidth = this.cells[slice.index].width;\r\n            const data = this.cells[slice.index].data;\r\n\r\n            // i - y index within cell\r\n            // e - x index within cell\r\n\r\n            // e2 - index in image data\r\n\r\n            // ri - y index within image relative to dot-center\r\n            // re - x index within image relative to dot-center\r\n\r\n            for (let i = slice.bounds.y1, ri = i + cellOffsetY - params.y; i <= slice.bounds.y2; i++, ri++) {\r\n                for (\r\n                    let e = slice.bounds.x1,\r\n                        e2 = i * cellWidth * 4 + slice.bounds.x1 * 4,\r\n                        re = e + cellOffsetX - params.x;\r\n                    e <= slice.bounds.x2;\r\n                    e++,\r\n                        e2 += 4,\r\n                        re++\r\n                ) {\r\n                    // O = over -> brush-dot\r\n                    // U = under -> image\r\n\r\n                    let alphaO = 0;\r\n                    if (samplesSquared) {\r\n                        for (let f = 0; f < sampleOffsets.length; f += 2) {\r\n                            const dist = BB.lenSquared(re + sampleOffsets[f], ri + sampleOffsets[f + 1]);\r\n                            if (dist >= sizeSquared) {\r\n                                continue;\r\n                            }\r\n                            alphaO += clamp(alphaMinuend - dist / distDivisor, 0, params.opacity);\r\n                        }\r\n                        if (!alphaO) {\r\n                            continue;\r\n                        }\r\n                        alphaO /= samplesSquared;\r\n                    } else {\r\n                        // technically needs + 0.5 offset, but not noticeable with large brush\r\n                        const dist = Math.pow(re, 2) + Math.pow(ri, 2);\r\n                        if (dist >= sizeSquared) {\r\n                            continue;\r\n                        }\r\n                        alphaO = clamp(alphaMinuend - dist / distDivisor, 0, params.opacity);\r\n                    }\r\n\r\n                    const invAlphaO = 1 - alphaO;\r\n                    const alphaU =data[e2 + 3] / 255;\r\n\r\n                    if (this.settingLockLayerAlpha) {\r\n                        const underR = (params.r * alphaO) + ((data[e2]) * invAlphaO);\r\n                        const underG = (params.g * alphaO) + ((data[e2 + 1]) * invAlphaO);\r\n                        const underB = (params.b * alphaO) + ((data[e2 + 2]) * invAlphaO);\r\n                        if (alphaU) {\r\n                            data[e2] = Math.floor(underR + randArr[randI]);\r\n                            data[e2 + 1] = Math.floor(underG + randArr[randI]);\r\n                            data[e2 + 2] = Math.floor(underB + randArr[randI]);\r\n                        }\r\n                    } else {\r\n                        const underR = (params.r * alphaO) + ((data[e2] * alphaU) * invAlphaO);\r\n                        const underG = (params.g * alphaO) + ((data[e2 + 1] * alphaU) * invAlphaO);\r\n                        const underB = (params.b * alphaO) + ((data[e2 + 2] * alphaU) * invAlphaO);\r\n\r\n                        let newAlpha = 1 - invAlphaO * (1 - alphaU);\r\n                        data[e2 + 3] = Math.floor(Math.min(255, newAlpha * 255) + 0.5);\r\n                        if (newAlpha) {\r\n                            data[e2] = Math.floor(underR / (newAlpha) + randArr[randI]);\r\n                            data[e2 + 1] = Math.floor(underG / (newAlpha) + randArr[randI]);\r\n                            data[e2 + 2] = Math.floor(underB / (newAlpha) + randArr[randI]);\r\n                        }\r\n                    }\r\n                    randI = (randI + 1) % randLen;\r\n\r\n                }\r\n            }\r\n\r\n        });\r\n    }\r\n\r\n    private calcSpacing (size: number): number {\r\n        return BB.mix(\r\n            (size * 2) / 2, // until size 5.3\r\n            (size * 2) / 9, // at size 24\r\n            BB.clamp((size - 2.7) / (12 - 2.7), 0, 1)\r\n        );\r\n    }\r\n\r\n    private continueLine (x: number, y: number, p: number, isCoalesced: boolean): void {\r\n\r\n        this.drawBuffer = [];\r\n\r\n        let localPressure;\r\n        let localOpacity;\r\n        let localSize = (this.settingSizePressure) ? Math.max(1, p * this.size) : Math.max(1, this.size);\r\n\r\n        let bdist = this.calcSpacing(localSize);\r\n\r\n        let avgX = x;\r\n        let avgY = y;\r\n        if (x === null) {\r\n            avgX = this.lastInput.x;\r\n            avgY = this.lastInput.y;\r\n        }\r\n\r\n        let localColNew;\r\n\r\n        if (this.blending === 0) {\r\n            this.mixr = this.color.r;\r\n            this.mixg = this.color.g;\r\n            this.mixb = this.color.b;\r\n        } else {\r\n            let average;\r\n            if (isCoalesced) {\r\n                average = {r: this.localColOld.r, g: this.localColOld.g, b: this.localColOld.b, a: 0};\r\n            } else {\r\n                const avgParams = [avgX, avgY, ((this.settingSizePressure) ? Math.max(0.5, p * this.size) : Math.max(0.5, this.size))];\r\n                const bounds = this.prepDot(avgParams[0], avgParams[1], avgParams[2]);\r\n                this.copyFromCanvas(bounds);\r\n                average = this.getAverage(avgParams[0], avgParams[1], avgParams[2]);\r\n            }\r\n            localColNew = {r: 0, g: 0, b: 0, a: 0};\r\n\r\n            if (average.a > 0 && this.blendCol.a === 0) {\r\n                this.blendCol.r = average.r;\r\n                this.blendCol.g = average.g;\r\n                this.blendCol.b = average.b;\r\n                this.blendCol.a = average.a;\r\n                localColNew.r = this.blendCol.r;\r\n                localColNew.g = this.blendCol.g;\r\n                localColNew.b = this.blendCol.b;\r\n                localColNew.a = this.blendCol.a;\r\n\r\n            } else {\r\n                if (average.a === 0) {\r\n                    average.r = this.color.r;\r\n                    average.g = this.color.g;\r\n                    average.b = this.color.b;\r\n                    average.a = 1 - this.blending;\r\n                }\r\n\r\n                this.blendCol.r = BB.mix(this.blendCol.r, BB.mix(this.blendCol.r, average.r, this.blendMix), average.a);\r\n                this.blendCol.g = BB.mix(this.blendCol.g, BB.mix(this.blendCol.g, average.g, this.blendMix), average.a);\r\n                this.blendCol.b = BB.mix(this.blendCol.b, BB.mix(this.blendCol.b, average.b, this.blendMix), average.a);\r\n                this.blendCol.a = Math.min(1, this.blendCol.a + average.a);\r\n                localColNew.r = this.blendCol.r;\r\n                localColNew.g = this.blendCol.g;\r\n                localColNew.b = this.blendCol.b;\r\n                localColNew.a = this.blendCol.a;\r\n            }\r\n\r\n        }\r\n\r\n\r\n        const bezierCallback = (val) => {\r\n            if (this.blending >= 1 && this.blendCol.a <= 0) {\r\n                return;\r\n            }\r\n            let factor = val.t;\r\n            localPressure = this.lastInput2.pressure * (1 - factor) + p * factor;\r\n            localOpacity = (this.settingOpacityPressure) ? (this.opacity * localPressure * localPressure) : this.opacity;\r\n            localSize = (this.settingSizePressure) ? Math.max(0.1, localPressure * this.size) : Math.max(0.1, this.size);\r\n            if (this.blending != 0) {\r\n                this.mixr = BB.mix(this.localColOld.r, localColNew.r, factor);\r\n                this.mixg = BB.mix(this.localColOld.g, localColNew.g, factor);\r\n                this.mixb = BB.mix(this.localColOld.b, localColNew.b, factor);\r\n            }\r\n            if (this.blending === 1 && this.localColOld.a === 0) {\r\n                this.mixr = localColNew.r;\r\n                this.mixg = localColNew.g;\r\n                this.mixb = localColNew.b;\r\n            }\r\n            const bounds = this.prepDot(val.x, val.y, localSize);\r\n            if (bounds) {\r\n                this.updateRedrawBounds(bounds);\r\n                this.drawBuffer.push({\r\n                    x: val.x,\r\n                    y: val.y,\r\n                    size: localSize,\r\n                    opacity: localOpacity,\r\n                    x1: bounds.x1,\r\n                    y1: bounds.y1,\r\n                    x2: bounds.x2,\r\n                    y2: bounds.y2,\r\n                    r: BB.mix(this.color.r, this.mixr, this.blending),\r\n                    g: BB.mix(this.color.g, this.mixg, this.blending),\r\n                    b: BB.mix(this.color.b, this.mixb, this.blending),\r\n                })\r\n            }\r\n        };\r\n\r\n        if (x === null) {\r\n            this.bezierLine.addFinal(bdist, bezierCallback);\r\n        } else {\r\n            this.bezierLine.add(x, y, bdist, bezierCallback);\r\n        }\r\n\r\n        this.copyFromCanvas(this.redrawBounds);\r\n        this.drawBuffer.forEach(item => {\r\n            this.drawDot(item);\r\n        });\r\n        this.drawBuffer = [];\r\n\r\n        this.localColOld = localColNew;\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    // --- public ----\r\n    constructor () {\r\n    }\r\n\r\n    setHistory (h: any): void {\r\n        this.history = h;\r\n    }\r\n\r\n    getSize (): number {\r\n        return this.size;\r\n    }\r\n\r\n    setSize (s: number): void {\r\n        this.size = s;\r\n    }\r\n\r\n    getOpacity (): number {\r\n        return this.opacity;\r\n    }\r\n\r\n    setOpacity (o: number): void {\r\n        this.opacity = o;\r\n    }\r\n\r\n    getBlending (): number {\r\n        return this.blending;\r\n    }\r\n\r\n    setBlending (b: number) {\r\n        this.blending = b;\r\n    }\r\n\r\n    setColor (c: IRGB): void {\r\n        this.color = BB.copyObj(c);\r\n    }\r\n\r\n    setContext (c: CanvasRenderingContext2D) {\r\n        this.context = c;\r\n    }\r\n\r\n    setSizePressure (b: boolean): void {\r\n        this.settingSizePressure = !!b;\r\n    }\r\n\r\n    setOpacityPressure (b: boolean): void {\r\n        this.settingOpacityPressure = !!b;\r\n    }\r\n\r\n    getLockAlpha (): boolean {\r\n        return this.settingLockLayerAlpha;\r\n    }\r\n\r\n    setLockAlpha (b: boolean): void {\r\n        this.settingLockLayerAlpha = !!b;\r\n    }\r\n\r\n    getIsDrawing (): boolean {\r\n        return this.isDrawing;\r\n    }\r\n\r\n    setIsTesting (b: boolean): void {\r\n        this.isTesting = !!b;\r\n    }\r\n\r\n    startLine (x: number, y: number, p: number): void {\r\n        this.historyEntry = {\r\n            tool: [\"brush\", \"BlendBrush\"],\r\n            actions: []\r\n        };\r\n\r\n\r\n        const totalCells = Math.ceil(this.context.canvas.width / cellSize) * Math.ceil(this.context.canvas.height / cellSize);\r\n        this.cells = '0'.repeat(totalCells).split('').map(item => null);\r\n\r\n        this.isDrawing = true;\r\n\r\n        p = Math.max(0, Math.min(1, p));\r\n        let localOpacity = (this.settingOpacityPressure) ? (this.opacity * p * p) : this.opacity;\r\n        let localSize = (this.settingSizePressure) ? Math.max(0.1, p * this.size) : Math.max(0.1, this.size);\r\n        if (this.blending === 0) {\r\n            this.mixr = this.color.r;\r\n            this.mixg = this.color.g;\r\n            this.mixb = this.color.b;\r\n        } else {\r\n            this.copyFromCanvas(this.prepDot(x, y, localSize));\r\n\r\n            let average = this.getAverage(\r\n                x,\r\n                y,\r\n                ((this.settingSizePressure) ? Math.max(0.1, p * this.size) : Math.max(0.1, this.size))\r\n            );\r\n            if (average.a === 0) {\r\n                this.blendCol = {\r\n                    r: this.color.r,\r\n                    g: this.color.g,\r\n                    b: this.color.b,\r\n                    a: 1 - this.blending,\r\n                };\r\n            } else {\r\n                this.blendCol = {\r\n                    r: average.r,\r\n                    g: average.g,\r\n                    b: average.b,\r\n                    a: average.a,\r\n                };\r\n            }\r\n\r\n            this.mixr = this.blendCol.r;\r\n            this.mixg = this.blendCol.g;\r\n            this.mixb = this.blendCol.b;\r\n        }\r\n\r\n        this.localColOld = {r: this.mixr, g: this.mixg, b: this.mixb, a: this.blendCol.a};\r\n\r\n        this.redrawBounds = null;\r\n        this.drawBuffer = [];\r\n\r\n        if (this.blending < 1 || this.blendCol.a > 0) {\r\n            const bounds = this.prepDot(x, y, localSize);\r\n            if (bounds) {\r\n                this.updateRedrawBounds(bounds);\r\n                this.drawBuffer.push({\r\n                    x: x,\r\n                    y: y,\r\n                    size: localSize,\r\n                    opacity: localOpacity,\r\n                    x1: bounds.x1,\r\n                    y1: bounds.y1,\r\n                    x2: bounds.x2,\r\n                    y2: bounds.y2,\r\n                    r: BB.mix(this.color.r, this.mixr, this.blending),\r\n                    g: BB.mix(this.color.g, this.mixg, this.blending),\r\n                    b: BB.mix(this.color.b, this.mixb, this.blending),\r\n                })\r\n            }\r\n        }\r\n\r\n        this.copyFromCanvas(this.redrawBounds);\r\n        this.drawBuffer.forEach(item => {\r\n            this.drawDot(item);\r\n        });\r\n        this.drawBuffer = [];\r\n\r\n        this.bezierLine = new BB.BezierLine();\r\n        this.bezierLine.add(x, y, 0, function () {\r\n        });\r\n\r\n        this.lastInput.x = x;\r\n        this.lastInput.y = y;\r\n        this.lastInput.pressure = p;\r\n        this.lastInput2 = BB.copyObj(this.lastInput);\r\n\r\n        if (this.redrawBounds && !this.isTesting) {\r\n            this.drawChangedCells();\r\n        }\r\n    }\r\n\r\n    goLine (x: number, y: number, p: number, isCoalesced: boolean): void {\r\n        if (!this.isDrawing) {\r\n            return;\r\n        }\r\n        this.continueLine(x, y, this.lastInput.pressure, isCoalesced);\r\n\r\n        this.lastInput2 = BB.copyObj(this.lastInput);\r\n        this.lastInput.x = x;\r\n        this.lastInput.y = y;\r\n        this.lastInput.pressure = p;\r\n\r\n        if (this.redrawBounds && !this.isTesting) {\r\n            this.drawChangedCells();\r\n        }\r\n    }\r\n\r\n    endLine (): void {\r\n        if (this.bezierLine) {\r\n            this.continueLine(null, null, this.lastInput.pressure, false);\r\n        }\r\n\r\n        this.isDrawing = false;\r\n        this.bezierLine = null;\r\n\r\n        if (this.redrawBounds) {\r\n            this.drawChangedCells();\r\n        }\r\n\r\n        if (this.historyEntry && this.history && this.cells.find(item => !!item)) {\r\n            this.historyEntry.actions.push({\r\n                action: \"drawCells\",\r\n                params: [this.cells],\r\n            });\r\n            this.history.add(this.historyEntry);\r\n            this.historyEntry = null;\r\n        }\r\n        this.cells = null;\r\n    }\r\n\r\n    /**\r\n     * draw cells onto context\r\n     * @param cells\r\n     */\r\n    drawCells (cells: (ImageData | null)[]): void {\r\n        const cellsW = this.getCellsWidth();\r\n        cells.forEach((imageData, index) => {\r\n            if (!imageData) {\r\n                return;\r\n            }\r\n            const cellOffsetX = (index % cellsW) * cellSize;\r\n            const cellOffsetY = Math.floor(index / cellsW) * cellSize;\r\n            this.context.putImageData(imageData, cellOffsetX, cellOffsetY);\r\n        });\r\n    }\r\n\r\n    drawLineSegment (x1: number, y1: number, x2: number, y2: number): void {\r\n        this.lastInput.x = x2;\r\n        this.lastInput.y = y2;\r\n\r\n        if (this.isDrawing || x1 === undefined) {\r\n            return;\r\n        }\r\n\r\n        const totalCells = Math.ceil(this.context.canvas.width / cellSize) * Math.ceil(this.context.canvas.height / cellSize);\r\n        this.cells = '0'.repeat(totalCells).split('').map(item => null);\r\n        this.redrawBounds = null;\r\n        this.drawBuffer = [];\r\n\r\n        this.copyFromCanvas(this.prepDot(x1, y1, Math.max(0.1, this.size)));\r\n        let average = this.getAverage(x1, y1, Math.max(0.1, this.size));\r\n\r\n        if (average.a === 0) {\r\n            this.blendCol = {\r\n                r: this.color.r,\r\n                g: this.color.g,\r\n                b: this.color.b,\r\n                a: 1 - this.blending,\r\n            };\r\n        } else {\r\n            this.blendCol = {\r\n                r: average.r,\r\n                g: average.g,\r\n                b: average.b,\r\n                a: average.a,\r\n            };\r\n        }\r\n\r\n        this.mixr = this.color.r * (1 - this.blendCol.a) + (this.blending * this.blendCol.r + this.color.r * (1 - this.blending)) * this.blendCol.a;\r\n        this.mixg = this.color.g * (1 - this.blendCol.a) + (this.blending * this.blendCol.g + this.color.g * (1 - this.blending)) * this.blendCol.a;\r\n        this.mixb = this.color.b * (1 - this.blendCol.a) + (this.blending * this.blendCol.b + this.color.b * (1 - this.blending)) * this.blendCol.a;\r\n\r\n\r\n        const p = 1;\r\n        const localOpacity = (this.settingOpacityPressure) ? (this.opacity * p * p) : this.opacity;\r\n        const localSize = (this.settingSizePressure) ? Math.max(0.1, p * this.size) : Math.max(0.1, this.size);\r\n\r\n\r\n        const mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\r\n        const eX = (x2 - x1) / mouseDist;\r\n        const eY = (y2 - y1) / mouseDist;\r\n        const bdist = this.calcSpacing(localSize);\r\n        for (let loopDist = 0; loopDist <= mouseDist; loopDist += bdist) {\r\n            const bounds = this.prepDot(x1 + eX * loopDist, y1 + eY * loopDist, localSize);\r\n            if (bounds) {\r\n                this.copyFromCanvas(bounds);\r\n                this.drawBuffer.push({\r\n                    x: x1 + eX * loopDist,\r\n                    y: y1 + eY * loopDist,\r\n                    size: localSize,\r\n                    opacity: localOpacity,\r\n                    x1: bounds.x1,\r\n                    y1: bounds.y1,\r\n                    x2: bounds.x2,\r\n                    y2: bounds.y2,\r\n                    r: BB.mix(this.color.r, this.mixr, this.blending),\r\n                    g: BB.mix(this.color.g, this.mixg, this.blending),\r\n                    b: BB.mix(this.color.b, this.mixb, this.blending),\r\n                })\r\n            }\r\n        }\r\n        this.drawBuffer.forEach(item => {\r\n            this.drawDot(item);\r\n        });\r\n        this.drawBuffer = [];\r\n\r\n        if (this.history && this.cells.find(item => !!item)) {\r\n            this.drawCells(this.cells);\r\n            this.historyEntry = {\r\n                tool: [\"brush\", \"BlendBrush\"],\r\n                actions: [{\r\n                    action: \"drawCells\",\r\n                    params: [this.cells],\r\n                }],\r\n            };\r\n            this.history.add(this.historyEntry);\r\n            this.historyEntry = null;\r\n        }\r\n        this.cells = null;\r\n    }\r\n}\r\n","import {BB} from '../../bb/bb';\r\n\r\nconst sampleCanvas = BB.canvas(32, 32);\r\nconst sampleCtx = sampleCanvas.getContext('2d');\r\n\r\nexport function sketchyBrush() {\r\n    let debugStr = '';\r\n    let context;\r\n    let settingColor;\r\n\r\n    let settingSize = 1, settingOpacity = 0.2;\r\n    let settingBlending = 0.5;\r\n    let settingScale = 1;\r\n\r\n    let lastX, lastY;\r\n    let isDrawing = false;\r\n    let lastInput = {x: 0, y: 0, pressure: 0};\r\n    let history = {\r\n        add: function (p?) {\r\n        }\r\n    };\r\n    let sketchySeed = 0;\r\n    this.setHistory = function (l) {\r\n        history = l;\r\n    };\r\n    let historyEntry;\r\n    this.setSeed = function (s) {\r\n        sketchySeed = parseInt(s);\r\n    };\r\n    this.getSeed = function () {\r\n        return parseInt('' + sketchySeed);\r\n    };\r\n\r\n    function rand() {\r\n        sketchySeed++;\r\n        return Math.sin(6324634.2345 * Math.cos(sketchySeed * 5342.3423)) * 0.5 + 0.5;\r\n    }\r\n\r\n    let points = [];\r\n    let count = 0;\r\n    let mixmode = [\r\n        function (c1, c2) {\r\n            return c1;\r\n        },\r\n        function (c1, c2) {\r\n            let result = new BB.RGB(c1.r, c1.g, c1.b);\r\n            result.r *= c2.r / 255;\r\n            result.g *= c2.g / 255;\r\n            result.b *= c2.b / 255;\r\n            return result;\r\n        },\r\n        function (c1, c2) {\r\n            let result = new BB.RGB(c1.r, c1.g, c1.b);\r\n            result.r *= c2.r / 255;\r\n            result.g *= c2.g / 255;\r\n            result.b *= c2.b / 255;\r\n            return result;\r\n        }\r\n    ];\r\n\r\n    this.getSize = function () {\r\n        return settingSize / 2;\r\n    };\r\n    this.setColor = function (c) {\r\n        settingColor = c;\r\n    };\r\n    this.getOpacity = function () {\r\n        return settingOpacity;\r\n    };\r\n    this.setOpacity = function (o) {\r\n        settingOpacity = o;\r\n    };\r\n    this.getBlending = function () {\r\n        return settingBlending;\r\n    };\r\n    this.setBlending = function (b) {\r\n        settingBlending = b;\r\n    };\r\n    this.setSize = function (s) {\r\n        settingSize = s * 2;\r\n    };\r\n    this.getScale = function () {\r\n        return settingScale;\r\n    };\r\n    this.setScale = function (s) {\r\n        settingScale = s;\r\n    };\r\n    this.setContext = function (c) {\r\n        context = c;\r\n    };\r\n    this.startLine = function (x, y, pressure, shift) {\r\n        if (shift && lastInput.x) {\r\n            let lx = lastInput.x, ly = lastInput.y;\r\n            isDrawing = true;\r\n            //this.goLine(x,y,pressure);\r\n            this.endLine();\r\n        } else {\r\n            isDrawing = true;\r\n            lastX = x;\r\n            lastY = y;\r\n            lastInput.x = x;\r\n            lastInput.y = y;\r\n            historyEntry = {\r\n                tool: [\"brush\", \"sketchy\"],\r\n                actions: []\r\n            };\r\n            historyEntry.actions.push({\r\n                action: \"setScale\",\r\n                params: [settingScale]\r\n            });\r\n            historyEntry.actions.push({\r\n                action: \"setSize\",\r\n                params: [settingSize / 2]\r\n            });\r\n            historyEntry.actions.push({\r\n                action: \"setOpacity\",\r\n                params: [settingOpacity]\r\n            });\r\n            historyEntry.actions.push({\r\n                action: \"setColor\",\r\n                params: [settingColor]\r\n            });\r\n            historyEntry.actions.push({\r\n                action: \"setBlending\",\r\n                params: [settingBlending]\r\n            });\r\n            historyEntry.actions.push({\r\n                action: \"startLine\",\r\n                params: [x, y, pressure]\r\n            });\r\n        }\r\n\r\n    };\r\n    this.goLine = function (p_x, p_y, pressure, preMixedColor) {\r\n        if (!isDrawing || (p_x === lastInput.x && p_y === lastInput.y)) {\r\n            return;\r\n        }\r\n\r\n        let e, b, a, g;\r\n        let x = parseInt(p_x);\r\n        let y = parseInt(p_y);\r\n        points.push([x, y]);\r\n\r\n        let mixr = settingColor.r;\r\n        let mixg = settingColor.g;\r\n        let mixb = settingColor.b;\r\n\r\n        if (preMixedColor !== null) {\r\n            mixr = preMixedColor.r;\r\n            mixg = preMixedColor.g;\r\n            mixb = preMixedColor.b;\r\n        } else {\r\n            if (settingBlending !== 0) {\r\n                if (x + 5 >= 0 && y + 5 >= 0 && x - 5 < context.canvas.width - 1 && y - 5 < context.canvas.height - 1) {\r\n                    mixr = 0;\r\n                    mixg = 0;\r\n                    mixb = 0;\r\n                    let mixx = Math.min(context.canvas.width - 1, Math.max(0, x - 5));\r\n                    let mixy = Math.min(context.canvas.height - 1, Math.max(0, y - 5));\r\n                    let mixw = Math.min(context.canvas.width - 1, Math.max(0, x + 5));\r\n                    let mixh = Math.min(context.canvas.height - 1, Math.max(0, y + 5));\r\n                    mixw -= mixx;\r\n                    mixh -= mixy;\r\n\r\n                    if (mixw > 0 && mixh > 0) {\r\n                        let imdat = context.getImageData(mixx, mixy, mixw, mixh);\r\n                        let countmix = 0;\r\n                        for (let i = 0; i < imdat.data.length; i += 4) {\r\n                            mixr += imdat.data[i + 0];\r\n                            mixg += imdat.data[i + 1];\r\n                            mixb += imdat.data[i + 2];\r\n                            countmix++;\r\n                        }\r\n                        mixr /= countmix;\r\n                        mixg /= countmix;\r\n                        mixb /= countmix;\r\n                    }\r\n\r\n                    let mixed = mixmode[0](new BB.RGB(mixr, mixg, mixb), settingColor);\r\n                    mixr = parseInt('' + BB.mix(settingColor.r, mixed.r, settingBlending));\r\n                    mixg = parseInt('' + BB.mix(settingColor.g, mixed.g, settingBlending));\r\n                    mixb = parseInt('' + BB.mix(settingColor.b, mixed.b, settingBlending));\r\n                }\r\n            }\r\n        }\r\n\r\n        context.save();\r\n        context.strokeStyle = \"rgba(\" + mixr + \", \" + mixg + \", \" + mixb + \", \" + settingOpacity + \")\";\r\n        context.lineWidth = settingSize;\r\n\r\n        context.beginPath();\r\n        context.moveTo(lastX, lastY);\r\n        context.lineTo(x, y);\r\n\r\n        for (e = 0; e < points.length; e++) {\r\n            b = points[e][0] - points[count][0];\r\n            a = points[e][1] - points[count][1];\r\n            g = b * b + a * a;\r\n            if (g < 4000 * settingScale * settingScale && rand() > g / 2000 / settingScale / settingScale) {\r\n                context.moveTo(points[count][0] + (b * 0.3), points[count][1] + (a * 0.3));\r\n                context.lineTo(points[e][0] - (b * 0.3), points[e][1] - (a * 0.3));\r\n            }\r\n        }\r\n\r\n        context.stroke();\r\n        context.restore();\r\n\r\n\r\n        count++;\r\n        lastX = x;\r\n        lastY = y;\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        historyEntry.actions.push({\r\n            action: \"goLine\",\r\n            params: [p_x, p_y, pressure, {r: mixr, g: mixg, b: mixb}]\r\n        });\r\n    };\r\n    this.endLine = function () {\r\n        isDrawing = false;\r\n        count = 0;\r\n        points = [];\r\n        if (historyEntry) {\r\n            historyEntry.actions.push({\r\n                action: \"endLine\",\r\n                params: []\r\n            });\r\n            history.add(historyEntry);\r\n            historyEntry = undefined;\r\n        }\r\n    };\r\n    //cheap n' ugly\r\n    this.drawLineSegment = function (x1, y1, x2, y2) {\r\n        lastInput.x = x2;\r\n        lastInput.y = y2;\r\n\r\n        if (isDrawing || x1 === undefined) {\r\n            return;\r\n        }\r\n\r\n\r\n        context.save();\r\n        context.lineWidth = settingSize;\r\n\r\n        let mixr = settingColor.r, mixg = settingColor.g, mixb = settingColor.b;\r\n        if (x1 + 5 >= 0 && y1 + 5 >= 0 && x1 - 5 < context.canvas.width - 1 && y1 - 5 < context.canvas.height - 1) {\r\n            mixr = 0;\r\n            mixg = 0;\r\n            mixb = 0;\r\n            let mixx = Math.min(context.canvas.width - 1, Math.max(0, x1 - 5));\r\n            let mixy = Math.min(context.canvas.height - 1, Math.max(0, y1 - 5));\r\n            let mixw = Math.min(context.canvas.width - 1, Math.max(0, x1 + 5));\r\n            let mixh = Math.min(context.canvas.height - 1, Math.max(0, y1 + 5));\r\n            mixw -= mixx;\r\n            mixh -= mixy;\r\n            if (mixw > 0 && mixh > 0) {\r\n                let w = Math.min(sampleCanvas.width, mixw);\r\n                let h = Math.min(sampleCanvas.height, mixh);\r\n                sampleCtx.save();\r\n                sampleCtx.globalCompositeOperation = 'copy';\r\n                sampleCtx.drawImage(context.canvas, mixx, mixy, mixw, mixh, 0, 0, w, h);\r\n                sampleCtx.restore();\r\n\r\n                let imdat = sampleCtx.getImageData(mixx, mixy, mixw, mixh);\r\n                let countmix = 0;\r\n                for (let i = 0; i < imdat.data.length; i += 4) {\r\n                    mixr += imdat.data[i + 0];\r\n                    mixg += imdat.data[i + 1];\r\n                    mixb += imdat.data[i + 2];\r\n                    countmix++;\r\n                }\r\n                mixr /= countmix;\r\n                mixg /= countmix;\r\n                mixb /= countmix;\r\n            }\r\n        }\r\n        let mixed = mixmode[0](new BB.RGB(mixr, mixg, mixb), settingColor);\r\n        mixr = parseInt('' + (settingBlending * mixed.r + settingColor.r * (1 - settingBlending)));\r\n        mixg = parseInt('' + (settingBlending * mixed.g + settingColor.g * (1 - settingBlending)));\r\n        mixb = parseInt('' + (settingBlending * mixed.b + settingColor.b * (1 - settingBlending)));\r\n        context.strokeStyle = \"rgba(\" + mixr + \", \" + mixg + \", \" + mixb + \", \" + settingOpacity + \")\";\r\n        context.beginPath();\r\n        context.moveTo(x1, y1);\r\n        context.lineTo(x2, y2);\r\n        context.stroke();\r\n        context.strokeStyle = \"rgba(\" + mixr + \", \" + mixg + \", \" + mixb + \", \" + settingOpacity + \")\";\r\n        context.restore();\r\n\r\n\r\n        let historyEntry = {\r\n            tool: [\"brush\", \"sketchy\"],\r\n            actions: []\r\n        };\r\n        historyEntry.actions.push({\r\n            action: \"setScale\",\r\n            params: [settingScale]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSize\",\r\n            params: [settingSize / 2]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setOpacity\",\r\n            params: [settingOpacity]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setColor\",\r\n            params: [settingColor]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setBlending\",\r\n            params: [settingBlending]\r\n        });\r\n\r\n        historyEntry.actions.push({\r\n            action: \"drawLineSegment\",\r\n            params: [x1, y1, x2, y2]\r\n        });\r\n        history.add(historyEntry);\r\n    };\r\n\r\n    this.isDrawing = function () {\r\n        return isDrawing;\r\n    };\r\n    this.setDebug = function (str) {\r\n        debugStr = str;\r\n    };\r\n}","import {BB} from '../../bb/bb';\r\n\r\nexport function pixelBrush() {\r\n\r\n    let _this = this;\r\n    let debugStr = '';\r\n    let context;\r\n    let history = {\r\n        add: function (p?) {\r\n        }\r\n    }, historyEntry;\r\n\r\n    let settingColor, settingSize = 0.5, settingSpacing = 0.9, settingOpacity = 1;\r\n    let settingColorStr;\r\n    let settingHasSizePressure = true, settingHasOpacityPressure = false;\r\n    let settingLockLayerAlpha = false;\r\n    let settingIsEraser = false;\r\n    let settingUseDither = true;\r\n\r\n    let lineToolLastDot;\r\n    let lastInput = {x: 0, y: 0, pressure: 0};\r\n    let lastInput2 = {x: 0, y: 0, pressure: 0};\r\n\r\n    let isDrawing = false;\r\n    let bezierLine = null;\r\n    let twoPI = Math.PI * 2;\r\n\r\n\r\n    let ditherCanvas = BB.canvas(4, 4);\r\n    let ditherCtx = ditherCanvas.getContext('2d');\r\n    let ditherPattern;\r\n    let ditherArr = [\r\n        [3, 2],\r\n        [1, 0],\r\n        [3, 0],\r\n        [1, 2],\r\n        [2, 1],\r\n        [0, 3],\r\n        [0, 1],\r\n        [2, 3],\r\n\r\n        [2, 0],\r\n        [0, 2],\r\n        [0, 0],\r\n        [2, 2],\r\n        [1, 1],\r\n        [3, 3],\r\n        [3, 1],\r\n        [1, 3]\r\n    ];\r\n\r\n    function updateDither() {\r\n        ditherCtx.clearRect(0, 0, 4, 4);\r\n        ditherCtx.fillStyle = settingIsEraser ? '#fff' : settingColorStr;\r\n        for (let i = 0; i < Math.max(1, Math.round(settingOpacity * ditherArr.length)); i++) {\r\n            ditherCtx.fillRect(ditherArr[i][0], ditherArr[i][1], 1, 1);\r\n        }\r\n        ditherPattern = context.createPattern(ditherCanvas, 'repeat');\r\n    }\r\n\r\n\r\n    /**\r\n     * Tests p1->p2 or p3->p4 deviate in their direction more than max, compared to p1->p4\r\n     * @param p1\r\n     * @param p2\r\n     * @param p3\r\n     * @param p4\r\n     * @param maxAngleRad\r\n     */\r\n    function cubicCurveOverThreshold(p1, p2, p3, p4, max) {\r\n        let d = BB.Vec2.nor({\r\n            x: p4.x - p1.x,\r\n            y: p4.y - p1.y\r\n        });\r\n        let d2 = BB.Vec2.nor({\r\n            x: p2.x - p1.x,\r\n            y: p2.y - p1.y\r\n        });\r\n        let d3 = BB.Vec2.nor({\r\n            x: p4.x - p3.x,\r\n            y: p4.y - p3.y\r\n        });\r\n        let a2 = Math.abs(BB.Vec2.angle(d, d2) % Math.PI) / Math.PI * 180;\r\n        let a3 = Math.abs(BB.Vec2.angle(d, d3) % Math.PI) / Math.PI * 180;\r\n\r\n        return Math.max(BB.Vec2.dist(d, d2), BB.Vec2.dist(d, d3)) > max;\r\n    }\r\n\r\n    //bresenheim line drawing\r\n    function plotLine(x0, y0, x1, y1, skipFirst) {\r\n        context.save();\r\n\r\n        if (settingIsEraser) {\r\n            context.fillStyle = settingUseDither ? ditherPattern : '#fff';\r\n            if (settingLockLayerAlpha) {\r\n                context.globalCompositeOperation = \"source-atop\";\r\n            } else {\r\n                context.globalCompositeOperation = \"destination-out\";\r\n            }\r\n        } else {\r\n            context.fillStyle = settingUseDither ? ditherPattern : settingColorStr;\r\n            if (settingLockLayerAlpha) {\r\n                context.globalCompositeOperation = \"source-atop\";\r\n            }\r\n        }\r\n        context.globalAlpha = settingUseDither ? 1 : settingOpacity;\r\n\r\n        x0 = Math.floor(x0);\r\n        y0 = Math.floor(y0);\r\n        x1 = Math.floor(x1);\r\n        y1 = Math.floor(y1);\r\n\r\n        let dX = Math.abs(x1 - x0);\r\n        let sX = x0 < x1 ? 1 : -1;\r\n        let dY = -Math.abs(y1 - y0);\r\n        let sY = y0 < y1 ? 1 : -1;\r\n        let err = dX + dY;\r\n        while (true) {\r\n            if (skipFirst) {\r\n                skipFirst = false;\r\n            } else {\r\n                context.fillRect(x0, y0, 1, 1);\r\n            }\r\n            if (x0 === x1 && y0 === y1) {\r\n                break;\r\n            }\r\n            let e2 = 2 * err;\r\n            if (e2 >= dY) {\r\n                err += dY;\r\n                x0 += sX;\r\n            }\r\n            if (e2 <= dX) {\r\n                err += dX;\r\n                y0 += sY;\r\n            }\r\n        }\r\n\r\n        context.restore();\r\n    }\r\n\r\n    function plotCubicBezierLine(p1, p2, p3, p4) {\r\n\r\n        let isOverThreshold = cubicCurveOverThreshold(p1, p2, p3, p4, 0.1);\r\n\r\n        p1.x = Math.floor(p1.x);\r\n        p1.y = Math.floor(p1.y);\r\n        p4.x = Math.floor(p4.x);\r\n        p4.y = Math.floor(p4.y);\r\n\r\n        let dist = BB.dist(p1.x, p1.y, p4.x, p4.y);\r\n        if (!isOverThreshold || dist < 7) {\r\n            plotLine(p1.x, p1.y, p4.x, p4.y, true);\r\n            return;\r\n        }\r\n\r\n        let n = Math.max(2, Math.round(dist / 4));\r\n        let pointArr = [];\r\n        for (let i = 0; i <= n; i++) {\r\n            let t = i / n;\r\n            let a = Math.pow(1 - t, 3);\r\n            let b = 3 * t * Math.pow(1 - t, 2);\r\n            let c = 3 * Math.pow(t, 2) * (1 - t);\r\n            let d = Math.pow(t, 3);\r\n            pointArr.push({\r\n                x: a * p1.x + b * p2.x + c * p3.x + d * p4.x,\r\n                y: a * p1.y + b * p2.y + c * p3.y + d * p4.y\r\n            });\r\n        }\r\n\r\n        for (let i = 0; i < n; i++) {\r\n            plotLine(\r\n                Math.round(pointArr[i].x),\r\n                Math.round(pointArr[i].y),\r\n                Math.round(pointArr[i + 1].x),\r\n                Math.round(pointArr[i + 1].y),\r\n                true\r\n            );\r\n        }\r\n    }\r\n\r\n    function drawDot(x, y, size, opacity, angle?) {\r\n        context.save();\r\n        if (settingIsEraser) {\r\n            context.fillStyle = settingUseDither ? ditherPattern : '#fff';\r\n            if (settingLockLayerAlpha) {\r\n                context.globalCompositeOperation = \"source-atop\";\r\n            } else {\r\n                context.globalCompositeOperation = \"destination-out\";\r\n            }\r\n        } else {\r\n            context.fillStyle = settingUseDither ? ditherPattern : settingColorStr;\r\n            if (settingLockLayerAlpha) {\r\n                context.globalCompositeOperation = \"source-atop\";\r\n            }\r\n        }\r\n        context.globalAlpha = settingUseDither ? 1 : opacity;\r\n        context.fillRect(\r\n            Math.round(x + -size),\r\n            Math.round(y + -size),\r\n            Math.round(size * 2),\r\n            Math.round(size * 2)\r\n        );\r\n        context.restore();\r\n    }\r\n\r\n\r\n    function continueLine(x, y, size, pressure) {\r\n        if (bezierLine === null) {\r\n            bezierLine = new BB.BezierLine();\r\n            bezierLine.add(lastInput.x, lastInput.y, 0, function () {\r\n            });\r\n        }\r\n\r\n        context.save();\r\n\r\n        function dotCallback(val) {\r\n            let localPressure = BB.mix(lastInput2.pressure, pressure, val.t);\r\n            let localOpacity = settingOpacity * (settingHasOpacityPressure ? (localPressure * localPressure) : 1);\r\n            let localSize = Math.max(0.5, settingSize * (settingHasSizePressure ? localPressure : 1));\r\n            drawDot(val.x, val.y, localSize, localOpacity, val.angle);\r\n        }\r\n\r\n        function controlCallback(controlObj) {\r\n            plotCubicBezierLine(controlObj.p1, controlObj.p2, controlObj.p3, controlObj.p4);\r\n        }\r\n\r\n        if (Math.round(settingSize * 2) === 1) {\r\n            if (x === null) {\r\n                bezierLine.addFinal(4, null, controlCallback);\r\n            } else {\r\n                bezierLine.add(x, y, 4, null, controlCallback);\r\n            }\r\n\r\n        } else {\r\n            let localSpacing = size * settingSpacing;\r\n\r\n            if (x === null) {\r\n                bezierLine.addFinal(localSpacing, dotCallback);\r\n            } else {\r\n                bezierLine.add(x, y, localSpacing, dotCallback);\r\n            }\r\n        }\r\n\r\n        context.restore();\r\n    }\r\n\r\n    //------------------ interface ---------------------------------------------------\r\n\r\n\r\n    this.startLine = function (x, y, p) {\r\n        historyEntry = {\r\n            tool: [\"brush\", \"pixel\"],\r\n            actions: []\r\n        };\r\n        historyEntry.actions.push({\r\n            action: \"sizePressure\",\r\n            params: [settingHasSizePressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSize\",\r\n            params: [settingSize]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSpacing\",\r\n            params: [settingSpacing]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setOpacity\",\r\n            params: [settingOpacity]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setColor\",\r\n            params: [settingColor]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setLockAlpha\",\r\n            params: [settingLockLayerAlpha]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setIsEraser\",\r\n            params: [settingIsEraser]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setUseDither\",\r\n            params: [settingUseDither]\r\n        });\r\n\r\n        if (settingUseDither) {\r\n            updateDither();\r\n        }\r\n\r\n        p = Math.max(0, Math.min(1, p));\r\n        let localOpacity = settingHasOpacityPressure ? (settingOpacity * p * p) : settingOpacity;\r\n        let localSize = settingHasSizePressure ? Math.max(0.5, p * settingSize) : Math.max(0.5, settingSize);\r\n\r\n        isDrawing = true;\r\n        drawDot(x, y, localSize, localOpacity);\r\n        lineToolLastDot = localSize * settingSpacing;\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        lastInput.pressure = p;\r\n        lastInput2 = BB.copyObj(lastInput);\r\n\r\n        historyEntry.actions.push({\r\n            action: \"startLine\",\r\n            params: [x, y, p]\r\n        });\r\n    };\r\n\r\n    this.goLine = function (x, y, p) {\r\n        if (!isDrawing) {\r\n            return;\r\n        }\r\n        historyEntry.actions.push({\r\n            action: \"goLine\",\r\n            params: [x, y, p]\r\n        });\r\n\r\n        //debug\r\n        //drawDot(x, y, 1, 0.5);\r\n\r\n        let pressure = BB.clamp(p, 0, 1);\r\n        let localSize = settingHasSizePressure ? Math.max(0.1, lastInput.pressure * settingSize) : Math.max(0.1, settingSize);\r\n\r\n        continueLine(x, y, localSize, lastInput.pressure);\r\n\r\n        lastInput2 = BB.copyObj(lastInput);\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        lastInput.pressure = pressure;\r\n    };\r\n\r\n    this.endLine = function (x, y) {\r\n\r\n        let localSize = settingHasSizePressure ? Math.max(0.1, lastInput.pressure * settingSize) : Math.max(0.1, settingSize);\r\n        continueLine(null, null, localSize, lastInput.pressure);\r\n\r\n        //debug\r\n        //drawDot(lastInput.x, lastInput.y, 3, 1);\r\n        //drawDot(x, y, 10, 0.1);\r\n\r\n        isDrawing = false;\r\n\r\n        bezierLine = null;\r\n\r\n        if (historyEntry) {\r\n            historyEntry.actions.push({\r\n                action: \"endLine\",\r\n                params: [x, y]\r\n            });\r\n            history.add(historyEntry);\r\n            historyEntry = undefined;\r\n        }\r\n    };\r\n    //cheap n' ugly\r\n    this.drawLineSegment = function (x1, y1, x2, y2) {\r\n        lastInput.x = x2;\r\n        lastInput.y = y2;\r\n        lastInput.pressure = 1;\r\n\r\n        if (isDrawing || x1 === undefined) {\r\n            return;\r\n        }\r\n\r\n\r\n        if (Math.round(settingSize * 2) === 1) {\r\n            plotLine(x1, y1, x2, y2, true);\r\n        } else {\r\n            let angle = BB.pointsToAngleDeg({x: x1, y: y1}, {x: x2, y: y2});\r\n            let mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\r\n            let eX = (x2 - x1) / mouseDist;\r\n            let eY = (y2 - y1) / mouseDist;\r\n            let loopDist;\r\n            let bdist = settingSize * settingSpacing;\r\n            lineToolLastDot = settingSize * settingSpacing;\r\n            for (loopDist = lineToolLastDot; loopDist <= mouseDist; loopDist += bdist) {\r\n                drawDot(x1 + eX * loopDist, y1 + eY * loopDist, settingSize, settingOpacity, angle);\r\n            }\r\n        }\r\n\r\n        let historyEntry = {\r\n            tool: [\"brush\", \"pixel\"],\r\n            actions: []\r\n        };\r\n        historyEntry.actions.push({\r\n            action: \"sizePressure\",\r\n            params: [settingHasSizePressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSize\",\r\n            params: [settingSize]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSpacing\",\r\n            params: [settingSpacing]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setOpacity\",\r\n            params: [settingOpacity]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setColor\",\r\n            params: [settingColor]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setLockAlpha\",\r\n            params: [settingLockLayerAlpha]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setIsEraser\",\r\n            params: [settingIsEraser]\r\n        });\r\n\r\n        historyEntry.actions.push({\r\n            action: \"drawLineSegment\",\r\n            params: [x1, y1, x2, y2]\r\n        });\r\n        history.add(historyEntry);\r\n    };\r\n\r\n    //IS\r\n    this.isDrawing = function () {\r\n        return isDrawing;\r\n    };\r\n    //SET\r\n    this.setColor = function (c) {\r\n        if (settingColor === c) {\r\n            return;\r\n        }\r\n        settingColor = c;\r\n        settingColorStr = \"rgb(\" + settingColor.r + \",\" + settingColor.g + \",\" + settingColor.b + \")\";\r\n    };\r\n    this.setContext = function (c) {\r\n        context = c;\r\n    };\r\n    this.setHistory = function (l) {\r\n        history = l;\r\n    };\r\n    this.setSize = function (s) {\r\n        settingSize = s;\r\n    };\r\n    this.setOpacity = function (o) {\r\n        settingOpacity = o;\r\n    };\r\n    this.setSpacing = function (s) {\r\n        settingSpacing = s;\r\n    };\r\n    this.sizePressure = function (b) {\r\n        settingHasSizePressure = b;\r\n    };\r\n    this.opacityPressure = function (b) {\r\n        settingHasOpacityPressure = b;\r\n    };\r\n    this.setLockAlpha = function (b) {\r\n        settingLockLayerAlpha = b;\r\n    };\r\n    this.setIsEraser = function (b) {\r\n        settingIsEraser = !!b;\r\n    };\r\n    this.setUseDither = function (b) {\r\n        settingUseDither = !!b;\r\n    };\r\n    //GET\r\n    this.getSpacing = function () {\r\n        return settingSpacing;\r\n    };\r\n    this.getSize = function () {\r\n        return settingSize;\r\n    };\r\n    this.getOpacity = function () {\r\n        return settingOpacity;\r\n    };\r\n    this.getLockAlpha = function () {\r\n        return settingLockLayerAlpha;\r\n    };\r\n    this.getIsEraser = function () {\r\n        return settingIsEraser;\r\n    };\r\n    this.getUseDither = function () {\r\n        return settingUseDither;\r\n    };\r\n    this.setDebug = function (str) {\r\n        debugStr = str;\r\n    };\r\n}","import {BB} from '../../bb/bb';\r\n\r\nexport function eraserBrush() {\r\n    let debugStr = '';\r\n    let context;\r\n    let history = {\r\n        add: function (p?) {\r\n        }\r\n    }, historyEntry;\r\n\r\n    let size = 30, spacing = 0.4, opacity = 1;\r\n    let sizePressure = true, opacityPressure = false;\r\n    let lastDot, lastInput = {x: 0, y: 0, pressure: 0};\r\n    let lastInput2 = {x: 0, y: 0, pressure: 0};\r\n    let started = false;\r\n\r\n    let bezierLine;\r\n    let isBaseLayer = false;\r\n    let isTransparentBG = false;\r\n\r\n    function drawDot(x, y, size, opacity) {\r\n\r\n        context.save();\r\n        if (isBaseLayer) {\r\n            if (isTransparentBG) {\r\n                context.globalCompositeOperation = \"destination-out\";\r\n            } else {\r\n                context.globalCompositeOperation = \"source-atop\";\r\n            }\r\n        } else {\r\n            context.globalCompositeOperation = \"destination-out\";\r\n        }\r\n        let radgrad = context.createRadialGradient(size, size, 0, size, size, size);\r\n        let sharpness = Math.pow(opacity, 2);\r\n        sharpness = Math.max(0, Math.min((size - 1) / size, sharpness));\r\n        let oFac = Math.max(0, Math.min(1, opacity));\r\n        let localOpacity = 2 * oFac - oFac * oFac;\r\n        radgrad.addColorStop(sharpness, \"rgba(255, 255, 255, \" + localOpacity + \")\");\r\n        radgrad.addColorStop(1, \"rgba(255, 255, 255, 0)\");\r\n        context.fillStyle = radgrad;\r\n        context.translate(x - size, y - size);\r\n        context.fillRect(0, 0, size * 2, size * 2);\r\n        context.restore();\r\n    }\r\n\r\n    function continueLine(x, y, p) {\r\n        p = Math.max(0, Math.min(1, p));\r\n        let localPressure;\r\n        let localOpacity;\r\n        let localSize = (sizePressure) ? Math.max(0.1, p * size) : Math.max(0.1, size);\r\n\r\n        let bdist = Math.max(1, Math.max(0.5, 1 - opacity) * localSize * spacing);\r\n\r\n        function bezierCallback(val) {\r\n            let factor = val.t;\r\n            localPressure = lastInput2.pressure * (1 - factor) + p * factor;\r\n            localOpacity = (opacityPressure) ? (opacity * localPressure * localPressure) : opacity;\r\n            localSize = (sizePressure) ? Math.max(0.1, localPressure * size) : Math.max(0.1, size);\r\n\r\n            drawDot(val.x, val.y, localSize, localOpacity);\r\n        }\r\n\r\n        if (x === null) {\r\n            bezierLine.addFinal(bdist, bezierCallback);\r\n        } else {\r\n            bezierLine.add(x, y, bdist, bezierCallback);\r\n        }\r\n    }\r\n\r\n\r\n    this.startLine = function (x, y, p) {\r\n        historyEntry = {\r\n            tool: [\"brush\", \"eraser\"],\r\n            actions: []\r\n        };\r\n        historyEntry.actions.push({\r\n            action: \"opacityPressure\",\r\n            params: [opacityPressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"sizePressure\",\r\n            params: [sizePressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSize\",\r\n            params: [size]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setOpacity\",\r\n            params: [opacity]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setTransparentBG\",\r\n            params: [isTransparentBG]\r\n        });\r\n\r\n        let klCanvas = context.canvas.klCanvas;\r\n        if (!klCanvas) {\r\n            throw 'context.canvas has no parent element (' + debugStr + ')';\r\n        }\r\n        isBaseLayer = 0 === klCanvas.getLayerIndex(context.canvas);\r\n\r\n        p = Math.max(0, Math.min(1, p));\r\n        let localOpacity = (opacityPressure) ? (opacity * p * p) : opacity;\r\n        let localSize = (sizePressure) ? Math.max(0.1, p * size) : Math.max(0.1, size);\r\n\r\n        started = true;\r\n        if (localSize > 1) {\r\n            drawDot(x, y, localSize, localOpacity);\r\n        }\r\n        lastDot = localSize * spacing;\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        lastInput.pressure = p;\r\n        lastInput2 = BB.copyObj(lastInput);\r\n\r\n        bezierLine = new BB.BezierLine();\r\n        bezierLine.add(x, y, 0, function () {\r\n        });\r\n\r\n        historyEntry.actions.push({\r\n            action: \"startLine\",\r\n            params: [x, y, p]\r\n        });\r\n    };\r\n    this.goLine = function (x, y, p) {\r\n        if (!started) {\r\n            return;\r\n        }\r\n        historyEntry.actions.push({\r\n            action: \"goLine\",\r\n            params: [x, y, p]\r\n        });\r\n\r\n        continueLine(x, y, lastInput.pressure);\r\n\r\n        lastInput2 = BB.copyObj(lastInput);\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        lastInput.pressure = p;\r\n    };\r\n    this.endLine = function () {\r\n\r\n        if (bezierLine) {\r\n            continueLine(null, null, lastInput.pressure);\r\n        }\r\n\r\n        started = false;\r\n        bezierLine = undefined;\r\n\r\n        if (historyEntry) {\r\n            historyEntry.actions.push({\r\n                action: \"endLine\",\r\n                params: []\r\n            });\r\n            history.add(historyEntry);\r\n            historyEntry = undefined;\r\n        }\r\n    };\r\n    //cheap n' ugly\r\n    this.drawLineSegment = function (x1, y1, x2, y2) {\r\n\r\n        let klCanvas = context.canvas.klCanvas;\r\n        isBaseLayer = 0 === klCanvas.getLayerIndex(context.canvas);\r\n\r\n        lastInput.x = x2;\r\n        lastInput.y = y2;\r\n\r\n        if (started || x1 === undefined) {\r\n            return;\r\n        }\r\n\r\n        let mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\r\n        let eX = (x2 - x1) / mouseDist;\r\n        let eY = (y2 - y1) / mouseDist;\r\n        let loopDist;\r\n        let bdist = Math.max(1, Math.max(0.5, 1 - opacity) * size * spacing);\r\n        lastDot = 0;\r\n        for (loopDist = lastDot; loopDist <= mouseDist; loopDist += bdist) {\r\n            drawDot(x1 + eX * loopDist, y1 + eY * loopDist, size, opacity);\r\n        }\r\n\r\n\r\n        let historyEntry = {\r\n            tool: [\"brush\", \"eraser\"],\r\n            actions: []\r\n        };\r\n        historyEntry.actions.push({\r\n            action: \"opacityPressure\",\r\n            params: [opacityPressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"sizePressure\",\r\n            params: [sizePressure]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setSize\",\r\n            params: [size]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setOpacity\",\r\n            params: [opacity]\r\n        });\r\n        historyEntry.actions.push({\r\n            action: \"setTransparentBG\",\r\n            params: [isTransparentBG]\r\n        });\r\n\r\n        historyEntry.actions.push({\r\n            action: \"drawLineSegment\",\r\n            params: [x1, y1, x2, y2]\r\n        });\r\n        history.add(historyEntry);\r\n    };\r\n\r\n    //IS\r\n    this.isDrawing = function () {\r\n        return started;\r\n    };\r\n    //SET\r\n    /*this.setAlpha = function(a) {\r\n        lastInput = {};\r\n        alpha = a;\r\n        updateAlphaCanvas();\r\n    };*/\r\n    this.setContext = function (c) {\r\n        context = c;\r\n    };\r\n    this.setHistory = function (l) {\r\n        history = l;\r\n    };\r\n    this.setSize = function (s) {\r\n        size = s;\r\n    };\r\n    this.setOpacity = function (o) {\r\n        opacity = o;\r\n    };\r\n    this.sizePressure = function (b) {\r\n        sizePressure = b;\r\n    };\r\n    this.opacityPressure = function (b) {\r\n        opacityPressure = b;\r\n    };\r\n    this.setTransparentBG = function (b) {\r\n        isTransparentBG = b == true;\r\n    };\r\n    //GET\r\n    this.getSize = function () {\r\n        return size;\r\n    };\r\n    this.getOpacity = function () {\r\n        return opacity;\r\n    };\r\n    this.setDebug = function (str) {\r\n        debugStr = str;\r\n    };\r\n}","import {BB} from '../../bb/bb';\r\nimport {IBounds, IVector2D} from '../../bb/bb.types';\r\n\r\n\r\n\r\n// let statCount = 1;\r\n// let statAcc = 0;\r\n// stats on win10, chrome, size 100, opacity 80, smudge()\r\n// unoptimized: 1 ms\r\n// minimal: 0.09 ms\r\n// minimal + circle: 0.5ms\r\n// minimal + circle + ix, iy: 0.23ms\r\n// unoptimized + ix, iy: 0.64 ms\r\n// unoptimized + ix, iy + sans rounding: 0.61 ms\r\n// ix, iy + sans rounding + sans random: 0.32ms\r\n// ix, iy + sans rounding + fast random: 0.46 ms\r\n// ix, iy + sans rounding + fast random + offset const: 0.48 ms\r\n\r\n\r\ninterface ISmudgeParams {\r\n    aP: IVector2D;\r\n    bP: IVector2D;\r\n    size: {\r\n        w: number;\r\n        h: number;\r\n    };\r\n    brush: {\r\n        center: IVector2D,\r\n        size: number;\r\n        opacity: number;\r\n        alphaLock: boolean;\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * determine bounds of smudge\r\n * @param imWidth\r\n * @param imHeight\r\n * @param aP\r\n * @param bP\r\n * @param size\r\n */\r\nfunction prepSmudge(\r\n    imWidth: number,\r\n    imHeight: number,\r\n    aP: IVector2D, // top left of source, integers\r\n    bP: IVector2D, // top left of dest, integers\r\n    size: {w: number; h: number}, // size of both rectangles, integers\r\n): {\r\n    aP: IVector2D,\r\n    bP: IVector2D,\r\n    size: {w: number; h: number},\r\n} {\r\n\r\n    if (aP.x === bP.x && aP.y === bP.y) {\r\n        return null;\r\n    }\r\n\r\n    aP = BB.copyObj(aP);\r\n    bP = BB.copyObj(bP);\r\n    size = BB.copyObj(size);\r\n\r\n    // corner behavior\r\n    // cut down rectangles, if a or b go outside\r\n    // i.e. if user drags partially or fully outside the canvas\r\n    {\r\n        let top = 0;\r\n        let right = 0;\r\n        let bottom = 0;\r\n        let left = 0;\r\n\r\n        if (aP.x < 0) {\r\n            left = -aP.x;\r\n        }\r\n        if (aP.y < 0) {\r\n            top = -aP.y;\r\n        }\r\n        if (bP.x < 0) {\r\n            left = Math.max(left, -bP.x);\r\n        }\r\n        if (bP.y < 0) {\r\n            top = Math.max(top, -bP.y);\r\n        }\r\n        if (aP.x + size.w > imWidth) {\r\n            right = aP.x + size.w - imWidth;\r\n        }\r\n        if (aP.y + size.h > imHeight) {\r\n            bottom = aP.y + size.h - imHeight;\r\n        }\r\n        if (bP.x + size.w > imWidth) {\r\n            right = Math.max(right, bP.x + size.w - imWidth);\r\n        }\r\n        if (bP.y + size.h > imHeight) {\r\n            bottom = Math.max(bottom, bP.y + size.h - imHeight);\r\n        }\r\n\r\n        aP.x += left;\r\n        bP.x += left;\r\n        aP.y += top;\r\n        bP.y += top;\r\n\r\n        size.w = size.w - left - right;\r\n        size.h = size.h - top - bottom;\r\n        if (size.w <= 0 || size.h <= 0) {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    return {\r\n        aP: {\r\n            x: aP.x,\r\n            y: aP.y,\r\n        },\r\n        bP: {\r\n            x: bP.x,\r\n            y: bP.y,\r\n        },\r\n        size: {\r\n            w: size.w,\r\n            h: size.h,\r\n        }\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * Pixel operations that do the smudging via ImageData\r\n * @param imageData\r\n * @param p\r\n */\r\nfunction smudge(imageData: ImageData, p : ISmudgeParams) {\r\n\r\n    p = BB.copyObj(p);\r\n\r\n    const cSize = p.brush.size;\r\n    const cX = p.brush.center.x;\r\n    const cY = p.brush.center.y;\r\n\r\n    /*if (statCount % 1000 === 0) {\r\n        console.log(statAcc / 1000);\r\n        statAcc = 0;\r\n    }\r\n    let start = performance.now();*/\r\n\r\n\r\n    // determine offset\r\n    let aIndex = p.aP.y * imageData.width + p.aP.x;\r\n    let bIndex = p.bP.y * imageData.width + p.bP.x;\r\n    const offset = (bIndex - aIndex) * 4;\r\n\r\n    // array with random numbers. faster than Math.random()\r\n    let randI = 0;\r\n    const randLen = Math.floor(25 + Math.random() * 25);\r\n    const randArr = [];\r\n    for (let i = 0; i < randLen; i++) {\r\n        randArr[i] = Math.random();\r\n    }\r\n\r\n    const softness = Math.max(3, Math.min(8, p.brush.size - 8));\r\n\r\n    const pixel = (ai, bi, ix, iy) => {\r\n\r\n        const dist = Math.abs(BB.dist(cX, cY, ix, iy));\r\n        const fac = 1 - p.brush.opacity * (1 - BB.clamp((dist - (cSize - softness)) / softness, 0, 1));\r\n\r\n        if (fac === 1) {\r\n            return;\r\n        }\r\n\r\n        if (!imageData.data[ai + 3]) {\r\n\r\n        } else if (!imageData.data[bi + 3]) { // don't mix if target fully transparent. pixel might have a strange color.\r\n            imageData.data[bi] = imageData.data[ai + 0];\r\n            imageData.data[bi + 1] = imageData.data[ai + 1];\r\n            imageData.data[bi + 2] = imageData.data[ai + 2];\r\n        } else {\r\n\r\n            // consider alpha ratio. If a has lower alpha than b, then b should be stronger, and vice versa\r\n            // not totally accurate. TODO research accurate smudging\r\n            let fac2;\r\n            if (imageData.data[ai + 3] < imageData.data[bi + 3]) {\r\n                fac2 = 1 - imageData.data[ai + 3] / imageData.data[bi + 3] * (1 - fac);\r\n            } else {\r\n                fac2 = imageData.data[bi + 3] / imageData.data[ai + 3] * fac;\r\n            }\r\n\r\n            // ImageData's Uint8ClampedArray rounds -> 0.5 becomes 1. But not in Safari, so needs to be done manually\r\n            // Offset mixed color by random number noise (-0.5, 0.5), so it doesn't get stuck while mixing.\r\n            // No +0.5, because it cancels out with rand.\r\n            imageData.data[bi] = Math.floor(BB.mix(imageData.data[ai], imageData.data[bi + 0], fac2) + randArr[randI++ % randLen]);\r\n            imageData.data[bi + 1] = Math.floor(BB.mix(imageData.data[ai + 1], imageData.data[bi + 1], fac2) + randArr[randI++ % randLen]);\r\n            imageData.data[bi + 2] = Math.floor(BB.mix(imageData.data[ai + 2], imageData.data[bi + 2], fac2) + randArr[randI++ % randLen]);\r\n        }\r\n        // Always mix alpha. unless alpha lock\r\n        if (!p.brush.alphaLock) {\r\n            imageData.data[bi + 3] = Math.floor(BB.mix(imageData.data[ai + 3], imageData.data[bi + 3], fac) + 0.5);\r\n        }\r\n\r\n    };\r\n\r\n    const bx1 = p.bP.x * 4;\r\n    const bx2 = bx1 + (p.size.w - 1) * 4;\r\n\r\n    // transfer of pixels depends on direction of smudging if there is overlap\r\n    if (p.aP.y < p.bP.y) {\r\n        for (let y = p.size.h - 1, iy = p.bP.y + p.size.h - 1; y >= 0; y--, iy--) {\r\n            const yStart = (y + p.bP.y) * imageData.width * 4;\r\n            for (let x = bx2 + yStart, x2 = bx2 + yStart - offset, ix = p.bP.x + p.size.w - 1; x >= bx1 + yStart; x -= 4, x2 -= 4, ix--) {\r\n                pixel(x2, x, ix, iy);\r\n            }\r\n        }\r\n    } else if (p.aP.y > p.bP.y) {\r\n        for (let y = 0, iy = p.bP.y; y < p.size.h; y++, iy++) {\r\n            const yStart = (y + p.bP.y) * imageData.width * 4;\r\n            for (let x = bx2 + yStart, x2 = bx2 + yStart - offset, ix = p.bP.x + p.size.w - 1; x >= bx1 + yStart; x -= 4, x2 -= 4, ix--) {\r\n                pixel(x2, x, ix, iy);\r\n            }\r\n        }\r\n    } else {\r\n        if (p.aP.x < p.bP.x) {\r\n            for (let y = p.size.h - 1, iy = p.bP.y + p.size.h - 1; y >= 0; y--, iy--) {\r\n                const yStart = (y + p.bP.y) * imageData.width * 4;\r\n                for (let x = bx2 + yStart, x2 = bx2 + yStart - offset, ix = p.bP.x + p.size.w - 1; x >= bx1 + yStart; x -= 4, x2 -= 4, ix--) {\r\n                    pixel(x2, x, ix, iy);\r\n                }\r\n            }\r\n        } else {\r\n            for (let y = 0, iy = p.bP.y; y < p.size.h; y++, iy++) {\r\n                const yStart = (y + p.bP.y) * imageData.width * 4;\r\n                for (let x = bx1 + yStart, x2 = bx1 + yStart - offset, ix = p.bP.x; x < bx2 + yStart; x += 4, x2 += 4, ix++) {\r\n                    pixel(x2, x, ix, iy);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    //statCount++;\r\n    //statAcc += performance.now() - start;\r\n}\r\n\r\n/**\r\n * Brush that pushes colors around.\r\n */\r\nexport function smudgeBrush() {\r\n\r\n    let _this = this;\r\n    let debugStr = '';\r\n    let context: CanvasRenderingContext2D;\r\n    let history = {\r\n        add: function (p?) {\r\n        },\r\n        isFake: true\r\n    }, historyEntry;\r\n\r\n    let settingColor, settingSize = 35, settingSpacing = 0.20446882736951905, settingOpacity = 0.8;\r\n    let settingColorStr: string;\r\n    let settingHasSizePressure = false, settingHasOpacityPressure = false;\r\n    let settingLockLayerAlpha = false;\r\n\r\n    let lineToolLastDot;\r\n    let lastInput = {x: 0, y: 0, pressure: 0};\r\n    let lastInput2 = {x: 0, y: 0, pressure: 0};\r\n\r\n    let isDrawing = false;\r\n\r\n    let bezierLine = null;\r\n\r\n\r\n    let redrawBounds: IBounds;\r\n    let completeRedrawBounds: IBounds;\r\n\r\n    let copyImageData: ImageData;\r\n\r\n    let smudgeBuffer: ISmudgeParams[] = [];\r\n    const cellSize = 256;\r\n    let copiedCells: boolean[];\r\n\r\n    function updateRedrawBounds(bounds: IBounds) {\r\n        if (!bounds) {\r\n            return;\r\n        }\r\n        if (!redrawBounds) {\r\n            redrawBounds = { x1: bounds.x1, y1: bounds.y1, x2: bounds.x2, y2: bounds.y2 };\r\n        } else {\r\n            redrawBounds.x1 = Math.min(redrawBounds.x1, bounds.x1);\r\n            redrawBounds.y1 = Math.min(redrawBounds.y1, bounds.y1);\r\n            redrawBounds.x2 = Math.max(redrawBounds.x2, bounds.x2);\r\n            redrawBounds.y2 = Math.max(redrawBounds.y2, bounds.y2);\r\n        }\r\n    }\r\n    function updateCompleteRedrawBounds(x1, y1, x2, y2) {\r\n        if (!completeRedrawBounds) {\r\n            completeRedrawBounds = { x1, y1, x2, y2 };\r\n        } else {\r\n            completeRedrawBounds.x1 = Math.min(completeRedrawBounds.x1, x1);\r\n            completeRedrawBounds.y1 = Math.min(completeRedrawBounds.y1, y1);\r\n            completeRedrawBounds.x2 = Math.max(completeRedrawBounds.x2, x2);\r\n            completeRedrawBounds.y2 = Math.max(completeRedrawBounds.y2, y2);\r\n        }\r\n    }\r\n\r\n\r\n    let lastDot;\r\n\r\n    /**\r\n     * update copyImageData. copy over new regions if needed\r\n     */\r\n    function copyFromCanvas() {\r\n\r\n        const touchedCells = copiedCells.map(item => false);\r\n\r\n        const bounds: IBounds[] = [];\r\n        const cellsW = Math.ceil(copyImageData.width / cellSize);\r\n\r\n        if (!redrawBounds) {\r\n            return;\r\n        }\r\n        bounds.push({\r\n            x1: Math.floor(redrawBounds.x1 / cellSize),\r\n            y1: Math.floor(redrawBounds.y1 / cellSize),\r\n            x2: Math.floor(redrawBounds.x2 / cellSize),\r\n            y2: Math.floor(redrawBounds.y2 / cellSize),\r\n        });\r\n        bounds.forEach(item => {\r\n            for (let i = item.x1; i <= item.x2; i++) {\r\n                for (let e = item.y1; e <= item.y2; e++) {\r\n                    touchedCells[e * cellsW + i] = true;\r\n                }\r\n            }\r\n        });\r\n\r\n        touchedCells.forEach((item, i) => {\r\n            if (!item || copiedCells[i]) {\r\n                // not touched, or already copied\r\n                return;\r\n            }\r\n            copiedCells[i] = true;\r\n            const x = i % cellsW;\r\n            const y = Math.floor(i / cellsW);\r\n            const w = (Math.min(x * cellSize + cellSize, copyImageData.width) - 1) % cellSize + 1;\r\n            const h = (Math.min(y * cellSize + cellSize, copyImageData.height) - 1) % cellSize + 1;\r\n\r\n            // temp canvas to prevent main canvas from getting slowed down in chrome\r\n            const tmpCanvas = BB.canvas(w, h);\r\n            const tmpCtx = tmpCanvas.getContext('2d');\r\n            tmpCtx.drawImage(context.canvas, -x * cellSize, -y * cellSize);\r\n\r\n            const data = tmpCtx.getImageData(0, 0, w, h);\r\n\r\n            for (let i = 0; i < h; i++) {\r\n                for (let e = 0, e2 = i * w * 4, e3 = ((y * cellSize + i) * copyImageData.width + x * cellSize) * 4; e < w; e++, e2 += 4, e3 += 4) {\r\n                    copyImageData.data[e3] = data.data[e2];\r\n                    copyImageData.data[e3 + 1] = data.data[e2 + 1];\r\n                    copyImageData.data[e3 + 2] = data.data[e2 + 2];\r\n                    copyImageData.data[e3 + 3] = data.data[e2 + 3];\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     *\r\n     *\r\n     * @param x\r\n     * @param y\r\n     * @param size\r\n     * @param opacity\r\n     */\r\n    function drawDot(x, y, size, opacity) {\r\n        if (!lastDot) {\r\n            lastDot = {\r\n                x: x,\r\n                y: y,\r\n            };\r\n            return;\r\n        }\r\n\r\n        size = Math.round(size);\r\n\r\n\r\n        const w = Math.round(size * 2);\r\n        const h = Math.round(size * 2);\r\n\r\n        const bounds = prepSmudge(\r\n            copyImageData.width,\r\n            copyImageData.height,\r\n            {\r\n                x: Math.round(lastDot.x - size),\r\n                y: Math.round(lastDot.y - size),\r\n            },\r\n            {\r\n                x: Math.round(x - size),\r\n                y: Math.round(y - size),\r\n            },\r\n            {\r\n                w,\r\n                h,\r\n            },\r\n        );\r\n\r\n        if (bounds) {\r\n            const params: ISmudgeParams = {\r\n                aP: bounds.aP,\r\n                bP: bounds.bP,\r\n                size: bounds.size,\r\n                brush: {\r\n                    center: { x, y },\r\n                    size,\r\n                    opacity,\r\n                    alphaLock: settingLockLayerAlpha,\r\n                }\r\n            };\r\n            updateRedrawBounds({\r\n                x1: params.bP.x,\r\n                y1: params.bP.y,\r\n                x2: params.bP.x + params.brush.size * 2,\r\n                y2: params.bP.y + params.brush.size * 2,\r\n            });\r\n            smudgeBuffer.push(params);\r\n        }\r\n\r\n        lastDot = {\r\n            x: x,\r\n            y: y,\r\n        };\r\n    }\r\n\r\n    function continueLine(x, y, size, pressure) {\r\n        smudgeBuffer = [];\r\n\r\n        if(bezierLine === null) {\r\n            bezierLine = new BB.BezierLine();\r\n            bezierLine.add(lastInput.x, lastInput.y, 0, function(){});\r\n        }\r\n\r\n        let drawArr = []; //draw instructions. will be all drawn at once\r\n\r\n        function dotCallback(val) {\r\n            let localPressure = BB.mix(lastInput2.pressure, pressure, val.t);\r\n            let localOpacity = settingOpacity * (settingHasOpacityPressure ? (localPressure * localPressure) : 1);\r\n            let localSize = Math.max(0.1, settingSize * (settingHasSizePressure ? localPressure : 1));\r\n            drawArr.push([val.x, val.y, localSize, localOpacity, val.angle]);\r\n        }\r\n\r\n        let localSpacing = size * settingSpacing / 3;\r\n        if(x === null) {\r\n            bezierLine.addFinal(localSpacing, dotCallback);\r\n        } else {\r\n            bezierLine.add(x, y, localSpacing, dotCallback);\r\n        }\r\n\r\n        // execute draw instructions\r\n        let before;\r\n        for (let i = 0; i < drawArr.length; i++) {\r\n            let item = drawArr[i];\r\n            drawDot(item[0], item[1], item[2], item[3]);\r\n            before = item;\r\n        }\r\n\r\n        copyFromCanvas();\r\n\r\n        for (let i = 0; i < smudgeBuffer.length; i++) {\r\n            smudge(copyImageData, smudgeBuffer[i]);\r\n        }\r\n    }\r\n\r\n    //------------------ interface ---------------------------------------------------\r\n\r\n\r\n    this.startLine = function (x, y, p) {\r\n        historyEntry = {\r\n            tool: [\"brush\", \"smudge\"],\r\n            actions: []\r\n        };\r\n\r\n        p = BB.clamp(p, 0, 1);\r\n        let localOpacity = settingHasOpacityPressure ? (settingOpacity * p * p) : settingOpacity;\r\n        let localSize = settingHasSizePressure ? Math.max(0.1, p * settingSize) : Math.max(0.1, settingSize);\r\n\r\n        lastDot = null;\r\n        isDrawing = true;\r\n\r\n        copyImageData = new ImageData(context.canvas.width, context.canvas.height);\r\n        const totalCells = Math.ceil(context.canvas.width / cellSize) * Math.ceil(context.canvas.height / cellSize);\r\n        copiedCells = '0'.repeat(totalCells).split('').map(item => false);\r\n\r\n        drawDot(x, y, localSize, localOpacity);\r\n\r\n        lineToolLastDot = localSize * settingSpacing;\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        lastInput.pressure = p;\r\n        lastInput2.pressure = p;\r\n\r\n        completeRedrawBounds = null;\r\n    };\r\n\r\n    this.goLine = function (x, y, p) {\r\n        if (!isDrawing) {\r\n            return;\r\n        }\r\n\r\n        redrawBounds = null;\r\n        let pressure = BB.clamp(p, 0, 1);\r\n        let localSize = settingHasSizePressure ? Math.max(0.1, lastInput.pressure * settingSize) : Math.max(0.1, settingSize);\r\n\r\n        continueLine(x, y, localSize, lastInput.pressure);\r\n\r\n\r\n        if (redrawBounds) {\r\n            context.putImageData(copyImageData, 0, 0, redrawBounds.x1, redrawBounds.y1, redrawBounds.x2 - redrawBounds.x1 - 1, redrawBounds.y2 - redrawBounds.y1 - 1);\r\n            updateCompleteRedrawBounds(redrawBounds.x1, redrawBounds.y1, redrawBounds.x2, redrawBounds.y2);\r\n        }\r\n\r\n        lastInput.x = x;\r\n        lastInput.y = y;\r\n        lastInput2.pressure = lastInput.pressure;\r\n        lastInput.pressure = pressure;\r\n\r\n    };\r\n\r\n    this.endLine = function (x, y) {\r\n        redrawBounds = null;\r\n        let localSize = settingHasSizePressure ? Math.max(0.1, lastInput.pressure * settingSize) : Math.max(0.1, settingSize);\r\n        context.save();\r\n        continueLine(null, null, localSize, lastInput.pressure);\r\n        context.restore();\r\n\r\n        isDrawing = false;\r\n\r\n        bezierLine = null;\r\n\r\n        if (redrawBounds) {\r\n            context.putImageData(copyImageData, 0, 0, redrawBounds.x1, redrawBounds.y1, redrawBounds.x2 - redrawBounds.x1 - 1, redrawBounds.y2 - redrawBounds.y1 - 1);\r\n            updateCompleteRedrawBounds(redrawBounds.x1, redrawBounds.y1, redrawBounds.x2, redrawBounds.y2);\r\n        }\r\n\r\n        if (historyEntry && completeRedrawBounds) {\r\n            let historyIm: ImageData | HTMLCanvasElement = copyImageData;\r\n            if (!(completeRedrawBounds.x1 === 0 && completeRedrawBounds.y1 === 0 && completeRedrawBounds.x2 >= context.canvas.width - 1 && completeRedrawBounds.y2 >= context.canvas.height - 1)) {\r\n\r\n                // temp canvas to prevent main canvas from getting slowed down in chrome\r\n                const tmpCanvas = BB.canvas(completeRedrawBounds.x2 - completeRedrawBounds.x1 + 1, completeRedrawBounds.y2 - completeRedrawBounds.y1 + 1);\r\n                const tmpCtx = tmpCanvas.getContext('2d');\r\n                tmpCtx.drawImage(context.canvas, -completeRedrawBounds.x1, -completeRedrawBounds.y1);\r\n\r\n                historyIm = tmpCanvas; // faster than getting image data (measured on 2018 lenovo chromebook)\r\n            }\r\n            historyEntry.actions.push({\r\n                action: \"drawImage\",\r\n                params: [\r\n                    historyIm,\r\n                    completeRedrawBounds.x1,\r\n                    completeRedrawBounds.y1,\r\n                ],\r\n            });\r\n            history.add(historyEntry);\r\n            historyEntry = undefined;\r\n        }\r\n        copyImageData = null;\r\n    };\r\n\r\n    this.drawImage = (im: ImageData | HTMLCanvasElement, x: number, y: number) => {\r\n        if (im instanceof ImageData) {\r\n            context.putImageData(im, x, y);\r\n        } else {\r\n            context.clearRect(x, y, im.width, im.height);\r\n            context.drawImage(im, x, y);\r\n        }\r\n    };\r\n\r\n    this.drawLineSegment = function (x1, y1, x2, y2) {\r\n        return;\r\n        /*\r\n        // todo\r\n        lastInput.x = x2;\r\n        lastInput.y = y2;\r\n        lastInput.pressure = 1;\r\n\r\n        if (isDrawing || x1 === undefined) {\r\n            return;\r\n        }\r\n\r\n        let angle = BB.pointsToAngleDeg({x:x1, y:y1}, {x:x2, y:y2});\r\n        let mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\r\n        let eX = (x2 - x1) / mouseDist;\r\n        let eY = (y2 - y1) / mouseDist;\r\n        let loopDist;\r\n        let bdist = settingSize * settingSpacing;\r\n        lineToolLastDot = settingSize * settingSpacing;\r\n        for (loopDist = lineToolLastDot; loopDist <= mouseDist; loopDist += bdist) {\r\n            drawDot(x1 + eX * loopDist, y1 + eY * loopDist, settingSize, settingOpacity);\r\n        }\r\n\r\n\r\n        let historyEntry = {\r\n            tool: [\"brush\", \"smudge\"],\r\n            actions: []\r\n        };\r\n        // todo\r\n        history.add(historyEntry);*/\r\n    };\r\n\r\n    //IS\r\n    this.isDrawing = function () {\r\n        return isDrawing;\r\n    };\r\n    //SET\r\n\r\n    // not needed, but might add in the future\r\n    this.setColor = function (c) {\r\n        if(settingColor === c) {\r\n            return;\r\n        }\r\n        settingColor = {r: c.r, g: c.g, b: c.b};\r\n        settingColorStr = \"rgb(\" + settingColor.r + \",\" + settingColor.g + \",\" + settingColor.b + \")\";\r\n    };\r\n    this.setContext = function (c) {\r\n        context = c;\r\n    };\r\n    this.setHistory = function (l) {\r\n        history = l;\r\n    };\r\n    this.setSize = function (s) {\r\n        settingSize = s;\r\n    };\r\n    this.setOpacity = function (o) {\r\n        settingOpacity = o;\r\n    };\r\n    this.setSpacing = function (s) {\r\n        settingSpacing = s;\r\n    };\r\n    this.sizePressure = function (b) {\r\n        settingHasSizePressure = b;\r\n    };\r\n    this.opacityPressure = function (b) {\r\n        settingHasOpacityPressure = b;\r\n    };\r\n    this.setLockAlpha = function (b) {\r\n        settingLockLayerAlpha = b;\r\n    };\r\n    //GET\r\n    this.getSpacing = function () {\r\n        return settingSpacing;\r\n    };\r\n    this.getSize = function () {\r\n        return settingSize;\r\n    };\r\n    this.getOpacity = function () {\r\n        return settingOpacity;\r\n    };\r\n    this.getLockAlpha = function (b) {\r\n        return settingLockLayerAlpha;\r\n    };\r\n    this.setDebug = function(str) {\r\n        debugStr = str;\r\n    };\r\n}","import {defaultBrushUi} from './default-brush-ui';\r\nimport {blendBrushUi} from './blend-brush-ui';\r\nimport {sketchyBrushUi} from './sketchy-brush-ui';\r\nimport {pixelBrushUi} from './pixel-brush-ui';\r\nimport {eraserBrushUi} from './eraser-brush-ui';\r\nimport {smudgeBrushUi} from './smudge-brush-ui';\r\n\r\n/**\r\n * UI for brushes.\r\n * each brush ui carries the brush with it.\r\n * so if you want to draw, you do it through the UI. should be changed sometime\r\n *\r\n * each brush: {\r\n *     image: str,\r\n *     tooltip: str,\r\n *     sizeSlider: {\r\n *         min: number,\r\n *         max: number,\r\n *         curve: [] // optional\r\n *     },\r\n *     opacitySlider: same as size slider,\r\n *     Ui: function(p)\r\n * }\r\n *\r\n */\r\n\r\nexport const brushesUI = {\r\n    defaultBrush: defaultBrushUi,\r\n    blendBrush: blendBrushUi,\r\n    sketchy: sketchyBrushUi,\r\n    pixel: pixelBrushUi,\r\n    displace: smudgeBrushUi,\r\n    eraser: eraserBrushUi,\r\n};\r\n","import {BB} from '../../bb/bb';\r\nimport {brushes} from '../brushes/brushes';\r\nimport {eventResMs} from './brushes-consts';\r\nimport {klHistory} from '../history/kl-history';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {PcSlider} from '../ui/base-components/slider';\r\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\r\n// @ts-ignore\r\nimport brushIconImg from 'url:~/src/app/img/ui/brush-smpl.png';\r\nimport {genBrushAlpha01, genBrushAlpha02} from '../brushes/alphas/brush-alphas';\r\n\r\nexport const defaultBrushUi = (function () {\r\n    let brushInterface: any = {\r\n        image: brushIconImg,\r\n        tooltip: 'Pen',\r\n        sizeSlider: {\r\n            min: 0.5,\r\n            max: 100,\r\n            curve: BB.quadraticSplineInput(0.5, 100, 0.1)\r\n        },\r\n        opacitySlider: {\r\n            min: 0,\r\n            max: 1,\r\n            curve: [[0, 1 / 100], [0.5, 0.3], [1, 1]]\r\n        }\r\n    };\r\n\r\n    let alphaNames = ['Circle', 'Chalk', 'Calligraphy', 'Square'];\r\n\r\n    /**\r\n     * @param p = {onSizeChange: function(size), onOpacityChange: function(opacity)}\r\n     * @constructor\r\n     */\r\n    brushInterface.Ui = function (p) {\r\n        let div = document.createElement(\"div\"); // the gui\r\n        let brush = new brushes.defaultBrush();\r\n        brush.setHistory(klHistory);\r\n        p.onSizeChange(brush.getSize());\r\n        let sizeSlider;\r\n        let opacitySlider;\r\n\r\n        let alphas = [];\r\n        let currentAlpha = 0;\r\n        for (let i = 0; i < 4; i++) {\r\n            (function (i) {\r\n                let alpha = BB.el({\r\n                    title: alphaNames[i],\r\n                    onClick: () => {\r\n                        alphaClick(i);\r\n                    }\r\n                });\r\n                let canvas = BB.canvas(70, 70);\r\n                let ctx = canvas.getContext('2d');\r\n                if (i === 0 || i === 3) {\r\n                    if (i === 0) {\r\n                        ctx.beginPath();\r\n                        ctx.arc(35, 35, 30, 0, 2 * Math.PI);\r\n                        ctx.closePath();\r\n                        ctx.fill();\r\n                    } else {\r\n                        ctx.fillRect(5, 5, 60, 60);\r\n                    }\r\n                } else if (i === 1) {\r\n                    ctx.drawImage(genBrushAlpha01(60), 5, 5);\r\n                } else if (i === 2) {\r\n                    ctx.drawImage(genBrushAlpha02(60), 5, 5);\r\n                }\r\n                alpha.style.backgroundImage = 'url(' + canvas.toDataURL('image/png') + ')';\r\n\r\n                alphas.push(alpha);\r\n            }(i));\r\n        }\r\n\r\n        function updateAlphas() {\r\n            for (let i = 0; i < alphas.length; i++) {\r\n                if (i === currentAlpha) {\r\n                    alphas[i].className = 'brush-alpha-selected';\r\n                } else {\r\n                    alphas[i].className = 'brush-alpha';\r\n                }\r\n            }\r\n        }\r\n\r\n        updateAlphas();\r\n\r\n        function alphaClick(id) {\r\n            currentAlpha = id;\r\n            brush.setAlpha(id);\r\n            updateAlphas();\r\n        }\r\n\r\n        let lockAlphaToggle = new Checkbox({\r\n            init: brush.getLockAlpha(),\r\n            label: 'Lock Alpha',\r\n            callback: function (b) {\r\n                brush.setLockAlpha(b);\r\n            },\r\n            doHighlight: true,\r\n            title: 'Locks layer\\'s alpha channel',\r\n            css: {\r\n                cssFloat: 'right',\r\n                textAlign: 'right',\r\n            }\r\n        });\r\n\r\n        let spacingSpline = new BB.SplineInterpolator([[0, 15], [8, 7], [14, 4], [30, 3], [50, 2.7], [100, 2]]);\r\n\r\n        function setSize(size) {\r\n            brush.setSize(size);\r\n            brush.setSpacing(Math.max(2, spacingSpline.interpolate(size)) / 15);\r\n        }\r\n\r\n        function init() {\r\n            sizeSlider = new PcSlider({\r\n                label: 'Size',\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.sizeSlider.min,\r\n                max: brushInterface.sizeSlider.max,\r\n                initValue: brush.getSize(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    setSize(val);\r\n                    p.onSizeChange(val);\r\n                },\r\n                curve: brushInterface.sizeSlider.curve,\r\n                formatFunc: function (v) {\r\n                    v *= 2;\r\n                    if (v < 10) {\r\n                        return Math.round(v * 10) / 10;\r\n                    } else {\r\n                        return Math.round(v);\r\n                    }\r\n                }\r\n            });\r\n            opacitySlider = new PcSlider({\r\n                label: 'Opacity',\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.opacitySlider.min,\r\n                max: brushInterface.opacitySlider.max,\r\n                initValue: brushInterface.opacitySlider.max,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setOpacity(val);\r\n                    p.onOpacityChange(val);\r\n                },\r\n                curve: brushInterface.opacitySlider.curve,\r\n                formatFunc: function(v) {\r\n                    return Math.round(v * 100);\r\n                }\r\n            });\r\n\r\n            let pressureSizeToggle = penPressureToggle(true, function (b) {\r\n                brush.sizePressure(b);\r\n            });\r\n            let pressureOpacityToggle = penPressureToggle(false, function (b) {\r\n                brush.opacityPressure(b);\r\n            });\r\n\r\n            div.appendChild(pressureSizeToggle);\r\n            div.appendChild(sizeSlider.getElement());\r\n            BB.el({\r\n                parent: div,\r\n                css: {\r\n                    clear: 'both',\r\n                    marginBottom: '10px'\r\n                }\r\n            });\r\n            div.appendChild(pressureOpacityToggle);\r\n            div.appendChild(opacitySlider.getElement());\r\n\r\n            let alphaWrapper = document.createElement(\"div\");\r\n            for (let i = 0; i < alphas.length; i++) {\r\n                alphaWrapper.appendChild(alphas[i]);\r\n            }\r\n            alphaWrapper.style.marginTop = \"10px\";\r\n            div.appendChild(alphaWrapper);\r\n            alphaWrapper.appendChild(lockAlphaToggle.getElement());\r\n\r\n        }\r\n\r\n        init();\r\n\r\n        this.increaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.increaseValue(f);\r\n            }\r\n        };\r\n        this.decreaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.decreaseValue(f);\r\n            }\r\n        };\r\n\r\n        this.getSize = function () {\r\n            return brush.getSize();\r\n        };\r\n        this.setSize = function(size) {\r\n            setSize(size);\r\n            sizeSlider.setValue(size);\r\n        };\r\n        this.getOpacity = function () {\r\n            return brush.getOpacity();\r\n        };\r\n        this.setOpacity = function(opacity) {\r\n            brush.setOpacity(opacity);\r\n            opacitySlider.setValue(opacity);\r\n        };\r\n\r\n        this.setColor = function (c) {\r\n            brush.setColor(c);\r\n        };\r\n        this.setContext = function (c) {\r\n            brush.setContext(c);\r\n        };\r\n        this.startLine = function (x, y, p) {\r\n            brush.startLine(x, y, p);\r\n        };\r\n        this.goLine = function (x, y, p) {\r\n            brush.goLine(x, y, p);\r\n        };\r\n        this.endLine = function (x, y) {\r\n            brush.endLine(x, y);\r\n        };\r\n        this.getBrush = function () {\r\n            return brush;\r\n        };\r\n        this.isDrawing = function () {\r\n            return brush.isDrawing();\r\n        };\r\n        this.getElement = function () {\r\n            return div;\r\n        };\r\n    };\r\n    return brushInterface;\r\n})();","\r\nexport const eventResMs = 20;","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"ljmLX\");","import {BB} from '../../bb/bb';\r\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\r\nimport {eventResMs} from './brushes-consts';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {brushes} from '../brushes/brushes';\r\nimport {klHistory} from '../history/kl-history';\r\nimport {PcSlider} from '../ui/base-components/slider';\r\n// @ts-ignore\r\nimport brushIconImg from 'url:~/src/app/img/ui/brush-smooth.png';\r\n\r\nexport const blendBrushUi = (function () {\r\n    let brushInterface: any = {\r\n        image: brushIconImg,\r\n        tooltip: 'Blend',\r\n        sizeSlider: {\r\n            min: 0.5,\r\n            max: 100,\r\n            curve: BB.quadraticSplineInput(0.5, 100, 0.1)\r\n        },\r\n        opacitySlider: {\r\n            min: 1 / 100,\r\n            max: 1\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param p = {onSizeChange: function(size), onOpacityChange: function(opacity)}\r\n     * @constructor\r\n     */\r\n    brushInterface.Ui = function (p) {\r\n        let div = document.createElement(\"div\"); // the gui\r\n        let brush = new brushes.BlendBrush();\r\n        brush.setHistory(klHistory);\r\n        p.onSizeChange(brush.getSize());\r\n\r\n        let sizeSlider;\r\n        let opacitySlider;\r\n\r\n        function setSize(size) {\r\n            brush.setSize(size);\r\n        }\r\n\r\n        function init() {\r\n            sizeSlider = new PcSlider({\r\n                label: 'Size',\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.sizeSlider.min,\r\n                max: brushInterface.sizeSlider.max,\r\n                initValue: 58 / 2,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    setSize(val);\r\n                    p.onSizeChange(val);\r\n                },\r\n                curve: brushInterface.sizeSlider.curve,\r\n                formatFunc: function (v) {\r\n                    v *= 2;\r\n                    return Math.round(v);\r\n                }\r\n            });\r\n            opacitySlider = new PcSlider({\r\n                label: 'Opacity',\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.opacitySlider.min,\r\n                max: brushInterface.opacitySlider.max,\r\n                initValue: brush.getOpacity(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setOpacity(val);\r\n                    p.onOpacityChange(val);\r\n                },\r\n                formatFunc: function(v) {\r\n                    return Math.round(v * 100);\r\n                }\r\n            });\r\n            let blendingSlider = new PcSlider({\r\n                label: 'Blending',\r\n                width: 225,\r\n                height: 30,\r\n                min: 0,\r\n                max: 100,\r\n                initValue: brush.getBlending() * 100,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setBlending(val / 100);\r\n                }\r\n            });\r\n            blendingSlider.getElement().style.marginTop = \"10px\";\r\n\r\n            let pressureSizeToggle = penPressureToggle(true, function (b) {\r\n                brush.setSizePressure(b);\r\n            });\r\n            let pressureOpacityToggle = penPressureToggle(false, function (b) {\r\n                brush.setOpacityPressure(b);\r\n            });\r\n\r\n            let lockAlphaToggle = new Checkbox({\r\n                init: brush.getLockAlpha(),\r\n                label: 'Lock Alpha',\r\n                callback: function (b) {\r\n                    brush.setLockAlpha(b);\r\n                },\r\n                doHighlight: true,\r\n                title: 'Locks layer\\'s alpha channel',\r\n                css: {\r\n                    marginTop: '10px',\r\n                    display: 'inline-block',\r\n                }\r\n            });\r\n\r\n\r\n            div.appendChild(pressureSizeToggle);\r\n            div.appendChild(sizeSlider.getElement());\r\n            BB.el({\r\n                parent: div,\r\n                css: {\r\n                    clear: 'both',\r\n                    marginBottom: '10px'\r\n                }\r\n            });\r\n            div.appendChild(pressureOpacityToggle);\r\n            div.appendChild(opacitySlider.getElement());\r\n            div.appendChild(blendingSlider.getElement());\r\n            div.appendChild(lockAlphaToggle.getElement());\r\n        }\r\n\r\n        init();\r\n\r\n        this.increaseSize = function (f) {\r\n            if (!brush.getIsDrawing()) {\r\n                sizeSlider.increaseValue(f);\r\n            }\r\n        };\r\n        this.decreaseSize = function (f) {\r\n            if (!brush.getIsDrawing()) {\r\n                sizeSlider.decreaseValue(f);\r\n            }\r\n        };\r\n\r\n        this.getSize = function () {\r\n            return brush.getSize();\r\n        };\r\n        this.setSize = function(size) {\r\n            setSize(size);\r\n            sizeSlider.setValue(size);\r\n        };\r\n        this.getOpacity = function () {\r\n            return brush.getOpacity();\r\n        };\r\n        this.setOpacity = function(opacity) {\r\n            brush.setOpacity(opacity);\r\n            opacitySlider.setValue(opacity);\r\n        };\r\n\r\n        this.setColor = function (c) {\r\n            brush.setColor(c);\r\n        };\r\n        this.setContext = function (c) {\r\n            brush.setContext(c);\r\n        };\r\n        this.startLine = function (x, y, p) {\r\n            brush.startLine(x, y, p);\r\n        };\r\n        this.goLine = function (x, y, p, isCoalesced) {\r\n            brush.goLine(x, y, p, isCoalesced);\r\n        };\r\n        this.endLine = function () {\r\n            brush.endLine();\r\n        };\r\n        this.getBrush = function () {\r\n            return brush;\r\n        };\r\n        this.isDrawing = function () {\r\n            return brush.getIsDrawing();\r\n        };\r\n        this.getElement = function () {\r\n            return div;\r\n        };\r\n    };\r\n\r\n    return brushInterface;\r\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"hCPh2\");","import {brushes} from '../brushes/brushes';\r\nimport {eventResMs} from './brushes-consts';\r\nimport {klHistory} from '../history/kl-history';\r\nimport {PcSlider} from '../ui/base-components/slider';\r\n// @ts-ignore\r\nimport brushIconImg from 'url:~/src/app/img/ui/brush-sketchy.png';\r\n\r\nexport const sketchyBrushUi = (function () {\r\n    let brushInterface: any = {\r\n        image: brushIconImg,\r\n        tooltip: 'Sketchy',\r\n        sizeSlider: {\r\n            min: 0.5,\r\n            max: 10\r\n        },\r\n        opacitySlider: {\r\n            min: 1 / 100,\r\n            max: 1\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param p = {onSizeChange: function(size), onOpacityChange: function(opacity)}\r\n     * @constructor\r\n     */\r\n    brushInterface.Ui = function (p) {\r\n        let div = document.createElement(\"div\"); // the gui\r\n        let brush = new brushes.sketchy();\r\n        brush.setHistory(klHistory);\r\n        p.onSizeChange(brush.getSize());\r\n        let sizeSlider;\r\n        let opacitySlider;\r\n\r\n        function setSize(size) {\r\n            brush.setSize(size);\r\n        }\r\n\r\n        function init() {\r\n            sizeSlider = new PcSlider({\r\n                label: 'Size',\r\n                width: 250,\r\n                height: 30,\r\n                min: brushInterface.sizeSlider.min,\r\n                max: brushInterface.sizeSlider.max,\r\n                initValue: brush.getSize(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setSize(val);\r\n                    p.onSizeChange(brush.getSize());\r\n                },\r\n                formatFunc: function (v) {\r\n                    v *= 2;\r\n                    if (v < 10) {\r\n                        return Math.round(v * 10) / 10;\r\n                    } else {\r\n                        return Math.round(v);\r\n                    }\r\n                }\r\n            });\r\n            opacitySlider = new PcSlider({\r\n                label: 'Opacity',\r\n                width: 250,\r\n                height: 30,\r\n                min: brushInterface.opacitySlider.min,\r\n                max: brushInterface.opacitySlider.max,\r\n                initValue: brush.getOpacity(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setOpacity(val);\r\n                    p.onOpacityChange(val);\r\n                },\r\n                formatFunc: function(v) {\r\n                    return Math.round(v * 100);\r\n                }\r\n            });\r\n            let blendSlider = new PcSlider({\r\n                label: 'Blending',\r\n                width: 250,\r\n                height: 30,\r\n                min: 0,\r\n                max: 100,\r\n                initValue: brush.getBlending() * 100,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setBlending(val / 100);\r\n                }\r\n            });\r\n            let scaleSlider = new PcSlider({\r\n                label: 'Scale',\r\n                width: 250,\r\n                height: 30,\r\n                min: 1,\r\n                max: 20,\r\n                initValue: brush.getScale(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setScale(val);\r\n                }\r\n            });\r\n            opacitySlider.getElement().style.marginTop = \"10px\";\r\n            blendSlider.getElement().style.marginTop = \"10px\";\r\n            scaleSlider.getElement().style.marginTop = \"10px\";\r\n            div.appendChild(sizeSlider.getElement());\r\n            div.appendChild(opacitySlider.getElement());\r\n            div.appendChild(blendSlider.getElement());\r\n            div.appendChild(scaleSlider.getElement());\r\n        }\r\n\r\n        init();\r\n\r\n        this.increaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.increaseValue(f);\r\n            }\r\n        };\r\n        this.decreaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.decreaseValue(f);\r\n            }\r\n        };\r\n        this.getSize = function () {\r\n            return brush.getSize();\r\n        };\r\n        this.setSize = function(size) {\r\n            setSize(size);\r\n            sizeSlider.setValue(size);\r\n        };\r\n        this.getOpacity = function () {\r\n            return brush.getOpacity();\r\n        };\r\n        this.setOpacity = function(opacity) {\r\n            brush.setOpacity(opacity);\r\n            opacitySlider.setValue(opacity);\r\n        };\r\n        this.setColor = function (c) {\r\n            brush.setColor(c);\r\n        };\r\n        this.setContext = function (c) {\r\n            brush.setContext(c);\r\n        };\r\n        this.startLine = function (x, y, pressure) {\r\n            brush.startLine(x, y, pressure);\r\n        };\r\n        this.goLine = function (x, y, pressure) {\r\n            brush.goLine(x, y, pressure, null);\r\n        };\r\n        this.endLine = function () {\r\n            brush.endLine();\r\n        };\r\n        this.getSeed = function () {\r\n            return parseInt(brush.getSeed());\r\n        };\r\n        this.setSeed = function (s) {\r\n            brush.setSeed(parseInt(s));\r\n        };\r\n        this.getBrush = function () {\r\n            return brush;\r\n        };\r\n        this.isDrawing = function () {\r\n            return brush.isDrawing();\r\n        };\r\n        this.getElement = function () {\r\n            return div;\r\n        };\r\n    };\r\n\r\n    return brushInterface;\r\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"hC7PC\");","import {BB} from '../../bb/bb';\r\nimport {brushes} from '../brushes/brushes';\r\nimport {eventResMs} from './brushes-consts';\r\nimport {klHistory} from '../history/kl-history';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {PcSlider} from '../ui/base-components/slider';\r\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\r\n// @ts-ignore\r\nimport brushIconImg from 'url:~/src/app/img/ui/brush-pixel.svg';\r\n\r\nexport const pixelBrushUi = (function () {\r\n    let brushInterface: any = {\r\n        image: brushIconImg,\r\n        tooltip: 'Pixel',\r\n        sizeSlider: {\r\n            min: 0.5,\r\n            max: 100,\r\n            curve: BB.quadraticSplineInput(0.5, 100, 0.1)\r\n        },\r\n        opacitySlider: {\r\n            min: 0,\r\n            max: 1,\r\n            curve: [[0, 1 / 100], [0.5, 0.3], [1, 1]]\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param p = {onSizeChange: function(size), onOpacityChange: function(opacity)}\r\n     * @constructor\r\n     */\r\n    brushInterface.Ui = function (p) {\r\n        let div = document.createElement(\"div\"); // the gui\r\n        let brush = new brushes.pixel();\r\n        brush.setHistory(klHistory);\r\n        p.onSizeChange(brush.getSize());\r\n        let sizeSlider;\r\n        let opacitySlider;\r\n\r\n        let lockAlphaToggle = new Checkbox({\r\n            init: brush.getLockAlpha(),\r\n            label: 'Lock Alpha',\r\n            callback: function (b) {\r\n                brush.setLockAlpha(b);\r\n            },\r\n            doHighlight: true,\r\n            title: 'Locks layer\\'s alpha channel',\r\n            css: {\r\n                marginRight: '10px',\r\n            }\r\n        });\r\n\r\n        let eraserToggle = new Checkbox({\r\n            init: brush.getIsEraser(),\r\n            label: 'Eraser',\r\n            callback: function (b) {\r\n                brush.setIsEraser(b);\r\n            },\r\n            css: {\r\n                width: '70px',\r\n                marginRight: '10px',\r\n            }\r\n        });\r\n\r\n        let ditherToggle = new Checkbox({\r\n            init: brush.getUseDither(),\r\n            label: 'Dither',\r\n            callback: function (b) {\r\n                brush.setUseDither(b);\r\n            }\r\n        });\r\n\r\n        let spacingSpline = new BB.SplineInterpolator([[0.5, 0.45], [100, 4]]);\r\n\r\n        function setSize(size) {\r\n            brush.setSize(size);\r\n            brush.setSpacing(spacingSpline.interpolate(size) / size);\r\n        }\r\n\r\n        function init() {\r\n            sizeSlider = new PcSlider({\r\n                label: 'Size',\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.sizeSlider.min,\r\n                max: brushInterface.sizeSlider.max,\r\n                initValue: brush.getSize(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    val = Math.round(val * 2) / 2;\r\n                    setSize(val);\r\n                    p.onSizeChange(val);\r\n                },\r\n                curve: brushInterface.sizeSlider.curve,\r\n                formatFunc: function (v) {\r\n                    v *= 2;\r\n                    return Math.round(v);\r\n                }\r\n            });\r\n            opacitySlider = new PcSlider({\r\n                label: 'Opacity',\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.opacitySlider.min,\r\n                max: brushInterface.opacitySlider.max,\r\n                initValue: brushInterface.opacitySlider.max,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setOpacity(val);\r\n                    p.onOpacityChange(val);\r\n                },\r\n                curve: brushInterface.opacitySlider.curve,\r\n                formatFunc: function(v) {\r\n                    return Math.round(v * 100);\r\n                }\r\n            });\r\n\r\n            let pressureSizeToggle = penPressureToggle(true, function (b) {\r\n                brush.sizePressure(b);\r\n            });\r\n\r\n            div.appendChild(pressureSizeToggle);\r\n            div.appendChild(sizeSlider.getElement());\r\n            BB.el({\r\n                parent: div,\r\n                css: {\r\n                    clear: 'both',\r\n                    marginBottom: '10px'\r\n                }\r\n            });\r\n            div.appendChild(opacitySlider.getElement());\r\n\r\n            let toggleRow = BB.el({\r\n                parent: div,\r\n                css: {\r\n                    display: 'flex',\r\n                    marginTop: '10px'\r\n                }\r\n            });\r\n\r\n            toggleRow.appendChild(lockAlphaToggle.getElement());\r\n            toggleRow.appendChild(eraserToggle.getElement());\r\n            toggleRow.appendChild(ditherToggle.getElement());\r\n        }\r\n\r\n        init();\r\n\r\n        this.increaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.increaseValue(f);\r\n            }\r\n        };\r\n        this.decreaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.decreaseValue(f);\r\n            }\r\n        };\r\n\r\n        this.getSize = function () {\r\n            return brush.getSize();\r\n        };\r\n        this.setSize = function(size) {\r\n            setSize(size);\r\n            sizeSlider.setValue(size);\r\n        };\r\n        this.getOpacity = function () {\r\n            return brush.getOpacity();\r\n        };\r\n        this.setOpacity = function(opacity) {\r\n            brush.setOpacity(opacity);\r\n            opacitySlider.setValue(opacity);\r\n        };\r\n\r\n        this.setColor = function (c) {\r\n            brush.setColor(c);\r\n        };\r\n        this.setContext = function (c) {\r\n            brush.setContext(c);\r\n        };\r\n        this.startLine = function (x, y, p) {\r\n            brush.startLine(x, y, p);\r\n        };\r\n        this.goLine = function (x, y, p) {\r\n            brush.goLine(x, y, p);\r\n        };\r\n        this.endLine = function (x, y) {\r\n            brush.endLine(x, y);\r\n        };\r\n        this.getBrush = function () {\r\n            return brush;\r\n        };\r\n        this.isDrawing = function () {\r\n            return brush.isDrawing();\r\n        };\r\n        this.getElement = function () {\r\n            return div;\r\n        };\r\n    };\r\n    return brushInterface;\r\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"eZgVv\");","import {BB} from '../../bb/bb';\r\nimport {brushes} from '../brushes/brushes';\r\nimport {eventResMs} from './brushes-consts';\r\nimport {klHistory} from '../history/kl-history';\r\nimport {PcSlider} from '../ui/base-components/slider';\r\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\n// @ts-ignore\r\nimport brushIconImg from 'url:~/src/app/img/ui/brush-eraser.svg';\r\n\r\nexport const eraserBrushUi = (function () {\r\n    let brushInterface: any = {\r\n        image: brushIconImg,\r\n        tooltip: 'Eraser [E]',\r\n        sizeSlider: {\r\n            min: 0.5,\r\n            max: 200,\r\n            curve: BB.quadraticSplineInput(0.5, 200, 0.1)\r\n        },\r\n        opacitySlider: {\r\n            min: 1 / 100,\r\n            max: 1\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param p = {onSizeChange: function(size), onOpacityChange: function(opacity)}\r\n     * @constructor\r\n     */\r\n    brushInterface.Ui = function (p) {\r\n        let div = document.createElement(\"div\"); // the gui\r\n        let brush = new brushes.eraser();\r\n        brush.setHistory(klHistory);\r\n        p.onSizeChange(brush.getSize());\r\n\r\n        let sizeSlider;\r\n        let opacitySlider;\r\n        let isTransparentBg = false;\r\n\r\n        function setSize(size) {\r\n            brush.setSize(size);\r\n        }\r\n\r\n        function init() {\r\n            sizeSlider = new PcSlider({\r\n                label: 'Size',\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.sizeSlider.min,\r\n                max: brushInterface.sizeSlider.max,\r\n                initValue: 30,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    setSize(val);\r\n                    p.onSizeChange(val);\r\n                },\r\n                curve: brushInterface.sizeSlider.curve,\r\n                formatFunc: function (v) {\r\n                    v *= 2;\r\n                    if (v < 10) {\r\n                        return Math.round(v * 10) / 10;\r\n                    } else {\r\n                        return Math.round(v);\r\n                    }\r\n                }\r\n            });\r\n            opacitySlider = new PcSlider({\r\n                label: 'Opacity',\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.opacitySlider.min,\r\n                max: brushInterface.opacitySlider.max,\r\n                initValue: 1,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setOpacity(val);\r\n                    p.onOpacityChange(val);\r\n                },\r\n                formatFunc: function(v) {\r\n                    return Math.round(v * 100);\r\n                }\r\n            });\r\n\r\n            let pressureSizeToggle = penPressureToggle(true, function (b) {\r\n                brush.sizePressure(b);\r\n            });\r\n            let pressureOpacityToggle = penPressureToggle(false, function (b) {\r\n                brush.opacityPressure(b);\r\n            });\r\n\r\n            div.appendChild(pressureSizeToggle);\r\n            div.appendChild(sizeSlider.getElement());\r\n            BB.el({\r\n                parent: div,\r\n                css: {\r\n                    clear: 'both',\r\n                    marginBottom: '10px'\r\n                }\r\n            });\r\n            div.appendChild(pressureOpacityToggle);\r\n            div.appendChild(opacitySlider.getElement());\r\n\r\n            let transparencyToggle = new Checkbox({\r\n                init: false,\r\n                label: 'Transparent Background',\r\n                callback: function (b) {\r\n                    isTransparentBg = b;\r\n                    brush.setTransparentBG(b);\r\n                },\r\n                css: {\r\n                    marginTop: \"10px\",\r\n                }\r\n            });\r\n            div.appendChild(transparencyToggle.getElement());\r\n        }\r\n\r\n        init();\r\n\r\n        function drawDot(x, y) {\r\n            brush.drawDot(x, y);\r\n        }\r\n\r\n        this.increaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.increaseValue(f);\r\n            }\r\n        };\r\n        this.decreaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.decreaseValue(f);\r\n            }\r\n        };\r\n        this.getSize = function () {\r\n            return brush.getSize();\r\n        };\r\n        this.setSize = function(size) {\r\n            setSize(size);\r\n            sizeSlider.setValue(size);\r\n        };\r\n        this.getOpacity = function () {\r\n            return brush.getOpacity();\r\n        };\r\n        this.setOpacity = function(opacity) {\r\n            brush.setOpacity(opacity);\r\n            opacitySlider.setValue(opacity);\r\n        };\r\n        this.setColor = function (c) {\r\n            //brush.setColor(c);\r\n        };\r\n        this.setContext = function (c) {\r\n            brush.setContext(c);\r\n        };\r\n        this.startLine = function (x, y, p) {\r\n            brush.startLine(x, y, p);\r\n        };\r\n        this.goLine = function (x, y, p) {\r\n            brush.goLine(x, y, p);\r\n        };\r\n        this.endLine = function () {\r\n            brush.endLine();\r\n        };\r\n        this.getBrush = function () {\r\n            return brush;\r\n        };\r\n        this.getIsTransparentBg = function () {\r\n            return isTransparentBg;\r\n        };\r\n        this.isDrawing = function () {\r\n            return brush.isDrawing();\r\n        };\r\n        this.getElement = function () {\r\n            return div;\r\n        }\r\n    };\r\n\r\n    return brushInterface;\r\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"fPZin\");","import {BB} from '../../bb/bb';\r\nimport {brushes} from '../brushes/brushes';\r\nimport {eventResMs} from './brushes-consts';\r\nimport {klHistory} from '../history/kl-history';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {PcSlider} from '../ui/base-components/slider';\r\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\r\n// @ts-ignore\r\nimport brushIconImg from 'url:~/src/app/img/ui/brush-smudge.png';\r\n\r\nexport const smudgeBrushUi = (function () {\r\n    let brushInterface: any = {\r\n        image: brushIconImg,\r\n        tooltip: 'Smudge',\r\n        sizeSlider: {\r\n            min: 0.5,\r\n            max: 100,\r\n            curve: BB.quadraticSplineInput(0.5, 100, 0.1)\r\n        },\r\n        opacitySlider: {\r\n            min: 0,\r\n            max: 1,\r\n            curve: [[0, 1 / 100], [0.5, 0.3], [1, 1]]\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param p = {onSizeChange: function(size), onOpacityChange: function(opacity)}\r\n     * @constructor\r\n     */\r\n    brushInterface.Ui = function (p) {\r\n        let div = document.createElement(\"div\"); // the gui\r\n        let brush = new brushes.smudge();\r\n        brush.setHistory(klHistory);\r\n        p.onSizeChange(brush.getSize());\r\n        let sizeSlider;\r\n        let opacitySlider;\r\n\r\n        let lockAlphaToggle = new Checkbox({\r\n            init: brush.getLockAlpha(),\r\n            label: 'Lock Alpha',\r\n            callback: function (b) {\r\n                brush.setLockAlpha(b);\r\n            },\r\n            doHighlight: true,\r\n            title: 'Locks layer\\'s alpha channel',\r\n            css: {\r\n                cssFloat: 'right',\r\n                textAlign: 'right',\r\n            }\r\n        });\r\n\r\n        let spacingSpline = new BB.SplineInterpolator([[0, 15], [8, 7], [14, 4], [30, 3], [50, 2.7], [100, 2]]);\r\n\r\n        function setSize(size) {\r\n            brush.setSize(size);\r\n            brush.setSpacing(Math.max(2, spacingSpline.interpolate(size)) / 15);\r\n        }\r\n\r\n        function init() {\r\n            sizeSlider = new PcSlider({\r\n                label: 'Size',\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.sizeSlider.min,\r\n                max: brushInterface.sizeSlider.max,\r\n                initValue: brush.getSize(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    setSize(val);\r\n                    p.onSizeChange(val);\r\n                },\r\n                curve: brushInterface.sizeSlider.curve,\r\n                formatFunc: function (v) {\r\n                    v *= 2;\r\n                    if (v < 10) {\r\n                        return Math.round(v * 10) / 10;\r\n                    } else {\r\n                        return Math.round(v);\r\n                    }\r\n                }\r\n            });\r\n            opacitySlider = new PcSlider({\r\n                label: 'Opacity',\r\n                width: 225,\r\n                height: 30,\r\n                min: brushInterface.opacitySlider.min,\r\n                max: brushInterface.opacitySlider.max,\r\n                initValue: brush.getOpacity(),\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brush.setOpacity(val);\r\n                    p.onOpacityChange(val);\r\n                },\r\n                curve: brushInterface.opacitySlider.curve,\r\n                formatFunc: function(v) {\r\n                    return Math.round(v * 100);\r\n                }\r\n            });\r\n\r\n            let pressureSizeToggle = penPressureToggle(false, function (b) {\r\n                brush.sizePressure(b);\r\n            });\r\n            let pressureOpacityToggle = penPressureToggle(false, function (b) {\r\n                brush.opacityPressure(b);\r\n            });\r\n\r\n            div.appendChild(pressureSizeToggle);\r\n            div.appendChild(sizeSlider.getElement());\r\n            BB.el({\r\n                parent: div,\r\n                css: {\r\n                    clear: 'both',\r\n                    marginBottom: '10px'\r\n                }\r\n            });\r\n            div.appendChild(pressureOpacityToggle);\r\n            div.appendChild(opacitySlider.getElement());\r\n\r\n            let bottomRow = BB.el({\r\n                parent: div,\r\n                css: {\r\n                    marginTop: '10px',\r\n                }\r\n            });\r\n            bottomRow.append(lockAlphaToggle.getElement());\r\n\r\n        }\r\n\r\n        init();\r\n\r\n        this.increaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.increaseValue(f);\r\n            }\r\n        };\r\n        this.decreaseSize = function (f) {\r\n            if (!brush.isDrawing()) {\r\n                sizeSlider.decreaseValue(f);\r\n            }\r\n        };\r\n\r\n        this.getSize = function () {\r\n            return brush.getSize();\r\n        };\r\n        this.setSize = function(size) {\r\n            setSize(size);\r\n            sizeSlider.setValue(size);\r\n        };\r\n        this.getOpacity = function () {\r\n            return brush.getOpacity();\r\n        };\r\n        this.setOpacity = function(opacity) {\r\n            brush.setOpacity(opacity);\r\n            opacitySlider.setValue(opacity);\r\n        };\r\n\r\n        this.setColor = function (c) {\r\n            brush.setColor(c);\r\n        };\r\n        this.setContext = function (c) {\r\n            brush.setContext(c);\r\n        };\r\n        this.startLine = function (x, y, p) {\r\n            brush.startLine(x, y, p);\r\n        };\r\n        this.goLine = function (x, y, p) {\r\n            brush.goLine(x, y, p);\r\n        };\r\n        this.endLine = function (x, y) {\r\n            brush.endLine(x, y);\r\n        };\r\n        this.getBrush = function () {\r\n            return brush;\r\n        };\r\n        this.isDrawing = function () {\r\n            return brush.isDrawing();\r\n        };\r\n        this.getElement = function () {\r\n            return div;\r\n        };\r\n    };\r\n    return brushInterface;\r\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"lQywM\");","import {BB} from '../../../bb/bb';\r\nimport {Popup} from './popup';\r\n\r\nexport function showIframePopup(url, isEmbed) {\r\n    if (!isEmbed && (window.innerHeight < 500 || window.innerWidth < 700)) {\r\n        window.open(url);\r\n        return;\r\n    }\r\n\r\n    let iframe = BB.el({\r\n        tagName: 'iframe',\r\n        custom: {\r\n            src: url,\r\n        },\r\n        css: {\r\n            width: '100%',\r\n            height: '100%'\r\n        }\r\n    }) as HTMLIFrameElement;\r\n    let titleEl = BB.el({});\r\n\r\n    let linkEl;\r\n    if (!isEmbed) {\r\n        linkEl = BB.el({\r\n            tagName: 'a',\r\n            parent: titleEl,\r\n            content: 'Open in new tab',\r\n            custom: {\r\n                href: 'help',\r\n                target: '_blank',\r\n            },\r\n            onClick: function() {\r\n                popup.close();\r\n            }\r\n        }) as HTMLAnchorElement;\r\n        iframe.onload = function() {\r\n            BB.setAttributes(linkEl, {\r\n                href: '' + iframe.contentWindow.location,\r\n            });\r\n        };\r\n    }\r\n\r\n\r\n    let popup = new Popup({\r\n        title: titleEl,\r\n        content: iframe,\r\n        width: 880,\r\n        isMaxHeight: true,\r\n        onClose: () => {\r\n            if (linkEl) {\r\n                BB.destroyEl(linkEl);\r\n            }\r\n        }\r\n    });\r\n\r\n}","import {BB} from '../../../bb/bb';\r\n\r\nexport class RadioList {\r\n\r\n    el: HTMLDivElement;\r\n    inputs: HTMLInputElement[] = [];\r\n\r\n    constructor(p: {\r\n        name: string;\r\n        init?: string;\r\n        items: {\r\n            label: string;\r\n            value: string;\r\n        }[],\r\n        ignoreFocus?: boolean; // default false\r\n    }) {\r\n        this.el = BB.el({\r\n            className: 'kl-radio'\r\n        }) as HTMLDivElement;\r\n\r\n        p.items.forEach(item => {\r\n            let label = BB.el({\r\n                tagName: 'label'\r\n            });\r\n            let input = BB.el({\r\n                tagName: 'input',\r\n                parent: label,\r\n                custom: {\r\n                    name: p.name,\r\n                    value: item.value,\r\n                    type: 'radio',\r\n                }\r\n            }) as HTMLInputElement;\r\n            if (p.ignoreFocus) {\r\n                input.setAttribute('data-ignore-focus', 'true');\r\n            }\r\n            if (p.init === item.value) {\r\n                input.checked = true;\r\n            }\r\n            label.append(item.label);\r\n            this.el.append(label);\r\n            this.inputs.push(input);\r\n        });\r\n    }\r\n\r\n\r\n    getValue(): string {\r\n        for (let i = 0; i < this.inputs.length; i++) {\r\n            if (this.inputs[i].checked) {\r\n                return this.inputs[i].value;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    getElement() {\r\n        return this.el;\r\n    }\r\n\r\n}","import {BB} from '../../../bb/bb';\r\n\r\n// @ts-ignore\r\nimport removeLayerImg from 'url:~/src/app/img/ui/remove-layer.svg';\r\nimport {IKlProject} from '../../kl.types';\r\nimport {showIframePopup} from '../modals/show-iframe-popup';\r\nimport {SaveReminder} from './save-reminder';\r\nimport {ProjectStore} from '../../storage/project-store';\r\nimport {KL} from '../../kl';\r\n\r\nexport class BrowserStorageUi {\r\n\r\n    private previewEl: HTMLDivElement;\r\n    private ageEl: HTMLDivElement;\r\n    private storeEl: HTMLButtonElement;\r\n    private clearEl: HTMLButtonElement;\r\n\r\n    private timestamp: number;\r\n\r\n    private updateAge() {\r\n        if (!this.timestamp) {\r\n            return;\r\n        }\r\n        let age = new Date().getTime() - this.timestamp;\r\n        let ageStr;\r\n        age = Math.floor(age / 1000 / 60);\r\n        ageStr = age + 'min ago';\r\n        if (age > 60) {\r\n            age = Math.floor(age / 60);\r\n            ageStr = age + 'h ago';\r\n            if (age > 24) {\r\n                age = Math.floor(age / 24);\r\n                ageStr = age + 'd ago';\r\n                if (age > 31) {\r\n                    ageStr = '> 1month ago';\r\n                }\r\n            }\r\n        }\r\n        this.ageEl.textContent = ageStr;\r\n    }\r\n\r\n    private resetButtons() {\r\n        if (this.timestamp) {\r\n            this.storeEl.textContent = 'Overwrite';\r\n            this.storeEl.disabled = false;\r\n            this.clearEl.disabled = false;\r\n        } else {\r\n            this.storeEl.textContent = 'Store';\r\n            this.storeEl.disabled = false;\r\n            this.clearEl.disabled = true;\r\n        }\r\n    }\r\n\r\n    private updateThumb(timestamp?: number, thumbnail?: HTMLImageElement | HTMLCanvasElement) {\r\n        this.timestamp = timestamp;\r\n        if (this.timestamp) {\r\n            BB.css(thumbnail, {\r\n                display: 'block',\r\n                maxWidth: 'calc(100% - 2px)',\r\n                maxHeight: 'calc(100% - 2px)',\r\n                margin: '0 auto',\r\n                background: \"url('\" + BB.createCheckerCanvas(4).toDataURL('image/png') + \"')\",\r\n                boxShadow: '0 0 0 1px #aaa',\r\n                pointerEvents: 'none',\r\n            });\r\n            this.previewEl.innerHTML = '';\r\n            this.updateAge();\r\n            this.previewEl.append(thumbnail, this.ageEl);\r\n        } else {\r\n            this.previewEl.innerHTML = 'Empty';\r\n        }\r\n        this.resetButtons();\r\n    }\r\n\r\n    private async store() {\r\n        this.storeEl.textContent = 'Storing...';\r\n        this.storeEl.disabled = true;\r\n        this.clearEl.disabled = true;\r\n        await new Promise((resolve) => {\r\n            setTimeout(() => resolve(null), 20);\r\n        });\r\n        try {\r\n            await this.projectStore.store(this.getProject());\r\n            this.saveReminder.reset();\r\n        } catch (e) {\r\n            this.resetButtons();\r\n            KL.popup({\r\n                target: this.klRootEl,\r\n                type: 'error',\r\n                message: 'Failed to store. Possible causes:<ul><li>Out of disk space</li><li>Storage disabled in incognito tab</li><li>Browser doesn\\'t support storage</li>',\r\n                buttons: ['Ok'],\r\n            });\r\n            setTimeout(() => {\r\n                throw new Error('storage-ui: failed to store browser storage, ' + e);\r\n            }, 0);\r\n        }\r\n    }\r\n\r\n    private async clear() {\r\n        this.storeEl.disabled = true;\r\n        this.clearEl.disabled = true;\r\n        try {\r\n            await this.projectStore.clear();\r\n        } catch (e) {\r\n            this.resetButtons();\r\n            KL.popup({\r\n                target: this.klRootEl,\r\n                type: 'error',\r\n                message: 'Failed to clear.',\r\n                buttons: ['Ok'],\r\n            });\r\n            setTimeout(() => {\r\n                throw new Error('storage-ui: failed to clear browser storage, ' + e);\r\n            }, 0);\r\n        }\r\n    }\r\n\r\n    element: HTMLDivElement;\r\n\r\n    constructor (\r\n        private projectStore: ProjectStore,\r\n        private getProject: () => IKlProject,\r\n        private saveReminder: SaveReminder,\r\n        private klRootEl: HTMLDivElement,\r\n    ) {\r\n        this.element = BB.el({\r\n            css: {\r\n                display: 'grid',\r\n                gridTemplateColumns: '1fr 0fr',\r\n                gridTemplateRows: '0fr 0fr 0fr',\r\n                gap: '0 0',\r\n                gridTemplateAreas: '\"title title\" \"preview store\" \"preview clear\"',\r\n            }\r\n        }) as HTMLDivElement;\r\n\r\n\r\n        const title = BB.el({\r\n            parent: this.element,\r\n            content: 'Browser Storage',\r\n            css: {\r\n                gridArea: 'title',\r\n                display: 'flex',\r\n                margin: '-5px 0',\r\n                //background: '#f00',\r\n            }\r\n        });\r\n\r\n        const infoEl = BB.el({\r\n            parent: title,\r\n            content: '?',\r\n            title: 'About Browser Storage',\r\n            css: {\r\n                cursor: 'pointer',\r\n                marginLeft: '5px',\r\n                width: '19px',\r\n                height: '19px',\r\n                borderRadius: '100%',\r\n                textAlign: 'center',\r\n                lineHeight: '19px',\r\n                fontWeight: 'bold',\r\n                boxShadow: 'inset 0 0 0 1px #000',\r\n            },\r\n            onClick: () => {\r\n                showIframePopup('./help/#help-browser-storage', false);\r\n            }\r\n        });\r\n\r\n        if (this.projectStore.isBroken()) {\r\n            BB.el({\r\n                parent: this.element,\r\n                content: \"🔴 Can't access\",\r\n            });\r\n            return;\r\n        }\r\n\r\n        this.previewEl = BB.el({\r\n            parent: this.element,\r\n            title: 'Restores when reopening page',\r\n            css: {\r\n                gridArea: 'preview',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                marginTop: '10px',\r\n                position: 'relative',\r\n                boxShadow: 'inset 0 0 0 1px #aaa',\r\n                background: '#cdcdcd',\r\n                color: '#545454',\r\n                colorScheme: 'only light',\r\n            }\r\n        }) as HTMLDivElement;\r\n        this.ageEl = BB.el({\r\n            css: {\r\n                position: 'absolute',\r\n                right: '0',\r\n                bottom: '0',\r\n                width: '100%',\r\n                textAlign: 'center',\r\n                background: 'rgba(0,0,0,0.7)',\r\n                color: '#fff',\r\n                textSize: '13px',\r\n            }\r\n        }) as HTMLDivElement;\r\n        this.storeEl = BB.el({\r\n            parent: this.element,\r\n            tagName: 'button',\r\n            className: 'gridButton',\r\n            content: 'Store',\r\n            css: {\r\n                gridArea: 'store',\r\n                //background: '#00f',\r\n            },\r\n            custom: {\r\n                tabIndex: -1,\r\n            },\r\n            onClick: () => this.store(),\r\n        }) as HTMLButtonElement;\r\n        this.storeEl.tabIndex = -1;\r\n        this.clearEl = BB.el({\r\n            parent: this.element,\r\n            tagName: 'button',\r\n            className: 'gridButton',\r\n            content: '<img src=\"' + removeLayerImg + '\" height=\"20\"/> Clear',\r\n            css: {\r\n                gridArea: 'clear',\r\n                //background: '#ff0',\r\n            },\r\n            custom: {\r\n                tabIndex: -1,\r\n            },\r\n            onClick: () => this.clear(),\r\n        }) as HTMLButtonElement;\r\n\r\n        this.projectStore.subscribe({\r\n            onUpdate: (timestamp, thumbnail) => {\r\n                this.updateThumb(timestamp, thumbnail);\r\n            },\r\n        });\r\n\r\n        setInterval(() => this.updateAge(), 1000 * 60);\r\n\r\n        (async () => {\r\n            try {\r\n                const readResult = await this.projectStore.read();\r\n                if (readResult) {\r\n                    this.updateThumb(readResult.timestamp, readResult.thumbnail);\r\n                } else {\r\n                    this.updateThumb();\r\n                }\r\n            } catch (e) {\r\n                setTimeout(() => {\r\n                    throw new Error('storage-ui: failed initial read browser storage, ' + e);\r\n                }, 0);\r\n            }\r\n        })();\r\n    }\r\n\r\n\r\n    getElement() {\r\n        return this.element;\r\n    }\r\n\r\n    show () {\r\n        // todo\r\n    }\r\n\r\n    hide () {\r\n        // todo\r\n    }\r\n}","import {BB} from '../../bb/bb';\r\nimport {IKlProject} from '../kl.types';\r\n\r\nexport function drawProject(project: IKlProject, factor) {\r\n    let resultCanvas = BB.canvas();\r\n    resultCanvas.width = Math.max(1, parseInt('' + (project.width * factor)));\r\n    resultCanvas.height = Math.max(1, parseInt('' + (project.height * factor)));\r\n    let ctx = resultCanvas.getContext(\"2d\");\r\n    if (factor > 1) {\r\n        ctx.imageSmoothingEnabled = false;\r\n    }\r\n    for (let i = 0; i < project.layers.length; i++) {\r\n        if (project.layers[i].opacity === 0) {\r\n            continue;\r\n        }\r\n        ctx.globalAlpha = project.layers[i].opacity;\r\n        ctx.globalCompositeOperation = project.layers[i].mixModeStr ? project.layers[i].mixModeStr : 'source-over';\r\n        ctx.drawImage(project.layers[i].image, 0, 0, resultCanvas.width, resultCanvas.height);\r\n    }\r\n    return resultCanvas;\r\n}","import {IKlProject, IKlStorageProject} from '../kl.types';\r\nimport {ProjectConverter} from './project-converter';\r\nimport {clear, getKlProjectObj, storeKlProjectObj} from './indexed-db';\r\n\r\n\r\nexport interface IProjectStoreListener {\r\n    onUpdate: (timestamp?: number, thumbnail?: HTMLImageElement | HTMLCanvasElement) => void,\r\n}\r\n\r\nfunction makeAsync(func): Promise<any> {\r\n    return new Promise((resolve, reject) => {\r\n        func(resolve, reject);\r\n    });\r\n}\r\n\r\n/**\r\n * simplified interface for storing projects into browser storage\r\n */\r\nexport class ProjectStore {\r\n\r\n    private listeners: IProjectStoreListener[] = [];\r\n    private accessHasFailed: boolean = false;\r\n\r\n    async lowLevelStore (project: IKlStorageProject): Promise<any> {\r\n        await new Promise((resolve, reject) => {\r\n            storeKlProjectObj(project, resolve, reject);\r\n        });\r\n    }\r\n\r\n    async lowLevelRead (): Promise<IKlStorageProject> {\r\n        return await makeAsync(getKlProjectObj) as IKlStorageProject;\r\n    }\r\n\r\n    async lowLevelClear (): Promise<any> {\r\n        await makeAsync(clear);\r\n    }\r\n\r\n\r\n\r\n    private emit(timestamp?: number, thumbnail?: HTMLImageElement | HTMLCanvasElement) {\r\n        this.listeners.forEach(item => {\r\n            item.onUpdate(timestamp, thumbnail);\r\n        });\r\n    }\r\n\r\n    private updateTimestamp() {\r\n        localStorage.setItem('indexedDbUpdatedAt', '' + new Date().getTime());\r\n    }\r\n\r\n    // --- public ---\r\n\r\n    constructor () {\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key !== 'indexedDbUpdatedAt' || this.listeners.length === 0) {\r\n                return;\r\n            }\r\n            try {\r\n                ( async () => {\r\n                    const readResult = await this.read();\r\n                    if (readResult) {\r\n                        this.emit(readResult.timestamp, readResult.thumbnail);\r\n                    } else {\r\n                        this.emit();\r\n                    }\r\n                })();\r\n            } catch (e) {\r\n                if (e.message === 'db-error') {\r\n                    this.accessHasFailed = true;\r\n                }\r\n            }\r\n\r\n        });\r\n    }\r\n\r\n    async read(): Promise<{\r\n        project: IKlProject,\r\n        timestamp: number,\r\n        thumbnail: HTMLImageElement | HTMLCanvasElement\r\n    } | null> {\r\n        let storageProject;\r\n        try {\r\n            storageProject = await this.lowLevelRead();\r\n        } catch (e) {\r\n            this.accessHasFailed = true;\r\n            throw new Error('db-error');\r\n        }\r\n        if (!storageProject) {\r\n            return null;\r\n        }\r\n        let result;\r\n        try {\r\n            result = await ProjectConverter.readStorageProject(storageProject);\r\n        } catch (e) {\r\n            throw new Error('format-error');\r\n        }\r\n        return result;\r\n    }\r\n\r\n    async store(project: IKlProject): Promise<void> {\r\n        try {\r\n            const storageProject = ProjectConverter.createStorageProject(project);\r\n            await this.lowLevelStore(storageProject);\r\n        } catch (e) {\r\n            this.accessHasFailed = true;\r\n            throw new Error('db-error');\r\n        }\r\n        {\r\n            // immediately test if it can be read\r\n            const storageProject = await this.lowLevelRead();\r\n            let readResult = null;\r\n            try {\r\n                readResult = await ProjectConverter.readStorageProject(storageProject);\r\n            } catch (e) {\r\n                await this.lowLevelClear();\r\n                this.updateTimestamp();\r\n                setTimeout(() => this.emit(), 0);\r\n                throw new Error('format-error');\r\n            }\r\n            this.updateTimestamp();\r\n            setTimeout(() => this.emit(readResult.timestamp, readResult.thumbnail), 0);\r\n        }\r\n    }\r\n\r\n    async clear(): Promise<void> {\r\n        await this.lowLevelClear();\r\n        this.updateTimestamp();\r\n        setTimeout(() => this.emit(), 0);\r\n    }\r\n\r\n    subscribe(listener: IProjectStoreListener) {\r\n        if (this.listeners.includes(listener)) {\r\n            return;\r\n        }\r\n        this.listeners.push(listener);\r\n    }\r\n\r\n    unsubscribe(listener: IProjectStoreListener) {\r\n        for (let i = 0; i < this.listeners.length; i++) {\r\n            if (listener === this.listeners[i]) {\r\n                this.listeners.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    isBroken() {\r\n        return this.accessHasFailed;\r\n    }\r\n\r\n}","import {IKlProject, IKlStorageProject} from '../kl.types';\r\nimport {BB} from '../../bb/bb';\r\nimport {drawProject} from '../canvas/draw-project';\r\nimport {base64ToBlob} from './base-64-to-blob';\r\n\r\n\r\nconst thumbSize = 240;\r\n\r\nfunction loadImage(blob: Blob): Promise<HTMLImageElement> {\r\n    return new Promise<HTMLImageElement>((resolve, reject) => {\r\n        const im = new Image();\r\n        try {\r\n            im.src = BB.imageBlobToUrl(blob);\r\n        } catch (e) {\r\n            reject('imageBlobToUrl, ' + e.message);\r\n            return;\r\n        }\r\n        im.onload = () => {\r\n            resolve(im);\r\n        }\r\n        im.onabort = function () {\r\n            reject('layer image failed loading');\r\n        };\r\n        im.onerror = function () {\r\n            reject('layer image failed loading');\r\n        };\r\n    });\r\n}\r\n\r\n/**\r\n * for:\r\n * - preparing project to be stored in ProjectStore\r\n * - reading a project that came out of the ProjectStore\r\n */\r\nexport class ProjectConverter {\r\n\r\n    private static createThumbnail(project): HTMLCanvasElement {\r\n        const size = BB.fitInto(project.width, project.height, thumbSize, thumbSize);\r\n        const factor = size.width / project.width;\r\n        return drawProject(project, factor);\r\n    }\r\n\r\n    static createStorageProject(project: IKlProject): IKlStorageProject {\r\n        return {\r\n            id: 1,\r\n            timestamp: new Date().getTime(),\r\n            thumbnail: base64ToBlob(ProjectConverter.createThumbnail(project).toDataURL('image/png')),\r\n            width: project.width,\r\n            height: project.height,\r\n            layers: project.layers.map(item => {\r\n                let blob;\r\n                if (item.image instanceof HTMLCanvasElement) {\r\n                    blob = base64ToBlob((item.image as HTMLCanvasElement).toDataURL('image/png'));\r\n                } else {\r\n                    // todo image\r\n                    throw new Error('Not implemented');\r\n                }\r\n                return {\r\n                    name: item.name,\r\n                    opacity: item.opacity,\r\n                    mixModeStr: item.mixModeStr,\r\n                    blob,\r\n                }\r\n            }),\r\n        };\r\n    }\r\n\r\n    static async readStorageProject(storageProject: IKlStorageProject): Promise<{\r\n        project: IKlProject,\r\n        timestamp: number,\r\n        thumbnail: HTMLImageElement | HTMLCanvasElement\r\n    }> {\r\n        const project: IKlProject = {\r\n            width: storageProject.width,\r\n            height: storageProject.height,\r\n            layers: (await Promise.all(storageProject.layers.map(layer => loadImage(layer.blob))))\r\n                .map((image, i) => {\r\n                    return {\r\n                        name: storageProject.layers[i].name,\r\n                        opacity: storageProject.layers[i].opacity,\r\n                        mixModeStr: storageProject.layers[i].mixModeStr,\r\n                        image,\r\n                    };\r\n                }),\r\n        };\r\n\r\n        let thumbnail;\r\n        if (storageProject.thumbnail) {\r\n            thumbnail = await loadImage(storageProject.thumbnail);\r\n        } else {\r\n            thumbnail = ProjectConverter.createThumbnail(project);\r\n        }\r\n\r\n        return {\r\n            project: project,\r\n            timestamp: storageProject.timestamp,\r\n            thumbnail: thumbnail,\r\n        };\r\n    }\r\n\r\n}","\r\nexport function base64ToBlob(base64Str: string): Blob {\r\n    let parts = base64Str.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);\r\n    let binStr = atob(parts[3]);\r\n    let buf = new ArrayBuffer(binStr.length);\r\n    let view = new Uint8Array(buf);\r\n    for (let i = 0; i < view.length; i++) {\r\n        view[i] = binStr.charCodeAt(i);\r\n    }\r\n    return new Blob([view], {'type': parts[1]});\r\n}","import {BB} from '../../../bb/bb';\r\nimport {KL} from '../../kl';\r\n// @ts-ignore\r\nimport newImageImg from 'url:~/src/app/img/ui/new-image.svg';\r\n// @ts-ignore\r\nimport exportImg from 'url:~/src/app/img/ui/export.svg';\r\n// @ts-ignore\r\nimport shareImg from 'url:~/src/app/img/ui/share.svg';\r\n// @ts-ignore\r\nimport uploadImg from 'url:~/src/app/img/ui/upload.svg';\r\n// @ts-ignore\r\nimport importImg from 'url:~/src/app/img/ui/import.svg';\r\n// @ts-ignore\r\nimport copyImg from 'url:~/src/app/img/ui/copy.svg';\r\nimport {BrowserStorageUi} from '../components/browser-storage-ui';\r\nimport {IKlProject} from '../../kl.types';\r\nimport {SaveReminder} from '../components/save-reminder';\r\nimport {ProjectStore} from '../../storage/project-store';\r\n\r\nexport type exportType = 'png' | 'layers' | 'psd';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport class FileTab {\r\n\r\n    private readonly div: HTMLDivElement;\r\n    private importButton: HTMLInputElement;\r\n    private fileBrowserStorage: BrowserStorageUi;\r\n\r\n    constructor(\r\n        klRootEl,\r\n        projectStore: ProjectStore,\r\n        getProject: () => IKlProject,\r\n        private exportType,\r\n        onExportTypeChange,\r\n        onFileSelect,\r\n        onSaveImageToComputer,\r\n        onNewImage,\r\n        onShareImage,\r\n        onUpload,\r\n        onCopyToClipboard,\r\n        saveReminder: SaveReminder,\r\n    ) {\r\n        const _this = this;\r\n        this.div = document.createElement(\"div\");\r\n\r\n        const asyncCreation = () => {\r\n            let filemenu = document.createElement(\"div\");\r\n            let newButton = document.createElement(\"button\");\r\n            let saveButton = document.createElement(\"button\");\r\n            let shareButton = document.createElement(\"button\");\r\n            let uploadImgurButton = document.createElement(\"button\");\r\n            let clipboardButton = document.createElement(\"button\");\r\n\r\n            newButton.style.cssFloat = 'left';\r\n            BB.css(saveButton, {\r\n                cssFloat: 'left',\r\n                clear: 'both',\r\n            });\r\n            BB.css(clipboardButton, {\r\n                cssFloat: 'left',\r\n                clear: 'both',\r\n            });\r\n\r\n            newButton.tabIndex = -1;\r\n            saveButton.tabIndex = -1;\r\n            shareButton.tabIndex = -1;\r\n            uploadImgurButton.tabIndex = -1;\r\n            clipboardButton.tabIndex = -1;\r\n\r\n            newButton.innerHTML = \"<img src='\" + newImageImg + \"' alt='New Image' height='20'/>New\";\r\n            saveButton.innerHTML = \"<img src='\" + exportImg + \"' alt='Save Image' height='20'/>Save\";\r\n            shareButton.innerHTML = \"<img src='\" + shareImg + \"' alt='Share Image' height='20'/>Share\";\r\n            uploadImgurButton.innerHTML = \"<img style='float:left' src='\" + uploadImg + \"' height='20' alt='Upload to Imgur'/>Upload\";\r\n            clipboardButton.innerHTML = \"<img src='\" + copyImg + \"' alt='Share Image' height='20'/>Copy\";\r\n            clipboardButton.title = \"Copy To Clipboard\";\r\n            newButton.className = \"gridButton\";\r\n            saveButton.className = \"gridButton\";\r\n            shareButton.className = \"gridButton\";\r\n            uploadImgurButton.className = \"gridButton\";\r\n            clipboardButton.className = \"gridButton\";\r\n\r\n\r\n            this.importButton = document.createElement(\"input\");\r\n            this.importButton.tabIndex = -1;\r\n            this.importButton.type = \"file\";\r\n            this.importButton.multiple = true;\r\n            this.importButton.accept = \"image\";\r\n            (this.importButton as any).size = \"71\";\r\n            this.importButton.textContent = \"Import\";\r\n            let importWrapper: any = this.importButton;\r\n\r\n            function createImportButton() {\r\n                importWrapper = document.createElement(\"div\");\r\n                importWrapper.className = \"gridButton\";\r\n                importWrapper.style.position = \"relative\";\r\n                importWrapper.style.cursor = \"pointer\";\r\n                importWrapper.style.cssFloat = \"left\";\r\n\r\n                let innerMask = document.createElement(\"div\");\r\n                innerMask.style.width = \"120px\";\r\n                innerMask.style.height = \"28px\";\r\n                innerMask.style.overflow = \"hidden\";\r\n                innerMask.style.cursor = \"pointer\";\r\n                innerMask.style.position = \"relative\";\r\n\r\n                importWrapper.appendChild(innerMask);\r\n                innerMask.appendChild(_this.importButton);\r\n\r\n                let importFakeButton = document.createElement(\"button\");\r\n                importFakeButton.innerHTML = \"<img style='float:left' height='20' src='\" + importImg + \"' alt='Import Image'/>Import\";\r\n                importFakeButton.tabIndex = -1;\r\n\r\n                BB.css(importFakeButton, {\r\n                    width: \"120px\",\r\n                    display: \"box\",\r\n                    position: \"absolute\",\r\n                    left: '0',\r\n                    top: '0',\r\n                    cursor: \"pointer\"\r\n                });\r\n                BB.css(_this.importButton, {\r\n                    display: 'none'\r\n                });\r\n                importWrapper.appendChild(importFakeButton);\r\n\r\n                importFakeButton.onclick = function() {\r\n                    _this.importButton.click();\r\n                }\r\n            }\r\n\r\n            createImportButton();\r\n\r\n            this.importButton.onchange = function (e) {\r\n                onFileSelect(_this.importButton.files, 'default');\r\n                _this.importButton.value = \"\";\r\n\r\n            };\r\n\r\n\r\n            // --- export filetype dropdown ---\r\n            let exportTypeWrapper;\r\n            let exportTypeSelect;\r\n            {\r\n                exportTypeWrapper = BB.el({\r\n                    css: {\r\n                        fontSize: '15px',\r\n                        marginLeft: '10px',\r\n                        marginTop: '10px',\r\n                        cssFloat: 'left',\r\n                        width: 'calc(50% - 15px)',\r\n                        height: '30px'\r\n                    }\r\n                });\r\n                exportTypeSelect = new KL.Select({\r\n                    optionArr: [\r\n                        ['png', 'Save PNG'],\r\n                        ['psd', 'Save PSD'],\r\n                        ['layers', 'Save Layers'],\r\n                    ],\r\n                    initValue: exportType,\r\n                    onChange: function(val) {\r\n                        exportType = val;\r\n                        onExportTypeChange(exportType);\r\n                        onSaveImageToComputer();\r\n                    }\r\n                });\r\n                BB.css(exportTypeSelect.getElement(), {\r\n                    width: '120px',\r\n                    height: '30px'\r\n                });\r\n                exportTypeWrapper.appendChild(exportTypeSelect.getElement());\r\n\r\n            }\r\n\r\n\r\n\r\n            newButton.onclick = onNewImage;\r\n            saveButton.onclick = function () {\r\n                onSaveImageToComputer();\r\n            };\r\n            shareButton.onclick = function() {\r\n                shareButton.disabled = true;\r\n                onShareImage(() => {\r\n                    shareButton.disabled = false;\r\n                });\r\n            };\r\n            uploadImgurButton.onclick = function () {\r\n                onUpload();\r\n            };\r\n\r\n            clipboardButton.onclick = function() {\r\n                clipboardButton.blur();\r\n                onCopyToClipboard();\r\n            };\r\n\r\n            let saveNote = document.createElement(\"div\");\r\n            saveNote.textContent = \"⚠️ No autosave, no cloud storage\";\r\n            BB.css(saveNote, {\r\n                textAlign: \"center\",\r\n                marginTop: \"10px\",\r\n                background: \"rgb(243, 243, 161)\",\r\n                marginLeft: \"10px\",\r\n                marginRight: \"10px\",\r\n                borderRadius: \"4px\",\r\n                padding: \"5px 0px\",\r\n                color: 'rgba(0,0,0,0.65)',\r\n                fontSize: '15px',\r\n            });\r\n\r\n            function createSpacer() {\r\n                let el = document.createElement(\"div\");\r\n                let clearer = document.createElement(\"div\");\r\n                let line = document.createElement(\"div\");\r\n                el.appendChild(clearer);\r\n                el.appendChild(line);\r\n                BB.css(clearer, {\r\n                    clear: 'both'\r\n                });\r\n                BB.css(line, {\r\n                    marginLeft: \"10px\",\r\n                    marginRight: \"10px\",\r\n                    marginTop: \"10px\",\r\n                    borderBottom: \"1px solid rgba(0,0,0,0.2)\",\r\n                    clear: 'both'\r\n                });\r\n                return el;\r\n            }\r\n\r\n            _this.fileBrowserStorage = new BrowserStorageUi(projectStore, getProject, saveReminder, klRootEl);\r\n            BB.css(_this.fileBrowserStorage.getElement(), {\r\n                //background: 'red',\r\n                margin: '10px',\r\n            });\r\n\r\n\r\n            let headlineUpload = document.createElement(\"div\");\r\n            headlineUpload.innerHTML = \"Upload<br>\";\r\n            BB.css(headlineUpload, {\r\n                marginLeft: \"10px\",\r\n                marginRight: \"10px\",\r\n                paddingTop: \"5px\",\r\n                marginBottom: \"-5px\"\r\n            });\r\n\r\n\r\n            //actual structure\r\n            BB.append(filemenu, [\r\n                saveNote,\r\n                newButton,\r\n                importWrapper,\r\n                saveButton,\r\n                exportTypeWrapper,\r\n                clipboardButton,\r\n                BB.canShareFiles() ? shareButton : null,\r\n                createSpacer(),\r\n                _this.fileBrowserStorage.getElement(),\r\n                createSpacer(),\r\n                uploadImgurButton,\r\n            ]);\r\n\r\n            this.div.appendChild(filemenu);\r\n        };\r\n\r\n        setTimeout(asyncCreation, 1);\r\n    }\r\n\r\n    refresh() {\r\n    }\r\n\r\n    getElement() {\r\n        return this.div;\r\n    }\r\n\r\n    setIsVisible(isVisible: boolean) {\r\n        if (isVisible) {\r\n            this.refresh();\r\n        }\r\n    }\r\n\r\n    triggerImport() {\r\n        this.importButton.click();\r\n    }\r\n}\r\n","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"2oHM2\");","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"la7yv\");","import {BB} from '../../../bb/bb';\r\nimport {KL} from '../../kl';\r\nimport {klHistory} from '../../history/kl-history';\r\nimport {IKeyString} from '../../../bb/bb.types';\r\nimport {StatusOverlay} from '../components/status-overlay';\r\n\r\n\r\nexport class FilterTab {\r\n\r\n    private readonly div: HTMLDivElement;\r\n    private isInit = false;\r\n\r\n    constructor (\r\n        private klRootEl,\r\n        private pcColorSlider,\r\n        private layerManager,\r\n        private setCurrentLayer,\r\n        private klCanvasWorkspace,\r\n        private handUi,\r\n        private getCurrentColor,\r\n        private getKlMaxCanvasSize,\r\n        private getKlCanvas,\r\n        private getCurrentLayerCtx,\r\n        private isEmbed: boolean,\r\n        private statusOverlay: StatusOverlay,\r\n    ) {\r\n        this.div = document.createElement(\"div\");\r\n    }\r\n\r\n    private init() {\r\n        const _this = this;\r\n        let hasWebGl = BB.hasWebGl();\r\n        let filters = KL.filterLib;\r\n        let buttons = [];\r\n\r\n        BB.BbLog.emit({\r\n            type: 'init-filters',\r\n        });\r\n\r\n        if (!KL.filterLibStatus.isLoaded) {\r\n            throw new Error('filters not loaded');\r\n        }\r\n\r\n        function createButton(filterKey, filterArr) {\r\n            let button = document.createElement(\"button\");\r\n            let buttonLabel = filterArr[filterKey].buttonLabel ? filterArr[filterKey].buttonLabel : filterArr[filterKey].name;\r\n            let name = filterArr[filterKey].name;\r\n            let im = '<img height=\"20\" width=\"18\" src=\"' + filterArr[filterKey].icon + '\" alt=\"' + name + '\" />';\r\n            if (name.length > 11) {\r\n                name = \"<span style='font-size: 12px'>\" + buttonLabel + \"</span>\";\r\n            }\r\n            button.innerHTML = im + name;\r\n            button.className = \"gridButton\";\r\n            button.tabIndex = -1;\r\n            button.onclick = function () {\r\n\r\n                function finishedDialog(result, filterDialog) {\r\n                    if (result == \"Cancel\") {\r\n                        if (filterDialog.destroy) {\r\n                            filterDialog.destroy();\r\n                        }\r\n                        return;\r\n                    }\r\n                    let input;\r\n                    try {\r\n                        input = filterDialog.getInput(); // also destroys\r\n                    } catch (e) {\r\n                        if(e.message.indexOf('.getInput is not a function') !== -1) {\r\n                            throw 'filterDialog.getInput is not a function, filter: ' + filterArr[filterKey].name;\r\n                        } else {\r\n                            throw e;\r\n                        }\r\n                    }\r\n                    applyFilter(input);\r\n                }\r\n\r\n                if (!('apply' in filterArr[filterKey])) {\r\n                    alert('Application not fully loaded');\r\n                    return;\r\n                }\r\n\r\n                function applyFilter(input) {\r\n                    let filterResult = filterArr[filterKey].apply({\r\n                        context: _this.getCurrentLayerCtx(),\r\n                        canvas: _this.getKlCanvas(),\r\n                        history: klHistory,\r\n                        input: input\r\n                    });\r\n                    if (filterResult === false) {\r\n                        alert(\"Couldn't apply the edit action\");\r\n                    }\r\n                    if (filterArr[filterKey].updateContext === true) {\r\n                        _this.setCurrentLayer(_this.getKlCanvas().getLayer(_this.layerManager.getSelected()));\r\n                    }\r\n                    if (filterArr[filterKey].updatePos === true) {\r\n                        _this.klCanvasWorkspace.resetView();\r\n                        _this.handUi.update(_this.klCanvasWorkspace.getScale(), _this.klCanvasWorkspace.getAngleDeg());\r\n                    }\r\n                    _this.layerManager.update();\r\n                }\r\n\r\n                if (filterArr[filterKey].isInstant){\r\n                    button.blur();\r\n                    applyFilter(null);\r\n                    _this.statusOverlay.out('\"' + filterArr[filterKey].name + '\" applied', true);\r\n                } else {\r\n                    let secondaryColorRGB = _this.pcColorSlider.getSecondaryRGB();\r\n                    let filterDialog = filterArr[filterKey].getDialog({\r\n                        context: _this.getCurrentLayerCtx(),\r\n                        canvas: _this.getKlCanvas(),\r\n                        maxWidth: _this.getKlMaxCanvasSize(),\r\n                        maxHeight: _this.getKlMaxCanvasSize(),\r\n                        currentColorRgb: {r: _this.getCurrentColor().r, g: _this.getCurrentColor().g, b: _this.getCurrentColor().b},\r\n                        secondaryColorRgb: {r: secondaryColorRGB.r, g: secondaryColorRGB.g, b: secondaryColorRGB.b}\r\n                    });\r\n\r\n                    if (!filterDialog) {\r\n                        return;\r\n                        //alert('Error: could not perform action');\r\n                        //throw('filter['+filterKey+'].getDialog returned '+filterDialog+'. ctx:' + currentLayerCtx + ' klCanvas:' + klCanvas);\r\n                    }\r\n\r\n                    let closefunc;\r\n                    filterDialog.errorCallback = function(e) {\r\n                        setTimeout(function() {\r\n                            alert('Error: could not perform action');\r\n                            throw e;\r\n                        }, 0);\r\n                        closefunc();\r\n                    };\r\n\r\n\r\n                    let style: IKeyString = {};\r\n                    if('width' in filterDialog) {\r\n                        style.width = filterDialog.width + 'px'\r\n                    }\r\n\r\n                    KL.popup({\r\n                        target: _this.klRootEl,\r\n                        message: \"<b>\" + filterArr[filterKey].name + \"</b>\",\r\n                        div: filterDialog.element,\r\n                        style: style,\r\n                        buttons: [\"Ok\", \"Cancel\"],\r\n                        clickOnEnter: 'Ok',\r\n                        callback: function(result) {\r\n                            finishedDialog(result, filterDialog);\r\n                        },\r\n                        closefunc: function (func) {\r\n                            closefunc = func;\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n            buttons[buttons.length] = button;\r\n            return button;\r\n        }\r\n\r\n        function createDisabledButton(filterKey, filterArr) {\r\n            if (!filterArr[filterKey].webgl && !filterArr[filterKey].ieFails) {\r\n                return;\r\n            }\r\n            if (filterArr[filterKey].ieFails && navigator.appName !== 'Microsoft Internet Explorer') {\r\n                return;\r\n            }\r\n            let buttonLabel = filterArr[filterKey].buttonLabel ? filterArr[filterKey].buttonLabel : filterArr[filterKey].name;\r\n            let button = document.createElement(\"button\");\r\n            let im = '<img style=\"opacity: 0.5\" src=\"img/' + filterArr[filterKey].icon + '\" />';\r\n            let name = filterArr[filterKey].name;\r\n            if (name.length > 11) {\r\n                name = \"<span style='font-size: 12px'>\" + buttonLabel + \"</span>\";\r\n            }\r\n            button.innerHTML = im + name;\r\n            button.className = \"gridButton\";\r\n            button.disabled = true;\r\n            return button;\r\n        }\r\n\r\n        function addGroup(groupArr, filterArr, targetEl) {\r\n            for (let filterKey in filterArr) {\r\n                if (filterArr.hasOwnProperty[filterKey] || !groupArr.includes(filterKey)) {\r\n                    continue;\r\n                }\r\n                if (_this.isEmbed && !filterArr[filterKey].inEmbed) {\r\n                    continue;\r\n                }\r\n                if ((filterArr[filterKey].webgl && hasWebGl)\r\n                    || (filterArr[filterKey].neededWithWebGL)\r\n                    || (!filterArr[filterKey].webgl && !hasWebGl)\r\n                    && !(filterArr[filterKey].ieFails && navigator.appName == 'Microsoft Internet Explorer')) {\r\n\r\n                    targetEl.appendChild(createButton(filterKey, filterArr));\r\n\r\n                } else {\r\n                    targetEl.appendChild(createDisabledButton(filterKey, filterArr));\r\n                    filterArr[filterKey] = undefined;\r\n                }\r\n            }\r\n        }\r\n\r\n        let groupA = [\r\n            'cropExtend',\r\n            'flip',\r\n            'glPerspective',\r\n            'resize',\r\n            'rotate',\r\n            'transform'\r\n        ];\r\n        let groupB = [];\r\n        for (let filterKey in filters) {\r\n            if (filters.hasOwnProperty[filterKey] || groupA.includes(filterKey)) {\r\n                continue;\r\n            }\r\n            groupB.push(filterKey);\r\n        }\r\n\r\n        addGroup(groupA, filters, _this.div);\r\n        let hrEl = document.createElement(\"div\");\r\n        hrEl.className = \"gridHr\";\r\n        _this.div.appendChild(hrEl);\r\n        addGroup(groupB, filters, _this.div);\r\n\r\n\r\n        if (!hasWebGl) {\r\n            let webglnote = BB.appendTextDiv(_this.div, \"Some actions are disabled because WebGL isn't working.\");\r\n            webglnote.style.margin = \"10px\";\r\n            BB.css(webglnote, {\r\n                fontSize: \"11px\",\r\n                color: \"#555\",\r\n                background: \"#ffe\",\r\n                padding: \"10px\",\r\n                borderRadius: \"10px\",\r\n                textAlign: \"center\"\r\n            });\r\n        }\r\n\r\n        this.isInit = true;\r\n    }\r\n\r\n    getElement() {\r\n        return this.div;\r\n    }\r\n\r\n    show() {\r\n        if (!this.isInit) {\r\n            this.init();\r\n        }\r\n        this.div.style.display = 'block';\r\n    }\r\n\r\n    hide() {\r\n        this.div.style.display = 'none';\r\n    }\r\n\r\n}","import {BB} from '../../../bb/bb';\r\nimport {KL} from '../../kl';\r\n// @ts-ignore\r\nimport loadingImg from 'url:~/src/app/img/ui/loading.gif';\r\nimport {SaveReminder} from './save-reminder';\r\nimport {base64ToBlob} from '../../storage/base-64-to-blob';\r\n\r\n\r\nasync function upload(canvas, title, description, type: 'png' | 'jpeg', imgurKey: string): Promise<{deletehash: string}> {\r\n    let img = base64ToBlob(canvas.toDataURL(\"image/\" + type));\r\n\r\n    let w = window.open();\r\n    let label = w.document.createElement(\"div\");\r\n    let gif = w.document.createElement(\"img\");\r\n    gif.src = loadingImg;\r\n    label.appendChild(gif);\r\n    BB.css(gif, {\r\n        filter: \"invert(1)\"\r\n    });\r\n    w.document.body.style.backgroundColor = \"#121211\";\r\n    w.document.body.style.backgroundImage = \"linear-gradient(#2b2b2b 0%, #121211 50%)\";\r\n    w.document.body.style.backgroundRepeat = \"no-repeat\";\r\n    let labelText = w.document.createElement(\"div\");\r\n    labelText.style.marginTop = \"10px\";\r\n    label.appendChild(labelText);\r\n    labelText.textContent = \"Uploading...\";\r\n\r\n    w.document.body.appendChild(label);\r\n    BB.css(label, {\r\n        marginLeft: \"auto\",\r\n        marginRight: \"auto\",\r\n        marginTop: \"100px\",\r\n        fontFamily: \"Arial, sans-serif\",\r\n        fontSize: \"20px\",\r\n        textAlign: \"center\",\r\n        transition: \"opacity 0.3s ease-in-out\",\r\n        opacity: '0',\r\n        color: \"#ccc\"\r\n    });\r\n    setTimeout(function () {\r\n        label.style.opacity = '1';\r\n    }, 20);\r\n\r\n    let response;\r\n    try {\r\n        const formData = new FormData();\r\n        formData.append('title', title);\r\n        formData.append('description', description);\r\n        formData.append('image', img);\r\n        response = await fetch('https://api.imgur.com/3/image',  {\r\n            method: 'POST',\r\n            headers: {\r\n                Authorization: 'Client-ID ' + imgurKey,\r\n            },\r\n            body: formData\r\n        });\r\n\r\n    } catch (e) {\r\n        w.close();\r\n        throw new Error(e);\r\n    }\r\n    if (!response.ok) {\r\n        w.close();\r\n        throw new Error();\r\n    }\r\n    let data = (await response.json()).data;\r\n\r\n    w.location.href = (data as any).link.replace(/\\.(jpg|png)/, '');\r\n\r\n    return data;\r\n}\r\n\r\n\r\nexport function imgurUpload(klCanvas, klRootEl, saveReminder: SaveReminder, imgurKey: string) {\r\n    if (!imgurKey) {\r\n        throw new Error('imgur key missing');\r\n    }\r\n\r\n    let inputTitle = document.createElement(\"input\");\r\n    inputTitle.type = \"text\";\r\n    inputTitle.value = \"Untitled\";\r\n    let inputDescription = document.createElement(\"textarea\");\r\n    inputDescription.cols = 30;\r\n    inputDescription.rows = 2;\r\n    let labelTitle = document.createElement(\"div\");\r\n    labelTitle.textContent = \"Title:\";\r\n    let labelDescription = BB.el({\r\n        content: 'Caption:',\r\n        css: {\r\n            marginTop: '10px',\r\n        }\r\n    });\r\n\r\n    let tos = document.createElement(\"div\");\r\n    tos.innerHTML = \"<br/><a href=\\\"https://imgur.com/tos\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\">Terms of Service</a> for imgur.com\";\r\n\r\n    const typeRadio = new KL.RadioList({\r\n        name: 'filetype',\r\n        init: 'jpeg',\r\n        items: [\r\n            { label: 'JPG', value: 'jpeg' },\r\n            { label: 'PNG', value: 'png' },\r\n        ],\r\n        ignoreFocus: true,\r\n    });\r\n    BB.css(typeRadio.getElement(), {\r\n        marginBottom: '10px',\r\n    });\r\n\r\n\r\n    let outDiv = document.createElement(\"div\");\r\n    let infoHint = document.createElement(\"div\");\r\n    infoHint.className = \"info-hint\";\r\n    infoHint.textContent = \"Anyone with the link to your uploaded image will be able to view it.\";\r\n    outDiv.append(\r\n        infoHint,\r\n        typeRadio.getElement(),\r\n        labelTitle,\r\n        inputTitle,\r\n        labelDescription,\r\n        inputDescription,\r\n        tos\r\n    );\r\n    KL.popup({\r\n        target: klRootEl,\r\n        message: \"<b>Upload to Imgur</b>\",\r\n        type: \"upload\",\r\n        div: outDiv,\r\n        buttons: [\"Upload\", \"Cancel\"],\r\n        clickOnEnter: 'Upload',\r\n        primaries: ['Upload'],\r\n        callback: async function (val) {\r\n            if (val === \"Upload\" || val === \"Yes\" || val === \"Ok\") {\r\n                try {\r\n                    const result = await upload(\r\n                        klCanvas.getCompleteCanvas(1),\r\n                        inputTitle.value,\r\n                        inputDescription.value,\r\n                        typeRadio.getValue() as 'png' | 'jpeg',\r\n                        imgurKey,\r\n                    );\r\n\r\n                    KL.popup({\r\n                        target: klRootEl,\r\n                        type: \"ok\",\r\n                        message: \"<h3>Upload Successful</h3><br>To delete your image from Imgur visit:<br><a target='_blank' rel=\\\"noopener noreferrer\\\" href='https://imgur.com/delete/\" + result.deletehash + \"'>imgur.com/<b>delete</b>/\" + result.deletehash + \"</a><br><br>\",\r\n                        buttons: [\"Ok\"]\r\n                    });\r\n                    saveReminder.reset();\r\n\r\n                } catch(e) {\r\n                    KL.popup({\r\n                        target: klRootEl,\r\n                        type: \"error\",\r\n                        message: \"Upload failed.\",\r\n                        buttons: [\"Ok\"]\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    });\r\n}","import {BB} from '../../bb/bb';\r\n\r\nlet agPsdLazy;\r\nexport async function loadAgPsd() {\r\n    if (!agPsdLazy) {\r\n        agPsdLazy = await import('ag-psd');\r\n        BB.BbLog.emit({\r\n            type: 'loaded-agpsd',\r\n        });\r\n    }\r\n    return agPsdLazy;\r\n}","module.exports = (require(\"./helpers/browser/js-loader\")(require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"kNYzr\"))).then(() => parcelRequire('2m2jt'));","import {KL} from '../../kl';\r\nimport {BB} from '../../../bb/bb';\r\n\r\n/**\r\n * remind user of saving, keep user aware of save state\r\n */\r\nexport class SaveReminder {\r\n    private oldActionNumber: [number, number];\r\n    private remindersShowed: number = 0;\r\n    private unsavedInterval;\r\n    private lastReminderResetAt: number;\r\n\r\n    constructor(private history, private showReminder: boolean, private changeTitle: boolean, private title: string = 'Klecks') { }\r\n\r\n    init() {\r\n        if (this.oldActionNumber) { // already initialized\r\n            return;\r\n        }\r\n        this.oldActionNumber = this.history.getActionNumber();\r\n\r\n        if (this.showReminder) {\r\n            setInterval(() => {\r\n                if (document.visibilityState !== 'visible') {\r\n                    return;\r\n                }\r\n\r\n                let reminderTimelimitMs = 1000 * 60 * 20; // 20 minutes\r\n\r\n                let actionNumber = this.history.getActionNumber();\r\n                //number of actions that were done since last reminder\r\n                let historyDist = actionNumber[0] !== this.oldActionNumber[0] ? actionNumber[1] : Math.abs(actionNumber[1] - this.oldActionNumber[1]);\r\n\r\n                if(this.lastReminderResetAt + reminderTimelimitMs < (performance.now()) && historyDist >= 30) {\r\n                    this.reset(true);\r\n                    KL.showSaveReminderToast(this.remindersShowed++);\r\n                }\r\n            }, 1000 * 60);\r\n        }\r\n\r\n        // confirmation dialog when closing tab\r\n        function onBeforeUnload(e) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n        }\r\n\r\n        this.history.addListener(() => {\r\n            let actionNumber = this.history.getActionNumber();\r\n            if(0 !== actionNumber && this.oldActionNumber.join('.') !== actionNumber.join('.')) {\r\n                BB.setEventListener(window, 'onbeforeunload', onBeforeUnload);\r\n            } else {\r\n                BB.setEventListener(window, 'onbeforeunload', null);\r\n            }\r\n        });\r\n\r\n        if (this.changeTitle) {\r\n            document.addEventListener(\"visibilitychange\", () => {\r\n                if(document.visibilityState === 'visible') {\r\n                    document.title = this.title;\r\n                    clearInterval(this.unsavedInterval);\r\n                } else {\r\n                    let actionNumber = this.history.getActionNumber();\r\n                    if(0 !== actionNumber && this.oldActionNumber.join('.') !== actionNumber.join('.')) {\r\n                        document.title = 'Unsaved - ' + this.title;\r\n                        let state = 0;\r\n                        this.unsavedInterval = setInterval(() => {\r\n                            state = (state + 1) % 2;\r\n                            if (state === 1) {\r\n                                document.title = 'Unsaved · ' + this.title;\r\n                            } else {\r\n                                document.title = 'Unsaved - ' + this.title;\r\n                            }\r\n                        }, 1000 * 60 * 3);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    reset(isSoft?) {\r\n        if (!this.oldActionNumber) { // not initialized\r\n            return;\r\n        }\r\n        if (!isSoft) {\r\n            this.remindersShowed = 0;\r\n        }\r\n        this.lastReminderResetAt = performance.now();\r\n        this.oldActionNumber = this.history.getActionNumber();\r\n        BB.setEventListener(window, 'onbeforeunload', null);\r\n    }\r\n}\r\n","import {BB} from '../../bb/bb';\r\nimport {KL} from '../kl';\r\nimport {saveAs} from 'file-saver';\r\n\r\nexport class SaveToComputer {\r\n\r\n    constructor(\r\n        private saveReminder,\r\n        private klRootEl,\r\n        private getExportType,\r\n        private getKlCanvas,\r\n        private filenameBase: string,\r\n    ) {}\r\n\r\n    save() {\r\n        const _this = this;\r\n\r\n        _this.saveReminder.reset();\r\n\r\n\r\n        function saveImage(canvas, filename, mimeType) {\r\n            let parts = canvas.toDataURL(mimeType).match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);\r\n            //assume base64 encoding\r\n            let binStr = atob(parts[3]);\r\n            //convert to binary in ArrayBuffer\r\n            let buf = new ArrayBuffer(binStr.length);\r\n            let view = new Uint8Array(buf);\r\n            for (let i = 0; i < view.length; i++) {\r\n                view[i] = binStr.charCodeAt(i);\r\n            }\r\n            let blob = new Blob([view], {'type': parts[1]});\r\n            saveAs(blob, filename);\r\n        }\r\n\r\n        if (_this.getExportType() === 'png') {\r\n            let extension = 'png';\r\n            let mimeType = 'image/png';\r\n            let filename = BB.getDate() + this.filenameBase + \".\" + extension;\r\n            let fullCanvas = _this.getKlCanvas().getCompleteCanvas(1);\r\n\r\n            /*fullCanvas.toBlob(function(blob) {\r\n                if(blob === null) {\r\n                    throw 'save image error, blob is null';\r\n                }\r\n                saveAs(blob, filename);\r\n            }, mimetype);*/\r\n\r\n            //using old code, because saving somehow doesn't work for ipad before ios 13\r\n            //and it doesn't even throw an exception\r\n            try {\r\n                saveImage(fullCanvas, filename, mimeType);\r\n            } catch (error) { //fallback for old browsers\r\n                let im = new Image();\r\n                im.width = _this.getKlCanvas().getWidth();\r\n                im.height = _this.getKlCanvas().getHeight();\r\n                im.src = fullCanvas.toDataURL(mimeType);\r\n                KL.exportDialog(_this.klRootEl, im);\r\n            }\r\n        } else if (_this.getExportType() === 'layers') {\r\n            let extension = 'png';\r\n            let mimeType = 'image/png';\r\n            let fileBase = BB.getDate() + this.filenameBase;\r\n            let layerArr = _this.getKlCanvas().getLayersFast();\r\n            for (let i = 0; i < layerArr.length; i++) {\r\n                let item = layerArr[i];\r\n                let fnameArr = [\r\n                    fileBase,\r\n                    '_',\r\n                    ('' + (i + 1)).padStart(2, '0'),\r\n                    '_',\r\n                    item.name,\r\n                    '.',\r\n                    extension\r\n                ];\r\n                saveImage(item.canvas, fnameArr.join(''), mimeType);\r\n            }\r\n        } else if (_this.getExportType() === 'psd') {\r\n\r\n            let layerArr = _this.getKlCanvas().getLayersFast();\r\n\r\n            let psdConfig = {\r\n                width: _this.getKlCanvas().getWidth(),\r\n                height: _this.getKlCanvas().getHeight(),\r\n                children: [],\r\n                canvas: _this.getKlCanvas().getCompleteCanvas(1)\r\n            };\r\n            for (let i = 0; i < layerArr.length; i++) {\r\n                let item = layerArr[i];\r\n                psdConfig.children.push({\r\n                    name: item.name,\r\n                    opacity: item.opacity,\r\n                    canvas: item.canvas,\r\n                    blendMode: KL.PSD.blendKlToPsd(item.mixModeStr),\r\n                    left: 0,\r\n                    top: 0\r\n                });\r\n            }\r\n\r\n            KL.loadAgPsd().then((agPsdLazy) => {\r\n                let buffer = agPsdLazy.writePsdBuffer(psdConfig);\r\n                let blob = new Blob([buffer], { type: 'application/octet-stream' });\r\n                saveAs(blob, BB.getDate() + this.filenameBase + '.psd');\r\n            }).catch(() => {\r\n                alert('Error: failed to load PSD library');\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n}","/*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n*\n* By Eli Grey, http://eligrey.com\n*\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\n* source  : http://purl.eligrey.com/github/FileSaver.js\n*/\n\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nvar _global = typeof window === 'object' && window.window === window\n  ? window : typeof self === 'object' && self.self === self\n  ? self : typeof global === 'object' && global.global === global\n  ? global\n  : this\n\nfunction bom (blob, opts) {\n  if (typeof opts === 'undefined') opts = { autoBom: false }\n  else if (typeof opts !== 'object') {\n    console.warn('Deprecated: Expected third argument to be a object')\n    opts = { autoBom: !opts }\n  }\n\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\n  }\n  return blob\n}\n\nfunction download (url, name, opts) {\n  var xhr = new XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.onload = function () {\n    saveAs(xhr.response, name, opts)\n  }\n  xhr.onerror = function () {\n    console.error('could not download file')\n  }\n  xhr.send()\n}\n\nfunction corsEnabled (url) {\n  var xhr = new XMLHttpRequest()\n  // use sync to avoid popup blocker\n  xhr.open('HEAD', url, false)\n  try {\n    xhr.send()\n  } catch (e) {}\n  return xhr.status >= 200 && xhr.status <= 299\n}\n\n// `a.click()` doesn't work for all browsers (#465)\nfunction click (node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'))\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents')\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\n                          20, false, false, false, false, 0, null)\n    node.dispatchEvent(evt)\n  }\n}\n\n// Detect WebView inside a native macOS app by ruling out all browsers\n// We just need to check for 'Safari' because all other browsers (besides Firefox) include that too\n// https://www.whatismybrowser.com/guides/the-latest-user-agent/macos\nvar isMacOSWebView = _global.navigator && /Macintosh/.test(navigator.userAgent) && /AppleWebKit/.test(navigator.userAgent) && !/Safari/.test(navigator.userAgent)\n\nvar saveAs = _global.saveAs || (\n  // probably in some web worker\n  (typeof window !== 'object' || window !== _global)\n    ? function saveAs () { /* noop */ }\n\n  // Use download attribute first if possible (#193 Lumia mobile) unless this is a macOS WebView\n  : ('download' in HTMLAnchorElement.prototype && !isMacOSWebView)\n  ? function saveAs (blob, name, opts) {\n    var URL = _global.URL || _global.webkitURL\n    var a = document.createElement('a')\n    name = name || blob.name || 'download'\n\n    a.download = name\n    a.rel = 'noopener' // tabnabbing\n\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n\n    if (typeof blob === 'string') {\n      // Support regular links\n      a.href = blob\n      if (a.origin !== location.origin) {\n        corsEnabled(a.href)\n          ? download(blob, name, opts)\n          : click(a, a.target = '_blank')\n      } else {\n        click(a)\n      }\n    } else {\n      // Support blobs\n      a.href = URL.createObjectURL(blob)\n      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\n      setTimeout(function () { click(a) }, 0)\n    }\n  }\n\n  // Use msSaveOrOpenBlob as a second approach\n  : 'msSaveOrOpenBlob' in navigator\n  ? function saveAs (blob, name, opts) {\n    name = name || blob.name || 'download'\n\n    if (typeof blob === 'string') {\n      if (corsEnabled(blob)) {\n        download(blob, name, opts)\n      } else {\n        var a = document.createElement('a')\n        a.href = blob\n        a.target = '_blank'\n        setTimeout(function () { click(a) })\n      }\n    } else {\n      navigator.msSaveOrOpenBlob(bom(blob, opts), name)\n    }\n  }\n\n  // Fallback to using FileReader and a popup\n  : function saveAs (blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank')\n    if (popup) {\n      popup.document.title =\n      popup.document.body.innerText = 'downloading...'\n    }\n\n    if (typeof blob === 'string') return download(blob, name, opts)\n\n    var force = blob.type === 'application/octet-stream'\n    var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\n    var isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\n\n    if ((isChromeIOS || (force && isSafari) || isMacOSWebView) && typeof FileReader !== 'undefined') {\n      // Safari doesn't allow downloading of blob URLs\n      var reader = new FileReader()\n      reader.onloadend = function () {\n        var url = reader.result\n        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\n        if (popup) popup.location.href = url\n        else location = url\n        popup = null // reverse-tabnabbing #460\n      }\n      reader.readAsDataURL(blob)\n    } else {\n      var URL = _global.URL || _global.webkitURL\n      var url = URL.createObjectURL(blob)\n      if (popup) popup.location = url\n      else location.href = url\n      popup = null // reverse-tabnabbing #460\n      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\n    }\n  }\n)\n\n_global.saveAs = saveAs.saveAs = saveAs\n\nif (typeof module !== 'undefined') {\n  module.exports = saveAs;\n}\n","import {KL} from '../kl';\r\nimport {klHistory} from './kl-history';\r\n\r\nexport class UndoRedoCatchup {\r\n\r\n    private doIgnore = false;\r\n\r\n    constructor(\r\n        private brushUiObj,\r\n        private layerPreview,\r\n        private layerManager,\r\n        private handUi,\r\n        private klCanvasWorkspace,\r\n        private getInitState,\r\n        private getKlCanvas,\r\n        private getCurrentLayerCtx,\r\n        private setCurrentLayerCtx,\r\n        private getCurrentBrush,\r\n    ) { }\r\n\r\n    /**\r\n     * Prevent multiple undo / redo getting triggered at once.\r\n     * Might be confusing if main thread is choking.\r\n     */\r\n    ignoreTest() {\r\n        if (this.doIgnore) {\r\n            return false;\r\n        }\r\n        this.doIgnore = true;\r\n        setTimeout(() => {\r\n            this.doIgnore = false;\r\n        }, 0);\r\n        return true;\r\n    }\r\n\r\n    undo(): boolean {\r\n        const _this = this;\r\n        if (!this.ignoreTest()) {\r\n            return false;\r\n        }\r\n\r\n        if (!klHistory.canUndo()) { // || workspace.isPainting()) {\r\n            return false;\r\n        }\r\n        let startTime = performance.now();\r\n        let actions = klHistory.undo();\r\n        klHistory.pause();\r\n        let oldSize = {w: _this.getKlCanvas().getWidth(), h: _this.getKlCanvas().getHeight()};\r\n        _this.getKlCanvas().copy(_this.getInitState().canvas);\r\n        let layerIndex = _this.getInitState().focus;\r\n        _this.setCurrentLayerCtx(_this.getKlCanvas().getLayerContext(layerIndex));\r\n        let brushes: any = {};\r\n        for (let b in KL.brushes) {\r\n            if (KL.brushes.hasOwnProperty(b)) {\r\n                brushes[b] = new KL.brushes[b]();\r\n                brushes[b].setContext(_this.getCurrentLayerCtx());\r\n            }\r\n        }\r\n        brushes.sketchy.setSeed(_this.getInitState().brushes.sketchy.getSeed());\r\n        for (let i = 0; i < actions.length; i++) {\r\n            (function (i) {\r\n                if (actions[i].tool[0] === \"brush\") {\r\n                    let b = brushes[actions[i].tool[1]];\r\n                    if (actions[i].actions) {\r\n                        for (let e = 0; e < actions[i].actions.length; e++) {\r\n                            let p = actions[i].actions[e].params;\r\n                            b[actions[i].actions[e].action].apply(b, p);\r\n                        }\r\n                    } else {\r\n                        let p = actions[i].params;\r\n                        b[actions[i].action].apply(b, p);\r\n                    }\r\n                } else if (actions[i].tool[0] === \"canvas\") {\r\n                    let p = actions[i].params;\r\n                    let id = _this.getKlCanvas()[actions[i].action].apply(_this.getKlCanvas(), p);\r\n                    if (typeof id === typeof 123) {\r\n                        layerIndex = id;\r\n                        _this.setCurrentLayerCtx(_this.getKlCanvas().getLayerContext(layerIndex));\r\n                        for (let b in brushes) {\r\n                            if (brushes.hasOwnProperty(b)) {\r\n                                brushes[b].setContext(_this.getCurrentLayerCtx());\r\n                            }\r\n                        }\r\n                    }\r\n                } else if (actions[i].tool[0] === \"filter\") {\r\n                    let p = [{\r\n                        context: _this.getCurrentLayerCtx(),\r\n                        canvas: _this.getKlCanvas(),\r\n                        input: actions[i].params[0].input,\r\n                        history: {\r\n                            add: function () {\r\n                            }, pause: function () {\r\n                            }\r\n                        }\r\n                    }];\r\n                    KL.filterLib[actions[i].tool[1]][actions[i].action].apply(null, p);\r\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"focusLayer\") {\r\n                    layerIndex = actions[i].params[0];\r\n                    _this.setCurrentLayerCtx(_this.getKlCanvas().getLayerContext(actions[i].params[0]));\r\n                    for (let b in brushes) {\r\n                        if (brushes.hasOwnProperty(b)) {\r\n                            brushes[b].setContext(_this.getCurrentLayerCtx());\r\n                        }\r\n                    }\r\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"importImage\") {\r\n                    let id = _this.getKlCanvas().addLayer();\r\n                    if (typeof id === typeof 123) {\r\n                        layerIndex = id;\r\n                        if (actions[i].params[1]) {\r\n                            _this.getKlCanvas().renameLayer(layerIndex, actions[i].params[1]);\r\n                        }\r\n                        _this.setCurrentLayerCtx(_this.getKlCanvas().getLayerContext(layerIndex));\r\n                        for (let b in brushes) {\r\n                            if (brushes.hasOwnProperty(b)) {\r\n                                brushes[b].setContext(_this.getCurrentLayerCtx());\r\n                            }\r\n                        }\r\n                    }\r\n                    _this.getCurrentLayerCtx().drawImage(actions[i].params[0], 0, 0);\r\n                }\r\n            })(i);\r\n        }\r\n        if (oldSize.w !== _this.getKlCanvas().getWidth() || oldSize.h !== _this.getKlCanvas().getHeight()) {\r\n            _this.klCanvasWorkspace.resetView();\r\n            _this.handUi.update(_this.klCanvasWorkspace.getScale(), _this.klCanvasWorkspace.getAngleDeg());\r\n        }\r\n        _this.layerManager.update(layerIndex);\r\n        _this.layerPreview.setLayer(_this.getKlCanvas().getLayer(layerIndex));\r\n        _this.brushUiObj.sketchy.setSeed(brushes.sketchy.getSeed());\r\n        _this.getCurrentBrush().setContext(_this.getCurrentLayerCtx());\r\n        _this.klCanvasWorkspace.setLastDrawEvent(null);\r\n\r\n        klHistory.pause(false);\r\n        return true;\r\n    }\r\n\r\n    redo(): boolean {\r\n        const _this = this;\r\n        if (!this.ignoreTest()) {\r\n            return false;\r\n        }\r\n\r\n        if (!klHistory.canRedo()) { // || workspace.isPainting()) {\r\n            return false;\r\n        }\r\n        let actions = klHistory.redo();\r\n        klHistory.pause();\r\n        let oldSize = {w: _this.getKlCanvas().getWidth(), h: _this.getKlCanvas().getHeight()};\r\n        let layerIndex;\r\n        let brushes: any = {};\r\n        for (let b in KL.brushes) {\r\n            if (KL.brushes.hasOwnProperty(b)) {\r\n                brushes[b] = new KL.brushes[b]();\r\n                brushes[b].setContext(_this.getCurrentLayerCtx());\r\n            }\r\n        }\r\n        brushes.sketchy.setSeed(_this.brushUiObj.sketchy.getSeed());\r\n        for (let i = 0; i < actions.length; i++) {\r\n            (function (i) {\r\n                if (actions[i].tool[0] === \"brush\") {\r\n                    let b = brushes[actions[i].tool[1]];\r\n                    if (actions[i].actions) {\r\n                        for (let e = 0; e < actions[i].actions.length; e++) {\r\n                            let p = actions[i].actions[e].params;\r\n                            b[actions[i].actions[e].action].apply(b, p);\r\n                        }\r\n                    } else {\r\n                        let p = actions[i].params;\r\n                        b[actions[i].action].apply(b, p);\r\n                    }\r\n                } else if (actions[i].tool[0] === \"canvas\") {\r\n                    let p = actions[i].params;\r\n                    let id = _this.getKlCanvas()[actions[i].action].apply(_this.getKlCanvas(), p);\r\n                    if (typeof id === typeof 123) {\r\n                        layerIndex = id;\r\n                        _this.setCurrentLayerCtx(_this.getKlCanvas().getLayerContext(layerIndex));\r\n                        for (let b in brushes) {\r\n                            if (brushes.hasOwnProperty(b)) {\r\n                                brushes[b].setContext(_this.getCurrentLayerCtx());\r\n                            }\r\n                        }\r\n                    }\r\n                } else if (actions[i].tool[0] === \"filter\") {\r\n                    let p = [{\r\n                        context: _this.getCurrentLayerCtx(),\r\n                        canvas: _this.getKlCanvas(),\r\n                        input: actions[i].params[0].input,\r\n                        history: {\r\n                            add: function () {\r\n                            }, pause: function () {\r\n                            }\r\n                        }\r\n                    }];\r\n                    KL.filterLib[actions[i].tool[1]][actions[i].action].apply(null, p);\r\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"focusLayer\") {\r\n                    layerIndex = actions[i].params[0];\r\n                    _this.setCurrentLayerCtx(_this.getKlCanvas().getLayerContext(actions[i].params[0]));\r\n                    for (let b in brushes) {\r\n                        if (brushes.hasOwnProperty(b)) {\r\n                            brushes[b].setContext(_this.getCurrentLayerCtx());\r\n                        }\r\n                    }\r\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"importImage\") {\r\n                    let id = _this.getKlCanvas().addLayer();\r\n                    if (typeof id === typeof 123) {\r\n                        layerIndex = id;\r\n                        if (actions[i].params[1]) {\r\n                            _this.getKlCanvas().renameLayer(layerIndex, actions[i].params[1]);\r\n                        }\r\n                        _this.setCurrentLayerCtx(_this.getKlCanvas().getLayerContext(layerIndex));\r\n                        for (let b in brushes) {\r\n                            if (brushes.hasOwnProperty(b)) {\r\n                                brushes[b].setContext(_this.getCurrentLayerCtx());\r\n                            }\r\n                        }\r\n                    }\r\n                    _this.getCurrentLayerCtx().drawImage(actions[i].params[0], 0, 0);\r\n                }\r\n            })(i);\r\n        }\r\n\r\n        if (oldSize.w !== _this.getKlCanvas().getWidth() || oldSize.h !== _this.getKlCanvas().getHeight()) {\r\n            _this.klCanvasWorkspace.resetView();\r\n            _this.handUi.update(_this.klCanvasWorkspace.getScale(), _this.klCanvasWorkspace.getAngleDeg());\r\n        }\r\n        let currentLayerIndex = _this.getKlCanvas().getLayerIndex(_this.getCurrentLayerCtx().canvas);\r\n        _this.layerManager.update(currentLayerIndex);\r\n        _this.layerPreview.setLayer(_this.getKlCanvas().getLayer(currentLayerIndex));\r\n        _this.brushUiObj.sketchy.setSeed(brushes.sketchy.getSeed());\r\n        _this.getCurrentBrush().setContext(_this.getCurrentLayerCtx());\r\n        _this.klCanvasWorkspace.setLastDrawEvent(null);\r\n        klHistory.pause(false);\r\n\r\n        return true;\r\n    }\r\n\r\n    catchup (logParam) {\r\n        const _this = this;\r\n        // const start = performance.now();\r\n        //play catch up (the version that is a few steps behind)\r\n        if (logParam && logParam.bufferUpdate) {\r\n            let brushes = _this.getInitState().brushes;\r\n            let actions = [logParam.bufferUpdate];\r\n            let localCurrentLayerCtx = _this.getInitState().canvas.getLayerContext(_this.getInitState().focus);\r\n            let canvas = _this.getInitState().canvas;\r\n            let layerIndex = _this.getInitState().focus;\r\n            (function (i) {\r\n                if (actions[i].tool[0] === \"brush\") {\r\n                    let b = brushes[actions[i].tool[1]];\r\n                    if (actions[i].actions) {\r\n                        for (let e = 0; e < actions[i].actions.length; e++) {\r\n                            let p = actions[i].actions[e].params;\r\n                            b[actions[i].actions[e].action].apply(b, p);\r\n                        }\r\n                    } else {\r\n                        let p = actions[i].params;\r\n                        b[actions[i].action].apply(b, p);\r\n                    }\r\n                } else if (actions[i].tool[0] === \"canvas\") {\r\n                    let p = actions[i].params;\r\n                    let id = canvas[actions[i].action].apply(canvas, p);\r\n                    if (typeof id === typeof 123) {\r\n                        layerIndex = id;\r\n                        localCurrentLayerCtx = canvas.getLayerContext(layerIndex);\r\n                        for (let b in brushes) {\r\n                            if (brushes.hasOwnProperty(b)) {\r\n                                brushes[b].setContext(localCurrentLayerCtx);\r\n                            }\r\n                        }\r\n                    }\r\n                } else if (actions[i].tool[0] === \"filter\") {\r\n                    let p = [{\r\n                        context: localCurrentLayerCtx,\r\n                        canvas: canvas,\r\n                        input: actions[i].params[0].input,\r\n                        history: {\r\n                            add: function () {\r\n                            }, pause: function () {\r\n                            }\r\n                        }\r\n                    }];\r\n                    KL.filterLib[actions[i].tool[1]][actions[i].action].apply(null, p);\r\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"focusLayer\") {\r\n                    layerIndex = actions[i].params[0];\r\n                    localCurrentLayerCtx = canvas.getLayerContext(actions[i].params[0]);\r\n                    for (let b in brushes) {\r\n                        if (brushes.hasOwnProperty(b)) {\r\n                            brushes[b].setContext(localCurrentLayerCtx);\r\n                        }\r\n                    }\r\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"importImage\") {\r\n                    let id = canvas.addLayer();\r\n                    if (typeof id === typeof 123) {\r\n                        layerIndex = id;\r\n                        if (actions[i].params[1]) {\r\n                            _this.getKlCanvas().renameLayer(layerIndex, actions[i].params[1]);\r\n                        }\r\n                        localCurrentLayerCtx = canvas.getLayerContext(layerIndex);\r\n                        for (let b in brushes) {\r\n                            if (brushes.hasOwnProperty(b)) {\r\n                                brushes[b].setContext(localCurrentLayerCtx);\r\n                            }\r\n                        }\r\n                    }\r\n                    localCurrentLayerCtx.drawImage(actions[i].params[0], 0, 0);\r\n                }\r\n            })(0);\r\n            _this.getInitState().focus = layerIndex;\r\n        }\r\n        // console.log('catchup', performance.now() - start);\r\n    }\r\n\r\n\r\n}","/**\r\n * Topmost row of buttons in toolspace\r\n *\r\n * p = { // button click callbacks\r\n *     onSubmit: function(),\r\n *     onLeftRight: function(),\r\n *     onHelp: function()\r\n * }\r\n *\r\n * @param p\r\n * @constructor\r\n */\r\nimport {BB} from \"../bb/bb\";\r\n// @ts-ignore\r\nimport uiSwapImg from 'url:~/src/app/img/ui/ui-swap-lr.svg';\r\n// @ts-ignore\r\nimport helpImg from 'url:~/src/app/img/ui/help.svg';\r\n\r\nexport class ToolspaceTopRow {\r\n    el: HTMLDivElement;\r\n\r\n    constructor(p: {onSubmit: () => void, onLeftRight: () => void, onHelp: () => void}) {\r\n        let div = document.createElement('div');\r\n        this.el = div;\r\n        BB.css(div, {\r\n            height: '36px',\r\n            //background: '#f00',\r\n            display: 'flex',\r\n            backgroundImage: 'linear-gradient(to top, rgba(255, 255, 255, 0) 20%, rgba(255, 255, 255, 0.6) 100%)'\r\n        });\r\n\r\n        function createButton(p) {\r\n            let padding = 6 + (p.extraPadding ? p.extraPadding : 0);\r\n            let result = BB.el({\r\n                className: 'toolspace-row-button nohighlight',\r\n                title: p.title,\r\n                onClick: p.onClick,\r\n                css: {\r\n                    padding: p.content ? '' : (p.contain ? padding + 'px 0' : ''),\r\n                }\r\n            });\r\n            if (p.content) {\r\n                result.appendChild(p.content);\r\n            } else {\r\n                let im = BB.el({\r\n                    css: {\r\n                        backgroundImage: 'url(\\'' + p.image + '\\')',\r\n                        backgroundRepeat: 'no-repeat',\r\n                        backgroundPosition: 'center',\r\n                        backgroundSize: p.contain ? 'contain' : '',\r\n                        //filter: 'grayscale(1)',\r\n                        height: '100%'\r\n                    }\r\n                });\r\n                im.style.pointerEvents = 'none';\r\n                result.appendChild(im);\r\n            }\r\n            (result as any).pointerListener = new BB.PointerListener({ // because :hover causes problems w touch\r\n                target: result,\r\n                onEnterLeave: function(isOver) {\r\n                    if(isOver) {\r\n                        BB.addClassName(result, 'toolspace-row-button-hover');\r\n                    } else {\r\n                        BB.removeClassName(result, 'toolspace-row-button-hover');\r\n                    }\r\n                }\r\n            });\r\n            return result;\r\n        }\r\n\r\n        let submitButton = createButton({\r\n            onClick: p.onSubmit,\r\n            title: 'Submit drawing',\r\n            content: BB.el({\r\n                content: 'Submit',\r\n                className: 'toolspace-row-button__submit',\r\n                css: {\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    width: '100%',\r\n                    height: '100%'\r\n                }\r\n            }),\r\n            contain: true\r\n        });\r\n        submitButton.style.width = '45px';\r\n\r\n        let helpButton = createButton({\r\n            onClick: p.onHelp,\r\n            title: 'Help',\r\n            image: helpImg,\r\n            contain: true\r\n        });\r\n\r\n        let leftRightButton = createButton({\r\n            onClick: p.onLeftRight,\r\n            title: 'Switch left/right UI',\r\n            image: uiSwapImg,\r\n            contain: true\r\n        });\r\n        let fullButton = createButton({\r\n            onClick: function() {\r\n                parent.postMessage({type: 'toggleFull'}, '*');\r\n                fullButton.style.display = 'none';\r\n                minimizeButton.style.display = '';\r\n            },\r\n            title: 'Toggle Full Page',\r\n            image: '__version__/img/ui/ui-fullscreen.svg',\r\n            contain: true\r\n        });\r\n        let minimizeButton = createButton({\r\n            onClick: function() {\r\n                parent.postMessage({type: 'toggleFull'}, '*');\r\n                fullButton.style.display = '';\r\n                minimizeButton.style.display = 'none';\r\n            },\r\n            title: 'Toggle Full Page',\r\n            image: '__version__/img/ui/ui-minimize.svg',\r\n            contain: true\r\n        });\r\n        minimizeButton.style.display = 'none';\r\n\r\n\r\n        div.appendChild(submitButton);\r\n        div.appendChild(leftRightButton);\r\n        // div.appendChild(fullButton);\r\n        // div.appendChild(minimizeButton);\r\n        div.appendChild(helpButton);\r\n    }\r\n\r\n    getElement() {\r\n        return this.el;\r\n    }\r\n}\r\n","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"4FMUg\");","import {filterLib, filterLibStatus} from './filters';\r\nimport {glBrightnessContrast} from './gl-brightness-contrast';\r\nimport {cropExtend} from './crop-extend';\r\nimport {glCurves} from './gl-curves';\r\nimport {flip} from './flip';\r\nimport {glHueSaturation} from './gl-hue-saturation';\r\nimport {invert} from './invert';\r\nimport {glPerspective} from './gl-perspective';\r\nimport {resize} from './resize';\r\nimport {rotate} from './rotate';\r\nimport {glTiltShift} from './gl-tilt-shift';\r\nimport {transform} from './transform';\r\nimport {glBlur} from './gl-blur';\r\nimport {glUnsharpMask} from './gl-unsharp-mask';\r\nimport {toAlpha} from './to-alpha';\r\n\r\nlet embed: boolean;\r\nfunction importFilter(libObj, moduleObj): void {\r\n    if (moduleObj.getDialog) {\r\n        libObj.getDialog = moduleObj.getDialog;\r\n    }\r\n    libObj.apply = moduleObj.apply;\r\n}\r\n\r\n\r\nexport function importFilters(isEmbed?: boolean) {\r\n    if (filterLibStatus.isLoaded) {\r\n        return;\r\n    }\r\n    embed = isEmbed\r\n\r\n    importFilter(filterLib.glBrightnessContrast, glBrightnessContrast);\r\n    importFilter(filterLib.cropExtend, cropExtend);\r\n    importFilter(filterLib.glCurves, glCurves);\r\n    importFilter(filterLib.flip, flip);\r\n    importFilter(filterLib.glHueSaturation, glHueSaturation);\r\n    importFilter(filterLib.invert, invert);\r\n    importFilter(filterLib.glPerspective, glPerspective);\r\n    importFilter(filterLib.resize, resize);\r\n    importFilter(filterLib.rotate, rotate);\r\n    importFilter(filterLib.glTiltShift, glTiltShift);\r\n    importFilter(filterLib.transform, transform);\r\n    importFilter(filterLib.glBlur, glBlur);\r\n    importFilter(filterLib.glUnsharpMask, glUnsharpMask);\r\n    importFilter(filterLib.toAlpha, toAlpha);\r\n\r\n    filterLibStatus.isLoaded = true;\r\n}","import {BB} from '../../bb/bb';\r\nimport {PcSlider} from '../ui/base-components/slider';\r\nimport {eventResMs} from './filters-consts';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {getSharedFx} from './shared-gl-fx';\r\n\r\nexport const glBrightnessContrast = {\r\n    getDialog(params) {\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n\r\n\r\n        let context = params.context; //2d context of canvas\r\n        let canvas = params.canvas; //the klCanvas and dom element\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\r\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (tempCanvas.width > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n\r\n\r\n        function finishInit() {\r\n\r\n            let brightness = 0, contrast = 0;\r\n            div.innerHTML = \"Change brightness and contrast for the selected layer.<br/><br/>\";\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n\r\n            let brightnessSlider = new PcSlider({\r\n                label: 'Brightness',\r\n                width: 300,\r\n                height: 30,\r\n                min: 0,\r\n                max: 100,\r\n                initValue: (brightness + 1) * 50,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    brightness = val / 50 - 1;\r\n                    glCanvas.draw(texture).brightnessContrast(brightness, contrast).update();\r\n                    klCanvasPreview.render();\r\n                }\r\n            });\r\n            let contrastSlider = new PcSlider({\r\n                label: 'Contrast',\r\n                width: 300,\r\n                height: 30,\r\n                min: 0,\r\n                max: 100,\r\n                initValue: (contrast + 1) * 50,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    contrast = val / 50 - 1;\r\n                    glCanvas.draw(texture).brightnessContrast(brightness, contrast).update();\r\n                    klCanvasPreview.render();\r\n                }\r\n            });\r\n            brightnessSlider.getElement().style.marginBottom = \"10px\";\r\n            div.appendChild(brightnessSlider.getElement());\r\n            div.appendChild(contrastSlider.getElement());\r\n\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            BB.css(previewWrapper, {\r\n                width: \"340px\",\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr = [];\r\n            {\r\n                for(let i = 0; i < layers.length; i++) {\r\n                    previewLayerArr.push({\r\n                        canvas: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            let klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + w),\r\n                height: parseInt('' + h),\r\n                layerArr: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + w) + 'px',\r\n                    height: parseInt('' + h) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n            div.appendChild(previewWrapper);\r\n\r\n            try {\r\n                glCanvas.draw(texture).brightnessContrast(brightness, contrast).update();\r\n                klCanvasPreview.render();\r\n            } catch(e) {\r\n                (div as any).errorCallback(e);\r\n            }\r\n\r\n            result.destroy = () => {\r\n                brightnessSlider.destroy();\r\n                contrastSlider.destroy();\r\n                texture.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    brightness: brightness,\r\n                    contrast: contrast\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1); // the canvas isn't ready for some reason\r\n\r\n        return result;\r\n    },\r\n\r\n    apply(params) {\r\n        let context = params.context;\r\n        let brightness = params.input.brightness;\r\n        let contrast = params.input.contrast;\r\n        let history = params.history;\r\n        if (!context || brightness === null || contrast === null || !history)\r\n            return false;\r\n        history.pause();\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).brightnessContrast(brightness, contrast).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"filter\", \"glBrightnessContrast\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n\r\n        return true;\r\n    }\r\n}","\r\nexport const eventResMs = 60;","import {fx} from '../../../script-vendor/glfx';\r\n\r\nlet fxCanvas = null\r\ntry {\r\n    fxCanvas = fx.canvas();\r\n} catch (e) {\r\n}\r\n\r\nexport function getSharedFx() {\r\n    if (!fxCanvas || fxCanvas._.gl.isContextLost()) {\r\n        try {\r\n            fxCanvas = fx.canvas();\r\n        } catch (e) {\r\n        }\r\n    }\r\n    return fxCanvas;\r\n}","/*\r\n * glfx.script\r\n * http://evanw.github.com/glfx.js/\r\n *\r\n * Copyright 2011 Evan Wallace\r\n * Released under the MIT license\r\n *\r\n * modifications by bitbof\r\n */\r\nexport const fx = (function() {\r\nlet exports: any = {};\r\n\r\n// src/OES_texture_float_linear-polyfill.script\r\n// From: https://github.com/evanw/OES_texture_float_linear-polyfill\r\n(function() {\r\n  // Uploads a 2x2 floating-point texture where one pixel is 2 and the other\r\n  // three pixels are 0. Linear filtering is only supported if a sample taken\r\n  // from the center of that texture is (2 + 0 + 0 + 0) / 4 = 0.5.\r\n  function supportsOESTextureFloatLinear(gl) {\r\n    // Need floating point textures in the first place\r\n    if (!gl.getExtension('OES_texture_float')) {\r\n      return false;\r\n    }\r\n\r\n    // Create a render target\r\n    let framebuffer = gl.createFramebuffer();\r\n    let byteTexture = gl.createTexture();\r\n    gl.bindTexture(gl.TEXTURE_2D, byteTexture);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n    gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\r\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, byteTexture, 0);\r\n\r\n    // Create a simple floating-point texture with value of 0.5 in the center\r\n    let rgba = [\r\n      2, 0, 0, 0,\r\n      0, 0, 0, 0,\r\n      0, 0, 0, 0,\r\n      0, 0, 0, 0\r\n    ];\r\n    let floatTexture = gl.createTexture();\r\n    gl.bindTexture(gl.TEXTURE_2D, floatTexture);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 2, 2, 0, gl.RGBA, gl.FLOAT, new Float32Array(rgba));\r\n\r\n    // Create the test shader\r\n    let program = gl.createProgram();\r\n    let vertexShader = gl.createShader(gl.VERTEX_SHADER);\r\n    let fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n    gl.shaderSource(vertexShader, '\\\r\n      attribute vec2 vertex;\\\r\n      void main() {\\\r\n        gl_Position = vec4(vertex, 0.0, 1.0);\\\r\n      }\\\r\n    ');\r\n    gl.shaderSource(fragmentShader, '\\\r\n      uniform sampler2D texture;\\\r\n      void main() {\\\r\n        gl_FragColor = texture2D(texture, vec2(0.5));\\\r\n      }\\\r\n    ');\r\n    gl.compileShader(vertexShader);\r\n    gl.compileShader(fragmentShader);\r\n    gl.attachShader(program, vertexShader);\r\n    gl.attachShader(program, fragmentShader);\r\n    gl.linkProgram(program);\r\n\r\n    // Create a buffer containing a single point\r\n    let buffer = gl.createBuffer();\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\r\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([0, 0]), gl.STREAM_DRAW);\r\n    gl.enableVertexAttribArray(0);\r\n    gl.vertexAttribPointer(0, 2, gl.FLOAT, false, 0, 0);\r\n\r\n    // Render the point and read back the rendered pixel\r\n    let pixel = new Uint8Array(4);\r\n    gl.useProgram(program);\r\n    gl.viewport(0, 0, 1, 1);\r\n    gl.bindTexture(gl.TEXTURE_2D, floatTexture);\r\n    gl.drawArrays(gl.POINTS, 0, 1);\r\n    gl.readPixels(0, 0, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, pixel);\r\n\r\n    // The center sample will only have a value of 0.5 if linear filtering works\r\n    return pixel[0] === 127 || pixel[0] === 128;\r\n  }\r\n\r\n  // The constructor for the returned extension object\r\n  function OESTextureFloatLinear() {\r\n  }\r\n\r\n  // Cache the extension so it's specific to each context like extensions should be\r\n  function getOESTextureFloatLinear(gl) {\r\n    if (gl.$OES_texture_float_linear$ === void 0) {\r\n      Object.defineProperty(gl, '$OES_texture_float_linear$', {\r\n        enumerable: false,\r\n        configurable: false,\r\n        writable: false,\r\n        value: new OESTextureFloatLinear()\r\n      });\r\n    }\r\n    return gl.$OES_texture_float_linear$;\r\n  }\r\n\r\n  // This replaces the real getExtension()\r\n  function getExtension(name) {\r\n    return name === 'OES_texture_float_linear'\r\n      ? getOESTextureFloatLinear(this)\r\n      : oldGetExtension.call(this, name);\r\n  }\r\n\r\n  // This replaces the real getSupportedExtensions()\r\n  function getSupportedExtensions() {\r\n    let extensions = oldGetSupportedExtensions.call(this);\r\n    if (extensions.indexOf('OES_texture_float_linear') === -1) {\r\n      extensions.push('OES_texture_float_linear');\r\n    }\r\n    return extensions;\r\n  }\r\n\r\n  // Get a WebGL context\r\n  try {\r\n    let gl = document.createElement('canvas').getContext('experimental-webgl');\r\n  } catch (e) {\r\n  }\r\n\r\n  // Don't install the polyfill if the browser already supports it or doesn't have WebGL\r\n  if (!gl || (gl as any).getSupportedExtensions().indexOf('OES_texture_float_linear') !== -1) {\r\n    return;\r\n  }\r\n\r\n  // Install the polyfill if linear filtering works with floating-point textures\r\n  let oldGetExtension;\r\n  let oldGetSupportedExtensions;\r\n  if (supportsOESTextureFloatLinear(gl)) {\r\n    oldGetExtension = WebGLRenderingContext.prototype.getExtension;\r\n    oldGetSupportedExtensions = WebGLRenderingContext.prototype.getSupportedExtensions;\r\n    WebGLRenderingContext.prototype.getExtension = getExtension;\r\n    WebGLRenderingContext.prototype.getSupportedExtensions = getSupportedExtensions;\r\n  }\r\n}());\r\n\r\n// src/core\\canvas.script\r\nvar gl;\r\n\r\nfunction clamp(lo, value, hi) {\r\n    return Math.max(lo, Math.min(value, hi));\r\n}\r\n\r\nfunction wrapTexture(texture) {\r\n    return {\r\n        _: texture,\r\n        loadContentsOf: function(element) {\r\n            // Make sure that we're using the correct global WebGL context\r\n            gl = this._.gl;\r\n            this._.loadContentsOf(element);\r\n        },\r\n        destroy: function() {\r\n            // Make sure that we're using the correct global WebGL context\r\n            gl = this._.gl;\r\n            this._.destroy();\r\n        }\r\n    };\r\n}\r\n\r\nfunction texture(element) {\r\n    return wrapTexture(Texture.fromElement(element));\r\n}\r\n\r\nfunction initialize(width, height) {\r\n    let type = gl.UNSIGNED_BYTE;\r\n\r\n    // Go for floating point buffer textures if we can, it'll make the bokeh\r\n    // filter look a lot better. Note that on Windows, ANGLE does not let you\r\n    // render to a floating-point texture when linear filtering is enabled.\r\n    // See http://crbug.com/172278 for more information.\r\n    if (gl.getExtension('OES_texture_float') && gl.getExtension('OES_texture_float_linear')) {\r\n        let testTexture = new Texture(100, 100, gl.RGBA, gl.FLOAT);\r\n        try {\r\n            // Only use gl.FLOAT if we can render to it\r\n            testTexture.drawTo(function() { type = gl.FLOAT; });\r\n        } catch (e) {\r\n        }\r\n        testTexture.destroy();\r\n    }\r\n\r\n    if (this._.texture) this._.texture.destroy();\r\n    if (this._.spareTexture) this._.spareTexture.destroy();\r\n    this.width = width;\r\n    this.height = height;\r\n    this._.texture = new Texture(width, height, gl.RGBA, type);\r\n    this._.spareTexture = new Texture(width, height, gl.RGBA, type);\r\n    this._.extraTexture = this._.extraTexture || new Texture(0, 0, gl.RGBA, type);\r\n    this._.flippedShader = this._.flippedShader || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            gl_FragColor = texture2D(texture, vec2(texCoord.x, 1.0 - texCoord.y));\\\r\n        }\\\r\n    ', 'flippedShader');\r\n    this._.isInitialized = true;\r\n}\r\n\r\n/*\r\n   Draw a texture to the canvas, with an optional width and height to scale to.\r\n   If no width and height are given then the original texture width and height\r\n   are used.\r\n*/\r\nfunction draw(texture, width, height) {\r\n    if (!this._.isInitialized || texture._.width != this.width || texture._.height != this.height) {\r\n        initialize.call(this, width ? width : texture._.width, height ? height : texture._.height);\r\n    }\r\n\r\n    texture._.use();\r\n    this._.texture.drawTo(function() {\r\n        Shader.getDefaultShader().drawRect();\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\nfunction update() {\r\n    this._.texture.use();\r\n    this._.flippedShader.drawRect();\r\n    return this;\r\n}\r\n\r\nfunction simpleShader(shader, uniforms, textureIn, textureOut) {\r\n    (textureIn || this._.texture).use();\r\n    this._.spareTexture.drawTo(function() {\r\n        shader.uniforms(uniforms).drawRect();\r\n    });\r\n    this._.spareTexture.swapWith(textureOut || this._.texture);\r\n}\r\n\r\nfunction replace(node) {\r\n    node.parentNode.insertBefore(this, node);\r\n    node.parentNode.removeChild(node);\r\n    return this;\r\n}\r\n\r\nfunction contents() {\r\n    let texture = new Texture(this._.texture.width, this._.texture.height, gl.RGBA, gl.UNSIGNED_BYTE);\r\n    this._.texture.use();\r\n    texture.drawTo(function() {\r\n        Shader.getDefaultShader().drawRect();\r\n    });\r\n    return wrapTexture(texture);\r\n}\r\n\r\n/*\r\n   Get a Uint8 array of pixel values: [r, g, b, a, r, g, b, a, ...]\r\n   Length of the array will be width * height * 4.\r\n*/\r\nfunction getPixelArray() {\r\n    let w = this._.texture.width;\r\n    let h = this._.texture.height;\r\n    let array = new Uint8Array(w * h * 4);\r\n    this._.texture.drawTo(function() {\r\n        gl.readPixels(0, 0, w, h, gl.RGBA, gl.UNSIGNED_BYTE, array);\r\n    });\r\n    return array;\r\n}\r\n\r\nfunction wrap(func) {\r\n    return function() {\r\n        // Make sure that we're using the correct global WebGL context\r\n        gl = this._.gl;\r\n\r\n        // Now that the context has been switched, we can call the wrapped function\r\n        return func.apply(this, arguments);\r\n    };\r\n}\r\n\r\nexports.canvas = function() {\r\n    let canvas: any = document.createElement('canvas');\r\n    try {\r\n        gl = canvas.getContext('experimental-webgl', { premultipliedAlpha: false });\r\n    } catch (e) {\r\n        gl = null;\r\n    }\r\n    if (!gl) {\r\n        throw 'This browser does not support WebGL';\r\n    }\r\n    canvas._ = {\r\n        gl: gl,\r\n        isInitialized: false,\r\n        texture: null,\r\n        spareTexture: null,\r\n        flippedShader: null\r\n    };\r\n\r\n    // Core methods\r\n    canvas.texture = wrap(texture);\r\n    canvas.draw = wrap(draw);\r\n    canvas.update = wrap(update);\r\n    canvas.replace = wrap(replace);\r\n    canvas.contents = wrap(contents);\r\n    canvas.getPixelArray = wrap(getPixelArray);\r\n\r\n    // Filter methods\r\n    canvas.brightnessContrast = wrap(brightnessContrast);\r\n    canvas.hexagonalPixelate = wrap(hexagonalPixelate);\r\n    canvas.hueSaturation = wrap(hueSaturation);\r\n    canvas.colorHalftone = wrap(colorHalftone);\r\n    canvas.triangleBlur = wrap(triangleBlur);\r\n    canvas.unsharpMask = wrap(unsharpMask);\r\n    canvas.perspective = wrap(perspective);\r\n    canvas.matrixWarp = wrap(matrixWarp);\r\n    canvas.bulgePinch = wrap(bulgePinch);\r\n    canvas.tiltShift = wrap(tiltShift);\r\n    canvas.dotScreen = wrap(dotScreen);\r\n    canvas.edgeWork = wrap(edgeWork);\r\n    canvas.lensBlur = wrap(lensBlur);\r\n    canvas.zoomBlur = wrap(zoomBlur);\r\n    canvas.noise = wrap(noise);\r\n    canvas.denoise = wrap(denoise);\r\n    canvas.curves = wrap(curves);\r\n    canvas.swirl = wrap(swirl);\r\n    canvas.ink = wrap(ink);\r\n    canvas.vignette = wrap(vignette);\r\n    canvas.vibrance = wrap(vibrance);\r\n    canvas.sepia = wrap(sepia);\r\n    canvas.invert = wrap(invert);\r\n    canvas.toAlpha = wrap(toAlpha);\r\n\r\n    return canvas;\r\n};\r\nexports.splineInterpolate = splineInterpolate;\r\n\r\n// src/core\\matrix.script\r\n// from javax.media.jai.PerspectiveTransform\r\n\r\nfunction getSquareToQuad(x0, y0, x1, y1, x2, y2, x3, y3) {\r\n    let dx1 = x1 - x2;\r\n    let dy1 = y1 - y2;\r\n    let dx2 = x3 - x2;\r\n    let dy2 = y3 - y2;\r\n    let dx3 = x0 - x1 + x2 - x3;\r\n    let dy3 = y0 - y1 + y2 - y3;\r\n    let det = dx1*dy2 - dx2*dy1;\r\n    let a = (dx3*dy2 - dx2*dy3) / det;\r\n    let b = (dx1*dy3 - dx3*dy1) / det;\r\n    return [\r\n        x1 - x0 + a*x1, y1 - y0 + a*y1, a,\r\n        x3 - x0 + b*x3, y3 - y0 + b*y3, b,\r\n        x0, y0, 1\r\n    ];\r\n}\r\n\r\nfunction getInverse(m) {\r\n    let a = m[0], b = m[1], c = m[2];\r\n    let d = m[3], e = m[4], f = m[5];\r\n    let g = m[6], h = m[7], i = m[8];\r\n    let det = a*e*i - a*f*h - b*d*i + b*f*g + c*d*h - c*e*g;\r\n    return [\r\n        (e*i - f*h) / det, (c*h - b*i) / det, (b*f - c*e) / det,\r\n        (f*g - d*i) / det, (a*i - c*g) / det, (c*d - a*f) / det,\r\n        (d*h - e*g) / det, (b*g - a*h) / det, (a*e - b*d) / det\r\n    ];\r\n}\r\n\r\nfunction multiply(a, b) {\r\n    return [\r\n        a[0]*b[0] + a[1]*b[3] + a[2]*b[6],\r\n        a[0]*b[1] + a[1]*b[4] + a[2]*b[7],\r\n        a[0]*b[2] + a[1]*b[5] + a[2]*b[8],\r\n        a[3]*b[0] + a[4]*b[3] + a[5]*b[6],\r\n        a[3]*b[1] + a[4]*b[4] + a[5]*b[7],\r\n        a[3]*b[2] + a[4]*b[5] + a[5]*b[8],\r\n        a[6]*b[0] + a[7]*b[3] + a[8]*b[6],\r\n        a[6]*b[1] + a[7]*b[4] + a[8]*b[7],\r\n        a[6]*b[2] + a[7]*b[5] + a[8]*b[8]\r\n    ];\r\n}\r\n\r\n// src/core\\shader.script\r\nvar Shader = (function() {\r\n    function isArray(obj) {\r\n        return Object.prototype.toString.call(obj) == '[object Array]';\r\n    }\r\n\r\n    function isNumber(obj) {\r\n        return Object.prototype.toString.call(obj) == '[object Number]';\r\n    }\r\n\r\n    function compileSource(type, source, nameStr) {\r\n        let shader = gl.createShader(type);\r\n        gl.shaderSource(shader, source);\r\n        gl.compileShader(shader);\r\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n            throw 'compile error: ' + nameStr + ' - ' + gl.getShaderInfoLog(shader);\r\n        }\r\n        return shader;\r\n    }\r\n\r\n    let defaultVertexSource = '\\\r\n    attribute vec2 vertex;\\\r\n    attribute vec2 _texCoord;\\\r\n    varying vec2 texCoord;\\\r\n    void main() {\\\r\n        texCoord = _texCoord;\\\r\n        gl_Position = vec4(vertex * 2.0 - 1.0, 0.0, 1.0);\\\r\n    }';\r\n\r\n    let defaultFragmentSource = '\\\r\n    uniform sampler2D texture;\\\r\n    varying vec2 texCoord;\\\r\n    void main() {\\\r\n        gl_FragColor = texture2D(texture, texCoord);\\\r\n    }';\r\n\r\n    // added test 2020-04-27 bitbof\r\n    let floatPrecision = null;\r\n    function testPrecisionSupport(precisionType) {\r\n        let format = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, precisionType);\r\n        return format !== null && format.precision !== 0;\r\n    }\r\n\r\n    function Shader(vertexSource?, fragmentSource?, nameStr?) {\r\n        this.vertexAttribute = null;\r\n        this.texCoordAttribute = null;\r\n        this.program = gl.createProgram();\r\n        vertexSource = vertexSource || defaultVertexSource;\r\n        fragmentSource = fragmentSource || defaultFragmentSource;\r\n        if(floatPrecision === null) {\r\n            floatPrecision = testPrecisionSupport(gl.HIGH_FLOAT) ? 'highp' : (testPrecisionSupport(gl.MEDIUM_FLOAT) ? 'mediump' : 'lowp');\r\n        }\r\n        fragmentSource = 'precision ' + floatPrecision + ' float;' + fragmentSource; // annoying requirement is annoying\r\n        gl.attachShader(this.program, compileSource(gl.VERTEX_SHADER, vertexSource, nameStr + '(vertex)'));\r\n        gl.attachShader(this.program, compileSource(gl.FRAGMENT_SHADER, fragmentSource, nameStr + '(fragment)'));\r\n        gl.linkProgram(this.program);\r\n        if (!gl.getProgramParameter(this.program, gl.LINK_STATUS)) {\r\n            throw 'link error: ' + gl.getProgramInfoLog(this.program);\r\n        }\r\n    }\r\n\r\n    Shader.prototype.destroy = function() {\r\n        gl.deleteProgram(this.program);\r\n        this.program = null;\r\n    };\r\n\r\n    Shader.prototype.uniforms = function(uniforms) {\r\n        gl.useProgram(this.program);\r\n        for (var name in uniforms) {\r\n            if (!uniforms.hasOwnProperty(name)) continue;\r\n            let location = gl.getUniformLocation(this.program, name);\r\n            if (location === null) continue; // will be null if the uniform isn't used in the shader\r\n            let value = uniforms[name];\r\n            if (isArray(value)) {\r\n                switch (value.length) {\r\n                    case 1: gl.uniform1fv(location, new Float32Array(value)); break;\r\n                    case 2: gl.uniform2fv(location, new Float32Array(value)); break;\r\n                    case 3: gl.uniform3fv(location, new Float32Array(value)); break;\r\n                    case 4: gl.uniform4fv(location, new Float32Array(value)); break;\r\n                    case 9: gl.uniformMatrix3fv(location, false, new Float32Array(value)); break;\r\n                    case 16: gl.uniformMatrix4fv(location, false, new Float32Array(value)); break;\r\n                    default: throw 'dont\\'t know how to load uniform \"' + name + '\" of length ' + value.length;\r\n                }\r\n            } else if (isNumber(value)) {\r\n                gl.uniform1f(location, value);\r\n            } else {\r\n                throw 'attempted to set uniform \"' + name + '\" to invalid value ' + (value || 'undefined').toString();\r\n            }\r\n        }\r\n        // allow chaining\r\n        return this;\r\n    };\r\n\r\n    // textures are uniforms too but for some reason can't be specified by gl.uniform1f,\r\n    // even though floating point numbers represent the integers 0 through 7 exactly\r\n    Shader.prototype.textures = function(textures) {\r\n        gl.useProgram(this.program);\r\n        for (var name in textures) {\r\n            if (!textures.hasOwnProperty(name)) continue;\r\n            gl.uniform1i(gl.getUniformLocation(this.program, name), textures[name]);\r\n        }\r\n        // allow chaining\r\n        return this;\r\n    };\r\n\r\n    Shader.prototype.drawRect = function(left, top, right, bottom) {\r\n        let undefined;\r\n        let viewport = gl.getParameter(gl.VIEWPORT);\r\n        top = top !== undefined ? (top - viewport[1]) / viewport[3] : 0;\r\n        left = left !== undefined ? (left - viewport[0]) / viewport[2] : 0;\r\n        right = right !== undefined ? (right - viewport[0]) / viewport[2] : 1;\r\n        bottom = bottom !== undefined ? (bottom - viewport[1]) / viewport[3] : 1;\r\n        if (gl.vertexBuffer == null) {\r\n            gl.vertexBuffer = gl.createBuffer();\r\n        }\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, gl.vertexBuffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([ left, top, left, bottom, right, top, right, bottom ]), gl.STATIC_DRAW);\r\n        if (gl.texCoordBuffer == null) {\r\n            gl.texCoordBuffer = gl.createBuffer();\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, gl.texCoordBuffer);\r\n            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([ 0, 0, 0, 1, 1, 0, 1, 1 ]), gl.STATIC_DRAW);\r\n        }\r\n        if (this.vertexAttribute == null) {\r\n            this.vertexAttribute = gl.getAttribLocation(this.program, 'vertex');\r\n            gl.enableVertexAttribArray(this.vertexAttribute);\r\n        }\r\n        if (this.texCoordAttribute == null) {\r\n            this.texCoordAttribute = gl.getAttribLocation(this.program, '_texCoord');\r\n            gl.enableVertexAttribArray(this.texCoordAttribute);\r\n        }\r\n        gl.useProgram(this.program);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, gl.vertexBuffer);\r\n        gl.vertexAttribPointer(this.vertexAttribute, 2, gl.FLOAT, false, 0, 0);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, gl.texCoordBuffer);\r\n        gl.vertexAttribPointer(this.texCoordAttribute, 2, gl.FLOAT, false, 0, 0);\r\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\r\n    };\r\n\r\n    Shader.getDefaultShader = function() {\r\n        gl.defaultShader = gl.defaultShader || new Shader();\r\n        return gl.defaultShader;\r\n    };\r\n\r\n    return Shader;\r\n})();\r\n\r\n// src/core\\spline.script\r\n// from SplineInterpolator.cs in the Paint.NET source code\r\n\r\nfunction SplineInterpolator(points) {\r\n    let n = points.length;\r\n    this.xa = [];\r\n    this.ya = [];\r\n    this.u = [];\r\n    this.y2 = [];\r\n\r\n    points.sort(function(a, b) {\r\n        return a[0] - b[0];\r\n    });\r\n    for (var i = 0; i < n; i++) {\r\n        this.xa.push(points[i][0]);\r\n        this.ya.push(points[i][1]);\r\n    }\r\n\r\n    this.u[0] = 0;\r\n    this.y2[0] = 0;\r\n\r\n    for (var i = 1; i < n - 1; ++i) {\r\n        // This is the decomposition loop of the tridiagonal algorithm. \r\n        // y2 and u are used for temporary storage of the decomposed factors.\r\n        let wx = this.xa[i + 1] - this.xa[i - 1];\r\n        let sig = (this.xa[i] - this.xa[i - 1]) / wx;\r\n        let p = sig * this.y2[i - 1] + 2.0;\r\n\r\n        this.y2[i] = (sig - 1.0) / p;\r\n\r\n        let ddydx = \r\n            (this.ya[i + 1] - this.ya[i]) / (this.xa[i + 1] - this.xa[i]) - \r\n            (this.ya[i] - this.ya[i - 1]) / (this.xa[i] - this.xa[i - 1]);\r\n\r\n        this.u[i] = (6.0 * ddydx / wx - sig * this.u[i - 1]) / p;\r\n    }\r\n\r\n    this.y2[n - 1] = 0;\r\n\r\n    // This is the backsubstitution loop of the tridiagonal algorithm\r\n    for (var i = n - 2; i >= 0; --i) {\r\n        this.y2[i] = this.y2[i] * this.y2[i + 1] + this.u[i];\r\n    }\r\n}\r\n\r\nSplineInterpolator.prototype.interpolate = function(x) {\r\n    let n = this.ya.length;\r\n    let klo = 0;\r\n    let khi = n - 1;\r\n\r\n    // We will find the right place in the table by means of\r\n    // bisection. This is optimal if sequential calls to this\r\n    // routine are at random values of x. If sequential calls\r\n    // are in order, and closely spaced, one would do better\r\n    // to store previous values of klo and khi.\r\n    while (khi - klo > 1) {\r\n        let k = (khi + klo) >> 1;\r\n\r\n        if (this.xa[k] > x) {\r\n            khi = k; \r\n        } else {\r\n            klo = k;\r\n        }\r\n    }\r\n\r\n    let h = this.xa[khi] - this.xa[klo];\r\n    let a = (this.xa[khi] - x) / h;\r\n    let b = (x - this.xa[klo]) / h;\r\n\r\n    // Cubic spline polynomial is now evaluated.\r\n    return a * this.ya[klo] + b * this.ya[khi] + \r\n        ((a * a * a - a) * this.y2[klo] + (b * b * b - b) * this.y2[khi]) * (h * h) / 6.0;\r\n};\r\n\r\n// src/core\\texture.script\r\nvar Texture = (function() {\r\n    Texture.fromElement = function(element) {\r\n        let texture = new Texture(0, 0, gl.RGBA, gl.UNSIGNED_BYTE);\r\n        texture.loadContentsOf(element);\r\n        return texture;\r\n    };\r\n\r\n    function Texture(width, height, format, type) {\r\n        this.gl = gl;\r\n        this.id = gl.createTexture();\r\n        this.width = width;\r\n        this.height = height;\r\n        this.format = format;\r\n        this.type = type;\r\n\r\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        if (width && height) gl.texImage2D(gl.TEXTURE_2D, 0, this.format, width, height, 0, this.format, this.type, null);\r\n    }\r\n\r\n    Texture.prototype.loadContentsOf = function(element) {\r\n        this.width = element.width || element.videoWidth;\r\n        this.height = element.height || element.videoHeight;\r\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, this.format, this.format, this.type, element);\r\n    };\r\n\r\n    Texture.prototype.initFromBytes = function(width, height, data) {\r\n        this.width = width;\r\n        this.height = height;\r\n        this.format = gl.RGBA;\r\n        this.type = gl.UNSIGNED_BYTE;\r\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, this.type, new Uint8Array(data));\r\n    };\r\n\r\n    Texture.prototype.destroy = function() {\r\n        gl.deleteTexture(this.id);\r\n        this.id = null;\r\n    };\r\n\r\n    Texture.prototype.use = function(unit) {\r\n        gl.activeTexture(gl.TEXTURE0 + (unit || 0));\r\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n    };\r\n\r\n    Texture.prototype.unuse = function(unit) {\r\n        gl.activeTexture(gl.TEXTURE0 + (unit || 0));\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n    };\r\n\r\n    Texture.prototype.ensureFormat = function(width, height, format, type) {\r\n        // allow passing an existing texture instead of individual arguments\r\n        if (arguments.length == 1) {\r\n            let texture = arguments[0];\r\n            width = texture.width;\r\n            height = texture.height;\r\n            format = texture.format;\r\n            type = texture.type;\r\n        }\r\n\r\n        // change the format only if required\r\n        if (width != this.width || height != this.height || format != this.format || type != this.type) {\r\n            this.width = width;\r\n            this.height = height;\r\n            this.format = format;\r\n            this.type = type;\r\n            gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n            gl.texImage2D(gl.TEXTURE_2D, 0, this.format, width, height, 0, this.format, this.type, null);\r\n        }\r\n    };\r\n\r\n    Texture.prototype.drawTo = function(callback) {\r\n        // start rendering to this texture\r\n        gl.framebuffer = gl.framebuffer || gl.createFramebuffer();\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, gl.framebuffer);\r\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.id, 0);\r\n        if (gl.checkFramebufferStatus(gl.FRAMEBUFFER) !== gl.FRAMEBUFFER_COMPLETE) {\r\n            throw new Error('incomplete framebuffer');\r\n        }\r\n        gl.viewport(0, 0, this.width, this.height);\r\n\r\n        // do the drawing\r\n        callback();\r\n\r\n        // stop rendering to this texture\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n    };\r\n\r\n    let canvas = null;\r\n\r\n    function getCanvas(texture) {\r\n        if (canvas == null) canvas = document.createElement('canvas');\r\n        canvas.width = texture.width;\r\n        canvas.height = texture.height;\r\n        let c = canvas.getContext('2d');\r\n        c.clearRect(0, 0, canvas.width, canvas.height);\r\n        return c;\r\n    }\r\n\r\n    Texture.prototype.fillUsingCanvas = function(callback) {\r\n        callback(getCanvas(this));\r\n        this.format = gl.RGBA;\r\n        this.type = gl.UNSIGNED_BYTE;\r\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, canvas);\r\n        return this;\r\n    };\r\n\r\n    Texture.prototype.toImage = function(image) {\r\n        this.use();\r\n        Shader.getDefaultShader().drawRect();\r\n        let size = this.width * this.height * 4;\r\n        let pixels = new Uint8Array(size);\r\n        let c = getCanvas(this);\r\n        let data = c.createImageData(this.width, this.height);\r\n        gl.readPixels(0, 0, this.width, this.height, gl.RGBA, gl.UNSIGNED_BYTE, pixels);\r\n        for (var i = 0; i < size; i++) {\r\n            data.data[i] = pixels[i];\r\n        }\r\n        c.putImageData(data, 0, 0);\r\n        image.src = canvas.toDataURL();\r\n    };\r\n\r\n    Texture.prototype.swapWith = function(other) {\r\n        let temp;\r\n        temp = other.id; other.id = this.id; this.id = temp;\r\n        temp = other.width; other.width = this.width; this.width = temp;\r\n        temp = other.height; other.height = this.height; this.height = temp;\r\n        temp = other.format; other.format = this.format; this.format = temp;\r\n    };\r\n\r\n    return Texture;\r\n})();\r\n\r\n// src/filters\\common.script\r\nfunction warpShader(uniforms, warp) {\r\n    return new Shader(null, uniforms + '\\\r\n    uniform sampler2D texture;\\\r\n    uniform vec2 texSize;\\\r\n    varying vec2 texCoord;\\\r\n    void main() {\\\r\n        vec2 coord = texCoord * texSize;\\\r\n        ' + warp + '\\\r\n        gl_FragColor = texture2D(texture, coord / texSize);\\\r\n        vec2 clampedCoord = clamp(coord, vec2(0.0), texSize);\\\r\n        if (coord != clampedCoord) {\\\r\n            /* fade to transparent if we are outside the image */\\\r\n            gl_FragColor.a *= max(0.0, 1.0 - length(coord - clampedCoord));\\\r\n        }\\\r\n    }', 'warp');\r\n}\r\n\r\n// returns a random number between 0 and 1\r\nvar randomShaderFunc = '\\\r\n    float random(vec3 scale, float seed) {\\\r\n        /* use the fragment position for a different seed per-pixel */\\\r\n        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\\\r\n    }\\\r\n';\r\n\r\n// src/filters\\adjust\\brightnesscontrast.script\r\n/**\r\n * @filter           Brightness / Contrast\r\n * @description      Provides additive brightness and multiplicative contrast control.\r\n * @param brightness -1 to 1 (-1 is solid black, 0 is no change, and 1 is solid white)\r\n * @param contrast   -1 to 1 (-1 is solid gray, 0 is no change, and 1 is maximum contrast)\r\n */\r\nfunction brightnessContrast(brightness, contrast) {\r\n    gl.brightnessContrast = gl.brightnessContrast || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float brightness;\\\r\n        uniform float contrast;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            color.rgb += brightness;\\\r\n            if (contrast > 0.0) {\\\r\n                color.rgb = (color.rgb - 0.5) / (1.0 - contrast) + 0.5;\\\r\n            } else {\\\r\n                color.rgb = (color.rgb - 0.5) * (1.0 + contrast) + 0.5;\\\r\n            }\\\r\n            gl_FragColor = color;\\\r\n        }\\\r\n    ', 'brightnessContrast');\r\n\r\n    simpleShader.call(this, gl.brightnessContrast, {\r\n        brightness: clamp(-1, brightness, 1),\r\n        contrast: clamp(-1, contrast, 1)\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\curves.script\r\nfunction splineInterpolate(points) {\r\n    let interpolator = new SplineInterpolator(points);\r\n    let array = [];\r\n    for (var i = 0; i < 256; i++) {\r\n        array.push(clamp(0, Math.floor(interpolator.interpolate(i / 255) * 256), 255));\r\n    }\r\n    return array;\r\n}\r\n\r\n/**\r\n * @filter      Curves\r\n * @description A powerful mapping tool that transforms the colors in the image\r\n *              by an arbitrary function. The function is interpolated between\r\n *              a set of 2D points using splines. The curves filter can take\r\n *              either one or three arguments which will apply the mapping to\r\n *              either luminance or RGB values, respectively.\r\n * @param red   A list of points that define the function for the red channel.\r\n *              Each point is a list of two values: the value before the mapping\r\n *              and the value after the mapping, both in the range 0 to 1. For\r\n *              example, [[0,1], [1,0]] would invert the red channel while\r\n *              [[0,0], [1,1]] would leave the red channel unchanged. If green\r\n *              and blue are omitted then this argument also applies to the\r\n *              green and blue channels.\r\n * @param green (optional) A list of points that define the function for the green\r\n *              channel (just like for red).\r\n * @param blue  (optional) A list of points that define the function for the blue\r\n *              channel (just like for red).\r\n */\r\nfunction curves(red, green, blue) {\r\n    // Create the ramp texture\r\n    red = splineInterpolate(red);\r\n    if (arguments.length == 1) {\r\n        green = blue = red;\r\n    } else {\r\n        green = splineInterpolate(green);\r\n        blue = splineInterpolate(blue);\r\n    }\r\n    let array = [];\r\n    for (var i = 0; i < 256; i++) {\r\n        array.splice(array.length, 0, red[i], green[i], blue[i], 255);\r\n    }\r\n    this._.extraTexture.initFromBytes(256, 1, array);\r\n    this._.extraTexture.use(1);\r\n\r\n    gl.curves = gl.curves || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform sampler2D map;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            color.r = texture2D(map, vec2(color.r)).r;\\\r\n            color.g = texture2D(map, vec2(color.g)).g;\\\r\n            color.b = texture2D(map, vec2(color.b)).b;\\\r\n            gl_FragColor = color;\\\r\n        }\\\r\n    ', 'curves');\r\n\r\n    gl.curves.textures({\r\n        map: 1\r\n    });\r\n    simpleShader.call(this, gl.curves, {});\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\denoise.script\r\n/**\r\n * @filter         Denoise\r\n * @description    Smooths over grainy noise in dark images using an 9x9 box filter\r\n *                 weighted by color intensity, similar to a bilateral filter.\r\n * @param exponent The exponent of the color intensity difference, should be greater\r\n *                 than zero. A value of zero just gives an 9x9 box blur and high values\r\n *                 give the original image, but ideal values are usually around 10-20.\r\n */\r\nfunction denoise(exponent) {\r\n    // Do a 9x9 bilateral box filter\r\n    gl.denoise = gl.denoise || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float exponent;\\\r\n        uniform float strength;\\\r\n        uniform vec2 texSize;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 center = texture2D(texture, texCoord);\\\r\n            vec4 color = vec4(0.0);\\\r\n            float total = 0.0;\\\r\n            for (float x = -4.0; x <= 4.0; x += 1.0) {\\\r\n                for (float y = -4.0; y <= 4.0; y += 1.0) {\\\r\n                    vec4 sample = texture2D(texture, texCoord + vec2(x, y) / texSize);\\\r\n                    float weight = 1.0 - abs(dot(sample.rgb - center.rgb, vec3(0.25)));\\\r\n                    weight = pow(weight, exponent);\\\r\n                    color += sample * weight;\\\r\n                    total += weight;\\\r\n                }\\\r\n            }\\\r\n            gl_FragColor = color / total;\\\r\n        }\\\r\n    ', 'denoise');\r\n\r\n    // Perform two iterations for stronger results\r\n    for (var i = 0; i < 2; i++) {\r\n        simpleShader.call(this, gl.denoise, {\r\n            exponent: Math.max(0, exponent),\r\n            texSize: [this.width, this.height]\r\n        });\r\n    }\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\huesaturation.script\r\n/**\r\n * @filter           Hue / Saturation\r\n * @description      Provides rotational hue and multiplicative saturation control. RGB color space\r\n *                   can be imagined as a cube where the axes are the red, green, and blue color\r\n *                   values. Hue changing works by rotating the color vector around the grayscale\r\n *                   line, which is the straight line from black (0, 0, 0) to white (1, 1, 1).\r\n *                   Saturation is implemented by scaling all color channel values either toward\r\n *                   or away from the average color channel value.\r\n * @param hue        -1 to 1 (-1 is 180 degree rotation in the negative direction, 0 is no change,\r\n *                   and 1 is 180 degree rotation in the positive direction)\r\n * @param saturation -1 to 1 (-1 is solid gray, 0 is no change, and 1 is maximum contrast)\r\n */\r\nfunction hueSaturation(hue, saturation) {\r\n    gl.hueSaturation = gl.hueSaturation || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float hue;\\\r\n        uniform float saturation;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            \\\r\n            /* hue adjustment, wolfram alpha: RotationTransform[angle, {1, 1, 1}][{x, y, z}] */\\\r\n            float angle = hue * 3.14159265;\\\r\n            float s = sin(angle), c = cos(angle);\\\r\n            vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;\\\r\n            float len = length(color.rgb);\\\r\n            color.rgb = vec3(\\\r\n                dot(color.rgb, weights.xyz),\\\r\n                dot(color.rgb, weights.zxy),\\\r\n                dot(color.rgb, weights.yzx)\\\r\n            );\\\r\n            \\\r\n            /* saturation adjustment */\\\r\n            float average = (color.r + color.g + color.b) / 3.0;\\\r\n            if (saturation > 0.0) {\\\r\n                color.rgb += (average - color.rgb) * (1.0 - 1.0 / (1.001 - saturation));\\\r\n            } else {\\\r\n                color.rgb += (average - color.rgb) * (-saturation);\\\r\n            }\\\r\n            \\\r\n            gl_FragColor = color;\\\r\n        }\\\r\n    ', 'hueSaturation');\r\n\r\n    simpleShader.call(this, gl.hueSaturation, {\r\n        hue: clamp(-1, hue, 1),\r\n        saturation: clamp(-1, saturation, 1)\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\noise.script\r\n/**\r\n * @filter         Noise\r\n * @description    Adds black and white noise to the image.\r\n * @param amount   0 to 1 (0 for no effect, 1 for maximum noise)\r\n */\r\nfunction noise(amount) {\r\n    gl.noise = gl.noise || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float amount;\\\r\n        varying vec2 texCoord;\\\r\n        float rand(vec2 co) {\\\r\n            return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\\r\n        }\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            \\\r\n            float diff = (rand(texCoord) - 0.5) * amount;\\\r\n            color.r += diff;\\\r\n            color.g += diff;\\\r\n            color.b += diff;\\\r\n            \\\r\n            gl_FragColor = color;\\\r\n        }\\\r\n    ', 'noise');\r\n\r\n    simpleShader.call(this, gl.noise, {\r\n        amount: clamp(0, amount, 1)\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\sepia.script\r\n/**\r\n * @filter         Sepia\r\n * @description    Gives the image a reddish-brown monochrome tint that imitates an old photograph.\r\n * @param amount   0 to 1 (0 for no effect, 1 for full sepia coloring)\r\n */\r\nfunction sepia(amount) {\r\n    gl.sepia = gl.sepia || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float amount;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            float r = color.r;\\\r\n            float g = color.g;\\\r\n            float b = color.b;\\\r\n            \\\r\n            color.r = min(1.0, (r * (1.0 - (0.607 * amount))) + (g * (0.769 * amount)) + (b * (0.189 * amount)));\\\r\n            color.g = min(1.0, (r * 0.349 * amount) + (g * (1.0 - (0.314 * amount))) + (b * 0.168 * amount));\\\r\n            color.b = min(1.0, (r * 0.272 * amount) + (g * 0.534 * amount) + (b * (1.0 - (0.869 * amount))));\\\r\n            \\\r\n            gl_FragColor = color;\\\r\n        }\\\r\n    ', 'sepia');\r\n\r\n    simpleShader.call(this, gl.sepia, {\r\n        amount: clamp(0, amount, 1)\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\unsharpmask.script\r\n/**\r\n * @filter         Unsharp Mask\r\n * @description    A form of image sharpening that amplifies high-frequencies in the image. It\r\n *                 is implemented by scaling pixels away from the average of their neighbors.\r\n * @param radius   The blur radius that calculates the average of the neighboring pixels.\r\n * @param strength A scale factor where 0 is no effect and higher values cause a stronger effect.\r\n */\r\nfunction unsharpMask(radius, strength) {\r\n    gl.unsharpMask = gl.unsharpMask || new Shader(null, '\\\r\n        uniform sampler2D blurredTexture;\\\r\n        uniform sampler2D originalTexture;\\\r\n        uniform float strength;\\\r\n        uniform float threshold;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 blurred = texture2D(blurredTexture, texCoord);\\\r\n            vec4 original = texture2D(originalTexture, texCoord);\\\r\n            gl_FragColor = mix(blurred, original, 1.0 + strength);\\\r\n        }\\\r\n    ', 'unsharpMask');\r\n\r\n    // Store a copy of the current texture in the second texture unit\r\n    this._.extraTexture.ensureFormat(this._.texture);\r\n    this._.texture.use();\r\n    this._.extraTexture.drawTo(function() {\r\n        Shader.getDefaultShader().drawRect();\r\n    });\r\n\r\n    // Blur the current texture, then use the stored texture to detect edges\r\n    this._.extraTexture.use(1);\r\n    this.triangleBlur(radius);\r\n    gl.unsharpMask.textures({\r\n        originalTexture: 1\r\n    });\r\n    simpleShader.call(this, gl.unsharpMask, {\r\n        strength: strength\r\n    });\r\n    this._.extraTexture.unuse(1);\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\vibrance.script\r\n/**\r\n * @filter       Vibrance\r\n * @description  Modifies the saturation of desaturated colors, leaving saturated colors unmodified.\r\n * @param amount -1 to 1 (-1 is minimum vibrance, 0 is no change, and 1 is maximum vibrance)\r\n */\r\nfunction vibrance(amount) {\r\n    gl.vibrance = gl.vibrance || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float amount;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            float average = (color.r + color.g + color.b) / 3.0;\\\r\n            float mx = max(color.r, max(color.g, color.b));\\\r\n            float amt = (mx - average) * (-amount * 3.0);\\\r\n            color.rgb = mix(color.rgb, vec3(mx), amt);\\\r\n            gl_FragColor = color;\\\r\n        }\\\r\n    ', 'vibrance');\r\n\r\n    simpleShader.call(this, gl.vibrance, {\r\n        amount: clamp(-1, amount, 1)\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\adjust\\vignette.script\r\n/**\r\n * @filter         Vignette\r\n * @description    Adds a simulated lens edge darkening effect.\r\n * @param size     0 to 1 (0 for center of frame, 1 for edge of frame)\r\n * @param amount   0 to 1 (0 for no effect, 1 for maximum lens darkening)\r\n */\r\nfunction vignette(size, amount) {\r\n    gl.vignette = gl.vignette || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float size;\\\r\n        uniform float amount;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            \\\r\n            float dist = distance(texCoord, vec2(0.5, 0.5));\\\r\n            color.rgb *= smoothstep(0.8, size * 0.799, dist * (amount + size));\\\r\n            \\\r\n            gl_FragColor = color;\\\r\n        }\\\r\n    ', 'vignette');\r\n\r\n    simpleShader.call(this, gl.vignette, {\r\n        size: clamp(0, size, 1),\r\n        amount: clamp(0, amount, 1)\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\blur\\lensblur.script\r\n/**\r\n * @filter           Lens Blur\r\n * @description      Imitates a camera capturing the image out of focus by using a blur that generates\r\n *                   the large shapes known as bokeh. The polygonal shape of real bokeh is due to the\r\n *                   blades of the aperture diaphragm when it isn't fully open. This blur renders\r\n *                   bokeh from a 6-bladed diaphragm because the computation is more efficient. It\r\n *                   can be separated into three rhombi, each of which is just a skewed box blur.\r\n *                   This filter makes use of the floating point texture WebGL extension to implement\r\n *                   the brightness parameter, so there will be severe visual artifacts if brightness\r\n *                   is non-zero and the floating point texture extension is not available. The\r\n *                   idea was from John White's SIGGRAPH 2011 talk but this effect has an additional\r\n *                   brightness parameter that fakes what would otherwise come from a HDR source.\r\n * @param radius     the radius of the hexagonal disk convolved with the image\r\n * @param brightness -1 to 1 (the brightness of the bokeh, negative values will create dark bokeh)\r\n * @param angle      the rotation of the bokeh in radians\r\n */\r\nfunction lensBlur(radius, brightness, angle) {\r\n    // All averaging is done on values raised to a power to make more obvious bokeh\r\n    // (we will raise the average to the inverse power at the end to compensate).\r\n    // Without this the image looks almost like a normal blurred image. This hack is\r\n    // obviously not realistic, but to accurately simulate this we would need a high\r\n    // dynamic range source photograph which we don't have.\r\n    gl.lensBlurPrePass = gl.lensBlurPrePass || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float power;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            color = pow(color, vec4(power));\\\r\n            gl_FragColor = vec4(color);\\\r\n        }\\\r\n    ', 'lensBlurPrePass');\r\n\r\n    let common = '\\\r\n        uniform sampler2D texture0;\\\r\n        uniform sampler2D texture1;\\\r\n        uniform vec2 delta0;\\\r\n        uniform vec2 delta1;\\\r\n        uniform float power;\\\r\n        varying vec2 texCoord;\\\r\n        ' + randomShaderFunc + '\\\r\n        vec4 sample(vec2 delta) {\\\r\n            /* randomize the lookup values to hide the fixed number of samples */\\\r\n            float offset = random(vec3(delta, 151.7182), 0.0);\\\r\n            \\\r\n            vec4 color = vec4(0.0);\\\r\n            float total = 0.0;\\\r\n            for (float t = 0.0; t <= 30.0; t++) {\\\r\n                float percent = (t + offset) / 30.0;\\\r\n                color += texture2D(texture0, texCoord + delta * percent);\\\r\n                total += 1.0;\\\r\n            }\\\r\n            return color / total;\\\r\n        }\\\r\n    ';\r\n\r\n    gl.lensBlur0 = gl.lensBlur0 || new Shader(null, common + '\\\r\n        void main() {\\\r\n            gl_FragColor = sample(delta0);\\\r\n        }\\\r\n    ', 'lensBlur0');\r\n    gl.lensBlur1 = gl.lensBlur1 || new Shader(null, common + '\\\r\n        void main() {\\\r\n            gl_FragColor = (sample(delta0) + sample(delta1)) * 0.5;\\\r\n        }\\\r\n    ', 'lensBlur1');\r\n    gl.lensBlur2 = gl.lensBlur2 || new Shader(null, common + '\\\r\n        void main() {\\\r\n            vec4 color = (sample(delta0) + 2.0 * texture2D(texture1, texCoord)) / 3.0;\\\r\n            gl_FragColor = pow(color, vec4(power));\\\r\n        }\\\r\n    ', 'lensBlur2').textures({ texture1: 1 });\r\n\r\n    // Generate\r\n    let dir = [];\r\n    for (var i = 0; i < 3; i++) {\r\n        let a = angle + i * Math.PI * 2 / 3;\r\n        dir.push([radius * Math.sin(a) / this.width, radius * Math.cos(a) / this.height]);\r\n    }\r\n    let power = Math.pow(10, clamp(-1, brightness, 1));\r\n\r\n    // Remap the texture values, which will help make the bokeh effect\r\n    simpleShader.call(this, gl.lensBlurPrePass, {\r\n        power: power\r\n    });\r\n\r\n    // Blur two rhombi in parallel into extraTexture\r\n    this._.extraTexture.ensureFormat(this._.texture);\r\n    simpleShader.call(this, gl.lensBlur0, {\r\n        delta0: dir[0]\r\n    }, this._.texture, this._.extraTexture);\r\n    simpleShader.call(this, gl.lensBlur1, {\r\n        delta0: dir[1],\r\n        delta1: dir[2]\r\n    }, this._.extraTexture, this._.extraTexture);\r\n\r\n    // Blur the last rhombus and combine with extraTexture\r\n    simpleShader.call(this, gl.lensBlur0, {\r\n        delta0: dir[1]\r\n    });\r\n    this._.extraTexture.use(1);\r\n    simpleShader.call(this, gl.lensBlur2, {\r\n        power: 1 / power,\r\n        delta0: dir[2]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\blur\\tiltshift.script\r\n/**\r\n * @filter               Tilt Shift\r\n * @description          Simulates the shallow depth of field normally encountered in close-up\r\n *                       photography, which makes the scene seem much smaller than it actually\r\n *                       is. This filter assumes the scene is relatively planar, in which case\r\n *                       the part of the scene that is completely in focus can be described by\r\n *                       a line (the intersection of the focal plane and the scene). An example\r\n *                       of a planar scene might be looking at a road from above at a downward\r\n *                       angle. The image is then blurred with a blur radius that starts at zero\r\n *                       on the line and increases further from the line.\r\n * @param startX         The x coordinate of the start of the line segment.\r\n * @param startY         The y coordinate of the start of the line segment.\r\n * @param endX           The x coordinate of the end of the line segment.\r\n * @param endY           The y coordinate of the end of the line segment.\r\n * @param blurRadius     The maximum radius of the pyramid blur.\r\n * @param gradientRadius The distance from the line at which the maximum blur radius is reached.\r\n */\r\nfunction tiltShift(startX, startY, endX, endY, blurRadius, gradientRadius) {\r\n    gl.tiltShift = gl.tiltShift || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float blurRadius;\\\r\n        uniform float gradientRadius;\\\r\n        uniform vec2 start;\\\r\n        uniform vec2 end;\\\r\n        uniform vec2 delta;\\\r\n        uniform vec2 texSize;\\\r\n        varying vec2 texCoord;\\\r\n        ' + randomShaderFunc + '\\\r\n        void main() {\\\r\n            vec4 color = vec4(0.0);\\\r\n            float total = 0.0;\\\r\n            \\\r\n            /* randomize the lookup values to hide the fixed number of samples */\\\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\r\n            \\\r\n            vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\\\r\n            float radius = smoothstep(0.0, 1.0, abs(dot(texCoord * texSize - start, normal)) / gradientRadius) * blurRadius;\\\r\n            for (float t = -30.0; t <= 30.0; t++) {\\\r\n                float percent = (t + offset - 0.5) / 30.0;\\\r\n                float weight = 1.0 - abs(percent);\\\r\n                vec4 sample = texture2D(texture, texCoord + delta / texSize * percent * radius);\\\r\n                \\\r\n                /* switch to pre-multiplied alpha to correctly blur transparent images */\\\r\n                sample.rgb *= sample.a;\\\r\n                \\\r\n                color += sample * weight;\\\r\n                total += weight;\\\r\n            }\\\r\n            \\\r\n            gl_FragColor = color / total;\\\r\n            \\\r\n            /* switch back from pre-multiplied alpha */\\\r\n            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\\\r\n        }\\\r\n    ', 'tiltShift');\r\n\r\n    let dx = endX - startX;\r\n    let dy = endY - startY;\r\n    let d = Math.sqrt(dx * dx + dy * dy);\r\n    simpleShader.call(this, gl.tiltShift, {\r\n        blurRadius: blurRadius,\r\n        gradientRadius: gradientRadius,\r\n        start: [startX, startY],\r\n        end: [endX, endY],\r\n        delta: [dx / d, dy / d],\r\n        texSize: [this.width, this.height]\r\n    });\r\n    simpleShader.call(this, gl.tiltShift, {\r\n        blurRadius: blurRadius,\r\n        gradientRadius: gradientRadius,\r\n        start: [startX, startY],\r\n        end: [endX, endY],\r\n        delta: [-dy / d, dx / d],\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\blur\\triangleblur.script\r\n/**\r\n * @filter       Triangle Blur\r\n * @description  This is the most basic blur filter, which convolves the image with a\r\n *               pyramid filter. The pyramid filter is separable and is applied as two\r\n *               perpendicular triangle filters.\r\n * @param radius The radius of the pyramid convolved with the image.\r\n */\r\nfunction triangleBlur(radius) {\r\n    gl.triangleBlur = gl.triangleBlur || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform vec2 delta;\\\r\n        varying vec2 texCoord;\\\r\n        ' + randomShaderFunc + '\\\r\n        void main() {\\\r\n            vec4 color = vec4(0.0);\\\r\n            float total = 0.0;\\\r\n            \\\r\n            /* randomize the lookup values to hide the fixed number of samples */\\\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\r\n            \\\r\n            for (float t = -30.0; t <= 30.0; t++) {\\\r\n                float percent = (t + offset - 0.5) / 30.0;\\\r\n                float weight = 1.0 - abs(percent);\\\r\n                vec4 sample = texture2D(texture, texCoord + delta * percent);\\\r\n                \\\r\n                /* switch to pre-multiplied alpha to correctly blur transparent images */\\\r\n                sample.rgb *= sample.a;\\\r\n                \\\r\n                color += sample * weight;\\\r\n                total += weight;\\\r\n            }\\\r\n            \\\r\n            gl_FragColor = color / total;\\\r\n            \\\r\n            /* switch back from pre-multiplied alpha */\\\r\n            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\\\r\n        }\\\r\n    ', 'triangleBlur');\r\n\r\n    simpleShader.call(this, gl.triangleBlur, {\r\n        delta: [radius / this.width, 0]\r\n    });\r\n    simpleShader.call(this, gl.triangleBlur, {\r\n        delta: [0, radius / this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\blur\\zoomblur.script\r\n/**\r\n * @filter         Zoom Blur\r\n * @description    Blurs the image away from a certain point, which looks like radial motion blur.\r\n * @param centerX  The x coordinate of the blur origin.\r\n * @param centerY  The y coordinate of the blur origin.\r\n * @param strength The strength of the blur. Values in the range 0 to 1 are usually sufficient,\r\n *                 where 0 doesn't change the image and 1 creates a highly blurred image.\r\n */\r\nfunction zoomBlur(centerX, centerY, strength) {\r\n    gl.zoomBlur = gl.zoomBlur || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform vec2 center;\\\r\n        uniform float strength;\\\r\n        uniform vec2 texSize;\\\r\n        varying vec2 texCoord;\\\r\n        ' + randomShaderFunc + '\\\r\n        void main() {\\\r\n            vec4 color = vec4(0.0);\\\r\n            float total = 0.0;\\\r\n            vec2 toCenter = center - texCoord * texSize;\\\r\n            \\\r\n            /* randomize the lookup values to hide the fixed number of samples */\\\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\r\n            \\\r\n            for (float t = 0.0; t <= 40.0; t++) {\\\r\n                float percent = (t + offset) / 40.0;\\\r\n                float weight = 4.0 * (percent - percent * percent);\\\r\n                vec4 sample = texture2D(texture, texCoord + toCenter * percent * strength / texSize);\\\r\n                \\\r\n                /* switch to pre-multiplied alpha to correctly blur transparent images */\\\r\n                sample.rgb *= sample.a;\\\r\n                \\\r\n                color += sample * weight;\\\r\n                total += weight;\\\r\n            }\\\r\n            \\\r\n            gl_FragColor = color / total;\\\r\n            \\\r\n            /* switch back from pre-multiplied alpha */\\\r\n            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\\\r\n        }\\\r\n    ', 'zoomBlur');\r\n\r\n    simpleShader.call(this, gl.zoomBlur, {\r\n        center: [centerX, centerY],\r\n        strength: strength,\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\fun\\colorhalftone.script\r\n/**\r\n * @filter        Color Halftone\r\n * @description   Simulates a CMYK halftone rendering of the image by multiplying pixel values\r\n *                with a four rotated 2D sine wave patterns, one each for cyan, magenta, yellow,\r\n *                and black.\r\n * @param centerX The x coordinate of the pattern origin.\r\n * @param centerY The y coordinate of the pattern origin.\r\n * @param angle   The rotation of the pattern in radians.\r\n * @param size    The diameter of a dot in pixels.\r\n */\r\nfunction colorHalftone(centerX, centerY, angle, size) {\r\n    gl.colorHalftone = gl.colorHalftone || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform vec2 center;\\\r\n        uniform float angle;\\\r\n        uniform float scale;\\\r\n        uniform vec2 texSize;\\\r\n        varying vec2 texCoord;\\\r\n        \\\r\n        float pattern(float angle) {\\\r\n            float s = sin(angle), c = cos(angle);\\\r\n            vec2 tex = texCoord * texSize - center;\\\r\n            vec2 point = vec2(\\\r\n                c * tex.x - s * tex.y,\\\r\n                s * tex.x + c * tex.y\\\r\n            ) * scale;\\\r\n            return (sin(point.x) * sin(point.y)) * 4.0;\\\r\n        }\\\r\n        \\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            vec3 cmy = 1.0 - color.rgb;\\\r\n            float k = min(cmy.x, min(cmy.y, cmy.z));\\\r\n            cmy = (cmy - k) / (1.0 - k);\\\r\n            cmy = clamp(cmy * 10.0 - 3.0 + vec3(pattern(angle + 0.26179), pattern(angle + 1.30899), pattern(angle)), 0.0, 1.0);\\\r\n            k = clamp(k * 10.0 - 5.0 + pattern(angle + 0.78539), 0.0, 1.0);\\\r\n            gl_FragColor = vec4(1.0 - cmy - k, color.a);\\\r\n        }\\\r\n    ', 'colorHalftone');\r\n\r\n    simpleShader.call(this, gl.colorHalftone, {\r\n        center: [centerX, centerY],\r\n        angle: angle,\r\n        scale: Math.PI / size,\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\fun\\dotscreen.script\r\n/**\r\n * @filter        Dot Screen\r\n * @description   Simulates a black and white halftone rendering of the image by multiplying\r\n *                pixel values with a rotated 2D sine wave pattern.\r\n * @param centerX The x coordinate of the pattern origin.\r\n * @param centerY The y coordinate of the pattern origin.\r\n * @param angle   The rotation of the pattern in radians.\r\n * @param size    The diameter of a dot in pixels.\r\n */\r\nfunction dotScreen(centerX, centerY, angle, size) {\r\n    gl.dotScreen = gl.dotScreen || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform vec2 center;\\\r\n        uniform float angle;\\\r\n        uniform float scale;\\\r\n        uniform vec2 texSize;\\\r\n        varying vec2 texCoord;\\\r\n        \\\r\n        float pattern() {\\\r\n            float s = sin(angle), c = cos(angle);\\\r\n            vec2 tex = texCoord * texSize - center;\\\r\n            vec2 point = vec2(\\\r\n                c * tex.x - s * tex.y,\\\r\n                s * tex.x + c * tex.y\\\r\n            ) * scale;\\\r\n            return (sin(point.x) * sin(point.y)) * 4.0;\\\r\n        }\\\r\n        \\\r\n        void main() {\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            float average = (color.r + color.g + color.b) / 3.0;\\\r\n            gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\\\r\n        }\\\r\n    ', 'dotScreen');\r\n\r\n    simpleShader.call(this, gl.dotScreen, {\r\n        center: [centerX, centerY],\r\n        angle: angle,\r\n        scale: Math.PI / size,\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\fun\\edgework.script\r\n/**\r\n * @filter       Edge Work\r\n * @description  Picks out different frequencies in the image by subtracting two\r\n *               copies of the image blurred with different radii.\r\n * @param radius The radius of the effect in pixels.\r\n */\r\nfunction edgeWork(radius) {\r\n    gl.edgeWork1 = gl.edgeWork1 || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform vec2 delta;\\\r\n        varying vec2 texCoord;\\\r\n        ' + randomShaderFunc + '\\\r\n        void main() {\\\r\n            vec2 color = vec2(0.0);\\\r\n            vec2 total = vec2(0.0);\\\r\n            \\\r\n            /* randomize the lookup values to hide the fixed number of samples */\\\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\r\n            \\\r\n            for (float t = -30.0; t <= 30.0; t++) {\\\r\n                float percent = (t + offset - 0.5) / 30.0;\\\r\n                float weight = 1.0 - abs(percent);\\\r\n                vec3 sample = texture2D(texture, texCoord + delta * percent).rgb;\\\r\n                float average = (sample.r + sample.g + sample.b) / 3.0;\\\r\n                color.x += average * weight;\\\r\n                total.x += weight;\\\r\n                if (abs(t) < 15.0) {\\\r\n                    weight = weight * 2.0 - 1.0;\\\r\n                    color.y += average * weight;\\\r\n                    total.y += weight;\\\r\n                }\\\r\n            }\\\r\n            gl_FragColor = vec4(color / total, 0.0, 1.0);\\\r\n        }\\\r\n    ', 'edgeWork1');\r\n    gl.edgeWork2 = gl.edgeWork2 || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform vec2 delta;\\\r\n        varying vec2 texCoord;\\\r\n        ' + randomShaderFunc + '\\\r\n        void main() {\\\r\n            vec2 color = vec2(0.0);\\\r\n            vec2 total = vec2(0.0);\\\r\n            \\\r\n            /* randomize the lookup values to hide the fixed number of samples */\\\r\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\r\n            \\\r\n            for (float t = -30.0; t <= 30.0; t++) {\\\r\n                float percent = (t + offset - 0.5) / 30.0;\\\r\n                float weight = 1.0 - abs(percent);\\\r\n                vec2 sample = texture2D(texture, texCoord + delta * percent).xy;\\\r\n                color.x += sample.x * weight;\\\r\n                total.x += weight;\\\r\n                if (abs(t) < 15.0) {\\\r\n                    weight = weight * 2.0 - 1.0;\\\r\n                    color.y += sample.y * weight;\\\r\n                    total.y += weight;\\\r\n                }\\\r\n            }\\\r\n            float c = clamp(10000.0 * (color.y / total.y - color.x / total.x) + 0.5, 0.0, 1.0);\\\r\n            gl_FragColor = vec4(c, c, c, 1.0);\\\r\n        }\\\r\n    ', 'edgeWork2');\r\n\r\n    simpleShader.call(this, gl.edgeWork1, {\r\n        delta: [radius / this.width, 0]\r\n    });\r\n    simpleShader.call(this, gl.edgeWork2, {\r\n        delta: [0, radius / this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\fun\\hexagonalpixelate.script\r\n/**\r\n * @filter        Hexagonal Pixelate\r\n * @description   Renders the image using a pattern of hexagonal tiles. Tile colors\r\n *                are nearest-neighbor sampled from the centers of the tiles.\r\n * @param centerX The x coordinate of the pattern center.\r\n * @param centerY The y coordinate of the pattern center.\r\n * @param scale   The width of an individual tile, in pixels.\r\n */\r\nfunction hexagonalPixelate(centerX, centerY, scale) {\r\n    gl.hexagonalPixelate = gl.hexagonalPixelate || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform vec2 center;\\\r\n        uniform float scale;\\\r\n        uniform vec2 texSize;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec2 tex = (texCoord * texSize - center) / scale;\\\r\n            tex.y /= 0.866025404;\\\r\n            tex.x -= tex.y * 0.5;\\\r\n            \\\r\n            vec2 a;\\\r\n            if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) a = vec2(floor(tex.x), floor(tex.y));\\\r\n            else a = vec2(ceil(tex.x), ceil(tex.y));\\\r\n            vec2 b = vec2(ceil(tex.x), floor(tex.y));\\\r\n            vec2 c = vec2(floor(tex.x), ceil(tex.y));\\\r\n            \\\r\n            vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\\\r\n            vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\\\r\n            vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\\\r\n            vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\\\r\n            \\\r\n            float alen = length(TEX - A);\\\r\n            float blen = length(TEX - B);\\\r\n            float clen = length(TEX - C);\\\r\n            \\\r\n            vec2 choice;\\\r\n            if (alen < blen) {\\\r\n                if (alen < clen) choice = a;\\\r\n                else choice = c;\\\r\n            } else {\\\r\n                if (blen < clen) choice = b;\\\r\n                else choice = c;\\\r\n            }\\\r\n            \\\r\n            choice.x += choice.y * 0.5;\\\r\n            choice.y *= 0.866025404;\\\r\n            choice *= scale / texSize;\\\r\n            gl_FragColor = texture2D(texture, choice + center / texSize);\\\r\n        }\\\r\n    ', 'hexagonalPixelate');\r\n\r\n    simpleShader.call(this, gl.hexagonalPixelate, {\r\n        center: [centerX, centerY],\r\n        scale: scale,\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\fun\\ink.script\r\n/**\r\n * @filter         Ink\r\n * @description    Simulates outlining the image in ink by darkening edges stronger than a\r\n *                 certain threshold. The edge detection value is the difference of two\r\n *                 copies of the image, each blurred using a blur of a different radius.\r\n * @param strength The multiplicative scale of the ink edges. Values in the range 0 to 1\r\n *                 are usually sufficient, where 0 doesn't change the image and 1 adds lots\r\n *                 of black edges. Negative strength values will create white ink edges\r\n *                 instead of black ones.\r\n */\r\nfunction ink(strength) {\r\n    gl.ink = gl.ink || new Shader(null, '\\\r\n        uniform sampler2D texture;\\\r\n        uniform float strength;\\\r\n        uniform vec2 texSize;\\\r\n        varying vec2 texCoord;\\\r\n        void main() {\\\r\n            vec2 dx = vec2(1.0 / texSize.x, 0.0);\\\r\n            vec2 dy = vec2(0.0, 1.0 / texSize.y);\\\r\n            vec4 color = texture2D(texture, texCoord);\\\r\n            float bigTotal = 0.0;\\\r\n            float smallTotal = 0.0;\\\r\n            vec3 bigAverage = vec3(0.0);\\\r\n            vec3 smallAverage = vec3(0.0);\\\r\n            for (float x = -2.0; x <= 2.0; x += 1.0) {\\\r\n                for (float y = -2.0; y <= 2.0; y += 1.0) {\\\r\n                    vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\\\r\n                    bigAverage += sample;\\\r\n                    bigTotal += 1.0;\\\r\n                    if (abs(x) + abs(y) < 2.0) {\\\r\n                        smallAverage += sample;\\\r\n                        smallTotal += 1.0;\\\r\n                    }\\\r\n                }\\\r\n            }\\\r\n            vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\\\r\n            gl_FragColor = vec4(color.rgb - dot(edge, edge) * strength * 100000.0, color.a);\\\r\n        }\\\r\n    ', 'ink');\r\n\r\n    simpleShader.call(this, gl.ink, {\r\n        strength: strength * strength * strength * strength * strength,\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\warp\\bulgepinch.script\r\n/**\r\n * @filter         Bulge / Pinch\r\n * @description    Bulges or pinches the image in a circle.\r\n * @param centerX  The x coordinate of the center of the circle of effect.\r\n * @param centerY  The y coordinate of the center of the circle of effect.\r\n * @param radius   The radius of the circle of effect.\r\n * @param strength -1 to 1 (-1 is strong pinch, 0 is no effect, 1 is strong bulge)\r\n */\r\nfunction bulgePinch(centerX, centerY, radius, strength) {\r\n    gl.bulgePinch = gl.bulgePinch || warpShader('\\\r\n        uniform float radius;\\\r\n        uniform float strength;\\\r\n        uniform vec2 center;\\\r\n    ', '\\\r\n        coord -= center;\\\r\n        float distance = length(coord);\\\r\n        if (distance < radius) {\\\r\n            float percent = distance / radius;\\\r\n            if (strength > 0.0) {\\\r\n                coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\\\r\n            } else {\\\r\n                coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\\\r\n            }\\\r\n        }\\\r\n        coord += center;\\\r\n    ');\r\n\r\n    simpleShader.call(this, gl.bulgePinch, {\r\n        radius: radius,\r\n        strength: clamp(-1, strength, 1),\r\n        center: [centerX, centerY],\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\warp\\matrixwarp.script\r\n/**\r\n * @filter                Matrix Warp\r\n * @description           Transforms an image by a 2x2 or 3x3 matrix. The coordinates used in\r\n *                        the transformation are (x, y) for a 2x2 matrix or (x, y, 1) for a\r\n *                        3x3 matrix, where x and y are in units of pixels.\r\n * @param matrix          A 2x2 or 3x3 matrix represented as either a list or a list of lists.\r\n *                        For example, the 3x3 matrix [[2,0,0],[0,3,0],[0,0,1]] can also be\r\n *                        represented as [2,0,0,0,3,0,0,0,1] or just [2,0,0,3].\r\n * @param inverse         A boolean value that, when true, applies the inverse transformation\r\n *                        instead. (optional, defaults to false)\r\n * @param useTextureSpace A boolean value that, when true, uses texture-space coordinates\r\n *                        instead of screen-space coordinates. Texture-space coordinates range\r\n *                        from -1 to 1 instead of 0 to width - 1 or height - 1, and are easier\r\n *                        to use for simple operations like flipping and rotating.\r\n */\r\nfunction matrixWarp(matrix, inverse, useTextureSpace) {\r\n    gl.matrixWarp = gl.matrixWarp || warpShader('\\\r\n        uniform mat3 matrix;\\\r\n        uniform bool useTextureSpace;\\\r\n    ', '\\\r\n        if (useTextureSpace) coord = coord / texSize * 2.0 - 1.0;\\\r\n        vec3 warp = matrix * vec3(coord, 1.0);\\\r\n        coord = warp.xy / warp.z;\\\r\n        if (useTextureSpace) coord = (coord * 0.5 + 0.5) * texSize;\\\r\n    ');\r\n\r\n    // Flatten all members of matrix into one big list\r\n    matrix = Array.prototype.concat.apply([], matrix);\r\n\r\n    // Extract a 3x3 matrix out of the arguments\r\n    if (matrix.length == 4) {\r\n        matrix = [\r\n            matrix[0], matrix[1], 0,\r\n            matrix[2], matrix[3], 0,\r\n            0, 0, 1\r\n        ];\r\n    } else if (matrix.length != 9) {\r\n        throw 'can only warp with 2x2 or 3x3 matrix';\r\n    }\r\n\r\n    simpleShader.call(this, gl.matrixWarp, {\r\n        matrix: inverse ? getInverse(matrix) : matrix,\r\n        texSize: [this.width, this.height],\r\n        useTextureSpace: useTextureSpace | 0\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n// src/filters\\warp\\perspective.script\r\n/**\r\n * @filter       Perspective\r\n * @description  Warps one quadrangle to another with a perspective transform. This can be used to\r\n *               make a 2D image look 3D or to recover a 2D image captured in a 3D environment.\r\n * @param before The x and y coordinates of four points before the transform in a flat list. This\r\n *               would look like [ax, ay, bx, by, cx, cy, dx, dy] for four points (ax, ay), (bx, by),\r\n *               (cx, cy), and (dx, dy).\r\n * @param after  The x and y coordinates of four points after the transform in a flat list, just\r\n *               like the other argument.\r\n */\r\nfunction perspective(before, after) {\r\n    let a = getSquareToQuad.apply(null, after);\r\n    let b = getSquareToQuad.apply(null, before);\r\n    let c = multiply(getInverse(a), b);\r\n    return this.matrixWarp(c);\r\n}\r\n\r\n// src/filters\\warp\\swirl.script\r\n/**\r\n * @filter        Swirl\r\n * @description   Warps a circular region of the image in a swirl.\r\n * @param centerX The x coordinate of the center of the circular region.\r\n * @param centerY The y coordinate of the center of the circular region.\r\n * @param radius  The radius of the circular region.\r\n * @param angle   The angle in radians that the pixels in the center of\r\n *                the circular region will be rotated by.\r\n */\r\nfunction swirl(centerX, centerY, radius, angle) {\r\n    gl.swirl = gl.swirl || warpShader('\\\r\n        uniform float radius;\\\r\n        uniform float angle;\\\r\n        uniform vec2 center;\\\r\n    ', '\\\r\n        coord -= center;\\\r\n        float distance = length(coord);\\\r\n        if (distance < radius) {\\\r\n            float percent = (radius - distance) / radius;\\\r\n            float theta = percent * percent * angle;\\\r\n            float s = sin(theta);\\\r\n            float c = cos(theta);\\\r\n            coord = vec2(\\\r\n                coord.x * c - coord.y * s,\\\r\n                coord.x * s + coord.y * c\\\r\n            );\\\r\n        }\\\r\n        coord += center;\\\r\n    ');\r\n\r\n    simpleShader.call(this, gl.swirl, {\r\n        radius: radius,\r\n        center: [centerX, centerY],\r\n        angle: angle,\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n/**\r\n * @filter        Invert\r\n * @description   Inverts color of each pixel\r\n */\r\nfunction invert() {\r\n    gl.invert = gl.invert || new Shader(null, '\\\r\n    uniform sampler2D texture;\\\r\n    uniform vec2 texSize;\\\r\n    varying vec2 texCoord;\\\r\n    \\\r\n    void main() {\\\r\n        vec4 color = texture2D(texture, texCoord);\\\r\n        gl_FragColor = vec4(1.0 - color.r, 1.0 - color.g, 1.0 - color.b, color.a);\\\r\n    }\\\r\n', 'invert');\r\n\r\n    simpleShader.call(this, gl.invert, {\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n/**\r\n * @filter        To Alpha\r\n * @description   Generates alpha channel from luminance (r+g+b)\r\n * @param isInverted    boolean - invert luminance\r\n * @param replaceRGBA    rgba - color to replace rgb with. if a = 0 -> keep orig color\r\n */\r\nfunction toAlpha(isInverted, replaceRGBA) {\r\n    gl.toAlpha = gl.toAlpha || new Shader(null, '\\\r\n    uniform bool isInverted;\\\r\n    uniform vec4 replace;\\\r\n    uniform sampler2D texture;\\\r\n    uniform vec2 texSize;\\\r\n    varying vec2 texCoord;\\\r\n    \\\r\n    void main() {\\\r\n        vec4 color = texture2D(texture, texCoord);\\\r\n        float alpha = (color.r + color.g + color.b) / 3.0;\\\r\n        if(isInverted) alpha = 1.0 - alpha;\\\r\n        alpha = min(color.a, alpha);\\\r\n        if(replace.a > 0.0) color = replace;\\\r\n        gl_FragColor = vec4(color.r, color.g, color.b, alpha);\\\r\n    }\\\r\n', 'toAlpha');\r\n\r\n    simpleShader.call(this, gl.toAlpha, {\r\n        isInverted: isInverted ? 1 : 0,\r\n        replace: replaceRGBA ? [replaceRGBA.r / 255, replaceRGBA.g / 255, replaceRGBA.b / 255, replaceRGBA.a] : [0,0,0,0],\r\n        texSize: [this.width, this.height]\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\n\r\nreturn exports;\r\n})();\r\n","import {BB} from '../../bb/bb';\r\nimport {input} from '../ui/base-components/input';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {ColorOptions} from '../ui/base-components/color-options';\r\nimport {Cropper} from '../ui/components/cropper';\r\n\r\nexport const cropExtend = {\r\n\r\n    getDialog(params) {\r\n        const canvas = params.canvas;\r\n        if (!canvas)\r\n            return false;\r\n        const tempCanvas = BB.canvas();\r\n        (function () {\r\n            let fit = BB.fitInto(canvas.width, canvas.height, 560, 400, 1);\r\n            let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n            let previewFactor = w / canvas.width;\r\n            tempCanvas.width = w;\r\n            tempCanvas.height = h;\r\n            tempCanvas.style.display = 'block';\r\n            tempCanvas.getContext(\"2d\").drawImage(canvas.getCompleteCanvas(previewFactor), 0, 0, w, h);\r\n        })();\r\n\r\n        const div = document.createElement(\"div\");\r\n        const result: any = {\r\n            element: div\r\n        };\r\n        div.innerHTML = \"Crop or extend the image.<br/><br/>\";\r\n        let left = 0, right = 0, top = 0, bottom = 0;\r\n        let leftChanged = false, rightChanged = false, topChanged = false, bottomChanged = false;\r\n        const maxWidth = params.maxWidth, maxHeight = params.maxHeight;\r\n        let scale;\r\n\r\n\r\n\r\n        // --- input elements ---\r\n\r\n        const lrWrapper = BB.el({\r\n            css: {lineHeight: '30px', height: '35px'}\r\n        });\r\n        const tbWrapper = BB.el({\r\n            css: {lineHeight: '30px', height: '35px'}\r\n        });\r\n        div.appendChild(lrWrapper);\r\n        div.appendChild(tbWrapper);\r\n\r\n        const leftInput = input({\r\n            init: 0,\r\n            type: 'number',\r\n            min: -canvas.width,\r\n            max: maxWidth,\r\n            css: {width: '75px', marginRight: '20px'},\r\n            callback: function(v) {\r\n                leftChanged = true;\r\n                updateInput();\r\n            }\r\n        });\r\n        const rightInput = input({\r\n            init: 0,\r\n            type: 'number',\r\n            min: -canvas.width,\r\n            max: maxWidth,\r\n            css: {width: '75px'},\r\n            callback: function(v) {\r\n                rightChanged = true;\r\n                updateInput();\r\n            }\r\n        });\r\n        const topInput = input({\r\n            init: 0,\r\n            type: 'number',\r\n            min: -canvas.height,\r\n            max: maxHeight,\r\n            css: {width: '75px', marginRight: '20px'},\r\n            callback: function(v) {\r\n                topChanged = true;\r\n                updateInput();\r\n            }\r\n        });\r\n        const bottomInput = input({\r\n            init: 0,\r\n            type: 'number',\r\n            min: -canvas.height,\r\n            max: maxHeight,\r\n            css: {width: '75px'},\r\n            callback: function(v) {\r\n                bottomChanged = true;\r\n                updateInput();\r\n            }\r\n        });\r\n\r\n        const labelStyle = {\r\n            display: 'inline-block',\r\n            width: '60px'\r\n        };\r\n        lrWrapper.appendChild(BB.el({content: 'Left:', css: labelStyle}));\r\n        lrWrapper.appendChild(leftInput);\r\n        lrWrapper.appendChild(BB.el({content: 'Right:', css: labelStyle}));\r\n        lrWrapper.appendChild(rightInput);\r\n        tbWrapper.appendChild(BB.el({content: 'Top:', css: labelStyle}));\r\n        tbWrapper.appendChild(topInput);\r\n        tbWrapper.appendChild(BB.el({content: 'Bottom:', css: labelStyle}));\r\n        tbWrapper.appendChild(bottomInput);\r\n\r\n        function updateInput() {\r\n            left = parseInt(leftInput.value);\r\n            right = parseInt(rightInput.value);\r\n            top = parseInt(topInput.value);\r\n            bottom = parseInt(bottomInput.value);\r\n            let newWidth = canvas.width + left + right;\r\n            let newHeight = canvas.height + top + bottom;\r\n\r\n            if (newWidth <= 0) {\r\n                if (leftChanged) {\r\n                    left = -canvas.width - right + 1;\r\n                    leftInput.value = '' + left;\r\n                }\r\n                if (rightChanged) {\r\n                    right = -canvas.width - left + 1;\r\n                    rightInput.value = '' + right;\r\n                }\r\n                newWidth = 1;\r\n            }\r\n            if (newWidth > maxWidth) {\r\n                if (leftChanged) {\r\n                    left = -canvas.width - right + maxWidth;\r\n                    leftInput.value = '' + left;\r\n                }\r\n                if (rightChanged) {\r\n                    right = -canvas.width - left + maxWidth;\r\n                    rightInput.value = '' + right;\r\n                }\r\n                newWidth = maxWidth;\r\n            }\r\n            if (newHeight <= 0) {\r\n                if (topChanged) {\r\n                    top = -canvas.height - bottom + 1;\r\n                    topInput.value = '' + top;\r\n                }\r\n                if (bottomChanged) {\r\n                    bottom = -canvas.height - top + 1;\r\n                    bottomInput.value = '' + bottom;\r\n                }\r\n                newHeight = 1;\r\n            }\r\n            if (newHeight > maxHeight) {\r\n                if (topChanged) {\r\n                    top = -canvas.height - bottom + maxHeight;\r\n                    topInput.value = '' + top;\r\n                }\r\n                if (bottomChanged) {\r\n                    bottom = -canvas.height - top + maxHeight;\r\n                    bottomInput.value = '' + bottom;\r\n                }\r\n                newHeight = maxHeight;\r\n            }\r\n            cropper.setTransform({\r\n                x: -left,\r\n                y: -top,\r\n                width: newWidth,\r\n                height: newHeight\r\n            });\r\n\r\n\r\n            leftChanged = false;\r\n            rightChanged = false;\r\n            topChanged = false;\r\n            bottomChanged = false;\r\n        }\r\n\r\n        let useRuleOfThirds = true;\r\n        let ruleOThirdsCheckbox = new Checkbox({\r\n            init: true,\r\n            label: 'Rule of Thirds',\r\n            allowTab: true,\r\n            callback: function(b) {\r\n                useRuleOfThirds = b;\r\n                cropper.showThirds(useRuleOfThirds);\r\n            }\r\n        });\r\n        div.appendChild(BB.el({\r\n            css: {\r\n                clear: 'both'\r\n            }\r\n        }));\r\n\r\n        let selectedRgbaObj = {r: 0, g: 0, b: 0, a: 0};\r\n        const colorOptionsArr = [\r\n            {r: 0, g: 0, b: 0, a: 0},\r\n            {r: 255, g: 255, b: 255, a: 1},\r\n            {r: 0, g: 0, b: 0, a: 1}\r\n        ];\r\n        colorOptionsArr.push({\r\n            r: params.currentColorRgb.r,\r\n            g: params.currentColorRgb.g,\r\n            b: params.currentColorRgb.b,\r\n            a: 1,\r\n        });\r\n        colorOptionsArr.push({\r\n            r: params.secondaryColorRgb.r,\r\n            g: params.secondaryColorRgb.g,\r\n            b: params.secondaryColorRgb.b,\r\n            a: 1,\r\n        });\r\n\r\n        const colorOptions = new ColorOptions({\r\n            label: 'fill',\r\n            colorArr: colorOptionsArr,\r\n            onChange: function(rgbaObj) {\r\n                selectedRgbaObj = rgbaObj;\r\n                updateBg(rgbaObj);\r\n            }\r\n        });\r\n\r\n\r\n        const flexRow = BB.el({\r\n            css: {\r\n                display: 'flex',\r\n                justifyContent: 'space-between'\r\n            }\r\n        });\r\n        div.appendChild(flexRow);\r\n        flexRow.appendChild(ruleOThirdsCheckbox.getElement());\r\n        flexRow.appendChild(colorOptions.getElement());\r\n\r\n\r\n        // when input field changed, or dragging in preview finished\r\n        // adjusts the zoom\r\n        function update(transform) {\r\n            const fit = BB.fitInto(transform.width, transform.height, 260, 180, 1);\r\n            scale = fit.width / transform.width;\r\n\r\n            const offset = BB.centerWithin(340, 220, fit.width, fit.height);\r\n\r\n            tempCanvas.style.width = canvas.width * scale + \"px\";\r\n            tempCanvas.style.height = canvas.height * scale + \"px\";\r\n\r\n            offsetWrapper.style.left = (offset.x - transform.x * scale) + \"px\";\r\n            offsetWrapper.style.top = (offset.y - transform.y * scale) + \"px\";\r\n\r\n            left = parseInt('' + -transform.x);\r\n            top = parseInt('' + -transform.y);\r\n            right = parseInt('' + (transform.x + transform.width - canvas.width));\r\n            bottom = parseInt('' + (transform.y + transform.height - canvas.height));\r\n            leftInput.value = '' + left;\r\n            topInput.value = '' + top;\r\n            rightInput.value = '' + right;\r\n            bottomInput.value = '' + bottom;\r\n\r\n            BB.createCheckerDataUrl(parseInt('' + (50 * scale)), function (url) {\r\n                previewWrapper.style.background = \"url(\" + url + \")\";\r\n                if (selectedRgbaObj.a !== 0) {\r\n                    tempCanvas.style.background = \"url(\" + url + \")\";\r\n                }\r\n            });\r\n            previewWrapper.style.backgroundPosition = (offset.x) + \"px \" + (offset.y) + \"px\";\r\n\r\n            cropper.setScale(scale);\r\n        }\r\n\r\n        const previewWrapper = BB.el({\r\n            css: {\r\n                width: \"340px\",\r\n                marginTop: '10px',\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                position: \"relative\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                userSelect: 'none',\r\n                colorScheme: 'only light',\r\n            }\r\n        });\r\n        previewWrapper.oncontextmenu = function () {\r\n            return false;\r\n        };\r\n        const bgColorOverlay = BB.el({\r\n            css: {\r\n                position: 'absolute',\r\n                left: '0',\r\n                top: '0',\r\n                bottom: '0',\r\n                right: '0'\r\n            }\r\n        });\r\n        previewWrapper.appendChild(bgColorOverlay);\r\n\r\n        const offsetWrapper = document.createElement(\"div\");\r\n        offsetWrapper.style.position = \"absolute\";\r\n        offsetWrapper.style.left = \"0px\";\r\n        offsetWrapper.style.top = \"0px\";\r\n        previewWrapper.appendChild(offsetWrapper);\r\n\r\n\r\n        const canvasWrapper = BB.appendTextDiv(offsetWrapper, \"\");\r\n        canvasWrapper.appendChild(tempCanvas);\r\n        //tempCanvas.style.width = w + \"px\";\r\n        //tempCanvas.style.height = h + \"px\";\r\n        tempCanvas.style.boxShadow = \"0 0 3px 1px rgba(0,0,0,0.5)\";\r\n        tempCanvas.style.position = \"absolute\";\r\n        tempCanvas.style.left = \"0px\";\r\n        tempCanvas.style.top = \"0px\";\r\n\r\n        div.appendChild(previewWrapper);\r\n        const cropper = new Cropper({\r\n            x: 0,\r\n            y: 0,\r\n            width: canvas.width,\r\n            height: canvas.height,\r\n            scale: scale,\r\n            callback: update,\r\n            maxW: maxWidth,\r\n            maxH: maxHeight\r\n        });\r\n        update(cropper.getTransform());\r\n        offsetWrapper.appendChild(cropper.getElement());\r\n\r\n        function updateBg(rgbaObj) {\r\n\r\n            let borderColor;\r\n            if (rgbaObj.a === 0) {\r\n                borderColor = 'rgba(0,0,0,0.5)';\r\n                bgColorOverlay.style.background = '';\r\n                tempCanvas.style.background = '';\r\n            } else {\r\n                borderColor = (rgbaObj.r + rgbaObj.g + rgbaObj.b < 255 * 3 / 2) ? 'rgba(255,255,255,0.5)' : 'rgba(0,0,0,0.5)'\r\n                bgColorOverlay.style.background = BB.ColorConverter.toRgbStr(rgbaObj);\r\n\r\n                BB.createCheckerDataUrl(parseInt('' + (50 * scale)), function (url) {\r\n                    tempCanvas.style.background = \"url(\" + url + \")\";\r\n                });\r\n            }\r\n            tempCanvas.style.boxShadow = \"0 0 3px 1px \" + borderColor;\r\n        }\r\n\r\n        result.destroy = () => {\r\n            cropper.destroy();\r\n            ruleOThirdsCheckbox.destroy();\r\n        };\r\n        result.getInput = function () {\r\n            result.destroy();\r\n            return {\r\n                left: left,\r\n                right: right,\r\n                top: top,\r\n                bottom: bottom,\r\n                fillColor: selectedRgbaObj.a === 0 ? null : selectedRgbaObj\r\n            };\r\n        };\r\n        return result;\r\n    },\r\n\r\n    apply(params) {\r\n        const canvas = params.canvas;\r\n        const history = params.history;\r\n        if (!canvas || !history || isNaN(params.input.left) || isNaN(params.input.right) || isNaN(params.input.top) || isNaN(params.input.bottom)) {\r\n            return false;\r\n        }\r\n        history.pause();\r\n        canvas.resizeCanvas(params.input);\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"filter\", \"cropExtend\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: JSON.parse(JSON.stringify(params.input))\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {Options} from '../ui/base-components/options';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {getSharedFx} from './shared-gl-fx';\r\n\r\nexport const glCurves = {\r\n\r\n    getDialog(params) {\r\n\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\r\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n\r\n        let tempCanvas = BB.canvas();\r\n        tempCanvas.width = w;\r\n        tempCanvas.height = h;\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (tempCanvas.width > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div,\r\n        };\r\n        let klCanvasPreview;\r\n\r\n        function finishInit() {\r\n\r\n            let previewFactor = w / context.canvas.width;\r\n            let brightness = 0, contrast = 0;\r\n\r\n            div.innerHTML = \"Apply curves on the selected layer.<br/><br/>\";\r\n\r\n            let curves = {\r\n                r: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\r\n                g: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\r\n                b: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\r\n            };\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n\r\n            function update() {\r\n                try {\r\n                    glCanvas.draw(texture).curves(curves.r, curves.g, curves.b).update();\r\n                    if(klCanvasPreview) {\r\n                        klCanvasPreview.render();\r\n                    }\r\n                } catch(e) {\r\n                    (div as any).errorCallback(e);\r\n                }\r\n            }\r\n\r\n            let modeButtons;\r\n\r\n            function CurvesInput(p) {\r\n                let div = document.createElement(\"div\");\r\n                div.oncontextmenu = function () {\r\n                    return false;\r\n                };\r\n                div.style.position = \"relative\";\r\n                div.style.marginBottom = \"10px\";\r\n                let mode = \"All\";\r\n                let curves = p.curves;\r\n                modeButtons = new Options( {\r\n                    optionArr: [\r\n                        {\r\n                            id: 'All',\r\n                            label: 'All'\r\n                        },\r\n                        {\r\n                            id: 'Red',\r\n                            label: 'Red'\r\n                        },\r\n                        {\r\n                            id: 'Green',\r\n                            label: 'Green'\r\n                        },\r\n                        {\r\n                            id: 'Blue',\r\n                            label: 'Blue'\r\n                        },\r\n                    ],\r\n                    initialId: 'All',\r\n                    onChange: function(id) {\r\n                        mode = id;\r\n                        if (mode === \"All\") {\r\n                            curves = {\r\n                                r: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\r\n                                g: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\r\n                                b: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\r\n                            };\r\n                        }\r\n                        let curve = curves.r;\r\n                        if (mode === \"Green\") {\r\n                            curve = curves.g;\r\n                        }\r\n                        if (mode === \"Blue\") {\r\n                            curve = curves.b;\r\n                        }\r\n                        (p0 as any).setPos(0, areah - curve[0][1] * areah);\r\n                        (p1 as any).setPos(curve[1][0] * areaw, areah - curve[1][1] * areah);\r\n                        (p2 as any).setPos(curve[2][0] * areaw, areah - curve[2][1] * areah);\r\n                        (p3 as any).setPos(areaw, areah - curve[3][1] * areah);\r\n\r\n                        update();\r\n                    }\r\n                });\r\n                div.appendChild(modeButtons.getElement());\r\n\r\n                let curveArea = document.createElement(\"div\");\r\n                BB.css(curveArea, {\r\n                    position: 'relative',\r\n                    marginTop: '10px',\r\n                    colorScheme: 'only light',\r\n                })\r\n                div.appendChild(curveArea);\r\n\r\n                let areaw = 300, areah = 100;\r\n                let canvas = document.createElement(\"canvas\");\r\n                canvas.width = areaw;\r\n                canvas.height = areah;\r\n                BB.css(canvas, {\r\n                    background: \"#c6c6c6\",\r\n                    boxShadow: \"0 0 0 1px rgba(0,0,0,0.3)\"\r\n                });\r\n                let ctx = canvas.getContext(\"2d\");\r\n                curveArea.appendChild(canvas);\r\n\r\n                let points = {\r\n                    r: [],\r\n                    g: [],\r\n                    b: []\r\n                };\r\n\r\n                function fit(v) {\r\n                    return Math.max(0, Math.min(1, v));\r\n                }\r\n\r\n                function createPoint(x, y, callback, lock?) {\r\n                    let gripSize = 14;\r\n                    let internalY = y, internalX = x;\r\n                    let point = document.createElement(\"div\");\r\n                    BB.css(point, {\r\n                        position: \"absolute\",\r\n                        left: (x - gripSize / 2) + \"px\",\r\n                        top: (y - gripSize / 2) + \"px\",\r\n                        width: gripSize + \"px\",\r\n                        height: gripSize + \"px\",\r\n                        background: \"#fff\",\r\n                        cursor: \"move\",\r\n                        borderRadius: gripSize + \"px\",\r\n                        boxShadow: \"inset 0 0 0 2px #000\",\r\n                        userSelect: 'none'\r\n                    });\r\n\r\n                    function update() {\r\n                        BB.css(point, {\r\n                            left: (x - gripSize / 2) + \"px\",\r\n                            top: (y - gripSize / 2) + \"px\"\r\n                        });\r\n                    }\r\n\r\n                    (point as any).pointerListener = new BB.PointerListener({\r\n                        target: point,\r\n                        maxPointers: 1,\r\n                        onPointer: function(event) {\r\n                            event.eventPreventDefault();\r\n                            if (event.type === 'pointerdown') {\r\n                                internalX = x;\r\n                                internalY = y;\r\n                            }\r\n                            if (event.button === 'left' && event.type === 'pointermove') {\r\n                                if (!lock) {\r\n                                    internalX += event.dX;\r\n                                }\r\n                                x = Math.max(0, Math.min(areaw, internalX));\r\n                                internalY += event.dY;\r\n                                y = Math.max(0, Math.min(areah, internalY));\r\n                                update();\r\n                                callback({\r\n                                    x: x,\r\n                                    y: y\r\n                                });\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    curveArea.appendChild(point);\r\n\r\n                    (point as any).setPos = function (newX, newY) {\r\n                        x = newX;\r\n                        y = newY;\r\n                        internalY = y;\r\n                        internalX = x;\r\n                        BB.css(point, {\r\n                            left: (x - gripSize / 2) + \"px\",\r\n                            top: (y - gripSize / 2) + \"px\"\r\n                        });\r\n                    };\r\n\r\n                    return point;\r\n                }\r\n\r\n                function updateControl(i, x, y) {\r\n                    if (mode === \"All\") {\r\n                        curves.r[i] = [fit(x / areaw), fit(1 - y / areah)];\r\n                        curves.g[i] = [fit(x / areaw), fit(1 - y / areah)];\r\n                        curves.b[i] = [fit(x / areaw), fit(1 - y / areah)];\r\n                    }\r\n                    if (mode === \"Red\") {\r\n                        curves.r[i] = [fit(x / areaw), fit(1 - y / areah)];\r\n                    }\r\n                    if (mode === \"Green\") {\r\n                        curves.g[i] = [fit(x / areaw), fit(1 - y / areah)];\r\n                    }\r\n                    if (mode === \"Blue\") {\r\n                        curves.b[i] = [fit(x / areaw), fit(1 - y / areah)];\r\n                    }\r\n                }\r\n\r\n                let p0 = createPoint(0, areah, function (val) {\r\n                    updateControl(0, val.x, val.y);\r\n                    update();\r\n                }, true);\r\n                let p1 = createPoint(areaw / 3, areah / 3 * 2, function (val) {\r\n                    updateControl(1, val.x, val.y);\r\n                    update();\r\n                });\r\n                let p2 = createPoint(areaw / 3 * 2, areah / 3, function (val) {\r\n                    updateControl(2, val.x, val.y);\r\n                    update();\r\n                });\r\n                let p3 = createPoint(areaw, 0, function (val) {\r\n                    updateControl(3, val.x, val.y);\r\n                    update();\r\n                }, true);\r\n\r\n\r\n                function update() {\r\n                    canvas.width = canvas.width;\r\n                    ctx = canvas.getContext(\"2d\");\r\n\r\n                    let outCurves = {\r\n                        r: [],\r\n                        g: [],\r\n                        b: []\r\n                    };\r\n                    for (let i = 0; i < curves.r.length; i++) {\r\n                        outCurves.r.push(curves.r[i]);\r\n                        outCurves.g.push(curves.g[i]);\r\n                        outCurves.b.push(curves.b[i]);\r\n                    }\r\n\r\n                    function drawCurve(curve) {\r\n                        ctx.beginPath();\r\n                        let spline = new BB.SplineInterpolator(curve);\r\n                        for (let i = 0; i < 100; i++) {\r\n                            let y = spline.interpolate(i / 100);\r\n                            y = Math.max(0, Math.min(1, y));\r\n\r\n                            if (i === 0) {\r\n                                ctx.moveTo(i / 100 * areaw, areah - y * areah);\r\n                            } else {\r\n                                ctx.lineTo(i / 100 * areaw, areah - y * areah);\r\n                            }\r\n                        }\r\n                        ctx.stroke();\r\n                    }\r\n\r\n                    ctx.save();\r\n                    if (mode === \"All\") {\r\n                        ctx.strokeStyle = \"black\";\r\n                        drawCurve(outCurves.r);\r\n                    } else {\r\n                        ctx.globalAlpha = 0.5;\r\n                        ctx.strokeStyle = \"red\";\r\n                        drawCurve(outCurves.r);\r\n                        ctx.strokeStyle = \"green\";\r\n                        drawCurve(outCurves.g);\r\n                        ctx.strokeStyle = \"blue\";\r\n                        drawCurve(outCurves.b);\r\n                    }\r\n                    ctx.restore();\r\n                    p.callback(outCurves);\r\n                }\r\n\r\n                update();\r\n\r\n\r\n                this.getDiv = function () {\r\n                    return div;\r\n                };\r\n                this.destroy = function() {\r\n                    (p0 as any).pointerListener.destroy();\r\n                    (p1 as any).pointerListener.destroy();\r\n                    (p2 as any).pointerListener.destroy();\r\n                    (p3 as any).pointerListener.destroy();\r\n                };\r\n            }\r\n\r\n            let input = new CurvesInput({\r\n                curves: curves,\r\n                callback: function (val) {\r\n                    curves = val;\r\n                    update();\r\n                }\r\n            });\r\n\r\n\r\n            div.appendChild(input.getDiv());\r\n\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            BB.css(previewWrapper, {\r\n                width: \"340px\",\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr = [];\r\n            {\r\n                for(let i = 0; i < layers.length; i++) {\r\n                    previewLayerArr.push({\r\n                        canvas: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + w),\r\n                height: parseInt('' + h),\r\n                layerArr: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + w) + 'px',\r\n                    height: parseInt('' + h) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n\r\n            div.appendChild(previewWrapper);\r\n\r\n            result.destroy = () => {\r\n                input.destroy();\r\n                texture.destroy();\r\n                modeButtons.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    curves: curves\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1);\r\n\r\n        return result;\r\n    },\r\n\r\n    apply(params) {\r\n        let context = params.context;\r\n        let curves = params.input.curves;\r\n        let history = params.history;\r\n        if (!context || curves === null || !history)\r\n            return false;\r\n        history.pause();\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).curves(curves.r, curves.g, curves.b).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"filter\", \"glCurves\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n\r\n        return true;\r\n    }\r\n\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\n// @ts-ignore\r\nimport checkmarkImg from 'url:~/src/app/img/ui/checkmark.svg';\r\n\r\nexport const flip = {\r\n\r\n    getDialog(params) {\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\r\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n        let isHorizontal = true;\r\n        let isVertical = false;\r\n        let doFlipCanvas = true;\r\n        div.innerHTML = \"Flips layer or whole image.<br/><br/>\";\r\n\r\n\r\n        let horizontalCheckbox = new Checkbox({\r\n            init: isHorizontal,\r\n            label: 'Horizontal ⟷',\r\n            allowTab: true,\r\n            callback: function(v) {\r\n                isHorizontal = v;\r\n                updatePreview();\r\n            },\r\n            css: {\r\n                marginBottom: '10px'\r\n            }\r\n        });\r\n        let verticalCheckbox = new Checkbox({\r\n            init: isVertical,\r\n            label: 'Vertical ↕',\r\n            allowTab: true,\r\n            callback: function(v) {\r\n                isVertical = v;\r\n                updatePreview();\r\n            },\r\n            css: {\r\n                marginBottom: '10px'\r\n            }\r\n        });\r\n        div.appendChild(horizontalCheckbox.getElement());\r\n        div.appendChild(verticalCheckbox.getElement());\r\n\r\n\r\n\r\n\r\n\r\n        let fcOption = document.createElement(\"div\");\r\n        BB.setEventListener(fcOption, 'onpointerdown', function () {\r\n            return false;\r\n        });\r\n        fcOption.textContent = \"Flip Image\";\r\n        fcOption.style.width = \"150px\";\r\n        fcOption.style.height = \"30px\";\r\n        fcOption.style.paddingTop = \"10px\";\r\n        fcOption.style.textAlign = \"center\";\r\n        fcOption.style.cssFloat = \"left\";\r\n        fcOption.style.paddingBottom = \"0px\";\r\n        fcOption.style.borderTopLeftRadius = \"10px\";\r\n        fcOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\r\n        fcOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\r\n        fcOption.style.backgroundSize = '8%';\r\n        fcOption.style.backgroundColor = \"#9e9e9e\";\r\n\r\n        let flOption = document.createElement(\"div\");\r\n        BB.setEventListener(flOption, 'onpointerdown', function () {\r\n            return false;\r\n        });\r\n        flOption.textContent = \"Flip Layer\";\r\n        flOption.style.width = \"150px\";\r\n        flOption.style.height = \"30px\";\r\n        flOption.style.paddingTop = \"10px\";\r\n        flOption.style.textAlign = \"center\";\r\n        flOption.style.cssFloat = \"left\";\r\n        flOption.style.paddingBottom = \"0px\";\r\n        flOption.style.borderTopRightRadius = \"10px\";\r\n        flOption.style.cursor = \"pointer\";\r\n        flOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n        flOption.style.backgroundSize = '8%';\r\n\r\n        BB.setEventListener(fcOption, 'onpointerover', function () {\r\n            if (doFlipCanvas === false)\r\n                fcOption.style.backgroundColor = \"#ccc\";\r\n        });\r\n        BB.setEventListener(fcOption, 'onpointerout', function () {\r\n            if (doFlipCanvas === false)\r\n                fcOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n        });\r\n        BB.setEventListener(flOption, 'onpointerover', function () {\r\n            if (doFlipCanvas === true)\r\n                flOption.style.backgroundColor = \"#ccc\";\r\n        });\r\n        BB.setEventListener(flOption, 'onpointerout', function () {\r\n            if (doFlipCanvas === true)\r\n                flOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n        });\r\n\r\n        fcOption.onclick = function () {\r\n            doFlipCanvas = true;\r\n\r\n            flOption.style.background = \"\";\r\n            flOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n            flOption.style.boxShadow = \"\";\r\n            flOption.style.cursor = \"pointer\";\r\n\r\n            fcOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\r\n            fcOption.style.backgroundSize = '8%';\r\n            fcOption.style.backgroundColor = \"#9e9e9e\";\r\n            fcOption.style.cursor = \"default\";\r\n            fcOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\r\n\r\n            updatePreview();\r\n        };\r\n        flOption.onclick = function () {\r\n            doFlipCanvas = false;\r\n\r\n            fcOption.style.background = \"\";\r\n            fcOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n            fcOption.style.boxShadow = \"\";\r\n            fcOption.style.cursor = \"pointer\";\r\n\r\n            flOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\r\n            flOption.style.backgroundSize = '8%';\r\n            flOption.style.backgroundColor = \"#9e9e9e\";\r\n            flOption.style.cursor = \"default\";\r\n            flOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\r\n\r\n            updatePreview();\r\n        };\r\n\r\n        let optionWrapper = document.createElement(\"div\");\r\n        optionWrapper.appendChild(fcOption);\r\n        optionWrapper.appendChild(flOption);\r\n        div.appendChild(optionWrapper);\r\n\r\n\r\n        let previewWrapper = document.createElement(\"div\");\r\n        BB.css(previewWrapper, {\r\n            width: \"340px\",\r\n            marginLeft: \"-20px\",\r\n            height: \"220px\",\r\n            backgroundColor: \"#9e9e9e\",\r\n            marginTop: \"10px\",\r\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n            overflow: \"hidden\",\r\n            position: \"relative\",\r\n            userSelect: 'none',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            colorScheme: 'only light',\r\n        });\r\n\r\n        let previewLayer = {\r\n            canvas: BB.canvas(parseInt('' + w), parseInt('' + h)),\r\n            opacity: 1,\r\n            mixModeStr: 'source-over'\r\n        };\r\n        let klCanvasPreview = new KlCanvasPreview({\r\n            width: parseInt('' + w),\r\n            height: parseInt('' + h),\r\n            layerArr: [previewLayer]\r\n        });\r\n\r\n        let previewInnerWrapper = BB.el({\r\n            css: {\r\n                position: 'relative',\r\n                boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                width: parseInt('' + w) + 'px',\r\n                height: parseInt('' + h) + 'px'\r\n            }\r\n        });\r\n        previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n        previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n        function updatePreview() {\r\n            let ctx = previewLayer.canvas.getContext('2d');\r\n            ctx.save();\r\n            ctx.clearRect(0, 0, previewLayer.canvas.width, previewLayer.canvas.height);\r\n\r\n            if (doFlipCanvas) {\r\n                if (isHorizontal) {\r\n                    ctx.translate(previewLayer.canvas.width, 0);\r\n                    ctx.scale(-1, 1);\r\n                }\r\n                if (isVertical) {\r\n                    ctx.translate(0, previewLayer.canvas.height);\r\n                    ctx.scale(1, -1);\r\n                }\r\n            }\r\n\r\n            for(let i = 0; i < layers.length; i++) {\r\n                ctx.save();\r\n                if (!doFlipCanvas && selectedLayerIndex === i) {\r\n                    if (isHorizontal) {\r\n                        ctx.translate(previewLayer.canvas.width, 0);\r\n                        ctx.scale(-1, 1);\r\n                    }\r\n                    if (isVertical) {\r\n                        ctx.translate(0, previewLayer.canvas.height);\r\n                        ctx.scale(1, -1);\r\n                    }\r\n                }\r\n                if (ctx.canvas.width > layers[i].context.canvas.width) {\r\n                    ctx.imageSmoothingEnabled = false;\r\n                }\r\n                ctx.globalAlpha = parseFloat(layers[i].opacity);\r\n                ctx.globalCompositeOperation = layers[i].mixModeStr;\r\n                ctx.drawImage(layers[i].context.canvas, 0, 0, previewLayer.canvas.width, previewLayer.canvas.height);\r\n                ctx.restore();\r\n            }\r\n            klCanvasPreview.render();\r\n            ctx.restore();\r\n        }\r\n        setTimeout(updatePreview, 0);\r\n\r\n\r\n        div.appendChild(previewWrapper);\r\n        result.destroy = () => {\r\n            horizontalCheckbox.destroy();\r\n            verticalCheckbox.destroy();\r\n        };\r\n        result.getInput = function () {\r\n            result.destroy();\r\n            return {\r\n                horizontal: isHorizontal,\r\n                vertical: isVertical,\r\n                flipCanvas: doFlipCanvas\r\n            };\r\n        };\r\n        return result;\r\n    },\r\n\r\n    apply(params) {\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        let history = params.history;\r\n        let horizontal = params.input.horizontal;\r\n        let vertical = params.input.vertical;\r\n        let flipCanvas = params.input.flipCanvas;\r\n        if (!context || !canvas || !history) {\r\n            return false;\r\n        }\r\n\r\n        history.pause();\r\n        canvas.flip(horizontal, vertical, flipCanvas ? null : canvas.getLayerIndex(context.canvas));\r\n        history.pause(false);\r\n\r\n        history.add({\r\n            tool: [\"filter\", \"flip\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    },\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\n// @ts-ignore\r\nimport checkmarkImg from 'url:~/src/app/img/ui/checkmark.svg';\r\nimport {getSharedFx} from './shared-gl-fx';\r\n\r\nexport const glPerspective = {\r\n\r\n    getDialog(params) {\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let isSmall = window.innerWidth < 550;\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, isSmall ? 280 : 490, isSmall ? 200 : 240, 1);\r\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\r\n        let w = Math.min(displayW, context.canvas.width);\r\n        let h = Math.min(displayH, context.canvas.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (w > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n        let displayPreviewFactor = displayW / context.canvas.width;\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n        if (!isSmall) {\r\n            result.width = 500;\r\n        }\r\n\r\n        let pointerListenerArr = [];\r\n\r\n        function finishInit() {\r\n            div.innerHTML = \"Transforms the selected layer. <br/><br/>\";\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n            let ba, bb, bc, bd; //before\r\n            let aa, ab, ac, ad; //after\r\n            function update() {\r\n                try {\r\n                    glCanvas.draw(texture).perspective(\r\n                        [ba.x, ba.y, bb.x, bb.y, bc.x, bc.y, bd.x, bd.y].map((item, i) => {\r\n                            if (i % 2 === 0) {\r\n                                return item / displayW * w;\r\n                            } else {\r\n                                return item / displayH * h;\r\n                            }\r\n                        }),\r\n                        [aa.x, aa.y, ab.x, ab.y, ac.x, ac.y, ad.x, ad.y].map((item, i) => {\r\n                            if (i % 2 === 0) {\r\n                                return item / displayW * w;\r\n                            } else {\r\n                                return item / displayH * h;\r\n                            }\r\n                        })\r\n                    ).update();\r\n                    klCanvasPreview.render();\r\n                } catch(e) {\r\n                    (div as any).errorCallback(e);\r\n                }\r\n            }\r\n\r\n            function nob(x, y, callback?) {\r\n                let nobSize = 14;\r\n                let div = document.createElement(\"div\");\r\n                (div as any).x = x;\r\n                (div as any).y = y;\r\n                BB.css(div, {\r\n                    width: nobSize + \"px\",\r\n                    height: nobSize + \"px\",\r\n                    backgroundColor: \"#fff\",\r\n                    boxShadow: \"inset 0 0 0 2px #000\",\r\n                    borderRadius: nobSize + \"px\",\r\n                    position: \"absolute\",\r\n                    cursor: \"move\",\r\n                    left: ((div as any).x - nobSize / 2) + \"px\",\r\n                    top: ((div as any).y - nobSize / 2) + \"px\",\r\n                    userSelect: 'none',\r\n                });\r\n\r\n                let pointerListener = new BB.PointerListener({\r\n                    target: div,\r\n                    maxPointers: 1,\r\n                    onPointer: function(event) {\r\n                        event.eventPreventDefault();\r\n                        if (event.button === 'left' && event.type === 'pointermove') {\r\n                            (div as any).x += event.dX;\r\n                            (div as any).y += event.dY;\r\n                            div.style.left = ((div as any).x - nobSize / 2) + \"px\";\r\n                            div.style.top = ((div as any).y - nobSize / 2) + \"px\";\r\n                            if (callback) {\r\n                                callback();\r\n                            }\r\n                            update();\r\n                        }\r\n                    }\r\n                });\r\n                (div as any).copy = function (p) {\r\n                    (div as any).x = p.x;\r\n                    (div as any).y = p.y;\r\n                    div.style.left = ((div as any).x - nobSize / 2) + \"px\";\r\n                    div.style.top = ((div as any).y - nobSize / 2) + \"px\";\r\n                };\r\n                pointerListenerArr.push(pointerListener);\r\n                return div;\r\n            }\r\n\r\n            function updateAfter() {\r\n                aa.copy(ba);\r\n                ab.copy(bb);\r\n                ac.copy(bc);\r\n                ad.copy(bd);\r\n            }\r\n\r\n            ba = nob(0, 0, updateAfter);\r\n            bb = nob(displayW, 0, updateAfter);\r\n            bc = nob(displayW, displayH, updateAfter);\r\n            bd = nob(0, displayH, updateAfter);\r\n            aa = nob(0, 0);\r\n            ab = nob(displayW, 0);\r\n            ac = nob(displayW, displayH);\r\n            ad = nob(0, displayH);\r\n\r\n            let before = false;\r\n            let beforeOption = document.createElement(\"div\");\r\n            BB.setEventListener(beforeOption, 'onpointerdown', function () {\r\n                return false;\r\n            });\r\n            beforeOption.textContent = \"Before\";\r\n            beforeOption.style.width = \"150px\";\r\n            beforeOption.style.height = \"30px\";\r\n            beforeOption.style.marginLeft = isSmall ? '0' : \"100px\";\r\n            beforeOption.style.paddingTop = \"10px\";\r\n            beforeOption.style.textAlign = \"center\";\r\n            beforeOption.style.cssFloat = \"left\";\r\n            beforeOption.style.paddingBottom = \"0px\";\r\n            beforeOption.style.borderTopLeftRadius = \"10px\";\r\n            beforeOption.style.cursor = \"pointer\";\r\n            beforeOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n            beforeOption.style.backgroundSize = '8%';\r\n\r\n            let afterOption = document.createElement(\"div\");\r\n            BB.setEventListener(afterOption, 'onpointerdown', function () {\r\n                return false;\r\n            });\r\n            afterOption.textContent = \"After\";\r\n            afterOption.style.width = \"150px\";\r\n            afterOption.style.height = \"30px\";\r\n            afterOption.style.paddingTop = \"10px\";\r\n            afterOption.style.textAlign = \"center\";\r\n            afterOption.style.cssFloat = \"left\";\r\n            afterOption.style.paddingBottom = \"0px\";\r\n            afterOption.style.borderTopRightRadius = \"10px\";\r\n            afterOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\r\n            afterOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\r\n            afterOption.style.backgroundSize = '8%';\r\n            afterOption.style.backgroundColor = \"#9e9e9e\";\r\n\r\n\r\n            BB.setEventListener(beforeOption, 'onpointerover', function () {\r\n                if (before === false)\r\n                    beforeOption.style.backgroundColor = \"#ccc\";\r\n            });\r\n            BB.setEventListener(beforeOption, 'onpointerout', function () {\r\n                if (before === false)\r\n                    beforeOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n            });\r\n            BB.setEventListener(afterOption, 'onpointerover', function () {\r\n                if (before === true)\r\n                    afterOption.style.backgroundColor = \"#ccc\";\r\n            });\r\n            BB.setEventListener(afterOption, 'onpointerout', function () {\r\n                if (before === true)\r\n                    afterOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n            });\r\n\r\n            beforeOption.onclick = function () {\r\n\r\n                beforeOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\r\n                beforeOption.style.backgroundSize = '8%';\r\n                beforeOption.style.backgroundColor = \"#9e9e9e\";\r\n                beforeOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\r\n                beforeOption.style.cursor = \"default\";\r\n\r\n                afterOption.style.background = \"\";\r\n                afterOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n                afterOption.style.boxShadow = \"\";\r\n                afterOption.style.cursor = \"pointer\";\r\n\r\n                aa.style.display = \"none\";\r\n                ab.style.display = \"none\";\r\n                ac.style.display = \"none\";\r\n                ad.style.display = \"none\";\r\n\r\n                ba.style.display = \"block\";\r\n                bb.style.display = \"block\";\r\n                bc.style.display = \"block\";\r\n                bd.style.display = \"block\";\r\n                ba.copy(aa);\r\n                bb.copy(ab);\r\n                bc.copy(ac);\r\n                bd.copy(ad);\r\n                before = true;\r\n                update();\r\n            };\r\n            afterOption.onclick = function () {\r\n                before = false;\r\n\r\n                afterOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\r\n                afterOption.style.backgroundSize = '8%';\r\n                afterOption.style.backgroundColor = \"#9e9e9e\";\r\n                afterOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\r\n                afterOption.style.cursor = \"default\";\r\n\r\n                beforeOption.style.background = \"\";\r\n                beforeOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\r\n                beforeOption.style.boxShadow = \"\";\r\n                beforeOption.style.cursor = \"pointer\";\r\n\r\n                ba.style.display = \"none\";\r\n                bb.style.display = \"none\";\r\n                bc.style.display = \"none\";\r\n                bd.style.display = \"none\";\r\n\r\n                aa.style.display = \"block\";\r\n                ab.style.display = \"block\";\r\n                ac.style.display = \"block\";\r\n                ad.style.display = \"block\";\r\n                aa.copy(ba);\r\n                ab.copy(bb);\r\n                ac.copy(bc);\r\n                ad.copy(bd);\r\n            };\r\n\r\n            let optionWrapper = document.createElement(\"div\");\r\n            optionWrapper.appendChild(beforeOption);\r\n            optionWrapper.appendChild(afterOption);\r\n            div.appendChild(optionWrapper);\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            previewWrapper.oncontextmenu = function () {\r\n                return false;\r\n            };\r\n            BB.css(previewWrapper, {\r\n                width: isSmall ? '340px' : '540px',\r\n                marginLeft: \"-20px\",\r\n                height: isSmall ? '260px' : '300px',\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr = [];\r\n            {\r\n                for(let i = 0; i < layers.length; i++) {\r\n                    let canvas = i === selectedLayerIndex ? glCanvas : layers[i].context.canvas;\r\n                    previewLayerArr.push({\r\n                        canvas: canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            let klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + displayW),\r\n                height: parseInt('' + displayH),\r\n                layerArr: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + displayW) + 'px',\r\n                    height: parseInt('' + displayH) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n            previewInnerWrapper.appendChild(aa);\r\n            previewInnerWrapper.appendChild(ab);\r\n            previewInnerWrapper.appendChild(ac);\r\n            previewInnerWrapper.appendChild(ad);\r\n\r\n            ba.style.display = \"none\";\r\n            bb.style.display = \"none\";\r\n            bc.style.display = \"none\";\r\n            bd.style.display = \"none\";\r\n            previewInnerWrapper.appendChild(ba);\r\n            previewInnerWrapper.appendChild(bb);\r\n            previewInnerWrapper.appendChild(bc);\r\n            previewInnerWrapper.appendChild(bd);\r\n\r\n\r\n            div.appendChild(previewWrapper);\r\n            update();\r\n            result.destroy = () => {\r\n                for(let i = 0; i < pointerListenerArr.length; i++) {\r\n                    pointerListenerArr[i].destroy();\r\n                }\r\n                texture.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    before: [\r\n                        ba.x / displayPreviewFactor,\r\n                        ba.y / displayPreviewFactor,\r\n\r\n                        bb.x / displayPreviewFactor,\r\n                        bb.y / displayPreviewFactor,\r\n\r\n                        bc.x / displayPreviewFactor,\r\n                        bc.y / displayPreviewFactor,\r\n\r\n                        bd.x / displayPreviewFactor,\r\n                        bd.y / displayPreviewFactor,\r\n                    ],\r\n                    after: [\r\n                        aa.x / displayPreviewFactor,\r\n                        aa.y / displayPreviewFactor,\r\n\r\n                        ab.x / displayPreviewFactor,\r\n                        ab.y / displayPreviewFactor,\r\n\r\n                        ac.x / displayPreviewFactor,\r\n                        ac.y / displayPreviewFactor,\r\n\r\n                        ad.x / displayPreviewFactor,\r\n                        ad.y / displayPreviewFactor,\r\n                    ]\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1);\r\n\r\n        return result;\r\n    },\r\n\r\n    apply(params) {\r\n        let context = params.context;\r\n        let history = params.history;\r\n        let before = params.input.before;\r\n        let after = params.input.after;\r\n        if (!context || !before || !after || !history)\r\n            return false;\r\n        history.pause();\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        let w = context.canvas.width;\r\n        let h = context.canvas.height;\r\n        glCanvas.draw(texture).perspective(before, after).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"filter\", \"glPerspective\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"eFiVD\");","import {BB} from '../../bb/bb';\r\nimport {eventResMs} from './filters-consts';\r\nimport {PcSlider} from '../ui/base-components/slider';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {getSharedFx} from './shared-gl-fx';\r\n\r\nexport const glHueSaturation = {\r\n\r\n    getDialog(params) {\r\n\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height,280, 200,  1);\r\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (tempCanvas.width > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n\r\n        function finishInit() {\r\n            let hue = 0, Saturation = 0;\r\n            div.innerHTML = \"Change hue and saturation for the selected layer.<br/><br/>\";\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n\r\n            let hueSlider = new PcSlider({\r\n                label: 'Hue',\r\n                width: 300,\r\n                height: 30,\r\n                min: -100,\r\n                max: 100,\r\n                initValue: hue * 100,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    hue = val / 100;\r\n                    glCanvas.draw(texture).hueSaturation(hue, Saturation).update();\r\n                    klCanvasPreview.render();\r\n                }\r\n            });\r\n            let saturationSlider = new PcSlider({\r\n                label: 'Saturation',\r\n                width: 300,\r\n                height: 30,\r\n                min: 0,\r\n                max: 100,\r\n                initValue: (Saturation + 1) * 50,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    Saturation = val / 50 - 1;\r\n                    glCanvas.draw(texture).hueSaturation(hue, Saturation).update();\r\n                    klCanvasPreview.render();\r\n                }\r\n            });\r\n            hueSlider.getElement().style.marginBottom = \"10px\";\r\n            div.appendChild(hueSlider.getElement());\r\n            div.appendChild(saturationSlider.getElement());\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            BB.css(previewWrapper, {\r\n                width: \"340px\",\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr = [];\r\n            {\r\n                for(let i = 0; i < layers.length; i++) {\r\n                    previewLayerArr.push({\r\n                        canvas: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            let klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + w),\r\n                height: parseInt('' + h),\r\n                layerArr: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + w) + 'px',\r\n                    height: parseInt('' + h) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n\r\n            div.appendChild(previewWrapper);\r\n\r\n            try {\r\n                glCanvas.draw(texture).hueSaturation(hue, Saturation).update();\r\n                klCanvasPreview.render();\r\n            } catch(e) {\r\n                (div as any).errorCallback(e);\r\n            }\r\n\r\n            result.destroy = () => {\r\n                hueSlider.destroy();\r\n                saturationSlider.destroy();\r\n                texture.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    hue: hue,\r\n                    Saturation: Saturation\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1);\r\n        return result;\r\n    },\r\n\r\n    apply(params) {\r\n        let context = params.context;\r\n        let hue = params.input.hue;\r\n        let history = params.history;\r\n        let Saturation = params.input.Saturation;\r\n        if (!context || hue === null || Saturation === null || !history)\r\n            return false;\r\n        history.pause();\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).hueSaturation(hue, Saturation).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"filter\", \"glHueSaturation\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {getSharedFx} from './shared-gl-fx';\r\n\r\nexport const invert = {\r\n\r\n    apply(params) {\r\n        let context = params.context;\r\n        let history = params.history;\r\n        if (!context || !history) {\r\n            return false;\r\n        }\r\n        history.pause();\r\n\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false;\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).invert().update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"filter\", \"invert\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {Select} from '../ui/base-components/select';\r\n// @ts-ignore\r\nimport constrainImg from 'url:~/src/app/img/ui/constrain.svg';\r\n\r\nexport const resize = {\r\n\r\n    getDialog(params) {\r\n        //BB.centerWithin\r\n        let canvas = params.canvas;\r\n        if (!canvas)\r\n            return false;\r\n\r\n        let fit = BB.fitInto( canvas.width, canvas.height, 280, 200,1);\r\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n\r\n        let previewFactor = w / canvas.width;\r\n        let tempCanvas = canvas.getCompleteCanvas(1);\r\n\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n        let newWidth = canvas.width, newHeight = canvas.height;\r\n\r\n        div.innerHTML = \"Resizes the image.<br/><br/>\";\r\n\r\n\r\n        let maxWidth = params.maxWidth, maxHeight = params.maxHeight;\r\n\r\n        let widthWrapper = document.createElement(\"div\");\r\n        let heightWrapper = document.createElement(\"div\");\r\n        let widthInput = document.createElement(\"input\");\r\n        let heightInput = document.createElement(\"input\");\r\n        widthInput.style.cssFloat = \"right\";\r\n        widthInput.style.width = \"90px\";\r\n        widthWrapper.style.width = \"150px\";\r\n        widthWrapper.style.height = \"35px\";\r\n        widthWrapper.style.lineHeight = \"30px\";\r\n        heightInput.style.cssFloat = \"right\";\r\n        heightInput.style.width = \"90px\";\r\n        heightWrapper.style.width = \"150px\";\r\n        heightWrapper.style.height = \"35px\";\r\n        heightWrapper.style.lineHeight = \"30px\";\r\n        if (navigator.appName != 'Microsoft Internet Explorer')\r\n            widthInput.type = \"number\";\r\n        widthInput.min = '1';\r\n        widthInput.max = maxWidth;\r\n        if (navigator.appName != 'Microsoft Internet Explorer')\r\n            heightInput.type = \"number\";\r\n        heightInput.min = '1';\r\n        heightInput.max = maxHeight;\r\n        widthInput.value = canvas.width;\r\n        heightInput.value = canvas.height;\r\n        widthInput.onclick = function () {\r\n            (this as any).focus();\r\n            widthChanged = true;\r\n            update();\r\n        };\r\n        heightInput.onclick = function () {\r\n            (this as any).focus();\r\n            heightChanged = true;\r\n            update();\r\n        };\r\n        widthInput.onchange = function () {\r\n            widthChanged = true;\r\n            update();\r\n        };\r\n        heightInput.onchange = function () {\r\n            heightChanged = true;\r\n            update();\r\n        };\r\n        /*widthInput.onkeyup = function () {\r\n            widthChanged = true;\r\n            update();\r\n        };\r\n        heightInput.onkeyup = function () {\r\n            heightChanged = true;\r\n            update();\r\n        };*/\r\n        widthWrapper.append(\"Width: \");\r\n        widthWrapper.appendChild(widthInput);\r\n        heightWrapper.append(\"Height: \");\r\n        heightWrapper.appendChild(heightInput);\r\n        let inputWrapper = document.createElement(\"div\");\r\n        inputWrapper.style.background = \"url(\" + constrainImg + \") no-repeat 140px 5px\";\r\n        inputWrapper.style.backgroundSize = '50px 52px';\r\n        inputWrapper.appendChild(widthWrapper);\r\n        inputWrapper.appendChild(heightWrapper);\r\n        div.appendChild(inputWrapper);\r\n\r\n        //contrain checkbox\r\n        let heightChanged = false, widthChanged = false;\r\n        let ratio = canvas.width / canvas.height;\r\n\r\n        function updateConstrain() {\r\n            if (isConstrained) {\r\n                widthInput.value = canvas.width;\r\n                heightInput.value = canvas.height;\r\n                inputWrapper.style.background = \"url(\" + constrainImg + \") no-repeat 140px 5px\";\r\n                inputWrapper.style.backgroundSize = '50px 52px';\r\n                update();\r\n            } else {\r\n                inputWrapper.style.background = \"\";\r\n            }\r\n        }\r\n\r\n        let isConstrained = true;\r\n        let constrainCheckbox = new Checkbox({\r\n            init: true,\r\n            label: 'Constrain Proportions',\r\n            allowTab: true,\r\n            callback: function(b) {\r\n                isConstrained = b;\r\n                updateConstrain();\r\n            }\r\n        });\r\n        div.appendChild(BB.el({\r\n            css: {\r\n                clear: 'both'\r\n            }\r\n        }));\r\n\r\n\r\n        let algorithmSelect = new Select({\r\n            isFocusable: true,\r\n            optionArr: [\r\n                ['smooth', 'Smooth'],\r\n                ['pixelated', 'Pixelated']\r\n            ],\r\n            title: 'Scaling algorithm',\r\n            initValue: 'smooth',\r\n            onChange: function() {\r\n                update();\r\n            },\r\n        });\r\n\r\n        let secondRowElement = BB.el({\r\n            parent: div,\r\n            css: {\r\n                display: 'flex',\r\n                justifyContent: 'space-between'\r\n            }\r\n        });\r\n        secondRowElement.appendChild(constrainCheckbox.getElement());\r\n        secondRowElement.appendChild(algorithmSelect.getElement());\r\n\r\n        let previewCanvas = BB.canvas();\r\n        previewCanvas.width = w;\r\n        previewCanvas.height = h;\r\n        previewCanvas.style.imageRendering = 'pixelated';\r\n\r\n\r\n        let previewCtx = previewCanvas.getContext('2d');\r\n\r\n\r\n        function draw() {\r\n            if(algorithmSelect.getValue() === 'smooth') {\r\n                previewCanvas.style.imageRendering = previewFactor > 1 ? 'pixelated' : '';\r\n\r\n                previewCanvas.width = canvas.width;\r\n                previewCanvas.height = canvas.height;\r\n\r\n                previewCtx.save();\r\n                previewCtx.imageSmoothingQuality = 'high';\r\n                previewCtx.drawImage(tempCanvas, 0, 0);\r\n                BB.resizeCanvas(previewCanvas, newWidth, newHeight);\r\n                previewCtx.restore();\r\n\r\n            } else {\r\n                previewCanvas.style.imageRendering = 'pixelated';\r\n\r\n                previewCanvas.width = newWidth;\r\n                previewCanvas.height = newHeight;\r\n                previewCtx.save();\r\n                previewCtx.imageSmoothingEnabled = false;\r\n                previewCtx.drawImage(tempCanvas, 0, 0, previewCanvas.width, previewCanvas.height);\r\n                previewCtx.restore();\r\n            }\r\n\r\n        }\r\n\r\n        function update() {\r\n            if ((widthInput.value.length === 0 && widthChanged) || (heightInput.value.length === 0 && heightChanged)) {\r\n                heightChanged = false;\r\n                widthChanged = false;\r\n                return;\r\n            }\r\n            widthInput.value = '' + Math.max(1, parseInt(widthInput.value));\r\n            heightInput.value = '' + Math.max(1, parseInt(heightInput.value));\r\n            if (isConstrained) {\r\n                if (heightChanged) {\r\n                    widthInput.value = '' + parseInt('' + (parseInt(heightInput.value) * ratio));\r\n                }\r\n                if (widthChanged) {\r\n                    heightInput.value = '' + parseInt('' + (parseInt(widthInput.value) / ratio));\r\n                }\r\n\r\n                if (widthInput.value > maxWidth || heightInput.value > maxHeight) {\r\n                    let fit = BB.fitInto(parseInt(widthInput.value), parseInt(heightInput.value), maxWidth, maxHeight, 1);\r\n                    widthInput.value = '' + parseInt('' + fit.width);\r\n                    heightInput.value = '' + parseInt('' + fit.height);\r\n                }\r\n            }\r\n\r\n            if (widthInput.value > maxWidth)\r\n                widthInput.value = maxWidth;\r\n            if (heightInput.value > maxHeight)\r\n                heightInput.value = maxHeight;\r\n\r\n            heightChanged = false;\r\n            widthChanged = false;\r\n\r\n            newWidth = widthInput.value;\r\n            newHeight = heightInput.value;\r\n\r\n            let preview = BB.fitInto(newWidth, newHeight, 280, 200, 1);\r\n            let previewW = parseInt('' + preview.width), previewH = parseInt('' + preview.height);\r\n            previewFactor = previewW / newWidth;\r\n\r\n            let offset = BB.centerWithin(340, 220, previewW, previewH);\r\n\r\n            draw();\r\n\r\n            previewCanvas.style.width = Math.max(1, previewW) + \"px\";\r\n            previewCanvas.style.height = Math.max(1, previewH) + \"px\";\r\n            canvasWrapper.style.left = offset.x + \"px\";\r\n            canvasWrapper.style.top = offset.y + \"px\";\r\n            canvasWrapper.style.width = Math.max(1, previewW) + \"px\";\r\n            canvasWrapper.style.height = Math.max(1, previewH) + \"px\";\r\n        }\r\n\r\n        let previewWrapper = document.createElement(\"div\");\r\n        BB.css(previewWrapper, {\r\n            width: \"340px\",\r\n            marginLeft: \"-20px\",\r\n            height: \"220px\",\r\n            display: \"table\",\r\n            backgroundColor: \"#9e9e9e\",\r\n            marginTop: \"10px\",\r\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n            position: \"relative\",\r\n            userSelect: 'none',\r\n            colorScheme: 'only light',\r\n        });\r\n\r\n\r\n        let canvasWrapper = BB.appendTextDiv(previewWrapper, \"\");\r\n        canvasWrapper.appendChild(previewCanvas);\r\n        canvasWrapper.style.width = w + \"px\";\r\n        canvasWrapper.style.height = h + \"px\";\r\n        canvasWrapper.style.position = \"absolute\";\r\n        canvasWrapper.style.overflow = \"hidden\";\r\n        canvasWrapper.style.boxShadow = \"0 0 5px rgba(0,0,0,0.8)\";\r\n        canvasWrapper.style.overflow = \"hidden\";\r\n        BB.createCheckerDataUrl(8, function (url) {\r\n            previewWrapper.style.background = \"url(\" + url + \")\";\r\n        });\r\n\r\n        div.appendChild(previewWrapper);\r\n        update();\r\n\r\n        result.destroy = () => {\r\n            constrainCheckbox.destroy();\r\n        };\r\n        result.getInput = function () {\r\n            result.destroy();\r\n            return {\r\n                width: newWidth,\r\n                height: newHeight,\r\n                algorithm: algorithmSelect.getValue()\r\n            };\r\n        };\r\n        return result;\r\n    },\r\n\r\n    apply(params) {\r\n        let canvas = params.canvas;\r\n        let history = params.history;\r\n        let width = params.input.width;\r\n        let height = params.input.height;\r\n        let algorithm = params.input.algorithm;\r\n        if (!canvas || !history) {\r\n            return false;\r\n        }\r\n        history.pause();\r\n        canvas.resize(width, height, algorithm);\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"filter\", \"resize\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {eventResMs} from './filters-consts';\r\nimport {PcSlider} from '../ui/base-components/slider';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {getSharedFx} from './shared-gl-fx';\r\n\r\nexport const glTiltShift = {\r\n\r\n    getDialog(params) {\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\r\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\r\n        let w = Math.min(displayW, context.canvas.width);\r\n        let h = Math.min(displayH, context.canvas.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (w > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n        let previewFactor = w / context.canvas.width;\r\n        let displayPreviewFactor = displayW / context.canvas.width;\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n\r\n        let pointerListenerArr = [];\r\n\r\n        function finishInit() {\r\n            let blur = 20, gradient = 200;\r\n            div.innerHTML = \"Applies tilt shift on the selected layer.<br/><br/>\";\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n            let fa, fb; // focus line\r\n            function update() {\r\n                try {\r\n                    glCanvas.draw(texture).tiltShift(\r\n                        fa.x / displayPreviewFactor * previewFactor,\r\n                        fa.y / displayPreviewFactor * previewFactor,\r\n                        fb.x / displayPreviewFactor * previewFactor,\r\n                        fb.y / displayPreviewFactor * previewFactor,\r\n                        blur * previewFactor,\r\n                        gradient * previewFactor\r\n                    ).update();\r\n                    klCanvasPreview.render();\r\n                } catch(e) {\r\n                    (div as any).errorCallback(e);\r\n                }\r\n            }\r\n\r\n            function nob(x, y) {\r\n                let nobSize = 14;\r\n                let div = document.createElement(\"div\");\r\n                (div as any).x = x;\r\n                (div as any).y = y;\r\n                div.style.width = nobSize + \"px\";\r\n                div.style.height = nobSize + \"px\";\r\n                div.style.backgroundColor = \"#fff\";\r\n                div.style.boxShadow = \"inset 0 0 0 2px #000\";\r\n                div.style.borderRadius = nobSize + \"px\";\r\n                div.style.position = \"absolute\";\r\n                div.style.cursor = \"move\";\r\n                div.style.left = (x - nobSize / 2) + \"px\";\r\n                div.style.top = (y - nobSize / 2) + \"px\";\r\n                BB.css(div, {\r\n                    userSelect: 'none'\r\n                });\r\n                let pointerListener = new BB.PointerListener({\r\n                    target: div,\r\n                    maxPointers: 1,\r\n                    onPointer: function(event) {\r\n                        event.eventPreventDefault();\r\n                        if (event.button === 'left' && event.type === 'pointermove') {\r\n                            (div as any).x += event.dX;\r\n                            (div as any).y += event.dY;\r\n                            div.style.left = ((div as any).x - nobSize / 2) + \"px\";\r\n                            div.style.top = ((div as any).y - nobSize / 2) + \"px\";\r\n                            update();\r\n                        }\r\n                    }\r\n                });\r\n                pointerListenerArr.push(pointerListener);\r\n                return div;\r\n            }\r\n\r\n            fa = nob(parseInt('' + (displayW / 6)), parseInt('' + (displayH / 2)));\r\n            fb = nob(parseInt('' + (displayW - displayW / 6)), parseInt('' + (displayH - displayH / 3)));\r\n\r\n            let blurSlider = new PcSlider({\r\n                label: 'Blur Radius',\r\n                width: 300,\r\n                height: 30,\r\n                min: 0,\r\n                max: 200,\r\n                initValue: blur,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    blur = val;\r\n                    update();\r\n                }\r\n            });\r\n            blurSlider.getElement().style.marginBottom = \"10px\";\r\n            div.appendChild(blurSlider.getElement());\r\n            let gradientSlider = new PcSlider({\r\n                label: 'Gradient Radius',\r\n                width: 300,\r\n                height: 30,\r\n                min: 0,\r\n                max: 1000,\r\n                initValue: gradient,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    gradient = val;\r\n                    update();\r\n                }\r\n            });\r\n            div.appendChild(gradientSlider.getElement());\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            previewWrapper.oncontextmenu = function () {\r\n                return false;\r\n            };\r\n            BB.css(previewWrapper, {\r\n                width: \"340px\",\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr = [];\r\n            {\r\n                for(let i = 0; i < layers.length; i++) {\r\n                    previewLayerArr.push({\r\n                        canvas: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            let klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + displayW),\r\n                height: parseInt('' + displayH),\r\n                layerArr: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + displayW) + 'px',\r\n                    height: parseInt('' + displayH) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n            previewInnerWrapper.appendChild(fa);\r\n            previewInnerWrapper.appendChild(fb);\r\n\r\n\r\n            div.appendChild(previewWrapper);\r\n            update();\r\n            result.destroy = () => {\r\n                for(let i = 0; i < pointerListenerArr.length; i++) {\r\n                    pointerListenerArr[i].destroy();\r\n                }\r\n                blurSlider.destroy();\r\n                gradientSlider.destroy();\r\n                texture.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    a: {x: fa.x / displayPreviewFactor, y: fa.y / displayPreviewFactor},\r\n                    b: {x: fb.x / displayPreviewFactor, y: fb.y / displayPreviewFactor},\r\n                    blur: blur,\r\n                    gradient: gradient\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1);\r\n\r\n\r\n        return result;\r\n    },\r\n\r\n    apply(params) {\r\n        let context = params.context;\r\n        let history = params.history;\r\n        let a = params.input.a;\r\n        let b = params.input.b;\r\n        let blur = params.input.blur;\r\n        let gradient = params.input.gradient;\r\n        if (!context || !history)\r\n            return false;\r\n        history.pause();\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        let w = context.canvas.width;\r\n        let h = context.canvas.height;\r\n        glCanvas.draw(texture).tiltShift(a.x, a.y, b.x, b.y, blur, gradient).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"filter\", \"glTiltShift\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {BB} from '../../bb/bb';\r\n\r\nexport const rotate = {\r\n\r\n    getDialog(params) {\r\n        let canvas = params.canvas;\r\n        if (!canvas)\r\n            return false;\r\n\r\n        let fit = BB.fitInto(canvas.width, canvas.height, 280, 200, 1);\r\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n\r\n        let previewFactor = w / canvas.width;\r\n        let tempCanvas = BB.canvas();\r\n        tempCanvas.width = w;\r\n        tempCanvas.height = h;\r\n        tempCanvas.style.display = 'block';\r\n        tempCanvas.getContext(\"2d\").drawImage(canvas.getCompleteCanvas(previewFactor), 0, 0, w, h);\r\n\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n        let deg = 0;\r\n        div.innerHTML = \"Rotates the image.<br/><br/>\";\r\n\r\n        let first = true;\r\n\r\n        function update() {\r\n            (canvasWrapper.style as any).WebkitTransform = \"rotate(\" + deg + \"deg)\";\r\n            (canvasWrapper.style as any).MozTransform = \"rotate(\" + deg + \"deg)\";\r\n            (canvasWrapper.style as any).OTransform = \"rotate(\" + deg + \"deg)\";\r\n            (canvasWrapper.style as any).msTransform = \"rotate(\" + deg + \"deg)\";\r\n            if (Math.abs(deg % 180) === 90) {\r\n                //height has to fit width because of rotation\r\n                let fit = BB.fitInto(h, w, 280, 200, 1);\r\n                let scale = parseInt('' + fit.height) / w;\r\n                (canvasWrapper.style as any).WebkitTransform = \"rotate(\" + deg + \"deg) scale(\" + scale + \")\";\r\n                (canvasWrapper.style as any).MozTransform = \"rotate(\" + deg + \"deg) scale(\" + scale + \")\";\r\n                (canvasWrapper.style as any).OTransform = \"rotate(\" + deg + \"deg) scale(\" + scale + \")\";\r\n                (canvasWrapper.style as any).msTransform = \"rotate(\" + deg + \"deg) scale(\" + scale + \")\";\r\n            }\r\n        }\r\n\r\n        let btnPlus = document.createElement(\"button\");\r\n        btnPlus.innerHTML = \"<span style='font-size: 1.3em'>⟳</span> 90°\";\r\n        let btnMinus = document.createElement(\"button\");\r\n        btnMinus.innerHTML = \"<span style='font-size: 1.3em'>⟲</span> 90°\";\r\n        btnMinus.style.marginRight = '5px';\r\n\r\n\r\n        btnPlus.onclick = function () {\r\n            deg += 90;\r\n            update();\r\n        };\r\n        btnMinus.onclick = function () {\r\n            deg -= 90;\r\n            update();\r\n        };\r\n\r\n        div.appendChild(btnMinus);\r\n        div.appendChild(btnPlus);\r\n\r\n        let previewWrapper = document.createElement(\"div\");\r\n        BB.css(previewWrapper, {\r\n            width: \"340px\",\r\n            marginLeft: \"-20px\",\r\n            height: \"220px\",\r\n            display: \"table\",\r\n            backgroundColor: \"#9e9e9e\",\r\n            marginTop: \"10px\",\r\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n            overflow: \"hidden\",\r\n            position: \"relative\",\r\n            userSelect: 'none',\r\n            colorScheme: 'only light',\r\n        });\r\n\r\n        let previewcell = document.createElement(\"div\");\r\n        previewcell.style.display = \"table-cell\";\r\n        previewcell.style.verticalAlign = \"middle\";\r\n        let canvasWrapper = BB.appendTextDiv(previewcell, \"\");\r\n        canvasWrapper.appendChild(tempCanvas);\r\n        previewWrapper.appendChild(previewcell);\r\n        canvasWrapper.style.width = w + \"px\";\r\n        canvasWrapper.style.height = h + \"px\";\r\n        canvasWrapper.style.marginLeft = \"auto\";\r\n        canvasWrapper.style.marginRight = \"auto\";\r\n        canvasWrapper.style.boxShadow = \"0 0 5px rgba(0,0,0,0.8)\";\r\n        canvasWrapper.style.overflow = \"hidden\";\r\n        BB.createCheckerDataUrl(4, function (url) {\r\n            canvasWrapper.style.background = \"url(\" + url + \")\";\r\n        });\r\n        //if(!visitor.chrome) {\r\n        canvasWrapper.style.transition = \"all 0.2s ease-out\";\r\n        //}\r\n\r\n        div.appendChild(previewWrapper);\r\n        update();\r\n\r\n        result.getInput = function () {\r\n            return {\r\n                deg: deg\r\n            };\r\n        };\r\n        return result;\r\n    },\r\n\r\n    apply(params) {\r\n        let canvas = params.canvas;\r\n        let history = params.history;\r\n        let deg = params.input.deg;\r\n        if (!canvas || !history)\r\n            return false;\r\n        history.pause();\r\n        canvas.rotate(deg);\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"filter\", \"rotate\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","module.exports = require('./helpers/bundle-url').getBundleURL('dafOa') + require('./helpers/bundle-manifest').resolve(\"2BZYe\");","import {BB} from '../../bb/bb';\r\nimport {Checkbox} from '../ui/base-components/checkbox';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {FreeTransform, ITransform} from '../ui/components/free-transform';\r\nimport {Select} from '../ui/base-components/select';\r\n\r\ninterface IFilterTransformInput {\r\n    bounds: {x: number, y: number, width: number, height: number};\r\n    transform: ITransform;\r\n    isPixelated: boolean;\r\n}\r\n\r\nexport const transform = {\r\n\r\n    getDialog(params) {\r\n        let i;\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let isSmall = window.innerWidth < 550;\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, isSmall ? 280 : 490, isSmall ? 200 : 240, 1);\r\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\r\n        let w = Math.min(displayW, context.canvas.width);\r\n        let h = Math.min(displayH, context.canvas.height);\r\n        let freeTransform: FreeTransform;\r\n        let displayPreviewFactor = displayW / context.canvas.width;\r\n\r\n        // determine bounds and initial transformation\r\n        let boundsObj: {\r\n            x: number;\r\n            y: number;\r\n            width: number;\r\n            height: number;\r\n        } = { x: 0, y: 0, width: 0, height: 0 };\r\n        {\r\n            let tempBounds: any = {\r\n                x1: null,\r\n                y1: null,\r\n                x2: null,\r\n                y2: null\r\n            };\r\n            let imdat = context.getImageData(0, 0, context.canvas.width, context.canvas.height);\r\n\r\n            if (imdat.data[3] > 0 && imdat.data[imdat.data.length - 1] > 0) {\r\n                tempBounds.x1 = 0;\r\n                tempBounds.y1 = 0;\r\n                tempBounds.x2 = context.canvas.width - 1;\r\n                tempBounds.y2 = context.canvas.height - 1;\r\n            } else {\r\n                for (i = 3; i < imdat.data.length; i += 4) {\r\n                    if (imdat.data[i] > 0 ) {\r\n                        let x = ((i - 3) / 4) %  context.canvas.width;\r\n                        let y = Math.floor((i - 3) / 4 / context.canvas.width);\r\n                        if (tempBounds.x1 > x || tempBounds.x1 === null) {\r\n                            tempBounds.x1 = x;\r\n                        }\r\n                        if (tempBounds.y1 === null) {\r\n                            tempBounds.y1 = y;\r\n                        }\r\n                        if (tempBounds.x2 < x || tempBounds.x2 === null) {\r\n                            tempBounds.x2 = x;\r\n                        }\r\n                        if (tempBounds.y2 < y || tempBounds.y2 === null) {\r\n                            tempBounds.y2 = y;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (tempBounds.x1 === null || tempBounds.y1 === null) {\r\n                alert('Layer is empty.');\r\n                return false;\r\n            }\r\n            boundsObj.x = tempBounds.x1;\r\n            boundsObj.y = tempBounds.y1;\r\n            boundsObj.width = tempBounds.x2 - tempBounds.x1 + 1;\r\n            boundsObj.height = tempBounds.y2 - tempBounds.y1 + 1;\r\n        }\r\n\r\n        const initTransform = {\r\n            x: boundsObj.x + boundsObj.width / 2,\r\n            y: boundsObj.y + boundsObj.height / 2,\r\n            width: boundsObj.width,\r\n            height: boundsObj.height,\r\n            angleDeg: 0,\r\n        };\r\n\r\n\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n        if (!isSmall) {\r\n            result.width = 500;\r\n        }\r\n        div.innerHTML = \"Transforms selected layer. Hold Shift for additional behavior.\";\r\n\r\n        let keyListener = new BB.KeyListener({\r\n            onDown: function(keyStr) {\r\n                if(BB.isInputFocused(true)) {\r\n                    return;\r\n                }\r\n\r\n                if (keyStr === 'left') {\r\n                    inputX.value = '' + (parseFloat(inputX.value) - 1);\r\n                    onInputsChanged();\r\n                }\r\n                if (keyStr === 'right') {\r\n                    inputX.value = '' + (parseFloat(inputX.value) + 1);\r\n                    onInputsChanged();\r\n                }\r\n                if (keyStr === 'up') {\r\n                    inputY.value = '' + (parseFloat(inputY.value) - 1);\r\n                    onInputsChanged();\r\n                }\r\n                if (keyStr === 'down') {\r\n                    inputY.value = '' + (parseFloat(inputY.value) + 1);\r\n                    onInputsChanged();\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        let leftWrapper = document.createElement(\"div\");\r\n        let rightWrapper = document.createElement(\"div\");\r\n        let rotWrapper = document.createElement(\"div\");\r\n        let inputY = document.createElement(\"input\");\r\n        let inputX = document.createElement(\"input\");\r\n        let inputR = document.createElement(\"input\");\r\n        leftWrapper.style.width = \"100px\";\r\n        leftWrapper.style.height = \"30px\";\r\n        rightWrapper.style.width = \"100px\";\r\n        rightWrapper.style.height = \"30px\";\r\n        rightWrapper.style.display = \"inline-block\";\r\n        leftWrapper.style.display = \"inline-block\";\r\n        rotWrapper.style.display = \"inline-block\";\r\n        rotWrapper.style.width = \"150px\";\r\n        rotWrapper.style.height = \"30px\";\r\n        inputY.type = \"number\";\r\n        inputX.type = \"number\";\r\n        inputR.type = \"number\";\r\n        inputX.style.width = 70 + \"px\";\r\n        inputY.style.width = 70 + \"px\";\r\n        inputR.style.width = 70 + \"px\";\r\n        inputY.value = '0';\r\n        inputX.value = '0';\r\n        inputR.value = '0';\r\n        inputY.onclick = function () {\r\n            (this as any).focus();\r\n            onInputsChanged();\r\n        };\r\n        inputX.onclick = function () {\r\n            (this as any).focus();\r\n            onInputsChanged();\r\n        };\r\n        inputR.onclick = function () {\r\n            (this as any).focus();\r\n            onInputsChanged();\r\n        };\r\n        inputY.onchange = function () {\r\n            onInputsChanged();\r\n        };\r\n        inputX.onchange = function () {\r\n            onInputsChanged();\r\n        };\r\n        inputR.onchange = function () {\r\n            onInputsChanged();\r\n        };\r\n        inputY.onkeyup = function () {\r\n            onInputsChanged();\r\n        };\r\n        inputX.onkeyup = function () {\r\n            onInputsChanged();\r\n        };\r\n        inputR.onkeyup = function () {\r\n            onInputsChanged();\r\n        };\r\n        leftWrapper.append(\"X: \", inputX);\r\n        rightWrapper.append(\"Y: \", inputY);\r\n        rotWrapper.append('Rotation: ', inputR);\r\n        if (!isSmall) {\r\n            const inputRow = BB.el({\r\n                parent: div,\r\n                css: {\r\n                    marginTop: '10px',\r\n                }\r\n            });\r\n            inputRow.append(leftWrapper, rightWrapper, rotWrapper);\r\n        }\r\n\r\n        // buttons\r\n        const actionBtnCss = {\r\n            marginLeft: '10px',\r\n            marginTop: '10px',\r\n        };\r\n        const buttonRow = BB.el ({\r\n            parent: div,\r\n            css: {\r\n                display: 'flex',\r\n                flexWrap: 'wrap',\r\n                marginLeft: '-10px',\r\n            }\r\n        });\r\n        const flipXBtn = BB.el ({\r\n            parent: buttonRow,\r\n            tagName: 'button',\r\n            content: 'Flip X',\r\n            onClick: () => {\r\n                const t = freeTransform.getTransform();\r\n                freeTransform.setSize(-t.width, t.height);\r\n            },\r\n            css: actionBtnCss,\r\n        });\r\n        const flipYBtn = BB.el ({\r\n            parent: buttonRow,\r\n            tagName: 'button',\r\n            content: 'Flip Y',\r\n            onClick: () => {\r\n                const t = freeTransform.getTransform();\r\n                freeTransform.setSize(t.width, -t.height);\r\n            },\r\n            css: actionBtnCss,\r\n        });\r\n        const scaleRotLeftBtn = BB.el ({\r\n            parent: buttonRow,\r\n            tagName: 'button',\r\n            content: '-90°',\r\n            onClick: () => {\r\n                const t = freeTransform.getTransform();\r\n                t.angleDeg -= 90;\r\n                t.angleDeg %= 360;\r\n                freeTransform.setAngleDeg(t.angleDeg);\r\n                inputR.value = '' + Math.round(t.angleDeg);\r\n                updatePreview();\r\n            },\r\n            css: actionBtnCss,\r\n        });\r\n        const scaleRotRightBtn = BB.el ({\r\n            parent: buttonRow,\r\n            tagName: 'button',\r\n            content: '+90°',\r\n            onClick: () => {\r\n                const t = freeTransform.getTransform();\r\n                t.angleDeg += 90;\r\n                t.angleDeg %= 360;\r\n                freeTransform.setAngleDeg(t.angleDeg);\r\n                inputR.value = '' + Math.round(t.angleDeg);\r\n                updatePreview();\r\n            },\r\n            css: actionBtnCss,\r\n        });\r\n        const scaleDoubleBtn = BB.el ({\r\n            parent: buttonRow,\r\n            tagName: 'button',\r\n            content: '2x',\r\n            onClick: () => {\r\n                const t = freeTransform.getTransform();\r\n                if (constrainCheckbox.getValue()) {\r\n                    freeTransform.setSize(freeTransform.getRatio() * t.height * 2, t.height * 2);\r\n                } else {\r\n                    freeTransform.setSize(t.width * 2, t.height * 2);\r\n                }\r\n            },\r\n            css: actionBtnCss,\r\n        });\r\n        const scaleHalfBtn = BB.el ({\r\n            parent: buttonRow,\r\n            tagName: 'button',\r\n            content: '1/2x',\r\n            onClick: () => {\r\n                const t = freeTransform.getTransform();\r\n                freeTransform.setSize(Math.round(t.width / 2), Math.round(t.height / 2));\r\n            },\r\n            css: actionBtnCss,\r\n        });\r\n        const centerBtn = BB.el ({\r\n            parent: buttonRow,\r\n            tagName: 'button',\r\n            content: 'Center',\r\n            onClick: () => {\r\n                const t = freeTransform.getTransform();\r\n                freeTransform.setPos({ x: context.canvas.width / 2, y: context.canvas.height / 2 });\r\n                freeTransform.setAngleDeg(t.angleDeg);\r\n                updatePreview();\r\n            },\r\n            css: actionBtnCss,\r\n        });\r\n\r\n\r\n\r\n\r\n\r\n        let isConstrained = true;\r\n        let constrainCheckbox = new Checkbox({\r\n            init: true,\r\n            label: 'Constrain',\r\n            title: 'Constrain proportions',\r\n            allowTab: true,\r\n            callback: function(b) {\r\n                isConstrained = b;\r\n                freeTransform.setConstrained(isConstrained);\r\n            },\r\n            css: {\r\n                display: 'inline-block'\r\n            }\r\n        });\r\n        let isSnapping = false;\r\n        let snappingCheckbox = new Checkbox({\r\n            init: true,\r\n            label: 'Snap',\r\n            title: 'Snap rotation and position',\r\n            allowTab: true,\r\n            callback: function(b) {\r\n                isSnapping = b;\r\n                freeTransform.setSnapping(isSnapping);\r\n            },\r\n            css: {\r\n                display: 'inline-block',\r\n                marginLeft: '10px',\r\n            }\r\n        });\r\n        const checkboxWrapper = BB.el({});\r\n        checkboxWrapper.append(constrainCheckbox.getElement(), snappingCheckbox.getElement());\r\n\r\n        div.appendChild(BB.el({\r\n            css: {\r\n                clear: 'both',\r\n                height: '10px'\r\n            }\r\n        }));\r\n\r\n        const bottomRow = BB.el({\r\n            parent: div,\r\n            css: {\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n            }\r\n        });\r\n\r\n        let algorithmSelect = new Select({\r\n            isFocusable: true,\r\n            optionArr: [\r\n                ['smooth', 'Smooth'],\r\n                ['pixelated', 'Pixelated']\r\n            ],\r\n            initValue: 'smooth',\r\n            title: 'Scaling algorithm',\r\n            onChange: function() {\r\n                updatePreview(true);\r\n            },\r\n        });\r\n        bottomRow.append(checkboxWrapper, algorithmSelect.getElement());\r\n\r\n\r\n        let previewWrapper = document.createElement(\"div\");\r\n        previewWrapper.oncontextmenu = function () {\r\n            return false;\r\n        };\r\n        BB.css(previewWrapper, {\r\n            width: isSmall ? '340px' : '540px',\r\n            marginLeft: \"-20px\",\r\n            height: isSmall ? '260px' : '300px',\r\n            backgroundColor: \"#9e9e9e\",\r\n            marginTop: \"10px\",\r\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n            overflow: \"hidden\",\r\n            position: \"relative\",\r\n            userSelect: 'none',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            colorScheme: 'only light',\r\n        });\r\n\r\n        let previewLayerArr = [];\r\n        {\r\n            for(let i = 0; i < layers.length; i++) {\r\n                let canvas;\r\n                if (i === selectedLayerIndex) {\r\n                    canvas = BB.canvas(parseInt('' + w), parseInt('' + h));\r\n                    let ctx = canvas.getContext('2d');\r\n                    ctx.drawImage(layers[i].context.canvas, 0, 0, canvas.width, canvas.height);\r\n                } else {\r\n                    canvas = layers[i].context.canvas;\r\n                }\r\n                previewLayerArr.push({\r\n                    canvas: canvas,\r\n                    opacity: layers[i].opacity,\r\n                    mixModeStr: layers[i].mixModeStr\r\n                });\r\n            }\r\n        }\r\n        let klCanvasPreview = new KlCanvasPreview({\r\n            width: parseInt('' + displayW),\r\n            height: parseInt('' + displayH),\r\n            layerArr: previewLayerArr\r\n        });\r\n\r\n        let previewInnerWrapper = BB.el({\r\n            css: {\r\n                position: 'relative',\r\n                boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                width: parseInt('' + displayW) + 'px',\r\n                height: parseInt('' + displayH) + 'px'\r\n            }\r\n        });\r\n        previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n        previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n        let lastDrawnTransformStr;\r\n        function updatePreview(doForce: boolean = false) {\r\n            if(!freeTransform) {\r\n                return;\r\n            }\r\n            let transform = freeTransform.getTransform();\r\n            if (JSON.stringify(transform) === lastDrawnTransformStr && !doForce) {\r\n                return;\r\n            }\r\n            lastDrawnTransformStr = JSON.stringify(transform);\r\n            if (displayPreviewFactor < 1) {\r\n                transform.x *= displayPreviewFactor;\r\n                transform.y *= displayPreviewFactor;\r\n                transform.width *= displayPreviewFactor;\r\n                transform.height *= displayPreviewFactor;\r\n            }\r\n            let transformLayerCanvas = previewLayerArr[selectedLayerIndex].canvas;\r\n            let ctx = transformLayerCanvas.getContext('2d');\r\n            ctx.save();\r\n            ctx.clearRect(0, 0, transformLayerCanvas.width, transformLayerCanvas.height);\r\n            BB.drawTransformedImageWithBounds(\r\n                ctx,\r\n                layers[selectedLayerIndex].context.canvas,\r\n                transform,\r\n                boundsObj,\r\n                algorithmSelect.getValue() === 'pixelated' ||\r\n                BB.testShouldPixelate(transform, transform.width / initTransform.width, transform.height / initTransform.height),\r\n            );\r\n            ctx.restore();\r\n            klCanvasPreview.render();\r\n        }\r\n\r\n        freeTransform = new FreeTransform({\r\n            x: initTransform.x,\r\n            y: initTransform.y,\r\n            width: initTransform.width,\r\n            height: initTransform.height,\r\n            angleDeg: initTransform.angleDeg,\r\n            isConstrained: true,\r\n            snapX: [0, context.canvas.width],\r\n            snapY: [0, context.canvas.height],\r\n            callback: function (t) {\r\n                inputX.value = '' + Math.round(t.x - initTransform.x);\r\n                inputY.value = '' + Math.round(t.y - initTransform.y);\r\n                inputR.value = '' + Math.round(t.angleDeg);\r\n                updatePreview();\r\n            },\r\n            scale: displayPreviewFactor\r\n        });\r\n        BB.css(freeTransform.getElement(), {\r\n            position: 'absolute',\r\n            left: '0',\r\n            top: '0'\r\n        });\r\n        previewInnerWrapper.appendChild(freeTransform.getElement());\r\n\r\n        function onInputsChanged() {\r\n            freeTransform.setPos({\r\n                x: parseInt(inputX.value) + initTransform.x,\r\n                y: parseInt(inputY.value) + initTransform.y}\r\n            );\r\n            freeTransform.setAngleDeg(parseInt(inputR.value));\r\n            updatePreview();\r\n        }\r\n\r\n        updatePreview();\r\n\r\n        div.appendChild(previewWrapper);\r\n        result.destroy = () => {\r\n            keyListener.destroy();\r\n            freeTransform.destroy();\r\n            constrainCheckbox.destroy();\r\n            snappingCheckbox.destroy();\r\n        };\r\n        result.getInput = function () {\r\n            const transform = freeTransform.getTransform();\r\n            let input = {\r\n                transform,\r\n                bounds: boundsObj,\r\n                isPixelated: algorithmSelect.getValue() === 'pixelated' ||\r\n                    BB.testShouldPixelate(transform, transform.width / initTransform.width, transform.height / initTransform.height),\r\n            } as IFilterTransformInput;\r\n            result.destroy();\r\n            return JSON.parse(JSON.stringify(input));\r\n        };\r\n        return result;\r\n    },\r\n\r\n    apply(params: {\r\n        context: CanvasRenderingContext2D,\r\n        history: any, // todo\r\n        input: IFilterTransformInput,\r\n    }) {\r\n        const context = params.context;\r\n        const history = params.history;\r\n        if (!context || !history) {\r\n            return false;\r\n        }\r\n        history.pause();\r\n\r\n        let copyCanvas = BB.copyCanvas(context.canvas);\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        BB.drawTransformedImageWithBounds(\r\n            context,\r\n            copyCanvas,\r\n            params.input.transform,\r\n            params.input.bounds,\r\n            params.input.isPixelated,\r\n        );\r\n\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"filter\", \"transform\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {PcSlider} from '../ui/base-components/slider';\r\nimport {eventResMs} from './filters-consts';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {getSharedFx} from './shared-gl-fx';\r\n\r\nexport const glBlur = {\r\n\r\n    getDialog(params) {\r\n        let canvas = params.canvas;\r\n        let context = params.context;\r\n        if (!canvas || !context) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\r\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\r\n        let w = Math.min(displayW, context.canvas.width);\r\n        let h = Math.min(displayH, context.canvas.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (w > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n        let previewFactor = w / context.canvas.width;\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n\r\n\r\n        function finishInit() {\r\n            let radius = 10;\r\n            div.innerHTML = \"Applies triangle blur on the selected layer.<br/><br/>\";\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n\r\n            let radiusSlider = new PcSlider({\r\n                label: 'Radius',\r\n                width: 300,\r\n                height: 30,\r\n                min: 1,\r\n                max: 200,\r\n                initValue: radius,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    radius = val;\r\n                    glCanvas.draw(texture).triangleBlur(radius * previewFactor).update();\r\n                    klCanvasPreview.render();\r\n                }\r\n            });\r\n            div.appendChild(radiusSlider.getElement());\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            BB.css(previewWrapper, {\r\n                width: \"340px\",\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr = [];\r\n            {\r\n                for(let i = 0; i < layers.length; i++) {\r\n                    previewLayerArr.push({\r\n                        canvas: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            let klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + displayW),\r\n                height: parseInt('' + displayH),\r\n                layerArr: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + displayW) + 'px',\r\n                    height: parseInt('' + displayH) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n            div.appendChild(previewWrapper);\r\n\r\n            try {\r\n                glCanvas.draw(texture).triangleBlur(radius * previewFactor).update();\r\n                klCanvasPreview.render();\r\n            } catch(e) {\r\n                (div as any).errorCallback(e);\r\n            }\r\n\r\n            result.destroy = () => {\r\n                texture.destroy();\r\n                radiusSlider.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    radius: radius\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1);\r\n\r\n        return result;\r\n    },\r\n\r\n    apply(params) {\r\n        let context = params.context;\r\n        let history = params.history;\r\n        let radius = params.input.radius;\r\n        if (!context || !radius || !history)\r\n            return false;\r\n        history.pause();\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).triangleBlur(radius).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"filter\", \"glBlur\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {eventResMs} from './filters-consts';\r\nimport {PcSlider} from '../ui/base-components/slider';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {getSharedFx} from './shared-gl-fx';\r\n\r\nexport const glUnsharpMask = {\r\n\r\n    getDialog(params) {\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\r\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\r\n        let w = Math.min(displayW, context.canvas.width);\r\n        let h = Math.min(displayH, context.canvas.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (w > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n        let previewFactor = w / context.canvas.width;\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n\r\n        function finishInit() {\r\n            let radius = 2, strength = 5.1 / 10;\r\n            div.innerHTML = \"Sharpens the selected layer by scaling pixels away from the average of their neighbors.<br/><br/>\";\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n\r\n            let radiusSlider = new PcSlider({\r\n                label: 'Radius',\r\n                width: 300,\r\n                height: 30,\r\n                min: 0,\r\n                max: 200,\r\n                initValue: 2,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    radius = val;\r\n                    glCanvas.draw(texture).unsharpMask(radius * previewFactor, strength).update();\r\n                    klCanvasPreview.render();\r\n                },\r\n                curve: [[0, 0], [0.1, 2], [0.5, 50], [1, 200]]\r\n            });\r\n            let strengthSlider = new PcSlider({\r\n                label: 'Strength',\r\n                width: 300,\r\n                height: 30,\r\n                min: 0,\r\n                max: 50,\r\n                initValue: 5.1,\r\n                eventResMs: eventResMs,\r\n                onChange: function (val) {\r\n                    strength = val / 10;\r\n                    glCanvas.draw(texture).unsharpMask(radius * previewFactor, strength).update();\r\n                    klCanvasPreview.render();\r\n                },\r\n                curve: [[0, 0], [0.1, 2], [0.5, 10], [1, 50]]\r\n            });\r\n            radiusSlider.getElement().style.marginBottom = \"10px\";\r\n            div.appendChild(radiusSlider.getElement());\r\n            div.appendChild(strengthSlider.getElement());\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            BB.css(previewWrapper, {\r\n                width: \"340px\",\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr = [];\r\n            {\r\n                for(let i = 0; i < layers.length; i++) {\r\n                    previewLayerArr.push({\r\n                        canvas: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            let klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + displayW),\r\n                height: parseInt('' + displayH),\r\n                layerArr: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + displayW) + 'px',\r\n                    height: parseInt('' + displayH) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n\r\n            div.appendChild(previewWrapper);\r\n\r\n            try {\r\n                glCanvas.draw(texture).unsharpMask(radius * previewFactor, strength).update();\r\n                klCanvasPreview.render();\r\n            } catch(e) {\r\n                (div as any).errorCallback(e);\r\n            }\r\n\r\n            result.destroy = () => {\r\n                radiusSlider.destroy();\r\n                strengthSlider.destroy();\r\n                texture.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    radius: radius,\r\n                    strength: strength\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1);\r\n\r\n        return result;\r\n    },\r\n\r\n\r\n    apply(params) {\r\n        let context = params.context;\r\n        let history = params.history;\r\n        let radius = params.input.radius;\r\n        let strength = params.input.strength;\r\n        if (!context || radius === null || strength === null || !history)\r\n            return false;\r\n        history.pause();\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).unsharpMask(radius, strength).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"filter\", \"glUnsharpMask\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {BB} from '../../bb/bb';\r\nimport {Options} from '../ui/base-components/options';\r\nimport {ColorOptions} from '../ui/base-components/color-options';\r\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\r\nimport {getSharedFx} from './shared-gl-fx';\r\n\r\nexport const toAlpha = {\r\n\r\n    getDialog(params) {\r\n        let context = params.context;\r\n        let canvas = params.canvas;\r\n        if (!context || !canvas) {\r\n            return false;\r\n        }\r\n\r\n        let layers = canvas.getLayers();\r\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\r\n\r\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\r\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\r\n\r\n        let tempCanvas = BB.canvas(w, h);\r\n        {\r\n            const ctx = tempCanvas.getContext(\"2d\");\r\n            ctx.save();\r\n            if (tempCanvas.width > context.canvas.width) {\r\n                ctx.imageSmoothingEnabled = false;\r\n            }\r\n            ctx.drawImage(context.canvas, 0, 0, w, h);\r\n            ctx.restore();\r\n        }\r\n\r\n        let div = document.createElement(\"div\");\r\n        let result: any = {\r\n            element: div\r\n        };\r\n\r\n        function finishInit() {\r\n            let radius = 2, strength = 5.1 / 10;\r\n            div.appendChild(BB.el({\r\n                content: 'Generates alpha channel for selected layer from:',\r\n                css: {\r\n                    marginBottom: '5px'\r\n                }\r\n            }));\r\n\r\n            let glCanvas = getSharedFx();\r\n            if (!glCanvas) {\r\n                return; // todo throw?\r\n            }\r\n            let texture = glCanvas.texture(tempCanvas);\r\n            glCanvas.draw(texture).update(); // update glCanvas size\r\n\r\n            function updatePreview() {\r\n                glCanvas.draw(texture).toAlpha(sourceId === 'inverted-luminance', selectedRgbaObj).update();\r\n                klCanvasPreview.render();\r\n            }\r\n\r\n            // source\r\n            let sourceId = 'inverted-luminance';\r\n            let sourceOptions = new Options({\r\n                optionArr: [\r\n                    {\r\n                        id: 'inverted-luminance',\r\n                        label: 'Inverted Luminance'\r\n                    },\r\n                    {\r\n                        id: 'luminance',\r\n                        label: 'Luminance'\r\n                    }\r\n                ],\r\n                initialId: sourceId,\r\n                onChange: function(id) {\r\n                    sourceId = id;\r\n                    updatePreview();\r\n                }\r\n            });\r\n            div.appendChild(sourceOptions.getElement());\r\n\r\n            // color\r\n            let selectedRgbaObj = {r: 0, g: 0, b: 0, a: 1};\r\n            let colorOptionsArr = [\r\n                null,\r\n                {r: 0, g: 0, b: 0, a: 1},\r\n                {r: 255, g: 255, b: 255, a: 1}\r\n            ];\r\n            colorOptionsArr.push({\r\n                r: params.currentColorRgb.r,\r\n                g: params.currentColorRgb.g,\r\n                b: params.currentColorRgb.b,\r\n                a: 1,\r\n            });\r\n            colorOptionsArr.push({\r\n                r: params.secondaryColorRgb.r,\r\n                g: params.secondaryColorRgb.g,\r\n                b: params.secondaryColorRgb.b,\r\n                a: 1,\r\n            });\r\n\r\n            let colorOptions = new ColorOptions({\r\n                label: 'Replace RGB',\r\n                colorArr: colorOptionsArr,\r\n                initialIndex: 1,\r\n                onChange: function(rgbaObj) {\r\n                    selectedRgbaObj = rgbaObj;\r\n                    updatePreview();\r\n                }\r\n            });\r\n            colorOptions.getElement().style.marginTop = '10px';\r\n            div.appendChild(colorOptions.getElement());\r\n\r\n\r\n            let previewWrapper = document.createElement(\"div\");\r\n            BB.css(previewWrapper, {\r\n                width: \"340px\",\r\n                marginLeft: \"-20px\",\r\n                height: \"220px\",\r\n                backgroundColor: \"#9e9e9e\",\r\n                marginTop: \"10px\",\r\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n                userSelect: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                colorScheme: 'only light',\r\n            });\r\n\r\n            let previewLayerArr = [];\r\n            {\r\n                for(let i = 0; i < layers.length; i++) {\r\n                    previewLayerArr.push({\r\n                        canvas: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\r\n                        opacity: layers[i].opacity,\r\n                        mixModeStr: layers[i].mixModeStr\r\n                    });\r\n                }\r\n            }\r\n            let klCanvasPreview = new KlCanvasPreview({\r\n                width: parseInt('' + w),\r\n                height: parseInt('' + h),\r\n                layerArr: previewLayerArr\r\n            });\r\n\r\n            let previewInnerWrapper = BB.el({\r\n                css: {\r\n                    position: 'relative',\r\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\r\n                    width: parseInt('' + w) + 'px',\r\n                    height: parseInt('' + h) + 'px'\r\n                }\r\n            });\r\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\r\n            previewWrapper.appendChild(previewInnerWrapper);\r\n\r\n\r\n            div.appendChild(previewWrapper);\r\n\r\n            setTimeout(function() { //ie has a problem otherwise...\r\n                try {\r\n                    updatePreview();\r\n                } catch(e) {\r\n                    (div as any).errorCallback(e);\r\n                }\r\n            }, 1);\r\n\r\n            result.destroy = () => {\r\n                texture.destroy();\r\n                sourceOptions.destroy();\r\n            };\r\n            result.getInput = function () {\r\n                result.destroy();\r\n                return {\r\n                    sourceId: sourceId,\r\n                    selectedRgbaObj: selectedRgbaObj\r\n                };\r\n            };\r\n        }\r\n\r\n        setTimeout(finishInit, 1);\r\n\r\n        return result;\r\n    },\r\n\r\n\r\n    apply(params) {\r\n        let context = params.context;\r\n        let history = params.history;\r\n        let sourceId = params.input.sourceId;\r\n        let selectedRgbaObj = params.input.selectedRgbaObj;\r\n        if (!context || !sourceId || !history)\r\n            return false;\r\n        history.pause();\r\n        let glCanvas = getSharedFx();\r\n        if (!glCanvas) {\r\n            return false; // todo more specific error?\r\n        }\r\n        let texture = glCanvas.texture(context.canvas);\r\n        glCanvas.draw(texture).toAlpha(sourceId === 'inverted-luminance', selectedRgbaObj).update();\r\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n        context.drawImage(glCanvas, 0, 0);\r\n        texture.destroy();\r\n        history.pause(false);\r\n        history.add({\r\n            tool: [\"filter\", \"toAlpha\"],\r\n            action: \"apply\",\r\n            params: [{\r\n                input: params.input\r\n            }]\r\n        });\r\n        return true;\r\n    }\r\n\r\n};","import {KL} from '../kl';\r\n\r\nexport async function klCanvasToPsdBlob(klCanvas): Promise<Blob> {\r\n    let layerArr = klCanvas.getLayersFast();\r\n\r\n    let psdConfig = {\r\n        width: klCanvas.getWidth(),\r\n        height: klCanvas.getHeight(),\r\n        //canvas: klCanvas.getCompleteCanvas(1), // preview, can be skipped\r\n        children: []\r\n    };\r\n    for (let i = 0; i < layerArr.length; i++) {\r\n        // todo - can be optimized if layer mostly empty\r\n        let item = layerArr[i];\r\n        psdConfig.children.push({\r\n            name: item.name,\r\n            opacity: item.opacity,\r\n            canvas: item.canvas,\r\n            blendMode: KL.PSD.blendKlToPsd(item.mixModeStr),\r\n            left: 0,\r\n            top: 0\r\n        });\r\n    }\r\n\r\n    let agPsd = await import('ag-psd');\r\n    let buffer = agPsd.writePsdBuffer(psdConfig);\r\n    return new Blob([buffer], { type: 'application/octet-stream' });\r\n}"],"names":["$d2fa9a947070c225$export$a84540bc8b694b2d","p","klApp","agPsd","onProjectReady","project","isInitialized","Error","loadingScreenEl","parentNode","removeChild","loadingScreenTextEl","saveReminder","$5ngYX","SaveReminder","$gWfkn","klHistory","$3C7jC","KlApp","bottomBar","embed","url","embedUrl","onSubmit","init","document","body","appendChild","getEl","psdQueue","getElementById","textContent","this","openProject","initError","error","className","getPNG","getPSD","$4gaLD","asyncToGenerator","$parcel$interopDefault","$cijLd","mark","_callee","readPSDs","psds","length","readItem","item","psd","readPsd","blob","$941rU","i","layerArr","image","canvas","layers","callback","e","console","forEach","parcelRequire","_ctx","sent","shift","push","$946de144e151ce6f$var$HIDDEN","$7Sc7b","$946de144e151ce6f$var$SYMBOL","$946de144e151ce6f$var$TO_PRIMITIVE","$8RiFY","$946de144e151ce6f$var$setInternalState","$jUSxl","set","$946de144e151ce6f$var$getInternalState","getterFor","$946de144e151ce6f$var$ObjectPrototype","Object","$946de144e151ce6f$var$$Symbol","$6LGrQ","Symbol","$946de144e151ce6f$var$SymbolPrototype","$946de144e151ce6f$var$TypeError","TypeError","$946de144e151ce6f$var$QObject","QObject","$946de144e151ce6f$var$$stringify","$fdCuf","$946de144e151ce6f$var$nativeGetOwnPropertyDescriptor","$l0gwz","f","$946de144e151ce6f$var$nativeDefineProperty","$bLi0c","$946de144e151ce6f$var$nativeGetOwnPropertyNames","$8Ybf3","$946de144e151ce6f$var$nativePropertyIsEnumerable","$7wvbV","$946de144e151ce6f$var$push","$2x0T1","$946de144e151ce6f$var$AllSymbols","$eW5R0","$946de144e151ce6f$var$ObjectPrototypeSymbols","$946de144e151ce6f$var$StringToSymbolRegistry","$946de144e151ce6f$var$SymbolToStringRegistry","$946de144e151ce6f$var$WellKnownSymbolsStore","$946de144e151ce6f$var$USE_SETTER","findChild","$946de144e151ce6f$var$setSymbolDescriptor","$A56Kx","$6WghJ","$KFLt0","get","value","a","O","P","Attributes","ObjectPrototypeDescriptor","$946de144e151ce6f$var$wrap","tag","description","symbol","type","$946de144e151ce6f$var$$defineProperty","$edAQb","key","$hvgHk","$1JB0D","enumerable","$eqpEX","$946de144e151ce6f$var$$defineProperties","Properties","properties","$hAcvu","keys","$8xgUB","concat","$946de144e151ce6f$var$$getOwnPropertySymbols","$9ZRgk","$946de144e151ce6f$var$$propertyIsEnumerable","V","$946de144e151ce6f$var$$getOwnPropertyDescriptor","it","descriptor","$946de144e151ce6f$var$$getOwnPropertyNames","names","result","$8OCuI","IS_OBJECT_PROTOTYPE","$OTdcX","$c9sXY","arguments","undefined","$eXtvS","$VN1JY","setter","configurable","$8Opqg","$jDguE","$9hrSE","$b9pdI","$btl60","name","$bMhTS","unsafe","$JGbI2","global","wrap","forced","sham","$aUpwE","target","stat","for","string","keyFor","sym","$fcVIX","useSetter","useSimple","create","defineProperty","defineProperties","getOwnPropertyDescriptor","getOwnPropertyNames","getOwnPropertySymbols","$falgx","stringify","replacer","space","args","$1fDSm","$replacer","$gczVK","$gVpis","$3HoBU","$cn22k","$946de144e151ce6f$var$valueOf","valueOf","hint","$9Ebr8","module","exports","options","source","targetProperty","sourceProperty","TARGET","GLOBAL","STATIC","$7eUfi","prototype","noTargetGet","$0894edb6be15987f$require$getOwnPropertyDescriptor","$iTHz4","typeOf","$jzDTf","$8ihId","$4ed80f2f712c1a8e$var$check","Math","globalThis","window","self","$parcel$global","Function","$f4a66a6ea03eaec6$export$2d1720544b23b823","$f4a66a6ea03eaec6$var$$getOwnPropertyDescriptor","$k9fAW","exec","$7473205dfab1fa23$var$call","call","$10M9V","bind","apply","test","hasOwnProperty","$57a3b7844b6c90ba$export$2d1720544b23b823","$57a3b7844b6c90ba$var$$propertyIsEnumerable","propertyIsEnumerable","$57a3b7844b6c90ba$var$getOwnPropertyDescriptor","$57a3b7844b6c90ba$var$NASHORN_BUG","bitmap","writable","$atLuV","$0dsEW","$7a1174e1fb228c6f$var$Object","$7a1174e1fb228c6f$var$split","split","$lrHHl","$1d7f59e44aff4a7a$var$FunctionPrototype","$1d7f59e44aff4a7a$var$bind","$1d7f59e44aff4a7a$var$call","$1d7f59e44aff4a7a$var$uncurryThis","fn","$f9ce0419d22a9ab2$var$toString","toString","$f9ce0419d22a9ab2$var$stringSlice","slice","$000a71535b8a0314$var$TypeError","argument","$ePlFm","$acb6a29183ca6e75$var$TypeError","$acb6a29183ca6e75$var$TO_PRIMITIVE","input","pref","exoticToPrim","$3Xhmk","$a2dhY","$b124c0d396db18ae$var$Object","$e4Dh9","$Symbol","$b145ec9fce0e97f9$var$aFunction","namespace","method","isPrototypeOf","iterator","String","$ipWH0","$d68816eb2fa7297b$var$match","$d68816eb2fa7297b$var$version","$d68816eb2fa7297b$var$process","process","$d68816eb2fa7297b$var$Deno","Deno","$d68816eb2fa7297b$var$versions","versions","version","$d68816eb2fa7297b$var$v8","v8","$2F7Zt","match","func","$lEpkd","$fc30fa73bab9ad2c$var$TypeError","$dth1M","$9ceb31273476e724$var$String","$74e4662ec9137ae3$var$TypeError","val","$6731c29e73be8b43$var$WellKnownSymbolsStore","$6731c29e73be8b43$var$Symbol","$6731c29e73be8b43$var$symbolFor","$6731c29e73be8b43$var$createWellKnownSymbol","withoutSetter","$gt9ls","mode","copyright","license","$bfd69a856f043d4f$var$SHARED","$bfd69a856f043d4f$var$store","$5455786d6561d0c9$var$defineProperty","$1436b3ae35d8e28e$var$hasOwnProperty","hasOwn","$b0a8491bce44604f$var$Object","$0adb5abdb2d94f92$var$id","$0adb5abdb2d94f92$var$postfix","random","$0adb5abdb2d94f92$var$toString","$ckGOu","$8fa89027f48a411a$var$document","$8fa89027f48a411a$var$EXISTS","createElement","object","$89020c597992b0a8$export$2d1720544b23b823","$89020c597992b0a8$var$TypeError","$89020c597992b0a8$var$$defineProperty","$89020c597992b0a8$var$$getOwnPropertyDescriptor","$89020c597992b0a8$var$ENUMERABLE","$89020c597992b0a8$var$CONFIGURABLE","$89020c597992b0a8$var$WRITABLE","$8U1TM","current","$a59edb5b2fd2788a$var$String","$a59edb5b2fd2788a$var$TypeError","CONFIGURABLE","$66a6b6a20211ca84$var$getInternalState","$66a6b6a20211ca84$var$enforceInternalState","enforce","$66a6b6a20211ca84$var$TEMPLATE","state","simple","replace","$66a6b6a20211ca84$require$CONFIGURABLE_FUNCTION_NAME","join","$3jbTY","$268c60e1efd01107$var$functionToString","inspectSource","$e7fd8d2701a52c10$var$set","$e7fd8d2701a52c10$var$get","$e7fd8d2701a52c10$var$has","$e7fd8d2701a52c10$var$OBJECT_ALREADY_INITIALIZED","$e7fd8d2701a52c10$var$TypeError","$e7fd8d2701a52c10$var$WeakMap","WeakMap","$g10oc","$e7fd8d2701a52c10$var$store","$e7fd8d2701a52c10$var$wmget","$e7fd8d2701a52c10$var$wmhas","has","$e7fd8d2701a52c10$var$wmset","metadata","facade","$e7fd8d2701a52c10$var$STATE","TYPE","$ba8d0aab92e243b6$var$WeakMap","$5bb6f9496df13346$var$keys","$8e6a0786b4ae9728$var$FunctionPrototype","$8e6a0786b4ae9728$var$getDescriptor","$8e6a0786b4ae9728$var$EXISTS","$8e6a0786b4ae9728$var$PROPER","$8e6a0786b4ae9728$var$CONFIGURABLE","EXISTS","PROPER","exceptions","$6qoE5","$4ad849db11f07af0$var$concat","$6c1b54106766ccdc$export$2d1720544b23b823","$6c1b54106766ccdc$var$hiddenKeys","$19Y1f","indexOf","$0d85303cf0728b08$var$push","$0d85303cf0728b08$require$indexOf","$fbdcaa2c8ce11a12$var$createMethod","IS_INCLUDES","$this","el","fromIndex","$9u6Bu","index","$8BhlN","includes","$642f3ce21d97ba11$var$max","max","$642f3ce21d97ba11$var$min","min","integer","$3Hjrl","$2b1477a1a3486b52$var$ceil","ceil","$2b1477a1a3486b52$var$floor","floor","number","obj","$k8phS","$ea882b862bf27474$var$min","$81e41929279a1d56$export$2d1720544b23b823","$dc1f2810a56598f1$var$replacement","$dc1f2810a56598f1$var$isForced","feature","detection","$dc1f2810a56598f1$var$data","$dc1f2810a56598f1$var$normalize","$dc1f2810a56598f1$var$POLYFILL","$dc1f2810a56598f1$var$NATIVE","normalize","toLowerCase","data","NATIVE","POLYFILL","$90193670beecd49b$var$FunctionPrototype","$90193670beecd49b$var$apply","$90193670beecd49b$var$call","Reflect","Array","isArray","$ae3d7814aa7be7fa$var$String","$cKQyt","$94928c40ef066db6$var$TO_STRING_TAG","$94928c40ef066db6$var$Object","$94928c40ef066db6$var$CORRECT_ARGUMENTS","$kDzjR","$94928c40ef066db6$var$tryGet","callee","$f062d8d8626aa8c7$var$test","$08c4b1923d6666ef$var$activeXDocument","$08c4b1923d6666ef$var$IE_PROTO","$08c4b1923d6666ef$var$EmptyConstructor","$08c4b1923d6666ef$var$scriptTag","content","$08c4b1923d6666ef$var$LT","$08c4b1923d6666ef$var$NullProtoObjectViaActiveX","activeXDocument","write","close","temp","parentWindow","$08c4b1923d6666ef$var$NullProtoObject","ActiveXObject","iframeDocument","iframe","domain","style","display","$25rlX","src","contentWindow","open","F","$hwdBV","$e4ae7418ddbfa74e$export$2d1720544b23b823","props","$687ca5bb09d467a5$export$2d1720544b23b823","$687ca5bb09d467a5$var$windowNames","$687ca5bb09d467a5$require$$getOwnPropertyNames","$b4zeJ","$687ca5bb09d467a5$var$getWindowNames","$80fb66adf7e0f99e$var$Array","$80fb66adf7e0f99e$var$max","start","end","k","fin","n","$9MkWL","propertyKey","$85a2c45afa04bf4c$export$2d1720544b23b823","NAME","$lEmA0","$7f12ef32d76ce306$require$defineProperty","$7060b89199bc6626$var$TO_STRING_TAG","TAG","$7060b89199bc6626$require$defineProperty","$6d6d9e1ac7090127$var$push","$6d6d9e1ac7090127$var$createMethod","IS_MAP","IS_FILTER","IS_SOME","IS_EVERY","IS_FIND_INDEX","IS_FILTER_REJECT","NO_HOLES","callbackfn","that","specificCreate","boundFunction","$gAXAR","$ab5jG","map","filter","some","every","find","findIndex","filterReject","$c14e3c307d6614b8$var$bind","originalArray","$kMN3P","$f21e58c4eb8182a8$var$SPECIES","$f21e58c4eb8182a8$var$Array","C","constructor","$iHD1w","$d9da836f9a560c1d$var$noop","$d9da836f9a560c1d$var$empty","$d9da836f9a560c1d$var$construct","$d9da836f9a560c1d$var$constructorRegExp","$d9da836f9a560c1d$var$exec","$d9da836f9a560c1d$var$INCORRECT_TO_STRING","$d9da836f9a560c1d$var$isConstructorModern","$d9da836f9a560c1d$var$isConstructorLegacy","called","$95058444ce44b672$var$NativeSymbol","$95058444ce44b672$var$SymbolPrototype","$95058444ce44b672$var$EmptyStringDescriptionStore","$95058444ce44b672$var$SymbolWrapper","$95058444ce44b672$var$NATIVE_SYMBOL","$95058444ce44b672$var$symbolToString","$95058444ce44b672$var$symbolValueOf","$95058444ce44b672$var$regexp","$95058444ce44b672$var$replace","$95058444ce44b672$var$stringSlice","desc","$06d708477fabbc3c$var$IS_CONCAT_SPREADABLE","$06d708477fabbc3c$var$MAX_SAFE_INTEGER","$06d708477fabbc3c$var$MAXIMUM_ALLOWED_INDEX_EXCEEDED","$06d708477fabbc3c$var$TypeError","$06d708477fabbc3c$var$IS_CONCAT_SPREADABLE_SUPPORT","array","$06d708477fabbc3c$var$SPECIES_SUPPORT","$4SJPo","$06d708477fabbc3c$var$isConcatSpreadable","spreadable","proto","arg","len","E","A","$38dfc10b7d062b7d$var$SPECIES","METHOD_NAME","foo","Boolean","copyWithin","$04UlN","$d9AHO","$00ec15e2e443b0ba$var$min","to","from","count","inc","$9938969e81eeb096$var$UNSCOPABLES","$9938969e81eeb096$var$ArrayPrototype","fill","$5QjeM","argumentsLength","endPos","$de1f2425280a5550$require$$filter","$d33f22fb1838a81f$var$FIND","$d33f22fb1838a81f$var$SKIPS_HOLES","$d33f22fb1838a81f$require$$find","$3cfa9a6590676def$var$FIND_INDEX","$3cfa9a6590676def$var$SKIPS_HOLES","$3cfa9a6590676def$require$$findIndex","flat","depthArg","sourceLen","$3GD8y","$2af3a71f27ab42a8$var$TypeError","$2af3a71f27ab42a8$var$flattenIntoArray","original","depth","mapper","thisArg","element","elementLen","targetIndex","sourceIndex","mapFn","flatMap","$dNJyV","iterable","$jvovY","$e333eda9c4fee069$var$Array","arrayLike","IS_CONSTRUCTOR","mapfn","mapping","step","next","iteratorMethod","$aCNH3","$9WXOl","$g3ZOP","done","$9XuUh","ENTRIES","$eYYfs","kind","innerResult","innerError","$73e7ed092b9c800c$var$ITERATOR","$73e7ed092b9c800c$var$ArrayPrototype","$csbVC","$bb1ce10fd36d041e$var$TypeError","usingIterator","$7bc40018221d6442$var$ITERATOR","$a0c331ad1c26b999$var$ITERATOR","$a0c331ad1c26b999$var$SAFE_CLOSING","$a0c331ad1c26b999$var$called","$a0c331ad1c26b999$var$iteratorWithReturn","return","SKIP_CLOSING","ITERATION_SUPPORT","$4c66802a9a219c77$require$$includes","$5bc31975d32d2345$var$un$IndexOf","$5bc31975d32d2345$var$NEGATIVE_ZERO","$5bc31975d32d2345$var$STRICT_METHOD","$orWZn","searchElement","$5bc31975d32d2345$require$$IndexOf","$f56abe53ba5eb975$var$ARRAY_ITERATOR","$f56abe53ba5eb975$var$setInternalState","$f56abe53ba5eb975$var$getInternalState","$A0wh1","iterated","$f56abe53ba5eb975$var$values","Arguments","$06c3c413d837e89a$var$PROPER_FUNCTION_NAME","$ce4aN","$06c3c413d837e89a$var$CONFIGURABLE_FUNCTION_NAME","$06c3c413d837e89a$var$IteratorPrototype","$aGk5W","IteratorPrototype","$06c3c413d837e89a$var$BUGGY_SAFARI_ITERATORS","BUGGY_SAFARI_ITERATORS","$06c3c413d837e89a$var$ITERATOR","$06c3c413d837e89a$var$KEYS","$06c3c413d837e89a$var$VALUES","$06c3c413d837e89a$var$ENTRIES","$06c3c413d837e89a$var$returnThis","Iterable","IteratorConstructor","DEFAULT","IS_SET","FORCED","$bGPs6","CurrentIteratorPrototype","methods","KEY","getIterationMethod","KIND","defaultIterator","IterablePrototype","TO_STRING_TAG","INCORRECT_VALUES_NAME","nativeIterator","anyNativeIterator","entries","$f4X4V","$4HLYu","values","$882b874f0aebd4cd$var$returnThis","ENUMERABLE_NEXT","$882b874f0aebd4cd$require$IteratorPrototype","$7c6d6a0dfcded862$var$IteratorPrototype","$7c6d6a0dfcded862$var$PrototypeOfArrayIteratorPrototype","$7c6d6a0dfcded862$var$arrayIterator","$7c6d6a0dfcded862$var$ITERATOR","$7c6d6a0dfcded862$var$BUGGY_SAFARI_ITERATORS","$afa50e7eae6435d2$var$IE_PROTO","$afa50e7eae6435d2$var$Object","$afa50e7eae6435d2$var$ObjectPrototype","$khrDL","getPrototypeOf","setPrototypeOf","CORRECT_SETTER","$iHaUn","__proto__","$d9c4b44ded233f44$var$String","$d9c4b44ded233f44$var$TypeError","$bc16be61500a9223$var$un$Join","$bc16be61500a9223$var$ES3_STRINGS","$bc16be61500a9223$var$STRICT_METHOD","separator","$hYbqA","lastIndexOf","$d150e79cf147dfb5$var$min","$d150e79cf147dfb5$var$$lastIndexOf","$d150e79cf147dfb5$var$NEGATIVE_ZERO","$d150e79cf147dfb5$var$STRICT_METHOD","$d150e79cf147dfb5$var$FORCED","$a9cf0fb5298318c9$require$$map","$afe503e80150048b$var$Array","of","left","$bVA4J","reduce","$77f91bc8c728543f$require$$reduce","$77ace5066f55ab98$var$TypeError","$77ace5066f55ab98$var$createMethod","IS_RIGHT","memo","right","reduceRight","$8e76da0addb6c606$require$$reduceRight","$c69e6770946c52af$var$un$Reverse","reverse","$c69e6770946c52af$var$test","$ea74985d703c2784$var$HAS_SPECIES_SUPPORT","$ea74985d703c2784$var$SPECIES","$ea74985d703c2784$var$Array","$ea74985d703c2784$var$max","Constructor","$6d981ef59a83a93b$var$test","$6d981ef59a83a93b$var$un$Sort","sort","$6d981ef59a83a93b$var$push","$6d981ef59a83a93b$var$FAILS_ON_UNDEFINED","$6d981ef59a83a93b$var$FAILS_ON_NULL","$6d981ef59a83a93b$var$STRICT_METHOD","$6d981ef59a83a93b$var$STABLE_SORT","$efWWg","$gucwG","$3M0bw","code","chr","fromCharCode","v","b","charAt","comparefn","itemsLength","items","arrayLength","$c3NuZ","x","y","$6d981ef59a83a93b$var$getSortCompare","$8c7c294a48fbd5f0$var$floor","$8c7c294a48fbd5f0$var$mergeSort","middle","$8c7c294a48fbd5f0$var$insertionSort","$8c7c294a48fbd5f0$var$merge","j","llength","rlength","lindex","rindex","$a6102f65caba9398$var$firefox","$2bf5ff846ca490e5$var$webkit","$b5zq9","$812ba325d699cdbe$var$SPECIES","CONSTRUCTOR_NAME","$94e9d0a062f4242a$var$HAS_SPECIES_SUPPORT","$94e9d0a062f4242a$var$TypeError","$94e9d0a062f4242a$var$max","$94e9d0a062f4242a$var$min","$94e9d0a062f4242a$var$MAX_SAFE_INTEGER","$94e9d0a062f4242a$var$MAXIMUM_ALLOWED_LENGTH_EXCEEDED","splice","deleteCount","insertCount","actualDeleteCount","actualStart","$aef8fd70a5e40999$var$ARRAY_BUFFER","$aef8fd70a5e40999$var$ArrayBuffer","$h6ot1","ArrayBuffer","$c735f9db77db5a68$var$PROPER_FUNCTION_NAME","$c735f9db77db5a68$var$CONFIGURABLE_FUNCTION_NAME","$c735f9db77db5a68$var$getInternalState","$c735f9db77db5a68$var$setInternalState","$c735f9db77db5a68$var$ARRAY_BUFFER","$c735f9db77db5a68$var$DATA_VIEW","$c735f9db77db5a68$var$WRONG_INDEX","$c735f9db77db5a68$var$NativeArrayBuffer","$c735f9db77db5a68$var$$ArrayBuffer","$c735f9db77db5a68$var$ArrayBufferPrototype","$c735f9db77db5a68$var$$DataView","$c735f9db77db5a68$var$DataViewPrototype","$c735f9db77db5a68$var$ObjectPrototype","$c735f9db77db5a68$var$Array","$c735f9db77db5a68$var$RangeError","RangeError","$c735f9db77db5a68$var$fill","$c735f9db77db5a68$var$reverse","$c735f9db77db5a68$var$packIEEE754","$4JHSt","pack","$c735f9db77db5a68$var$unpackIEEE754","unpack","$c735f9db77db5a68$var$packInt8","$c735f9db77db5a68$var$packInt16","$c735f9db77db5a68$var$packInt32","$c735f9db77db5a68$var$unpackInt32","buffer","$c735f9db77db5a68$var$packFloat32","$c735f9db77db5a68$var$packFloat64","$c735f9db77db5a68$var$addGetter","$c735f9db77db5a68$var$get","view","isLittleEndian","intIndex","$75wCi","store","byteLength","bytes","byteOffset","$c735f9db77db5a68$var$set","conversion","$7jUo8","$c735f9db77db5a68$var$INCORRECT_ARRAY_BUFFER_NAME","NaN","$lIgln","$c735f9db77db5a68$var$key","$c735f9db77db5a68$var$keys","$c735f9db77db5a68$require$getOwnPropertyNames","$c735f9db77db5a68$var$j","$c735f9db77db5a68$var$testView","$c735f9db77db5a68$var$$setInt8","setInt8","getInt8","$g2jnF","setUint8","bufferLength","offset","getUint8","getInt16","getUint16","getInt32","getUint32","getFloat32","getFloat64","setInt16","setUint16","setInt32","setUint32","setFloat32","setFloat64","DataView","$fcea6295360a95aa$var$TypeError","Prototype","$52924d0b004d36a8$var$RangeError","$372d6692f9dc6c25$var$Array","$372d6692f9dc6c25$var$abs","abs","$372d6692f9dc6c25$var$pow","pow","$372d6692f9dc6c25$var$floor","$372d6692f9dc6c25$var$log","log","$372d6692f9dc6c25$var$LN2","LN2","mantissaLength","exponent","mantissa","c","exponentLength","eMax","eBias","rt","sign","Infinity","nBits","$ca7e867aeefa82f6$var$ArrayBuffer","$ca7e867aeefa82f6$var$DataView","$ca7e867aeefa82f6$var$DataViewPrototype","$ca7e867aeefa82f6$var$un$ArrayBufferSlice","$ca7e867aeefa82f6$var$getUint8","$ca7e867aeefa82f6$var$setUint8","first","$4xaB6","viewSource","viewTarget","$34d276f1cc0e9c1f$var$SPECIES","defaultConstructor","S","$3Z9Nz","$2e6eab6702fa1b0e$var$TypeError","Date","toJSON","toISOString","pv","isFinite","$5e86d5cf2559ab75$var$TO_PRIMITIVE","$5e86d5cf2559ab75$var$DatePrototype","$heBc3","$c8c0985652775684$var$TypeError","$6f7d5205848dd522$var$HAS_INSTANCE","$6f7d5205848dd522$var$FunctionPrototype","$bd587bdd09f5fb4c$var$FunctionPrototype","$bd587bdd09f5fb4c$var$functionToString","$bd587bdd09f5fb4c$var$nameRE","$bd587bdd09f5fb4c$var$regExpExec","$bd587bdd09f5fb4c$require$FUNCTION_NAME_EXISTS","$bd587bdd09f5fb4c$require$defineProperty","JSON","$6P8eJ","wrapper","common","IS_WEAK","ADDER","NativeConstructor","NativePrototype","exported","fixMethod","uncurriedNativeMethod","getConstructor","$7ahyY","enable","instance","HASNT_CHAINING","THROWS_ON_PRIMITIVES","ACCEPT_ITERABLES","BUGGY_ZERO","$instance","dummy","$4nT4Z","$d8pty","AS_ENTRIES","clear","setStrong","$5377173f5423bfef$var$REQUIRED","$5377173f5423bfef$var$METADATA","$5377173f5423bfef$var$id","$5377173f5423bfef$var$setMetadata","objectID","weakData","$5377173f5423bfef$var$meta","fastKey","$kneZa","getWeakData","onFreeze","$6jxZs","$ed519476a2f6c474$var$$isExtensible","isExtensible","$ed519476a2f6c474$var$FAILS_ON_PRIMITIVES","$8Chxf","preventExtensions","$98ffc8a58644c09f$var$TypeError","$98ffc8a58644c09f$var$Result","stopped","$98ffc8a58644c09f$var$ResultPrototype","unboundFunction","iterFn","IS_ITERATOR","INTERRUPTED","stop","condition","callFn","Wrapper","NewTarget","NewTargetPrototype","$c52cbfa92a8c3afc$var$setInternalState","$c52cbfa92a8c3afc$var$internalStateGetterFor","last","size","getInternalState","define","previous","entry","getEntry","$c52cbfa92a8c3afc$require$fastKey","removed","delete","prev","add","$c52cbfa92a8c3afc$require$defineProperty","ITERATOR_NAME","getInternalCollectionState","getInternalIteratorState","$de3580f95004286b$var$$acosh","acosh","$de3580f95004286b$var$log","$de3580f95004286b$var$sqrt","sqrt","$de3580f95004286b$var$LN2","Number","MAX_VALUE","$dVGex","$a2415beeb773b741$var$log","log1p","$2ef2ab175d68371d$var$$asinh","asinh","$2ef2ab175d68371d$var$log","$2ef2ab175d68371d$var$sqrt","$2ef2ab175d68371d$var$asinh","$51de6475ea62667d$var$$atanh","atanh","$51de6475ea62667d$var$log","$877700f786d3b071$var$abs","$877700f786d3b071$var$pow","cbrt","$fAbqV","$4d5bac8103272b52$var$floor","$4d5bac8103272b52$var$log","$4d5bac8103272b52$var$LOG2E","LOG2E","clz32","$c557c2f9fd85eb3a$var$$cosh","cosh","$c557c2f9fd85eb3a$var$abs","$c557c2f9fd85eb3a$var$E","t","$aXV8O","$7fbbbd2218a8aa4f$var$$expm1","expm1","$7fbbbd2218a8aa4f$var$exp","exp","fround","$f2b854d554808773$var$abs","$f2b854d554808773$var$pow","$f2b854d554808773$var$EPSILON","$f2b854d554808773$var$EPSILON32","$f2b854d554808773$var$MAX32","$f2b854d554808773$var$MIN32","$abs","$sign","$e0b4e047d893fcf8$var$$hypot","hypot","$e0b4e047d893fcf8$var$abs","$e0b4e047d893fcf8$var$sqrt","value1","value2","div","sum","aLen","larg","$48b0e6bcf6649d46$var$$imul","imul","UINT16","xn","yn","xl","yl","log10","$5e028cd5a1d92290$var$log","$5e028cd5a1d92290$var$LOG10E","LOG10E","$0d53237d08355bc5$var$log","$0d53237d08355bc5$var$LN2","log2","$9c130dae4f446bfc$var$abs","$9c130dae4f446bfc$var$exp","$9c130dae4f446bfc$var$E","sinh","$c49f9a2aa1cac773$var$exp","tanh","$5b6a67b5c1a51dc7$var$ceil","$5b6a67b5c1a51dc7$var$floor","trunc","trim","$b06f634510db1b10$var$NUMBER","$b06f634510db1b10$var$NativeNumber","$b06f634510db1b10$var$NumberPrototype","$b06f634510db1b10$var$TypeError","$b06f634510db1b10$var$arraySlice","$b06f634510db1b10$var$charCodeAt","charCodeAt","$b06f634510db1b10$var$toNumeric","primValue","$b06f634510db1b10$var$toNumber","third","radix","maxCode","digits","$b06f634510db1b10$require$trim","parseInt","$b06f634510db1b10$var$key","$b06f634510db1b10$var$NumberWrapper","$dBMLl","$b06f634510db1b10$var$keys","$b06f634510db1b10$require$getOwnPropertyNames","$b06f634510db1b10$var$j","$b06f634510db1b10$require$defineProperty","$b06f634510db1b10$require$getOwnPropertyDescriptor","$9304af073e986fbc$var$replace","$9304af073e986fbc$var$whitespace","$eJCyU","$9304af073e986fbc$var$ltrim","RegExp","$9304af073e986fbc$var$rtrim","$9304af073e986fbc$var$createMethod","EPSILON","$3720d9a264c3b676$var$globalIsFinite","isInteger","$a29d3ec5df192b8d$var$floor","isNaN","$b05bbdede92fb15b$var$abs","isSafeInteger","$dXAGN","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","parseFloat","$hpuGp","$cacc9274dbcca3bc$var$charAt","$cacc9274dbcca3bc$var$n$ParseFloat","$cacc9274dbcca3bc$var$Symbol","$cacc9274dbcca3bc$var$ITERATOR","$cacc9274dbcca3bc$var$FORCED","trimmedString","$cacc9274dbcca3bc$require$trim","$9W5cg","$73bd8fcb3027a7db$var$$parseInt","$73bd8fcb3027a7db$var$Symbol","$73bd8fcb3027a7db$var$ITERATOR","$73bd8fcb3027a7db$var$hex","$73bd8fcb3027a7db$var$exec","$73bd8fcb3027a7db$var$FORCED","$73bd8fcb3027a7db$require$trim","$4e1f642ad95f55f9$var$RangeError","$4e1f642ad95f55f9$var$String","$4e1f642ad95f55f9$var$floor","$4e1f642ad95f55f9$var$repeat","$kmJfO","$4e1f642ad95f55f9$var$stringSlice","$4e1f642ad95f55f9$var$un$ToFixed","toFixed","$4e1f642ad95f55f9$var$pow","acc","$4e1f642ad95f55f9$var$multiply","c2","$4e1f642ad95f55f9$var$divide","$4e1f642ad95f55f9$var$dataToString","s","fractionDigits","z","fractDigits","x2","$4e1f642ad95f55f9$var$log","$ed38f736006a189b$var$RangeError","str","assign","$lFR0S","$fc768c9ef9e1deb0$var$$assign","$fc768c9ef9e1deb0$var$defineProperty","$fc768c9ef9e1deb0$var$concat","B","alphabet","T","$4qt6g","__defineGetter__","getter","__defineSetter__","$f989467c0ff32b07$require$$entries","$c7d0dd7c98cf6620$var$propertyIsEnumerable","$c7d0dd7c98cf6620$var$push","$c7d0dd7c98cf6620$var$createMethod","TO_ENTRIES","$ae1348ad95526311$var$$freeze","freeze","$ae1348ad95526311$require$onFreeze","fromEntries","$cc1eb17eb08c9bee$var$FAILS_ON_PRIMITIVES","$cc1eb17eb08c9bee$require$nativeGetOwnPropertyDescriptor","getOwnPropertyDescriptors","$47c621318e2f76c3$require$getOwnPropertyNames","is","$8286df4accdf48ed$var$$isFrozen","isFrozen","$298641195c3c623c$var$$isSealed","isSealed","__lookupGetter__","$924d18b281a9c424$require$getOwnPropertyDescriptor","__lookupSetter__","$42abce55f97ceab5$require$getOwnPropertyDescriptor","$267d03b316d70c8b$var$$preventExtensions","$267d03b316d70c8b$require$onFreeze","$e28a496f96292dfa$var$$seal","seal","$e28a496f96292dfa$require$onFreeze","$j9rDg","$71106bf8fefef8c0$require$$values","$f63b4deb68b5ca14$var$Internal","$f63b4deb68b5ca14$var$OwnPromiseCapability","$f63b4deb68b5ca14$var$PromiseWrapper","$f63b4deb68b5ca14$var$nativeThen","$f63b4deb68b5ca14$var$SPECIES","$f63b4deb68b5ca14$var$PROMISE","$f63b4deb68b5ca14$var$getInternalState","$f63b4deb68b5ca14$var$setInternalState","$f63b4deb68b5ca14$var$getInternalPromiseState","$f63b4deb68b5ca14$var$NativePromisePrototype","$dH9yW","$f63b4deb68b5ca14$var$PromiseConstructor","$f63b4deb68b5ca14$var$PromisePrototype","$f63b4deb68b5ca14$var$TypeError","$f63b4deb68b5ca14$var$document","$f63b4deb68b5ca14$var$process","$f63b4deb68b5ca14$var$newPromiseCapability","$4l0Z8","$f63b4deb68b5ca14$var$newGenericPromiseCapability","$f63b4deb68b5ca14$var$DISPATCH_EVENT","createEvent","dispatchEvent","$f63b4deb68b5ca14$var$NATIVE_REJECTION_EVENT","PromiseRejectionEvent","$f63b4deb68b5ca14$var$UNHANDLED_REJECTION","$f63b4deb68b5ca14$var$SUBCLASSING","$f63b4deb68b5ca14$var$FORCED","PROMISE_CONSTRUCTOR_SOURCE","GLOBAL_CORE_JS_PROMISE","promise","resolve","FakePromise","then","$5qUSX","$f63b4deb68b5ca14$var$INCORRECT_ITERATION","all","$f63b4deb68b5ca14$var$isThenable","$f63b4deb68b5ca14$var$callReaction","reaction","exited","ok","handler","fail","reject","rejection","$f63b4deb68b5ca14$var$onHandleUnhandled","enter","exit","$f63b4deb68b5ca14$var$notify","isReject","notified","$cqo3L","reactions","$f63b4deb68b5ca14$var$onUnhandled","$f63b4deb68b5ca14$var$dispatchEvent","reason","event","initEvent","$46Eeh","$f63b4deb68b5ca14$require$task","$f63b4deb68b5ca14$var$isUnhandled","$emrW7","emit","parent","$f63b4deb68b5ca14$var$bind","unwrap","$f63b4deb68b5ca14$var$internalReject","$f63b4deb68b5ca14$var$internalResolve","executor","$c6xXQ","onFulfilled","onRejected","catch","Promise","r","capability","$jb14y","$promiseResolve","counter","remaining","alreadyCalled","race","$33e6d73a2ea24d6b$var$location","$33e6d73a2ea24d6b$var$defer","$33e6d73a2ea24d6b$var$channel","$33e6d73a2ea24d6b$var$port","$33e6d73a2ea24d6b$var$set","setImmediate","$33e6d73a2ea24d6b$var$clear","clearImmediate","$33e6d73a2ea24d6b$var$process","$33e6d73a2ea24d6b$var$Dispatch","Dispatch","$33e6d73a2ea24d6b$var$Function","$33e6d73a2ea24d6b$var$MessageChannel","MessageChannel","$33e6d73a2ea24d6b$var$String","$33e6d73a2ea24d6b$var$counter","$33e6d73a2ea24d6b$var$queue","$33e6d73a2ea24d6b$var$ONREADYSTATECHANGE","location","$33e6d73a2ea24d6b$var$run","id","$33e6d73a2ea24d6b$var$runner","$33e6d73a2ea24d6b$var$listener","$33e6d73a2ea24d6b$var$post","postMessage","protocol","host","nextTick","now","$eFUbX","port2","port1","onmessage","addEventListener","importScripts","setTimeout","$90ba93803394c14b$var$flush","$90ba93803394c14b$var$head","$90ba93803394c14b$var$last","$90ba93803394c14b$var$notify","$90ba93803394c14b$var$toggle","$90ba93803394c14b$var$node","$90ba93803394c14b$var$promise","$90ba93803394c14b$var$then","$90ba93803394c14b$var$MutationObserver","MutationObserver","WebKitMutationObserver","$90ba93803394c14b$var$document","$90ba93803394c14b$var$process","$90ba93803394c14b$var$Promise","$90ba93803394c14b$var$queueMicrotaskDescriptor","$90ba93803394c14b$require$getOwnPropertyDescriptor","$90ba93803394c14b$var$queueMicrotask","$jtDRH","$k2k84","$90ba93803394c14b$require$macrotask","createTextNode","observe","characterData","task","Pebble","promiseCapability","$3289e331b59edf28$export$2d1720544b23b823","$3289e331b59edf28$var$PromiseCapability","$$resolve","$$reject","$8d0064273ae794d4$var$Queue","head","tail","real","finally","onFinally","isFunction","$044557d82d23c7b7$var$method","thisArgument","argumentsList","$d991cb3405c95f1e$var$nativeConstruct","$d991cb3405c95f1e$var$ObjectPrototype","$d991cb3405c95f1e$var$push","$d991cb3405c95f1e$var$NEW_TARGET_BUG","$d991cb3405c95f1e$var$ARGS_BUG","$d991cb3405c95f1e$var$FORCED","construct","Target","newTarget","$args","$bLEKU","$8913b2b3e886b877$var$Function","$8913b2b3e886b877$var$concat","$8913b2b3e886b877$var$join","$8913b2b3e886b877$var$factories","$8913b2b3e886b877$var$construct","argsLength","list","partArgs","attributes","deleteProperty","$f6707b6d575f1de3$require$getOwnPropertyDescriptor","$a8ede88258171abd$var$get","receiver","$dxXnz","ownKeys","objectPreventExtensions","$f3bd7d05059f3f8c$var$set","existingDescriptor","ownDescriptor","$1a64a42b0b7fff6e$var$MATCH","$1a64a42b0b7fff6e$var$NativeRegExp","$1a64a42b0b7fff6e$var$RegExpPrototype","$1a64a42b0b7fff6e$var$SyntaxError","SyntaxError","$1a64a42b0b7fff6e$var$getFlags","$1wkuT","$1a64a42b0b7fff6e$var$exec","$1a64a42b0b7fff6e$var$charAt","$1a64a42b0b7fff6e$var$replace","$1a64a42b0b7fff6e$var$stringIndexOf","$1a64a42b0b7fff6e$var$stringSlice","$1a64a42b0b7fff6e$var$IS_NCG","$1a64a42b0b7fff6e$var$re1","$1a64a42b0b7fff6e$var$re2","$1a64a42b0b7fff6e$var$CORRECT_NEW","$1a64a42b0b7fff6e$var$MISSED_STICKY","$5mPjD","MISSED_STICKY","$1a64a42b0b7fff6e$var$UNSUPPORTED_Y","UNSUPPORTED_Y","$1a64a42b0b7fff6e$var$BASE_FORCED","$iolan","$15yb5","$1a64a42b0b7fff6e$var$RegExpWrapper","pattern","flags","rawFlags","dotAll","sticky","handled","thisIsRegExp","patternIsRegExp","$j7Wj1","flagsAreUndefined","groups","rawPattern","named","brackets","ncg","groupid","groupname","$1a64a42b0b7fff6e$var$handleNCG","$1a64a42b0b7fff6e$require$enforceInternalState","raw","$1a64a42b0b7fff6e$var$handleDotAll","$1a64a42b0b7fff6e$var$proxy","$1a64a42b0b7fff6e$require$defineProperty","$1a64a42b0b7fff6e$var$keys","$1a64a42b0b7fff6e$require$getOwnPropertyNames","$1a64a42b0b7fff6e$var$index","$decbe61b88b1ca94$var$MATCH","isRegExp","ignoreCase","multiline","unicode","$3e86d009365b1bcd$var$$RegExp","$3e86d009365b1bcd$var$UNSUPPORTED_Y","re","lastIndex","$3e86d009365b1bcd$var$MISSED_STICKY","$3e86d009365b1bcd$var$BROKEN_CARET","BROKEN_CARET","$d63ae31c41c02162$var$$RegExp","$0cb0c5148b1dfc95$var$$RegExp","$gDZSO","re1","re2","$c1e04a8dd1201ac1$var$nativeReplace","$c1e04a8dd1201ac1$var$nativeExec","$c1e04a8dd1201ac1$var$patchedExec","$c1e04a8dd1201ac1$var$charAt","$c1e04a8dd1201ac1$var$indexOf","$c1e04a8dd1201ac1$var$replace","$c1e04a8dd1201ac1$var$stringSlice","$c1e04a8dd1201ac1$var$UPDATES_LAST_INDEX_WRONG","$c1e04a8dd1201ac1$var$UNSUPPORTED_Y","$c1e04a8dd1201ac1$var$NPCG_INCLUDED","reCopy","group","$c1e04a8dd1201ac1$require$getInternalState","charsAdded","strCopy","$4d9034aa0a7c78c5$var$RegExpPrototype","$e33b07dd25444a37$var$TO_STRING","$e33b07dd25444a37$var$RegExpPrototype","$e33b07dd25444a37$var$n$ToString","$e33b07dd25444a37$var$getFlags","$e33b07dd25444a37$var$NOT_GENERIC","$e33b07dd25444a37$var$INCORRECT_NAME","$e33b07dd25444a37$require$PROPER_FUNCTION_NAME","R","rf","codeAt","codePointAt","pos","$84c537d40dd85849$require$codeAt","$3bbd219b097bf803$var$charAt","$3bbd219b097bf803$var$charCodeAt","$3bbd219b097bf803$var$stringSlice","$3bbd219b097bf803$var$createMethod","CONVERT_TO_STRING","second","position","$a321b1a461d318d9$var$un$EndsWith","endsWith","$a321b1a461d318d9$var$slice","$a321b1a461d318d9$var$min","$a321b1a461d318d9$var$CORRECT_IS_REGEXP_LOGIC","$gkCWb","$a321b1a461d318d9$require$getOwnPropertyDescriptor","searchString","$jliZt","endPosition","search","$e14eb5a118a77d53$var$TypeError","$be3cb7bcec3f6005$var$MATCH","regexp","error1","error2","$5a8165a23fe280d7$var$RangeError","$5a8165a23fe280d7$var$fromCharCode","$5a8165a23fe280d7$var$$fromCodePoint","fromCodePoint","$5a8165a23fe280d7$var$join","elements","$8bf07a5ea4f86bf8$var$stringIndexOf","$421d3bd28a93f302$var$STRING_ITERATOR","$421d3bd28a93f302$var$setInternalState","$421d3bd28a93f302$var$getInternalState","point","$421d3bd28a93f302$require$charAt","$1eJAF","MATCH","nativeMatch","maybeCallNative","matcher","rx","res","$2aUTa","fullUnicode","matchStr","$6DNPg","$0e6a768d17013739$var$SPECIES","$0e6a768d17013739$var$RegExpPrototype","SHAM","SYMBOL","DELEGATES_TO_SYMBOL","DELEGATES_TO_EXEC","execCalled","uncurriedNativeRegExpMethod","nativeMethod","arg2","forceStringMethod","$exec","$4d5d08f9313fe63c$require$charAt","$1958a4db80fb0f43$var$TypeError","padEnd","maxLength","$53960335dda7a9bf$require$$padEnd","$31ce6e790965ee6e$var$repeat","$31ce6e790965ee6e$var$stringSlice","$31ce6e790965ee6e$var$ceil","$31ce6e790965ee6e$var$createMethod","IS_END","fillString","fillLen","stringFiller","intMaxLength","stringLength","fillStr","padStart","$81ed00457f8ab940$require$$padStart","$8577e5a06e0ac04d$var$push","$8577e5a06e0ac04d$var$join","template","rawTemplate","literalSegments","repeat","$009f5df1198ba855$var$REPLACE","$009f5df1198ba855$var$max","$009f5df1198ba855$var$min","$009f5df1198ba855$var$concat","$009f5df1198ba855$var$push","$009f5df1198ba855$var$stringIndexOf","$009f5df1198ba855$var$stringSlice","$009f5df1198ba855$var$REPLACE_KEEPS_$0","$009f5df1198ba855$var$REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE","_","nativeReplace","UNSAFE_SUBSTITUTE","searchValue","replaceValue","functionalReplace","results","accumulatedResult","nextSourcePosition","matched","captures","namedCaptures","replacerArgs","replacement","$tmsHt","$05842203b4d319b5$var$floor","$05842203b4d319b5$var$charAt","$05842203b4d319b5$var$replace","$05842203b4d319b5$var$stringSlice","$05842203b4d319b5$var$SUBSTITUTION_SYMBOLS","$05842203b4d319b5$var$SUBSTITUTION_SYMBOLS_NO_NAMED","tailPos","m","symbols","ch","capture","SEARCH","nativeSearch","searcher","previousLastIndex","$98Orf","$cba551393cb53eca$var$UNSUPPORTED_Y","$cba551393cb53eca$var$MAX_UINT32","$cba551393cb53eca$var$min","$cba551393cb53eca$var$$push","$cba551393cb53eca$var$exec","$cba551393cb53eca$var$push","$cba551393cb53eca$var$stringSlice","$cba551393cb53eca$var$SPLIT_WORKS_WITH_OVERWRITTEN_EXEC","originalExec","SPLIT","nativeSplit","internalSplit","limit","lim","lastLength","output","lastLastIndex","separatorCopy","splitter","unicodeMatching","q","$4872c160a86fd36b$var$un$StartsWith","startsWith","$4872c160a86fd36b$var$stringSlice","$4872c160a86fd36b$var$min","$4872c160a86fd36b$var$CORRECT_IS_REGEXP_LOGIC","$4872c160a86fd36b$require$getOwnPropertyDescriptor","$ecacA","$61e74fc345dbbdfb$require$$trim","$a55a1999ac794209$require$PROPER_FUNCTION_NAME","$6f2ff22016a32dee$var$FORCED","$6f2ff22016a32dee$var$trimEnd","$6f2ff22016a32dee$require$$trimEnd","trimEnd","trimRight","$171362188355f50f$var$FORCED","$171362188355f50f$var$trimStart","$171362188355f50f$require$$trimStart","trimStart","trimLeft","$6PJ8T","anchor","$1nd9Q","$100225492babcc44$var$quot","$100225492babcc44$var$replace","attribute","p1","big","blink","bold","fixed","fontcolor","color","fontsize","italics","link","small","strike","sub","sup","$fMuLF","$b7d334927398c843$var$getInternalState","$b7d334927398c843$var$setInternalState","$b7d334927398c843$var$nativeDefineProperty","$b7d334927398c843$var$nativeGetOwnPropertyDescriptor","$b7d334927398c843$var$round","round","$b7d334927398c843$var$RangeError","$b7d334927398c843$var$ArrayBuffer","$b7d334927398c843$var$ArrayBufferPrototype","$b7d334927398c843$var$DataView","$b7d334927398c843$var$NATIVE_ARRAY_BUFFER_VIEWS","$lKaOf","NATIVE_ARRAY_BUFFER_VIEWS","$b7d334927398c843$var$TYPED_ARRAY_CONSTRUCTOR","TYPED_ARRAY_CONSTRUCTOR","$b7d334927398c843$var$TYPED_ARRAY_TAG","TYPED_ARRAY_TAG","$b7d334927398c843$var$TypedArray","TypedArray","$b7d334927398c843$var$TypedArrayPrototype","TypedArrayPrototype","$b7d334927398c843$var$aTypedArrayConstructor","aTypedArrayConstructor","$b7d334927398c843$var$isTypedArray","isTypedArray","$b7d334927398c843$var$BYTES_PER_ELEMENT","$b7d334927398c843$var$WRONG_LENGTH","$b7d334927398c843$var$fromList","$b7d334927398c843$var$addGetter","$b7d334927398c843$var$isArrayBuffer","klass","$b7d334927398c843$var$isTypedArrayIndex","$b7d334927398c843$var$wrappedGetOwnPropertyDescriptor","$b7d334927398c843$var$wrappedDefineProperty","CLAMPED","BYTES","GETTER","SETTER","NativeTypedArrayConstructor","TypedArrayConstructor","TypedArrayConstructorPrototype","addElement","$gwHTU","typedArrayOffset","$length","$1kqup","$8ecSO","$len","$c081b040a237c76f$var$ArrayBuffer","$c081b040a237c76f$var$Int8Array","Int8Array","$c081b040a237c76f$require$NATIVE_ARRAY_BUFFER_VIEWS","$fd46476516885c65$var$NAME","$fd46476516885c65$var$Constructor","$fd46476516885c65$var$Prototype","$fd46476516885c65$var$Int8Array","$fd46476516885c65$var$Int8ArrayPrototype","$fd46476516885c65$var$Uint8ClampedArray","Uint8ClampedArray","$fd46476516885c65$var$Uint8ClampedArrayPrototype","$fd46476516885c65$var$TypedArray","$fd46476516885c65$var$TypedArrayPrototype","$fd46476516885c65$var$ObjectPrototype","$fd46476516885c65$var$TypeError","$fd46476516885c65$var$TO_STRING_TAG","$fd46476516885c65$var$TYPED_ARRAY_TAG","$fd46476516885c65$var$TYPED_ARRAY_CONSTRUCTOR","$fd46476516885c65$var$NATIVE_ARRAY_BUFFER_VIEWS","opera","$fd46476516885c65$var$TYPED_ARRAY_TAG_REQUIRED","$fd46476516885c65$var$TypedArrayConstructorsList","Uint8Array","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","$fd46476516885c65$var$BigIntArrayConstructorsList","BigInt64Array","BigUint64Array","$fd46476516885c65$var$isTypedArray","aTypedArray","exportTypedArrayMethod","property","ARRAY","exportTypedArrayStaticMethod","isView","$0f7c34f15c2bb5ce$var$RangeError","$dG9ye","$9f569b4629448553$var$RangeError","$5fd99fddcaec4112$require$aTypedArrayConstructor","$b631bbe003371657$var$u$ArrayCopyWithin","$b631bbe003371657$var$aTypedArray","$b631bbe003371657$var$exportTypedArrayMethod","$d69ecf634a10a535$var$aTypedArray","$d69ecf634a10a535$var$exportTypedArrayMethod","$d69ecf634a10a535$require$$every","$4ec5af8a77aa31ac$var$aTypedArray","$4ec5af8a77aa31ac$var$exportTypedArrayMethod","$3586d39acc2774dd$var$aTypedArray","$3586d39acc2774dd$var$exportTypedArrayMethod","$3586d39acc2774dd$require$$filter","$7WNzG","$ijLgx","$97HwV","$6a4688aced6685cb$var$TYPED_ARRAY_CONSTRUCTOR","$6a4688aced6685cb$var$aTypedArrayConstructor","$79db93bd5fca1ce7$var$aTypedArray","$79db93bd5fca1ce7$var$exportTypedArrayMethod","predicate","$79db93bd5fca1ce7$require$$find","$59b8d2c114df5a4e$var$aTypedArray","$59b8d2c114df5a4e$var$exportTypedArrayMethod","$59b8d2c114df5a4e$require$$findIndex","$97423b5d490b4446$var$aTypedArray","$97423b5d490b4446$var$exportTypedArrayMethod","$6a83ddf03671ed91$var$aTypedArray","$6a83ddf03671ed91$var$exportTypedArrayMethod","$6a83ddf03671ed91$require$$includes","$15ed4ef7ba5f52a2$var$aTypedArray","$15ed4ef7ba5f52a2$var$exportTypedArrayMethod","$15ed4ef7ba5f52a2$require$$indexOf","$fc479e6228c9e0bf$var$ITERATOR","$fc479e6228c9e0bf$var$Uint8Array","$fc479e6228c9e0bf$var$arrayValues","$l4lCC","$fc479e6228c9e0bf$var$arrayKeys","$fc479e6228c9e0bf$var$arrayEntries","$fc479e6228c9e0bf$var$aTypedArray","$fc479e6228c9e0bf$var$exportTypedArrayMethod","$fc479e6228c9e0bf$var$TypedArrayPrototype","$fc479e6228c9e0bf$var$GENERIC","$fc479e6228c9e0bf$var$ITERATOR_IS_VALUES","$fc479e6228c9e0bf$var$typedArrayValues","$046afbce50198ca1$var$aTypedArray","$046afbce50198ca1$var$exportTypedArrayMethod","$046afbce50198ca1$var$$join","$f68531cb13917c81$var$aTypedArray","$f68531cb13917c81$var$exportTypedArrayMethod","$937a5b0c74fb830c$var$aTypedArray","$937a5b0c74fb830c$var$exportTypedArrayMethod","$937a5b0c74fb830c$require$$map","$c32e06b56e4a41ef$var$aTypedArrayConstructor","$c32e06b56e4a41ef$var$exportTypedArrayStaticMethod","$ec25c78e10e68660$var$aTypedArray","$ec25c78e10e68660$var$exportTypedArrayMethod","$ec25c78e10e68660$require$$reduce","$7cac9044c9527222$var$aTypedArray","$7cac9044c9527222$var$exportTypedArrayMethod","$7cac9044c9527222$require$$reduceRight","$ead7a01b48e39503$var$aTypedArray","$ead7a01b48e39503$var$exportTypedArrayMethod","$ead7a01b48e39503$var$floor","$e0a5c5b8271df7c6$var$RangeError","$e0a5c5b8271df7c6$var$Int8Array","$e0a5c5b8271df7c6$var$Int8ArrayPrototype","$e0a5c5b8271df7c6$var$$set","$e0a5c5b8271df7c6$var$aTypedArray","$e0a5c5b8271df7c6$var$exportTypedArrayMethod","$e0a5c5b8271df7c6$var$WORKS_WITH_OBJECTS_AND_GEERIC_ON_TYPED_ARRAYS","$e0a5c5b8271df7c6$var$TO_OBJECT_BUG","$c6c88b1d5fcf56c4$var$aTypedArray","$c6c88b1d5fcf56c4$var$exportTypedArrayMethod","$3f60740c905767a3$var$aTypedArray","$3f60740c905767a3$var$exportTypedArrayMethod","$3f60740c905767a3$require$$some","$5c101bffda9b4dc5$var$Array","$5c101bffda9b4dc5$var$aTypedArray","$5c101bffda9b4dc5$var$exportTypedArrayMethod","$5c101bffda9b4dc5$var$Uint16Array","$5c101bffda9b4dc5$var$un$Sort","$5c101bffda9b4dc5$var$ACCEPT_INCORRECT_ARGUMENTS","$5c101bffda9b4dc5$var$STABLE_SORT","mod","expected","$5c101bffda9b4dc5$var$getSortCompare","$54a89f2dea9e9012$var$aTypedArray","$54a89f2dea9e9012$var$exportTypedArrayMethod","begin","beginIndex","BYTES_PER_ELEMENT","$88d44de1a6a90a41$var$Int8Array","$88d44de1a6a90a41$var$aTypedArray","$88d44de1a6a90a41$var$exportTypedArrayMethod","$88d44de1a6a90a41$var$$toLocaleString","toLocaleString","$88d44de1a6a90a41$var$TO_LOCALE_STRING_BUG","$e88adbad4d614fed$var$Uint8Array","$e88adbad4d614fed$var$Uint8ArrayPrototype","$e88adbad4d614fed$var$arrayToString","$e88adbad4d614fed$var$join","$e88adbad4d614fed$var$IS_NOT_ARRAY_METHOD","$0af78d12490b7b6f$var$InternalWeakMap","$0af78d12490b7b6f$var$IS_IE11","$0af78d12490b7b6f$var$wrapper","$0af78d12490b7b6f$var$$WeakMap","$lGvw2","$0af78d12490b7b6f$var$WeakMapPrototype","$0af78d12490b7b6f$var$nativeDelete","$0af78d12490b7b6f$var$nativeHas","$0af78d12490b7b6f$var$nativeGet","$0af78d12490b7b6f$var$nativeSet","$0af78d12490b7b6f$require$enforceInternalState","frozen","$fc95f796e98c0c9a$var$setInternalState","$fc95f796e98c0c9a$var$internalStateGetterFor","$fc95f796e98c0c9a$var$find","$9otZn","$fc95f796e98c0c9a$var$findIndex","$fc95f796e98c0c9a$var$splice","$fc95f796e98c0c9a$var$id","$fc95f796e98c0c9a$var$uncaughtFrozenStore","$fc95f796e98c0c9a$var$UncaughtFrozenStore","$fc95f796e98c0c9a$var$findUncaughtFrozen","$fc95f796e98c0c9a$require$getWeakData","$983ff28d45588730$var$TO_STRING_TAG","$983ff28d45588730$var$Error","$983ff28d45588730$var$push","$983ff28d45588730$var$$AggregateError","errors","message","isInstance","$983ff28d45588730$var$AggregateErrorPrototype","$l5aDI","$1hDjD","$7w1I6","stack","$fSh1A","errorsArray","AggregateError","$578cd93057827280$var$replace","$578cd93057827280$var$TEST","$578cd93057827280$var$V8_OR_CHAKRA_STACK_ENTRY","$578cd93057827280$var$IS_V8_OR_CHAKRA_STACK","dropEntries","cause","$default","$15b9214f17cc4215$var$Object","$15b9214f17cc4215$var$initializer","compositeKey","$8p7xn","$61e681497820a0b0$var$Object","$61e681497820a0b0$var$TypeError","$61e681497820a0b0$var$Map","$61e681497820a0b0$var$WeakMap","$61e681497820a0b0$var$Node","primitives","objectsByIndex","initializer","IS_OBJECT","$61e681497820a0b0$var$root","active","compositeSymbol","deleteAll","wasDeleted","collection","remover","allDeleted","$7AisJ","Map","newMap","findKey","$d9101a8b8952cf02$var$push","nextItem","$266b05ec1b53f26d$var$push","groupBy","keyDerivative","derivedKey","$j1P8I","keyBy","keyOf","mapKeys","mapValues","merge","$0cb343ee31a7f56b$var$TypeError","noInitial","accumulator","$58d9b99d231b61f5$var$TypeError","update","isPresentInMap","$99469c90a1670338$var$min","$99469c90a1670338$var$max","clamp","lower","upper","DEG_PER_RAD","PI","$7afc466313ad437e$var$RAD_PER_DEG","degrees","radians","fscale","inLow","inHigh","outLow","outHigh","$kPZzt","$ax2Zy","scale","nx","nInLow","nInHigh","nOutLow","nOutHigh","iaddh","x0","x1","y0","y1","$x0","$y0","imulh","u","$u","$v","u0","v0","u1","v1","isubh","RAD_PER_DEG","$8203115ff05fcb06$var$DEG_PER_RAD","$83af51d30afa2190$var$SEEDED_RANDOM","$83af51d30afa2190$var$SEEDED_RANDOM_GENERATOR","$83af51d30afa2190$var$setInternalState","$83af51d30afa2190$var$getInternalState","$83af51d30afa2190$var$TypeError","$83af51d30afa2190$var$$SeededRandomGenerator","seed","seededPRNG","$4JrHk","signbit","umulh","$2ad16c82d7e5bdda$var$INVALID_NUMBER_REPRESENTATION","$2ad16c82d7e5bdda$var$RangeError","$2ad16c82d7e5bdda$var$SyntaxError","$2ad16c82d7e5bdda$var$TypeError","$2ad16c82d7e5bdda$var$valid","$2ad16c82d7e5bdda$var$charAt","$2ad16c82d7e5bdda$var$exec","$2ad16c82d7e5bdda$var$numberToString","$2ad16c82d7e5bdda$var$stringSlice","fromString","mathNum","$125e49295718c6c9$var$$$OBSERVABLE","$125e49295718c6c9$var$OBSERVABLE","$125e49295718c6c9$var$SUBSCRIPTION","$125e49295718c6c9$var$SUBSCRIPTION_OBSERVER","$125e49295718c6c9$var$getterFor","$125e49295718c6c9$var$setInternalState","$125e49295718c6c9$var$getObservableInternalState","$125e49295718c6c9$var$getSubscriptionInternalState","$125e49295718c6c9$var$getSubscriptionObserverInternalState","$125e49295718c6c9$var$Array","$125e49295718c6c9$var$SubscriptionState","observer","cleanup","subscriptionObserver","clean","subscription","closed","isClosed","$125e49295718c6c9$var$Subscription","subscriber","subscriptionState","$125e49295718c6c9$var$SubscriptionObserver","unsubscribe","$125e49295718c6c9$require$defineProperty","nextMethod","errorMethod","err","complete","completeMethod","$125e49295718c6c9$var$$Observable","$125e49295718c6c9$var$ObservablePrototype","subscribe","observableMethod","observable","Observable","allSettled","promiseResolve","status","$e2179bcb26acbb4b$var$PROMISE_ANY_ERROR","any","alreadyResolved","alreadyRejected","try","$6ec782fcb928f430$var$toMetadataKey","$aLynb","toKey","$6ec782fcb928f430$var$ordinaryDefineOwnMetadata","defineMetadata","metadataKey","metadataValue","targetKey","$7d68f4e7e4c4b782$var$Map","$7d68f4e7e4c4b782$var$WeakMap","$7d68f4e7e4c4b782$var$push","$7d68f4e7e4c4b782$var$metadata","$7d68f4e7e4c4b782$var$store","$7d68f4e7e4c4b782$var$getOrCreateMetadataMap","targetMetadata","keyMetadata","getMap","MetadataKey","metadataMap","MetadataValue","$9af708e71367b103$var$toMetadataKey","$9af708e71367b103$var$getOrCreateMetadataMap","$9af708e71367b103$var$store","deleteMetadata","$f1e6afa3d172152e$var$ordinaryHasOwnMetadata","$f1e6afa3d172152e$var$ordinaryGetOwnMetadata","$f1e6afa3d172152e$var$toMetadataKey","$f1e6afa3d172152e$var$ordinaryGetMetadata","getMetadata","$ff72e5bc2a0c8764$var$arrayUniqueBy","$ff72e5bc2a0c8764$var$concat","$ff72e5bc2a0c8764$var$ordinaryOwnMetadataKeys","$ff72e5bc2a0c8764$var$toMetadataKey","$ff72e5bc2a0c8764$var$ordinaryMetadataKeys","oKeys","pKeys","getMetadataKeys","$579ba129125d1fa5$var$Map","$579ba129125d1fa5$var$MapPrototype","$579ba129125d1fa5$var$mapForEach","$579ba129125d1fa5$var$mapHas","$579ba129125d1fa5$var$mapSet","$579ba129125d1fa5$var$push","resolver","resolverFunction","$711ec71648de990d$var$ordinaryGetOwnMetadata","$711ec71648de990d$var$toMetadataKey","getOwnMetadata","$1901db538b4d77f7$var$ordinaryOwnMetadataKeys","$1901db538b4d77f7$var$toMetadataKey","getOwnMetadataKeys","$f21eeb678da61698$var$ordinaryHasOwnMetadata","$f21eeb678da61698$var$toMetadataKey","$f21eeb678da61698$var$ordinaryHasMetadata","hasMetadata","$a93863ffbbf45637$var$ordinaryHasOwnMetadata","$a93863ffbbf45637$var$toMetadataKey","hasOwnMetadata","$8e7798a8c8e81c9d$var$toMetadataKey","$8e7798a8c8e81c9d$var$ordinaryDefineOwnMetadata","addAll","adder","difference","newSet","$iEP2p","Set","intersection","hasCheck","isDisjointFrom","isSubsetOf","otherSet","isSupersetOf","$aed530c20c995f87$var$arrayJoin","$aed530c20c995f87$var$push","sep","$267b8f450c83d607$var$TypeError","symmetricDifference","union","at","relativeIndex","$4553b2908c7726ba$require$charAt","$be139b4dd007a70a$var$codeAt","$57ZgD","$be139b4dd007a70a$var$charAt","$be139b4dd007a70a$var$STRING_ITERATOR","$be139b4dd007a70a$var$setInternalState","$be139b4dd007a70a$var$getInternalState","$be139b4dd007a70a$var$$StringIterator","codePoint","codePoints","$494c22fb3259e451$var$MATCH_ALL","$494c22fb3259e451$var$REGEXP_STRING","$494c22fb3259e451$var$REGEXP_STRING_ITERATOR","$494c22fb3259e451$var$setInternalState","$494c22fb3259e451$var$getInternalState","$494c22fb3259e451$var$RegExpPrototype","$494c22fb3259e451$var$TypeError","$494c22fb3259e451$var$getFlags","$494c22fb3259e451$var$stringIndexOf","$494c22fb3259e451$var$un$MatchAll","matchAll","$494c22fb3259e451$var$WORKS_WITH_NON_GLOBAL_REGEX","$494c22fb3259e451$var$$RegExpStringIterator","$global","$494c22fb3259e451$var$$matchAll","flagsValue","$578275b064831efe$var$REPLACE","$578275b064831efe$var$RegExpPrototype","$578275b064831efe$var$TypeError","$578275b064831efe$var$getFlags","$578275b064831efe$var$indexOf","$578275b064831efe$var$replace","$578275b064831efe$var$stringSlice","$578275b064831efe$var$max","$578275b064831efe$var$stringIndexOf","replaceAll","IS_REG_EXP","searchLength","advanceBy","endOfLastMatch","$ed4078936178e184$var$handlePrototype","CollectionPrototype","$iLKSv","$ed4078936178e184$var$COLLECTION_NAME","$2vChI","$atkun","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DOMTokenList","DataTransferItemList","FileList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList","$79fc817da0f47b47$var$classList","classList","$79fc817da0f47b47$var$DOMTokenListPrototype","$daa0fad1a5e71fc1$var$STRICT_METHOD","$daa0fad1a5e71fc1$require$$forEach","$353bf2319d4355ad$var$ITERATOR","$353bf2319d4355ad$var$TO_STRING_TAG","$353bf2319d4355ad$var$ArrayValues","$353bf2319d4355ad$var$handlePrototype","COLLECTION_NAME","$353bf2319d4355ad$var$COLLECTION_NAME","$4sgQc","$aa0122136da199d1$var$process","queueMicrotask","$ca49c6c3f5b8ed45$var$EOF","$ca49c6c3f5b8ed45$var$setInternalState","$ca49c6c3f5b8ed45$var$getInternalURLState","$ca49c6c3f5b8ed45$var$URLSearchParams","$kfur8","URLSearchParams","$ca49c6c3f5b8ed45$var$getInternalSearchParamsState","getState","$ca49c6c3f5b8ed45$var$NativeURL","URL","$ca49c6c3f5b8ed45$var$TypeError","$ca49c6c3f5b8ed45$var$parseInt","$ca49c6c3f5b8ed45$var$floor","$ca49c6c3f5b8ed45$var$pow","$ca49c6c3f5b8ed45$var$charAt","$ca49c6c3f5b8ed45$var$exec","$ca49c6c3f5b8ed45$var$join","$ca49c6c3f5b8ed45$var$numberToString","$ca49c6c3f5b8ed45$var$pop","pop","$ca49c6c3f5b8ed45$var$push","$ca49c6c3f5b8ed45$var$replace","$ca49c6c3f5b8ed45$var$shift","$ca49c6c3f5b8ed45$var$split","$ca49c6c3f5b8ed45$var$stringSlice","$ca49c6c3f5b8ed45$var$toLowerCase","$ca49c6c3f5b8ed45$var$unshift","unshift","$ca49c6c3f5b8ed45$var$INVALID_SCHEME","$ca49c6c3f5b8ed45$var$INVALID_HOST","$ca49c6c3f5b8ed45$var$INVALID_PORT","$ca49c6c3f5b8ed45$var$ALPHA","$ca49c6c3f5b8ed45$var$ALPHANUMERIC","$ca49c6c3f5b8ed45$var$DIGIT","$ca49c6c3f5b8ed45$var$HEX_START","$ca49c6c3f5b8ed45$var$OCT","$ca49c6c3f5b8ed45$var$DEC","$ca49c6c3f5b8ed45$var$HEX","$ca49c6c3f5b8ed45$var$FORBIDDEN_HOST_CODE_POINT","$ca49c6c3f5b8ed45$var$FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT","$ca49c6c3f5b8ed45$var$LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE","$ca49c6c3f5b8ed45$var$TAB_AND_NEW_LINE","$ca49c6c3f5b8ed45$var$serializeHost","compress","ignore0","ipv6","maxIndex","currStart","currLength","$ca49c6c3f5b8ed45$var$findLongestZeroSequence","$ca49c6c3f5b8ed45$var$C0ControlPercentEncodeSet","$ca49c6c3f5b8ed45$var$fragmentPercentEncodeSet","$ca49c6c3f5b8ed45$var$pathPercentEncodeSet","$ca49c6c3f5b8ed45$var$userinfoPercentEncodeSet","$ca49c6c3f5b8ed45$var$percentEncode","$ca49c6c3f5b8ed45$require$codeAt","encodeURIComponent","$ca49c6c3f5b8ed45$var$specialSchemes","ftp","file","http","https","ws","wss","$ca49c6c3f5b8ed45$var$isWindowsDriveLetter","normalized","$ca49c6c3f5b8ed45$var$startsWithWindowsDriveLetter","$ca49c6c3f5b8ed45$var$isSingleDot","segment","$ca49c6c3f5b8ed45$var$SCHEME_START","$ca49c6c3f5b8ed45$var$SCHEME","$ca49c6c3f5b8ed45$var$NO_SCHEME","$ca49c6c3f5b8ed45$var$SPECIAL_RELATIVE_OR_AUTHORITY","$ca49c6c3f5b8ed45$var$PATH_OR_AUTHORITY","$ca49c6c3f5b8ed45$var$RELATIVE","$ca49c6c3f5b8ed45$var$RELATIVE_SLASH","$ca49c6c3f5b8ed45$var$SPECIAL_AUTHORITY_SLASHES","$ca49c6c3f5b8ed45$var$SPECIAL_AUTHORITY_IGNORE_SLASHES","$ca49c6c3f5b8ed45$var$AUTHORITY","$ca49c6c3f5b8ed45$var$HOST","$ca49c6c3f5b8ed45$var$HOSTNAME","$ca49c6c3f5b8ed45$var$PORT","$ca49c6c3f5b8ed45$var$FILE","$ca49c6c3f5b8ed45$var$FILE_SLASH","$ca49c6c3f5b8ed45$var$FILE_HOST","$ca49c6c3f5b8ed45$var$PATH_START","$ca49c6c3f5b8ed45$var$PATH","$ca49c6c3f5b8ed45$var$CANNOT_BE_A_BASE_URL_PATH","$ca49c6c3f5b8ed45$var$QUERY","$ca49c6c3f5b8ed45$var$FRAGMENT","$ca49c6c3f5b8ed45$var$URLState","isBase","base","baseState","failure","searchParams","urlString","parse","bindURL","stateOverride","bufferCodePoints","pointer","seenAt","seenBracket","seenPasswordToken","scheme","username","password","port","path","query","fragment","cannotBeABaseURL","isSpecial","includesCredentials","encodedCodePoints","parseHost","shortenPath","numbersSeen","ipv4Piece","swaps","swap","address","pieceIndex","$ca49c6c3f5b8ed45$var$parseIPv6","$fTJdw","partsLength","numbers","part","ipv4","parts","$ca49c6c3f5b8ed45$var$parseIPv4","cannotHaveUsernamePasswordPort","pathSize","serialize","setHref","href","getOrigin","$ca49c6c3f5b8ed45$var$URLConstructor","origin","getProtocol","setProtocol","getUsername","setUsername","getPassword","setPassword","getHost","setHost","getHostname","setHostname","hostname","getPort","setPort","getPathname","setPathname","pathname","getSearch","setSearch","getSearchParams","getHash","setHash","hash","$ca49c6c3f5b8ed45$var$URLPrototype","$ca49c6c3f5b8ed45$var$accessorDescriptor","$ca49c6c3f5b8ed45$require$defineProperties","$ca49c6c3f5b8ed45$var$nativeCreateObjectURL","createObjectURL","$ca49c6c3f5b8ed45$var$nativeRevokeObjectURL","revokeObjectURL","$jQmSw","$e7249ecef49e6e4f$var$ITERATOR","$b92f1140f6de596b$var$maxInt","$b92f1140f6de596b$var$regexNonASCII","$b92f1140f6de596b$var$regexSeparators","$b92f1140f6de596b$var$OVERFLOW_ERROR","$b92f1140f6de596b$var$RangeError","$b92f1140f6de596b$var$exec","$b92f1140f6de596b$var$floor","$b92f1140f6de596b$var$fromCharCode","$b92f1140f6de596b$var$charCodeAt","$b92f1140f6de596b$var$join","$b92f1140f6de596b$var$push","$b92f1140f6de596b$var$replace","$b92f1140f6de596b$var$split","$b92f1140f6de596b$var$toLowerCase","$b92f1140f6de596b$var$digitToBasic","digit","$b92f1140f6de596b$var$adapt","delta","numPoints","firstTime","$b92f1140f6de596b$var$baseMinusTMin","$b92f1140f6de596b$var$base","$b92f1140f6de596b$var$encode","extra","$b92f1140f6de596b$var$ucs2decode","currentValue","inputLength","bias","basicLength","handledCPCount","handledCPCountPlusOne","qMinusT","baseMinusT","label","encoded","labels","$ebdcd16dd431135f$var$ITERATOR","$ebdcd16dd431135f$var$URL_SEARCH_PARAMS","$ebdcd16dd431135f$var$URL_SEARCH_PARAMS_ITERATOR","$ebdcd16dd431135f$var$setInternalState","$ebdcd16dd431135f$var$getInternalParamsState","$ebdcd16dd431135f$var$getInternalIteratorState","$ebdcd16dd431135f$var$n$Fetch","$ebdcd16dd431135f$var$N$Request","$ebdcd16dd431135f$var$Headers","$ebdcd16dd431135f$var$RequestPrototype","$ebdcd16dd431135f$var$HeadersPrototype","$ebdcd16dd431135f$var$RegExp","$ebdcd16dd431135f$var$TypeError","$ebdcd16dd431135f$var$decodeURIComponent","decodeURIComponent","$ebdcd16dd431135f$var$encodeURIComponent","$ebdcd16dd431135f$var$charAt","$ebdcd16dd431135f$var$join","$ebdcd16dd431135f$var$push","$ebdcd16dd431135f$var$replace","$ebdcd16dd431135f$var$shift","$ebdcd16dd431135f$var$splice","$ebdcd16dd431135f$var$split","$ebdcd16dd431135f$var$stringSlice","$ebdcd16dd431135f$var$plus","$ebdcd16dd431135f$var$sequences","$ebdcd16dd431135f$var$percentSequence","$ebdcd16dd431135f$var$percentDecode","sequence","$ebdcd16dd431135f$var$deserialize","$ebdcd16dd431135f$var$find","$ebdcd16dd431135f$var$replacements","$ebdcd16dd431135f$var$replacer","$ebdcd16dd431135f$var$serialize","$ebdcd16dd431135f$var$URLSearchParamsIterator","params","$ebdcd16dd431135f$var$URLSearchParamsState","parseObject","parseQuery","entryIterator","entryNext","updateURL","$ebdcd16dd431135f$var$URLSearchParamsConstructor","$ebdcd16dd431135f$var$URLSearchParamsPrototype","append","$lRXJh","getAll","found","$ebdcd16dd431135f$var$headersHas","$ebdcd16dd431135f$var$headersSet","$ebdcd16dd431135f$var$wrapRequestOptions","headers","fetch","$ebdcd16dd431135f$var$RequestConstructor","Request","$febce133319278e2$var$TypeError","passed","required","t1","e1","createDocumentFragment","Node","Element","Document","DocumentFragment","$cf5d938ee512ebca$export$96f6458b62e4c2c","pProject","pOptions","translateSmoothing","sizeWatcher","brushSettingService","emitSize","klCanvasWorkspace","setCursorSize","importFinishedLoading","importedImage","filename","optionStr","getResizedDimensions","width","height","w","h","klMaxCanvasSize","importAsImage","resizedDimensions","tempCanvas","$eWjiX","BB","getContext","drawImage","resizeCanvas","klCanvas","reset","layerName","layerManager","setCurrentLayer","getLayer","resetView","getScale","getAngleDeg","importAsImagePsd","convertedPsdObj","cropObj1","crop","targetCanvas","cropCanvas","cropObj","cropCanvas1","i1","item1","layerIndex","showImportAsLayerDialog","klRootEl","transformObj","isPixelated","pause","addLayer","getLayers","renameLayer","activeLayerIndex","activeLayerContext","getLayerContext","drawTransformedImageWithBounds","tool","action","copyCanvas","popup","buttons","$hrnUX","KL","showImportImageDialog","maxSize","importAsLayer","files","showWarningPsdFlattened","extension","f1","maxResolution","doShowLoader","loaderIsOpen","closeLoader","FileReader","readerResult","agPsdLazy","convertedPsd","PSD","skipLayerImageData","skipThumbnail","alert","webkitURL","im","Image","loadImage","hasUnsupportedFile","collapseThreshold","getElement","setDirection","uiState","toolspaceCollapser","isOpen","css","setSize","uiWidth","toolWidth","uiHeight","setWide","statusOverlay","toolspace","borderLeft","borderRight","setUiState","updateCollapse","setCurrentBrush","brushId","lastNonEraserBrushId","pcColorSlider","currentBrushId","currentBrush","brushUiObj","setColor","currentColor","setContext","currentLayerCtx","setMode","toolspaceToolRow","setActive","updateMainTabVisibility","layer","context","layerPreview","setLayer","newImageDialog","getSecondaryRGB","innerWidth","handUi","onCancel","shareImage","shareCanvas","getCompleteCanvas","fileName","getDate","filenameBase","title","mainTabRow","activeStr","getActive","oldTabId","getOpenedTabId","keysArr","draw","hand","shape","setIsVisible","showCrop","clipboardDialog","inputObj","top","bottom","history","filterLib","cropExtend","screen","localStorage","getItem","app","pEl","ctx","fillStyle","fillRect","projectStore","innerHeight","exportType","KlCanvas","projectObj","setHistory","initState","copy","focus","getLayerCount","initBrushes","brushes","subscriberArr","RGB","skipSubscriber","emitColor","rgbObj","emitOpacity","opacity","emitSliderConfig","config","setOpacity","getColor","getSize","getOpacity","getSliderConfig","sizeSlider","brushesUI","opacitySlider","EventChain","LineSmoothing","LineSanitizer","pointerEvents","startLine","pressure","requestFrame","goLine","isCoalesced","setLastDrawEvent","endLine","getBrush","drawLineSegment","isBold","isItalic","KlCanvasWorkspace","drawEventChain","chainIn","onPick","isDragDone","pickingDone","canvasX","canvasY","getLayerIndex","floodFill","fillUi","getTolerance","getSample","getGrow","getContiguous","onText","angleRad","dialogCounter","textToolDialog","secondaryColor","textToolSettings","align","font","onConfirm","colorRGBA","text","textStr","ColorConverter","toRgbaStr","typeStr","undo","out","fitView","comboStr","preventDefault","returnValue","undoRedoCatchup","redo","saveToComputer","save","success","getProject","t0","copyToClipboard","keyListener","comboOnlyContains","keyStr","translateView","setAngle","decreaseSize","increaseSize","layerFill","eraser","getIsTransparentBg","clearLayer","g","brushTabRow","swapColors","onUp","PcImageDropper","onDrop","handleFileSelect","enabledTest","pasteEvent","clipboardData","getAsFile","retrieveImageFromClipboardAsBlob","imageBlob","img","onload","URLObj","getAsString","pasteStr","onerror","crossOrigin","hexToRGB","b2","Ui","StatusOverlay","handleClick","toolspaceTopRow","overlayToolspace","OverlayToolspace","lineSanitizer","getIsDrawing","overflow","userSelect","$85H3x","ToolspaceTopRow","onHelp","$5ebUJ","showIframePopup","overlay","abrupt","onLeftRight","updateUi","logoImg","onLogo","onNew","showNewImageDialog","onImport","fileTab","triggerImport","onSave","onShare","addClassName","marginBottom","ToolspaceToolRow","onActivate","zoomByStep","isPressed","addListener","setEnableUndo","canUndo","setEnableRedo","canRedo","PcColorSlider","svHeight","startValue","p_color","setHeight","setPickCallback","doPick","colorDiv","margin","flexWrap","justifyContent","alignItems","toolspaceStabilizerRow","ToolspaceStabilizerRow","smoothing","onSelect","lineSmoothing","setSmoothing","getOutputElement","TabRow","createTab","tooltip","onOpen","onClose","result1","keyArr","b1","brushDiv","HandUi","onReset","onFit","onAngleChange","angleDeg","isRelative","FillUi","colorSlider","textUi","TextUi","shapeUi","ShapeUi","shapeTool","ShapeTool","onShape","isDone","y2","shapeObj","getShape","isOutwards","getIsOutwards","isEraser","getIsEraser","strokeRgb","lineWidth","getLineWidth","isAngleSnap","getIsSnap","isFixedRatio","getIsFixed","getMode","fillRgb","setComposite","drawShape","pcLayerManager","LayerPreview","FilterTab","UndoRedoCatchup","clctx","catchup","SaveToComputer","FileTab","imgurUpload","imgurKey","isVisible","filterTab","show","hide","bottomBarWrapper","textAlign","$iUR3L","importFilters","$9cbe98d1fb398012$export$6e4a713ddcda1e5e","$dAXbp","$3P46L","$705qg","drawProject","$aSJRf","WorkspaceSvgOverlay","$7bo3M","$9XK0C","KlCanvasPreview","$i5nyl","filterLibStatus","$kyVjY","$6rdi0","renderText","$h20yl","floodFillBits","$30Cml","$3ujzu","setDbName","$9BlwZ","indexedDb","ProjectStore","$6mTnI","loadAgPsd","$lkluh","$eyygR","calcSliderFalloffFactor","$l4PqG","CheckBox","$lXqiv","Checkbox","$c4LUw","Select","$21VAD","ImageToggle","$jKOQl","ImageRadioList","$gmlbk","RadioList","$bHZQg","penPressureToggle","$fCJWy","PcSlider","$3sAQY","HexColorDialog","$lfHl9","$6kRMg","PcSmallColorSlider","$5TF1N","PointSlider","$bd9hB","ColorOptions","$9A7OD","Options","$iskOY","$bmB93","CropCopy","$hRdOL","TabMenu","$9mAp3","$1UV8s","FreeTransform","$cNhNm","FreeTransformCanvas","$kEeSq","Cropper","$32CBv","$kqmpc","showSaveReminderToast","$9UZfd","FittedImage","$j1kEL","$fIdXJ","$9p4Zp","$8jqzp","ToolDropdown","$84zxV","$9Kxky","$1Ax5m","$e4sAN","ToolspaceCollapser","$1uc3b","BrowserStorageUi","$9pcu9","$afeCg","$i8UFO","$ekHRj","Popup","exportDialog","$auloj","$isYih","ProgressPopup","$biMpK","$8ebuX","$76Qvv","$keKW3","$kDGzx","$khi8I","$dJXmR","$iS9xS","$9J17G","$eK8ID","$2umOB","broadcast","clearCount","hInterface","dataArr","listeners","pauseStack","maxState","currentIndex","$b60fce38973759d6$export$28b6f4d98dde9845","l","bufferUpdate","getActionNumber","$9fd01211d0fde0a8$export$63b4813c5280c707","closePopup","destructed","clearSelection","destroy","removeEventListener","closingLayer","onClosingLayerClick","xButton","onclick","buttonArr","wheelPrevent","cursor","autoFocusArr","autoFocus","cell","navigator","appName","innerHTML","marginRight","buttonWrapper","clickOnEnterButton","addbutton","button","minWidth","marginLeft","primaries","$c0kqC","$fh18w","clickOnEnter","KeyListener","isInputFocused","click","stopPropagation","closefunc","clearInterval","updateInterval","updatePos","destroyEl","bgEl","elW","popupEl","offsetWidth","elH","offsetHeight","background","animationName","animationDuration","animationTimingFunction","onClick","isCssMinMaxSupported","borderRadius","boxShadow","titleHeight","paddingLeft","titleEl","lineHeight","contentEl","$dd0d395ff14a3e11$export$17eb8275e0c4cab8","$dd0d395ff14a3e11$export$f5386afdb763a67e","$05ec456c8871d48f$export$921068d8846a1559","eventUsesHighResTimeStamp","$6J2My","mouseEventHasMovement","hasPointerEvents","hasWebGl","getVisitor","canShareFiles","getPageOffset","$7jh4K","insertAfter","setAttributes","removeClassName","fitInto","centerWithin","gcd","decToFraction","imageBlobToUrl","dateDayDifference","copyObj","createSvg","BbLog","$i0uIf","mix","$eg83P","dist","distSquared","lenSquared","pointsToAngleRad","pointsToAngleDeg","rotate","rotateAround","Matrix","$kVHNC","Vec2","$4toIY","intDxy","roundEven","roundUneven","updateBounds","projectPointOnLine","$af1iA","PointLine","BezierLine","SplineInterpolator","quadraticSplineInput","$eelgW","createCanvas","$eIcQa","testShouldPixelate","drawTransformedImageOnCanvas","createCheckerCanvas","createCheckerDataUrl","convertToAlphaChannelCanvas","HSV","$dJ1E2","CMYK","testIsWhiteBestContrast","appendTextDiv","$72Jv0","makeUnfocusable","$h4olN","setEventListener","$idV3L","PointerListener","$04lDo","$exufe","$cdd5ef6b176accd6$var$listenerFuncObj","$cdd5ef6b176accd6$export$d031894fc27e45","DomEl","listener","$cdd5ef6b176accd6$export$3f65cefe8380dbea","$cdd5ef6b176accd6$export$8ff9f68337b520c0","hasWebgl","visitor","$878b1f179a521546$export$b7d78993b74f766d","userAgent","$878b1f179a521546$export$4ec3bfbae69fbb50","Event","timeStamp","$878b1f179a521546$export$ebcc19037a7ab076","mouseEvent","MouseEvent","$878b1f179a521546$export$b7b64c480b083ae0","PointerEvent","$878b1f179a521546$export$9cbe517943afd6db","premultipliedAlpha","$878b1f179a521546$export$96cd70eaafd80100","chrome","gl","$878b1f179a521546$export$fe0a7220ab4eecad","offsetLeft","$878b1f179a521546$export$558f5e20caee48c2","$44dda2e48e48a872$export$cd3d1f114b139967","$2bd9b7b9bc92046d$export$b8cabc1f5e40859","offsetTop","offsetParent","$2bd9b7b9bc92046d$export$c4f94c8b3850a5a9","referenceNode","newNode","insertBefore","nextSibling","$2bd9b7b9bc92046d$export$fe58198efe02b173","check","$2bd9b7b9bc92046d$export$dbf350e5966cf602","styleObj","alignContent","webkitUserSelect","$2bd9b7b9bc92046d$export$74da2cba014bdc09","attrObj","setAttribute","$2bd9b7b9bc92046d$export$5cf2b5b76bc9d0c","classStr","classAttr","getAttribute","splitArr","$2bd9b7b9bc92046d$export$1789407f05ca7654","$2bd9b7b9bc92046d$export$10d8903dec122b9d","els","$2bd9b7b9bc92046d$export$fa55905620c22535","aw","ah","bw","bh","$2bd9b7b9bc92046d$export$76d0c1a172b67a61","$2bd9b7b9bc92046d$export$aa350b96d91cd94","date","getFullYear","getMonth","getHours","getMinutes","$2bd9b7b9bc92046d$export$f81847884871263e","$2bd9b7b9bc92046d$export$533b26079ad0b4b","numerator","denominator","$2bd9b7b9bc92046d$export$8215e6b900906daa","decimalNumber","$2bd9b7b9bc92046d$export$5063ec57a23c4f2e","blobObj","Blob","fauxBlob","encoding","$2bd9b7b9bc92046d$export$1093707c159148e8","dateA","dateB","setHours","getTime","$2bd9b7b9bc92046d$export$af0d87255f3cfd7e","$2bd9b7b9bc92046d$export$331c30fd60da0115","mimetype","toBlob","filesArray","File","share","$2bd9b7b9bc92046d$export$b981489921ee18cd","clickEvent","tagName","allowClick","$2bd9b7b9bc92046d$export$c54fe3b9ecaa84cf","createElementNS","elementType","childrenArr","$74d1f29ad2137b2c$var$globalKey","emitDown","d","listenerArr","emitUp","keyDown","keyCode","keyToKeyStrObj","isDownObj","comboArr","codeIsDownObj","keyUp","oldComboStr","blur","eventArr","keyToKeyStrArr","i2","keyStrToKeyObj","alt","ctrl","cmd","esc","backspace","sqbr_open","sqbr_close","plus","minus","up","down","home","code1","remove","getIsDown","getCombo","$74d1f29ad2137b2c$export$f17908c5de22d32e","onDown","onBlur","ref","keyStrArr","pointerArr","pressureNormalizeAvgCount","pressureNormalizeAvgPressure","pressureNormalizeIsComplete","pressureNormalizeFactor","$893e90c2dcf687ac$var$WheelCleaner","endSequenceTimeout","deltaY","sequenceUnit","pageX","pageY","endSequence","toEmitDelta","knownUnitArr","sequenceLength","clearTimeout","deltaMode","absDelta","$893e90c2dcf687ac$export$9371bd96776f4e82","updateOffset","targetElement","offsetObj","getDragObj","pointerId","dragObjArr","removeDragObj","removedDragObj","dragPointerIdArr","normalizePressure","correctPointerEvent","corrected","correctedObj","pointerType","movementX","movementY","timeStampOffset","eventPreventDefault","eventStopPropagation","customPressure","isFirefox","coalescedEventArr","getCoalescedEvents","pointerObj","getPointer","lastPageX","lastPageY","addPointer","totalLastX","totalLastY","eventItem","coalescedArr","correctedEvent","custom","time","coalescedItem","relX","relY","dX","dY","createTouchOutEvent","touchListItem","touchEvent","identifier","destroyDocumentListeners","onGlobalPointerMove","onGlobalPointerUp","onGlobalPointerLeave","onPointerEnter","isOverCounter","onEnterLeaveCallback","onPointerLeave","onPointermove","tempLastPointerType","lastPointerType","maxPointers","didSkip","outEvent","createPointerOutEvent","onPointerCallback","dragObj","downPageX","downPageY","buttonsToStr","clearTouchTimeout","setTouchTimeout","lastTimeStamp","outEvent1","touchTimeout","fakeEvent","performance","onTouchTimeout","onPointer","onWheelCallback","onWheel","onEnterLeave","wheelCleaner","wheelEvent","isDestroyed","timing","navigationStart","onPointerdown","touchArr","changedTouches","touchObj","onTouchmove","onTouchend","$9a5bdb07e7a7c42f$export$2c9e8a9632a706b2","$9a5bdb07e7a7c42f$export$6c4a311cc157c764","ax","ay","bx","by","$9a5bdb07e7a7c42f$export$499eb56409f6cbc2","$9a5bdb07e7a7c42f$export$a4f99f99d3e99cfa","$9a5bdb07e7a7c42f$export$627023b405ba5028","p2","atan2","$9a5bdb07e7a7c42f$export$c03a8450eabc2532","$9a5bdb07e7a7c42f$export$7d15b64cf5a3a4c4","num","$9a5bdb07e7a7c42f$export$bb628a54ab399bc9","deg","theta","cs","cos","sn","sin","$9a5bdb07e7a7c42f$export$95ec0760d3d00713","center","rot","$9a5bdb07e7a7c42f$export$bbf9af158036c5e9","remainder","fDx","fDy","$9a5bdb07e7a7c42f$export$94cce7adf2ec2d08","above","below","$9a5bdb07e7a7c42f$export$f373b6a7b0c159a","$9a5bdb07e7a7c42f$export$f4467a4f41373bc7","bounds","$12950380ec51f25d$export$649a211db9812745","continueChain","chainArr","chainOut","setChainOut","$12950380ec51f25d$export$db3963a21c01d803","sequenceArr","timeoutObj","maxUntilSecondDown","eventQueueArr","lastSequenceItem","onDoubleTap","setupTimeout","timeoutStr","targetFunc","timeMS","diff","nowTime","minSilenceBeforeDurationMs","maxPressedDurationMs","maxPressedDistancePx","maxInbetweenDistancePx","maxUpToUpDurationMs","maxUntilSecondDownDurationMs","minSilenceAfterMs","allowedPointerTypeArr","allowedButtonArr","pointersDownIdArr","lastUpTime","isDown","isUp","processEvent","setAllowedPointerTypeArr","arr","setAllowedButtonArr","firstDownTime","firstLastDownTimeout","tapTimeout","fingerArr","lastEventTime","fingers","maxFirstLastFingerDownMs","downTime","tempLastEventTime","maxTapMs","fingerObj","fingerObj1","i3","allAreUp","i4","onTap","gestureObj1","doSwallow","secondFingerTimeout","touchPointerArr","isInProgress","continuePinch","otherPointerIdArr","downRelX","untilSecondFingerDurationMs","i6","i7","endPinch","touchPointerObj","i5","downRelY","firstFingerMaxDistancePx","gestureObj","pincherArr","actionObj","startDist","distance","startAngle","angle","onPinch","beginPinch","$12950380ec51f25d$export$fe11e0afe623a677","eventCopy","pointers","downPointerId","ignorePointerIdArr","pressure0","pressure1","eventQueue","shiftIsPressed","direction","downEvent","onDraw","i8","$12950380ec51f25d$export$91dcf4209534d21f","isDrawing","lastMixedInput","inputX","inputY","inputPressure","$3f0e2f35371c9852$export$dd0873c0fb3ccff6","resultCanvas","$3f0e2f35371c9852$export$1555f643cc9a976","transform","scaleX","scaleY","whSwapped","$3f0e2f35371c9852$export$ded2b43392504635","destCtx","transformImage","pixelated","imageSmoothingEnabled","imageSmoothingQuality","translate","restore","$3f0e2f35371c9852$export$425a419ef9fc761f","baseCanvas","angleDegree","cache","$3f0e2f35371c9852$export$754559b36e94ea2f","$3f0e2f35371c9852$export$42af33c76b681867","size1","toDataURL","$3f0e2f35371c9852$export$59b33278b5b2fc8a","tmp1","tmp2","oldW","oldH","newW","newH","ew","eh","base2","oldWidthEx","oldHeightEx","newWidthEx","newHeightEx","buffer1","buffer2","bufferCtx","globalCompositeOperation","currentWidth","currentHeight","newWidth","newHeight","tmp","canvasCtx","tmp1Ctx","$3f0e2f35371c9852$export$5a7576952c826b4f","imdat","getImageData","putImageData","multiplyMatrixAndPoint","$e4df33b4b16105d5$export$5b12bf1653c0dd85","getIdentity","matrix","multiplyMatrices","matrixA","matrixB","row0","row1","row2","row3","result0","result2","result3","createTranslationMatrix","createRotationMatrix","createScaleMatrix","$531c9f41f98b7ec0$export$ac4bca90992eed1","nor","mul","dot","aArr","bArr","$77ae015f37ebe4f1$export$b4c5b177db876445","lineStart","lineEnd","$77ae015f37ebe4f1$export$8b36a4a83269a640","segmentArr","_this","points","getAtDist","getLength","fac","lastAngle","pointArr","lastSpacing","spacing","controlsCallback","lastPoint","dir","lastDot","pointM1","pointM2","pointM3","curvePoints","p3","p4","resolution","getBezierPoints","pointLine","tempSpacing","lastCallbackPoint","dAngle","addFinal","newP","xa","ya","wx","sig","ddydx","getFirstX","getLastX","interpolate","klo","khi","$77ae015f37ebe4f1$export$80967b1eb9fd6eb4","findX","$5e7aac2fa49b6b1f$export$d2edaecd208aed43","$5e7aac2fa49b6b1f$export$8f9ece5a47764b93","$5e7aac2fa49b6b1f$export$89d3f85304bf0767","$5e7aac2fa49b6b1f$export$fb7efcd2e153af6e","_RGBtoHSV","minVal","maxVal","del_R","del_G","del_B","_HSVtoRGB","var_h","var_i","var_1","var_2","var_3","var_r","var_g","var_b","_CMYKtoRGB","_RGBtoCMYK","toRGB","o","toHSV","toCMYK","toHexString","ha","hb","hc","toRgbStr","rgbaObj","hexStr","$5e7aac2fa49b6b1f$export$5cf396345d1238ae","$cfe3aa45a75894cc$export$7868464f598ba79d","$cfe3aa45a75894cc$export$906dfdb7df31ccfc","activeElement","$cfe3aa45a75894cc$export$a3d02541b0ebf605","getSelection","sel","empty","removeAllRanges","selection","preventFocus","$cfe3aa45a75894cc$export$6bd63bfceaafae0c","didFocusRelated","relatedTarget","currentTarget","$cfe3aa45a75894cc$export$c3da0dad1b44eea9","$cfe3aa45a75894cc$var$els","onChange","customKeyArr","$cfe3aa45a75894cc$export$b1da1db524e22115","$0d0e99c175410ac4$export$9860cd9e09e6f8ba","msg","getBundleURL","$d82e0c66c1aaca81$export$48513f6b9f8ce62d","innerEl","checked","doHighlight","allowTab","tabIndex","onchange","$aa0ec58519fa7d10$export$b7e3ae3d7c15e42e","$eb01976a4bab51ce$export$ef9b1a59e592288f","selectEl","changeListener","fontSize","padding","colorScheme","isFocusable","optionArr","option","initValue","$5cde84e643fb89d6$export$b6d053cded550773","isActive","backgroundImage","isRadio","setValue","getValue","$459eb3dcb08ae3f8$export$7cc1012a658e6ad8","activeIndex","createOption","initId","radioEl","select","$12a3b74a8702bb1f$export$77219f67585650fa","isChecked","changeCallback","redraw","toggleDiv","backgroundColor","border","cssFloat","marginTop","$e1Rnq","backgroundSize","backgroundRepeat","boxSizing","$d34e5fce81c035ce$export$8b9a4354b27fb66e","splineInterpolator","toLinearValue","useSpline","getOutsideVal","linearValue","updateLabel","pLinearValue","outVal","formatFunc","labelCaption","control","elementWidth","isFinal","isChangeOnFinal","eventResMs","lastCallbackTime","isDisabled","virtualVal","deltaX","curve","elementHeight","curveArr","controlInner","oncontextmenu","labelFontSize","pointerListener","fixScribble","increaseValue","decreaseValue","disable","$0c2dd884393cffca$export$f8e41e222e32615d","isRightButton","$dada52d673c8c4ac$export$cc42e119007cb939","createRgbInputRow","labelStr","attributeStr","rowEl","labelEl","inputEl","lastValidRgb","previewEl","hexInput","hexRowEl","hexLabel","rgbArr","copyButton","execCommand","resultStr","$58f4d49b87b12ba2$export$da75b45cbcab19f5","updatePrimaryHSV","hsv","primaryColorHSV","updateSVCanvas","rgb","hueStop","updateSVPointer","pointerSV","setColPreview","divPreview","primaryColorRGB","pickerButton","hexButton","updateSecondaryColor","secondaryColorBtn","secondaryColorRGB","secondaryColorHSV","controlH","pickCallback","outputDiv","svWrapper","svSvg","DOMParser","parseFromString","documentElement","divH","SVContainer","virtualHSV","$1nsGS","backgroundPosition","isPicking","isOver","targetEl","cv","gradH","createLinearGradient","col","addColorStop","createHueBg","zIndex","factor","$b62b82d17e7d5038$export$ecb37866f21d7d7e","updateSV","canvasSV","gradient1","colleft","colright","heightSV","updateHPointer","pointerH","canvasH","heightH","svPointerId","svPointerListener","hPointerId","hPointerListener","cleardiv","$0b17443c34517974$export$ac00cea56cec3037","param","redrawPoint","sliderPoint","sliderPos","isDragging","pointSize","sliderLine","isFirst","imaginaryPos","transition","$a19b2655062f09b7$export$24ba9b81662d4366","setIsSelected","selectedIndex","colorArr","checkerUrl","sItem","initialIndex","colorButton","buttonSize","$c8511e371b1e3768$export$c019608e5b5bb4cb","optionObj","classArr","isSmall","wrapperEl","selectedId","getIndex","initialId","changeOnInit","$c1a93a3cd82636c9$export$5ee0af1d5c87e856","removeProperty","isWide","updateUiState","angleIm","$bv5Zj","verticalAlign","innerInnerEl","doPulse","animation","_this1","timeout3","timeout","timeout2","$81ac8fccf3fa43c3$export$8e17099f54853f0e","aboutDiv","aniToggle","imageContainer","coverImage","coverSize","aniTimeout","boxSize","ontouchstart","ontouchmove","ontouchend","$01fcd0ed15aa4018$export$40175a5948a88a57","resetCrop","updateCroppedCanvas","croppedCanvas","croppedImage","updateSelectionRect","selectionRect","thumbX","scaleW","thumbY","scaleH","toOriginalSpace","genCrop","topLeftP","bottomRightP","origTopLeftP","origBottomRightP","isReset","eventTarget","isNotCopy","previewWrapper","thumbCanvas","thumbSize","imageRendering","thumbCtx","startP","updateCropTimeout","startCrop","didMove","rect","doUpdate","stepSize","getRect","getCroppedImage","$ffd40240385bb9f9$export$32b89bc9bb92706a","fullCanvas","cropCallback","toClipboard","imgURL","cropCopy","clipboard","ClipboardItem","topWrapper","borderTop","borderBottom","KeyEvent","rectObj","$ffa4ac636a118fcd$export$60204bfd6efac94c","updateEntries","currentTabId","cssSelected","cssContainer","webkitTapHighlightColor","widthSum","borderTopLeftRadius","borderTopRightRadius","keepState","clearDiv","$f0d6f2905d5471e2$export$f77fe9e215cd0ded","p_canvas","p_func","p_rootDiv","oldHistoryState","row","clearBtn","$8yL1I","suggestionBtns","btn","createLayerList","updatefunc","createLayerEntry","klCanvasLayerArr","layercanvas","layerElArr","posY","innerLayer","container1","container2","spot","oldOpacity","thumbDimensions","thumb","thc","lname","whiteSpace","ondblclick","opacityLabel","sliderValue","isLast","layerOpacity","largeThumbCanvas","clearRect","largeThumbDiv","clientY","largeThumbInDocument","largeThumbInTimeout","largeThumbTimeout","dragstart","freshSelection","lastpos","isSelected","div1","activateLayer","updateLayersVerticalPosition","posToSpot","newSpot","oldSpot","move","selectedSpotIndex","regularContainer","firstChild","child","layerHeight","layerSpacing","newspot","posy","oldSpotIndex","newSpotIndex","moveLayer","mergeBtn","disabled","listdiv","disableButtons","enableButtons","div2","modeWrapper","modeSelect","addnewBtn","duplicateBtn","removeBtn","renameBtn","paddingRight","$d42vI","$dKwR8","$3VpTB","clearboth","duplicateLayer","removeLayer","mixModeStr","preview","spacer","topCanvas","alphaCanvas","bottomCanvas","globalAlpha","topOpacity","mergeDialog","mergeLayers","setMixMode","setInterval","historyState","activeLayerSpotIndex","getSelected","spotIndex","stateStr","$d256278b259ca979$export$6b9252711ea5997f","namespaceStr","rootElement","brushCircleOuter","brushCircleInner","pickerPreviewBorder","pickerPreviewCol","compass","compassInner","compassBaseCircle","compassLineCircle","compassUpperTriangle","compassLowerTriangle","updateCursor","radius","updateColorPreview","borderColor","updateCompass","$1dea8f25d1f3d1e7$export$6eaf6f7c0cc177fc","getRenderedTransform","renderedTransformObj","highResTransformObj","updateChangeListener","addChangeListener","lastRenderedState","modeInt","doForce","currentMode","oldMode","MODE_DRAW","MODE_HAND","MODE_HAND_GRABBING","MODE_PICK","$hNEwm","MODE_ZOOM","$iOLNv","MODE_ROTATE","MODE_ROTATING","MODE_FILL","$3zTyb","MODE_TEXT","$kFdtJ","MODE_SHAPE","globalMode","oldIsHand","currentIsHand","mainDoubleTapper","svgOverlay","internalZoomByStep","stepNum","centerX","centerY","newStep","targetTransformObj","newScale","MIN_SCALE","MAX_SCALE","effectiveFactor","transformIsDirty","testBgVisible","renderWidth","renderHeight","art","workspacePointArr","coords","getWidth","getHeight","renderContext","bgVisible","emptyCanvas","borderSize","getLayersFast","compositeObj","compositeCanvas","compositeCtx","workspaceToCanvasCoord","snapAngleRad","snapDegIncrement","maxDistDeg","modDeg","minimizeAngleRad","resetInputProcessor","currentInputProcessor","oldTransform","onViewChange","changed","doRedrawCanvas","elapsedFrames","newState","doRender","doAnimateTranslate","brushRadius","blendFactor","animationSpeed","transformA","transformB","centerPosA","canvasToWorkspaceCoord","centerPosB","mixedPos","mixTransformObj","usesCssCursor","doResizeCanvas","renderTargetCanvas","renderTargetCtx","renderTime","oldTransformObj","cursorPos","isRepeat","onKeyDown","inputProcessorObj","spaceHand","altPicker","zoom","onKeyUp","LinetoolProcessor","lastDrawEvent","matrix2","getMatrix","coords1","matrix1","coords2","getComboStr","linetoolProcessor","coord","offsetX","offsetY","pickedColor","getColorAt","centerObj","startAngleRad","dAngleRad","PinchZoomer","angleIsExtraSticky","DoubleTapper","middleDoubleTapper","NFingerTapper","onUndo","threeFingerTap","onRedo","pointerEventChain","twoFingerTap","pinchZoomer","OnePointerLimiter","CoalescedExploder","picker","animationFrameRequested","lastRenderTime","disableRadiusPreviewTimeout","requestAnimationFrame","updateLoop","checkChange","setCanvas","oldHeight","oldWidth","modeStr","doAnimate","canvasPointsArr","boundsObj","boundsWidth","boundsHeight","oldAngleRad","tx","ty","getMaxScale","getMinScale","$6faa9d948ec87f40$export$e258ade1648009b7","render","$0370167ee97a20d9$var$snapToPixel","$0370167ee97a20d9$var$copyTransform","$0370167ee97a20d9$var$toTransformSpace","px","py","$0370167ee97a20d9$var$toImageSpace","$0370167ee97a20d9$export$79a74567acf241b0","_this2","classCallCheck","scaled","corners","minSnapDist","cornerCursors","gripSize","edgeSize","edges","isConstrained","snapX","snapY","snappingEnabled","ratio","rootEl","transEl","boundsStartP","snap","iP","distX","distY","projected","dist1","updateCornerPositions","updateDOM","virtualPos","offsetArr","tinyOffset","constrainCorner","snapCorner","tP","indexes","updateTransformViaCorners","angleOffset","isInverted","isVertical","pointerRemainder","tfD","ti","dimension","restoreRatio","angleGrip","$lQMok","anglePointerListener","snapDeg","iX","iY","cornerIndex","flip","widthChanged","heightChanged","angle90","newHeight1","skipCallback","transformOrigin","boundsEl","$48f5d87739d28bf9$export$205c2dd29f8a66b5","updatePreview","freeTransform","getTransform","destCanvas","previewLayerArr","transformIndex","initTransform","klCanvasPreview","imageWidth","imageHeight","previewFit","innerWrapper","transformSize","setPos","setAngleDeg","fit","setTransformCenter","getTransformation","getIsPixelated","$de496a1759b04ed9$export$71ed2b85d4ca43d3","transformTop","grips","maxH","transformRight","maxW","transformBottom","transformLeft","commit","cornerElArr","darken","outline","thirdsHorizontal","thirdsVertical","gripCursors","outlinePointerListener","gripOverlay","edge0PointerListener","edge1PointerListener","edge2PointerListener","edge3PointerListener","corner0PointerListener","corner1PointerListener","corner2PointerListener","corner3PointerListener","setTransform","setScale","showThirds","$8dbae0e43d591a5c$export$700a455eda43668e","bg","box","$j8sUl","getDiv","$18e69c7d4cb991e8$export$d25420b53e16716f","layerObj","largeCanvasAnimationTimeout","isInstant","nameLabelEl","opacityEl","layerCanvas","lastDrawnSize","canvasDimensions","canvasSize","animationCanvas","animationCanvasCtx","animationCanvasCheckerPattern","animationCount","animationLength","animate","drawLargeCanvas","lastDrawnState","largeCanvasIsVisible","largeCanvasSize","largeCanvas","largeCanvasCtx","largeCanvasCheckerPattern","largeCanvasWrapper","removeLargeCanvas","largeCanvasAnimationDurationMs","contentWrapperEl","canvasWrapperEl","nameWrapper","flexGrow","nameFadeEl","clickableEl","webkitTouchCallout","createPattern","showLargeCanvas","currentState","klCanvasLayerObj","$a2f9cd4025818799$export$758e8ce7669aab04","remindersShowed","inner","colA","colB","durationMs","$a29ff52bf33e0691$export$83ae33786c7b4ee5","$e3dfa43019bc3f08$export$962af7e240721d88","freeTransformCanvas","isLayerLimitReached","noteEl","buttonRowEl","originalSizeBtn","fitSizeBtn","setTransformFit","centerBtn","importImage","buttonStr","$b3688df6b8da5e0a$export$4330d42ae9108b98","rootCounter","optionLayerCounter","optionImageCounter","testAcceptType","dataTransfer","types","updateOptions","optionLayerEl","optionImageEl","paddingTop","textShadow","optionStyle","fontWeight","$d6fe881e8fc421ac$export$9f0da9b942594e99","updateColor","selectedColorEl","updateUI","mousePos","sizeObj","hHeight","sliderHeight","queuedObj","subscriptionFunc","initialColor","sliderConfig","$6003e73b8cbb69e2$export$665d2c76b1eb8459","createButton","extraPadding","contain","logoButton","$8oUiM","newButton","$1gUFn","importButton","$gswMe","saveButton","$lLh5u","shareButton","$5xpQb","helpButton","$kS5uZ","$18c597dee53260ff$export$a0a40f8a0b8fee15","createDropdownButton","dropdownWrapper","setIsSmall","smallMargin","onClickDropdownBtn","closeDropdown","currentActiveIndex","activeButton","titleArr","updateImage","showDropdown","dropdownBtnArr","arrowButton","activeButtonIm","imArr","$2Gap9","$fuF9j","$adBnR","$cafM1","openTimeout","startX","startY","elementFromPoint","$gzZrf","$a372d78c806cd0cc$export$c744a22bef9e0b97","doEmit","currentActiveStr","toolDropdown","handButton","doLighten","doMirror","createTriangleButton","svg","viewBox","preserveAspectRatio","defs","in","stdDeviation","dx","dy","in2","operator","k2","k3","svgTriangleLeft","class","onLeft","svgTriangleRight","onRight","leftPointerListener","rightPointerListener","leftIm","leftImage","rightIm","rightImage","setIsEnabledLeft","setIsEnabledRight","$9jRQ0","zoomInNOutButton","onZoomIn","onZoomOut","$3KoFh","$eWf2I","zoomInButton","zoomOutButton","undoNRedoButton","$fc34V","undoButton","redoButton","setEnableZoomIn","setEnableZoomOut","$90c04b5ac185bf3d$export$8162a66cd18867a7","strengthSelect","setDeltaValue","$d04d72b97d637d65$export$3c6d17ed0106bfb9","pTabObj","useAccent","openedTabObj","tabDiv","openedTabObj1","tabArr","tabId","$9934467c988b088a$export$cf20160367bae46c","scaleEl","angleEl","resetButton","fitButton","leftRotateButton","$2n4Fs","resetAngleButton","rightRotateButton","pIsVisible","pScale","pAngleDeg","$51d47356d698ffec$export$1e63e3b0645421a2","toleranceSlider","selectRow","growWrapper","growSelect","isContiguous","contiguousToggle","$d06987f550ff485e$export$32a22540e4b2f123","$45c003c723de07b5$export$a9387b1d4260d39c","updatePreviews","strokeWidth","lineWidthSlider","squish","rectStrokeSvgRect","stroke","rectFilledSvgRect","ellipseStrokeSvgEllipse","ellipseFilledSvgEllipse","lineSvgLine","fixedToggle","previewPadding","previewSize","snapToggle","rectStrokeSvg","rectFilledSvg","cx","cy","ellipseStrokeSvg","ellipseFilledSvg","lineSvg","shapeOptions","eraserToggle","outwardsToggle","$4fb68589de8a8c9a$export$f77a89101d7d6586","createRatioSize","ratioX","ratioY","maxCanvasSize","updateRatio","widthInput","heightInput","commonRatios","reducedArr","closestRatio","closestDistance","ratioWrapper","innerText","realw","U","HCF","canvasWidth","canvasHeight","workspaceWidth","workspaceHeight","newImDiv","widthWrapper","heightWrapper","widthUnit","heightUnit","templateWrapper","presetFitBtn","presetCurrentBtn","presetSquareBtn","presetLandscapeBtn","presetPortraitBtn","presetOversizeBtn","sizeObj1","backgroundRGBA","colorOptionsArr","colorOptions","previewcell","onkeyup","secondRow","secondRowLeft","$3f73fb4b1b574d52$export$5b91f641162972fc","icon","directionStr","$jiQkU","dirStr","$fdc12d72a3df9be9$export$482c90f94eb9717c","outer","fontFamily","fontStyle","spanStr","children","el1","fillText","isDebug","strokeRect","$cd9e7df6e228ea45$export$e263e067d6140649","textCtx","textCanvas","textInput","alignRadioList","italicToggle","boldToggle","sizeInput","fontSelect","rotatedXY","rotatedWH","fitBounds","zoomFac","targetCtx","previewCanvas","layersCtx","previewCtx","checkerPattern","layersCanvas","strokeStyle","rotated","changeZoomFac","zoomInBtn","canZoom","zoomOutBtn","onScroll","scrollTo","isSmallWidth","isSmallHeight","previewPointerListener","row2n3Wrapper","fontPointerListener","zoomWrapper","sizePointerListener","$2dqOY","$rk4vM","$hucjG","$cZa2s","$03Zd8","placeholder","resize","$c8d2eb7d799b314c$export$1bf16d9bd59fd8f9","resolutionEl","updateResolution","flattenCheckbox","doFlatten","noteStyle","warningArr","psdWarningArr","contentArr","warningMap","mask","clipping","adjustment","showWarnings","noteEl1","cropRect","$7069db2f5e23d00f$var$fillRect","$7069db2f5e23d00f$var$mx","$7069db2f5e23d00f$var$my","$7069db2f5e23d00f$var$moveIndex","$7069db2f5e23d00f$var$testAndFill","srcArr","targetArr","initRgba","tolerance","grow","tl","tr","br","bl","$4c230b0de5e1a470$var$kl2PsdMap","$4c230b0de5e1a470$var$psd2KlMap","$4c230b0de5e1a470$var$init","multiply","lighten","exclusion","hue","saturation","luminosity","$4c230b0de5e1a470$export$6df36f0c42d2440f","$4c230b0de5e1a470$export$4e3b1f7d3ad623b4","$4c230b0de5e1a470$export$3d649861c4b13fa2","psdObj","addWarning","warningStr","getMixModeStr","blendMode","prepareMask","maskCanvas","defaultColor","groupMaskCtx","imData","bitsPerChannel","layerCount","countWithinGroup","groupObj","convertGroup","psdGroupObj","groupCanvas","groupCtx","resultArr","groupOpacity","hidden","groupMixModeStr","hasClipping","innerArr","innerItem","innerCtx","clippingCanvas","clippingCtx","clippingItem","effects","clippingCanvas1","clippingCtx1","clippingItem1","$01d7180c5d1d0fdf$export$27550cc14d7ae85a","downX","downY","downAngleRad","onMove","$01d7180c5d1d0fdf$export$71b514a25c47df50","r1","r2","pAngleDegSnapped","r11","r21","ry","rdX","rdY","x1r","y1r","x2r","y2r","x1f","y1f","x2f","y2f","beginPath","moveTo","lineTo","x1f1","y1f1","x2f1","y2f1","ellipse","$0621fc8724f6bfac$var$allowedMixModes","$0621fc8724f6bfac$export$4a819bde91671014","layerNrOffset","emitChange","changeListenerArr","layerCanvasArr","maxLayers","pickCanvas","toCopyCanvas","origLayers","algorithm","offX","offY","ctemp","layerCtx","fillColor","selected","doReturnNull","layerBottomIndex","layerTopIndex","isHorizontal","tempCtx","colorObj","compositeOperation","sampleStr","srcCtx","srcImageData","srcData","targetImageData","targetData","srcCanvas","srcIndex","pCopy","replaceLayer","imageData","canvasObj","finalim","$41164c8aeaf53227$var$indexedDbIsSupported","indexedDB","$41164c8aeaf53227$var$dbNameStr","$41164c8aeaf53227$var$storageNameStr","$41164c8aeaf53227$export$1347f8be1f25c479","$41164c8aeaf53227$var$execIndexedDBTransaction","actionFunction","successCallback","errorCallback","onError","errorStr","hasFinished","requestObj","createObjectStore","keyPath","createIndex","unique","databaseObj","objectStoreNames","contains","deleteDatabase","storeObj","transactionObj","transaction","objectStore","e2","e3","oncomplete","$41164c8aeaf53227$export$1448a0dd0d3fde8e","$41164c8aeaf53227$export$21ade4eb935254aa","storageProject","put","$41164c8aeaf53227$export$42ffd38884aecdac","$805be15a1e91c0ee$export$7a4e0b62a5d854bc","isLoaded","$805be15a1e91c0ee$export$395d33c8e06b92c9","glBrightnessContrast","buttonLabel","webgl","updateContext","$8k5kH","getDialog","inEmbed","$4UkHZ","neededWithWebGL","glCurves","$e7LnL","$iI5sC","glHueSaturation","$eySuj","invert","$iPRwU","glPerspective","$krmR4","$92iBR","glTiltShift","$bFASM","toAlpha","$9m6gZ","$4fkq2","ieFails","glBlur","$dPWA8","glUnsharpMask","$cQHFd","$42ac5b30ad65dabb$export$7d68cd8857639377","defaultBrush","$8exf0","BlendBrush","$5PSXS","sketchy","$ewgr9","sketchyBrush","pixel","$kic4a","pixelBrush","smudge","$ltaBP","smudgeBrush","$7cUpm","eraserBrush","$e287643e0c37bc21$export$655f76e9e73f5f80","settingColor","settingColorStr","updateAlphaCanvas","settingAlphaId","ALPHA_CIRCLE","ALPHA_SQUARE","instructionArr","alphaCanvas128","alphaCanvas64","alphaCanvas32","alphaOpacityArr","$5CF7D","alphaImArr","drawDot","before","settingLockLayerAlpha","arc","twoPI","closePath","targetMipmap","ALPHA_CHALK","bezierLine","lastInput","dotCallback","localPressure","lastInput2","localOpacity","settingOpacity","settingHasOpacityPressure","localSize","settingSize","settingHasSizePressure","drawArr","localSpacing","settingSpacing","isFake","actions","historyEntry1","continueLine","loopDist","mouseDist","eX","eY","bdist","historyEntry","setAlpha","setSpacing","sizePressure","opacityPressure","setLockAlpha","getSpacing","$ff6c1f784f50f5d5$export$d116ae91f77f1f19","$74D3O","genBrushAlpha01","genBrushAlpha02","$f875015ce1aeb4d3$export$74a44bbc21d06a28","scaleFac","createImageData","sFac2","$gZSR2","noise","simplex2","noisePattern","centerDist","$f875015ce1aeb4d3$var$udSegment","ba","pa","$f875015ce1aeb4d3$export$eaa218d5d17c8f1c","pDist","centerSize","transitionSize","$dfc47a34ad9bc378$var$myModule","$dfc47a34ad9bc378$var$Grad","dot2","$dfc47a34ad9bc378$var$grad3","$dfc47a34ad9bc378$var$p","$dfc47a34ad9bc378$var$perm","$dfc47a34ad9bc378$var$gradP","$dfc47a34ad9bc378$var$F2","$dfc47a34ad9bc378$var$G2","xin","yin","j1","gi0","gi1","gi2","$02d77b8dd5755328$var$cellSize","$02d77b8dd5755328$var$clamp","$02d77b8dd5755328$export$9659db8d01dd5313","isTesting","blending","settingSizePressure","settingOpacityPressure","blendCol","blendMix","redrawBounds","cells","getTouchedCells","isTouched","touchedCells","cellsW","getCellsWidth","cellOffsetX","cellOffsetY","cellWidth","cellHeight","inCellBounds","tmpCtx","alpha","ar","ag","ab","aa","sliceBounds","randI","randLen","randArr","samples","samplesSquared","sampleOffsets","sharpness","invSharpness","sharpnessSubtrahend","sizeSquared","distDivisor","alphaMinuend","slicedBounds","ri","alphaO","alphaU","underR","invAlphaO","underG","underB","underR1","underG1","underB1","newAlpha","drawBuffer","calcSpacing","avgX","avgY","mixr","mixg","mixb","average","localColOld","avgParams","prepDot","copyFromCanvas","getAverage","localColNew","updateRedrawBounds","totalCells","drawChangedCells","$c214fbe9e4fc15b0$var$sampleCanvas","$c214fbe9e4fc15b0$var$sampleCtx","$c214fbe9e4fc15b0$export$561c93f463e3c1a","lastX","lastY","settingBlending","settingScale","sketchySeed","setSeed","getSeed","mixmode","c1","getBlending","setBlending","p_x","p_y","preMixedColor","mixx","mixy","mixw","mixh","countmix","mixed","setDebug","$58b45953679baa4a$export$3c3507434ff9c3cf","ditherPattern","plotLine","skipFirst","settingIsEraser","settingUseDither","sX","sY","plotCubicBezierLine","isOverThreshold","d2","d3","cubicCurveOverThreshold","controlCallback","controlObj","ditherCanvas","ditherCtx","ditherArr","updateDither","setIsEraser","setUseDither","getLockAlpha","$fc1a683099fb2d61$export$22eeff62edad5b64","isBaseLayer","isTransparentBG","radgrad","createRadialGradient","oFac","opacity1","bezierCallback","debugStr","started","setTransparentBG","$78ad817c60f81b7c$var$smudge","cSize","brush","cX","cY","aP","bP","aIndex","ai","bi","ix","iy","softness","fac2","alphaLock","bx1","iy4","yStart","bx2","ix4","iy1","yStart1","x21","ix1","iy2","yStart2","x3","x22","ix2","y3","iy3","yStart3","x4","x23","ix3","$78ad817c60f81b7c$export$f694e4f33d831e0f","copyImageData","copiedCells","updateCompleteRedrawBounds","completeRedrawBounds","imWidth","imHeight","$78ad817c60f81b7c$var$prepSmudge","smudgeBuffer","cellSize","ImageData","historyIm","tmpCanvas","$7de2f0eab7a9ead7$export$f1561c72be54c6a7","$AysI7","defaultBrushUi","blendBrush","$9mjXI","blendBrushUi","$iYbUv","sketchyBrushUi","$brjBD","pixelBrushUi","displace","$dS2qM","smudgeBrushUi","$9rc5F","eraserBrushUi","brushInterface","alphaNames","$8259323f3cb8b90b$export$68d59e83a12dc946","$gQwEO","updateAlphas","alphas","currentAlpha","spacingSpline","onSizeChange","lockAlphaToggle","$7NTKy","onOpacityChange","pressureSizeToggle","pressureOpacityToggle","alphaWrapper","$e8a5c017c49bb311$export$5ec472fd0ce20d84","$2e3c50106ba150d5$export$156bb4fe8f4bcb4b","$cC0s5","blendingSlider","setSizePressure","setOpacityPressure","$94537af75923b9e3$export$ffae56164d1bde68","$bteky","blendSlider","scaleSlider","$9519e739bc9666ee$export$d001f3406562d07","$4PDnu","ditherToggle","getUseDither","toggleRow","$d6fc2ded7d9d56db$export$cf481ecf227135a8","$984eq","isTransparentBg","transparencyToggle","$1045b9bae2ffbbb4$export$84831662ba707e7a","$aQkfK","$6f92981a32875bca$export$5334e08b3589fc5c","isEmbed","linkEl","isMaxHeight","$142eacf53b1eb43d$export$3dff5655255b5729","inputs","ignoreFocus","$0e681e75eb3cab30$export$9c72cf485ef46673","gridTemplateColumns","gridTemplateRows","gap","gridTemplateAreas","gridArea","isBroken","ageEl","textSize","storeEl","clearEl","onUpdate","timestamp","thumbnail","updateThumb","updateAge","readResult","read","ageStr","age","maxWidth","maxHeight","resetButtons","$089586a542a12f27$export$5f63a7b18dc4503a","$14b343f2c12ca9c5$var$makeAsync","$14b343f2c12ca9c5$export$93d91060b9af7e2a","accessHasFailed","storeKlProjectObj","getKlProjectObj","setItem","lowLevelRead","$3hwQ7","ProjectConverter","readStorageProject","storageProject1","createStorageProject","lowLevelStore","lowLevelClear","updateTimestamp","$3ee249752703e788$var$loadImage","onabort","$3ee249752703e788$export$f3c1ac6650038646","$2wCWz","base64ToBlob","createThumbnail","HTMLCanvasElement","t2","$e3587a28373f51f9$export$b3fb17ae4345ac8f","base64Str","binStr","atob","buf","$01ce2e23a2667e77$export$a2647fbf5f056b0a","onExportTypeChange","onFileSelect","onSaveImageToComputer","onNewImage","onShareImage","onUpload","onCopyToClipboard","createSpacer","clearer","line","filemenu","uploadImgurButton","clipboardButton","$4xKQD","$fcsnL","multiple","accept","exportTypeWrapper","exportTypeSelect","importWrapper","innerMask","importFakeButton","createImportButton","saveNote","fileBrowserStorage","headlineUpload","refresh","$0d10046ca7f6fbd0$export$3f17d740ad471e50","getCurrentColor","getKlMaxCanvasSize","getKlCanvas","getCurrentLayerCtx","isInit","filterKey","filterArr","applyFilter","filterDialog1","currentColorRgb","secondaryColorRgb","filterDialog","getInput","finishedDialog","createDisabledButton","addGroup","groupArr","filters","groupA","groupB","filterKey1","hrEl","webglnote","$2574c4c829fba14e$var$upload","_upload","gif","labelText","response","formData","FormData","Authorization","json","$2574c4c829fba14e$export$b1dd62fa0b5f32f5","inputTitle","inputDescription","cols","rows","labelTitle","labelDescription","tos","typeRadio","outDiv","infoHint","deletehash","$ae23cd0c3e53f398$var$agPsdLazy","$ae23cd0c3e53f398$export$ab3d838b1d336b38","_loadAgPsd","$06e8423858d08972$export$befc6437ad34b28a","showReminder","changeTitle","onBeforeUnload","oldActionNumber","visibilityState","actionNumber","historyDist","lastReminderResetAt","unsavedInterval","isSoft","$956d06d740fc5053$export$75e7b60500bb415b","getExportType","saveImage","mimeType","$98ax7","saveAs","mimeType2","filename1","fnameArr","fileBase","layerArr1","psdConfig","blendKlToPsd","writePsdBuffer","XMLHttpRequest","responseType","g1","send","d1","a2","initMouseEvent","a1","HTMLAnchorElement","download","rel","msSaveOrOpenBlob","autoBom","warn","HTMLElement","safari","onloadend","readAsDataURL","amd","FileSaver","$48534f13b7192dff$export$5cebd3bb2d68229a","getInitState","setCurrentLayerCtx","getCurrentBrush","doIgnore","ignoreTest","oldSize","b4","id1","b3","b8","p5","b5","p6","b6","id2","b7","currentLayerIndex","logParam","localCurrentLayerCtx","p7","p8","b9","p9","b10","id3","b11","$b37f5cd553722692$export$665d2c76b1eb8459","submitButton","leftRightButton","$7OLuX","fullButton","minimizeButton","$4bb0d03ef02dc0c0$var$importFilter","libObj","moduleObj","$4bb0d03ef02dc0c0$export$4283b00eae4a6956","$99EgS","$5deND","$4d8c6","$5Ta9b","$gMKRz","$7z464","$diAhN","$c1rJJ","$2elec","$gACTl","$dIv7c","$1NZ3i","$cJB4E","$gTwOE","$1e763c481ba6cf00$export$80884bc1ac80aa1d","selectedLayerIndex","brightness","contrast","glCanvas","$5RaQo","getSharedFx","texture","brightnessSlider","$cH2YE","brightnessContrast","contrastSlider","previewInnerWrapper","$fca35583bfaa35b6$export$5ec472fd0ce20d84","$0e6e34a2063e157d$var$fxCanvas","$TEtAx","fx","$0e6e34a2063e157d$export$8c4423af32b21158","isContextLost","$5eb53faa48338ac6$export$68ae324f2f6c6252","lo","hi","wrapTexture","loadContentsOf","gl1","texture1","Texture1","fromElement","initialize","UNSIGNED_BYTE","getExtension","testTexture","RGBA","FLOAT","drawTo","spareTexture","extraTexture","flippedShader","Shader1","use","getDefaultShader","drawRect","simpleShader","shader","uniforms","textureIn","textureOut","swapWith","node","contents","getPixelArray","readPixels","dx1","dy1","dx2","dy2","dx3","dy3","det","warpShader","warp","interpolator","curves","red","green","blue","splineInterpolate","initFromBytes","textures","denoise","texSize","hueSaturation","amount","sepia","unsharpMask","strength","ensureFormat","triangleBlur","unuse","vibrance","vignette","lensBlur","lensBlurPrePass","randomShaderFunc","lensBlur0","lensBlur1","lensBlur2","power","delta0","delta1","tiltShift","endX","endY","blurRadius","gradientRadius","zoomBlur","colorHalftone","dotScreen","edgeWork1","edgeWork2","hexagonalPixelate","replaceRGBA","oldGetExtension","oldGetSupportedExtensions","getSupportedExtensions","framebuffer","createFramebuffer","byteTexture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","FRAMEBUFFER","COLOR_ATTACHMENT0","floatTexture","LINEAR","program","createProgram","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","shaderSource","compileShader","attachShader","linkProgram","createBuffer","ARRAY_BUFFER","STREAM_DRAW","enableVertexAttribArray","vertexAttribPointer","useProgram","viewport","POINTS","supportsOESTextureFloatLinear","WebGLRenderingContext","$OES_texture_float_linear$","OESTextureFloatLinear","extensions","perspective","matrixWarp","bulgePinch","edgeWork","swirl","ink","testPrecisionSupport","Shader","defaultVertexSource","defaultFragmentSource","nameStr","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","precisionType","format","getShaderPrecisionFormat","precision","vertexSource","fragmentSource","vertexAttribute","texCoordAttribute","floatPrecision","HIGH_FLOAT","MEDIUM_FLOAT","compileSource","getProgramParameter","LINK_STATUS","getProgramInfoLog","deleteProgram","getUniformLocation","uniform1fv","uniform2fv","uniform3fv","uniform4fv","uniformMatrix3fv","uniformMatrix4fv","isNumber","uniform1f","uniform1i","getParameter","VIEWPORT","vertexBuffer","bindBuffer","bufferData","STATIC_DRAW","texCoordBuffer","getAttribLocation","defaultShader","getCanvas","Texture","videoWidth","videoHeight","unit","activeTexture","TEXTURE0","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","pixels","other","$21fb62da4f6e89f8$export$4630dcf80f8ceb88","leftInput","rightInput","topInput","bottomInput","leftChanged","rightChanged","previewFactor","topChanged","bottomChanged","lrWrapper","tbWrapper","updateInput","labelStyle","useRuleOfThirds","ruleOThirdsCheckbox","cropper","selectedRgbaObj","updateBg","flexRow","bgColorOverlay","offsetWrapper","register","$e250f451a2faf8b3$export$2e9081b953703a77","canvas1","fit1","ctx1","curves1","modeButtons","p0","areah","areaw","update2","curveArea","createPoint","lock","internalY","internalX","newX","newY","updateControl","outCurves","drawCurve","$ae0fd60a73f3b8a4$export$8a83211c878a3f1f","previewLayer","doFlipCanvas","horizontalCheckbox","verticalCheckbox","fcOption","paddingBottom","$1RI49","flOption","optionWrapper","horizontal","vertical","flipCanvas","$b5e471d752989800$export$88005259b9a70e15","Saturation","hueSlider","saturationSlider","$d23471d9289cfec2$export$6897c284b6f9f4dc","$ed63f0c6c7ca7574$export$358acb0cd681f612","displayH","displayW","pointerListenerArr","bb","bc","bd","ac","ad","nob","updateAfter","beforeOption","afterOption","displayPreviewFactor","after","nobSize","$2405b4796fda9858$export$4380c87abf28fdf","previewW","previewH","algorithmSelect","canvasWrapper","inputWrapper","$jfTWC","constrainCheckbox","secondRowElement","$5b99ea702a5304d2$export$bb628a54ab399bc9","WebkitTransform","MozTransform","OTransform","msTransform","btnPlus","btnMinus","$e3bfa9cf59911118$export$83a0900d4b9a8022","gradient","fa","fb","blurSlider","gradientSlider","$dc2850290325f029$export$51186ad6e864892a","lastDrawnTransformStr","transformLayerCanvas","onInputsChanged","inputR","tempBounds","rotWrapper","leftWrapper","rightWrapper","buttonRow","actionBtnCss","getRatio","setConstrained","setSnapping","isSnapping","snappingCheckbox","checkboxWrapper"],"version":3,"file":"main-embed.b5d6a101.js.map"}